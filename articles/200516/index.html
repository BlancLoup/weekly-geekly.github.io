<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We aim from the gun</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article describes a simple gun targeting algorithm, when the axis of rotation does not intersect with the axis of the barrel. It was not possible ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We aim from the gun</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/437/747/516/437747516b1836993e6d5316a7addb87.png" align="left"><br>  The article describes a simple gun targeting algorithm, when the axis of rotation does not intersect with the axis of the barrel.  It was not possible to quickly find the ready one - I had to remember the school days.  Well, since I remembered, it is a sin not to share with the rest.  And someone somewhere, saving time, uses it to create something more useful ... <br><br>  The result of the above calculations is used in an arcade game.  For a month there were no misses.  If you are developing a simulator, you will most likely need something more sophisticated. <br><a name="habracut"></a><br><br>  So, given the gun.  When hovering, the turret can rotate in the horizontal (red axis of rotation in the figure) and vertical (green axis) planes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Gun Model Properties <br><br>  1. The stem axis (marked in blue) does not intersect with the axes of rotation. <br>  2. The axis of the trunk is parallel to the axis X <br>  3. The direction of the shot coincides with the positive direction X <br>  4. The horizontal rotation axis (red) is parallel to the Z axis, or the axes coincide. <br>  5. The vertical rotation axis (green) is parallel to the Y axis, or the axes coincide. <br>  6. The top of the model corresponds to the positive direction of the Z axis. <br><br>  For successful targeting you need to calculate two angles of rotation - horizontal and vertical. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c55/403/ad9/c55403ad90c64c985b99f6605159cdee.png"><br><br>  Due to the specified constraints of the model (the axes of turns are parallel or coincide with the corresponding axes of coordinates), the task of finding the pointing angles in three-dimensional space can be divided into two in two-dimensional: <br><br>  1. The angle of horizontal rotation can be found using the model projection on the XY plane (Z = 0) <br>  2. Angle of vertical rotation - XZ axis (Y = 0) <br><br>  Solve both subtasks will be the same. <br><br>  To begin, consider the starting position. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/de5/088/25d/de508825d63fa885a3f509af6ac13695.png"><br><br>  A is the center of rotation.  The result of the projection of the axis of rotation on the perpendicular plane. <br><br>  B - the point of departure of the projectile. <br><br>  Fire is a projection of the direction vector of the shot. <br><br>  C - goal position <br><br>  Determine the angle between the shot vector and AB <br><br><img src="https://habrastorage.org/getpro/habr/post_images/611/f15/126/611f15126a5f1b74b39941b37d8a3263.png"><br><br>  Hereinafter, the angular brackets will denote the scalar product of vectors. <br><br>  Now suppose the guidance is complete.  When turning to the target, point B went to D, and the Fire vector became Fire1 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d60/550/cbe/d60550cbeef4351c4959feb84226fa2e.png"><br><br>  From here you can find the length of the DC segment using the cosine theorem. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e1d/641/ade/e1d641aded8d33b038cfed7e3ccc05b8.png"><br><br>  Where <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9a6/772/34a/9a677234ad24d5484e95f9edc6eb9a13.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/bcf/4fc/0f6/bcf4fc0f658856bbbaff60441f70bd99.png"><br><br>  Rewrite the formula to match the general form of the quadratic equation <br><br><img src="https://habrastorage.org/getpro/habr/post_images/94c/b81/682/94cb81682d377369b3f4a83aebb0b838.png"><br><br>  for unknown DC <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b8f/079/ef9/b8f079ef9a1c2624e22537b1702faee8.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6aa/ad3/1fd/6aaad31fd3857761a414de204192bf8c.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a09/1f9/83d/a091f983df136dec10bbca27a360a686.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c56/696/7d9/c566967d93e6574f9ae5736fa8aeb664.png"><br><br>  then <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8e0/1ee/8c1/8e01ee8c1d89cbda1f177a0e160b23f2.png"><br><br>  of the two DC values ‚Äã‚Äãthat are obtained, we are positive. <br><br>  If DC turns negative, then the target is inaccessible (at least using this algorithm) for positioning. <br><br>  Now consider the figure, which shows the position of the system before and after pointing <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5de/675/9cf/5de6759cfd0340c6f58067eb419e4c99.png"><br><br>  Red indicates the desired angle of guidance. <br><br>  Determine the coordinate of point E. This is the coordinate of target C, rotated by the aiming angle relative to center A in the opposite direction.  Ie this is where the gun would hit if it had fired at the correct distance, forgetting to turn.  To do this, shift point B in the direction of the Fire vector to a distance DC. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/08d/d2f/94f/08dd2f94fe740a2087d967be4a82abe8.png"><br><br>  Then the aiming angle is the angle between the vectors AE and AC, which is through the scalar product <br><br><img src="https://habrastorage.org/getpro/habr/post_images/173/12a/5aa/17312a5aa972d994eacea410b2812e38.png"><br><br>  The angle is found, but you need to remember that the aiming point can be anywhere, including ‚Äúabove‚Äù the direction of the shot.  Those.  need to find another direction of rotation. <br><br>  Determine the orientation of the vectors AE and AC.  Two vectors are not enough for this.  We need a third vector perpendicular to the first two.  Let's call it V. It is his direction that determines the position of the observer, who will see the rotation clockwise or counterclockwise, depending on which side of the plane with the vectors AE and AC is located.  Since we are working with projections on coordinate planes, the desired vector will be parallel to the third coordinate axis. <br><br>  For definiteness, consider an example of a projection on the XY axis.  In this case, the perpendicular vector will have coordinates (0, 0, z), where z is not equal to zero.  With the z sign you need to decide.  When building the projections, I proceeded from the fact that I am on the positive side of the Z axis, therefore z&gt; 0 <br><br>  The orientation of the vectors is determined by the sign of the determinant, composed of coordinates.  The first line is the coordinates of the rotated vector, the second is the vector to which the first and the third vectors are rotated. For our case (AE rotates to match AC), this <br><br><img src="https://habrastorage.org/getpro/habr/post_images/399/d5d/f89/399d5df8931ab36a711e4b40de7ceef5.png"><br><br>  Since we have determined that z is strictly positive, its value will not affect the sign of the result <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f2/411/db5/5f2411db5fa0531a961070b7b80c1728.png"><br><br>  Ie the final angle of rotation for the case of projection on the XY axis, this <br><br><img src="https://habrastorage.org/getpro/habr/post_images/759/87e/cd9/75987ecd907c69c0f0ad056d71d34e56.png"><br><br>  Similarly, the direction of rotation is calculated for the projection on the XZ axis. <br><br>  Well, the last remark.  Fully independent of each other, the angles of rotation can not be calculated.  The turret can make a complete turn (from -180 to 180 degrees) around the horizontal axis, but around the vertical this is usually impossible (it will look as if the gun has come off the ground and turned over. Vertical turn is logical to limit to the range from -90 to 90 degrees. <br><br>  This is the easiest to implement. <br><br>  1. Find the angle of horizontal rotation <br>  2. Turn the target at this angle around the axis of horizontal rotation in the opposite direction <br>  3. Calculate the vertical angle of guidance for the new coordinates of the target. <br><br>  Or (which is essentially the same), you can first rotate the tower horizontally, and then calculate the angle of vertical rotation. <br><br>  Now the gun will fall. </div><p>Source: <a href="https://habr.com/ru/post/200516/">https://habr.com/ru/post/200516/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../200506/index.html">Google+ URLs</a></li>
<li><a href="../200508/index.html">Intel Xeon E3-1230 / 8GB DDR3 / 4x1TB SATA2 / 100Mbps Unmetered at NL / US for $ 89 / month! Windows 2008 R2 Web for free!</a></li>
<li><a href="../200510/index.html">Digest of news of the Windows Azure platform, October 2013</a></li>
<li><a href="../200512/index.html">Football Manager 2014 released and available under Linux</a></li>
<li><a href="../200514/index.html">IGoogle closed</a></li>
<li><a href="../200518/index.html">Tape is still the leader in data backup</a></li>
<li><a href="../200522/index.html">Look: Android vs iOS</a></li>
<li><a href="../200528/index.html">How to teach scanners to scan silently by buttons without windows and crutches?</a></li>
<li><a href="../200530/index.html">The best startups of the Runet or the composition of the semi-finalists Web Ready 2013</a></li>
<li><a href="../200532/index.html">Coursera Launches Learning Hubs ‚Äî Physical Premises for Online Courses</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>