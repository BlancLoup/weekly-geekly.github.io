<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to connect Java, Js and graphs with art, or the story of how to create an interactive theater</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This year in Estonia is a series of theatrical performances, united in a series of "History of the Century." During the year, 22 theaters in the count...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to connect Java, Js and graphs with art, or the story of how to create an interactive theater</h1><div class="post__text post__text-html js-mediator-article">  This year in Estonia is a series of theatrical performances, united in a series of "History of the Century."  During the year, 22 theaters in the country presented to the public in their performances the centenary history of Estonia.  In the course of the draw, the Russian Theater of Estonia was given the topic of the future of Estonia. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/sjoH4uYETVo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Under the cut - how to combine technology and art. <br><a name="habracut"></a><br>  Each of us has an idea of ‚Äã‚Äãwhat the future could be: what we fear, what we dream of, what it may actually be.  In order to avoid a performance that tells only a narrow circle of theater people who think about the future, we addressed this question to those who will live in the future - children, Estonian youth aged 3-19 years.  There were hundreds of respondents, and we are very grateful to them. <br><br><img src="https://habrastorage.org/webt/ok/ca/ka/okcaka8lqv3eksoc14xuyqspihg.jpeg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Each answer received is unique, but, sorting the materials, we saw noticeable trends and patterns.  From the children's answers loomed an incredible number of possible worlds of the future - and attractive, and terrible.  But these worlds also had common features, on the basis of which the plot was built. <br><br>  The performance takes us to the year 2118.  Estonia is under a protective dome.  We have learned a lot, including life extension.  The main characters - an elderly couple Linda and Timo.  A hundred years ago, being children, they fantasized about the future in which they now live.  This is one of those very children, thanks to whom this performance turned out.  Heroes fall into different worlds, in different Estonia.  During the performance, it is the spectators who, by their decision, influence what their 2118 year will be. <br><br><img src="https://habrastorage.org/webt/he/4k/qo/he4kqo1besdvokvprzbai-zo_5s.jpeg"><br><br>  The theater does not start with a hanger, but much earlier.  After processing all the material, the main paths for the development of the future were identified according to the children, from the information technology path to the ecological state.  Since the future is not predetermined, but depends on the choice of each of us, the possible paths of development were divided into stories, united by the history of the main characters and their families. <br><br><img src="https://habrastorage.org/webt/xy/lz/4z/xylz4zziphoqxdglpaiilnlkrx4.png"><br>  <i>Artyom Gareev (director of the play) shows the main ideas on a model</i> <br><br>  The idea of ‚Äã‚Äãscenery is a constructor, which in the hands of children can take any form and function.  He also has the form of a graph.  A graph is a special abstract mathematical object that allows you to describe and model many real-world phenomena: the road network, the organizational structure, the Internet, and various choices that people can make.  Elections that lead on different lines of the plot. <br><br><img src="https://habrastorage.org/webt/8g/dt/pc/8gdtpciqewzjhqmlkyov9hqjtya.png"><br><br>  In addition to the dramatic task, there were considerable challenges from the technical side: stage lighting, a complex system of controllers that controlled hundreds of LEDs on the scenery, a variety of costumes for each variant of the future, skillfully performed by one of Estonia‚Äôs best theater artists Rosita Raud.  The actors needed to change quickly after each vote, which was especially difficult when the intrigue remained until the very end of the vote and the next scene was unknown. <br><br>  All music is played live by the <a href="http://modulshtein.com/">MODULSHTEIN</a> project. <br><br><img src="https://habrastorage.org/webt/63/mk/h0/63mkh0zxlk3-4bdilenmmhxoqjo.jpeg"><br><br><h3>  To make it a little clearer, let's get into the context of the play a little. </h3><br>  We found ourselves in a multi-cultural society, where languages ‚Äã‚Äãand genders are intermingled.  Everything is allowed. <br>  A news release immerses us in the proposed circumstances. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/cqnvd7KJalo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Ironically adds that Elena Solomina - leading on national television and well known to many viewers. <br><br>  Multicultural society is sheer fun, the younger Semenova leads to get acquainted with the parents of a huge boyfriend dressed in arafatka and a tutu. <br><br>  After all, they go to a party. <br><br><img src="https://habrastorage.org/webt/gh/ec/ar/ghecarf2b1jsq-pqlmb_8z8129a.png"><br><img src="https://habrastorage.org/webt/gn/pr/wc/gnprwcazoufbeiatjj6u-sld040.png"><br><br>  At the end of the scene, a vote opens, offering a choice of whether Estonia will take the proposed path of multicultural development. <br><br>  And if the answer is positive, then ... <br><br>  Utopia falls into dystopia and freed freed up with a knot.  There are new bans, and now the special forces break into the party and sort people.  Some are allowed to pass to the right, towards the future, others are stripped and sent to the left, where their fate is decided by the machine of destruction.  (based on articles by Nikolai Karaev and Boris Tukh) <br><br><img src="https://habrastorage.org/webt/7_/nr/gn/7_nrgn9jg4akvmdz29hqj6luimk.png"><br><img src="https://habrastorage.org/webt/vi/mk/lx/vimklx4g2bmrkldu1h-edtx6eik.png"><br><br><h3>  What technical solution did we need? </h3><br>  In fact, it was another EMA actor (Est. Mama), artificial intelligence, which became a reality in the future.  EMA leads the audience through the story, manifests itself in different variants of the future, and also announces and launches the vote, counts and presents the results, moves along the subject lines.  The hall could accommodate 600 people.  And each viewer should have the opportunity to vote, and the system correctly calculate his voice. <br><br>  Possible options for the development of the plot, presented and modeled as a graph, formed a complex and branched structure. <br><br>  Utopia tends to flow into a dystopia, and the road to hell is paved with good intentions.  The plots are interconnected by the logic of drama.  Given the number of options for the future that the children offered, a large number of branches came out.  It is important to avoid repetitions - what was played should not be put to the vote again as a possible option.  For example, if after viewing the Information and Technological Utopia, viewers confirm their choice of such a future, then we end up in a technological dystopia.  If the audience rejects the proposed option, then they must again make a choice between the proposed options - for example, the Ecological and Cosmic-Colonial future.  Very often there were situations when the hall struggled, the votes were divided almost 50% to 50% and everything was decided by a difference of several votes. <br><img src="https://habrastorage.org/webt/lk/gy/-f/lkgy-fbyvgnqylywy3w8xusrsw4.png"><br><br>  All this complexity required an appropriate structure, which is the graph. <br><br><img src="https://habrastorage.org/webt/t0/qj/-h/t0qj-hopeb95gwpmd-d1bwkv9og.png"><br><br>  What other functional requirements were there for the technical solution for the performance?  We needed: <br><br><ul><li>  The voting system, which collects votes during the voting period, shows the voting process and their results. </li><li>  Automatic selection of actions - depending on the results of the vote, the opening of a new vote, or the announcement of the beginning of the next storyline, in accordance with the logic of the graph. </li><li>  The system should communicate with viewers, offer choices and announce results in natural language. </li><li>  The system should be managed by an assistant director and display complete statistics on the progress of the vote. </li></ul><br>  So we have 600 people who must vote in less than a minute.  People should be able to cast a voice from their phone.  The mobile application option disappeared immediately, because downloading the application is an extra effort.  No one is downloading apps if you are not on Facebook or Google.  Different models and phone types require different designs, which is unrealistic in the conditions of 1.5 months and one developer.  Consequently, we need a Web application for a mobile phone. <br><br><img src="https://habrastorage.org/webt/9n/99/ld/9n99ldabxh3fue6eodrm2zjyyqu.png"><br><br>  Another Web application is required for system administration, startup, activation of states, and other technical issues. <br><br>  And finally, the most important thing is how the EMA should interact with the hall. <br><br><img src="https://habrastorage.org/webt/oa/7o/po/oa7opom5cl0oohjnwfssonv6ibu.jpeg"><br><br>  And here it is necessary to introduce the concept of "super", which was new and for me.  Super is a screen that goes down and closes the stage. <br><br>  <i>Lift curtain</i> <i><br></i>  <i>Also known as ‚Äúguillotine curtain‚Äù or ‚ÄúGerman‚Äù curtain.</i>  <i>More often used in musical theaters.</i>  <i>The curtain is a whole canvas, straight or pleated, fixed on the upper edge to the carrier beam.</i>  <i>Lifting the curtain occurs simultaneously with the lifting of the carrier beam.</i>  <i>Such a curtain requires a great height of space above the stage.</i> <i><br></i>  <i>(Wikipedia)</i> <br><br>  The curtain is reflective and allows you to display various projections, such as news, about which will be below, or the EMA screen, which displays information related to voting, its results and the choice made. <br><br><img src="https://habrastorage.org/webt/y9/pp/dk/y9ppdkyu6vnst6xgrk1-sb8d7xo.png"><br><br>  So, we have a complicated graph, a voting system and three FrontEnd systems that must interact with the audience and the administrator (an incredible assistant director Svetlana Shushina). <br><br><h3>  Decision </h3><br>  So let's start with the graph.  The data structure, in this case variants of the history of Estonia, must be stored somewhere.  Standard relational databases are not suitable for graphing for several reasons.  For us, the most essential was the flexibility of the stored data, transitions, links to audio files depending on the choice, and so on. <br><br>  The definitive choice was Neo4j, the world's leading graph database system.  7 of the top 10 technology companies in the world use it.  This is a very mature technology.  Speed, convenience and excellent community leave no other choice in this kind of solutions. <br>  We modeled the plot, built by dramatists, in the form of a graph on Neo4j.  And here is a piece of plot twists and turns, as it looks from the inside Neo4j. <br><br>  One of the advantages that Neo4j gave was flexibility and the lack of a scheme, which allowed to change the plot lines without any serious consequences, add new audio options, link various novels to each other.  This is the native representation of the graph in the native environment. <br><br><img src="https://habrastorage.org/webt/bn/md/jb/bnmdjbmv4pe-uw3mzi-llyxz8qq.png"><br><br>  In terms of the server side there were some doubts - Python vs Java.  The choice leaned in favor of Java.  The reasons are speed, less risk to break something with clear requirements and straight arms, and finally Spring Boot, which supports Neo4j out of the box. <br><br><img src="https://habrastorage.org/webt/ky/qt/h9/kyqth9gahrerihjjwygqfmuckd8.jpeg"><br><br>  The server part is implemented on Spring Boot.  In fact, the server collects votes, switches from ‚Äúsuper‚Äù to the following states when the voting is completed, accepts commands from the admin, gives statistics and so on.  Plus gives all the options FrontEnd-am, and also registers the audience. <br><br><img src="https://habrastorage.org/webt/q9/f5/gc/q9f5gc1w4naq2hgph08ega0fuxu.png"><br><br>  Now begins the most non-trivial part of the task.  The fact is that according to the idea of ‚Äã‚Äãthe component that is displayed on the "super" should talk with the audience: prepare to vote, suggest options, start and end voting, announce the results and, depending on the choice, suggest other options, or go to the choice and tell the introduction to the next scene.  Thus, the audio must be dynamic and prepared on the fly.  Given that the number of options is enormous, and the length of each segment of audio is different, synchronization is important (for example, voting should open only after the announcement ‚ÄúVoting is open‚Äù) and this was not a completely trivial task. <br><br>  The system has two control centers. <br><br>  The first is the server.  It stores the current state of the plot, collects votes, gives statistics data, controls the ability to give only one vote from one person. <br>  The second is ‚Äúsuper‚Äù, which turns the voting on and off, shows the voting process, and so on. <br><br>  "Super" is implemented on Vue.  Initially, we wanted to call audio with the Google Speech API, but we could not guarantee the absence of network delays.  Therefore, another option was chosen - we recorded the response of the Google Speech API piece by piece. <br><br>  In total, we got 55 pieces of audio.  Information about which audio files should be included depending on the current state, we stored on the graph.  Since we are dealing with JavaScript, we stringed audio files and command calls at each other, like beads.  Thus, we did not depend on the fact that audio files of various lengths, and got a fairly universal solution. <br><br>  Initially, the mobile client (web page) was written on Vue, but we got partial incompatibility on some phone models.  We tried the babel transpilers, but because of the heap of settings, the volume of the page grew, and although voting began to work on some telephones, it broke down on others.  As a result, the mobile client was rewritten on Vanilla JS. <br><br>  In essence, this was a distributed system. <br><br>  The final volume of the system (jar file) was 146 megabytes.  The telecommunication company Telia provided us with a virtual server at a symbolic price of 1 euro per month, for which she is very grateful. <br><br>  The pace of work before the premiere all accelerated.  At the premiere of the expected president.  The last bug was detected in half an hour, and there was no time for testing, so the first performances went with parallel testing locally on the machine behind the scenes, so that in case of an error it was possible to draw up a plan of action. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/fnQ2yKJOTdI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><img src="https://habrastorage.org/webt/wb/6-/ux/wb6-uxwdvwvmgyxrkke7ch4ahls.jpeg"><br><br>  Of the interesting moments, we can highlight the fact that we showed the names of the last voters on the screen and used the Vue template animation for this.  At the first submission, we were given a killer character, which broke the animation and display of Vue templates.  Subsequently, we abandoned this solution and switched to the good old jQuery. <br><br>  But a piece of voting taken during the performance. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/VCKhhiwBJps" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  The performance has received a huge amount of positive reviews in the press. <br>  <a href="https://rus.postimees.ee/6141942/budet-ne-budet-net-nichego-opasnee-budushchego">https://rus.postimees.ee/6141942/budet-ne-budet-net-nichego-opasnee-budushchego</a> <br>  <a href="https://rus.postimees.ee/6147704/nashe-zavtra-v-zerkalah-utopii-i-antiutopii">https://rus.postimees.ee/6147704/nashe-zavtra-v-zerkalah-utopii-i-antiutopii</a> <br><br><br>  At the Drama Festival in Tartu, the standing ovation lasted almost 5 minutes. <br><br>  It was an incredible adventure due to the crazy energy and dedication of the people involved in the project.  A huge bow to all the people who participated in the creation of this show. <br><br>  Director and set designer - Artyom Gareev <br>  Composer, producer of the project - Alexander Zhedelev <br>  Visual - Alena Movko <br>  Costume Designer - Rosita Raud <br>  Lighting Designer - Anton Andreiuk <br>  Choreographer - Olga Privis <br>  Playwrights: Karin Lamson, Marie-Liis Lille, Elena Chicherina and Laura Kalle <br>  Video - Nikolay Alkhazov <br>  Programming and creating applications - Alexander Tavgen, Anna Agafonova <br>  Technical solution ice shine - Aleksander Sprohgis <br>  Animation - Martin Yakush <br>  Band - Modulshtein <br>  Martin Altrov - clarinet, bass clarinet <br>  Alexey Semenikhin‚Äì work with samples, effects <br>  Alexander Zhedelev - guitar, synthesizers, ableton <br>  Vocal teacher - Anna Dydina <br>  Assistant Director Svetlana Shushina <br>  In the play are busy: <br>  Natalia Dymchenko, Alexander Zhilenko, Daniil Zandberg, Dmitry Kordas, Ekaterina Kordas, Alexander Kuchmezov, Victor Marvin, Natalia Murina, Elena Tarasenko, Eduard Tee <br>  Sergey Furmanyuk, Leonid Shevtsov, Elena Yakovleva <br>  Russian Theater Studio: Denis Volkov, Pauline Grinyova Nina Zagvozdkin Anastasia Kalyada Natasha Christensen, Anastasia Masalova Sandra Minosyan Sofia Mikhalev, Catherine Magi, Michael Pashchuk, Catherine Selyugina Christina Sorokina, Sofia Str√∂mberg, Ilya Sutta. </div><p>Source: <a href="https://habr.com/ru/post/425537/">https://habr.com/ru/post/425537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425525/index.html">Tim Berners-Lee goes on the warpath: "One small step for the web ..."</a></li>
<li><a href="../425527/index.html">Lists in Kotlin. Haskell approach</a></li>
<li><a href="../425529/index.html">Sans Forgetica: a font that allows you to memorize what you read</a></li>
<li><a href="../425531/index.html">Liquid cooling brakes. System development options</a></li>
<li><a href="../425533/index.html">How to work in the cloud: from checking the reliability of the data center to managing the virtual infrastructure</a></li>
<li><a href="../425539/index.html">Why they didn‚Äôt call me back-3, or I know where you mined last summer</a></li>
<li><a href="../425541/index.html">How quickly and without unnecessary chips to bypass the immutability of the address at the sensor HTU21</a></li>
<li><a href="../425545/index.html">You should think about the practice hours.</a></li>
<li><a href="../425547/index.html">Qt: drawing based on vector graphics</a></li>
<li><a href="../425549/index.html">Shares of Supermicro collapsed amid investigations into the introduction of Chinese spy chips into the company's servers.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>