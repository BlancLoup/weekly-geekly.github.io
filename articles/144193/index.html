<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Optimization and Generics in the CLR</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, John Skeet will describe how the simplest language constructs slow down your program and how you can speed it up. 

 As in any job th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Optimization and Generics in the CLR</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/656/d44/fe9/656d44fe9f50f0ddc0798400fc056604.jpg" align="left">  <i>In this article, John Skeet will describe how the simplest language constructs slow down your program and how you can speed it up.</i> <br><br>  As in any job that is linked to application performance, the result may vary depending on conditions (in particular, for example, a 64-bit <code>JIT</code> may work a little differently), and in most cases this should not worry you.  Despite this, a relatively small number of developers write a production code consisting of a large number of micro-optimizations.  Therefore, please do not accept this post as a call to complicate the code for the sake of irrational optimization, which supposedly speeds up your program.  Use it only where it may actually be needed. <br><br><a name="habracut"></a><br><h4>  New () constraint </h4><br>  Suppose, narpimer, we have the type <code>SteppedPattern</code> (the author discusses optimization using the example of his library, <code>Noda Time</code> , approx. Transl.), Which has a generic type <code>TBucket</code> .  I note only that it is important that before I parse the value, I want to create a new object of the <code>TBucket</code> class.  The idea is that the nuggets of information are added to the <code>Bucket</code> , where they parse.  And after the end of the operation, they add up to <code>ParseResult</code> .  So each string parsing operation requires the creation of a <code>TBucket</code> instance.  How can we create them in the case of Generic types? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We can do this by calling the type constructor without parameters.  I don‚Äôt want to think about whether the passed types have such a constructor, so I‚Äôll just add a <code>new()</code> constraint and call <code>new TBucket()</code> . <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// Somewhat simplified... internal sealed class SteppedPattern&lt;TResult, TBucket&gt; : IParsePattern&lt;TResult&gt;    where TBucket : new() {    public ParseResult&lt;TResult&gt; Parse(string value)   {       TBucket bucket = new TBucket();        // Rest of parsing goes here   } }</span></span></code> </pre><br><br>  Sumptuously!  Quite simple.  However, unfortunately, I lost sight of the fact that this single line of code will take us 75% of the time it takes to parse a line.  And this is just the creation of an empty <code>Bucket</code> - the simplest class that parses the simplest line!  When I understood it, it shocked me. <br><br><h5>  Fix it using the provider </h5><br>  Our fix will be very simple.  We just need to tell our type how to create an instance of the object.  We do this with a delegate: <br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// Somewhat simplified... internal sealed class SteppedPattern&lt;TResult, TBucket&gt; : IParsePattern&lt;TResult&gt; {    private readonly Func&lt;TBucket&gt; bucketProvider;    internal SteppedPattern(Func&lt;TBucket&gt; bucketProvider)   {        this.bucketProvider = bucketProvider;   }    public ParseResult&lt;TResult&gt; Parse(string value)   {       TBucket bucket = bucketProvider();        // Rest of parsing goes here   } }</span></span></code> </pre><br><br>  Now I can call <code>new StoppedPattern(() =&gt; new OffsetBucket())</code> , or something like that.  It also means that I can leave the costructor as internal and never take care of it again.  And, which will further simplify the writing of subsequent code, I could even use the old Bucket to parse subsequent lines. <br><br><h5>  I want signs! </h5><br>  It seems to me that not everyone wants to run the tests on their own, and more want to look at the finished results.  So I decided to give the results of the benchmarks, which I did to check only the time for creating Generic types.  In order to show how insignificant these results will be, I will indicate that the values ‚Äã‚Äãrecorded in the table are measured in milliseconds.  And during this time 100 million operations have been performed, which we will test.  Therefore, unless your code is based on a frequent reference to the operation of creating generic types, this should not make you want to rewrite the code.  However, remember this for the future. <br><br>  Anyway, our code is designed to work with four types: two classes and two structures.  And for each of them - with a small and large version (meaning, apparently, small and large versions for the <code>GAC</code> , smaller and larger than 85K), on 32-bit and 64-bit machines, for <code>CLR v2</code> , v4.  My 64-bit machine is faster by itself, so it‚Äôs necessary to compare the results inside one machine. <br><br>  <b>CLR v4: 32-bit results (ms per 100 million iterations)</b> <br><table><tbody><tr><td>  Test type </td><td>  new () constraint </td><td>  Provider delegate </td></tr><tr><td>  Small struct </td><td>  689 </td><td>  1225 </td></tr><tr><td>  Large struct </td><td>  11188 </td><td>  7273 </td></tr><tr><td>  Small class </td><td>  16307 </td><td>  1690 </td></tr><tr><td>  Large class </td><td>  17471 </td><td>  3017 </td></tr></tbody></table><br><br>  <b>CLR v4: 64-bit results (ms per 100 million iterations)</b> <br><table><tbody><tr><td>  Test type </td><td>  new () constraint </td><td>  Provider delegate </td></tr><tr><td>  Small struct </td><td>  473 </td><td>  868 </td></tr><tr><td>  Large struct </td><td>  2670 </td><td>  2396 </td></tr><tr><td>  Small class </td><td>  8366 </td><td>  1189 </td></tr><tr><td>  Large class </td><td>  8805 </td><td>  1529 </td></tr></tbody></table><br><br>  <b>CLR v2: 32-bit results (ms per 100 million iterations)</b> <br><table><tbody><tr><td>  Test type </td><td>  new () constraint </td><td>  Provider delegate </td></tr><tr><td>  Small struct </td><td>  703 </td><td>  1246 </td></tr><tr><td>  Large struct </td><td>  11411 </td><td>  7392 </td></tr><tr><td>  Small class </td><td>  143967 </td><td>  1791 </td></tr><tr><td>  Large class </td><td>  143107 </td><td>  2581 </td></tr></tbody></table><br><br>  <b>CLR v2: 64-bit results (ms per 100 million iterations)</b> <br><table><tbody><tr><td>  Test type </td><td>  new () constraint </td><td>  Provider delegate </td></tr><tr><td>  Small struct </td><td>  510 </td><td>  686 </td></tr><tr><td>  Large struct </td><td>  2334 </td><td>  1731 </td></tr><tr><td>  Small class </td><td>  81801 </td><td>  1539 </td></tr><tr><td>  Large class </td><td>  83293 </td><td>  1896 </td></tr></tbody></table><br><br>  Look at the results for the classes.  These are real results - they take about 2 minutes on my laptop when using the <code>new()</code> restriction and only a couple of seconds when using the provider.  And, which is very important to note, these results are relevant for <code>.Net 2.0</code> (meaning <code>CLR</code> , and version 2.0 is most likely written to surprise the reader with the fact that, up to <code>.Net 3.5</code> everything works on <code>CLR v2</code> , for <code>.Net 2.0</code> ). <br><br>  And, of course, you can download the <a href="">benchmark</a> to see and see how it works on your machine. <br><br><h5>  What happens under the hood? </h5><br>  As far as I understand, there is no <code>IL</code> instruction to support the <code>new()</code> constraint.  Instead, the compiler inserts instructions for calling <a href="http://msdn.microsoft.com/en-us/library/0hcyx2kd.aspx">Activator.CreateInstance [T]</a> .  Obviously, this is in any case slower than calling the delegate, since  In this case, we are trying to find a suitable constructor for us through reflection and call it.  I was really surprised that this was not optimized.  After all, the obvious solution is to use delegates and cache them for future use.  I will not raise debates on their decision, because in the end their decision does not consume additional memory that the cache will occupy. <br><br><h4>  I want more benchmarks !! </h4><br>  (taken from the second part of the article) <br><br>  Here we look at the performance of work with delegates.  And also try to speed them up. <br>  You can download the full source code for performance testing <a href="">from my site</a> .  Here, as a matter of fact, I do similar actions every time I write a test.  I create an <code>Action</code> delegate that does nothing and check that the reference to it is not null.  I only do this to avoid <code>JIT</code> optimizations.  Each test is implemented as a generic method that accepts one Generic parameter.  I call each method two times: the first time I pass the <code>Int32</code> argument, and the second, <code>String</code> .  Also included a few cases: <br><ul><li>  I use lambda expressions: Action foo = () =&gt; (); <br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Lambda&lt;T&gt;() { Action foo = () =&gt; {}; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (foo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exception(); } }</code> </pre><br></li><li>  What I would like the compiler to do for me: a separate cache that stores a delegate for instantiating a class. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> FakeCachedLambda&lt;T&gt;() { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FakeLambdaCache&lt;T&gt;.CachedAction == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { FakeLambdaCache&lt;T&gt;.CachedAction = FakeLambdaCache&lt;T&gt;.NoOp; } Action foo = FakeLambdaCache&lt;T&gt;.CachedAction; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (foo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exception(); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">FakeLambdaCache</span></span>&lt;<span class="hljs-title"><span class="hljs-title">T</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Action CachedAction; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NoOp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {} }</code> </pre><br></li><li>  What the compiler does in reality with a lambda expression: we will write a separate generic method, and we will do a <code>method group conversion</code> <br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> GenericMethodGroup&lt;T&gt;() { Action foo = NoOp&lt;T&gt;; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (foo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exception(); } }</code> </pre><br></li><li>  What the compiler could do: use a separate non- <code>generic</code> method to subsequently apply <code>method group conversion</code> <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> NonGenericMethodGroup&lt;T&gt;() { Action foo = NoOp; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (foo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exception(); } }</code> </pre><br></li><li>  Using <code>method group conversion</code> in the static non- <code>generic</code> method of the generic type; <br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> StaticMethodOnGenericType&lt;T&gt;() { Action foo = SampleGenericClass&lt;T&gt;.NoOpStatic; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (foo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exception(); } }</code> </pre><br></li><li>  Using <code>method group conversion</code> in a non-static, non-generic method of a generic type, using a generic cache class with a single field pointing to an instance of the generic class. <br>  Yes, the latter looks somewhat convoluted, however it looks much simpler: <br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> InstanceMethodOnGenericType&lt;T&gt;() { Action foo = ClassHolder&lt;T&gt;.SampleInstance.NoOpInstance; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (foo == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Exception(); } }</code> </pre></li></ul><br><br>  Also I will reveal all unsolved definitions: <br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NoOp</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {} <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> NoOp&lt;T&gt;() {} <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ClassHolder</span></span>&lt;<span class="hljs-title"><span class="hljs-title">T</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">internal</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> SampleGenericClass&lt;T&gt; SampleInstance = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SampleGenericClass&lt;T&gt;(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SampleGenericClass</span></span>&lt;<span class="hljs-title"><span class="hljs-title">T</span></span>&gt; { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NoOpStatic</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NoOpInstance</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { } }</code> </pre><br><br>  Notice that we do all this in a generic method, and call it for each type: <code>Int32</code> and <code>String</code> .  And what is important to note is that we do not capture any variables, and the generic parameter does not participate in any part of the implementation of the method body. <br><br><h5>  Test results </h5><br>  Again, the results are presented in milliseconds, on 10 million operations.  I do not want to run them on 100 million operations, because it will be very slow.  Also I will clarify that testing was performed on x64 JIT <br><br><table><tbody><tr><td>  <b>Test</b> </td><td>  <b>TestCase [int]</b> </td><td>  <b>TestCase [string]</b> </td></tr><tr><td>  Lambda expression </td><td>  180 </td><td>  29684 </td></tr><tr><td>  Generic cache class </td><td>  90 </td><td>  288 </td></tr><tr><td>  Generic method group conversion </td><td>  184 </td><td>  30017 </td></tr><tr><td>  Non-generic method group conversion </td><td>  178 </td><td>  189 </td></tr><tr><td>  Static method on generic type </td><td>  180 </td><td>  29276 </td></tr><tr><td>  Instance method on generic type </td><td>  202 </td><td>  299 </td></tr></tbody></table><br>  Yes, creating a delegate for a generic method, with a reference type as a generic parameter, is 150 times slower than for a value-type as a generic parameter.  And it seems that I was the first to know about it.  It would, of course, be very interesting to hear the answer from the <code>CLR</code> team blog ... <br><br><h4>  findings </h4><br>  I would never have found this reef if only I had any tests.  The lesson to be learned from this message is to never use the <code>new()</code> restriction if your goal is application performance and if your code relies on a large number of operations to allocate new objects in Generic types. <br><br>  One of the most difficult questions on which it is difficult to know the exact answer is what the compiler will do with a lambda expression.  In our version, the compiler doesn‚Äôt care much about performance, and we‚Äôll have to take care of it ourselves. <br><img src="http://habr.habrastorage.org/post_images/afa/19d/045/afa19d045b2bce238895a5f2856f9174.gif" alt="image"></div><p>Source: <a href="https://habr.com/ru/post/144193/">https://habr.com/ru/post/144193/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../144187/index.html">PHDays 2012 Master Classes: From Wi-Fi Network Protection to SAP and Web 2.0 Security</a></li>
<li><a href="../144188/index.html">About startups</a></li>
<li><a href="../144189/index.html">Analysis of the length of string data in web development: paranoia or necessity?</a></li>
<li><a href="../144190/index.html">Mailings on segments on the basis of MailChimp</a></li>
<li><a href="../144192/index.html">Optimizing SQLite with NSCalendar</a></li>
<li><a href="../144195/index.html">Intel Architecture Code Analyzer 2.0.1</a></li>
<li><a href="../144196/index.html">CAT - Processor Cache Size Management</a></li>
<li><a href="../144197/index.html">Indexing AJAX sites by the Yandex search robot</a></li>
<li><a href="../144198/index.html">How I walked behind the backtrace</a></li>
<li><a href="../144199/index.html">Today, YouTube is seven years old. And you set the record again</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>