<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sorting a million 32-bit ints in 2 megabytes of memory on Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="My translation of the article by Guido van Rossum: 

 I was jokingly asked if I could sort out a million 32-bit ints in 2 megabytes of memory on Pytho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sorting a million 32-bit ints in 2 megabytes of memory on Python</h1><div class="post__text post__text-html js-mediator-article">  My translation of the <a href="http://neopythonic.blogspot.com/2008/10/sorting-million-32-bit-integers-in-2mb.html">article by</a> Guido van Rossum: <br><br>  I was jokingly asked if I could sort out a million 32-bit ints in 2 megabytes of memory on Python.  While thinking, it occurred to me to use an I / O mechanism using buffer memory. <br><br>  In general, this is a comic question - the data alone will take 4 megabytes, subject to a binary representation!  True, you can go to the trick - take a file containing a million 32-bit int'ov.  How to sort them using the minimum amount of memory?  It must be some sort of merge sort, in which small pieces of data are sorted and written to a temporary file, after which the temporary files are merged to produce the final result. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Here is my solution: <br><a name="habracut"></a><br><blockquote><code><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> <font color="black">Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> <ol> <li> <code><font color="black"><font color="#696969"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML #!/usr/bin/env python3.0 <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li></li><li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: break <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li></li><li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><font color="#0000ff"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: break f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li></li><li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2677/s"></a> <a href="http://s-c.me/2677/h"></a> Copy Source | Copy HTML <font color="#696969">#!/usr/bin/env python3.0</font> <font color="#0000ff">import</font> sys, array, tempfile, heapq <font color="#0000ff">assert</font> <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ).itemsize == <font color="#008000">4</font> <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring(f.read( <font color="#008000">4000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: <font color="#0000ff">yield</font> x iters = [] <font color="#0000ff">while</font> True: a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) a.fromstring( <b>sys</b> .stdin.buffer.read( <font color="#008000">40000</font> )) <font color="#0000ff">if not</font> a: <font color="#0000ff">break</font> f = <b>tempfile</b> .TemporaryFile() <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)).tofile(f) f.seek( <font color="#008000">0</font> ) iters.append( <font color="#cc6633">intsfromfile</font> (f)) a = <b>array</b> . <b>array</b> ( <font color="#008000">'i'</font> ) <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge(*iters): a.append(x) <font color="#0000ff">if</font> <b>len</b> (a) &gt;= <font color="#008000">1000</font> : a.tofile( <b>sys</b> .stdout.buffer) <font color="#0000ff">del</font> a[:] <font color="#0000ff">if</font> a: a.tofile( <b>sys</b> .stdout.buffer)</font></code> </li> </ol></blockquote><br>  On my 3-year-old Linux-based personal, the execution took 5.4 seconds when reading data from an input file containing exactly a million random 32-bit ints.  This is not so bad, considering that when reading data directly from memory, sorting takes 2 seconds: <br><br><blockquote> <code><a href="http://s-c.me/2678/s"></a> <a href="http://s-c.me/2678/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#696969">#! / usr / bin / env python3.0</font> </li><li>  <font color="#0000ff">import</font> sys, array </li><li>  a = <b>array</b> .  <b>array</b> ( <font color="#008000">'i'</font> , <b>sys</b> .stdin.buffer.read ()) </li><li>  a = <b>list</b> (a) </li><li>  a.sort () </li><li>  a = <b>array</b> .  <b>array</b> ( <font color="#008000">'i'</font> , a) </li><li>  a.tofile ( <b>sys</b> .stdout.buffer) </li></ol></blockquote><br>  Let's return to our sorting.  The first 3 lines are obvious: <br><br><blockquote> <code><a href="http://s-c.me/2679/s"></a> <a href="http://s-c.me/2679/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#696969">#! / usr / bin / env python3.0</font> </li><li>  <font color="#0000ff">import</font> sys, array, tempfile, heapq </li><li>  <font color="#0000ff">assert</font> <b>array</b> .  <b>array</b> ( <font color="#008000">'i'</font> ) .itemsize == <font color="#008000">4</font> </li></ol></blockquote><br>  The first line indicates that we are using Python 3.0.  The second line imports the required modules.  The third line causes an interrupt on 64-bit systems where int is not 32-bit ‚Äî I was not tasked with writing portable code. <br><br>  Then we declared a function that reads the ints from the file: <br><br><blockquote> <code><a href="http://s-c.me/2680/s"></a> <a href="http://s-c.me/2680/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#0000ff">def</font> <font color="#cc6633">intsfromfile</font> (f): </li><li>  <font color="#0000ff">while</font> true: </li><li>  a = <b>array</b> .  <b>array</b> ( <font color="#008000">'i'</font> ) </li><li>  a.fromstring (f.read ( <font color="#008000">4000</font> )) </li><li>  <font color="#0000ff">if not</font> a: </li><li>  <font color="#0000ff">break</font> </li><li>  <font color="#0000ff">for</font> x <font color="#0000ff">in</font> a: </li><li>  <font color="#0000ff">yield</font> x </li></ol></blockquote><br>  This is the very place where the optimization of the algorithm takes place: it reads up to 1000 ints at a time, giving them out one by one.  At first, I did not use buffering - the function simply read 4 bytes from the file, converted it to an integer, and returned it.  But it worked 4 times slower!  Please note that we cannot use <code>a.fromfile(f, 1000)</code> , because the <code>fromfile()</code> method will return an error if there is not enough data in the file, but I wanted the code to adapt to any number of ints in the file. <br><br>  Next comes the input cycle.  It cyclically reads a piece of 10'000 ints from the input file, sorts them into memory and writes it into a temporary file.  Then we will add an iterator for the temporary file to the list of iterators we need in the final stage using the intsfromfile () function described above. <br><br><blockquote> <code><a href="http://s-c.me/2681/s"></a> <a href="http://s-c.me/2681/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  iters = [] </li><li>  <font color="#0000ff">while</font> true: </li><li>  a = <b>array</b> .  <b>array</b> ( <font color="#008000">'i'</font> ) </li><li>  a.fromstring ( <b>sys</b> .stdin.buffer.read ( <font color="#008000">40000</font> )) </li><li>  <font color="#0000ff">if not</font> a: </li><li>  <font color="#0000ff">break</font> </li><li>  f = <b>tempfile</b> .TemporaryFile () </li><li>  <b>array</b> .  <b>array</b> ( <font color="#008000">'i'</font> , <b>sorted</b> (a)). tofile (f) </li><li>  f.seek ( <font color="#008000">0</font> ) </li><li>  iters.append (intsfromfile (f)) </li></ol></blockquote><br>  Accordingly, 100 temporary files of 10,000 values ‚Äã‚Äãeach will be created for the input million ints. <br><br>  Finally, we merge all these files (each already sorted) together.  The heapq module contains a remarkable function for solving this problem: <code>heapq.merge(iter1, iter2, ... )</code> , which returns an iterator that passes input parameters in a sequence in which each input parameter itself passes its value in the correct order (as in this case). <br><br><blockquote> <code><a href="http://s-c.me/2682/s"></a> <a href="http://s-c.me/2682/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  a = <b>array</b> .  <b>array</b> ( <font color="#008000">'i'</font> ) </li><li>  <font color="#0000ff">for</font> x <font color="#0000ff">in</font> <b>heapq</b> .merge (* iters): </li><li>  a.append (x) </li><li>  <font color="#0000ff">if</font> <b>len</b> (a)&gt; = <font color="#008000">1000</font> : </li><li>  a.tofile ( <b>sys</b> .stdout.buffer) </li><li>  <font color="#0000ff">del</font> a [:] </li><li>  <font color="#0000ff">if</font> a: </li><li>  a.tofile ( <b>sys</b> .stdout.buffer) </li></ol></blockquote><br>  This is another case in which buffered input / output becomes necessary: ‚Äã‚Äãwriting each individual value to a file, as soon as it becomes available, reduces the rate of operation of the algorithm by half.  Using input and output buffering, we managed to increase the execution speed by 10 times! </div><p>Source: <a href="https://habr.com/ru/post/65503/">https://habr.com/ru/post/65503/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../65493/index.html">Habr's update</a></li>
<li><a href="../65495/index.html">Tree Management Module Nested Sets</a></li>
<li><a href="../65498/index.html">Overview of ways to withdraw electronic money in Russia</a></li>
<li><a href="../65499/index.html">ASUS Eee PC 1004DN - sales of the first netbook with a DVD-drive began</a></li>
<li><a href="../65501/index.html">Twitter birds</a></li>
<li><a href="../65504/index.html">Transformer Headset</a></li>
<li><a href="../65511/index.html">WRIT - you message?</a></li>
<li><a href="../65512/index.html">What is dNaNo?</a></li>
<li><a href="../65513/index.html">CyberHelper - not yet Skynet, but already close</a></li>
<li><a href="../65514/index.html">WD Scorpio Blue the first hard drive for mobile devices with a capacity of 1 TB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>