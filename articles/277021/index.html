<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We disassemble decorators ES2016</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many of us are probably already tired of this hype around the latest ECMAScript standards. ES6, ES7 ECMAScript Harmony ... It seems that everyone has ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We disassemble decorators ES2016</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/97d/a39/b01/97da39b014f44e10a2b48cd8fffc368b.png"><br><br>  Many of us are probably already tired of this hype around the latest ECMAScript standards.  ES6, ES7 ECMAScript Harmony ... It seems that everyone has their own opinion on how to properly name JS.  But even despite all this HYIP, what is happening with JavaScript now is the most remarkable thing that has happened to it in the last 5 years at least.  The language lives, develops, the community constantly offers new features and syntactic constructions.  One of these new designs, certainly worthy of attention, are decorators.  Having started searching for materials on this topic, I realized that there is almost nothing about decorators on the Russian-language Internet.  <a href="https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841">Back</a> in July 2015, Addy Osmani presented an excellent article <a href="https://medium.com/google-developers/exploring-es7-decorators-76ecb65fb841">Exploring ES2016 Decorators</a> on Medium.  In this regard, I would like to present to your attention the translation of this article into Russian and post it here. <br><a name="habracut"></a><br>  <a href="https://jakearchibald.com/2014/iterators-gonna-iterate/">Iterators</a> , <a href="http://www.2ality.com/2015/03/es6-generators.html">generators</a> , <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Array_comprehensions">list inclusion</a> ... With each innovation, the differences between JavaScript and Python are getting smaller.  Today we will talk about one more ‚Äúpitonopodopnom‚Äù proposal for the ECMAScript 2016 standard (aka ES7) - <a href="https://github.com/wycats/javascript-decorators">Decorators</a> from Yehuda Katz. <br><cut><br><h2>  Pattern "Decorator" </h2><br>  Before analyzing the scope and use of decorators for ES2016, let's still find out if there is something similar in other languages?  For example in Python.  For him, decorators are simply syntactic sugar, which makes it possible to simplify calling <a href="https://en.wikipedia.org/wiki/Higher-order_function">higher-order functions</a> .  In other words, <i>it is just a function that takes another function, changes its behavior, while not making changes to its source code</i> .  We could imagine the simplest decorator as shown below: <br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@mydecorator def myfunc(): pass</span></span></code> </pre> <br>  The expression at the very top of the example ("@mydecorator") is a decorator, the syntax of which will look the same in the ES2016 (ES7) standard, so you have already mastered some of the necessary material. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The "@" symbol tells the parser that we are using a decorator, while <i>mydecorator</i> is just the name of some function.  Our decorator from the example takes one parameter (namely, the decorated function <i>myfunc</i> ) and returns exactly the same function, but with the modified functionality. <br><br>  Decorators are very useful if you want to add additional behavior to a function without changing its source code.  For example, in order to provide support for memoization, access levels, authentication, <a href="https://en.wikipedia.org/wiki/Instrumentation_(computer_programming)">instrumentation</a> , logging ... there are really a lot of use cases, the list goes on and on. <br><br><h2>  Decorators in ES5 and ES2015 (aka ES6) </h2><br>  Implementing a decorator in ES5 using the imperative approach (that is, using pure functions) is a rather trivial task.  But due to the fact that ES2015 has native support for classes, we need something more flexible than pure functions to provide the same goals. <br><br>  ECMAScript‚Äôs proposal by Yehuda Katz to add decorators to the next standard provides for annotating and modifying object literals, classes, and their properties during code design, using a declarative rather than an imperative approach. <br><br>  Let's take a look at some ES2016 decorators with a real example! <br><br><h2>  ES2016 decorators in action </h2><br>  So, remember what we learned from Python and try to transfer our knowledge to the field of JavaScript.  As I said, the syntax for ES7 will be no different, the basic idea, too.  Thus, the decorator in ES2016 is <i>some expression that can take a target object, a name, and a descriptor as arguments</i> .  Then you simply ‚Äúapply‚Äù it by adding the ‚Äú@‚Äù symbol at the beginning and place it right in front of the part of the code that you are going to decorate.  Today decorators can be defined either to define a class or to define a property. <br><br><h3>  Decorating property </h3><br>  Let's look at the class: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cat</span></span></span><span class="hljs-class"> </span></span>{ meow() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.name}</span></span></span><span class="hljs-string"> says Meow!`</span></span>} }</code> </pre><br>  Adding this method to the Cat class prototype gives us something like this: <br><br><pre> <code class="javascript hljs"> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(Cat.prototype, <span class="hljs-string"><span class="hljs-string">'meow'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: specifiedFunction, <span class="hljs-attr"><span class="hljs-attr">enumerable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">configurable</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">writable</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> });</code> </pre><br>  Thus, the method allowing the cat to give a vote is hung on the class prototype.  At the same time, this method does not participate in the enumeration of the properties of an object, it can also be modified and is available for writing.  But imagine that you would like to explicitly ban changes to the implementation of this method.  For example, we could do this with the help of the @readonly decorator, which, as the name implies, would give access to this read-only method and prohibit any overrides: <br><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readonly</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">target, key, descriptor</span></span></span><span class="hljs-function">) </span></span>{ descriptor.writable = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> descriptor; }</code> </pre><br>  And then add the created decorator to the method, as shown below: <br><br><pre> <code class="javascript hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cat</span></span></span><span class="hljs-class"> </span></span>{ @readonly meow() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.name}</span></span></span><span class="hljs-string"> says Meow!`</span></span>} }</code> </pre><br>  The decorator can also take parameters; in the end, the decorator is just an expression, so both "@readonly" and "@something (parameter)" should work. <br><br>  Now, before hanging the method on the Cat class prototype, the engine will start the decorator: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> descriptor = { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: specifiedFunction, <span class="hljs-attr"><span class="hljs-attr">enumerable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">configurable</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">writable</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }; <span class="hljs-comment"><span class="hljs-comment">//     ,   "Object.defineProperty", //       ,  // "Object.defineProperty"   descriptor = readonly(Cat.prototype, 'meow', descriptor) || descriptor; Object.defineProperty(Cat.prototype, 'meow', descriptor);</span></span></code> </pre><br>  Thus, the decorated meow method becomes read-only.  We can check this behavior: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> garfield = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Cat(); garfield.meow = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'I want lasagne!'</span></span>); }; <span class="hljs-comment"><span class="hljs-comment">// !        .</span></span></code> </pre><br>  Interesting, isn't it?  Very soon we will consider decorating classes, but before that let's talk about the support of the decorators from the community.  Despite its immaturity, entire libraries of decorators are starting to appear (for example, <a href="">https://github.com/jayphelps/core-decorators.js</a> from Jay Phelps).  Just as we wrote our decorator, you can take exactly the same, but implemented in the library: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { readonly } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'core-decorators'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Meal</span></span></span><span class="hljs-class"> </span></span>{ @readonly entree = <span class="hljs-string"><span class="hljs-string">'steak'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> meal = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Meal(); meal.entree = <span class="hljs-string"><span class="hljs-string">'salmon'</span></span>; <span class="hljs-comment"><span class="hljs-comment">// !</span></span></code> </pre><br>  The library is also good because it implements the "@deprecate" decorator, which is quite useful when you change the API, but you need to keep outdated methods for backward compatibility.  Here is what the documentation says about this decorator: <br><blockquote>  The decorator calls console.warn (), and displays a warning message.  This message can be overridden.  Also supports adding links for further reference. </blockquote><br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { deprecate } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'core-decorators'</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Person</span></span></span><span class="hljs-class"> </span></span>{ @deprecate facepalm() {} @deprecate(<span class="hljs-string"><span class="hljs-string">'We are stopped facepalming.'</span></span>) facepalmHard() {} @deprecate(<span class="hljs-string"><span class="hljs-string">'We are stopped facepalming'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'http://knowyourmeme.com/memes/facepalm'</span></span> }) facepalmHarder() {} } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> captainPicard = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Person(); captainPicard.facepalm(); <span class="hljs-comment"><span class="hljs-comment">// DEPRECATION Person#facepalm will be removed in future versions captainPicard.facepalmHard(); // DEPRECATION Person#facepalmHard: We are stopped facepalming. captainPicard.facepalmHarder(); // DEPRECATION Person#facepalmHarder: We are stopped facepalming. // // See http://knowyourmemes.com/memes/facepalm for more details //</span></span></code> </pre><br><h3>  Decorating class </h3><br>  Next, let's look at decorating classes.  According to the proposed specification, the decorator accepts the target constructor.  For example, we could create a <a href="https://habrahabr.ru/users/superhero/" class="user_link">superhero</a> decorator for the MySuperHero class: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">superhero</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">target</span></span></span><span class="hljs-function">) </span></span>{ target.isSuperhero = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; target.power = <span class="hljs-string"><span class="hljs-string">'flight'</span></span>; } @superhero <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MySuperHero</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(MySuperHero.isSuperhero); <span class="hljs-comment"><span class="hljs-comment">// true</span></span></code> </pre><br>  We can go even further and allow our decorator to take parameters, turning it into a factory method: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">superhero</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">isSuperhero</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">target</span></span></span><span class="hljs-function">) </span></span>{ target.isSuperhero = isSuperHero; target.power = <span class="hljs-string"><span class="hljs-string">'flight'</span></span>; } } @superhero(<span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MySuperHero</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(MySuperHero.isSuperhero); <span class="hljs-comment"><span class="hljs-comment">// false</span></span></code> </pre><br>  So, decorators in ES2016 can work with classes and property descriptors.  And, as we have already found out, the property descriptor and the target object are automatically transferred to them.  Having access to a property descriptor, a decorator can do such things as: adding a getter to a property, adding behavior that might look cumbersome without bringing it into the decorator, for example, automatically changing the context of a function call to the current entity when you first try to access the property. <br><br><h3>  ES2016 decorators and mixins </h3><br>  I thoroughly read the article by Reg <a href="http://raganwald.com/2015/06/26/decorators-in-es7.html">Breithwaite Decorators ES2016 as mixins</a> and its previous <a href="http://raganwald.com/2015/06/17/functional-mixins.html">Functional Mixins,</a> and made a rather interesting use of decorators from there.  His proposal is that we introduce some kind of helper, which adds the behavior to the prototype or an object of a particular class.  At the same time, a functional mixin that mixes the behavior of an object with a class prototype looks like this: <br><br><pre> <code class="hljs javascript"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mixin</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">behaviour, sharedBehaviour = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> instanceKeys = <span class="hljs-built_in"><span class="hljs-built_in">Reflect</span></span>.ownKeys(behaviour); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sharedKeys = <span class="hljs-built_in"><span class="hljs-built_in">Reflect</span></span>.ownKeys(sharedBehaviour); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> typeTag = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">'isa'</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_mixin</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">clazz</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> property <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> instanceKeys) { <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(clazz.prototype, property, { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: behaviour[property] }); } <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(clazz.prototype, typeTag, { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> clazz; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> property <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> sharedKeys) { <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(_mixin, property, { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: sharedBehaviour[property], <span class="hljs-attr"><span class="hljs-attr">enumerable</span></span>: sharedBehaviour.propertyIsEnumerable(property) }); } <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(_mixin, <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.hasInstance, { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i</span></span></span><span class="hljs-function">) =&gt;</span></span> !!i[typeTag] }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mixin; }</code> </pre><br>  Fine.  Now we can define several mixins and try to decorate a class with them.  Let's imagine that we have the ‚ÄúComicBookCharacter‚Äù class: <br><br><pre> <code class="hljs kotlin"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ComicBookCharacter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(first, last) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstName = first; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lastName = last; } realName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstName + <span class="hljs-string"><span class="hljs-string">' '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lastName; } }</code> </pre><br>  Maybe this will be the most boring comic book hero, but we can save the situation by declaring several mixins that add ‚Äúsuper power‚Äù to our hero and a ‚Äúmulti-purpose Bateman belt‚Äù to our hero.  To do this, let's use the mixin factory announced above: <br><br><pre> <code class="hljs kotlin"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SuperPowers = mixin({ addPower(name) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.powers().push(name); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }, powers() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._powers_pocessed || (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._powers_pocessed = []); } }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> UtilityBelt = mixin({ addToBelt(name) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.utilities().push(name); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }, utilties() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._utility_items || (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._utility_items = []); } });</code> </pre><br>  Now we can use the @ -syntax with the names of our mixins in order to decorate the ‚ÄúComicBookCharacter‚Äù class declared above, adding to it the desired behavior.  Please note we can define several decoration instructions together: <br><br><pre> <code class="hljs kotlin"> <span class="hljs-meta"><span class="hljs-meta">@SuperPowers</span></span> <span class="hljs-meta"><span class="hljs-meta">@UtilityBelt</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ComicBookCharacter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(first, last) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstName = first; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lastName = last; } realName() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.firstName + <span class="hljs-string"><span class="hljs-string">' '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lastName; } }</code> </pre><br>  Now we can create our own Batman: <br><br><pre> <code class="hljs pgsql"> const batman = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ComicBookCharacter(<span class="hljs-string"><span class="hljs-string">'Bruce'</span></span>, <span class="hljs-string"><span class="hljs-string">'Wayne'</span></span>); console.log(batman.realName()); // Bruce Wayne batman .addToBelt(<span class="hljs-string"><span class="hljs-string">'batarang'</span></span>) .addToBelt(<span class="hljs-string"><span class="hljs-string">'cape'</span></span>); console.log(batman.utilities()); // [<span class="hljs-string"><span class="hljs-string">'batarang'</span></span>, <span class="hljs-string"><span class="hljs-string">'cape'</span></span>] batman .addPower(<span class="hljs-string"><span class="hljs-string">'detective'</span></span>) .addPower(<span class="hljs-string"><span class="hljs-string">'voice sounds like Gollum has asthma'</span></span>); console.log(batman.powers()); // [<span class="hljs-string"><span class="hljs-string">'detective'</span></span>, <span class="hljs-string"><span class="hljs-string">'voice sounds like Gollum has asthma'</span></span>]</code> </pre><br>  As you can see, decorators of this kind are relatively compact and I can easily use them as an alternative for calling functions or as helper for higher order components. <br><br><h3>  Making Babel understand decorators </h3><br>  Decorators (at the time of writing) are still not approved and are only proposed for addition to the standard.  But due to the fact that Babel supports the transplantation of experimental constructions, we can make friends with the decorators. <br><br>  If you use Babel CLI, you can enable decorators like this: <br><pre> <code class="hljs swift"> babel --<span class="hljs-keyword"><span class="hljs-keyword">optional</span></span> es7.decorators</code> </pre><br>  Or you can enable decorator support with the help of a transformer: <br><br><pre> <code class="hljs pgsql"> babel.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>(<span class="hljs-string"><span class="hljs-string">'code'</span></span>, { optional: [<span class="hljs-string"><span class="hljs-string">'es7.decorators'</span></span>] });</code> </pre><br>  Well, in the end, you can play with them in the Babel REPL (for this, enable support for experimental constructions). <br><br><h3>  Why don't you use decorators in your projects yet? </h3><br>  In the short term, decorators in ES2016 are quite useful for declarative decoration, annotation, type checking, and mixing behavior with classes from ES2015.  In the long run, they can serve as a very useful tool for static analysis (which can trigger the creation of tools for type checking during compilation or autocompletion). <br><br>  They are no different from the decorators of the classical OOP, where an object can be decorated with a certain behavior using a pattern, either statically or dynamically without affecting other objects of the same class.  Nevertheless, I consider them a nice addition.  The semantics of the decorators for the classes still look damp, but it is worth looking at the Yehuda repository from time to time and checking for updates. <br><br><h3>  useful links </h3><br>  <a href="https://github.com/wycats/javascript-decorators">https://github.com/wycats/javascript-decorators</a> <br>  <a href="https://github.com/jayphelps/core-decorators.js‚Äù&gt;">https://github.com/jayphelps/core-decorators.js"&gt;https://github.com/jayphelps/core-decorators.js</a> <br>  <a href="http://blog.developsuperpowers.com/eli5-ecmascript-7-decorators/">http://blog.developsuperpowers.com/eli5-ecmascript-7-decorators/</a> <br>  <a href="http://elmasse.github.io/js/decorators-bindings-es7.html">http://elmasse.github.io/js/decorators-bindings-es7.html</a> <br>  <a href="http://raganwald.com/2015/06/26/decorators-in-es7.html">http://raganwald.com/2015/06/26/decorators-in-es7.htmlince&gt;http://raganwald.com/2015/06/26/decorators-in-es7.html</a> </cut></div><p>Source: <a href="https://habr.com/ru/post/277021/">https://habr.com/ru/post/277021/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277011/index.html">CEPH Cluster: Chronology of work on the upgrade of our file storage to a new architecture (56Gb / s IB)</a></li>
<li><a href="../277013/index.html">Video conferencing Mind - the best choice for business</a></li>
<li><a href="../277015/index.html">Device Usage: Opportunities for Developers in 2016 and Beyond</a></li>
<li><a href="../277017/index.html">Hit Parade of the City Hackathon Projects</a></li>
<li><a href="../277019/index.html">Technosphere Mail.Ru - 2 years</a></li>
<li><a href="../277023/index.html">The book "Head First. Programming for Android ¬ª</a></li>
<li><a href="../277025/index.html">From complex to simple: we start a virtual server Windows / Linux</a></li>
<li><a href="../277029/index.html">Log server Elasticsearch + Logstash + Kibana4 + Beats (windows / linux). Installation and Setup</a></li>
<li><a href="../277031/index.html">MyHTML - HTML parser on the "bare" C with POSIX Threads support</a></li>
<li><a href="../277033/index.html">Generators in ES6 and asynchronous code in a new way</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>