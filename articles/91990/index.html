<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>8 useful tricks for WordPress database</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We must pay tribute to WordPress. This is really an amazing system for building blogs and even full-fledged sites. Nice and logical admin (especially ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>8 useful tricks for WordPress database</h1><div class="post__text post__text-html js-mediator-article">  We must pay tribute to WordPress.  This is really an amazing system for building blogs and even full-fledged sites.  Nice and logical admin (especially in versions 2.7 and above, tasty), a considerable number of fairly high-quality templates ... and in general everything is very nice and relatively simple.  I want to pay tribute to this system and do something useful for its users. <br><br>  Over the past 10 years, MySQL has become incredibly popular on the web.  Each WordPress blog is based on the MySQL database, which stores all your posts, settings, comments, and more. <br><br>  Although plug-ins and even so-called hacks (I prefer ‚Äúcode inserts‚Äù) can solve some problems, sometimes you have no choice but to enter SQL queries in phpMyAdmin or directly into the database via SSH.  So let's take a look at <strong>8 useful tricks for a WordPress database</strong> . <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  1. Creating a backup of your database </h3><br>  <strong>The problem</strong> .  Although the tips in this article have been verified, you should not put them into practice before creating a backup of your MySQL database (who knows ...) <br><br>  <strong>The decision</strong> .  To manually back up your database, follow these simple steps: <br><br>  1. First you need to log in to phpMyAdmin and select your WordPress database there. <br><br>  2. Click on the ‚ÄúExport‚Äù button, which is in the horizontal menu. <br><br>  3. Select a data compression method (I personally use gzip) and click on the ‚ÄúExecute‚Äù button. <br><br>  4. Your browser will ask if you want to download the backup.  Of course, tell him solid Yes and save the file somewhere on your computer. <br><br>  <strong>Note</strong>  Please note that creating backups of the WordPress database is much more convenient to do with the help of the special plug-in <a href="http://wordpress.org/extend/plugins/wp-db-backup/">WP-DB-Backup</a> .  WordPress users can not hesitate to install this plugin right now if for some reason they still have not done so. <br><br><h3>  2. Batch deletion of revisions of records </h3><br>  <strong>The problem</strong> .  Post revisions are a new feature of WordPress since version 2.6.  It can be very useful, and it can also increase the size of the MySQL database.  Of course, you can manually delete post revisions from the admin panel.  But it is very long and tedious.  There is a better solution. <br><br>  <strong>The decision</strong> .  And the solution to the problem is very simple: we package, I mean everything at one stroke, delete post revisions using a simple SQL query.  The result can be amazing if you have a lot of records.  Your database can lose weight by half! <br><br>  1. You need to log in to phpMyAdmin and select your WordPress database there. <br><br>  2. Then click on the ‚ÄúSQL‚Äù button.  A window will appear in which you must insert the following query: <br><br> <code>DELETE FROM wp_posts WHERE post_type = "revision";</code> <br> <br>  3. That's it!  Depending on the number of entries, you saved a lot of precious time and cleaned the base. <br><br>  <strong>Explanation of the code</strong> .  In the <em>wp_posts</em> table <em>there</em> is a field called <em>post_type</em> .  This field can have multiple values, such as <em>post</em> , <em>page,</em> or <em>revision</em> .  When we want to get rid of the revision of the records, we simply run the command so that it deletes all the values ‚Äã‚Äãin the <em>wp_posts</em> table, in the field of which the <em>post_type</em> is the <em>revision</em> value.  Here is how. <br><br><h3>  3. Remove 5000 spam comments in one second. </h3><br>  <strong>The problem</strong> .  True story: a friend of mine recently opened his own blog and started actively promoting it all over the internet.  After a few weeks of intensive work, he spent a couple of days on vacation, without a network. <br><br>  When he returned home and looked at his blog ... he saw more than 5,000 posts that were awaiting moderation!  How to be? <br><br>  <strong>The decision</strong> .  Fortunately, my friend told me about his problem with fucking spammers.  He had already spent 45 minutes manually checking and deleting spam, as I showed him a very useful trick: <br><br>  1. Login to phpMyAdmin and select your WordPress database there. <br><br>  2. Click on the ‚ÄúSQL‚Äù button.  A window will appear in which you must insert the following query: <br><br> <code>DELETE from wp_comments WHERE comment_approved = '0';</code> <br> <br>  3. And forgive spammers!  Enjoying cleanliness and comfort ... <br><br>  <strong>Explanation</strong> .  The <em>wp_comments</em> table contains the <em>comment_approved</em> field, which contains a boolean value (1 or 0).  Approved comments have a value of 1, and comments that are pending moderation are 0. The above command simply deletes unapproved comments.  It's simple. <br><br>  <strong>But be careful!</strong>  Although this solution is awesomely convenient for automatically deleting millions of spam comments, it also deletes normal unapproved comments.  If you are still not using a plugin like <a href="http://www.akismet.com/">Akismet</a> , then it's time to start to prevent blog spamming. <br><br><h3>  4. How to change a record attribute </h3><br>  <strong>The problem</strong> .  When you install WordPress, a default admin account is created.  Some bloggers make the mistake of using this account to create their posts until they realize that this is somehow impersonal. <br><br>  <strong>The decision</strong> .  Modification of the attribute of the author for each entry takes a lot of time.  Fortunately, SQL can help us: <br><br>  1. Login to phpMyAdmin and select your WordPress database there. <br><br>  2. First we need to determine the correct user IDs.  So click on the ‚ÄúSQL‚Äù button.  A window will appear in which you must insert the following query: <br><br> <code>SELECT ID, display_name FROM wp_users;</code> <br> <br>  3. phpMyAdmin will display a list of ‚ÄúIT members‚Äù that are associated with WordPress users.  By the way, NEW_AUTHOR_ID is the ID of the most recently created author, and OLD_AUTHOR_ID is the ID of the original admin account. <br><br>  4. After you have defined the aydshniki NEW_AUTHOR_ID and OLD_AUTHOR_ID, run the following command: <br><br> <code>UPDATE wp_posts SET post_author=NEW_AUTHOR_ID WHERE post_author=OLD_AUTHOR_ID;</code> <br> <br>  5. That's all.  All entries that were associated with the admin account will now be the property of the user you selected. <br><br><h3>  5. Reset password </h3><br>  <strong>The problem</strong> .  To protect their blogs, people often choose strong passwords, such as 7 * KoF5i8_.  This, of course, is commendable, but everyone has heard many stories about how admins forget their passwords :) <br><br>  <strong>The decision</strong> .  When you forget your password, WordPress can send you a link to reset it by email.  But if you do not have access to the soap that is specified in the WordPress database, or if you think that the issue can be solved in some other way, then here‚Äôs a way of ‚Äúhacking‚Äù: <br><br>  1. Login to phpMyAdmin, select your WordPress database there and open the SQL window. <br><br>  2. Enter the following command (taking into account that your login was ‚Äúadmin‚Äù): <br><br> <code>UPDATE 'wp_users' SET 'user_pass' = MD5('PASSWORD') WHERE 'wp_users'.'user_login' = 'admin' LIMIT 1;</code> <br> <br>  3. Well, actually, that's all.  Your password will successfully update to the one you specified in the place marked as ‚ÄúPASSWORD‚Äù. <br><br>  <strong>Explanation</strong> .  User passwords are stored in the <em>wp_users table</em> .  Of course, MD5 hash is used to protect them from viewing. <br><br>  We sent the ‚ÄúUPDATE‚Äù SQL query and used the MySQL built-in function - MD5 () to convert our password to MD5 and update it.  Using "WHERE" ensures that we have updated only the administrator password.  <strong>The same query, but without using the ‚ÄúWHERE‚Äù parameter, will update all passwords in the database!</strong> <br><br><h3>  6. Change your domain name </h3><br>  <strong>The problem</strong> .  Although it is not recommended, but you may at some point want to change the domain name of your blog and at the same time save all its data.  Since WordPress stores the domain name in the database, you will have to change the base a little to link your new domain and WordPress blog. <br><br>  <strong>The decision</strong> . <br><br>  1. As you might have guessed: log in to phpMyAdmin, select your WordPress database there and open the SQL window <br><br>  2. To change the URL of the Wordpress press the following command: <br><br> <code>UPDATE wp_options SET option_value = replace(option_value, 'http://www.oldsite.com', 'http://www.newsite.com') WHERE option_name = 'home' OR option_name = 'siteurl';</code> <br> <br>  3. Then we need to replace the relative URL (GUID) for each entry.  The following command will do this for you: <br><br> <code>UPDATE wp_posts SET guid = replace(guid, 'http://www.oldsite.com','http://www.newsite.com');</code> <br> <br>  4. This is almost the end.  It remains only to find and replace absolute URLs in the wp_posts table for a conclusive final: <br><br> <code>UPDATE wp_posts SET post_content = replace(post_content, 'http://www.oldsite.com', 'http://www.newsite.com');</code> <br> <br>  5. And this is the end.  You can log in to the admin area of ‚Äã‚Äãyour blog using the new URL. <br><br><h3>  7. Display the number of SQL queries of your blog. </h3><br>  <strong>The problem</strong> .  When you try to optimize your blog's loading time, knowing the number of database queries helps a lot.  In order to reduce the number of requests, the first thing you need to know how many requests occur on any page. <br><br>  <strong>Decision.</strong>  Trick: we don‚Äôt need to go into phpMyAdmin :) You just need to open the footer.php file for editing (it definitely is in your theme) and add these lines of code there: <br><br> <code>&lt;?php if (is_user_logged_in()) { ?&gt; <br> &lt;?php echo get_num_queries(); ?&gt;   &lt;?php timer_stop(1); ?&gt; . <br> &lt;?php } ?&gt;</code> <br> <br>  Save the file and visit your blog.  In the "basement" you will see the number of requests to the database of WordPress and the time spent on their creation. <br><br>  <strong>Note</strong>  It seems that many WordPress users are not aware of this wonderful opportunity.  The <em>get_num_queries ()</em> function returns the number of queries created during page loading. <br><br>  Please note that the code above displays the number of requests only for logged in users, since blog guests and search bots do not have to know this information.  But you can make the mapping public by simply removing the conditional <em>if (is_user_logged_in ())</em> operator from the code. <br><br><h3>  8. Restoring your database </h3><br>  <strong>The problem</strong> .  Let's say ... for some reason, such as hacking or an issue with updating, you may lose your blog data or find it hopelessly corrupted.  So if you have a backup copy (really there is, yes?), You need to import it into your WordPress database.  And then everything will be fine.  Probably. <br><br>  <strong>The decision</strong> . <br><br>  1. Login to phpMyAdmin, choose your WordPress database there. <br><br>  2. Click on the ‚ÄúImport‚Äù button in the horizontal menu. <br><br>  3. Click the "Open" button (Browse) and select the most recent copy of the database from your disk. <br><br>  4. Click on the button "Go" (Execute).  If everything goes well and the gods are on your side, the database will again be fully functional. <br><br>  <i>This post is a free translation of article <a href="http://www.smashingmagazine.com/2008/12/18/8-useful-wordpress-sql-hacks/">8 Useful WordPress SQL Hacks</a> .</i>  <i>Thanks to Jean-Baptiste Jung, the author of the original.</i>  <i>The post is designed for beginners WordPress and I hope that the recommendations will be useful to someone.</i> </div><p>Source: <a href="https://habr.com/ru/post/91990/">https://habr.com/ru/post/91990/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../91983/index.html">Eyyafyatlayokudl as a source of creativity and expensive things</a></li>
<li><a href="../91985/index.html">The reference model of the interaction of computing systems?</a></li>
<li><a href="../91987/index.html">iPadLaunch Party on which the community of fans of the new device came together</a></li>
<li><a href="../91988/index.html">Mathematician vs. Queen</a></li>
<li><a href="../91989/index.html">Quiet, quiet crawl, Haiku, on the slope of Fuji</a></li>
<li><a href="../91991/index.html">The awful truth about AMOLED screens :)</a></li>
<li><a href="../91996/index.html">We are testing the ERP system. Part 1</a></li>
<li><a href="../91997/index.html">Troyan on travel.mail.ru</a></li>
<li><a href="../91999/index.html">What does the strong name protect from in the .net builds?</a></li>
<li><a href="../92000/index.html">Universal charging for gadgets do it yourself</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>