<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NB-IoT, Narrow Band Internet of Things. Power saving modes and control commands</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all! 


 In the previous part, we discussed general information and features of the NB-IoT technology, and here we propose to consider in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NB-IoT, Narrow Band Internet of Things. Power saving modes and control commands</h1><div class="post__text post__text-html js-mediator-article"><p>  Good day to all! </p><br><p>  In the <a href="https://habr.com/ru/post/435646/">previous part, we</a> discussed general information and features of the NB-IoT technology, and here we propose to consider in detail the power saving modes of PSM and eDRX, as well as the commands with which these modes can be controlled. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zq/25/d1/zq25d19x97qntznb9esig9avf40.png"></div><a name="habracut"></a><br><h2>  Energy Saving Modes in NB-IoT </h2><br><p>  Devices that run on batteries, it is important to consume as little energy as possible.  For this, the NB-IoT has two power saving modes: Power Saving Mode, PSM and Extended idle mode DRX, eDRX.  Consider them in more detail. </p><br><h3>  Power Save Mode PSM, Power Saving Mode </h3><br><p>  According to the 3GPP TS 23.682 specification, <b>Power Saving Mode (PSM)</b> is a power-off mode, in which the device nevertheless remains registered on the network.  Curiously, the PSM mode appeared in 3GPP specifications earlier than the NB-IoT in 3GPP Release 12. </p><br><p>  The NB-IoT device initiates the PSM mode, including the values ‚Äã‚Äãof two timers in the ATTACH REQUEST / TAU REQUEST requests sent in the Attach and TAU procedures (TAU, Tracking Area Update is a periodic procedure that is used in LTE to notify the network of the availability and location of the mobile device ). </p><br><p>  The first timer - <b>T3324 Active Timer</b> - determines the time during which the device remains available from the network after an Attach, TAU, or data transfer procedure. </p><br><p>  The second timer, <b>T3412 Extended periodic TAU Timer</b> , determines the period of the TAU procedure. </p><br><p>  PSM mode and timers T3324, T3412 are shown in fig.  one: </p><br><img src="https://habrastorage.org/webt/fi/3v/xj/fi3vxjd1z69gf1rjr4diouuotfs.jpeg"><br><p>  If the network allows the use of the PSM mode, the values ‚Äã‚Äãof these timers are included in the ATTACH ACCEPT / TAU ACCEPT response messages.  When determining the values ‚Äã‚Äãof the timers, the network can take into account not only the values ‚Äã‚Äãrequested by the device, but also the local configuration.  In other words, the network is not required to confirm exactly the values ‚Äã‚Äãof the timers that the device requested.  But the device must apply the values ‚Äã‚Äãreceived from the network. </p><br><p>  <b>The duration of a device in PSM mode is defined as the difference between Extended periodic TAU Timer and Active Timer (T3412-T3324).</b>  Since the value of T3324 Active Timer can be zero, the <b>maximum theoretical time spent by the device in PSM mode</b> is equal to the maximum time T3412 Extended periodic TAU Timer and is <b>413 days and 8 hours (!!!)</b> .  The maximum T3324 Active Timer is 3 hours and 6 minutes (186 minutes). </p><br><p>  When a device is in PSM mode, it is not available from the network side (for the so-called mobile terminating services). </p><br><p>  The GSMA recommends that cellular service providers store and transmit to the device (after the last PSM mode exit) at least the last 100-bit data packet. </p><br><p>  The device can exit PSM mode at any time (for example, if the device needs to urgently transfer some data, as in the picture above). </p><br><h3>  EDRX power saving mode (Extended idle mode DRX) </h3><br><p>  <b>eDRX (Extended idle mode DRX)</b> can be considered an additional power-saving mode of the device, it appeared in 3GPP Release 13 specifications. DRX means discontinuous reception (Discontinuous Receiving).  The discontinuous reception method has been known in cellular communication for a long time, and consists in the fact that in order to save energy, the receiving path of the device is turned on periodically at certain intervals, and most of the time is turned off.  The network ‚Äúknows‚Äù about this and sends paging signals only at the ‚Äúright‚Äù times.  The extended discontinuous reception (eDRX) mode allows you to significantly increase the period of time when the receiving path of the device is turned off.  According to the 3GPP TS 23.682 specification, the <b>period of intermittent reception of eDRX in the NB-IoT mode is from 20.48 to 10485.76 seconds</b> (10485 seconds is almost 3 hours). </p><br><p>  A comparison of the ‚Äúold‚Äù DRX and the ‚Äúnew‚Äù eDRX is presented in Fig.  2: </p><br><img src="https://habrastorage.org/webt/m-/hw/vz/m-hwvz9fasw-ubefb9q0vaprfso.jpeg"><br><p>  The NB-IoT device activates the eDRX mode by transmitting the eDRX period length value in ATTACH REQUEST / TAU REQUEST requests sent in Attach and TAU procedures.  If the network allows the use of eDRX mode, then the eDRX period value is included in the ATTACH ACCEPT / TAU ACCEPT response messages.  The network is not required to confirm the value of the eDRX period requested by the device, but the device must apply the value transmitted by the network. </p><br><p>  As in the case of PSM, when using the eDRX mode, the GSMA recommends that operators save and transmit at least the last 100-bit data packet to the device.  However, as follows from a survey conducted by the GSM association, the operators intend to save much more downlink data (from application to device). </p><br><p>  The eDRX mode can be used simultaneously with the PSM mode. </p><br><p>  The PSM and eDRX modes are among the minimum requirements for NB-IoT networks recommended by the GSMA. </p><br><h2>  NB-IoT device control commands (AT commands) </h2><br><p>  Standard AT commands are described in the 3GPP TS 27.007 specification.  There are a lot of teams in total; here we will consider only those with which you can control the power saving modes of the NB-IoT device.  In addition, different manufacturers may interpret standard or invent new commands in their own way.  Therefore, for greater certainty, let's see the commands of the <a href="http://wless.ru/technology/%3Faction%3Ddetails%26id%3D723%26pf%3Dtech%26pf_id%3D1%26prod%3D35%26tech%3D2%26type%3D181">NB-IoT-module N21</a> . </p><br><h3>  PSM mode control command </h3><br><p>  To set the PSM mode parameters, use the AT + CPSMS command: </p><br><pre><code class="bash hljs">AT+CPSMS=[mode],[Requested_Periodic-RAU],[Requested_GPRS-READY-timer],[Requested_Periodic-TAU],[Requested_Active-Time]</code> </pre> <br><p>  Parameters of the AT + CPSMS command: </p><br><ul><li>  mode (0 - PSM is off, 1 - PSM is on) </li><li>  Requested_Periodic-RAU, T3312 (applicable to 2G / 3G, not used in NB-IoT) </li><li>  Requested_GPRS-READY-timer, T3314 (applicable to 2G / 3G, not used in NB-IoT) </li><li>  Requested_Periodic-TAU, T3412 (applicable to LTE, <b>used in NB-IoT</b> ) </li><li>  Requested_Active-Time, T3324 (applicable to 2G / 3G / LTE, <b>used in NB-IoT</b> ) </li></ul><br><p>  Thus, to configure the PSM parameters in the NB-IoT <b>mode</b> , three parameters are used: <b>mode</b> , <b>Requested_Periodic-TAU</b> and <b>Requested_Active-Time</b> . </p><br><p>  The requested duration of a device in PSM mode is the difference between the Requested_Periodic-TAU and Requested_Active-Time values. </p><br><h4>  Encoding the value of Requested_Active-Time (T3324) </h4><br><p>  Requested_Active-Time is encoded as a sequence consisting of 8 bits, where the high-order bits 8, 7, 6 are a multiplier, bits 5, 4, 3, 2, 1 are the value. </p><br><table><caption>  Table 1. Requested_Active-Time Multipliers (T3324) </caption><tbody><tr><td>  Bit 8 </td><td>  Bit 7 </td><td>  Bit 6 </td><td>  Factor </td></tr><tr><td>  0 </td><td>  0 </td><td>  0 </td><td>  2 seconds </td></tr><tr><td>  0 </td><td>  0 </td><td>  one </td><td>  1 minute </td></tr><tr><td>  0 </td><td>  one </td><td>  0 </td><td>  6 minutes (1/10 hour) </td></tr><tr><td>  one </td><td>  one </td><td>  one </td><td>  Timer deactivated </td></tr><tr><td></td><td></td><td></td><td>  Other values ‚Äã‚Äãshould be interpreted as 1 minute (in the current protocol version) </td></tr></tbody></table><br><p>  An example of coding the value of Requested_Active-Time (T3324): <br>  00000101 - Requested_Active-Time <br>  000 - multiplier, 2 seconds, <br>  00101 - value, 5, <br>  5 x 2 seconds = 10 seconds - the requested value is Requested_Active-Time. </p><br><p>  The maximum Requested_Active-Time (T3324) value is 3 hours and 6 minutes (186 minutes). </p><br><h4>  Coding the value Requested_Periodic-TAU (T3412) </h4><br><p>  Requested_Periodic-TAU is encoded as a sequence consisting of 8 bits, where the high-order bits 8, 7, 6 are a multiplier, the low-order bits 5, 4, 3, 2, 1 are the value. </p><br><table><caption>  Table 2. Requested_Periodic-TAU multipliers (T3412) </caption><tbody><tr><td>  Bit 8 </td><td>  Bit 7 </td><td>  Bit 6 </td><td>  Factor </td></tr><tr><td>  0 </td><td>  0 </td><td>  0 </td><td>  10 minutes </td></tr><tr><td>  0 </td><td>  0 </td><td>  one </td><td>  1 hour </td></tr><tr><td>  0 </td><td>  one </td><td>  0 </td><td>  10 hours </td></tr><tr><td>  0 </td><td>  one </td><td>  one </td><td>  2 seconds </td></tr><tr><td>  one </td><td>  0 </td><td>  0 </td><td>  30 seconds </td></tr><tr><td>  one </td><td>  0 </td><td>  one </td><td>  1 minute </td></tr><tr><td>  one </td><td>  one </td><td>  0 </td><td>  320 hours  Note: this value applies only to T3312 extended and T3412 extended timers (see TS 24.301).  If it is received in a message with integrity checking enabled, the value should be interpreted as 320 hours.  Otherwise, it should be interpreted as 1 hour. </td></tr><tr><td>  one </td><td>  one </td><td>  one </td><td>  Timer deactivated </td></tr></tbody></table><br><p>  Example of coding the value Requested_Periodic-TAU (T3412): <br>  00100001 - Requested_Periodic-TAU <br>  001 - multiplier, 1 hour, <br>  00010 - value, 2, <br>  2 x 1 hour = 2 hours - Requested_Periodic-TAU requested value </p><br><p>  The maximum value of the timer Requested_Periodic-TAU T3412 is 9920 hours or 413 days and 8 hours. </p><br><h4>  AT + CPSMS command examples </h4><br><pre> <code class="bash hljs">AT+CPSMS=0 //  PSM </code> </pre> <br><pre> <code class="bash hljs">AT+CPSMS=1,,,<span class="hljs-string"><span class="hljs-string">"00100001"</span></span>,<span class="hljs-string"><span class="hljs-string">"00100011"</span></span> //  PSM , Requested_Periodic-TAU: 2 , Requested_Active-Time: 3 ,  PSM: 1   57 </code> </pre> <br><h3>  EDRX mode control command </h3><br><p>  To set eDRX mode parameters, use the AT + CEDRXS command: </p><br><pre> <code class="bash hljs">AT+CEDRXS=[mode],[AcT-type],[Requested_eDRX_value]</code> </pre> <br><p>  Parameters of the AT + CEDRXS command: </p><br><p>  1. mode - mode: </p><br><ul><li>  0 - eDRX mode is off </li><li>  1 - eDRX mode is on </li><li>  2 - eDRX mode enabled, unsolicited messages (URC) enabled </li></ul><br><p>  2. AcT-type - radio access technology: </p><br><ul><li>  1 - EC-GSM-IoT </li><li>  2 - GSM </li><li>  3 - 3G </li><li>  4 - LTE, LTE-M </li><li>  5 - NB-IoT </li></ul><br><p>  3. Requested_eDRX_value - the duration of the eDRX period.  The value is encoded as a binary sequence consisting of 4 bits.  According to the 3GPP TS 23.682 specification, the eDRX period in the NB-IoT mode is in the range from 20.48 to 10485.76 seconds.  The values ‚Äã‚Äãof Requested_eDRX_value in the NB-IoT mode are listed in Table 3. </p><br><table><caption>  Table 3. The duration of the eDRX period </caption><tbody><tr><td>  Requested_eDRX_value in NB-IoT mode </td><td>  The duration of the period eDRX, with </td></tr><tr><td>  0010 </td><td>  20.48 </td></tr><tr><td>  0011 </td><td>  40.96 </td></tr><tr><td>  0100 </td><td>  20.48 </td></tr><tr><td>  0101 </td><td>  81.92 </td></tr><tr><td>  0110 </td><td>  20.48 </td></tr><tr><td>  0111 </td><td>  20.48 </td></tr><tr><td>  1000 </td><td>  20.48 </td></tr><tr><td>  1001 </td><td>  163.84 </td></tr><tr><td>  1010 </td><td>  327.68 </td></tr><tr><td>  1011 </td><td>  655.36 </td></tr><tr><td>  1100 </td><td>  1310.72 </td></tr><tr><td>  1101 </td><td>  2621.44 </td></tr><tr><td>  1110 </td><td>  5242.88 </td></tr><tr><td>  1111 </td><td>  10485.76 </td></tr></tbody></table><br><br><h4>  AT + CEDRXS command examples </h4><br><pre> <code class="bash hljs">AT+CEDRXS=0 //  eDRX </code> </pre> <br><pre> <code class="bash hljs">AT+CEDRXS=1,5,<span class="hljs-string"><span class="hljs-string">"0010"</span></span> //  eDRX ,   - NB-IoT,   eDRX - 20,48 </code> </pre> <br><p>  PS The article does not claim to absolute truth and may contain inaccuracies.  If you notice inaccuracies, want to share insider information or just give your opinion - welcome to the comments! </p><br>  <a href="https://habr.com/ru/post/435646/">Previous part: NB-IoT, Narrow Band Internet of Things.</a>  <a href="https://habr.com/ru/post/435646/">General information and technology features.</a> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/435722/">https://habr.com/ru/post/435722/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435708/index.html">Faial: a meeting place in the Atlantic</a></li>
<li><a href="../435712/index.html">Procter & Gamble has released a ‚Äúrejuvenating‚Äù skin printer</a></li>
<li><a href="../435714/index.html">Ukrainian developers have been given access to files from all Ring camcorders in the world.</a></li>
<li><a href="../435718/index.html">We pump Angular NGSW with the help of custom logic in the Service Worker</a></li>
<li><a href="../435720/index.html">Adblock Radio Development</a></li>
<li><a href="../435724/index.html">Holding back the imperatives</a></li>
<li><a href="../435728/index.html">[Friday] Tale about how IT-sale of firewood tried to sell, or Baxtage of one tender</a></li>
<li><a href="../435730/index.html">Shell cracked</a></li>
<li><a href="../435732/index.html">Friday JS: Quic, which plays tic-tac-toe</a></li>
<li><a href="../435734/index.html">How not to be deceived by doing physics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>