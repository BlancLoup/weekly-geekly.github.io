<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bruce Momjan, Marco Kreen, Fedor Sigaev and Maxim Boguk answered questions about PostgreSQL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On June 30, we held an online session, Questions to the world's leading PostgreSQL experts. Within three hours, anyone could ask a question to one of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bruce Momjan, Marco Kreen, Fedor Sigaev and Maxim Boguk answered questions about PostgreSQL</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/olpictures/019/26b/de9/01926bde9ffaec2cb1566c803a72c10e.jpg" width="200" height="267" alt="Photos from tika-online.de" hspace="10" vspace="10" align="right"><br>  On June 30, we held an online session, Questions to the world's leading PostgreSQL experts.  Within three hours, anyone could ask a question to one of the invited guests and get a comprehensive answer.  As a result, more than 40 questions were received, none of which went unheeded. <br><br>  Participants: <strong>Bruce Momjan (Bruce Momjian)</strong> (PGDG, EnterpriseDB), <strong>Maxim Boguk</strong> (Rambler, Masterhost), <strong>Fedor Sigaev</strong> (PGDG), <strong>Marko Kreen (Marko Kreen)</strong> (Skype). <br><br>  Here are the selected questions and answers: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>Question number 3</strong> <br><br>  <em><strong><a href="https://habrahabr.ru/users/kai/" class="user_link">kai</a> kai</strong> :</em> <br>  One of the annoying pieces in the work is the lack of the INSERT OR UPDATE construction.  In MySQL, you can do this: ‚ÄúINSERT INTO users (username, email) VALUES ('Jo', 'jo@email.com') ON DUPLICATE KEY UPDATE email = 'jo@email.com'‚Äù.  Will anything similar appear in PostgreSQL? <br><br>  <strong>Bruce Momjan, PostgreSQL community leader, EnterpriseDB expert:</strong> <br>  The standard (ANSI) method for such things is MERGE or UPSERT.  Both methods are in our TODO list and, as far as I know, someone is working on this functionality for PostgreSQL 8.4, although I personally have not seen this patch yet.  We, no doubt, need this syntax. <br><a name="habracut"></a><br>  <strong>Question number 5</strong> <br><br>  <em><strong>Alexander:</strong></em> <em><br></em>  <em>Questions to Skype developers:</em> <em><br></em>  <em>1) I want to estimate the scale of Skype, at least approximately.</em>  <em>How many users are currently registered?</em>  <em>How many users are online at the same time?</em>  <em>How many transactions per second does your PostgreSQL perform?</em>  <em>How many PostgreSQL servers do you have?</em> <em><br></em>  <em>2) How to measure the number of transactions per second in PostgreSQL?</em> <br><br>  <strong>Marco Kreen, Skype engineer:</strong> <br>  1) The total number of users we now have around 300 million.  I don‚Äôt know for sure about active users, but my Skype client shows that there are 10 million users online now, and this is far from a peak load.  I do not have exact figures for the number of transactions per second (TPS), but it seems that our workload is somewhere around 10-20 thousand TPS.  In total, we have over 100 PostgreSQL servers, although not all of them work simultaneously. <br>  2) Use the log analyzer or pgBouncer installed in front of the database, it gives such statistics. <br><br>  <strong>Question number 7</strong> <br><br>  <em><strong>Sergey Konoplev:</strong></em> <em><br></em>  <em>We have the task of generating events based on operations in the database: add / modify / delete.</em>  <em>This, of course, can be done in triggers, but at the level of WAL files IMHO it would be more efficient, not to mention that the processing could be done deferred and rendered.</em>  <em>The question is - is there a well-documented API for working with WAL files and, if so, how much will it change from version to version?</em>  <em>If so, where can I find information about it?</em> <br><br>  <strong>Fedor Sigaev, a leading PostgreSQL developer:</strong> <br>  There is no external API, since external access to WAL files was never intended.  Moreover, their format is compatible only for minor versions, the guarantee of compatibility of formats between major versions was never even expected.  In Postgres, there is not even a central decrypter for WAL records, each record is in some sense a container that has a decryption attribute (table, btree index, GiST index, etc.). It is not very convenient to build your processing on WAL logs. the following reason: files can be reused, and Postgres does not inform the outside world about it. <br><br>  <strong>Bruce Momjan, PostgreSQL community leader, EnterpriseDB expert:</strong> <br>  That is, are you looking for a way to read WAL files directly?  There is no API for this, as their internal format is rather complicated.  I now realized that the possibility of reading the logs could be useful, perhaps we should consider including this wish in the TODO list.  We actually have pg_filedump ( <a href="http://sources.redhat.com/rhdb/utilities.html">http://sources.redhat.com/rhdb/utilities.html</a> ), but I‚Äôm not sure if it dumps WAL files. <br><br>  <strong>Marco Kreen, Skype engineer:</strong> <br>  Maybe it is more efficient, but less reliable (for example, a WAL file can be deleted without your knowledge).  Please try Skytools PgQ and study the scripts that use this mechanism for queuing.  This is a very efficient queue within the database, easy to use and reliable.  It also has a built-in framework in order to guarantee transactions between multiple databases when processing a queue.  There are also triggers that automatically determine the structure of the tables and format the data in an easily parsed format (urlencode). <br><br>  <strong>Question number 8</strong> <br><br>  <em><strong>sakalr:</strong></em> <em><br></em>  <em>Question about the books.</em>  <em>Today I received a book from the British Amazon, I had to wait a few weeks.</em>  <em>In Russia, from current versions I found only a book for 3,900 rubles.</em>  <em>In general, let the books be even in English, but I want to come to Biblio-Globus or the Young Guard and see this book on the shelf, but not for 3,900 rubles (on Amazon this book was 2 times cheaper) .</em>  <em>There is a need for development on PostgreSQL, but for me, as a beginner in PgSQL, this is difficult.</em>  <em>Constantly you have to communicate on freenode in broken English, master the basics, having spent a lot of time when it should be just a mechanical assimilation.</em>  <em>That is why the question arises about the book.</em>  <em>Books on postgresql (English / Russian) are very necessary.</em> <br><br>  <strong>Fedor Sigaev, a leading PostgreSQL developer:</strong> <br>  If you are already familiar with any SQL dialect, then the work in Postgres should not cause you great inconvenience.  Postgres documentation is very good and usually suffices (with careful reading, of course).  If you are not familiar with SQL, then it is better to take any textbook on SQL. <br><br>  <strong>Bruce Momjan, PostgreSQL community leader, EnterpriseDB expert:</strong> <br>  I fully agree that more English and Russian books are needed.  Ideally, we need to have PostgreSQL documentation translated into Russian. <br><br>  <strong>Question number 18</strong> <br><br>  <em><strong><a href="https://habrahabr.ru/users/kai/" class="user_link">kai</a> kai</strong> :</em> <br>  Here's another question about pgAdmin - are you planning to regularly build packages for common versions of Linux?  For example, in Ubuntu 8.04 pgAdmin 1.8.2 is now (buggy), and pgadmin 1.8.4 is already on the pgadmin.org site. <br><br>  <strong>Bruce Momjan, PostgreSQL community leader, EnterpriseDB expert:</strong> <br>  I was told that these problems were fixed in Ubuntu (Ubuntu), which, by the way, I use myself.  I think the only problem here is forcing the developers of Ubuntu to update the server for updates.  The bundle of software packages with Postgres for Ubuntu also works fine and maybe you should try it.  There is a PostgreSQL server, pgAdmin, and many other software packages prepared by Dave Page, the author of pgAdmin, and not the developers of Ubuntu. <br><br>  <strong>Question number 26</strong> <br><br>  <em>How is PostgreSQL migrated to Skype between major versions?</em> <br><br>  <strong>Marco Kreen, Skype engineer:</strong> <br>  Using Londiste (a replication component in Skytools). <br><br>  <strong>Question number 36</strong> <br><br>  <em><strong>Dmitriy:</strong></em> <em><br></em>  <em>Is it planned to introduce a built-in multi-replication master?</em>  <em>If so, when can we expect the beta version?</em> <br><br>  <strong>Bruce Momjan, PostgreSQL community leader, EnterpriseDB expert:</strong> <br>  We could try to implement multi-master replication, but locks often make it inefficient.  Most developers consider master / slave replication or partitioning of data across servers as the best alternative.  PgPool, by the way, can work in multi-master mode.  PgCluster implements a multi-master, but its performance leaves much to be desired.  Slony-II tried to implement a multi-master, but again, the performance was low. <br><br>  <strong>Fedor Sigaev, a leading PostgreSQL developer:</strong> <br>  There are plans for built-in replication of Master-Multiple Slaves, we hope that this will be in 8.4.  About Multi-Master - look at Postgres-R, its source codes have been open for a month now. <br><br>  <strong>Marco Kreen, Skype engineer:</strong> <br>  If you want to distribute the load on the recording on several machines, see PL / Proxy - it is not a multi-master in the conventional sense of the word, but it has very good performance, which is so lacking in conventional multi-master systems. <br><br>  The full history of the online session can be found <a href="http://postgresmen.ru/articles/view/107">on our website</a> . </div><p>Source: <a href="https://habr.com/ru/post/30381/">https://habr.com/ru/post/30381/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../30380/index.html">QIP Online - a program for tracking incoming messages in social networks</a></li>
<li><a href="../303800/index.html">The implementation of interactive diagrams using OOP on the example of the prototype editor of UML diagrams. Part 2</a></li>
<li><a href="../303802/index.html">Big Data Brain</a></li>
<li><a href="../303804/index.html">The ‚ÄúMake with Ada‚Äù competition for developers of embedded systems has begun.</a></li>
<li><a href="../303806/index.html">Harvard CS50 Programming Course Now in Russian</a></li>
<li><a href="../303814/index.html">Launch Xamarin.Forms on Windows 7</a></li>
<li><a href="../303816/index.html">NavMesh on crutches - little tricks</a></li>
<li><a href="../303818/index.html">Indian regulator plans to make life difficult for high-frequency trading companies.</a></li>
<li><a href="../30382/index.html">Choosing a projector for the office</a></li>
<li><a href="../303820/index.html">Global trends that manage fintech companies: infographics</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>