<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mathematical calculations and graphs in LyX using Sage</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="LyX is a WYSIWYM document processor that works seamlessly with LaTeX. That is, the user creates * .lyx files in this processor, from which * .tex is t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mathematical calculations and graphs in LyX using Sage</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://www.lyx.org/">LyX</a> is a WYSIWYM document processor that works seamlessly with LaTeX.  That is, the user creates * .lyx files in this processor, from which * .tex is then created and compiled. <br>  <a href="http://www.sagemath.org/">Sage</a> is a computer algebra system that works transparently with other math packages.  The main interface is the command line, using all the variety of python capabilities.  Also available is a web-based interface that can be tested on the developers website. <br>  The joint use of these two developments opens up interesting possibilities.  For example, you can create reports in which calculations, graphs and analytical calculations will be performed automatically, almost as if in some kind of, but with a clear LyX structure, python flexibility and LaTeX layout capabilities. <br> <a href=""><img src="https://habrastorage.org/storage/habraeffect/6b/4b/6b4b8e47ab3f499ef1d94d7d77e36e61.png"></a> <br><a name="habracut"></a><br> <a href=""><img src="https://habrastorage.org/storage/habraeffect/bd/5c/bd5cae0d6b33eec3ef8447d1a53d60cb.png"></a> <br><h4>  Installation </h4><br>  LyX is in almost any modern distribution, so it installs in the usual way.  It is written in Qt, there is a port under Windows.  LyX will pull LaTeX. <br>  With Sage, it's not that simple.  He is now only under linux, in distributions, if presented, then in a not particularly efficient form.  Developers recommend running <a href="http://www.sagemath.org/download-windows.html">under Windows</a> using a virtual machine. <br>  Sage developers suggest <a href="http://www.sagemath.org/download-linux.html">downloading the</a> build for your architecture (386 or amd64) and distribution (Ubuntu and Fedora, but I think it will work in the rest).  The assembly contains, in addition to sage-modules, python, maxima, gap, and much more.  You download the archive, unpack it into a folder and immediately start sage or sage-notebook - the server for the web interface from it.  It also includes the style for LaTeX, which can always be <a href="http://www.ctan.org/tex-archive/macros/latex/contrib/sagetex/">downloaded</a> separately. <br>  Let all this is not particularly compatible with package managers, but quite convenient. <br>  I will assume that you unpacked the archive into the <code>/usr/local/sage</code> directory. <br><br><h4>  Training </h4><br>  Now that LyX and Sage are installed, you can begin to combine them. <br>  This will require: <br><ol><li>  Customize LaTeX. </li><li>  Write a script. </li><li>  Customize LyX. </li></ol><br><h5>  1. Configure LaTeX </h5><br>  The sagetex style mentioned above should be visible to LaTeX.  In the style manual it is advised to put it in the <code>~/texmf/tex/genetic</code> folder.  Under ubuntu, apparently, you need to put in <code>~/.local/share/texmf/tex/genetic</code> <br>  It worked for me (so far without LyX) like this: <pre> <code class="hljs pgsql">$ sudo ln -s /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/sage/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>/texmf/tex/generic/sagetex/ /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>/texmf/tex/generic/sagetex/</code> </pre>  and then <pre> <code class="hljs pgsql">$ sudo texhash /usr/<span class="hljs-keyword"><span class="hljs-keyword">local</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">share</span></span>/texmf/tex/generic/sagetex/ # ,  ,      </code> </pre><br>  By the way, speaking, TexLive, which is set by default in ubunt, contains the sagetex style.  But there is a problem with versions - sage and sagetex of different versions are not friendly with each other, so it is important that LaTeX deal with the new sagetex.sty. <br>  You can find out which file LaTeX will take if you say <code>\usepackage{sagetex}</code> to it, like this: <pre> <code class="hljs ruby">$ kpsewhich sagetex.sty</code> </pre> <br>  This style implies the following sequence of assembling documents that use it: <pre> <code class="hljs smalltalk"><span class="hljs-string"><span class="hljs-string">$ </span></span>latex tex_with_sage.tex #     sage tex_with_sage.sage <span class="hljs-string"><span class="hljs-string">$ </span></span>sage tex_with_sage.sage #      #     ,    <span class="hljs-string"><span class="hljs-string">$ </span></span>latex tex_with_sage.tex #   <br></code> </pre> <code>$ latex tex_with_sage.tex #     sage tex_with_sage.sage $ sage tex_with_sage.sage #      #     ,    $ latex tex_with_sage.tex #   <br></code> <br>  LyX, of course, does not know how to run sage.  But he knows how to work with noweb.  What it is now is not even important, we just need to have the file <code>noweb.sty</code> in the system.  You can install the noweb package, or you can simply create this file. <br><h5>  2. Script </h5><br>  As soon as LyX starts collecting the final file (for example, pdf), it generates a * .tex file in the temporary directory and runs the usual commands (pdflatex, makeindex, etc.).  Then it launches the final * .pdf or * .dvi file in the viewer or copies this file to the folder with the original document. <br>  If the document type is noweb, a * .nv file will be generated (essentially the same * .tex), a special program will be launched for this file, which creates * .tex, after which pdflatex, makeindex and their ilk will be used . <br>  As this program, we‚Äôll give LyX such a simple script: <pre> <code class="hljs mel">#!/bin/bash name=<span class="hljs-string"><span class="hljs-string">`basename $1 .nw`</span></span> # uncomment and replace path <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you have problems with # old version of sagetex.sty <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> texlive # ln -sf /usr/local/share/texmf/tex/generic/sagetex/sagetex.sty sagetex.sty # generating *.sage <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> latex $1 &gt; $name.sage.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span> echo <span class="hljs-string"><span class="hljs-string">""</span></span> &gt;&gt; $name.sage.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> # generating *.sout <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> /usr/local/sage/sage $name.sage &gt;&gt; $name.sage.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>&gt;&amp;<span class="hljs-number"><span class="hljs-number">1</span></span> ln -sf $1 $2 # now LyX can run latex <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> usual way <br></code> </pre> <code>#!/bin/bash name=`basename $1 .nw` # uncomment and replace path if you have problems with # old version of sagetex.sty in texlive # ln -sf /usr/local/share/texmf/tex/generic/sagetex/sagetex.sty sagetex.sty # generating *.sage file latex $1 &gt; $name.sage.log 2&gt;&amp;1 echo "" &gt;&gt; $name.sage.log # generating *.sout file /usr/local/sage/sage $name.sage &gt;&gt; $name.sage.log 2&gt;&amp;1 ln -sf $1 $2 # now LyX can run latex in usual way <br></code> <br>  I put it in <code>$HOME</code> and called <code>sagelyx.sh</code> . <br><br><h5>  3. Configure LyX </h5><br>  Classes with Noweb must be available in the document settings.  If they are not available, you may need to run <code>-&gt;</code> . <br>  Next, you need to tell LyX that you need to run our script for the Noweb documents (see picture). <br> <a href=""><img src="https://habrastorage.org/storage/habraeffect/02/08/02089eba0cbce94ec33df2ef91f9aaa5.png"></a> <br>  We add to the preamble of all documents: <pre> <code class="hljs tex"><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">usepackage</span></span></span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{sagetex}</span></span></span></span></code> </pre> <br><h4>  Using </h4><br>  Now you can enter a formula (or make a TeX-insert) in the document: <br><pre> <code class="hljs tex"><span class="hljs-formula"><span class="hljs-formula">$26^{3}</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">cdot</span></span></span></span></span><span class="hljs-formula">10^{3}=</span><span class="hljs-tag"><span class="hljs-formula"><span class="hljs-tag">\</span></span><span class="hljs-name"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-name">sage</span></span></span></span><span class="hljs-string"><span class="hljs-formula"><span class="hljs-tag"><span class="hljs-string">{26**3+10**3}</span></span></span></span></span><span class="hljs-formula">$</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If the formula preview is enabled, then LyX will replace the <code>\sage</code> command with <code>??</code>  .  This is because only one LaTeX pass is used for the preview.  However, if you click the <code> PDF</code> button, a pdf with the numbers entered will open. <br>  A simple example and my script: <a href="http://www.box.net/shared/air7v45yqk">http://www.box.net/shared/air7v45yqk</a> <br><br><h4>  What does not work? </h4><br>  Many things don't work ... <br>  Something turns out bad in LyX and you have to do TeX inserts, for example, you don‚Äôt really use <code>\sage{}</code> inside the mathematical environment, because LyX removes spaces and inserts braces. <br>  Something cannot be done in sagetex itself, for example, using strings with unicode text.  To do this, you need to place the line at the beginning of the sage file. <pre> <code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta"># -*- coding: utf-8 -*-</span></span></code> </pre>  but no means for this sagetex does not provide. <br><br>  PS I hope that someday all this will become very, very simple (maybe even thanks to this post), as in cool commercial systems, but flexibility and freedom will remain in all possible ways. <br></div><p>Source: <a href="https://habr.com/ru/post/95289/">https://habr.com/ru/post/95289/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../95278/index.html">Linked: strength in weakness?</a></li>
<li><a href="../95279/index.html">Quantum informatics for cats and people</a></li>
<li><a href="../95283/index.html">Make your own firmware for Nokia 5530</a></li>
<li><a href="../95285/index.html">Microsoft's official response to the Google demarche</a></li>
<li><a href="../95288/index.html">What Intel will show at Computex 2010</a></li>
<li><a href="../95290/index.html">Application Developer Days - Programmer Days</a></li>
<li><a href="../95295/index.html">Software People 2010 - our video footage from the scene</a></li>
<li><a href="../95299/index.html">Start-up lift</a></li>
<li><a href="../95302/index.html">The great and mighty localization of Basecamp!</a></li>
<li><a href="../95304/index.html">Self-education with self-stimulation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>