<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As a Windows driver crafty breaks sound in Linux or painful bug searches</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instead of intro  Cheap ‚Äúroom of fear‚Äù is dark and everywhere a rake.  Thoughtfully looking at the correction of the ruble exchange rate to fall into ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As a Windows driver crafty breaks sound in Linux or painful bug searches</h1><div class="post__text post__text-html js-mediator-article"><h2>  Instead of intro </h2><blockquote>  Cheap ‚Äúroom of fear‚Äù is dark and everywhere a rake. </blockquote>  Thoughtfully looking at the correction of the ruble exchange rate to <s>fall into the deep chasms</s> , I decided that it makes no sense to remain with a rapidly devaluing paper on my hands and it is time to upgrade outdated hardware.  The choice was for Gigabyte GA-Z97-D3H, because I wanted to have interfaces for SSD "for growth".  M.2 and Sata Express promise up to 10 Gbit / s per port, which can not but rejoice amid a rapid increase in the speed of the drives.  He collected, performed the rite of applying thermal paste and solemnly sprinkled a system unit with beer, as expected and immediately plunged into the exciting world of rakes and mysterious bugs. <img src="https://habrastorage.org/files/949/41f/884/94941f884c42463d8de332b542b6604e.png">  <i>Hero of the occasion.</i> <a name="habracut"></a><h2>  Simple joys of linuksoid </h2>  Just want to say - I am not a harsh, bearded piece of iron, healing controllers by the laying on of hands.  Maximum - slightly bristly linux-user, using open source software in work and life.  In the secret underground headcrab cultivation lab in which I work, there are often tasks involved in processing audio and video materials from the work.  Zip zergling's hatching process there or something else ... In short, without Audacity and Kdenlive nowhere.  Realtek ALC1150 on the motherboard, as always, promised unearthly bliss and crystal bells fluttering under the spring wind on top of the Himalayas. <h2>  In search of a rake </h2><img src="https://habrastorage.org/files/1d3/b40/a96/1d3b40a96ad44ce7950327d3c4e04ff5.jpg">  And so, I habitually broke the SSD into sections for Windows 7 (yes, I don't like tiles) and Kubuntu 14.04 LTS.  After a superficial configuration, Windows rebuilt in Linux and was surprised at the lack of sound.  Having decided that the core, as always, does not keep up with fresh iron, I found it useful to search for known bugs on the z97 chipset.  <a href="https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1321421">The first bug that came</a> across <a href="https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1321421">,</a> sadly told about distortions and wheezing on this chipset among Ubuntu 14.04 users.  I looked at the recommendations superficially and tried to do this: <pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"options snd-hda-intel vid=8086 pid=8ca0 snoop=0"</span></span> &gt;&gt; /etc/modprobe.d/alsa-base.conf</code> </pre>  After the reboot, silence still filled the speakers.  Not very upset, I noticed that in the kernel version&gt; 3.16 the problem should be fixed.  Apparently, despite promises to sit on stable LTS releases, the Universe was pushing me in the previous series of continuous updates and searches for what had fallen off this time.  Having completed the do-release-upgrade, I was glad that there were no major changes, but the problem still remained.  Then I decided to make a contribution to the development of open source software and <a href="https://bugs.launchpad.net/ubuntu/%2Bsource/alsa-driver/%2Bbug/1388436">file down the fixed bug report.</a>  In addition to the standard logs, I decided to try to give the sound manually, without using pads like Phonon and PulseAudio. First we define the devices: <pre> <code class="bash hljs">meklon@meklon-desktop:~/$ aplay -l ****  PLAYBACK  ****  0: PCH [HDA Intel PCH],  0: ALC1150 Analog [ALC1150 Analog] : 1/1  ‚Ññ0: subdevice <span class="hljs-comment"><span class="hljs-comment">#0  0: PCH [HDA Intel PCH],  1: ALC1150 Digital [ALC1150 Digital] : 1/1  ‚Ññ0: subdevice #0  1: HDMI [HDA ATI HDMI],  3: HDMI 0 [HDMI 0] : 1/1  ‚Ññ0: subdevice #0</span></span></code> </pre>  First of all, we check that we don‚Äôt have a low mute (thanks for the <a href="https://habrahabr.ru/users/valdikss/" class="user_link">ValdikSS</a> tips): <pre> <code class="bash hljs">meklon@meklon-desktop:~/$ amixer <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> Master 100 unmute Simple mixer control <span class="hljs-string"><span class="hljs-string">'Master'</span></span>,0 Capabilities: pvolume pvolume-joined pswitch pswitch-joined Playback channels: Mono Limits: Playback 0 - 87 Mono: Playback 87 [100%] [0.00dB] [on]</code> </pre><img src="https://habrastorage.org/files/ec6/153/5ef/ec61535ef0634a35b0660788d14319f3.png">  Now we are trying to sound directly using the console omnivorous mplayer: <pre> <code class="bash hljs">meklon@meklon-desktop:~/$ amixer <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> Master 100 unmute Simple mixer control <span class="hljs-string"><span class="hljs-string">'Master'</span></span>,0 Capabilities: pvolume pvolume-joined pswitch pswitch-joined Playback channels: Mono Limits: Playback 0 - 87 Mono: Playback 87 [100%] [0.00dB] [on] meklon@meklon-desktop:~/$ mplayer --ao=alsa:device=hw=0.0 0.mp3 MPlayer2 2.0-728-g2c378c7-2ubuntu3 (C) 2000-2012 MPlayer Team Cannot open file <span class="hljs-string"><span class="hljs-string">'/home/meklon/.mplayer/input.conf'</span></span>: No such file or directory Failed to open /home/meklon/.mplayer/input.conf. Cannot open file <span class="hljs-string"><span class="hljs-string">'/etc/mplayer/input.conf'</span></span>: No such file or directory Failed to open /etc/mplayer/input.conf. Playing 0.mp3. Detected file format: MP2/3 (MPEG audio layer 2/3) (libavformat) [mp3 @ 0x7f43bdf90b40]max_analyze_duration 5000000 reached [mp3 @ 0x7f43bdf90b40]Estimating duration from bitrate, this may be inaccurate [lavf] stream 0: audio (mp3), -aid 0 Clip info: album_artist: Emma Chapplin track: 17 title: Spente Le Stelle (Live Version) artist: Emma Shapplin album: Forever Gold genre: Classical date: 2000 Load subtitles <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> . Selected audio codec: MPEG 1.0/2.0/2.5 layers I, II, III [mpg123] AUDIO: 44100 Hz, 2 ch, s16le, 320.0 kbit/22.68% (ratio: 40000-&gt;176400) AO: [alsa] 44100Hz 2ch s16le (2 bytes per sample) Video: no video Starting playback... A: 6.5 (06.5) of 334.7 (05:34.7) 0.4%</code> </pre>  And again we listen to silence.  Decay and hopelessness.  Windows at the same time continues to delight normal sound, eliminating hardware problems.  Sensing the awakening of a bearded software tester, I decide to sort through all the possible options: <ul><li>  None of the distributions in the live-cd version does not work </li><li>  Replacing the core with 3.17 made the system less adequate, but the sound did not appear </li><li>  Physically disabled the video card and SSD </li><li>  Wipe the dust on the speakers </li><li>  I put the cable into different connectors </li><li>  Burned a manual in front of a portrait of Stallman </li></ul><h2>  The killer is a janitor </h2><img src="https://habrastorage.org/files/094/ad9/276/094ad9276286450190c278987b9cbbb9.jpg">  As you may have guessed from the name of the post - the problem in Windows.  And don't care that there were a million reboots, on and off, launches from all possible media.  So, the drumming and solution of the problem in the form of a huge crutch, rewound with electrical tape: <b>In order for sound to appear, you need to physically de-energize the system unit.</b>  <b>Yes.</b>  <b>It is de-energize.</b>  <b>If you run Windows at least once, the sound will disappear again.</b>  Reboots and normal shutdown do not help.  Windows, when started, does something in the meanest way with the controller's hardware on the motherboard, making it inaccessible on Linux systems.  Enemy intrigues are not otherwise.  So, as I am not an expert in the field of low-level iron and the core, I leave the search for a solution for more bearded comrades in misfortune.  By the way, I still stumbled upon <a href="https://bugs.launchpad.net/ubuntu/%2Bsource/linux/%2Bbug/1357723">a description of my bug after it had revealed its cause.</a>  Taking this opportunity, I want to clarify what should I do with my bug report?  How does his sdurgit with the earlier?  <b>UPD 4 Bug entered in the database kernel.org.</b> Please unsubscribe all affected.  <a href="https://bugzilla.kernel.org/show_bug.cgi%3Fid%3D87771">Link to Bugzilla</a> <b>UPD 5 In the process of debugging with the help of dark magic, it seems to have felt the problem. <b>After entering the next one into the console, the sound appears:</b></b> <pre> <b><b><code class="bash hljs">apt-get install alsa-tools root@meklon-desktop:/home/meklon<span class="hljs-comment"><span class="hljs-comment"># hda-verb /dev/snd/hwC0D2 0x20 SET_COEF_INDEX 0x07 nid = 0x20, verb = 0x500, param = 0x7 value = 0x0 root@meklon-desktop:/home/meklon# hda-verb /dev/snd/hwC0D2 0x20 SET_PROC_COEF 0x7cb0 nid = 0x20, verb = 0x400, param = 0x7cb0 value = 0x0</span></span></code></b></b> </pre>  <b><b><b>UPD 6 A bug marked as resolved</b> Fix will be included in the 3.18-rc5 kernel.</b></b>  <b><b>If someone can help in backporting, it would be great.</b></b> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/242253/">https://habr.com/ru/post/242253/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242235/index.html">As a formal management, the whole department ruined.</a></li>
<li><a href="../242241/index.html">Getting unique content from video blogs</a></li>
<li><a href="../242243/index.html">ASP.NET vNext Likbez</a></li>
<li><a href="../242247/index.html">The first browser specifically for developers: soon</a></li>
<li><a href="../242251/index.html">Algorithms for eliminating false and redundant data in the GPS stream</a></li>
<li><a href="../242255/index.html">Ilya Grigorik on the implementation of HTTP / 2</a></li>
<li><a href="../242257/index.html">Startup, Westing, Cliff: Shares in Business and Rights of Participants</a></li>
<li><a href="../242261/index.html">Effective Django. Part 2</a></li>
<li><a href="../242263/index.html">We restore the old clock "Electronics-7"</a></li>
<li><a href="../242267/index.html">Free signing for Open Source from Certum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>