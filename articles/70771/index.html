<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Weather forecast by phone</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I decided that it would turn out to be a very useful opportunity when going to work to listen to the weather forecast on the telephone loudspeaker by ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Weather forecast by phone</h1><div class="post__text post__text-html js-mediator-article"><h4>  I decided that it would turn out to be a very useful opportunity when going to work to listen to the weather forecast on the telephone loudspeaker by pressing one programmed button.  How I did it look under the cut. </h4><br><a name="habracut"></a><br><h6>  The first thing we need is the weather forecast itself.  I decided to take it from the site gismeteo.ru. <br>  How I did it: <br>  I went to the site gismeteo.ru found your city. <br>  I clicked the "Informers" link in the header. <br>  On the next page I found the text ‚ÄúData in XML format‚Äù and took the link from the ‚Äúget code‚Äù button. <br>  Thus, we now know how we get a fresh forecast in XML format. <br><br>  Now you need to save it for further processing: <br>  I did not reinvent the bicycle and wrote a two-line bash script </h6><br><br><blockquote><code><a href="http://s-c.me/3680/s"></a> <a href="http://s-c.me/3680/h"></a> <font color="black">Copy Source | Copy HTML <font color="#696969">#!/bin/bash</font> <font color="#0000ff">cd</font> /usr/isp/weather /usr/bin/wget <font color="#008000">'http://informer.gismeteo.ru/xml/34214_1.xml'</font> -O ./34214_1.xml</font></code> <ol> <li> <code><font color="black"><font color="#696969"><a href="http://s-c.me/3680/s"></a> <a href="http://s-c.me/3680/h"></a> Copy Source | Copy HTML #!/bin/bash <font color="#0000ff">cd</font> /usr/isp/weather /usr/bin/wget <font color="#008000">'http://informer.gismeteo.ru/xml/34214_1.xml'</font> -O ./34214_1.xml</font></font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3680/s"></a> <a href="http://s-c.me/3680/h"></a> Copy Source | Copy HTML <font color="#696969">#!/bin/bash</font> <font color="#0000ff">cd</font> /usr/isp/weather /usr/bin/wget <font color="#008000">'http://informer.gismeteo.ru/xml/34214_1.xml'</font> -O ./34214_1.xml</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/3680/s"></a> <a href="http://s-c.me/3680/h"></a> Copy Source | Copy HTML <font color="#696969">#!/bin/bash</font> <font color="#0000ff">cd</font> /usr/isp/weather /usr/bin/wget <font color="#008000">'http://informer.gismeteo.ru/xml/34214_1.xml'</font> -O ./34214_1.xml</font></code> </li> <li></li></ol></blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  where <b><a href="">informer.gismeteo.ru/xml/34214_1.xml</a></b> is the link for your city.  The wget command downloads our XML and writes it to file 34214_1.xml in the current directory, we will need it later.  To make the forecast always fresh, you need to write this script to cron for example like this: </h6><br> <code>*/60 * * * * /usr/isp/weather/weather_up.sh</code> <br> <br><h6>  I decided to make a voice prediction algorithm in Perl which interacts with Asterisk through <a href="http://voip.rus.net/tiki-index.php%3Fpage%3DAsterisk%2BAGI">AGI</a> .  Our algorithm is required to parse the XML file and output to stdout a sequence of lines with commands for Asterisk to play audio files like this: </h6><br><blockquote> <code><a href="http://s-c.me/3681/s"></a> <a href="http://s-c.me/3681/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#0000ff">EXEC</font> Playback weather / Po_dannym_Gismeteo "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / tod / dnem "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / m / 15ogo "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / budet "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / cloudiness / pasmurno "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / precipitation / dozhd <font color="#0000ff">'""</font> &lt;br/&gt; <br>  <font color="#0000ff">EXEC</font> Playback weather / temp_vosduha_sostavit "" &lt;br/&gt; <font color="#0000ff">EXEC</font> Playback weather / digits / 20 "" &lt;br/&gt; <font color="#0000ff">EXEC</font> Playback weather / digits / 2 "" &lt;br/&gt; <font color="#0000ff">EXEC</font> Playback weather / Do "" &lt;br/&gt; <font color="#0000ff">EXEC</font> Playback weather / digits / 20 "" &lt;br/&gt; <font color="#0000ff">EXEC</font> Playback weather / gradusov_C "" &lt;br/&gt; <font color="#0000ff">EXEC</font> Playback weather / Skorost'_vetra_sostavit "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / digits / 5 "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / Do "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / digits / 3 "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / metrov_v_sekundu "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / Atmosfernoe_davlenie_sostavit "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / digits / 700 "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / digits / 40 "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / digits / 7 "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / Do "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / digits / 700 "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / digits / 40 "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / digits / 5 "" </li><li>  <font color="#0000ff">EXEC</font> Playback weather / milimetrov_rtutnogo_stolba "" </li></ol></blockquote><br><br><h6>  As you noticed, you will have to prepare a lot of sound recordings, but this is once and for all. <br><br>  In my version in some recorded phrases there is the word "from".  For example: Atmosfernoe_davlenie_sostavit read as "Atmospheric pressure will be from." <br><br>  Actually, I used the <b>XML :: Simple</b> module to parse XML. It seemed to me the easiest to use.  To replace the XML tags with the lines I need, I used lists for dubbing: </h6><br><blockquote> <code><a href="http://s-c.me/3682/s"></a> <a href="http://s-c.me/3682/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  my <font color="#cc6633">$ date_name</font> = { </li><li>  <font color="#008000">1</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 1ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">2</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 2ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">3</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 3ogo \" \ "\ n"</font> ], </li><li>  ..... </li><li></li></ol></blockquote><br><h6>  With the algorithm for converting numbers into a set of commands for playing numbers, I also decided not to reinvent the wheel and took a ready-made algorithm for converting money to a record (unfortunately I don‚Äôt remember anyone else), replaced the lines such as " <b>one</b> " with " <b>Playback weather \ / digits</b> " in the right places. <b>\ / 1 \ "\" \ n</b> "and the algorithm is adapted (a lot of time saved). <br>  I think now everything will be clear, it's time to look at the script: </h6><br><br><blockquote> <code><a href="http://s-c.me/3683/s"></a> <a href="http://s-c.me/3683/h"></a> <a href="http://www.php.net/manual/en/function.split.php"></a> <a href="http://www.php.net/manual/en/function.split.php"></a> <a href="http://www.php.net/manual/en/function.defined.php"></a> <a href="http://www.php.net/manual/en/function.defined.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <a href="http://www.php.net/manual/en/function.substr.php"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#696969">#! / usr / bin / perl</font> </li><li></li><li>  <font color="#0000ff">use</font> strict; </li><li>  <font color="#0000ff">use</font> XML :: Simple; </li><li>  <font color="#0000ff">use</font> Data :: Dumper; </li><li></li><li>  my <font color="#cc6633">$ date_name</font> = { </li><li>  <font color="#008000">1</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 1ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">2</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 2ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">3</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 3ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">4</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 4ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">5</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 5ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">6</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 6ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">7</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 7ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">8</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 8ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">9</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 9ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">10</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 10ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">11</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 11ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">12</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 12ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">13</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 13ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">14</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 14ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">15</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 15ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">16</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 16ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">17</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 17ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">18</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 18ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">19</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 19ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">20</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 10ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">21</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 21ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">22</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 22ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">23</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 23ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">24</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 24ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">25</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 25ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">26</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 26ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">27</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 27ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">28</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 28ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">29</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 29ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">30</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 30ogo \" \ "\ n"</font> ], </li><li>  <font color="#008000">31</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / 31ogo \" \ "\ n"</font> ] </li><li>  }; </li><li></li><li>  my <font color="#cc6633">$ hour_name</font> = { </li><li>  <font color="#008000">0</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">1</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chas \" \ "\ n"</font> ], </li><li>  <font color="#008000">2</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasa \" \ "\ n"</font> ], </li><li>  <font color="#008000">3</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasa \" \ "\ n"</font> ], </li><li>  <font color="#008000">4</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasa \" \ "\ n"</font> ], </li><li>  <font color="#008000">5</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">6</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">7</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">8</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">9</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">10</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">11</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">12</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">13</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">14</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">15</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">16</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">17</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">18</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">19</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">20</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasov \" \ "\ n"</font> ], </li><li>  <font color="#008000">21</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chas \" \ "\ n"</font> ], </li><li>  <font color="#008000">22</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasa \" \ "\ n"</font> ], </li><li>  <font color="#008000">23</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / hour \ / chasa \" \ "\ n"</font> ], </li><li>  }; </li><li></li><li>  my <font color="#cc6633">$ m_name</font> = { </li><li>  <font color="#008000">1</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / yanvarya \" \ "\ n"</font> ], </li><li>  <font color="#008000">2</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / fevralya \" \ "\ n"</font> ], </li><li>  <font color="#008000">3</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / marta \" \ "\ n"</font> ], </li><li>  <font color="#008000">4</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / aprelya \" \ "\ n"</font> ], </li><li>  <font color="#008000">5</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / maya \" \ "\ n"</font> ], </li><li>  <font color="#008000">6</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / iunya \" \ "\ n"</font> ], </li><li>  <font color="#008000">7</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / iylya \" \ "\ n"</font> ], </li><li>  <font color="#008000">8</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / avgusta \" \ "\ n"</font> ], </li><li>  <font color="#008000">9</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / sentyabrya \" \ "\ n"</font> ], </li><li>  <font color="#008000">10</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / octyabya \" \ "\ n"</font> ], </li><li>  <font color="#008000">11</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / noyabrya \" \ "\ n"</font> ], </li><li>  <font color="#008000">12</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / m \ / decabrya \" \ "\ n"</font> ] </li><li>  }; </li><li></li><li>  my <font color="#cc6633">$ tod_name</font> = { </li><li>  <font color="#008000">0</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / tod \ / noch'u \" \ "\ n"</font> ], </li><li>  <font color="#008000">1</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / tod \ / utrom \" \ "\ n"</font> ], </li><li>  <font color="#008000">2</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / tod \ / dnem \" \ "\ n"</font> ], </li><li>  <font color="#008000">3</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / tod \ / vecherom \" \ "\ n"</font> ] </li><li>  }; </li><li></li><li>  my <font color="#cc6633">$ cloudiness_name</font> = { </li><li>  <font color="#008000">0</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / cloudiness \ / yasno \" \ "\ n"</font> ], </li><li>  <font color="#008000">1</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / cloudiness \ / malooblachno \" \ "\ n"</font> ], </li><li>  <font color="#008000">2</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / cloudiness \ / oblachno \" \ "\ n"</font> ], </li><li>  <font color="#008000">3</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / cloudiness \ / pasmurno \" \ "\ n"</font> ] </li><li>  }; </li><li></li><li>  my <font color="#cc6633">$ precipitation_name</font> = { </li><li>  <font color="#008000">4</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / precipitation \ / dozhd '\" \ "\ n"</font> ], </li><li>  <font color="#008000">5</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / precipitation \ / liven '\" \ "\ n"</font> ], </li><li>  <font color="#008000">6</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / precipitation \ / sneg \" \ "\ n"</font> ], </li><li>  <font color="#008000">7</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / precipitation \ / sneg \" \ "\ n"</font> ], </li><li>  <font color="#008000">8</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / precipitation \ / groza \" \ "\ n"</font> ], </li><li>  <font color="#008000">9</font> =&gt; [ <font color="#008000">""</font> ], </li><li>  <font color="#008000">10</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / precipitation \ / bez_osadkov \" \ "\ n"</font> ] </li><li>  }; </li><li></li><li>  my <font color="#cc6633">$ wind_direction_name</font> = { </li><li>  <font color="#008000">0</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / wind_direction \ / severnyi \" \ "\ n"</font> ], </li><li>  <font color="#008000">1</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / wind_direction \ / severo-vostochnyi \" \ "\ n"</font> ], </li><li>  <font color="#008000">2</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / wind_direction \ / vostochno-uzhnyi \" \ "\ n"</font> ], </li><li>  <font color="#008000">3</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / wind_direction \ / ugo-zapadnyi \" \ "\ n"</font> ] </li><li>  }; </li><li></li><li></li><li>  my <font color="#cc6633">$ xmlWeather</font> = <font color="#0000ff">new</font> XML :: Simple (keeproot =&gt; <font color="#008000">1</font> , searchpath =&gt; <font color="#008000">"."</font> , forcearray =&gt; <font color="#008000">1</font> , suppressempty =&gt; <font color="#008000">''</font> ); </li><li>  my <font color="#cc6633">$ xmlData1</font> = <font color="#cc6633">$ xmlWeather</font> -&gt; XMLin ( <font color="#008000">'/usr/isp/weather/34214_1.xml'</font> ); </li><li>  my <font color="#cc6633">$ xmlData</font> = <font color="#cc6633">$ xmlData1</font> -&gt; {MMWEATHER} [ <font color="#008000">0</font> ] -&gt; {REPORT} [ <font color="#008000">0</font> ] -&gt; {TOWN} [ <font color="#008000">0</font> ] -&gt; {FORECAST}; </li><li></li><li>  $ |  = <font color="#008000">1</font> ; </li><li>  <font color="#0000ff">while</font> (&lt;STDIN&gt;) { </li><li>  chomp ( <font color="#cc6633">$ _</font> ); </li><li>  last <font color="#0000ff">if</font> length ( <font color="#cc6633">$ _</font> ) == <font color="#008000">0</font> ; </li><li>  } </li><li></li><li>  <font color="#696969"># "Po dannym Gismeteo"</font> </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / Po_dannym_Gismeteo \" \ "\ n"</font> ; </li><li>  my <font color="#cc6633">$ i</font> = <font color="#008000">0</font> ; </li><li>  <font color="#0000ff">for</font> ( <font color="#cc6633">$ i</font> = <font color="#008000">0</font> ; <font color="#cc6633">$ i</font> &lt; <font color="#008000">4</font> ; <font color="#cc6633">$ i</font> ++) </li><li>  { </li><li>  <font color="#0000ff">print</font> <font color="#cc6633">$ tod_name</font> -&gt; { <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {tod}} -&gt; [ <font color="#008000">0</font> ]; </li><li>  <font color="#0000ff">print</font> <font color="#cc6633">$ date_name</font> -&gt; { <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {day}} -&gt; [ <font color="#008000">0</font> ]; </li><li>  <font color="#0000ff">print</font> <font color="#cc6633">$ m_name</font> -&gt; { <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {month}} -&gt; [ <font color="#008000">0</font> ]; </li><li>  <font color="#696969">#</font> </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / budet \" \ "\ n"</font> ; </li><li>  <font color="#0000ff">print</font> <font color="#cc6633">$ cloudiness_name</font> -&gt; { <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {PHENOMENA} [ <font color="#008000">0</font> ] -&gt; {cloudiness}} -&gt; [ <font color="#008000">0</font> ]; </li><li>  <font color="#0000ff">print</font> <font color="#cc6633">$ precipitation_name</font> -&gt; { <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {PHENOMENA} [ <font color="#008000">0</font> ] -&gt; {precipitation}} -&gt; [ <font color="#008000">0</font> ]; </li><li>  <font color="#696969"># Temp</font> </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / temp_vosduha_sostavit \" \ "\ n"</font> ; </li><li>  <font color="#0000ff">print</font> digit_string ( <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {TEMPERATURE} [ <font color="#008000">0</font> ] -&gt; {max}); </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / Do \" \ "\ n"</font> ; </li><li>  <font color="#0000ff">print</font> digit_string ( <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {TEMPERATURE} [ <font color="#008000">0</font> ] -&gt; {min}); </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / gradusov_C \" \ "\ n"</font> ; </li><li>  <font color="#696969"># Veter</font> </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / Skorost'_vetra_sostavit \" \ "\ n"</font> ; </li><li>  <font color="#0000ff">print</font> digit_string ( <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {WIND} [ <font color="#008000">0</font> ] -&gt; {max}); </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / Do \" \ "\ n"</font> ; </li><li>  <font color="#0000ff">print</font> digit_string ( <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {WIND} [ <font color="#008000">0</font> ] -&gt; {min}); </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / metrov_v_sekundu \" \ "\ n"</font> ; </li><li>  <font color="#696969"># Atmosfernoe davlenie</font> </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / Atmosfernoe_davlenie_sostavit \" \ "\ n"</font> ; </li><li>  <font color="#0000ff">print</font> digit_string ( <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {PRESSURE} [ <font color="#008000">0</font> ] -&gt; {max}); </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / Do \" \ "\ n"</font> ; </li><li>  <font color="#0000ff">print</font> digit_string ( <font color="#cc6633">$ xmlData</font> -&gt; [ <font color="#cc6633">$ i</font> ] -&gt; {PRESSURE} [ <font color="#008000">0</font> ] -&gt; {min}); </li><li>  <font color="#0000ff">print</font> <font color="#008000">"EXEC Playback weather \ / milimetrov_rtutnogo_stolba \" \ "\ n"</font> ; </li><li></li><li>  } </li><li></li><li></li><li>  <font color="#696969"># ================================================= =================================================</font> </li><li>  <font color="#696969"># ================================================= =================================================</font> </li><li>  <font color="#696969"># ================================================= =================================================</font> </li><li>  sub digit_string { </li><li>  my <font color="#cc6633">$ digit</font> = shift; </li><li>  local <font color="#cc6633">$ _</font> ; </li><li></li><li>  my <font color="#cc6633">$ sign</font> = <font color="#008000">1</font> <font color="#0000ff">if</font> <font color="#cc6633">$ digit</font> = ~ s / ^ - + <font color="#696969">//;</font> </li><li></li><li></li><li>  <font color="#cc6633">$ digit</font> = ~ s <font color="#696969"># ^ 0 + ##;</font> </li><li>  my ( <font color="#cc6633">$ b_dig</font> , <font color="#cc6633">$ s_dig</font> ) = (split (m /[ , <font color="#cc6633">. digit $</font> , <font color="#008000">2</font> )); </li><li>  <font color="#cc6633">$ s_dig</font> = <font color="#008000">""</font> ; </li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># Clear the numbers from the `extra 'characters (100_000,43)</font> </li><li>  <font color="#696969">#</font> </li><li>  <font color="#0000ff">if</font> (defined <font color="#cc6633">$ b_dig</font> <font color="#0000ff">and</font> length <font color="#cc6633">$ b_dig</font> ) { </li><li>  <font color="#696969"># $ b_dig = ~ s # [^ \ d] ## sg;</font> </li><li>  } <font color="#0000ff">else</font> { </li><li>  <font color="#cc6633">$ b_dig</font> = <font color="#008000">""</font> ; </li><li>  } </li><li>  <font color="#0000ff">if</font> (defined <font color="#cc6633">$ s_dig</font> <font color="#0000ff">and</font> length <font color="#cc6633">$ s_dig</font> ) { </li><li>  <font color="#696969"># $ s_dig = ~ s # [^ \ d] ## sg;</font> </li><li>  } <font color="#0000ff">else</font> { </li><li>  <font color="#cc6633">$ s_dig</font> = <font color="#008000">""</font> ; </li><li>  } </li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># We round a penny in a big way, if as a result of rounding</font> </li><li>  <font color="#696969"># get the ruble, then add it to b_dig (rubles)</font> </li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># if (sprintf ('% 0.2f', "0. $ s_dig") == 1) {</font> </li><li>  <font color="#696969"># $ b_dig ++;</font> </li><li>  <font color="#696969"># $ s_dig = '00';</font> </li><li>  <font color="#696969">#} else {</font> </li><li>  <font color="#696969"># $ s_dig = substr (sprintf ('% 0.2f', "0. $ s_dig"), 2);</font> </li><li>  <font color="#696969">#}</font> </li><li>  <font color="#696969">#</font> </li><li>  my @ <font color="#0000ff">array</font> = split ( <font color="#696969">//, ($ b_dig || 0));</font> </li><li></li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># Determine the digit capacity of the number.</font> </li><li>  <font color="#696969">#</font> </li><li>  my <font color="#cc6633">$ class_id</font> = int (scalar (@ <font color="#0000ff">array</font> ) / <font color="#008000">3</font> ); </li><li>  <font color="#cc6633">$ class_id</font> ++ <font color="#0000ff">if</font> (scalar (@ <font color="#0000ff">array</font> )% <font color="#008000">3</font> ); </li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># Unsupported bit depth.</font> </li><li>  <font color="#696969">#</font> </li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ digit</font> <font color="#0000ff">if</font> <font color="#cc6633">$ class_id</font> &gt; <font color="#008000">5</font> ; </li><li></li><li>  my <font color="#cc6633">$ digits_name</font> = { </li><li>  <font color="#008000">0</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / digits \ / 0 \" \ "\ n"</font> , <font color="#008000">""</font> , <font color="#008000">""</font> ], </li><li>  <font color="#008000">1</font> =&gt; [[ <font color="#008000">"EXEC Playback weather \ / digits \ / 1 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 1a \" \ "\ n"</font> ], <font color="#008000">"EXEC Playback weather \ / digits \ / 10 \ "\" \ n "</font> , <font color="#008000">" EXEC Playback weather \ / digits \ / 100 \ "\" \ n "</font> ], </li><li>  <font color="#008000">2</font> =&gt; [[ <font color="#008000">"EXEC Playback weather \ / digits \ / 2 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 2e \" \ "\ n"</font> ], <font color="#008000">"EXEC Playback weather \ / digits \ / 20 \ "\" \ n "</font> , <font color="#008000">" EXEC Playback weather \ / digits \ / 200 \ "\" \ n "</font> ], </li><li>  <font color="#008000">3</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / digits \ / 3 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 30 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 300 \ "\" \ n "</font> ], </li><li>  <font color="#008000">4</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / digits \ / 4 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 40 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 400 \ "\" \ n "</font> ], </li><li>  <font color="#008000">5</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / digits \ / 5 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 50 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 500 \ "\" \ n "</font> ], </li><li>  <font color="#008000">6</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / digits \ / 6 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 60 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 600 \ "\" \ n "</font> ], </li><li>  <font color="#008000">7</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / digits \ / 7 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 70 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 700 \ "\" \ n "</font> ], </li><li>  <font color="#008000">8</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / digits \ / 8 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 80 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 800 \ "\" \ n "</font> ], </li><li>  <font color="#008000">9</font> =&gt; [ <font color="#008000">"EXEC Playback weather \ / digits \ / 9 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 90 \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / 900 \ "\" \ n "</font> ], </li><li>  }; </li><li></li><li>  my <font color="#cc6633">$ dec_digits</font> = { </li><li>  <font color="#008000">11</font> =&gt; <font color="#008000">"EXEC Playback weather \ / digits \ / 11 \" \ "\ n"</font> , </li><li>  <font color="#008000">12</font> =&gt; <font color="#008000">"EXEC Playback weather \ / digits \ / 12 \" \ "\ n"</font> , </li><li>  <font color="#008000">13</font> =&gt; <font color="#008000">"EXEC Playback weather \ / digits \ / 13 \" \ "\ n"</font> , </li><li>  <font color="#008000">14</font> =&gt; <font color="#008000">"EXEC Playback weather \ / digits \ / 14 \" \ "\ n"</font> , </li><li>  <font color="#008000">15</font> =&gt; <font color="#008000">"EXEC Playback weather \ / digits \ / 15 \" \ "\ n"</font> , </li><li>  <font color="#008000">16</font> =&gt; <font color="#008000">"EXEC Playback weather \ / digits \ / 16 \" \ "\ n"</font> , </li><li>  <font color="#008000">17</font> =&gt; <font color="#008000">"EXEC Playback weather \ / digits \ / 17 \" \ "\ n"</font> , </li><li>  <font color="#008000">18</font> =&gt; <font color="#008000">"EXEC Playback weather \ / digits \ / 18 \" \ "\ n"</font> , </li><li>  <font color="#008000">19</font> =&gt; <font color="#008000">"EXEC Playback weather \ / digits \ / 19 \" \ "\ n"</font> </li><li>  }; </li><li></li><li>  my <font color="#cc6633">$ digits_class</font> = { </li><li>  <font color="#008000">'-1'</font> =&gt; [ <font color="#008000">1</font> , <font color="#008000">""</font> , <font color="#008000">""</font> , <font color="#008000">""</font> ], </li><li>  <font color="#008000">0</font> =&gt; [ <font color="#008000">0</font> , <font color="#008000">""</font> , <font color="#008000">""</font> , <font color="#008000">""</font> ], </li><li>  <font color="#008000">1</font> =&gt; [ <font color="#008000">1</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / tysiacha \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / tysiach \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / tysiachi \ "\" \ n "</font> ], </li><li>  <font color="#008000">2</font> =&gt; [ <font color="#008000">0</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / million \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / millionov \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / milliona \ "\" \ n "</font> ], </li><li>  <font color="#008000">3</font> =&gt; [ <font color="#008000">0</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / milliard \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / milliardov \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / milliarda \ "\" \ n "</font> ], </li><li>  <font color="#008000">4</font> =&gt; [ <font color="#008000">0</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / trillion \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / trillionov \" \ "\ n"</font> , <font color="#008000">"EXEC Playback weather \ / digits \ / trilliona \ "\" \ n "</font> ], </li><li>  }; </li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># Determine the length of the left `three '...</font> </li><li>  <font color="#696969">#</font> </li><li>  my <font color="#cc6633">$ id</font> = <font color="#008000">0</font> ; </li><li>  unless ((scalar @ <font color="#0000ff">array</font> )% <font color="#008000">3</font> ) { </li><li>  <font color="#cc6633">$ id</font> = <font color="#008000">2</font> ; </li><li>  } <font color="#0000ff">else</font> { </li><li>  <font color="#cc6633">$ id</font> = ((scalar @ <font color="#0000ff">array</font> )% <font color="#008000">3</font> ) - <font color="#008000">1</font> ; </li><li>  } </li><li></li><li>  my <font color="#cc6633">$ str</font> = <font color="#008000">''</font> ; </li><li>  my <font color="#cc6633">$ sub_str</font> = <font color="#008000">0</font> ; </li><li>  my <font color="#cc6633">$ tvar</font> = <font color="#008000">0</font> ; </li><li></li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ array</font> [ <font color="#008000">0</font> ] == <font color="#008000">0</font> ) { </li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># If rubles are still zero, then we write 'zero rubles',</font> </li><li>  <font color="#696969"># if you don‚Äôt need to just close the next line ...</font> </li><li>  <font color="#696969">#</font> </li><li>  <font color="#cc6633">$ str</font> . = <font color="#cc6633">$ digits_name</font> -&gt; { <font color="#008000">'0'</font> } -&gt; [ <font color="#008000">0</font> ].  <font color="#008000">''</font> .  <font color="#cc6633">$ digits_class</font> -&gt; { <font color="#008000">'0'</font> } -&gt; [ <font color="#008000">2</font> ].  <font color="#008000">''</font> ; </li><li>  } <font color="#0000ff">else</font> { </li><li>  <font color="#0000ff">while</font> (defined ( <font color="#cc6633">$ _</font> = shift @ <font color="#0000ff">array</font> )) { </li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ _</font> &gt; <font color="#008000">0</font> ) { </li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ _</font> == <font color="#008000">1</font> <font color="#0000ff">and</font> <font color="#cc6633">$ id</font> == <font color="#008000">1</font> ) { </li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># Consider the amount to be used in sub num ()</font> </li><li>  <font color="#696969">#</font> </li><li>  <font color="#cc6633">$ sub_str</font> + = <font color="#cc6633">$ _</font> * <font color="#008000">10</font> ; </li><li>  <font color="#0000ff">if</font> (defined ( <font color="#cc6633">$ tvar</font> = shift @ <font color="#0000ff">array</font> ) <font color="#0000ff">and</font> <font color="#cc6633">$ tvar</font> &gt; <font color="#008000">0</font> ) { </li><li>  <font color="#cc6633">$ str</font> . = <font color="#cc6633">$ dec_digits</font> -&gt; { <font color="#cc6633">$ _</font> .  <font color="#cc6633">$ tvar</font> }; </li><li>  <font color="#cc6633">$ sub_str</font> + = <font color="#cc6633">$ tvar</font> ; </li><li>  <font color="#cc6633">$ id</font> -; </li><li>  } <font color="#0000ff">else</font> { </li><li>  unshift @ <font color="#0000ff">array</font> , <font color="#cc6633">$ tvar</font> ; </li><li>  <font color="#0000ff">if</font> (ref <font color="#cc6633">$ digits_name</font> -&gt; { <font color="#cc6633">$ _</font> } -&gt; [ <font color="#cc6633">$ id</font> ] eq <font color="#008000">'ARRAY'</font> ) { </li><li>  <font color="#696969"># $ str. = $ digits_name -&gt; {$ _} -&gt; [$ id] -&gt; [$ digits_class -&gt; {$ class_id-1} -&gt; [0]];</font> </li><li>  } <font color="#0000ff">else</font> { </li><li>  <font color="#cc6633">$ str</font> . = <font color="#cc6633">$ digits_name</font> -&gt; { <font color="#cc6633">$ _</font> } -&gt; [ <font color="#cc6633">$ id</font> ]; </li><li>  } </li><li>  } </li><li>  } <font color="#0000ff">else</font> { </li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># Consider the amount to be used in sub num ()</font> </li><li>  <font color="#696969">#</font> </li><li>  <font color="#cc6633">$ sub_str</font> + = ( <font color="#cc6633">$ _</font> * ( <font color="#008000">10</font> ** <font color="#cc6633">$ id</font> )); </li><li>  <font color="#0000ff">if</font> (ref <font color="#cc6633">$ digits_name</font> -&gt; { <font color="#cc6633">$ _</font> } -&gt; [ <font color="#cc6633">$ id</font> ] eq <font color="#008000">'ARRAY'</font> ) { </li><li>  <font color="#cc6633">$ str</font> . = <font color="#cc6633">$ digits_name</font> -&gt; { <font color="#cc6633">$ _</font> } -&gt; [ <font color="#cc6633">$ id</font> ] -&gt; [ <font color="#cc6633">$ digits_class</font> -&gt; { <font color="#cc6633">$ class_id</font> - <font color="#008000">1</font> } -&gt; [ <font color="#008000">0</font> ]]; </li><li>  } <font color="#0000ff">else</font> { </li><li>  <font color="#cc6633">$ str</font> . = <font color="#cc6633">$ digits_name</font> -&gt; { <font color="#cc6633">$ _</font> } -&gt; [ <font color="#cc6633">$ id</font> ]; </li><li>  } </li><li>  } </li><li>  <font color="#cc6633">$ str</font> . = <font color="#008000">''</font> ; </li><li>  } </li><li>  <font color="#0000ff">if</font> (- <font color="#cc6633">$ id</font> == - <font color="#008000">1</font> ) { </li><li>  <font color="#cc6633">$ id</font> = <font color="#008000">2</font> ; </li><li>  <font color="#cc6633">$ class_id</font> -; </li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ sub_str</font> &gt; <font color="#008000">0</font> ) { </li><li>  <font color="#cc6633">$ str</font> . = num ( <font color="#cc6633">$ sub_str</font> , (@ { <font color="#cc6633">$ digits_class</font> -&gt; { <font color="#cc6633">$ class_id</font> }}) [ <font color="#008000">1</font> .. <font color="#008000">3</font> ]).  <font color="#008000">''</font> ; </li><li>  } elsif ( <font color="#cc6633">$ class_id</font> == <font color="#008000">0</font> ) { </li><li>  <font color="#cc6633">$ str</font> . = <font color="#cc6633">$ digits_class</font> -&gt; { <font color="#cc6633">$ class_id</font> } -&gt; [ <font color="#008000">2</font> ].  <font color="#008000">''</font> ; </li><li>  } </li><li>  <font color="#cc6633">$ sub_str</font> = <font color="#008000">0</font> ; </li><li>  } </li><li>  } </li><li>  } </li><li></li><li>  <font color="#cc6633">$ str</font> . = <font color="#cc6633">$ s_dig</font> .  <font color="#008000">''</font> .  num ( <font color="#cc6633">$ s_dig</font> , (@ { <font color="#cc6633">$ digits_class</font> -&gt; { <font color="#008000">'-1'</font> }}) [ <font color="#008000">1</font> .. <font color="#008000">3</font> ]); </li><li></li><li>  <font color="#0000ff">if</font> (defined <font color="#cc6633">$ sign</font> ) { </li><li>  <font color="#cc6633">$ str</font> = <font color="#008000">"EXEC Playback weather \ / digits / minus \" \ "\ n"</font> .  <font color="#cc6633">$ str</font> ; </li><li>  } </li><li></li><li>  <font color="#cc6633">$ s_dig</font> = substr ( <font color="#cc6633">$ str</font> , <font color="#008000">0</font> , <font color="#008000">1</font> ); </li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># In the case where it was used it turned out easier</font> </li><li>  <font color="#696969"># so, than through use locale &amp; ucfirst ...</font> </li><li>  <font color="#696969">#</font> </li><li>  <font color="#0000ff">if</font> ( <font color="#cc6633">$ s_dig</font> = ~ tr / abvgdeyzkykmnoprstufkhtschshchyyyyuya / abvgdeyezhziyklmlopprstufhtstshschschyyuya /) { </li><li>  substr ( <font color="#cc6633">$ str</font> , <font color="#008000">0</font> , <font color="#008000">1</font> , <font color="#cc6633">$ s_dig</font> ); </li><li>  } </li><li></li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ str</font> ; </li><li>  } </li><li></li><li>  <font color="#696969">#</font> </li><li>  <font color="#696969"># Used when translating money into a string in words ..</font> </li><li>  <font color="#696969">#</font> </li><li></li><li>  sub num { </li><li>  my <font color="#cc6633">$ d1</font> = <font color="#cc6633">$ _</font> [ <font color="#008000">0</font> ]% <font color="#008000">10</font> ; </li><li>  my <font color="#cc6633">$ d2</font> = int (( <font color="#cc6633">$ _</font> [ <font color="#008000">0</font> ]% <font color="#008000">100</font> ) / <font color="#008000">10</font> ); </li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ _</font> [ <font color="#008000">2</font> ] <font color="#0000ff">if</font> (( <font color="#cc6633">$ d2</font> == <font color="#008000">1</font> ) <font color="#0000ff">or</font> ( <font color="#cc6633">$ d1</font> = ~ / [ <font color="#008000">05</font> - <font color="#008000">9</font> ] /)); </li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ _</font> [ <font color="#008000">1</font> ] <font color="#0000ff">if</font> ( <font color="#cc6633">$ d1</font> == <font color="#008000">1</font> ); </li><li>  <font color="#0000ff">return</font> <font color="#cc6633">$ _</font> [ <font color="#008000">3</font> ]; </li><li>  } </li><li></li></ol></blockquote><br><br><h6>  Next we need to teach Asterisk to use this script.  To do this, in the <b>extensions.conf</b> file in the right context, we write it like this: </h6><br><br><blockquote> <code><a href="http://s-c.me/3684/s"></a> <a href="http://s-c.me/3684/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  exten =&gt; XXXX, 1, Wait (1) </li><li>  exten =&gt; XXXX, n, Answer () </li><li>  exten =&gt; XXXX, n, Agi (/usr/isp/weather/weather.pl) </li><li>  exten =&gt; XXXX, n, Hangup () </li><li></li></ol></blockquote><br><h6>  Where XXXX is the number you want to assign to the Weather service.  For example, I have a Digium board, through which everyone can check the weather by calling from any phone. <br>  That's all! </h6></div><p>Source: <a href="https://habr.com/ru/post/70771/">https://habr.com/ru/post/70771/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../70765/index.html">The introduction of free software in schools in Russia. Results of the tender NP-12</a></li>
<li><a href="../70766/index.html">Barking Collar</a></li>
<li><a href="../70767/index.html">Conflict between the Android community and Google</a></li>
<li><a href="../70769/index.html">Google Earth launches climate simulator</a></li>
<li><a href="../70770/index.html">11th birthday</a></li>
<li><a href="../70772/index.html">Chineses thought up how to make a stand for iPhone from a paper clip</a></li>
<li><a href="../70773/index.html">Admins Habra hide habrazhenschinah!</a></li>
<li><a href="../70774/index.html">Point of View Mobii ION 230</a></li>
<li><a href="../70777/index.html">What and how to write (part 1. Eclipse and Java)</a></li>
<li><a href="../70781/index.html">Learn to make money from 1C</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>