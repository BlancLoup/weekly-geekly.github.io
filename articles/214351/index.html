<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attacks on banking systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I do not remember on Habr√© articles about attacks on banks. No theory and fantasy, real practice and screenshots 
 A little introduction. Not so long ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attacks on banking systems</h1><div class="post__text post__text-html js-mediator-article"><h5>  I do not remember on Habr√© articles about attacks on banks.  No theory and fantasy, real practice and screenshots </h5><br>  A little introduction.  Not so long ago, I spoke at the VI Ural Forum on Information Security of Banks, where a lot of attention was paid to the new CBR standard on ensuring information security of banking systems, and my report was on the same topic.  The standard identifies 7 stages of the life of banking systems (software), from writing TK to decommissioning.  And the outline of my report was the following - to tell some real stories of attacks, projecting them onto a new standard from the Central Bank, and showing how it (the standard) could ‚Äúbreak‚Äù these vectors if the banks applied it.  And on Habr√©, I will publish a retelling of my speech <i>(carefully, pictures!)</i> .  Oh and yes - all information is provided solely for the purpose of familiarization and in no case is not a guide to action. <br><a name="habracut"></a><br><h4>  Story # 1 - popular, SSL'naya </h4><br>  We all know about SSL.  All sensetive data must be transmitted through encrypted data, in the case of the web it is via HTTPS <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e93/6db/f0e/e936dbf0e5613edb3b51667a24d3d983.jpg"><br>  <i>We all know about this green color at the beginning of the navigation bar.</i>  <i>Who am I telling?</i> <br><br>  And in the case of a ‚Äúman in the middle‚Äù attack with a ‚Äústrip‚Äù (substitution) of the certificate <br>  : <br><img src="https://habrastorage.org/getpro/habr/post_images/649/0ac/a34/6490aca348c0001b737557f615adcaee.gif" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The client browser will swear to the wrong certificate: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9f2/d7c/169/9f2d7c1698934e14110673c6613af97a.jpg"><br>  <i>MitM Google</i> <br><br>  The bar will ‚Äúblush‚Äù and warnings will be in the whole window. <br><br>  With banks, too.  The bank, wherever necessary, prescribed HTTPS for clients, everywhere they use an encrypted connection.  And if there is traffic interception, then the client will see a warning, this technical part goes to the shoulders of browser developers. <br><br>  But there comes a time when the bank releases the application for mobile platforms.  And here is the verification of such things passes on the shoulders of the developers of the banking client.  As with the same attack - the substitution of the certificate between the client (mobile application) and the bank API, a situation may arise that the certificate is not verified.  For an attacker, the attack is similar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf1/4a2/650/bf14a26505f40c47df5306647cf3bef6.png"><br>  <i>MitM proxy when replacing SSL traffic</i> <br><br>  As a result, an attacker can replace the transaction with the client and divert money.  Problems at stages: <br><br><ul><li>  <b>Development TK</b> .  TK should be developed taking into account the specifics of the software and knowledge of the future environment of the application, including  (and we are only talking about this in this article) from a security point of view; </li><li>  <b>Creation and testing</b> .  Well, this is understandable.  The error in fact was implemented when writing the code, and the tests missed it; </li><li>  <b>Acceptance and commissioning</b> .  The new standard says this - put the system into action - do pentest. </li></ul><br>  <i>PS And for good, it is necessary not only to check the certificate correctly, but also to do SSL Pining - sew the imprint of the bank certificate into the application itself (and check!)</i> <br><br><h4>  Story # 2 - Hardcore </h4><br>  It seems the previous story was too simple (albeit popular).  Therefore, we will add techniques and set a goal - to penetrate the bank‚Äôs internal network, i.e.  get an oversight car.  And we will not be wise, the idea of ‚Äã‚Äãthe vector will be simple: send a letter with a flood and get a return gateway. <br><br>  Getting started.  First, we collect all the available emails (via harvester, by hand, somehow else).  It is advisable to find mail security officers.  We send mail via the SMTP protocol, which by its architecture allows you to specify any sender.  And we receive the <b>first moment: we will send the letter from the security service of the bank to the operator</b> (trying to increase the level of trust). <br><br>  Good.  Now we need to think about investing.  Just a trojan?  Too easy.  Available in public is an <a href="http://www.exploit-db.com/exploits/29881/">Adobe Acrobat Reader - ASLR / DEP Bypass Exploit with SANDBOX BYPASS</a> , which affects three branches of a super popular PDF reader and bypasses all kinds of protections.  The probability that it will be installed in the bank is very high. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a2f/4cb/0eb/a2f4cb0eb6563d8e7056b8456b863ab9.jpg"><br>  <i>1 - we are sending the letter, 2 - the letter is delivered to the addressee, 3 - we believe that the addressee has opened the letter</i> <br><br>  So, we are at step 3. Most likely, we will get into the CIS, where there should not be the Internet as such (or very limited).  <b>The second point is using DNS tunneling for the reverse gateway</b> .  In short - if you are on a network where there is no ‚ÄúInternet‚Äù, but when you ping a website, its IP resolves, for example <br><br><pre><code class="hljs pgsql">Pinging somesite.ru [<span class="hljs-number"><span class="hljs-number">162.243</span></span><span class="hljs-number"><span class="hljs-number">.231</span></span><span class="hljs-number"><span class="hljs-number">.60</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> data: Request timed <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>. Request timed <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>. Request timed <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>. Request timed <span class="hljs-keyword"><span class="hljs-keyword">out</span></span>.</code> </pre> <br><br>  This means that you can still get to the external network.  Often found in practice in banks and in all sorts of hotels.  The idea is the following - a domain is taken, which is configured on its own special DNS server, which logs all calls.  Data are taken and encoded into subdomains of this domain.  A rough example: <br><br><pre> <code class="hljs css">0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x11112222222233333333</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.attacker</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.com</span></span> 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x33333344444444445555</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.attacker</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.com</span></span> 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x55555666666666777777</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.attacker</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.com</span></span> 0<span class="hljs-selector-tag"><span class="hljs-selector-tag">x77777788888888999999</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.attacker</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.com</span></span></code> </pre> <br>  The DNS server decrypts them and sends reverse commands.  Problem solved - access to internal network received :) <br><br>  Problems at three stages: acceptance and commissioning, operation, maintenance and modernization ‚Äî for the attacker, they most often ‚Äúlook‚Äù like one ‚Äî problems in the internal infrastructure. <br><br><h4>  Story # 3 - true banking </h4><br>  If the first two stories can be projected not only onto banks, the third one is specific in its essence (although, who knows).  Banks do not often develop their software, and often buy box solutions.  The next article sent an attack from one of them from the BSS (I‚Äôll make a reservation right away, this has already been <a href="http://habrahabr.ru/users/jrun/" class="user_link">mentioned</a> many times, including by my colleague <a href="http://habrahabr.ru/users/jrun/" class="user_link">JRun</a> at <a href="http://2013.zeronights.org/includes/docs/Gleb_Cherbov_-_DBO_Hacking_-_arch_bugs_in_BSS.pptx">ZeroNights</a> ). <br><br>  RBOs are remote banking systems.  And they are separated - on physical.  Persons and on jur.  individuals.  And secondly, in these systems there is an opportunity - to send documents to the bank (any!). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c3c/4d0/085/c3c4d0085004100ad75f03dfbf86b58a.jpg"><br>  <i>It looks something like this</i> <br><br>  The document is sent: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a54/d93/806/a54d938063b926f8653536f9eabb0f7f.jpg"><br>  <i>Any of our document after sending</i> <br><br>  And comes to the operator: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6be/0ad/2b3/6be0ad2b3b96b1aa4a09a8c4a27777b8.jpg"><br>  <i>The operator has special desktop software for processing such requests</i> <br><br>  He opens it, and after that on our account 13 billion rubles: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/14e/24c/0bf/14e24c0bf7764ec1d595f7d0a3257fdb.jpg"><br>  <i>Customer account, after the operator opened the attachment</i> <br><br>  WTF !? <br><br>  The problem is architectural - the operator's software is arranged as follows: it works directly with the database with SQL queries, and the login is sewn right into the client: the password for connecting to the database (yes, they are encrypted, but on a shared key that was successfully extracted by reverse engineering the operator‚Äôs software). ).  The interface, login / password of the operator itself are only visual limitations, which can be simply thrown out and connected by the SQL manager directly to the database. <br><br>  Here it is clear that the main problem at the stage of TZ and design (oh, I met an article on Habr√© where the author in the mobile application also went directly to the database), but also at the stages of creation, testing and commissioning.  Yes, it‚Äôs an architectural problem, but you can limit the files that are started on the workstation, in Windows it‚Äôs not so difficult. <br><br>  I think, on Habr√© there are not so many bank workers, but I am sure that it was easy for software developers / admins / testers to learn. </div><p>Source: <a href="https://habr.com/ru/post/214351/">https://habr.com/ru/post/214351/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../214339/index.html">Python-digest # 16. News, interesting projects, articles and interviews [February 23, 2013 - March 2, 2014]</a></li>
<li><a href="../214343/index.html">We are writing to monitor the availability of tickets for Russian Railways, part 2</a></li>
<li><a href="../214345/index.html">Useful materials for mobile developer # 42 (February 24 - March 2)</a></li>
<li><a href="../214347/index.html">Script Automator, loading images on Habrastorage: the second coming</a></li>
<li><a href="../214349/index.html">Arduino in the hands of designers</a></li>
<li><a href="../214353/index.html">Mediatek announced a 64-bit LTE chip</a></li>
<li><a href="../214355/index.html">We program a microwave or controller 40 years ago</a></li>
<li><a href="../214359/index.html">Video banned on YouTube due to the 5-second presence of the actress</a></li>
<li><a href="../214361/index.html">Lenovo's first mobile trade show: MWC 2014</a></li>
<li><a href="../214363/index.html">Introducing Nokia Imaging SDK 1.1 with support for Windows 8.1 and Windows RT 8.1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>