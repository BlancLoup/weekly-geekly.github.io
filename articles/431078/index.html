<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Javascript error handling guide</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bugs are good. The author of the material, the translation of which we are publishing today, says that he is confident that this idea is known to all....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Javascript error handling guide</h1><div class="post__text post__text-html js-mediator-article">  Bugs are good.  The author of the material, the translation of which we are publishing today, says that he is confident that this idea is known to all.  At first glance, errors seem to be something scary.  They may have some kind of loss.  An error made in public harms the authority of the one who made it.  But, making mistakes, we learn from them, which means that the next time we get into a situation in which we have behaved incorrectly, we do everything as it should. <br><br> <a href="https://habr.com/company/ruvds/blog/431078/"><img src="https://habrastorage.org/webt/9q/dw/s5/9qdws5ejk1iibkjghqujq6m4c_4.jpeg"></a> <br><br>  Above, we talked about the mistakes that people make in ordinary life.  Errors in programming are something else.  Error messages help us improve the code, they allow us to inform users of our projects that something has gone wrong, and, perhaps, tell users how to behave so that errors do not occur anymore. <br><a name="habracut"></a><br>  This JavaScript error handling material is divided into three parts.  First we will give a general overview of the error handling system in JavaScript and talk about the error objects.  After that, we will look for the answer to the question of what to do with errors that occur in the server code (in particular, when using the Node.js + Express.js bundle).  Next, let's discuss error handling in React.js.  The frameworks that will be considered here are chosen because of their immense popularity.  However, the principles of working with errors that are considered here are universal, so you, even if you do not use Express and React, can easily apply what you have learned to the tools you work with. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The code for the demonstration project used in this material can be found in <a href="https://github.com/gisderdube/graceful-error-handling">this</a> repository. <br><br><h2>  <font color="#3AC1EF">1. Errors in JavaScript and universal ways of working with them</font> </h2><br>  If something went wrong in your code, you can use the following construct. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'something went wrong'</span></span>)</code> </pre> <br>  During the execution of this command, an instance of the <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a> object will be created and an exception will be generated (or, as they say, ‚Äúthrown out‚Äù) with this object.  The <a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Statements/throw">throw</a> statement can generate exceptions containing arbitrary expressions.  At the same time, the execution of the script will stop if measures were not taken to handle the error. <br><br>  Novice JS programmers usually do not use the <code>throw</code> statement.  They, as a rule, are faced with exceptions issued by either the language runtime environment or third-party libraries.  When this happens, something like <code>ReferenceError: fs is not defined</code> gets to the console <code>ReferenceError: fs is not defined</code> and the program execution stops. <br><br><h3>  <font color="#3AC1EF">ErrorProject Error</font> </h3><br>  An <code>Error</code> object instance has several properties that we can use.  The first property of interest is <code>message</code> .  This is exactly the line that can be passed to the error constructor as an argument.  For example, the following shows the creation of an instance of the <code>Error</code> object and the output to the console of a string passed by the constructor through a call to its <code>message</code> property. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> myError = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'please improve your code'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(myError.message) <span class="hljs-comment"><span class="hljs-comment">// please improve your code</span></span></code> </pre> <br>  The second property of the object, very important, is a trace of the error stack.  This is a <code>stack</code> property.  Referring to it, you can view the call stack (error history), which shows the sequence of operations that led to the incorrect operation of the program.  In particular, it allows you to understand which file contains the failed code and see which sequence of function calls resulted in an error.  Here is an example of what can be seen by accessing the <code>stack</code> property. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: please improve your code at <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.&lt;anonymous&gt; (<span class="hljs-regexp"><span class="hljs-regexp">/Users/gi</span></span>sderdube/Documents/_projects/hacking.nosync/error-handling/src/general.js:<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">79</span></span>) at Module._compile (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">689</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span>) at <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.Module._extensions..js (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">700</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span>) at Module.load (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">599</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span>) at tryModuleLoad (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">538</span></span>:<span class="hljs-number"><span class="hljs-number">12</span></span>) at <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>.Module._load (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">530</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>) at <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>.Module.runMain (internal/modules/cjs/loader.js:<span class="hljs-number"><span class="hljs-number">742</span></span>:<span class="hljs-number"><span class="hljs-number">12</span></span>) at startup (internal/bootstrap/node.js:<span class="hljs-number"><span class="hljs-number">266</span></span>:<span class="hljs-number"><span class="hljs-number">19</span></span>) at bootstrapNodeJSCore (internal/bootstrap/node.js:<span class="hljs-number"><span class="hljs-number">596</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>)</code> </pre> <br>  Here, in the upper part, there is an error message, followed by an indication of the code section, the execution of which caused an error, then the place from which this bad section was called is described.  This continues to the most "distant" in relation to the error code fragment. <br><br><h3>  <font color="#3AC1EF">‚ñç Generation and error handling</font> </h3><br>  Creating an instance of the <code>Error</code> object, that is, executing a command like <code>new Error()</code> , does not lead to any special consequences.  Interesting things start to happen after applying the <code>throw</code> operator, which generates an error.  As already mentioned, if this error is not processed, the execution of the script will stop.  In this case, there is no difference whether the <code>throw</code> statement was used by the programmer himself, whether an error occurred in some library or in the language runtime (in the browser or in Node.js).  Let's talk about various error handling scenarios. <br><br><h3>  <font color="#3AC1EF">TryDesign try ... catch</font> </h3><br>  The <code>try...catch</code> is the easiest way to handle errors, which is often forgotten.  Nowadays, however, it is used much more intensively than before, due to the fact that it can be used to handle errors in <code>async/await</code> constructions. <br><br>  This block can be used to handle any errors occurring in the synchronous code.  Consider an example. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(b) <span class="hljs-comment"><span class="hljs-comment">//  b   -   } catch (err) {   console.error(err) //          } console.log(a) //    ,   </span></span></code> </pre> <br>  If, in this example, we did not enclose the failed <code>console.log(b)</code> command in a <code>try...catch</code> , the script would be stopped. <br><br><h3>  <font color="#3AC1EF">Finally finally block</font> </h3><br>  Sometimes it happens that a code needs to be executed regardless of whether an error has occurred or not.  To do this, in the <code>try...catch</code> construct, use the third, optional, block <code>finally</code> .  Often, its use is equivalent to some kind of code that comes right after <code>try...catch</code> , but in some situations it can be useful.  Here is an example of its use. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {   <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(b) <span class="hljs-comment"><span class="hljs-comment">//  b   -   } catch (err) {   console.error(err) //          } finally {   console.log(a) //        }</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç Asynchronous mechanisms - callbacks</font> </h3><br>  Programming in JavaScript is always worth paying attention to the code that runs asynchronously.  If you have an asynchronous function and an error occurs in it, the script will continue to run.  When asynchronous mechanisms in JS are implemented using callbacks (by the way, this is not recommended), the corresponding callback (callback function) usually receives two parameters.  This is something like the <code>err</code> parameter, which may contain an error, and <code>result</code> with the results of an asynchronous operation.  It looks like this: <br><br><pre> <code class="javascript hljs">myAsyncFunc(someInput, (err, result) =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(err) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err) <span class="hljs-comment"><span class="hljs-comment">//           console.log(result) })</span></span></code> </pre> <br>  If an error gets into the callback, it is visible there as an <code>err</code> parameter.  Otherwise, this parameter will get the value <code>undefined</code> or <code>null</code> .  If it turns out that there is something in <code>err</code> , it is important to respond to this, either as in our example, using the <code>return</code> command, or using the <code>if...else</code> and placing commands in the <code>else</code> block to work with the result of the asynchronous operation.  The point is that, in the event that an error occurred, to exclude the possibility of working with the result, the parameter <code>result</code> , which in this case can be set to <code>undefined</code> .  Working with this value, if it is assumed, for example, that it contains an object, can itself cause an error.  Let's say it happens when you try to use a <code>result.data</code> construct or the like. <br><br><h3>  <font color="#3AC1EF">‚ñç Asynchronous mechanisms - promises</font> </h3><br>  To perform asynchronous operations in JavaScript, it is better to use not callbacks but promises.  Here, in addition to improved code readability, there are more advanced error handling mechanisms.  Namely, there is no need to mess around with the object of the error that may fall into the callback function when using promises.  Here a special <code>catch</code> block is provided for this purpose.  It intercepts all errors that occurred in promises that are before it, or all errors that occurred in the code after the previous <code>catch</code> .  Note that if there was an error in the promise that does not have a <code>catch</code> block for processing, this will not stop the execution of the script, but the error message will not be particularly readable. <br><br><pre> <code class="javascript hljs">(node:<span class="hljs-number"><span class="hljs-number">7741</span></span>) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: <span class="hljs-number"><span class="hljs-number">1</span></span>): <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>: something went wrong (node:<span class="hljs-number"><span class="hljs-number">7741</span></span>) DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> a non-zero exit code. *<span class="hljs-regexp"><span class="hljs-regexp">/</span></span></code> </pre> <br>  As a result, you can always recommend, when working with promises, use the <code>catch</code> .  Take a look at an example. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.resolve(<span class="hljs-number"><span class="hljs-number">1</span></span>)   .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">res</span></span></span><span class="hljs-function"> =&gt;</span></span> {       <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(res) <span class="hljs-comment"><span class="hljs-comment">// 1       throw new Error('something went wrong')       return Promise.resolve(2)   })   .then(res =&gt; {       console.log(res) //        })   .catch(err =&gt; {       console.error(err) //  ,     ,         return Promise.resolve(3)   })   .then(res =&gt; {       console.log(res) // 3   })   .catch(err =&gt; {       //      ,      -        console.error(err)   })</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñçAsynchronous mechanisms and try ... catch</font> </h3><br>  After the <code>async/await</code> construction appeared in JavaScript, we returned to the classic error handling method - to <code>try...catch...finally</code> .  Handling errors with this approach is very easy and convenient.  Consider an example. <br><br><pre> <code class="javascript hljs">;(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {       <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> someFuncThatThrowsAnError()   } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (err) {       <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(err) <span class="hljs-comment"><span class="hljs-comment">//       }   console.log('Easy!') //   })()</span></span></code> </pre> <br>  With this approach, errors in asynchronous code are handled in the same way as in synchronous.  As a result, now, if necessary, in a single <code>catch</code> you can handle a wider range of errors. <br><br><h2>  <font color="#3AC1EF">2. Generation and error handling in server code</font> </h2><br>  Now that we have the tools to work with errors, let's look at what we can do with them in real situations.  Generating and correct error handling is an essential aspect of server programming.  There are different approaches to working with errors.  It will demonstrate an approach using a custom constructor for instances of the <code>Error</code> object and error codes that are conveniently passed to the frontend or to any mechanisms using server APIs.  How the backend of a specific project is structured doesn‚Äôt matter much, as with any approach you can use the same ideas for dealing with errors. <br><br>  As a server framework responsible for routing, we will use Express.js.  Let's think about what structure we need to organize an effective error handling system.  So, this is what we need: <br><br><ol><li>  Universal error handling is a kind of basic mechanism suitable for handling any errors, during which a message like <code>Something went wrong, please try again or contact us</code> , prompting the user to try the failed operation again or contact the owner of the server.  This system is not particularly intelligent, but at least it is able to inform the user that something has gone wrong.  This message is much better than ‚Äúendless loading‚Äù or something similar. </li><li>  The handling of specific errors is a mechanism for informing the user of the details of the reasons for the incorrect behavior of the system and giving it specific advice on how to deal with the problem.  For example, this may concern the absence of some important data in the request that the user sends to the server, or that there is already some record in the database that he is trying to add again, and so on. </li></ol><br><h3>  <font color="#3AC1EF">‚ñçDeveloping your own error object constructor</font> </h3><br>  Here we will use the standard <code>Error</code> class and expand it.  Using inheritance mechanisms in JavaScript is risky, but in this case, these mechanisms are very useful.  Why do we need inheritance?  The fact is that in order for us to make the code convenient to debug, we need information about the error stack trace.  Expanding the standard <code>Error</code> class, we, without additional efforts, get the opportunity to trace the stack.  We add two properties to our own error object.  The first is the <code>code</code> property, which can be accessed using an <code>err.code</code> .  The second is the <code>status</code> property.  The HTTP status code will be written to it, which is planned to be transferred to the client part of the application. <br><br>  This is how the <code>CustomError</code> class looks, the code of which is designed as a module. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Error</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(code = 'GENERIC', status = 500, ...params) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(...params)       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>.captureStackTrace) {           <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>.captureStackTrace(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, CustomError)       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.code = code       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.status = status   } } <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = CustomError</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñçRouting</font> </h3><br>  Now that our error object is ready for use, we need to set up the structure of the routes.  As mentioned above, we need to implement a unified approach to error handling, which allows us to handle errors for all routes in the same way.  By default, the Express.js framework does not fully support this workflow.  The fact is that all its routes are encapsulated. <br><br>  In order to deal with this problem, we can implement our own route handler and define the logic of the routes as normal functions.  Thanks to this approach, if the route function (or any other function) throws an error, it will end up in the route handler, which can then be passed to the client-side of the application.  If an error occurs on the server, we plan to send it to the frontend in the following format, assuming that JSON-API will be used for this: <br><br><pre> <code class="javascript hljs">{   <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">'SOME_ERROR_CODE'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">'Something bad happened. Please try again or contact support.'</span></span> }</code> </pre> <br>  If at this stage what is happening seems incomprehensible to you - do not worry - just keep reading, try to work with what is at stake, and gradually you will understand everything.  In fact, if we talk about computer training, the ‚Äútop-down‚Äù approach is used here, when general ideas are discussed first, and then the transition to particulars takes place. <br><br>  Here is the route handler code. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> router = express.Router() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CustomError = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../CustomError'</span></span>) router.use(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (req, res) =&gt; {   <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {       <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> route = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">`.</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${req.path}</span></span></span><span class="hljs-string">`</span></span>)[req.method]       <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> {           <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> result = route(req) <span class="hljs-comment"><span class="hljs-comment">//    route           res.send(result) //   ,     route       } catch (err) {           /*                ,    route             */           if (err instanceof CustomError) {               /*                   -                                  */               return res.status(err.status).send({                   error: err.code,                   description: err.message,               })           } else {               console.error(err) //                  //   -                   return res.status(500).send({                   error: 'GENERIC',                   description: 'Something went wrong. Please try again or contact support.',               })           }       }   } catch (err) {       /*          ,    ,  ,            ,  ,          ,                       */       res.status(404).send({           error: 'NOT_FOUND',           description: 'The resource you tried to access does not exist.',       })   } }) module.exports = router</span></span></code> </pre> <br>  We believe that the comments in the code explain it quite well.  We hope it is more convenient to read them than explanations of the similar code given after it. <br><br>  Now take a look at the route file. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CustomError = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../CustomError'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> GET = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req</span></span></span><span class="hljs-function"> =&gt;</span></span> {   <span class="hljs-comment"><span class="hljs-comment">//       return { name: 'Rio de Janeiro' } } const POST = req =&gt; {   //       throw new Error('Some unexpected error, may also be thrown by a library or the runtime.') } const DELETE = req =&gt; {   //  ,      throw new CustomError('CITY_NOT_FOUND', 404, 'The city you are trying to delete could not be found.') } const PATCH = req =&gt; {   //      CustomError   try {       //   -        throw new Error('Some internal error')   } catch (err) {       console.error(err) //    ,           throw new CustomError(           'CITY_NOT_EDITABLE',           400,           'The city you are trying to edit is not editable.'       )   } } module.exports = {   GET,   POST,   DELETE,   PATCH, }</span></span></code> </pre> <br>  In these examples nothing is done with the queries themselves.  It just looks at different error scenarios.  So, for example, the <code>GET /city</code> request gets into the function <code>const GET = req =&gt;...</code> , the <code>POST /city</code> request gets into the function <code>const POST = req =&gt;...</code> and so on.  This scheme also works when using query parameters.  For example - for a request of the form <code>GET /city?startsWith=R</code>  In general, it is demonstrated here that when handling errors, the frontend can be either a general error, containing only a suggestion to try again or contact the server owner, or an error generated using the <code>CustomError</code> constructor, which contains detailed information about the problem. <br>  General error data will come to the client part of the application in the following form: <br><br><pre> <code class="javascript hljs">{   <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">'GENERIC'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">'Something went wrong. Please try again or contact support.'</span></span> }</code> </pre> <br>  The <code>CustomError</code> constructor is used like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CustomError(<span class="hljs-string"><span class="hljs-string">'MY_CODE'</span></span>, <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-string"><span class="hljs-string">'Error description'</span></span>)</code> </pre> <br>  This gives the following JSON code transmitted to the frontend: <br><br><pre> <code class="javascript hljs">{   <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">'MY_CODE'</span></span>,   <span class="hljs-attr"><span class="hljs-attr">description</span></span>: <span class="hljs-string"><span class="hljs-string">'Error description'</span></span> }</code> </pre> <br>  Now that we have thoroughly worked on the server part of the application, the useless error logs no longer fall into the client side.  Instead, the client gets useful information about what went wrong. <br><br>  Do not forget that <a href="https://github.com/gisderdube/graceful-error-handling">there</a> is a repository with the code considered here.  You can download it, experiment with it, and, if necessary, adapt it to the needs of your project. <br><br><h2>  <font color="#3AC1EF">3. Work with errors on the client</font> </h2><br>  Now it's time to describe the third part of our error handling system, concerning the frontend.  Here it will be necessary, firstly, to handle errors that occur in the client part of the application, and secondly, you will need to notify the user about errors that occur on the server.  We will first understand the display of information about server errors.  As already mentioned, this example will use the React library. <br><br><h3>  <font color="#3AC1EF">‚ñçSaving error information in the application state</font> </h3><br>  Like any other data, errors and error messages can change, so it makes sense to put them in the state of the components.  When a component is mounted, the error data is reset, so when the user first sees the page, there will be no error messages. <br><br>  The next thing you need to understand is that errors of one type should be shown in the same style.  By analogy with the server, here you can select 3 types of errors. <br><br><ol><li>   ‚Äî         ,   ,  , , ,    ,           . </li><li>  ,     ‚Äî   ,      . ,   ,             ,      ,   .        ,         . </li><li>  ,    .    ‚Äî      ,    . </li></ol><br>       ,    ,      .      ,      . ,  ,      . <br><br>      React    , ,  ,          ‚Äî ,  MobX  Redux. <br><br><h3> <font color="#3AC1EF">‚ñç </font> </h3><br>           ,  .       .         ,      .     .       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1fb/5d9/c43/1fb5d9c436f66a99bd3b14d07f543740.jpg"></div><br> <i><font color="#999999">   </font></i> <br><br>    ,     <code>Application.js</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GlobalError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./GlobalError'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {           <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._resetError = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._resetError.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._setError = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._setError.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">GlobalError</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">error</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.error}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">resetError</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this._resetError}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Handling Errors</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">           </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">       )   }   _resetError() {       this.setState({ error: '' })   }   _setError(newError) {       this.setState({ error: newError })   } } export default Application</span></span></code> </pre> <br>  ,  ,  <code>Application.js</code> ,      .  ,           . <br><br>         <code>GlobalError</code> ,                  <code>x</code>  ,   .    <code>GlobalError</code> ( <code>GlobalError.js</code> ). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GlobalError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   render() {       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.props.error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">               </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{{</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">position:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fixed</span></span></span></span><span class="xml"><span class="hljs-tag">',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">top:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">left:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">50</span></span></span></span><span class="xml"><span class="hljs-tag">%',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">transform:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">translateX</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-50</span></span></span></span><span class="xml"><span class="hljs-tag">%)',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">padding:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">10</span></span></span></span><span class="xml"><span class="hljs-tag">,                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">backgroundColor:</span></span></span></span><span class="xml"><span class="hljs-tag"> '#</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ffcccc</span></span></span></span><span class="xml"><span class="hljs-tag">',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">boxShadow:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">3px</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">25px</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-10px</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rgba</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0</span></span></span></span><span class="xml"><span class="hljs-tag">,</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">0.5</span></span></span></span><span class="xml"><span class="hljs-tag">)',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">display:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">flex</span></span></span></span><span class="xml"><span class="hljs-tag">',                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">alignItems:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">center</span></span></span></span><span class="xml"><span class="hljs-tag">',               }}           &gt;</span></span></span><span class="xml">               {this.props.error}                              </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">i</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"material-icons"</span></span></span></span><span class="xml"><span class="hljs-tag">                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{{</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">cursor:</span></span></span></span><span class="xml"><span class="hljs-tag"> '</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">pointer</span></span></span></span><span class="xml"><span class="hljs-tag">' }}                   </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.props.resetError}</span></span></span></span><span class="xml"><span class="hljs-tag">               &gt;</span></span></span><span class="xml">                   close               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">font</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">i</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>           &lt;<span class="hljs-regexp"><span class="hljs-regexp">/div&gt;       )   } } export default GlobalError</span></span></code> </pre> <br>     <code>if (!this.props.error) return null</code> .    ,        .        . , ,  ,        . ,  ,       <code>x</code> ,   -   ,       . <br><br> ,        ,       <code>_setError</code>  <code>Application.js</code> . ,      ,  ,    ,      ( <code>error: 'GENERIC'</code> ).   ( <code>GenericErrorReq.js</code> ). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GenericErrorReq</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this._callBackend}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Click me to call the backend</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">           </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>       )   }   _callBackend() {       axios           .post(<span class="hljs-string"><span class="hljs-string">'/api/city'</span></span>)           .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function"> =&gt;</span></span> {               <span class="hljs-comment"><span class="hljs-comment">//  -     ,               })           .catch(err =&gt; {               if (err.response.data.error === 'GENERIC') {                   this.props.setError(err.response.data.description)               }           })   } } export default GenericErrorReq</span></span></code> </pre> <br>   ,            .          ,       ,        .          . -,         ,  -,    UX-,        ,    ‚Äî . <br><br><h3> <font color="#3AC1EF">‚ñç  ,    </font> </h3><br>      ,    ,        ,   . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dee/2f6/bd1/dee2f6bd1605d89c082a46f6feaa86b6.jpg"></div><br> <i><font color="#999999">   </font></i> <br><br>     ,        .           .          .    <code>SpecificErrorReq.js</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> InlineError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./InlineError'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpecificErrorRequest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {           <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this._callBackend}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Delete your city</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">               </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">InlineError</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">error</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{this.state.error}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">           </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">       )   }   _callBackend() {       this.setState({           error: '',       })       axios           .delete('/api/city')           .then(result =&gt; {               //  -     ,               })           .catch(err =&gt; {               if (err.response.data.error === 'GENERIC') {                   this.props.setError(err.response.data.description)               } else {                   this.setState({                       error: err.response.data.description,                   })               }           })   } } export default SpecificErrorRequest</span></span></code> </pre> <br>   ,      , ,      <code>x</code> . ,         ,     .   ,     ,  ‚Äî   ,    ,  ,    .        , ,    .       ,      ,       ,   ‚Äî     . <br><br><h3> <font color="#3AC1EF">‚ñç,     </font> </h3><br>    ,            ,        ,   . ,                ,       - .            . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/532/553/2f5/5325532f59efd4ff9ad92e2a33209d9f.jpg"></div><br> <i><font color="#999999">   ,     </font></i> <br><br>    <code>SpecificErrorFrontend.js</code> ,   . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> axios <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'axios'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> InlineError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./InlineError'</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpecificErrorRequest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{   <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props) {       <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = {           <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,           <span class="hljs-attr"><span class="hljs-attr">city</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>,       }       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._callBackend.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)       <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._changeCity = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._changeCity.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)   }   render() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (           &lt;div&gt;               &lt;input                   type="text"                   value={this.state.city}                   style={{ marginRight: 15 }}                   onChange={this._changeCity}               /&gt;               &lt;button onClick={this._callBackend}&gt;Delete your city&lt;/button&gt;               &lt;InlineError error={this.state.error} /&gt;           &lt;/div&gt;       )   }   _changeCity(e) {       this.setState({           error: '',           city: e.target.value,       })   }   _validate() {       if (!this.state.city.length) throw new Error('Please provide a city name.')   }   _callBackend() {       this.setState({           error: '',       })       try {           this._validate()       } catch (err) {           return this.setState({ error: err.message })       }       axios           .delete('/api/city')           .then(result =&gt; {               //  -     ,               })           .catch(err =&gt; {               if (err.response.data.error === 'GENERIC') {                   this.props.setError(err.response.data.description)               } else {                   this.setState({                       error: err.response.data.description,                   })               }           })   } } export default SpecificErrorRequest</code> </pre> <br><h3> <font color="#3AC1EF">‚ñç       </font> </h3><br> ,      ,      ( <code>GENERIC</code> ),        ,   .   , ,      , ,  ,    ,   ,   ,           .                 . <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br> ,      ,       -.   <code>console.error(err)</code>      ,    ,  ,   .      -    <a href="https://www.npmjs.com/package/loglevel">loglevel</a> . <br><br>  <b>Dear readers!</b>       ? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/431078/">https://habr.com/ru/post/431078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431066/index.html">Conference DEFCON 16. How can I get hold of you? Let me list the ways. Part 2</a></li>
<li><a href="../431068/index.html">Art of education: the ideology of slot machines</a></li>
<li><a href="../431070/index.html">Hare to eat? Talking about the food habits of a modern IT person</a></li>
<li><a href="../431072/index.html">JavaScript Guide, Part 7: strict mode, this keyword, events, modules, mathematical calculations</a></li>
<li><a href="../431074/index.html">JavaScript Guide, Part 8: ES6 Standard Feature Overview</a></li>
<li><a href="../431080/index.html">How to organize remote offices and not lose a team in space</a></li>
<li><a href="../431082/index.html">Kotlin: Looking for Head of Marketing</a></li>
<li><a href="../431084/index.html">In any incomprehensible situation - write scripts</a></li>
<li><a href="../431086/index.html">Everything you wanted to know about PVS-Studio and did not hesitate to ask</a></li>
<li><a href="../431088/index.html">File management done wrong - Part 1: Hailing from the 90s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>