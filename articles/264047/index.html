<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NGFW. Part 3 - Demonstration of DDoS Protection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Attacks such as distributed denial of service (DDoS) attacks are still in the top lines of the anti-rating. DDoS attacks against commercial organizati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NGFW. Part 3 - Demonstration of DDoS Protection</h1><div class="post__text post__text-html js-mediator-article">  Attacks such as distributed denial of service (DDoS) attacks are still in the top lines of the anti-rating.  DDoS attacks against commercial organizations have proven to be effective in disrupting business and attracting company attention.  For example, through the use of massive botnets collected from compromised computers, hackers launched a series of highly publicized and highly destructive DDoS attacks against US banks. <br><br>  Below is an example of protection against denial of <a href="http://www.darkreading.com/attacks-and-breaches/us-bank-hack-attack-techniques-identified/d/d-id/1108089">service</a> attacks <a href="http://www.darkreading.com/attacks-and-breaches/us-bank-hack-attack-techniques-identified/d/d-id/1108089">using computers infected with malware</a> using <a href="http://habrahabr.ru/company/hp/blog/262123/">HP NGFW</a> .  To test this feature of the firewall, a stand was assembled, as shown in the figure below. <br><br> <a href="http://habrahabr.ru/company/hp/blog/264047/"><img src="https://habrastorage.org/files/fbd/8d9/d14/fbd8d9d14729492fa0d0e4be7c211438.png"></a> <br>  <i><font color="#999999">Stand layout</font></i> <br><a name="habracut"></a><br>  The stand consists of three main parts: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  VMWare-based virtual environment imitating local network + data center (on the left in the diagram) </li><li>  HP NGFW Firewall </li><li>  Virtual environment simulating a segment of the Internet (right on the diagram) </li></ol><br>  A virtual environment that simulates a local network is a virtual machine deployed on a workstation based on the Windows operating system.  To simulate the operation of malicious software, a testing agent capable of generating DDoS traffic is installed on a part of virtual machines. <br><br>  The firewall is installed in the gap between the Internet segment and the local network and at this stand is a third-level device that routes traffic between the segments.  The basic rules and firewall settings are shown in the diagram above. <br><br>  A virtual environment that mimics the Internet segment is a set of virtual machines based on the Linux operating system with specialized software installed on them - among other things, Apache web server, MySQL database server, PHP version 5 interpreter, Nessus security scanner, scan utility nmap network. <br><br><h2>  <font color="#0096d6">Basic Firewall Configuration</font> </h2><br>  Below are the basic settings of NGFW in accordance with the developed stand scheme shown in Figure 3. All settings are shown in the NGFW's own web interface.  Figure 4 shows the settings of the IP interfaces of the FW in accordance with the diagram above. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d75/bee/471/d75bee471329e25cca63e2c46e17a1af.jpg"><br>  <i><font color="#999999">IP interface settings</font></i> <br><br>  Below are the security zone settings.  For simplicity, the booth has three security zones set up - Inside, Outside and VPN. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/618/ad2/6f8/618ad26f88b04bfe3b089590ec69f733.jpg"><br>  <i><font color="#999999">Security Zone Settings</font></i> <br><br>  Figure 6 shows the basic settings made for Destination NAT.  Published several internal addresses of virtual machines that run various network services (HTTP / HTTPS, FTP, etc.). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1c/ddd/00f/d1cddd00fe087c4c0e569ef340a93b01.jpg"><br>  <i><font color="#999999">Destination NAT Settings</font></i> <br><br>  The following shows the basic Source NAT settings.  Several virtual machine addresses are translated to external addresses in order to provide them access to the emulated malware services. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd5/06d/ef8/bd506def84276cc6ef20c56e5e530b17.jpg"><br>  <i><font color="#999999">Source NAT</font></i> <br><br>  The basic FW Policy settings, according to which the traffic is processed, are shown in Figure 8. In order to check how the default IPS policy is processed, we will pass all traffic through the Static FW base filters transparently. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a40/d1c/372/a40d1c37280f7b120a2d75dfeb4f9e9f.jpg"><br>  <i><font color="#999999">Fw policy</font></i> <br><br>  Basic Intrusion Prevention System (IPS) settings.  All recommended IPS filtering categories are included in this test. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/48a/4b4/8f1/48a4b48f1873255f5861813719cf7865.jpg"><br>  <i><font color="#999999">Basic IPS settings</font></i> <br><br>  Setting thresholds for DDoS attacks.  The threshold of IPS on DDoS attack type SYN FLOOD - 100 packets per second. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eaa/c8a/78e/eaac8a78ee0d27ae0573c4208b10c8bb.jpg"><br>  <i><font color="#999999">IPS DDoS</font></i> <br><br>  We emulate the attack according to the classical scheme given in part 2 of the series and try to defend against the attack with the help of NGFW.  At the same time, in a real DDoS attack, filtering by ports / addresses is an ineffective approach, since the infected machines are scattered, as a rule, over the network and have randomly scattered addresses.  Therefore, we skip all traffic to IPS and, as shown above, configure the DDoS protection rule in IPS: <br><br>  <b>1.</b> To make sure that IPS works, turn off the rule on NGFW, according to which the traffic of the source host of the network attack will be blocked: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e3b/5a7/763/e3b5a7763ad66e58c1f8696e2f1b0ad8.jpg"><br><br>  <b>2.</b> Start the network DDoS attack and look at the Wireshark logs and observe the classic DoS attack with the agent-infected virtual machine: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9a1/36f/801/9a136f8016dd34dd98232540c2e0a75c.jpg"><br><br>  <b>3.</b> We enable a rule on NGFW IPS that blocks the traffic of the host from which the network attack is coming: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/acf/3e4/2ec/acf3e42ec8df48fbd7d21a70cc8bc0f7.jpg"><br><br>  <b>4.</b> We are convinced in the Wireshark logs that the rule worked and the DoS attack was terminated: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/304/3fd/ee7/3043fdee7c1d592b1b68e1af80693ad2.png"><br><br>  <b>5.</b> We look at the NGFW logs and note that the attack was detected and the traffic from the attacking host is closed: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ea/3dc/cfa/5ea3dccfae0ece01918355a582a38032.jpg"><br><br>  This example shows how, using rules pre-configured in the NGFW intrusion detection system, classic DDoS attacks are detected and prevented.  In conclusion, I would like to say that the functionality of NGFW to repel such threats is not limited to built-in rules (although there are enough rules in NGFW to repel most network threats).  NGFW has a functional on writing and implementing its own rules in policies, which allows you to respond flexibly to the morphic threats of information security.  But more about that next time. </div><p>Source: <a href="https://habr.com/ru/post/264047/">https://habr.com/ru/post/264047/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264037/index.html">Advanced CSS filters</a></li>
<li><a href="../264039/index.html">Free grid control for Xamarin from DevExpress</a></li>
<li><a href="../264041/index.html">Will GCC C ++ be better for AVR and Arduino?</a></li>
<li><a href="../264043/index.html">FP9: The ability to dig and dig</a></li>
<li><a href="../264045/index.html">My system is testing and improving the quality of the GSM gateway. Part two</a></li>
<li><a href="../264049/index.html">Third extra: how we implemented mail collection using OAuth 2.0</a></li>
<li><a href="../264051/index.html">Office as Platform issue 2: Power BI - a new approach to creating business intelligence</a></li>
<li><a href="../264057/index.html">InterSystems Ensemble 2015.1 and 2015.2 release</a></li>
<li><a href="../264059/index.html">We limit the load on the server. Cheap and angry</a></li>
<li><a href="../264063/index.html">Back to the Future - Decapsulation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>