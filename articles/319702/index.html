<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Duplo Railroad Tycoon: Synthesis of the rail network with maximum coverage</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Santa Claus brought the children Duplo railway. Rail segments are very easily interconnected, and you can build some small, most likely just a closed ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Duplo Railroad Tycoon: Synthesis of the rail network with maximum coverage</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/821/583/b7e/821583b7e34d434a8fd7510c29f1adb6.png" alt="image"></div><br>  Santa Claus brought the children Duplo railway.  Rail segments are very easily interconnected, and you can build some small, most likely just a closed path, put the station and watch the train running in a circle.  Sometimes it stops and the baby must ‚Äúfill‚Äù the locomotive from the column, after which the locomotive will go again. <br><a name="habracut"></a><br>  Here is an example of the simplest path: <br><br><img src="https://habrastorage.org/files/e22/b9a/3d3/e22b9a3d36714921a3e579e84f384bf9.jpg" alt="image"><br><br>  I was very bored with this train, the circle after the third, and I went again to dig into the Thingiverse, in order to try to use a 3D printer for something useful one hundred thousand times.  And suddenly I find a <a href="http://www.thingiverse.com/thing:635065">segment-arrow</a> there just for the Duplo locomotive. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The arrow works like this: it has three inputs and outputs, let's call them first, second and third.  If a train enters the first or second node, then it always leaves the arrow through the third.  In this case, the arrow switches to the corresponding node (i.e., if entered through the first, it switches to the first, if through the second, then to the second).  But if he enters the third node, the output depends on the state of the arrow and he can leave both through the first and second.  Those.: <br><br>  '1' -&gt; '3' (the arrow translates to '1') <br>  '2' -&gt; '3' (the arrow translates to '2') <br>  '3' -&gt; if the arrow is on '1', then '1', otherwise '2' <br><br>  I printed out a couple of such shooters, and began to collect the "normal" railway.  But everything worked out somehow sadly - the locomotive traveled only along part of the way, stuck on some ring, and did not want to leave it. <br><br>  Problem one (simple): How many shooter segments should there be in a network so that all nodes are interconnected?  The road must be continuous and not have dead ends. <br><br><div class="spoiler">  <b class="spoiler_title">Answer</b> <div class="spoiler_text">  The shooter must be a mandatory even number.  It is easy to understand if you mentally imagine two nodes of the three arrows connected to each other.  That is, an arrow is always plus one free knot. <br></div></div><br>  But podnapryagis, for the simplest version, I solved the problem in a few days.  A friend who came to visit decided it in 5 minutes without straining :) <br><br>  Denote each arrow with a letter, nodes as in the example above.  Those.  there are nodes in our network ['a1', 'a2', 'a3', 'b1', 'b2', 'b3']. <br><br><div class="spoiler">  <b class="spoiler_title">Decision</b> <div class="spoiler_text">  For two arrows: <br>  [('a1', 'a2'), ('a3', 'b3'), ('b1', 'b2')] <br>  So and the only way the train will pass all segments of the road in different directions.  <s>In fact, for two shooters there are only two solutions - this one and the wrong one.</s>  Brad wrote, and no one noticed.  La-la-la ... <br></div></div><br>  And what if you take more shooters?  Hmm, if I thought so much about a simple solution, then I‚Äôm obviously not going to master it anymore.  But master the computer!  But how to get to this task?  I struggled for a few days, trying to add some depth search to this, and I almost left everything, when suddenly I had the idea to write a solution on a piece of paper. <br><br>  I just broke the whole track into steps: <br><br>  Current state ‚Üí Go to arrow ‚Üí Go to connecting segment ‚Üí Remember new state of arrows <br><br>  Those.  For the solution above, the transitions will be as follows (the state of the arrows: a3-&gt; a1; b3-&gt; b1): <br><br>  a1 -&gt; a3 -&gt; b3 (a3-&gt; a1; b3-&gt; b1) <br>  b3 -&gt; b1 -&gt; b2 (a3-&gt; a1; b3-&gt; b1) <br>  b2 -&gt; b3 -&gt; a3 (a3-&gt; a1; b3-&gt; b2) ## note that the arrow b3 has switched <br><br>  Further simple: <br><br><ul><li>  We generate all possible road configurations for a given number of arrows. </li><li>  For each road: <br><ul><li>  We run the train 10 times and count the number of passage for each node </li><li>  If there are nodes with 0 or 1 passage, then this means the system after entering the mode fell into an infinite loop </li><li>  If there are no such nodes, then the train is safely worn all the way, which is what we need! </li></ul></li></ul><br>  So simple, that I fought my head on the table for two days and eventually went to ask for advice on stackoverflow, where I was given a number of solutions on a silver platter in a matter of minutes. <br><br>  Track Generator (I will not declare the task and put it in the spoiler - for someone like me it can be a very cruel joke, but try it yourself for the sake of interest to solve): <br><br><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrack</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># recursion anchor, basic case: # when we have 2 nodes only one pair is possible if len(l) == 2: yield [tuple(l)] else: # Pair the first node with all the others for i in range(1, len(l)): # Current pair pair1 = [(l[0], l[i])] # Combine it with all pairs among the remaining nodes remaining = l[1:i] + l[i+1:] for otherPairs in getTrack2(remaining, 1): yield pair1 + otherPairs</span></span></code> </pre> <br>  Reshalk tracks: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solveTrack</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(track)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#        nodeCount = {} for n in nodes: nodeCount[n] = 0 railTr = None jointTr = 'a1' while True: pos = jointTr #  nodeCount[pos] += 1 #  railTr = getTransition(track, pos) #    (    ) nodeCount[railTr] += 1 #    jointTr = tj[railTr] #   (    ,        ) if railTr[1] in ['1','2']: ##  tj[railTr[0]+'3'] = railTr if max(nodeCount.values()) &gt; nodesTrace and min(nodeCount.values()) &lt; 3: #       nodesTrace ,     .   -   -     . #print "Infinite cycle detected" break #sol = "{}\t{}\t{}\t{}\t{}".format(pos, railTr, jointTr, tj['a3'], tj['b3']) #print sol if max(nodeCount.values()) &gt; nodesTrace * 1.5: print "-------------------------------------------------------\n" print "Simulation complete!" print '\nNodes: ', nodeCount, "\n" print "Solution: ", track break return</span></span></code> </pre> <br>  It remains only to specify a list of nodes for the input data, transitions between nodes of the arrow and begin the search for a solution!  Hooray! <br><br><pre> <code class="python hljs">tj = {} <span class="hljs-comment"><span class="hljs-comment">#  nodes = [] #  ##create joints transition table for jt in range(nJoints): tj[idxs[jt]+'1'] = idxs[jt]+'3' tj[idxs[jt]+'2'] = idxs[jt]+'3' tj[idxs[jt]+'3'] = idxs[jt]+'1' nodes.extend((idxs[jt]+'1', idxs[jt]+'2', idxs[jt]+'3'))</span></span></code> </pre> <br>  Hmm, but there is no solution near the road with four arrows.  And with six (I waited a few hours) - also not.  That's all.  The dream is over. <br><br>  Although.  But what if you make only a part of the arrows switchable and freeze the rest?  For example: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> railTr[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> idxs[:nSwitchableJoints]: <span class="hljs-comment"><span class="hljs-comment">## nSwitchableJoints -     if railTr[1] in ['1','2']: ##  tj[railTr[0]+'3'] = railTr</span></span></code> </pre> <br>  And voila - there are solutions and there are a lot of them!  I tried to choose something prettier :) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9eb/941/6a0/9eb9416a0bdc47a883b6da68570a71e6.jpg" alt="image"></div><br>  Here, only the arrow 'a' is switchable, the other three are always resolved to one. <br>  This track corresponds to the solution: <br><br><pre> <code class="python hljs">[(<span class="hljs-string"><span class="hljs-string">'a1'</span></span>, <span class="hljs-string"><span class="hljs-string">'c3'</span></span>), (<span class="hljs-string"><span class="hljs-string">'a2'</span></span>, <span class="hljs-string"><span class="hljs-string">'f3'</span></span>), (<span class="hljs-string"><span class="hljs-string">'a3'</span></span>, <span class="hljs-string"><span class="hljs-string">'b3'</span></span>), (<span class="hljs-string"><span class="hljs-string">'b1'</span></span>, <span class="hljs-string"><span class="hljs-string">'d2'</span></span>), (<span class="hljs-string"><span class="hljs-string">'b2'</span></span>, <span class="hljs-string"><span class="hljs-string">'e1'</span></span>), (<span class="hljs-string"><span class="hljs-string">'c1'</span></span>, <span class="hljs-string"><span class="hljs-string">'e2'</span></span>), (<span class="hljs-string"><span class="hljs-string">'c2'</span></span>, <span class="hljs-string"><span class="hljs-string">'f1'</span></span>), (<span class="hljs-string"><span class="hljs-string">'d1'</span></span>, <span class="hljs-string"><span class="hljs-string">'f2'</span></span>), (<span class="hljs-string"><span class="hljs-string">'d3'</span></span>, <span class="hljs-string"><span class="hljs-string">'e3'</span></span>)] nSwitchableJoints = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  That's all, bye! </div><p>Source: <a href="https://habr.com/ru/post/319702/">https://habr.com/ru/post/319702/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319692/index.html">Auto compiler objects</a></li>
<li><a href="../319694/index.html">The continuation of the epic with a USB stack</a></li>
<li><a href="../319696/index.html">How to iterate over all permutations and about factorial decomposition of natural numbers</a></li>
<li><a href="../319698/index.html">Windows has an internal list of undelete root certificates.</a></li>
<li><a href="../319700/index.html">Introduction to the 8pt mesh system</a></li>
<li><a href="../319704/index.html">The system of recommendations online store based on methods of machine learning in the Compute Engine (Google Cloud Platform)</a></li>
<li><a href="../319706/index.html">Auto-find IPs</a></li>
<li><a href="../319708/index.html">Battle of ideas</a></li>
<li><a href="../319710/index.html">8 network resources to remove malicious code and eliminate the consequences of hacking the site</a></li>
<li><a href="../319712/index.html">Crysis at the maximum speed, or why the server needs a video card</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>