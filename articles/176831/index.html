<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>EIGRP Composite Metric</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Which just did not have to read articles about the composite metric of EIGRP. Both very useful and frankly stupid. Let's look at what‚Äôs what. I will t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>EIGRP Composite Metric</h1><div class="post__text post__text-html js-mediator-article">  Which just did not have to read articles about the composite metric of EIGRP.  Both very useful and frankly stupid.  Let's look at what‚Äôs what.  I will try not to chew on what has already been chewed 10 times, but to point out the interesting, in my opinion, features and tricks of counting this composite metric in a short article.  Recall the nightmarish formula: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f63/fcb/727/f63fcb727c97b241afb4ef0a50facf86.png" alt="image"><br><br><a name="habracut"></a>  Here it is very important to remember the first rule once and for all: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Rule 1:</b> K-values ‚Äã‚Äãare not bandwidth, delay, loading, or whatever it was like we were taught in the CCNA track or in many articles!  K-values ‚Äã‚Äã(K1, K2, K3, K4 and K5) are some indices, changing which we can influence the calculation of the composite metric.  The BW value is not just the minimum bandwidth value, but 10,000,000 (10 ^ 7) divided by the minimum bandwidth value, and delay is not just the sum of all interface delays, but the amount divided by 10. <br><br>  As we all know, the following parameters are used to calculate the route metrics: <br><br><ul><li>  The minimum value of bandwidth among all interfaces along the route </li><li>  The sum of the delay values ‚Äã‚Äãof all interfaces along the route </li><li>  Reliability </li><li>  Load </li><li>  Minimum MTU among all interfaces along the route </li></ul><br>  With bandwidth, everything is simple.  We received an announcement on some kind of interface.  If the bandwidth on this interface is less than what we received in the announcement, we substitute the value in the announcement and send the helmet further.  Thus, from any point to any, the end point will receive an announcement with a minimum bandwidth value along the entire route.  The same rule applies to MTU.  By the way, both values ‚Äã‚Äãare taken into account, and L2 MTU of the interface, and L3 IP MTU, a smaller value is chosen.  This is not written in the books.  Another interesting fact is that the change of MTU on the interface does not cause the update of the route, and in order for the change to take effect, you have to pull the interface, or change another parameter, such as delay or bandwidth, to trigger update.  Another little known fact. <br><br>  Delay is still easier.  Received an announcement on the interface - added to the value of delay your delay of this interface and announce further.  I honestly could not understand exactly how to behave from hop to hop reliability and load, since I could not emulate their change.  I would be glad if someone complements this post. <br>  <b>UPD:</b> The comments suggest that reliability, like bw / mtu, is the worst transmitted on the track.  Load, it seems to be like, is summed up, but until it comes to rest at 255 <br><br>  <b>Rule 2:</b> only the interfaces on which we received the announcement are taken into account in the calculations.  Interfaces where we send these announcements are not considered at all, no matter what bandwidth, delay, MTU parameters would be on them. <br><br>  Here the head begins to break.  How does a router, having received an announcement, find out what is the minimum bandwidth on the way to subtract it from the composite metric and replace it with its own?  How with other parameters?  Interesting.  Open the book <i>Troubleshooting IP Routing Protocols (CCIE Professional Development)</i> , which contains the structure of the EIGRP IP Internal Route TLV package: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ed/6dc/2f3/8ed6dc2f36a1d4a92e4d52d3e8d82d13.png" alt="image"><br><br>  Where is the composite metric here?  And not her.  Only the parameters themselves are passed from hop to hop.  We derive: <br><br>  <b>Rule 3:</b> Composite metric is not transmitted between routers.  The metric is calculated locally on the router, and exists only on it.  Further, the router transmits only the modified bandwidth, delay, MTU, etc. parameters. <br><br>  From here you can draw interesting conclusions.  First, since the composite metric is not transmitted, it becomes extremely clear why the K-values ‚Äã‚Äãmust coincide in order to establish a neighborhood.  Otherwise, each router will consider it in its own way, and not far from the loop.  Secondly, if we consider all 5 parameters transmitted from hop to hop, it becomes clear that we can only adjust one ‚Äî delay, since the bandwidth always carries the minimum bandwidth on the highway, reliability and load are not at all suitable for manual change and have the move is in a very narrow range (1-255), but the MTU is similar to the bandwidth.  Hence, if we carry out Traffic Engineering and adjust the EIGRP metric with the help of the offset-list, we change only the delay value and only that, and do not add / subtract from the entire metric!  Suppose we specify an offset-list that corrects our metric by +100.  As you know, delay is defined in tens of microseconds, then we will immediately multiply by 10, get 1000. Next, we know that the formula for calculating the EIGRP metric multiplies the result of calculations by 256 in order to improve the EIGRP metric, which has the same calculation formula .  So we will divide 1,000 by 256, and we get 3.90, reduce to three.  This means that the next router will receive the delay parameter by 3 microseconds longer than it should have been without an offset-list. <br><br>  Armed with this information, having encountered a task on the CCIE R + S lab that requires giving one route advantage over another, changing the delay parameter, but you are forbidden to change the delay on the interface, feel free to write the usual offset-list. <br><br>  <b>UPD2:</b> As was rightly noted in the comments, MTU does not participate in the calculation of the metric at all.  However, this is one of the attributes that we specify wherever we need to manually specify the metric, for example, during redistribution.  Changing this attribute in the prefix announcement from hop to hop is handled in the same way as attributes affecting the metric. </div><p>Source: <a href="https://habr.com/ru/post/176831/">https://habr.com/ru/post/176831/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../17682/index.html">Yahoo will open a website for IT investors, as in 2000</a></li>
<li><a href="../176823/index.html">Running Windows under Linux KVM</a></li>
<li><a href="../176825/index.html">Decompiling Java Applications</a></li>
<li><a href="../176829/index.html">Google Mirror API published</a></li>
<li><a href="../17683/index.html">The work of the author of the news2.ru logo has become a symbol of the Year of Russia in India</a></li>
<li><a href="../176833/index.html">On Kickstarter is collecting funds for the game, the heir of the famous Road Rush</a></li>
<li><a href="../176835/index.html">Google Glass Technical Specs</a></li>
<li><a href="../176837/index.html">Crowdinvesting in Russia: how we made the investment platform, what we have already achieved and what projects we can invest in</a></li>
<li><a href="../176839/index.html">Google has published the Glass Mirror API Developer's Guide and Best Practices</a></li>
<li><a href="../176841/index.html">Fujitsu development allows you to work with a sheet of paper, as with a touch screen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>