<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The influence of a small window on the user's memory, and what to do about it</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Even with the release of Windows Vista \ 2008, administrators were faced with a small but unpleasant problem: a warning message about password expirat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The influence of a small window on the user's memory, and what to do about it</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/y0/cd/bk/y0cdbkyyvwxszohiwjcp1pmqm70.jpeg"></p><br><p>  Even with the release of Windows Vista \ 2008, administrators were faced with a small but unpleasant problem: a warning message about password expiration became lonely to appear in the most inconspicuous corner of the screen.  And this is instead of the window right in the center, as it was before! </p><br><p>  From here and change of passwords at the last moment, to the accompaniment of access failures;  and indignation, why the VPN suddenly stopped working, and what to do about it on a business trip.  Of course, not the problem of the year, but the phenomenon is annoying and unpleasant.  Therefore, we understand how to overcome it. <a name="habracut"></a></p><br><h1 id="otchety-i-excel-na-strazhe-pamyati">  Reports and Excel on guard memory </h1><br><p>  In the article ‚Äú <a href="https://habr.com/company/pc-administrator/blog/350582/">Excel instead of PowerShell: queries to AD and system reports</a> ‚Äù I told how to get information from Active Directory using Excel.  Thanks to this mechanism you can always get a report on the validity of user passwords.  In modern domains for this there is an attribute <strong>msDS-UserPasswordExpiryTimeComputed</strong> , which is located in the class <strong>user.</strong> </p><br><p>  With Power Query, we can easily get a similar label: </p><br><p><img src="https://habrastorage.org/webt/ec/96/uc/ec96ucjlabbwae9uim9hsltszlk.jpeg"><br>  <em>Report on password expiration dates in MS Excel.</em> </p><br><p>  Now, if we add a formula like </p><br><pre><code class="hljs mel">=([@[msDS-UserPasswordExpiryTimeComputed]]&lt;();<span class="hljs-string"><span class="hljs-string">" !"</span></span>;([@[msDS-UserPasswordExpiryTimeComputed]]<span class="hljs-number"><span class="hljs-number">-5</span></span>&lt;();<span class="hljs-string"><span class="hljs-string">"  !"</span></span>;<span class="hljs-string"><span class="hljs-string">""</span></span>))</code> </pre> <br><p>  in the next column, we will get a table of this kind: </p><br><p><img src="https://habrastorage.org/webt/nf/ax/z9/nfaxz9dpvdbj08edssrpwylf3qg.jpeg"><br>  <em>We make the report more visual.</em> </p><br><p>  It remains only to add rules for coloring cells based on their content, and it will be quite beautiful: </p><br><p><img src="https://habrastorage.org/webt/ez/7o/fq/ez7ofqqiudnqa5lrezec7vbq_g8.jpeg"><br>  <em>And even more visual.</em> </p><br><p>  When setting up automatic data update, you can look at the table and prepare for requests from users.  Or instruct the account manager (yes, somewhere there are such special people) to ring up employees. </p><br><p>  Let's try to use PowerShell as account manager. </p><br><h1 id="avtomaticheskie-uvedomleniya-sotrudnikov">  Automatic employee notifications </h1><br><p>  Fortunately, you can retrieve data from Active Directory not only through Excel, but also with the help of your favorite scripting languages ‚Äã‚Äãlike PowerShell. </p><br><p>  To begin with, we will get a list of users and their addresses with such a query: </p><br><pre> <code class="hljs vbscript">$users = <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-ADUser -<span class="hljs-built_in"><span class="hljs-built_in">filter</span></span> {Enabled -eq $<span class="hljs-literal"><span class="hljs-literal">True</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">and</span></span> PasswordNeverExpires -eq $<span class="hljs-literal"><span class="hljs-literal">False</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">and</span></span> PasswordLastSet -gt <span class="hljs-number"><span class="hljs-number">0</span></span>} ` -Properties <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-string"><span class="hljs-string">"EmailAddress"</span></span>, <span class="hljs-string"><span class="hljs-string">"msDS-UserPasswordExpiryTimeComputed"</span></span> | ` <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>-Object -<span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> <span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-string"><span class="hljs-string">"EmailAddress"</span></span>, ` @{Name = <span class="hljs-string"><span class="hljs-string">"PasswordExpiry"</span></span>; Expression = {[datetime]::FromFileTime($_.<span class="hljs-string"><span class="hljs-string">"msDS-UserPasswordExpiryTimeComputed"</span></span>).tolongdatestring() }}</code> </pre> <br><p>  As you can see, on this request, I get only those users that meet the three criteria: </p><br><ul><li>  Not blocked - <strong>Enabled -eq $ True</strong> . </li><li>  Those who have a password has a lifetime - <strong>PasswordNeverExpires -eq $ False</strong> . </li><li>  Those who do not have a password at all - <strong>PasswordLastSet -gt 0</strong> . </li></ul><br><p>  As a result, we get a value table with the user name, his address and the password expiration date.  For convenience, we set three options for the warning time ‚Äî 7, 3, and 1 day: </p><br><pre> <code class="hljs vbscript">$SevenDayWarnDate = (<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">date</span></span>).adddays(<span class="hljs-number"><span class="hljs-number">7</span></span>).ToLongDateString() $ThreeDayWarnDate = (<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">date</span></span>).adddays(<span class="hljs-number"><span class="hljs-number">3</span></span>).ToLongDateString() $OneDayWarnDate = (<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">date</span></span>).adddays(<span class="hljs-number"><span class="hljs-number">1</span></span>).ToLongDateString()</code> </pre> <br><p>  Now, by comparing these three variables with the value of $ user.PasswordExpiry, we can send the corresponding notifications.  Let me remind you that sending e-mail is done using the Send-MailMessage cmdlet. </p><br><blockquote>  But it is not necessary to notify users exclusively by mail - you can use the material ‚Äú <a href="https://habr.com/company/pc-administrator/blog/353652/">Not a bot yet, but already something - we receive notifications from Zabbix in messengers</a> ‚Äù and send notifications via any other communication channel. </blockquote><p>  A full listing of the script, which can be run daily using the scheduler, can be found under the spoiler. </p><br><div class="spoiler">  <b class="spoiler_title">Familiarize</b> <div class="spoiler_text"><pre> <code class="hljs smalltalk"><span class="hljs-type"><span class="hljs-type">Import</span></span>-<span class="hljs-type"><span class="hljs-type">Module</span></span> <span class="hljs-type"><span class="hljs-type">ActiveDirectory</span></span> #    <span class="hljs-string"><span class="hljs-string">$S</span></span>evenDayWarnDate = (get-date).adddays(<span class="hljs-number"><span class="hljs-number">7</span></span>).<span class="hljs-type"><span class="hljs-type">ToLongDateString</span></span>() <span class="hljs-string"><span class="hljs-string">$T</span></span>hreeDayWarnDate = (get-date).adddays(<span class="hljs-number"><span class="hljs-number">3</span></span>).<span class="hljs-type"><span class="hljs-type">ToLongDateString</span></span>() <span class="hljs-string"><span class="hljs-string">$O</span></span>neDayWarnDate = (get-date).adddays(<span class="hljs-number"><span class="hljs-number">1</span></span>).<span class="hljs-type"><span class="hljs-type">ToLongDateString</span></span>() #   <span class="hljs-string"><span class="hljs-string">$M</span></span>ailSender = <span class="hljs-comment"><span class="hljs-comment">" - &lt;bot@domain.com&gt;"</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>ubject = <span class="hljs-string"><span class="hljs-string">'!     '</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub1 = <span class="hljs-string"><span class="hljs-string">' -.   '</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub2 = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub3 = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub4 = <span class="hljs-string"><span class="hljs-string">'. ,    .     ,       .'</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>MTPServer = <span class="hljs-string"><span class="hljs-string">'smtp.domain.com'</span></span> #  <span class="hljs-string"><span class="hljs-string">$u</span></span>sers = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ADUser</span></span> -filter {<span class="hljs-type"><span class="hljs-type">Enabled</span></span> -eq <span class="hljs-string"><span class="hljs-string">$T</span></span>rue -and <span class="hljs-type"><span class="hljs-type">PasswordNeverExpires</span></span> -eq <span class="hljs-string"><span class="hljs-string">$F</span></span>alse -and <span class="hljs-type"><span class="hljs-type">PasswordLastSet</span></span> -gt <span class="hljs-number"><span class="hljs-number">0</span></span> } ` -<span class="hljs-type"><span class="hljs-type">Properties</span></span> <span class="hljs-comment"><span class="hljs-comment">"Name"</span></span>, <span class="hljs-comment"><span class="hljs-comment">"EmailAddress"</span></span>, <span class="hljs-comment"><span class="hljs-comment">"msDS-UserPasswordExpiryTimeComputed"</span></span> | <span class="hljs-type"><span class="hljs-type">Select</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> -<span class="hljs-type"><span class="hljs-type">Property</span></span> <span class="hljs-comment"><span class="hljs-comment">"Name"</span></span>, <span class="hljs-comment"><span class="hljs-comment">"EmailAddress"</span></span>, ` @{<span class="hljs-type"><span class="hljs-type">Name</span></span> = <span class="hljs-comment"><span class="hljs-comment">"PasswordExpiry"</span></span>; <span class="hljs-type"><span class="hljs-type">Expression</span></span> = {[datetime]::<span class="hljs-type"><span class="hljs-type">FromFileTime</span></span>(<span class="hljs-string"><span class="hljs-string">$_</span></span>.<span class="hljs-comment"><span class="hljs-comment">"msDS-UserPasswordExpiryTimeComputed"</span></span>).tolongdatestring() }} #     . foreach (<span class="hljs-string"><span class="hljs-string">$u</span></span>ser in <span class="hljs-string"><span class="hljs-string">$u</span></span>sers) { if (<span class="hljs-string"><span class="hljs-string">$u</span></span>ser.<span class="hljs-type"><span class="hljs-type">PasswordExpiry</span></span> -eq <span class="hljs-string"><span class="hljs-string">$S</span></span>evenDayWarnDate) { <span class="hljs-string"><span class="hljs-string">$d</span></span>ays = <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailBody = <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub1, <span class="hljs-string"><span class="hljs-string">$u</span></span>ser.name, <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub2, <span class="hljs-string"><span class="hljs-string">$d</span></span>ays, <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub3, <span class="hljs-string"><span class="hljs-string">$S</span></span>evenDayWarnDate, <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub4 -join <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-type"><span class="hljs-type">Send</span></span>-<span class="hljs-type"><span class="hljs-type">MailMessage</span></span> -<span class="hljs-type"><span class="hljs-type">To</span></span> <span class="hljs-string"><span class="hljs-string">$u</span></span>ser.<span class="hljs-type"><span class="hljs-type">EmailAddress</span></span> -<span class="hljs-type"><span class="hljs-type">From</span></span> <span class="hljs-string"><span class="hljs-string">$M</span></span>ailSender -<span class="hljs-type"><span class="hljs-type">SmtpServer</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>MTPServer -<span class="hljs-type"><span class="hljs-type">Subject</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>ubject -<span class="hljs-type"><span class="hljs-type">Body</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailBody } elseif (<span class="hljs-string"><span class="hljs-string">$u</span></span>ser.<span class="hljs-type"><span class="hljs-type">PasswordExpiry</span></span> -eq <span class="hljs-string"><span class="hljs-string">$T</span></span>hreeDayWarnDate) { <span class="hljs-string"><span class="hljs-string">$d</span></span>ays = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailBody = <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub1, <span class="hljs-string"><span class="hljs-string">$u</span></span>ser.name, <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub2, <span class="hljs-string"><span class="hljs-string">$d</span></span>ays, <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub3, <span class="hljs-string"><span class="hljs-string">$T</span></span>hreeDayWarnDate, <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub4 -join <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-type"><span class="hljs-type">Send</span></span>-<span class="hljs-type"><span class="hljs-type">MailMessage</span></span> -<span class="hljs-type"><span class="hljs-type">To</span></span> <span class="hljs-string"><span class="hljs-string">$u</span></span>ser.<span class="hljs-type"><span class="hljs-type">EmailAddress</span></span> -<span class="hljs-type"><span class="hljs-type">From</span></span> <span class="hljs-string"><span class="hljs-string">$M</span></span>ailSender -<span class="hljs-type"><span class="hljs-type">SmtpServer</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>MTPServer -<span class="hljs-type"><span class="hljs-type">Subject</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>ubject ` -<span class="hljs-type"><span class="hljs-type">Body</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailBody } elseif (<span class="hljs-string"><span class="hljs-string">$u</span></span>ser.<span class="hljs-type"><span class="hljs-type">PasswordExpiry</span></span> -eq <span class="hljs-string"><span class="hljs-string">$o</span></span>neDayWarnDate) { <span class="hljs-string"><span class="hljs-string">$d</span></span>ays = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailBody = <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub1, <span class="hljs-string"><span class="hljs-string">$u</span></span>ser.name, <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub2, <span class="hljs-string"><span class="hljs-string">$d</span></span>ays, <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub3, <span class="hljs-string"><span class="hljs-string">$O</span></span>neDayWarnDate, <span class="hljs-string"><span class="hljs-string">$E</span></span>mailStub4 -join <span class="hljs-string"><span class="hljs-string">' '</span></span> <span class="hljs-type"><span class="hljs-type">Send</span></span>-<span class="hljs-type"><span class="hljs-type">MailMessage</span></span> -<span class="hljs-type"><span class="hljs-type">To</span></span> <span class="hljs-string"><span class="hljs-string">$u</span></span>ser.<span class="hljs-type"><span class="hljs-type">EmailAddress</span></span> -<span class="hljs-type"><span class="hljs-type">From</span></span> <span class="hljs-string"><span class="hljs-string">$M</span></span>ailSender -<span class="hljs-type"><span class="hljs-type">SmtpServer</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>MTPServer -<span class="hljs-type"><span class="hljs-type">Subject</span></span> <span class="hljs-string"><span class="hljs-string">$S</span></span>ubject -<span class="hljs-type"><span class="hljs-type">Body</span></span> <span class="hljs-string"><span class="hljs-string">$E</span></span>mailBody } else {} }</code> </pre> </div></div><br><p>  Now users are warned, and it remains to hope for their responsibility.  Consider another notification option. </p><br><h1 id="uvedomlyaem-polzovateley-pri-vhode">  Notify users at the entrance </h1><br><p>  You can return to the screen a message about the expiring password through a logon script or program in autoload.  Unfortunately, for obvious reasons, this option is not suitable for users working with domain services remotely. </p><br><p>  Here is an example of a simple PowerShell script slipped into autoload by group policies: </p><br><pre> <code class="hljs ruby">$user= Get-ADUser -Identity $env<span class="hljs-symbol"><span class="hljs-symbol">:username</span></span> -Properties <span class="hljs-string"><span class="hljs-string">'msDS-UserPasswordExpiryTimeComputed'</span></span>,<span class="hljs-string"><span class="hljs-string">'PasswordNeverExpires'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( -<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> $user.<span class="hljs-string"><span class="hljs-string">'PasswordNeverExpires'</span></span>) { $diff=(new-timespan -start (get-date) -<span class="hljs-keyword"><span class="hljs-keyword">end</span></span> ([datetime]<span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-symbol"><span class="hljs-symbol">:FromFileTime</span></span>($user.<span class="hljs-string"><span class="hljs-string">"msDS-UserPasswordExpiryTimeComputed"</span></span>))).Days <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($diff -lt <span class="hljs-number"><span class="hljs-number">7</span></span>) { $msgBoxInput = [System.Windows.MessageBox]<span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-symbol"><span class="hljs-symbol">:Show</span></span>(<span class="hljs-string"><span class="hljs-string">"    "</span></span>+ $diff + <span class="hljs-string"><span class="hljs-string">" !`n    ?"</span></span>,<span class="hljs-string"><span class="hljs-string">"!"</span></span>,<span class="hljs-string"><span class="hljs-string">"YesNo"</span></span>,<span class="hljs-string"><span class="hljs-string">"Warning"</span></span>) switch ($msgBoxInput) { <span class="hljs-string"><span class="hljs-string">'Yes'</span></span> { cmd /c <span class="hljs-string"><span class="hljs-string">"explorer shell:::{2559a1f2-21d7-11d4-bdaf-00c04f60b9f0}"</span></span> } <span class="hljs-string"><span class="hljs-string">'No'</span></span> { } } } }</code> </pre> <br><p>  The <strong>explorer shell ::: {2559a1f2-21d7-11d4-bdaf-00c04f60b9f0}</strong> startup line is the launch of the Windows Security interface.  After the release of Windows 2012, it disappeared from the Start menu and became available only by pressing Ctrl + Alt + Del or Ctrl + Alt + End in the case of connecting via RDP. </p><br><p><img src="https://habrastorage.org/webt/be/wm/nq/bewmnqrvqdwudt40pfqlaguvyqm.png"></p><br><p>  <em>Notification window.</em> <br>  For connoisseurs under the spoiler, the old version of the script. </p><br><div class="spoiler">  <b class="spoiler_title">on AutoIT</b> <div class="spoiler_text"><pre> <code class="hljs mel">#Include &lt;AD.au3&gt; #include &lt;Date.au3&gt; _AD_Open() $array=_AD_GetPasswordInfo() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $array[<span class="hljs-number"><span class="hljs-number">9</span></span>] &lt;&gt; <span class="hljs-string"><span class="hljs-string">""</span></span> then $t=_DateDiff ( <span class="hljs-string"><span class="hljs-string">"d"</span></span>, _NowCalc(), $array[<span class="hljs-number"><span class="hljs-number">9</span></span>] ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $t &lt; <span class="hljs-number"><span class="hljs-number">7</span></span> Then $a=MsgBox ( <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-string"><span class="hljs-string">"!"</span></span>, <span class="hljs-string"><span class="hljs-string">"      "</span></span> &amp;$t &amp;<span class="hljs-string"><span class="hljs-string">" ."</span></span>&amp;@crlf&amp;<span class="hljs-string"><span class="hljs-string">"    ?"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $a=<span class="hljs-number"><span class="hljs-number">6</span></span> then Run(<span class="hljs-string"><span class="hljs-string">"explorer shell:::{2559a1f2-21d7-11d4-bdaf-00c04f60b9f0}"</span></span>) sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>) endif endif endif _AD_Close()</code> </pre> <br><p>  A simple implementation is supported by the _AD_GetPasswordInfo () function from the <a href="https://www.autoitscript.com/forum/topic/106163-active-directory-udf/">AD.au3</a> library.  It gives an array of values ‚Äã‚Äãwith password information, including its expiration time. </p></div></div><br><p>  After the introduction of this mechanism, any problems with expired passwords stopped appearing. </p><br><h1 id="otsutstvie-domena">  Missing Domain </h1><br><p>  If the Active Directory infrastructure is not deployed for you - for example, in the case of a separate terminal server - then the solution also exists, albeit a bit more complicated. </p><br><p>  To do this, we need a little bit of WMI magic and our favorite scripting language.  Let's go back to the PowerShell examples: </p><br><pre> <code class="hljs mel"># . $Computer = $env:computername #  $UserName = $env:username #   $Days = <span class="hljs-number"><span class="hljs-number">2</span></span> $User = [ADSI]<span class="hljs-string"><span class="hljs-string">"WinNT://$Computer/$UserName,user"</span></span> $Flags = $User.UserFlags.psbase.Value #    . If ($Flags -band <span class="hljs-number"><span class="hljs-number">65536</span></span>) { <span class="hljs-string"><span class="hljs-string">"     "</span></span> } Else { #   . $AgeDays = $User.PasswordAge.psbase.Value / <span class="hljs-number"><span class="hljs-number">86400</span></span> $MaxAge = $User.MaxPasswordAge.psbase.Value / <span class="hljs-number"><span class="hljs-number">86400</span></span> If ($AgeDays -gt $MaxAge) { <span class="hljs-string"><span class="hljs-string">" "</span></span> } Else { If (($AgeDays + $Days) -gt $MaxAge) { <span class="hljs-string"><span class="hljs-string">"    $Days "</span></span> } Else { <span class="hljs-string"><span class="hljs-string">"  "</span></span> } } }</code> </pre> <br><p>  With proper refinement, such a script can notify users at regular launch or upon login. </p><br><p>  For a long time I thought about the meaning of the existence of the password lifetime.  On the one hand, it is good and safe, on the other - the constant inventing of new passwords leads to the forgetting of these same passwords and, as a result, to stickers on the monitor and under the keyboard. </p><br><p>  Therefore, more and more close to me is the practice when users themselves come up with passwords, but at the same time their work is regularly audited by a dictionary attack with utilities like <a href="http://www.l0phtcrack.com/">L0phtCrack</a> .  The only requirement is the password length requirement (recalling the well-known <a href="https://xkcd.com/936/">xkcd</a> image). </p><br><p>  So it is possible for people to make life easier, and to avoid a defensive reaction to ‚Äútightening the screws‚Äù in the form of wonderful combinations like <em>Qwerty123</em> .  Well, and what - the system does not swear, but this is your IB ... ponapridumyvali here. </p><br><p>  <strong>By the way, do you have an account manager or some fashionable youth practice of changing passwords?</strong> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/358082/">https://habr.com/ru/post/358082/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358068/index.html">50 announcements of Build 2018. Part 1. Hardware & Dev Tools</a></li>
<li><a href="../358072/index.html">Pension interview programmer</a></li>
<li><a href="../358076/index.html">Moving a physical server to a virtual one - how to manage in 1 day</a></li>
<li><a href="../358078/index.html">How to automate the development of a team of various sizes</a></li>
<li><a href="../358080/index.html">11 backlog optimization tips</a></li>
<li><a href="../358084/index.html">Three main principles for rapid product growth from Head of Growth Recruitee</a></li>
<li><a href="../358086/index.html">Not a single code: what affects the operation of blockchain systems</a></li>
<li><a href="../358088/index.html">Go assembler guide</a></li>
<li><a href="../358090/index.html">Understanding the life cycle of the React component</a></li>
<li><a href="../358092/index.html">Why think about web security when it's too late?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>