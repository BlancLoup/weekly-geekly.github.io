<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cloud API for mobile applications do it yourself. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instead of entering 
 At the dawn of programming and until very recently, the program was something complete, completely ready for use by an independe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cloud API for mobile applications do it yourself. Part 1</h1><div class="post__text post__text-html js-mediator-article"><h4>  Instead of entering </h4><br>  At the dawn of programming and until very recently, the program was something complete, completely ready for use by an independent unit that performed its functions and only them. <br><br>  However, with the advent of mobile devices, web sites with rich logic and social networks, everything began to change.  Now programs that do not go online, do not know how to upload something to Facebook and generally work on their own, practically have no right to life.  Even professional tools, such as <a href="http://office.microsoft.com/ru-ru/">Microsoft Office 2013</a> , began to support cloud storage for exchanging documents. <br><br>  The world is changing.  Now, in order to make money selling software, it is not necessary to write your own <a href="http://lurkmore.to/%25D0%2594%25D0%25B5%25D0%25BD%25D0%25B8%25D1%2581_%25D0%259F%25D0%25BE%25D0%25BF%25D0%25BE%25D0%25B2">operating system</a> or antivirus, spending a lot of time and resources.  Simply ask your wife and work together to develop a <a href="http://en.wikipedia.org/wiki/Temple_Run">world hit</a> .  Therefore, many today dream of creating their own evil birds or cat-ze-roup, studying the development for <a href="http://www.apple.com/ios/">iOS</a> , <a href="http://www.android.com/">Android</a> , <a href="http://www.windowsphone.com/">Windows Phone</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Suppose you have written your application and published it in some of the stores.  Everything is fine, you make a profit, but you want more.  You understand that you need to write applications for other platforms in order to expand the user base.  This is where the first ambush lies - how to minimize the amount of code you write, if applications run more equally and differ only in appearance (and not fact) and in programming language? <br><a name="habracut"></a><br>  The answer to this question will be the PLO old man, dressed in fashionable clothes and changed his name.  If you take out the common logic from the application code to a certain common service and locate this service on the Internet so that all applications can connect to it, then to implement the mobile application on a specific platform, you just need to write the data mapping code from the server.  Sounds familiar, doesn't it?  This is very similar to the <a href="http://ru.wikipedia.org/wiki/Model-View-Controller">MVC</a> pattern.  Here, Model is a service on the Internet that receives and sends data, and View and Controller are implemented on a mobile device and can be as simple as possible.  Today, the so-called <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">RESTful</a> <a href="http://en.wikipedia.org/wiki/Api">API</a> , a software interface that can be accessed through standard HTTP methods, has increasingly been used as a model for such a service. <br><br>  And everything seems to be looking good and it already seems that a solution has been found.  However, problems begin when you begin to deploy the backend service on the server.  I am a programmer, and when it comes to installing and configuring a server, I immediately feel uneasy.  First of all, this is absolutely new knowledge that needs to be learned so that everything works as it should.  Secondly, in order for everything to work as it should and not fall with increased load or attack, it is necessary to smoke mana even more and more persistently.  You can try to find such a hoster that will save you from messing with the servers and pre-install PHP and / or something else.  But then the problem remains that you will need to independently implement all the necessary server event handlers to implement a full-fledged REST API.  And this again takes away your useful time and spends it on unnecessary things. <br><br><h4>  Why am I all this? </h4><br>  I myself have long been tormented by the question, how can I organize my server backend for an application?  At first I wrote something special using WCF services.  Then came the <a href="http://www.asp.net/web-api">ASP.NET Web API</a> , which pretty well simplified life.  But today I want to talk about something else.  I, as a fan of easy-to-use things, could not pass by the relative new service that appeared in the <a href="http://www.windowsazure.com/">Windows Azure</a> cloud platform.  The name of this service is Windows Azure Mobile Services Custom API. <br><br>  This service, along with other useful features of Windows Azure Mobile Services, is a PaaS solution and provides the ability to quickly deploy the cloud-based RESTful API that the program can access in any language and platform.  The basis of this decision is no longer a new, but quite popular <a href="http://nodejs.org/">Node.js</a> technology.  Custom API is a fully functional Node.js application with all the ensuing consequences - it is a complete solution without compromise.  And taking into account the fact that native SDKs for all three popular mobile platforms were written to work with it, this solution becomes even more interesting. <br><br>  Further in this part, I want to talk about how to create and start using the cloud backend in Windows Azure and access it from a mobile device.  Do not switch! <br><br><h4>  Creating cloud backend </h4><br>  Creating a cloud backend, like any other service in Windows Azure, comes from <a href="https://manage.windowsazure.com/">the</a> cloud <a href="https://manage.windowsazure.com/">management portal</a> .  First you need to create a mobile service, inventing some meaningful name for it: <br><img src="https://habrastorage.org/getpro/habr/post_images/fcb/7f6/0e3/fcb7f60e308fc4cb00cf0c278a15bc93.png"><br><br>  Next, you need to select the SQL database in which the mobile service data will be stored.  There is an option to create a free copy of 20Mb.  To test the possibilities - enough for the eyes.  And if you like it, you can always upgrade to more serious decisions. <br><br>  After clicking on the arrow further and entering the database server parameters (create a new or use an existing administrator login / password and other dullness), a new mobile service will be created in the cloud.  This usually happens extremely quickly, in less than a minute.  When the service is created and you enter it, you will see something like this window: <br><img src="https://habrastorage.org/getpro/habr/post_images/19f/250/569/19f250569dce35512ca91f767b1709b9.png"><br><br>  Remember it, it is still useful to us further. <br><br><h4>  API creation </h4><br>  To create your first cloud-based API, just go to the API tab and click the Create a Custom API button: <br><img src="https://habrastorage.org/getpro/habr/post_images/77d/845/00a/77d84500a24d57bbb1f2159949c3aa1c.png"><br><br>  If you have previously worked with Windows Azure Mobile Services, then the following window will be familiar to you.  It is necessary to specify the name of the future API, as well as one of the four levels of access to its various methods.  Leave everything by default, then only those clients that have an authorization parameter can connect to our API: <br><img src="https://habrastorage.org/getpro/habr/post_images/d1c/401/d96/d1c401d96f44d643ad7f82fd96e51f0d.png"><br><br>  Once the new API has been created, we can proceed to editing it.  Initially, you should see a script similar to this: <br><img src="https://habrastorage.org/getpro/habr/post_images/61e/2d1/8b9/61e2d18b9a4f75a579aeb80bb056005c.png"><br><br>  For educational / test purposes, I suggest changing it slightly to make it like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/5fc/6af/148/5fc6af1488b4d2d246e58963945f5d28.png"><br><br>  The main change in this case was that the POST request handler began returning data as a simple string, and a variable was added to GET, and its object has more than one field.  I did so for clarity, to illustrate the various possibilities of working with data. <br><br><h4>  API usage </h4><br>  For this article, we will use a test application that Windows Azure Mobile Services kindly provides us.  To do this, go back to the Quick Create page (this is the same one with a cloud and a lightning bolt on the icon), select Windows Phone 8 (although pay attention to a wide choice) and click Create A New Windows Phone App: <br><img src="https://habrastorage.org/getpro/habr/post_images/4e8/8b2/6b9/4e88b26b9a4bd5e67895db5c36ff5781.png"><br><br>  After creating the desired label (TodoItem) and downloading the application using the Download button, open it in Visual Studio. <br><br>  First of all, we are interested in two things.  The file App.xaml.cs has a line like this: <br><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MobileServiceClient MobileService = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MobileServiceClient( <span class="hljs-string"><span class="hljs-string">"https://mva-test-api.azure-mobile.net/"</span></span>, <span class="hljs-string"><span class="hljs-string">"___"</span></span> );</code> </pre> <br><br>  With this field, we will communicate with our new mobile service.  The set of incomprehensible symbols is the ApplicationKey, the individual key of your service, which you can use and honor. <br><br>  Let's run the application and see at least how it looks: <br><img src="https://habrastorage.org/getpro/habr/post_images/512/65c/7a8/51265c7a8a1f70cd26ab7130a2ab7e38.png"><br><br>  Well, not hit upstor, but not bad for a start.  Let's endow it with additional logic and call our API methods.  Go to the file MainPage.xaml.cs.  From him, I want to ensure that when you click on the Save button, the services are accessed, after which the result is simply written to the debug console.  To do this, add the following code to the end of the InsertTodoItem method: <br><br><pre> <code class="hljs pgsql">//   POST var result = await App.MobileService.InvokeApiAsync("CoolAPI", <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, HttpMethod.Post, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Debug</span></span>.WriteLine(result.StatusCode); var stringData = await result.Content.ReadAsStringAsync(); <span class="hljs-keyword"><span class="hljs-keyword">Debug</span></span>.WriteLine(stringData); //   <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> var resultJson = await App.MobileService.InvokeApiAsync("CoolAPI", HttpMethod.<span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">Debug</span></span>.WriteLine(resultJson);</code> </pre><br><br>  The main method in this code can be called InvokeApiAsync.  He is responsible for calling one or another API method.  This method is overloaded and endowed with a different set of parameters.  In the example, it is clear that in the case of POST we pass as many as 5 parameters, and in the case of GET there are only 3. This is due to the fact that the method for POST is calculated on the fact that the result will be a regular line (remember the implementation of the script on the backend) and the variant with GET is for working with a JSON object (the result will be <a href="http://json.codeplex.com/">Newtonsoft.Json</a> ). <br><br>  If you now start the application and press the Save button, then in the Debug console of the application you will see something like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/ff6/a65/2ea/ff6a652eab38a4b1a14777cfc951f399.png"><br><br><h4>  How are they </h4><br>  I didn‚Äôt just ask to pay attention to the possibility of choosing the type of application on the Quick Create page in the Windows Azure Control Panel.  The fact is that the native SDK for working with mobile services is written not only for Windows devices.  Their libraries are released for both iOS and Android, so all the same can be used on these platforms.  Here is an example of ObjectiveC code that will do roughly the same as in the example: <br><br><pre> <code class="hljs objectivec">[<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.client invokeAPI:<span class="hljs-string"><span class="hljs-string">@"CoolAPI"</span></span> data:<span class="hljs-literal"><span class="hljs-literal">nil</span></span> HTTPMethod:<span class="hljs-string"><span class="hljs-string">"POST"</span></span> parameters:<span class="hljs-literal"><span class="hljs-literal">nil</span></span> headers:<span class="hljs-literal"><span class="hljs-literal">nil</span></span> completion:^(<span class="hljs-built_in"><span class="hljs-built_in">NSData</span></span> *result, <span class="hljs-built_in"><span class="hljs-built_in">NSHTTPURLResponse</span></span> *response, <span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span> *error) { <span class="hljs-built_in"><span class="hljs-built_in">NSLog</span></span>(<span class="hljs-string"><span class="hljs-string">@"%i"</span></span>, response.statusCode); <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *stringData = [[<span class="hljs-built_in"><span class="hljs-built_in">NSSatring</span></span> alloc] initWithData:result encoding:<span class="hljs-built_in"><span class="hljs-built_in">NSUTF8StringEncoding</span></span>]; }];</code> </pre><br><br>  As you can see - ‚Äúpure‚Äù ObjectiveC, without flies.  Similarly for Android, WinRT and even for the web version (in HTML and JavaScript). <br><br><h4>  What's next </h4><br>  I originally planned to write only one article at once about all the capabilities of the server code in Windows Azure Mobile Services, but there is too much material.  So now we‚Äôll finish, and in the next part I‚Äôll talk about how you can work on a cloud backend in a team using Git.  And how to extend the functionality with common scripts and NPM packages. </div><p>Source: <a href="https://habr.com/ru/post/209912/">https://habr.com/ru/post/209912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209894/index.html">Which HDD is more reliable? Backblaze statistics on 27134 drives for 4 years of work</a></li>
<li><a href="../209898/index.html">With regards to points</a></li>
<li><a href="../209902/index.html">Hello, I am error 217 and I will not tell you anything</a></li>
<li><a href="../209906/index.html">DMMR: radio control via USB- "whistle"</a></li>
<li><a href="../209910/index.html">In the wake of the bug and a little about the events of MotionEvent in Android</a></li>
<li><a href="../209914/index.html">Interesting moments in C # (foreach)</a></li>
<li><a href="../209916/index.html">Smart House. Concrete implementation</a></li>
<li><a href="../209920/index.html">Yet another audioplayer</a></li>
<li><a href="../209922/index.html">Designer review Android 4.4 KitKat. Part 1</a></li>
<li><a href="../209924/index.html">Burn after reading</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>