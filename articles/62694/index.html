<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Request Processing in ASP.NET MVC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I will try to contribute to the development of a relatively untapped ASP.NET MVC framework and offer you a translation of the excerpt from the book " ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Request Processing in ASP.NET MVC</h1><div class="post__text post__text-html js-mediator-article">  I will try to contribute to the development of a relatively untapped ASP.NET MVC framework and offer you a translation of the excerpt from the book " <a href="http://www.apress.com/book/view/1430210079">Pro ASP.NET MVC Framework</a> " entitled "The Request Processing Pipeline". <br><br>  *** <br><br>  Let's take a look at what happens in runtime mode when ASP.NET MVC processes an incoming request. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ASP.NET MVC query processing pipeline is comparable to the page life cycle in ASP.NET WebForms in that it displays the anatomy of the system.  An understanding of this process is necessary to perform any non-standard tasks.  Unlike the traditional page life cycle in ASP.NET, the request processing pipeline in MVC is very flexible ‚Äî you can change any part of it as you like, and even redistribute or replace some components.  Although you usually do not have to expand or change the pipeline, you can do it at any time, because extensibility is at the core of ASP.NET MVC. <br><a name="habracut"></a><br><br>  The figure shows the query processing pipeline.  The central axis is a standard pipeline (for requests that render a view);  branches are the main points of expansion.  To simplify the scheme does not contain absolutely all the stages and points of expansion.  The most significant omission is filters that can be embedded before or after the execution of action methods, or before or after the execution of action results. <br><br><img src="http://img198.imageshack.us/img198/1136/pic2w.png" alt="image"><br><br><h4>  STEP 1: IIS </h4><br>  Internet Information Services (IIS), a web server from Microsoft, starts up first.  When an HTTP request arrives, before the ASP.NET comes into play, the Windows kernel's HTTP.SYS driver analyzes the URL / port number / IP address combination, matches them and redirects to the registered application (which can be either an IIS website or virtual directory inside the IIS website). <br><br>  Since ASP.NET MVC applications are based on ASP.NET, you need to enable ASP.NET for the application pool (each IIS application is associated with an application pool).  ASP.NET can be enabled in two managed pipeline modes (managed pipeline modes): <br><br>  ‚Ä¢ In ISAPI mode (classic mode), ASP.NET is activated using the ISAPI extension (aspnet_isapi.dll) associated with certain file extensions from a URL address (for example, .aspx, .ashx, .mvc).  In IIS 6, you can use wildcards, and then aspnet_isapi.dll will process all requests despite the file extension. <br><br>  ‚Ä¢ In integrated mode (supported only in IIS 7+), .NET is the native part of the query processing pipeline, so you do not need to use the ISAPI extension associated with file extensions.  This is what makes it easy to use routing with ‚Äúbeautiful‚Äù URL addresses (without file extensions). <br><br>  In any case, as soon as the ASP.NET system accepts an incoming request, it notifies all registered HTTP modules that a new request has arrived.  (The HTTP module is a .NET class that implements the IHttpModule interface, which can be embedded in the request processing pipeline).  One particularly important HTTP module, registered by default in all ASP.NET MVC applications, is UrlRoutingModule.  This module is the starting point of the entire routing system (core routing system).  For IIS 6, the UrlRoutingModule module is registered in the web.config file. <br><br>  For IIS 7, you can use the Modules GUI (to do this, open the Internet Information Services (IIS) Manager from Administrative Tools, select the website and double-click Modules). <br><br><h4>  STAGE 2: ROUTING (CORE ROUTING) </h4><br>  When the UrlRoutingModule module enters into the processing of a request, it starts the System.Web.Routing routing system.  The routing task is to recognize and analyze the incoming URL and fill in the request context that subsequent components can use (for example, ASP.NET MVC uses it to transfer control to the appropriate MVC controller and populate the action method parameters). <br><br>  The diagram shows that the routing system first checks whether the incoming URL matches the file on disk.  If yes, then the routing system ends its work and IIS continues processing the request.  For static files (for example, .gif, .jpeg, .png, .css, or .js), this means that IIS will process them in a standard way (because they exist on disk), which is very efficient.  Similarly, traditional ASP.NET WebForms (.aspx) pages will be processed in the usual way. <br><br>  However, if the incoming URL does not correspond to the file on disk (for example, requests to MVC controllers that are .NET classes, not files), then the routing system examines the current configuration in order to determine how to handle the incoming URL. <br><br><h5>  ROUTING TABLE </h5><br>  The routing table is stored in the System.Web.Routing.RouteTable.Routes static collection.  Each entry in the collection is a template for valid URLs.  The template can optionally include placeholders (for example, / blog / {year} / {entry}) and constraints that limit the range of acceptable values ‚Äã‚Äãfor each of the parameters.  Each entry points to a route handler (route handler) - an object that implements the IRouteHandler interface that accepts and processes the request.  In order to populate the RouteTable.Routes collection, add the appropriate code to the RegisterRoutes () method of the Global.asax.cs file. <br><br>  To search for a matching HTTP request to a specific route from RouteTable.Routes, the routing system starts scanning the RouteTable.Routes collection from top to bottom and selects the first route found that matches the incoming request.  Having found it, the routing system transfers control to the route handler, providing it with the context of the request, describing the selected route and all URL parameters. <br><br><h4>  STAGE 3: CONTROLLERS AND ACTIONS (CONTROLLERS AND ACTIONS) </h4><br>  At this point, the routing system selected a route from the RouteTable.Routes collection and analyzed the URL parameters.  All this information is placed in the context of the request.  So where are the controllers and actions on the scene? <br><br><h5>  SEARCH AND LAUNCH OF CONTROLLERS </h5><br>  For ASP.NET MVC applications, most routes from RouteTable.Routes correspond to one handler ‚Äî the MvcRouteHandler handler; this is the standard handler built into ASP.NET MVC.  MvcRouteHandler knows how to call the appropriate controller using the request context. <br><br>  As can be seen in the diagram, he does this using the controller factory.  By default, it uses the incredibly original factory named DefaultControllerFactory, which uses a specific controller naming convention to select the correct controller for the incoming request. <br><br>  However, if you replace the DefaultControllerFactory's built-in factory with some other implementation of the IControllerFactory interface or a successor of the DefaultControllerFactory class, then you must change this logic. <br><br><h5>  WHAT SHOULD MAKE CONTROLLERS </h5><br>  The minimum requirement for a controller class is that it must implement the IController interface: <br><br>  public interface IController <br>  { <br>  void Execute (RequestContext requestContext); <br>  } <br><br>  As you can see, this is a very simple interface!  It does not define anything, except that the controller has to do something in the Execute () method.  Notice that the requestContext parameter stores complete information about the request context generated by the routing system, including URL parameters, and also provides access to Request and Response objects. <br><br><h5>  WHAT CONTROLLERS DO USUALLY </h5><br>  Most often, there is no need to implement IController directly - you can inherit controllers from the System.Web.Mvc.Controller class.  This is the standard ASP.NET MVC base controller, which adds the necessary infrastructure for processing requests.  Most importantly, it introduces action methods into the system.  This means that all public controller methods are reachable via URLs (such methods are called ‚Äúaction methods‚Äù) and, in addition, this means that you do not need to independently implement the Execute () method. <br><br>  Although action methods can output the result directly in the HTTP response, this is not recommended.  For reasons of convenience of testing and reusing code in action methods, it is better to return the result of actions (action result) (an object inherited from ActionResult), which describes the result of performing an action.  For example, if you want to render a view, return the ViewResult.  Or, to redirect an HTTP request to another action method, return RedirectToRouteResult.  ASP.NET MVC takes care of executing the result at the right moment in the query processing pipeline. <br><br>  In addition, there is a very flexible system filter.  These are .NET attributes (for example, [Authorize]), which you can use to label controller classes or action methods by embedding any logic before or after performing action methods, or before or after running the results of actions.  There are several built-in filters, such as exception filters and authorization filters.  Filters can be applied in so many different places that they have no place on the diagram! <br><br>  Controllers and actions (and their associated capabilities) are the core concepts in ASP.NET MVC. <br><br><h4>  STAGE 4: RESULTS ACTIONS AND REPRESENTATIONS (ACTION RESULTS AND VIEWS) </h4><br>  Ok, yes, quite a lot has already happened!  Let's repeat: <br><br>  ‚Ä¢ The routing system matched the incoming URL with a specific route and prepared an object containing the request context.  The route selected from RouteTable.Routes has designated the MvcRouteHandler handler for processing the request. <br><br>  ‚Ä¢ MvcRouteHandler used the request context and the controller factory to select and call the appropriate controller. <br><br>  ‚Ä¢ The controller called one of its action methods. <br><br>  ‚Ä¢ The action method returned an ActionResult object. <br>  At this point, ASP.NET MVC executes the result of the ActionResult. <br><br><h5>  RENDERING REPRESENTATIONS </h5><br>  Let's pay special attention to one special class inherited from ActionResult - ViewResult.  This class is able to find and render the corresponding view template, passing to it something in the ViewData collection, formed in the action method.  This is what is called the ‚Äúview engine‚Äù (a .NET class that implements the IViewEngine interface). <br><br>  The standard engine is WebFormViewEngine.  Its presentation templates are WebForms pages (.aspx) (that is, server pages used in traditional ASP.NET WebForms technology).  WebForms pages have their own processing pipeline, starting with an ASPX / ASCX compilation on the fly and going through a series of events called the page life cycle.  Unlike traditional ASP.NET, in ASP.NET MVC, these pages should be as simple as possible, since, according to MVC principles, views can only be responsible for generating HTML code.  This means that you do not need to understand in detail the life cycle of WebForms pages.  With the observance of the principles of separation of roles come simplicity and ease of maintenance code. <br><br>  *** <br><br>  From myself I would like to add that the article " <a href="http://codeclimber.net.nz/archive/2009/04/08/13-asp.net-mvc-extensibility-points-you-have-to-know.aspx">13 ASP.NET MVC extensibility points you have to know</a> " can be useful directly on this topic. </div><p>Source: <a href="https://habr.com/ru/post/62694/">https://habr.com/ru/post/62694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62685/index.html">POHMELFS: NFS in a new way</a></li>
<li><a href="../62686/index.html">Reservation link error in icq</a></li>
<li><a href="../62689/index.html">Copyright and music</a></li>
<li><a href="../62690/index.html">VIDEO medicine library</a></li>
<li><a href="../62691/index.html">Do I need manual processing of search results on the Internet?</a></li>
<li><a href="../62696/index.html">Guess 2/3 average,% username%</a></li>
<li><a href="../62697/index.html">Joomla 1.6 - Alpha version</a></li>
<li><a href="../62699/index.html">Realtor 2.0 - convenient property search</a></li>
<li><a href="../62700/index.html">Aggregators of contextual advertising: a real alternative or fifth leg?</a></li>
<li><a href="../62701/index.html">The story of one picture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>