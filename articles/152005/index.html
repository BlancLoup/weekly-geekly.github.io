<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In response to the question why access to an element of an array is faster than access to the fields of an object</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, a respected lany wrote a wonderful post about mutable numbers in Java: http://habrahabr.ru/post/151887/ 
 In the comment to his post, I ment...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In response to the question why access to an element of an array is faster than access to the fields of an object</h1><div class="post__text post__text-html js-mediator-article">  Recently, a respected <a href="https://habrahabr.ru/users/lany/" class="user_link">lany</a> wrote a wonderful post about mutable numbers in Java: <a href="http://habrahabr.ru/post/151887/">http://habrahabr.ru/post/151887/</a> <br>  In the comment to his post, I mentioned that if performance is important, then you can replace the wrapper object with a one-element array; access to an array element is, by definition, faster than retrieving a value from an instance field. <br>  I inherited this stereotype from Sun after reading the next performance white paper.  It was written there that the fastest access to a local variable occurs, followed by a static field, then the array element closes the instance field list. <br>  Fortunately, they did not believe me, and this was the reason for writing this article. <br>  The article is not designed for juniors, the reader must know Java, ASM x86 and bytecode. <br><br><a name="habracut"></a><br>  In order to understand whether or not access to an array element will be faster compared with access to an object field, you can: <br><ol><li>  Write synthetic performance test </li><li>  Understand what is really worth of the array [0] and this.value </li></ol><br>  I chose the second path, from synthetic tests already sick.  To begin with, we throw a test class. <br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> numbers; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TestNumbers</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ test(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IntNumField()); test(IntNumArray.create()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] mutableInt2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = <span class="hljs-number"><span class="hljs-number">10000</span></span>; index-- &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;) { IntNumArray.inc(mutableInt2); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IntNumField mutableInt1)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = <span class="hljs-number"><span class="hljs-number">10000</span></span>; index-- &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;) { mutableInt1.inc(); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IntNumField</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> value; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value++; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IntNumArray</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] create() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[<span class="hljs-number"><span class="hljs-number">1</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] array)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> array[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] array, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{ array[<span class="hljs-number"><span class="hljs-number">0</span></span>] = value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] array)</span></span></span><span class="hljs-function"> </span></span>{ array[<span class="hljs-number"><span class="hljs-number">0</span></span>]++; } } }</code> </pre> <br><br>  The IntNumField class works with an object field, and IntNumArray, as I suggested, with a single-element array.  Each of the classes contains an inc method which increments our mutable by one.  In test methods, a call to each version of inc is run 10,000 times - so that the method is compiled with guarantee. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But first, take a look at baytkod: <br><pre> <code class="java hljs">~$ javap -c numbers/<span class="hljs-function"><span class="hljs-function">TestNumbers$IntNumField </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; Code: <span class="hljs-number"><span class="hljs-number">0</span></span>: aload_0 <span class="hljs-number"><span class="hljs-number">1</span></span>: getfield #<span class="hljs-number"><span class="hljs-number">18</span></span>; <span class="hljs-comment"><span class="hljs-comment">//Field value:I 4: ireturn public void setValue(int); Code: 0: aload_0 1: iload_1 2: putfield #18; //Field value:I 5: return public final void inc(); Code: 0: aload_0 1: dup 2: getfield #18; //Field value:I 5: iconst_1 6: iadd 7: putfield #18; //Field value:I 10: return</span></span></code> </pre><br><br>  In the getter method, everything is simple, we load this and push the value value onto the stack.  The rest is about the same, well, except that inc uses dup for optimization. <br>  Now let's see what awaits us in the IntNumArray class: <br><pre> <code class="java hljs">~$ javap -c numbers/<span class="hljs-function"><span class="hljs-function">TestNumbers$IntNumArray </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[])</span></span></span></span>; Code: <span class="hljs-number"><span class="hljs-number">0</span></span>: aload_0 <span class="hljs-number"><span class="hljs-number">1</span></span>: iconst_0 <span class="hljs-number"><span class="hljs-number">2</span></span>: iaload <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-function"><span class="hljs-function">ireturn </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[], </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; Code: <span class="hljs-number"><span class="hljs-number">0</span></span>: aload_0 <span class="hljs-number"><span class="hljs-number">1</span></span>: iconst_0 <span class="hljs-number"><span class="hljs-number">2</span></span>: iload_1 <span class="hljs-number"><span class="hljs-number">3</span></span>: iastore <span class="hljs-number"><span class="hljs-number">4</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[])</span></span></span></span>; Code: <span class="hljs-number"><span class="hljs-number">0</span></span>: aload_0 <span class="hljs-number"><span class="hljs-number">1</span></span>: iconst_0 <span class="hljs-number"><span class="hljs-number">2</span></span>: dup2 <span class="hljs-number"><span class="hljs-number">3</span></span>: iaload <span class="hljs-number"><span class="hljs-number">4</span></span>: iconst_1 <span class="hljs-number"><span class="hljs-number">5</span></span>: iadd <span class="hljs-number"><span class="hljs-number">6</span></span>: iastore <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span></code> </pre><br><br>  Approximately the same, except that getfield is replaced by iconst_0 and iaload.  Well, it‚Äôs still not clear yet, so let's take a look at the assembler that will generate HotSpot for inc methods using special parameters: <br><pre> <code class="hljs mel">~$ java -XX:+UnlockDiagnosticVMOptions -XX:CompileThreshold=<span class="hljs-number"><span class="hljs-number">10000</span></span> -XX:+PrintAssembly numbers.TestNumbers # {method} <span class="hljs-string"><span class="hljs-string">'inc'</span></span> <span class="hljs-string"><span class="hljs-string">'()V'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">'numbers/TestNumbers$IntNumField'</span></span> # [sp+<span class="hljs-number"><span class="hljs-number">0x20</span></span>] (sp of caller) <span class="hljs-number"><span class="hljs-number">0x02141a87</span></span>: cmp <span class="hljs-number"><span class="hljs-number">0x4</span></span>(%ecx),%eax <span class="hljs-number"><span class="hljs-number">0x02141a8a</span></span>: jne <span class="hljs-number"><span class="hljs-number">0x020dd100</span></span> ; {runtime_call} [Verified Entry Point] <span class="hljs-number"><span class="hljs-number">0x02141a90</span></span>: mov %eax,<span class="hljs-number"><span class="hljs-number">0xffffc000</span></span>(%esp) <span class="hljs-number"><span class="hljs-number">0x02141a97</span></span>: push %ebp <span class="hljs-number"><span class="hljs-number">0x02141a98</span></span>: sub $0x18,%esp ;*aload_0 ; - numbers.TestNumbers$IntNumField::inc@0 (line <span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-number"><span class="hljs-number">0x02141a9b</span></span>: mov <span class="hljs-number"><span class="hljs-number">0x8</span></span>(%ecx),%esi ;*getfield value ; - numbers.TestNumbers$IntNumField::inc@2 (line <span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-number"><span class="hljs-number">0x02141a9e</span></span>: inc %esi <span class="hljs-number"><span class="hljs-number">0x02141a9f</span></span>: mov %esi,<span class="hljs-number"><span class="hljs-number">0x8</span></span>(%ecx) ;*putfield value ; - numbers.TestNumbers$IntNumField::inc@7 (line <span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-number"><span class="hljs-number">0x02141aa2</span></span>: add $0x18,%esp <span class="hljs-number"><span class="hljs-number">0x02141aa5</span></span>: pop %ebp <span class="hljs-number"><span class="hljs-number">0x02141aa6</span></span>: test %eax,<span class="hljs-number"><span class="hljs-number">0x1b0100</span></span> ; {poll_return} <span class="hljs-number"><span class="hljs-number">0x02141aac</span></span>: ret # {method} <span class="hljs-string"><span class="hljs-string">'inc'</span></span> <span class="hljs-string"><span class="hljs-string">'([I)V'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">'numbers/TestNumbers$IntNumArray'</span></span> # parm0: ecx = <span class="hljs-string"><span class="hljs-string">'[I'</span></span> # [sp+<span class="hljs-number"><span class="hljs-number">0x20</span></span>] (sp of caller) <span class="hljs-number"><span class="hljs-number">0x02141c80</span></span>: mov %eax,<span class="hljs-number"><span class="hljs-number">0xffffc000</span></span>(%esp) <span class="hljs-number"><span class="hljs-number">0x02141c87</span></span>: push %ebp <span class="hljs-number"><span class="hljs-number">0x02141c88</span></span>: sub $0x18,%esp ;*aload_0 ; - numbers.TestNumbers$IntNumArray::inc@0 (line <span class="hljs-number"><span class="hljs-number">71</span></span>) <span class="hljs-number"><span class="hljs-number">0x02141c8b</span></span>: cmpl $0x0,<span class="hljs-number"><span class="hljs-number">0x8</span></span>(%ecx) ; implicit exception: dispatches to <span class="hljs-number"><span class="hljs-number">0x02141cb7</span></span> <span class="hljs-number"><span class="hljs-number">0x02141c92</span></span>: jbe <span class="hljs-number"><span class="hljs-number">0x02141cc1</span></span> <span class="hljs-number"><span class="hljs-number">0x02141c98</span></span>: mov <span class="hljs-number"><span class="hljs-number">0xc</span></span>(%ecx),%esi ;*iaload ; - numbers.TestNumbers$IntNumArray::inc@3 (line <span class="hljs-number"><span class="hljs-number">71</span></span>) <span class="hljs-number"><span class="hljs-number">0x02141c9b</span></span>: inc %esi <span class="hljs-number"><span class="hljs-number">0x02141c9c</span></span>: cmpl $0x0,<span class="hljs-number"><span class="hljs-number">0x8</span></span>(%ecx) <span class="hljs-number"><span class="hljs-number">0x02141ca3</span></span>: jbe <span class="hljs-number"><span class="hljs-number">0x02141ccd</span></span> <span class="hljs-number"><span class="hljs-number">0x02141ca9</span></span>: mov %esi,<span class="hljs-number"><span class="hljs-number">0xc</span></span>(%ecx) ;*iastore ; - numbers.TestNumbers$IntNumArray::inc@6 (line <span class="hljs-number"><span class="hljs-number">71</span></span>) <span class="hljs-number"><span class="hljs-number">0x02141cac</span></span>: add $0x18,%esp <span class="hljs-number"><span class="hljs-number">0x02141caf</span></span>: pop %ebp <span class="hljs-number"><span class="hljs-number">0x02141cb0</span></span>: test %eax,<span class="hljs-number"><span class="hljs-number">0x1b0100</span></span> ; {poll_return} <span class="hljs-number"><span class="hljs-number">0x02141cb6</span></span>: ret</code> </pre><br><br>  I had to trim both methods by throwing things like code alignment and a bunch of code in the [Exception Handler] section. <br>  If you look closely, both methods use inc% esi to increment the values ‚Äã‚Äãon the stack.  Differ only <br><pre> <code class="hljs perl">mov <span class="hljs-number"><span class="hljs-number">0x8</span></span>(%ecx),%esi ;*getfield value</code> </pre><br>  and <br><pre> <code class="hljs perl">cmpl $0<span class="hljs-keyword"><span class="hljs-keyword">x</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0x8</span></span>(%ecx) ; implicit exception: dispatches to <span class="hljs-number"><span class="hljs-number">0x02141cb7</span></span> jbe <span class="hljs-number"><span class="hljs-number">0x02141cc1</span></span> mov <span class="hljs-number"><span class="hljs-number">0xc</span></span>(%ecx),%esi ;*iaload</code> </pre><br>  The first two lines in the second piece of code is a check that the index 0 does not exceed the bounds of the array (0 &lt;array.length).  It is because of it that it turns out that I was wrong, Worse, the exact same check takes place two lines below ... It is unlikely that it will be slower, but certainly it will not be faster than access to the object field. <br><br>  Thank you <a href="https://habrahabr.ru/users/apangin/" class="user_link">apangin</a> for having doubted, I think it is interesting not only for the two of us.  You can safely use the class wrapper and all the charms of the PLO. <br><br>  PS I still run the performance benchmark, no difference. </div><p>Source: <a href="https://habr.com/ru/post/152005/">https://habr.com/ru/post/152005/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151998/index.html">IR remote for PC and sockets. Part 1</a></li>
<li><a href="../152000/index.html">Guntior Analysis</a></li>
<li><a href="../152001/index.html">Introduction to web components. Part 1</a></li>
<li><a href="../152002/index.html">Rare monoblock Compaq Presario 3020</a></li>
<li><a href="../152003/index.html">Prism and user interaction requests</a></li>
<li><a href="../152006/index.html">¬µTorrent will change the peer-id every hour to avoid spying</a></li>
<li><a href="../152007/index.html">Additional Xcode SDK - what it is and why you don‚Äôt need it</a></li>
<li><a href="../152010/index.html">Android is four years old</a></li>
<li><a href="../152012/index.html">My shop in real life or thinking about the usefulness of my undertakings</a></li>
<li><a href="../152013/index.html">Google Chrome vs File Downloader</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>