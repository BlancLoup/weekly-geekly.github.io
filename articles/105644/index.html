<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Chakra. Interoperability means more than just standards.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How is the decision to implement a function that is not included in the specification of standards? Like all browser vendors, we often have to make th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Chakra. Interoperability means more than just standards.</h1><div class="post__text post__text-html js-mediator-article">  How is the decision to implement a function that is not included in the specification of standards?  Like all browser vendors, we often have to make this decision.  This publication will provide a number of real-world JavaScript examples to illustrate some of the principles used to create a interoperable browser when standards standards are not enough. <a name="habracut"></a><br><br>  Ideally, the specification of standards is self-sufficient.  A JavaScript implementation would simply include everything specified in <a href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">the ECMAScript specification</a> , and nothing more.  We believe that specifications published <a href="http://en.wikipedia.org/wiki/Standards_organizations">by standardization organizations</a> such as <a href="http://www.ecma-international.org/">Ecma International</a> or <a href="http://www.w3.org/">W3C</a> are essential to ensure browser interoperability.  Such specifications inform the browser implementers about what functions they should implement, and website developers what functions they should use. <br><br>  In the real world of the Internet, things are not so clearly defined.  Specifications are rarely perfect, and sometimes they are intentionally left incomplete or ambiguous.  Own experience as an editor of the specification of ES5 suggests that there are always problems that have not found a final solution.  As a result, functions that are not defined in any specification of standards are widely implemented and applied.  A developer trying to build a browser that would work on the existing Internet will have to implement many features not covered by the standards specification. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  What is a real grammar regular expression? </h5> <br><br>  When creating <a href="http://blogs.msdn.com/b/ie/archive/2010/03/18/the-new-javascript-engine-in-internet-explorer-9.aspx">Chakra</a> , ECMAScript 5 (ES5) specification was carefully followed, including regular expressions grammar.  But when testing started on real websites, pages began to come across that didn't work because of syntax errors in some regular expression literals.  For example, a failure occurred on regular expressions containing the following right bracket: <br><br> <code>next = /]/.exec(buffer);</code> <br> <br>  The reason was that the ECMAScript standard regular expression grammar includes] the list of characters that cannot be directly used as a match character.  The specification states that the <code>/]/</code> symbol is invalid, use <code>/\]/</code> instead.  It turns out that such a restriction of the symbol [is important, because otherwise it would be impossible to analyze literals such as <code>/axyz[ad]qwer/</code> .  However, the single bracket], which is not preceded by the symbol [, in fact does not represent an obstacle for analysis.  However, the standard still claims that it is unacceptable. <br><br>  In practice, all browsers accept regular expressions such as <code>/]/</code> , and website developers write them. <br><br>  <i>A consensus function</i> is a term that we use to describe such functions that are not part of any standard, but are universally implemented in a way that enables interaction.  In general, IE9 and any other JavaScript implementation should include such consensus functions in order to work with real web content.  The real difficulty lies in their identification, since they are not included in the specifications of the standards. <br><br>  We recognize the need to maintain consensus functions of this kind and will make efforts to ensure that they are included in future revisions of relevant standards for the Internet.  However, not all JavaScript extensions are implemented everywhere or uniformly. <br><br><h5>  Why are there no methods in IE9 with _ _ in the names? </h5><br><br>  ES5 includes support for reading and setting values.  Similar functions have been available in some web browsers for many years.  During this period, browser developers experimented with various syntaxes and programmatic interfaces (APIs) to define such methods.  Before the advent of ES5, the most widely implemented API used two methods called __ defineGetter__ and __ defineSetter__ to define the read / set methods.  The use of underscores on either side of a method name is a convention used by some browser developers to mark methods that are experimental features or address the low-level unique features of a particular JavaScript implementation. <br><br>  <a href="http://www.ecma-international.org/memento/TC39.htm">ECMA TC39</a> committee <a href="http://www.ecma-international.org/memento/TC39.htm">members</a> agreed that methods for reading and setting values ‚Äã‚Äãshould be included in the ES5 specification, since their benefits are obvious.  At the same time, the TC39 committee decided to create a new API for their definition and refrain from standardizing interfaces __ defineXXX__. <br><br>  Why did the TC39 do just that?  Due to significant differences in the behavior of browsers that provided this API.  Standardization based on common semantics for these methods will mean that some or possibly all existing implementations of browsers will have to be modified to bring them in line with the new semantics.  And this will probably make non-functional some applications written to work with specific browsers. <br><br>  Another reason is the desire to maintain the logical integrity of naming conventions.  No other embedded name in ECMAScript begins with an underscore or ends with an underscore.  The association of such names with experimental functions or the implementation of a specific function is widely known.  Using this symbol for a standardized function will be misleading and reduce its usefulness for future experiments. <br><br>  The TC39 committee developed a new API based on the <code>Object.defineProperty</code> method.  This interface not only supports the definition of the properties of the read and set methods, but also other new features of ES5.  The __defineXXX__ methods were not included in the ES5 specification. <br><br>  Browsers that already have the __defineXXX__ API implemented can continue to support it unchanged in order to ensure compatibility.  However, in a new code written to ensure compatibility of browsers that support the ES5 standard, the Object.defineProperty method should be used to determine the properties of methods for reading and setting values. <br><br>  The development team is still being asked to add the __defineXXX__ programming interfaces to IE9.  It is clear why.  Some developers already have code that uses these interfaces, and they would like this code to run in IE9.  However, the developers of IE9 believe that supporting these interfaces will not be in the fundamental interest of ensuring interoperability on the Internet.  TC39 has already reviewed this API and concluded that its standardization is undesirable.  If support for __defineXXX__ interfaces were added in IE9, this API would be even closer to becoming a permanent consensus function on the Internet;  this would essentially cancel decision TC39. <br><br>  Unfortunately, in the short term, this creates a small amount of additional work for developers currently using this outdated API.  However, creating a simple compatibility library for existing code that implements __defineXXX__ interfaces using the <code>Object.defineProperty</code> method <code>Object.defineProperty</code> to be nothing. <br><br><h5>  Inoperable consensus function </h5><br><br>  In JavaScript code, you can set a link to a function, and you can also call it in code that precedes the function declaration as such.  This is possible because JavaScript logically ‚Äúlifts‚Äù all function declarations to the top of the enclosing code body.  JavaScript also allows for the existence of multiple function declarations with the same name.  Consider a simple testing function. <br><br><pre>  &lt;code&gt; function testFuncDeclarationOrder () {&lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; f1 (); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; function f1 () {alert ("first f1")} &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; &lt;/ code&gt; &lt;code&gt; f1 (); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; function f1 () {alert ("second f1")} &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; f1 (); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt;} &lt;/ code&gt; </pre><br><br>  After the call, the function created a sequence of alerts: ‚Äúsecond f1‚Äù, ‚Äúsecond f1‚Äù, ‚Äùsecond f1‚Äù.  The reason is that JavaScript actually handles this function as if it were written as follows: <br><br><pre>  &lt;code&gt; function testFuncDeclarationOrder () {&lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; function f1 () {alert ("first f1")} &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; function f1 () {alert ("second f1")} &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; f1 (); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; f1 (); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; f1 (); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt;} &lt;/ code&gt; </pre><br><br>  ECMAScript specification has historically imposed only one restriction on the placement of a function declaration.  The ECMAScript standard does not include the ability to place a function declaration inside the body of a control structure statement.  An example code is shown below. <br><br><pre>  &lt;code&gt; if (someCondition) {&lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; function f1 () {alert ("f1")} &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt;} &lt;/ code&gt; </pre><br><br>  In the analysis, in accordance with the ECMAScript specification, the above code will cause a syntax error.  However, if you run it in any browser, you will find that the error does not occur.  Support for function declarations in any place where instruction is allowed is a consensus on the Internet.  And if so, why is this not included in ES5?  Section 12 of the ES5 specification actually says something about this. <br><br>  <i>NOTE.</i>  <i>It is known that several widely used ECMAScript implementations support the use of function declaration as an instruction.</i>  <i>However, between implementations there are significant and irreconcilable variations in the semantics applied to such function declarations.</i>  <i>Due to these irreconcilable differences, the use of a function declaration as an instruction causes the code to not be reliably portable between implementations.</i>  <i>It is recommended in ECMAScript implementations to prohibit such use of the function declaration or to accompany the declaration with a mandatory warning.</i>  <i>In future editions of ECMAScript, alternative portable means may be defined for declaring functions in the context of an instruction.</i> <br><br>  What do these inconsistent wording mean?  Simply put, the behavior of different browsers differed so much that the matching attempts were impractical. <br><br>  What does IE9 do?  Does IE9 prohibit such feature declarations at the instruction level as recommended in the ES5 specification?  No, in IE9, similar ads are handled in exactly the same way as in previous versions of IE. <br><br>  Why was this decision made?  Because the previous experiments of browser developers have demonstrated that the rejection of such ads led to the inoperability of many existing web pages. <br><br>  This may seem surprising.  How can a web page depend on functions that behave differently in different browsers and, nevertheless, be compatible with different browsers?  One possible answer: in fact, the code is not used.  This may be a function that is never called, or the result of which is not important for the functioning of the page.  On the other hand, if the JavaScript implementation would treat these functions as syntax errors, the entire script would be rejected, even if the function was never called. <br><br>  The implementation of such a dangerous function for developers is undesirable.  However, its existence on the Internet is fixed, so there is virtually no choice. <br><br><h5>  And what about const? </h5><br><br>  Sometimes the question is asked whether IE9 will support the declaration of <code>const</code> .  <code>const</code> is a non-standard JavaScript extension that provides a way to declare ‚Äúnamed constant‚Äù values.  A typical application might look something like this: <br><br> <code>const pi=3.14159;</code> <br> <br>  Several browsers support this feature, but there are significant differences in their handling of unusual situations and in what they define as errors.  Here is an example showing some differences in the behavior of browsers that "support" <code>const</code> : <br><br><pre>  &lt;code&gt; // function with multiple const declarations for the same name &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; function f () {&lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; alert ('executing within f'); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; const x = 1;  // declare the constant x as 1 &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; alert (x); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; const x = 2;  // override the constant x as 2 &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; alert (x); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; x = 3;  // try to set 3 for x &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; &lt;/ code&gt; &lt;code&gt; alert (x); &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt;} &lt;/ code&gt; </pre><br><br><pre>  &lt;code&gt; alert ('about to call f');  f (); &lt;/ code&gt; </pre><br><br>  Depending on the browser, the code can do the following: <br><br><ul><li>  report a syntax error and do not load the page; </li><li>  throw an exception when calling f; </li><li>  Alert: '1', '2', '2'.  This means that conflicting <code>const</code> declarations are resolved, but the assignment is ignored; </li><li>  Alert '1', '2', '3'.  This means that <code>const</code> processed just like var. </li></ul><br><br>  In essence, only very simple applications of <code>const</code> compatible with various browsers that support ad.  Many more complex applications or scenarios that may lead to an error are incompatible between different browsers. <br><br>  The actual implementation of JavaScript cannot support only a small number of trivial use cases.  This implementation should also do something with untypical borderline cases and erroneous scenarios that exist on real web pages.  It is likely that standardized specifications exist primarily for such situations.  What to do with simple common use cases is usually obvious.  This is for edge cases, a specification of standards is required to ensure the existence of compatible implementations. <br><br>  TC39 seriously considered the inclusion of <code>const</code> in ES5, it is present in the early projects of ES5.  However, many problems have emerged with its definition and interaction with other ads.  Ultimately, it was agreed in TC39 that <code>const</code> standardization would wait for the ‚Äúnext‚Äù revision of the specification, in which some of these other problems might also be solved.  In essence, the TC39 committee decided that standardization of a function with a flaw is undesirable.  Instead, he decided to postpone any <code>const</code> standardization for the future, when a single improved design could be embedded in all browsers. <br><br>  So what does IE9 do with <code>const</code> ?  So far the group has adhered to the decision not to support him.  This is not yet a consensus function, since it has never been available in all browsers.  There is no standard specification, but there are significant semantic differences between all existing browser implementations.  In addition to this, it is known that TC39 decided not to standardize any existing alternatives and intends to re-examine the issue in the following ECMAScript editions. <br><br>  The desire of many website developers to be able to use such an ad is understandable.  However, I don‚Äôt want to create another situation, similar to the conditional function declaration, when the function should exist, but it would be better for website developers not to use it if they are concerned about browser compatibility.  Ultimately, it appears that the best long-term solution for the Internet is to exclude it from use and wait until the standardization process takes its course. <br><br><h6>  A principled approach to decision making </h6><br><br>  These are just four specific JavaScript examples that demonstrate what kind of decisions you have to make during the creation of IE9.  Many similar problems arise in connection with other standards and consensus functions on the Internet.  In each case, a similar analysis is carried out.  And what does the standard say?  How many websites really need it?  Is this a consensus function with common semantics?  Are there several incompatible function options?  Does the standards committee work on this issue?  Are there any <a href="http://blogs.msdn.com/b/ieru/archive/2010/07/28/javascript-same-code-and-a-standardized-test-suite.aspx">test suites</a> ?  Will adoption promote or hinder standardization processes?  Ultimately, this is a matter of subjective judgment, and therefore it is important to make every effort to ensure a principled and consistent approach to decision-making. <br><br>  <b>PS Have you already rated <a href="http://habrahabr.ru/special/microsoft/ie9/posts/">Habr on HTML5</a> ?</b> </div><p>Source: <a href="https://habr.com/ru/post/105644/">https://habr.com/ru/post/105644/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../105636/index.html">Let's play in cities</a></li>
<li><a href="../105637/index.html">Our experience of performing at DEMO Fall 2010</a></li>
<li><a href="../105638/index.html">New flagship HP Storageworks</a></li>
<li><a href="../105639/index.html">Particle swarm algorithm</a></li>
<li><a href="../105640/index.html">Returning to the issue of emigration: the lottery from the US government to issue Green Cards has begun</a></li>
<li><a href="../105646/index.html">Apple history from the beginning to the present</a></li>
<li><a href="../105648/index.html">Online Community Map 2.0</a></li>
<li><a href="../105649/index.html">Internet spy who daily merges your competitors prices</a></li>
<li><a href="../105651/index.html">A few words about Ext.Direct</a></li>
<li><a href="../105652/index.html">Data compression in industrial automation systems. SwingingDoor algorithm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>