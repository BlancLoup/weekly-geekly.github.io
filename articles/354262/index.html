<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"The secret passenger": collecting feedback from consumers "on the fly"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Companies want to know whether the customer liked the product or service, and what can be improved. Some interviewed consumers immediately after purch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"The secret passenger": collecting feedback from consumers "on the fly"</h1><div class="post__text post__text-html js-mediator-article">  Companies want to know whether the customer liked the product or service, and what can be improved.  Some interviewed consumers immediately after purchasing the service, whether they liked the taxi ride or delivery from the online store.  It turns out the moment cut about the quality of service, but very common.  Especially if there were no excesses.  The service is rendered, the taxi driver got his five points, what else do you need? <br><br>  For comprehensive testing attract mystery shoppers with pre-prepared scripts, questionnaires, voice recorders or special applications.  But everything can be forgotten; a person with a voice recorder and a learned script can be easily deceived.  In addition, finding and hiring these people costs money. <br><br>  There is a nuance: our customer - S7 Airlines, and the service itself - the flight - is stretched in time.  In principle, airfare in this regard, the service is not at all unique.  Any transportation, journey, delivery also consist of several stages occurring one after another.  And in each of these situations it is impossible to hope that the client will remember all the details and be able to tell about them in detail after the fact.  We need something simple and in the moment before the person has yet forgotten. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/--/fl/ee/--fleeqjmuhn08zeztiy83vjn-s.jpeg"><br><br>  This is how our application appeared for S7 Airlines passengers for <a href="https://itunes.apple.com/ru/app/%25D1%2582%25D0%25B0%25D0%25B9%25D0%25BD%25D1%258B%25D0%25B9-%25D0%25BF%25D0%25B0%25D1%2581%25D1%2581%25D0%25B0%25D0%25B6%25D0%25B8%25D1%2580/id1323013613%3Fmt%3D8">iOS</a> and <a href="https://play.google.com/store/apps/details%3Fid%3Dru.s7.mysterypax">Android</a> , who want to help airlines become better.  To do this, just download the application on your smartphone and go through all the polls that will appear there.  Below we will describe in more detail how we determine whom to ask when, and at what moment. <br><a name="habracut"></a><br><br><h3>  How do users get the app </h3><br>  They receive a letter or sms with an invitation to become a secret passenger with a direct link to the application.  Link made using <a href="https://habrahabr.ru/company/redmadrobot/blog/267587/">Deep Link</a> technology.  Due to this, when clicking on a link from a smartphone, the system determines for itself what kind of device it is - IOS or Android.  Depending on this, the user is redirected to the App Store or Google Play to download the application.  This link also contains the ticket number and the last name of the passenger.  After installing the application, the user automatically logs in to the application with the data received from the deep link. <br><br>  Thanks to this technology, the device already has all the necessary data for authorization.  The ticket number and surname are forwarded from the link to the app. <br><br><h3>  Deep Link: server side and mobile development </h3><br>  When creating a survey, the server generates a short link, a deep link, with which the user will go to the appropriate app store and will be able to open the application with this link inside.  The server part accepts the ticket number or reservation number and the last name of the passenger.  A survey is generated on this basis.  Information for the survey is in the database and set in advance.  To create a poll, the server polls: <br><br><ul><li>  flight schedule service to understand the time of departure and arrival </li><li>  booking service to understand what additional services the passenger has purchased, </li><li>  booking base to determine where the ticket was purchased. </li></ul><br>  All this information is compiled, and a large questionnaire is made. <br><br>  To implement the deep link we used the technology <a href="https://firebase.google.com/docs/dynamic-links/">Firebase Dynamic Links</a> .  It provides a REST service for generating links, and also Sdk for handling links in a mobile application.  Links are generated in two ways: <br><br><ul><li>  manually via firebase console </li><li>  via Firebase deep link API, if you need to dynamically generate parameters for a deep link on your server.  Since it is unstable, every second we try to generate a link, and if it does not work out, wait a second, and then resume attempts. </li></ul><br><h3>  Attention, bug </h3><br>  During the development of the IOS application, there was a bug related to authorization.  In Firebase IOS SDK from version 4.0.4 to version 4.8.1, when installing an application from the AppStore, the wrong bundle_id link came to some devices: // google / link /? Dismiss = 1 &amp; is_weak_match = 1.  Because of this, the user did not start authorization in the application.  The problem was solved by updating the version of the Firebase framework. <br><br>  After generating the link, we advise you to immediately verify the correctness of the transition scheme via deeplink, adding the GET parameter d = 1 to the end of the deep link.  So you can check the correctness of the work deep link for mobile devices or browser. <br><br><img src="https://habrastorage.org/webt/kb/-v/i6/kb-vi67iikqtf4bdqpezsznayku.jpeg"><br><br><h3>  What are we going to ask about? </h3><br>  According to the reservation number, the ticket and flight data are pulled out of the system, when and by which flight the passenger flies and which ‚Äúpackage of services‚Äù has bought.  After that, a questionnaire is created, <br><br><ul><li>  tied to the <b>services</b> used by the passenger.  (If the fare is with baggage, it means that it will be checked in. We are interested to learn about all the stages, so we will add a block of questions about the delivery and receipt of baggage to the person with baggage.) </li><li>  and by the <b>time</b> this service is provided - when and what to ask this passenger. </li></ul><br><br>  <i>The diagram shows the general logic of how we link the opening of the question blocks to the ‚Äúlife cycle‚Äù of a flight:</i> <br><br><img src="https://habrastorage.org/webt/pg/-u/y-/pg-uy-mutjosv_o94t1bqcp2sbo.jpeg"><br><br>  The entire configuration of questions is downloaded along with the application as a single JSON file and is expanded into columns.  Questions on later flight tapas are blocked so that the passenger does not answer all questions in advance. <br><br>  <b>As we inform, it is time to respond</b> <br>  The passenger passes the questionnaire before the flight, on the plane and after landing.  We remind each block with local notifications.  Pushes cannot be used, because most of the time the application will work in offline mode.  Time is calculated from the time zone where the passenger is located; we take the information from the phone.  All completed surveys are stored on the device and sent when connected to the network. <br><br>  <b>Routing in response process</b> <br>  The first section of questions appears the day before the flight - these are issues related to the purchase of tickets.  Last - comes at the airport of arrival. <br><br>  We build a graph of questions, within which there are transitions depending on the answers, and we can skip the next block of questions.  For example, a passenger is asked: ‚ÄúHave they offered you food?‚Äù.  And if not, then we will not ask how much he liked what was eaten, but let us move on to the question of drinks. <br><br>  For this, additional connections are set up on the server, which we have learned to read and build on the client. <br><br>  Before takeoff, we calculate the range of time for which the flight will take place.  For this, local notification is used, which is calculated automatically.  For each section ("At the airport of departure", "On Board", "At the airport of arrival") there is a range of times when it is active and valid.  For this time range, we calculate when it is better to show the notification.  For example, the ‚ÄúOn the Plane‚Äù block of questions turns on an hour after takeoff, based on the fact that the passenger has already reached for the phone to play or read.  Let at the same time and the survey will take place. <br><br>  After arrival, we send a notification where we offer to send answers.  A person can refuse or go through some of the answers later, so we send another notification with a reminder.  The message is sent only in the daytime (from 10 to 18), taking into account the user's time zone, in order not to wake anyone up and not to angry.  Then we cache all the responses and send the JSON file to the server. <br><br><img src="https://habrastorage.org/webt/po/bn/8-/pobn8-rpxmxpfiep62lrcvxx9mw.jpeg"><br><br><h3>  Data analysis </h3><br>  Then all the answers are uploaded to the database.  The customer can build queries and receive analytics, distributed over time.  For example, how much the passengers liked the service at Domodedovo or how the passengers rate the service on a particular flight.  This is a tool that will allow you to quickly receive feedback and trace patterns when there are enough answers for the relevant sample. <br><br><h3>  Results and plans </h3><br>  <b>We solved two important tasks:</b> <br><br><ul><li>  We learned how to quickly collect reliable data online due to the fact that we can interrogate passengers in a digital format at the exact moment when the event occurs. </li><li>  Got the opportunity to segment passengers and ask them only those questions that are relevant to them.  We interview everyone, but we adjust the survey so that all the questions in it already take into account the passenger‚Äôs experience, the composition of his booking, the class of the flight, etc. </li></ul><br>  <b>And then what are your plans?</b> <br><br><ul><li>  Self Registration <br>  Users who have an active booking with S7 Airlines flight will be able to independently log in to the application without an invitation by email.  To do this, just enter the ticket number and the passenger's name at the authorization stage. </li></ul><br><br><ul><li>  Bonuses for answers <br>  In the future, a system of remuneration for completed surveys is planned.  What it will be, the company still keeps a secret.  As they say, stay tuned. </li></ul><br><br><ul><li>  Dynamic adjustment to changes in the flight <br>  Questions will not only be generated for each passenger, but also adapt to the changes.  For example, in cases where the flight was delayed or the passenger was late for the plane, we will move questions to the new departure time. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/354262/">https://habr.com/ru/post/354262/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354252/index.html">Vivaldi 1.15 - nice and comfortable</a></li>
<li><a href="../354254/index.html">Do not waste days worrying about the years. Or where success is born</a></li>
<li><a href="../354256/index.html">Casinos hacked through a thermostat in an aquarium</a></li>
<li><a href="../354258/index.html">And if we do not design a system for managing the production of IT products. Part 2. Basic solution structure</a></li>
<li><a href="../354260/index.html">How to earn your first $ 100 in the Google Play Market - my experience</a></li>
<li><a href="../354264/index.html">What's New in PostgreSQL 11: JSONB Transforms</a></li>
<li><a href="../354266/index.html">Internship in e-Legion</a></li>
<li><a href="../354268/index.html">Morrowind Project</a></li>
<li><a href="../354270/index.html">Insolence and enthusiasm for rapid growth from Aviasales</a></li>
<li><a href="../354274/index.html">Using libpam when setting up SOCKS Dante server</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>