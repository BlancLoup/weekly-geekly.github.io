<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A simple in-circuit programmer LPC microcontroller. Features in-circuit programming. Part two</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my first article I described a simple programmer circuit , today I will tell you how to connect it to a programmable device. 

 Fig. 1. The appeara...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A simple in-circuit programmer LPC microcontroller. Features in-circuit programming. Part two</h1><div class="post__text post__text-html js-mediator-article">  In my first article I described <a href="http://habrahabr.ru/post/163767/">a simple programmer circuit</a> , today I will tell you how to connect it to a programmable device. <br><img src="https://habrastorage.org/storage2/993/561/2b5/9935612b5a89ecf10ffedf15a78630aa.jpg"><br>  Fig.  1. The appearance of the programmer. <br>  In the good old times, when microcontrollers with flash memory of programs based on FLASH were just beginning to appear, they were programmed via a parallel interface.  At the same time, more than 20 outputs could be used for programming and it was often necessary to use an increased voltage of 12 volts or more.  Microcontrollers were then produced in pinouts DIP enclosures. <a name="habracut"></a>  They were programmed mainly by inserting them into high-quality programmer sockets, and only then they were soldered into the device.  However, over time, the transition to programming via the serial channel began, with only 4-5 signal legs already being used for programming.  In addition, the chips were made in a completely exotic buildings.  Reliable panels for such cases sometimes could cost almost more than the programmer itself!  Now it is possible and necessary to reprogram microcontrollers without soldering from the circuit - in-circuit programming.  This is very convenient for debugging the program.  In addition, it became possible to make the installation of the entire board, and programming should be carried out when setting up and releasing the device.  This is especially convenient when working with contract manufacturers - there is a guarantee that no code leak will occur. <br>  Today, most devices on microcontrollers use in-circuit programming.  For illustration, consider the LPC2xxx microcontrollers. <br>  These microcontrollers have a built-in bootloader that allows flash memory to be flashed by in-circuit programming.  Serial port 0 is used for data transmission - RXD0 and TXD0 pins.  The algorithm for entering the programming mode is very simple; for this, only two additional signal legs are used - P0.14 and Reset. <br>  Port P0.14 is set to a low logic level, in other words, it closes to ground, while the Reset pin must have a high logic level.  It is worth noting, however, that exceptions are possible if a user program was previously run, for example, in which the watchdog timer was activated.  Therefore, the most reliable algorithm for entering the microcontroller into the programming mode is as follows. <br>  Before turning on the power, close pins P0.14 and Reset to ground.  Apply power, wait until it reaches the nominal value.  Transfer Reset to a high logic level, wait at least a few milliseconds and submit a high level to P0.14. <br>  To successfully use this feature, you need to follow a few uncomplicated rules that are easier to demonstrate with an example of a programmer connection circuit to a device based on a microcontroller from the LPC 214x series.  For programming, we will use the programmer described in the last article. <br><img src="https://habrastorage.org/storage2/09f/4ce/6c1/09f4ce6c1436cf38fbfa4770ee147a45.jpg"><br>  Fig.  2. Wiring diagram of the programmer. <br>  Let's begin the review of the scheme.  P0.14 port is pulled to power with the help of resistor R4, so that when the device is turned on in normal mode, a high level appears on it and, accordingly, the user program is started.  In the LPC_RESET circuit, there is a pull-down register for power and a capacitor to ground.  For normal operation, their ratings must be selected depending on the power source used.  The fact is that when the device is connected to power, the voltage on it reaches the nominal value not instantaneously, but gradually, as the filtering capacity is charged.  For normal operation of the device, it is necessary that the microcontroller start up only when a certain power level is reached, special circuits are provided for this in modern microcontrollers, but rely on them and don‚Äôt make it - as practice shows, with a slow increase in the supply voltage, these schemes may not work correctly.  At the moment when the supply voltage is applied, the capacitor C2 starts charging and the voltage on it is kept for a while at a low level.  It is desirable to select the circuit ratings of R5, C2 in such a way that a high level at the RESET input does not appear before the power supply voltage of the microcontroller reaches a voltage of 2.6 volts. <br>  The programming process takes place at a low level at the RESET input, with all the I / O ports of the microcontroller being converted to a high-resistance state.  If the ports of your microcontroller are used to control any nodes, for example, power switches or controlled voltage regulators, they must be tightened to the required logic level during programming, otherwise big troubles can occur, even the board itself and the devices it controls fail. <br>  In our example, the zero COM port is used not only for programming, but also for data exchange via the RS485 interface.  For this is the node on the chip D2.  Usually, the D2 chip is constantly switched to receive mode, while it generates a signal at the RXD input of the microcontroller.  In programming mode, this signal will interfere with the programmer, so that this does not happen, the resistance R1 and R3 are provided in the circuit.  R1 puts the D2 receiver in an inactive state ‚Äî the R0 output goes into a high-resistance state and does not interfere with data transfer to the programmer, and R3 turns off the transmitter so that incorrect data is not received through the RS-485 driver of the interface. <br>  If you intend to use sufficiently long wires for programming, or there is a possibility that the device may be reprogrammed by users who do not have sufficient qualifications, you should worry about protecting the programmable microcontroller from static and voltage surges.  I, for example, had a case when the device had to replace the microcontroller 4 times due to Krivorukov ‚Äúprogrammers‚Äù!  The simplest protection can consist of diodes or zener diodes that limit the voltage and resistors connected in series with low resistance.  For example, as shown in Figure 3. <br><img src="https://habrastorage.org/storage2/c2e/6ee/da8/c2e6eeda8455384c234b4b7f5aa9780b.jpg"><br>  Fig.  3. Connection diagram of the programmer with protective circuits. <br>  It remains to add that for programming microcontrollers of the LPC2xxx family based on the ARM7TDMI core, pin 3 of the programmer is connected to port P0.14.  To program the microcontrollers of the LPCxxx family based on the ARM7 Cortex core, pin 3 of the programmer is connected to port P2.10. <br>  The topic of programming microcontrollers and other devices, despite the apparent simplicity, is very multifaceted and full of nuances.  However, for our case <br>  It remains to talk about the software and programming features of the LPC900 series. <br>  PS This article is intended mainly for beginners, so I apologize for possibly explaining some obvious things to the pros in too much detail. </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/164381/">https://habr.com/ru/post/164381/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../164367/index.html">Parallax effect for live wallpaper on Android</a></li>
<li><a href="../164371/index.html">NIST SP 800: Information Security Library</a></li>
<li><a href="../164373/index.html">Marmalade announces support for Windows Phone 8</a></li>
<li><a href="../164377/index.html">Using Database Connections in Multi-threaded Qt Applications</a></li>
<li><a href="../164379/index.html">How the owner of a team Dropbox account can destroy your Dropbox account</a></li>
<li><a href="../164383/index.html">Microsoft Reporting Services tips for beginners. Part 2</a></li>
<li><a href="../164385/index.html">LED Christmas tree on the Arduino in one evening</a></li>
<li><a href="../164391/index.html">Logic - weekly selection of gaming and IT industry news ‚Ññ7</a></li>
<li><a href="../164393/index.html">About torrent and seeders</a></li>
<li><a href="../164397/index.html">Easyweb: New Year Update</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>