<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Labyrinth generation by Euler algorithm in 30 lines</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Well, you should immediately apologize for the late reaction, because the ‚Äúweek of 30 lines‚Äù has passed, and I am posting this post just now. All beca...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Labyrinth generation by Euler algorithm in 30 lines</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/b54/ce8/674/b54ce86744043f5526041940c4b5432a.jpg" alt="image"><br>  Well, you should immediately apologize for the late reaction, because the ‚Äúweek of 30 lines‚Äù has passed, and I am posting this post just now.  All because of the hard work week and only on weekends we managed to allocate some time. <br>  Immediately thank the <a href="http://habrahabr.ru/users/deadkrolik/" class="user_link">deadkrolik</a> user for the article <a href="http://habrahabr.ru/post/176671/">Eller‚Äôs Algorithm for generating labyrinths</a> and agree that I‚Äôm a rogue and a crook and do not smell here in 30 lines of code))) Who doesn‚Äôt like to wait for an explanation, please go straight to <a href="http://jsfiddle.net/lPestl/W54f6/">Fiddle</a> . <br><a name="habracut"></a><br>  When I just wrote these unlucky labyrinths, my code took up about 200 lines with comments, indents and a bunch of unnecessary variables.  Of course, it was necessary to reduce it.  But something was not an easy task and I could not cut the code in 30 lines.  All that happened after my manipulations can be found here: <br><pre><code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mapGen</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">elid, w, h, steps, complete</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> canvas = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(elid), cell = canvas.getContext(<span class="hljs-string"><span class="hljs-string">"2d"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'#step'</span></span>).innerHTML = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(steps), <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'#complete'</span></span>).innerHTML = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(complete); canvas.width = w * <span class="hljs-number"><span class="hljs-number">13</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span>, canvas.height = h * <span class="hljs-number"><span class="hljs-number">13</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span>; cell.fillStyle = <span class="hljs-string"><span class="hljs-string">"black"</span></span>, cell.fillRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, w * <span class="hljs-number"><span class="hljs-number">13</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span>, h * <span class="hljs-number"><span class="hljs-number">13</span></span> + <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> line = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(w), cell_floor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(w), cell_wall = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(w), many = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (cr_l = <span class="hljs-number"><span class="hljs-number">0</span></span>; cr_l &lt; h; cr_l++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; w; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cr_l == <span class="hljs-number"><span class="hljs-number">0</span></span>) line[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>; cell.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * i + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * cr_l + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), cell_wall[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cell_floor[i] == <span class="hljs-number"><span class="hljs-number">1</span></span>) cell_floor[i] = line[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (line[i] == <span class="hljs-number"><span class="hljs-number">0</span></span>) line[i] = many++;} <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; w; i++) { cell_wall[i] = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() * <span class="hljs-number"><span class="hljs-number">2</span></span>), cell_floor[i] = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() * <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((cell_wall[i] == <span class="hljs-number"><span class="hljs-number">0</span></span>) || (cr_l == h - <span class="hljs-number"><span class="hljs-number">1</span></span>)) &amp;&amp; (i != w - <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (line[i + <span class="hljs-number"><span class="hljs-number">1</span></span>] != line[i])) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> temp_line = line[i + <span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; w; j++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (line[j] == temp_line) line[j] = line[i]; cell.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * i + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * cr_l + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((cr_l != h - <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (cell_floor[i] == <span class="hljs-number"><span class="hljs-number">0</span></span>)) cell.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * i + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * cr_l + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>);} <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; w; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count_floor = <span class="hljs-number"><span class="hljs-number">0</span></span>, count_hole = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; w; j++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((line[i] == line[j]) &amp;&amp; (cell_floor[j] == <span class="hljs-number"><span class="hljs-number">0</span></span>)) count_hole++; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> count_floor++; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count_hole == <span class="hljs-number"><span class="hljs-number">0</span></span>) { cell_floor[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>; cell.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * i + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * cr_l + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>);}}} cell.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * w, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cur_x = <span class="hljs-number"><span class="hljs-number">0</span></span>, cur_y = <span class="hljs-number"><span class="hljs-number">0</span></span>; cell.fillStyle = <span class="hljs-string"><span class="hljs-string">"red"</span></span>; character(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.onkeydown = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((e.keyCode &gt; <span class="hljs-number"><span class="hljs-number">36</span></span>) &amp;&amp; (e.keyCode &lt; <span class="hljs-number"><span class="hljs-number">41</span></span>)) character((e.keyCode - <span class="hljs-number"><span class="hljs-number">38</span></span>) % <span class="hljs-number"><span class="hljs-number">2</span></span>, (e.keyCode - <span class="hljs-number"><span class="hljs-number">39</span></span>) % <span class="hljs-number"><span class="hljs-number">2</span></span>);}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">character</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sx, sy</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stepData = cell.getImageData(<span class="hljs-number"><span class="hljs-number">13</span></span> * cur_x + <span class="hljs-number"><span class="hljs-number">7</span></span> + <span class="hljs-number"><span class="hljs-number">6</span></span> * sx, <span class="hljs-number"><span class="hljs-number">13</span></span> * cur_y + <span class="hljs-number"><span class="hljs-number">7</span></span> + <span class="hljs-number"><span class="hljs-number">6</span></span> * sy, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((stepData.data[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp;&amp; (stepData.data[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp;&amp; (stepData.data[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp;&amp; (stepData.data[<span class="hljs-number"><span class="hljs-number">3</span></span>] == <span class="hljs-number"><span class="hljs-number">255</span></span>)) sx = sy = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'#step'</span></span>).innerHTML = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'#step'</span></span>).innerHTML) + <span class="hljs-number"><span class="hljs-number">1</span></span>; cell.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * cur_x + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * cur_y + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); cur_x += sx, cur_y += sy; cell.fillRect(<span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">13</span></span> * cur_x, <span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">13</span></span> * cur_y, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cur_x &gt;= w) mapGen(<span class="hljs-string"><span class="hljs-string">"#canvas"</span></span>, w, h, <span class="hljs-number"><span class="hljs-number">0</span></span>, complete + <span class="hljs-number"><span class="hljs-number">1</span></span>);} })(<span class="hljs-string"><span class="hljs-string">"#canvas"</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre> <br><br>  In the overall standings 42 lines turned out.  But even here, attentive users see a scam, because  I declared several variables in one line, and also contained both condition and operators in one line.  I really wanted to put everything in 30 lines all the same, and I continued the scam!  On the Internet I found a very interesting and good code optimizer, which you can find <a href="http://closure-compiler.appspot.com/home">here</a> .  He managed to reduce my code to 38 lines.  There is no limit to my impudence at all, and with the help of a dashing operator "," and a few keystrokes of the DEL key, I still put everything in 30 lines. <br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mapGen</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">b, c, e, a, m</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">character</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> h = d.getImageData(<span class="hljs-number"><span class="hljs-number">13</span></span> * f + <span class="hljs-number"><span class="hljs-number">7</span></span> + <span class="hljs-number"><span class="hljs-number">6</span></span> * a, <span class="hljs-number"><span class="hljs-number">13</span></span> * g + <span class="hljs-number"><span class="hljs-number">7</span></span> + <span class="hljs-number"><span class="hljs-number">6</span></span> * b, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-number"><span class="hljs-number">0</span></span> == h.data[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp;&amp; <span class="hljs-number"><span class="hljs-number">0</span></span> == h.data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &amp;&amp; <span class="hljs-number"><span class="hljs-number">0</span></span> == h.data[<span class="hljs-number"><span class="hljs-number">2</span></span>] &amp;&amp; <span class="hljs-number"><span class="hljs-number">255</span></span> == h.data[<span class="hljs-number"><span class="hljs-number">3</span></span>] ? a = b = <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">"#step"</span></span>).innerHTML = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">"#step"</span></span>).innerHTML) + <span class="hljs-number"><span class="hljs-number">1</span></span>; d.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * f + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * g + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), f += a, g += b, d.fillRect(<span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">13</span></span> * f, <span class="hljs-number"><span class="hljs-number">3</span></span> + <span class="hljs-number"><span class="hljs-number">13</span></span> * g, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); f &gt;= c &amp;&amp; mapGen(<span class="hljs-string"><span class="hljs-string">"#canvas"</span></span>, c, e, <span class="hljs-number"><span class="hljs-number">0</span></span>, m + <span class="hljs-number"><span class="hljs-number">1</span></span>)} b = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(b); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = b.getContext(<span class="hljs-string"><span class="hljs-string">"2d"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">"#step"</span></span>).innerHTML = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(a), <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">"#complete"</span></span>).innerHTML = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(m); b.width = <span class="hljs-number"><span class="hljs-number">13</span></span> * c + <span class="hljs-number"><span class="hljs-number">3</span></span>, b.height = <span class="hljs-number"><span class="hljs-number">13</span></span> * e + <span class="hljs-number"><span class="hljs-number">3</span></span>, d.fillStyle = <span class="hljs-string"><span class="hljs-string">"black"</span></span>, d.fillRect(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * c + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * e + <span class="hljs-number"><span class="hljs-number">3</span></span>), a = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(c), b = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(c); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> k = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(c), q = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (cr_l = <span class="hljs-number"><span class="hljs-number">0</span></span>; cr_l &lt; e; cr_l++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; c; i++) <span class="hljs-number"><span class="hljs-number">0</span></span> == cr_l &amp;&amp; (a[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>), d.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * i + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * cr_l + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>), k[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> == b[i] &amp;&amp; (b[i] = a[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span> == a[i] &amp;&amp; (a[i] = q++); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; c; i++) { k[i] = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(<span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()), b[i] = <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(<span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-number"><span class="hljs-number">0</span></span> == k[i] || cr_l == e - <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; i != c - <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; a[i + <span class="hljs-number"><span class="hljs-number">1</span></span>] != a[i]) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> l = a[i + <span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; c; j++) a[j] == l &amp;&amp; (a[j] = a[i]); d.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * i + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * cr_l + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) } cr_l != e - <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; <span class="hljs-number"><span class="hljs-number">0</span></span> == b[i] &amp;&amp; d.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * i + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * cr_l + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; c; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> p = l = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; c; j++) a[i] == a[j] &amp;&amp; <span class="hljs-number"><span class="hljs-number">0</span></span> == b[j] ? p++ : l++; <span class="hljs-number"><span class="hljs-number">0</span></span> == p &amp;&amp; (b[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>, d.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * i + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span> * cr_l + <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>)) } } d.clearRect(<span class="hljs-number"><span class="hljs-number">13</span></span> * c, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = <span class="hljs-number"><span class="hljs-number">0</span></span>, g = <span class="hljs-number"><span class="hljs-number">0</span></span>; d.fillStyle = <span class="hljs-string"><span class="hljs-string">"red"</span></span>, character(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.onkeydown = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-number"><span class="hljs-number">36</span></span> &lt; a.keyCode &amp;&amp; <span class="hljs-number"><span class="hljs-number">41</span></span> &gt; a.keyCode &amp;&amp; character((a.keyCode - <span class="hljs-number"><span class="hljs-number">38</span></span>) % <span class="hljs-number"><span class="hljs-number">2</span></span>, (a.keyCode - <span class="hljs-number"><span class="hljs-number">39</span></span>) % <span class="hljs-number"><span class="hljs-number">2</span></span>) } })(<span class="hljs-string"><span class="hljs-string">"#canvas"</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br><br>  The input parameters of this function are the drawing area, the width and length of the maze by the number of cells, the number of steps taken by the character and the number of the mazes passed. <br>  I do not pretend to a good code or at least good reviews, but I am pleased to share my first post.  Please do not judge strictly.  And all comments and corrections carefully listen in the comments. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      UPD 1: <br>  To improve the aesthetics and readability of the code: <br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mapGen</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">b, c, e, a, m</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    function character(a, b) { //          ,       var h = d.getImageData(13 * f + 7 + 6 * a, 13 * g + 7 + 6 * b, 1, 1); //    ,     ( dx (a)  dy (b)),     0 == h.data[0] &amp;&amp; 0 == h.data[1] &amp;&amp; 0 == h.data[2] &amp;&amp; 255 == h.data[3] ? a = b = 0 : document.querySelector("#step").innerHTML = Math.floor(document.querySelector("#step").innerHTML) + 1; //   d.clearRect(13 * f + 3, 13 * g + 3, 10, 10); //     f += a; g += b; //    d.fillRect(3 + 13 * f, 3 + 13 * g, 10, 10); //      ,         f &gt;= c &amp;&amp; mapGen("#canvas", c, e, 0, m + 1) } //    b = document.querySelector(b); var d = b.getContext("2d"); //        document.querySelector("#step").innerHTML = Math.floor(a); document.querySelector("#complete").innerHTML = Math.floor(m); //       b.width = 13 * c + 3; b.height = 13 * e + 3; //      d.fillStyle = "black"; d.fillRect(0, 0, 13 * c + 3, 13 * e + 3); //        ,          a = Array(c); b = Array(c); var k = Array(c), //   q = 1; //    for (cr_l = 0; cr_l &lt; e; cr_l++) { //       -  for (i = 0; i &lt; c; i++) 0 == cr_l &amp;&amp; (a[i] = 0), d.clearRect(13 * i + 3, 13 * cr_l + 3, 10, 10), k[i] = 0, 1 == b[i] &amp;&amp; (b[i] = a[i] = 0), 0 == a[i] &amp;&amp; (a[i] = q++); //        for (i = 0; i &lt; c; i++) { k[i] = Math.floor(2 * Math.random()), b[i] = Math.floor(2 * Math.random()); if ((0 == k[i] || cr_l == e - 1) &amp;&amp; i != c - 1 &amp;&amp; a[i + 1] != a[i]) { var l = a[i + 1]; for (j = 0; j &lt; c; j++) a[j] == l &amp;&amp; (a[j] = a[i]); d.clearRect(13 * i + 3, 13 * cr_l + 3, 15, 10) } cr_l != e - 1 &amp;&amp; 0 == b[i] &amp;&amp; d.clearRect(13 * i + 3, 13 * cr_l + 3, 10, 15) } //    . for (i = 0; i &lt; c; i++) { var p = l = 0; for (j = 0; j &lt; c; j++) a[i] == a[j] &amp;&amp; 0 == b[j] ? p++ : l++; 0 == p &amp;&amp; (b[i] = 0, d.clearRect(13 * i + 3, 13 * cr_l + 3, 10, 15)) } } //     d.clearRect(13 * c, 3, 15, 10); //     var f = 0, g = 0; //    d.fillStyle = "red"; //       character(-1, -1); //    document.body.onkeydown = function (a) { 36 &lt; a.keyCode &amp;&amp; 41 &gt; a.keyCode &amp;&amp; character((a.keyCode - 38) % 2, (a.keyCode - 39) % 2) } })("#canvas", 25, 30, 0, 0);</span></span></code> </pre></div><p>Source: <a href="https://habr.com/ru/post/203478/">https://habr.com/ru/post/203478/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../203460/index.html">Plasma Crystal Experiment and Science on the ISS</a></li>
<li><a href="../203462/index.html">HTML5 Canvas Scheme of the suburban movement of the railway communication of Moscow and Moscow Region</a></li>
<li><a href="../203466/index.html">About private "clouds": what and how is usually done in Russia, educational program and the main problems</a></li>
<li><a href="../203470/index.html">Neurozagadka</a></li>
<li><a href="../203476/index.html">Where is the story of space</a></li>
<li><a href="../203482/index.html">The digest of interesting news and materials from the world of PHP No. 30 (November 10‚Äî24, 2013)</a></li>
<li><a href="../203484/index.html">Query optimization. Basics of EXPLAIN in PostgreSQL (part 3)</a></li>
<li><a href="../203488/index.html">Desktop in a home server or all-in-one</a></li>
<li><a href="../203490/index.html">Why 98% of the texts on your sites do not work. At all. And how to fix it</a></li>
<li><a href="../203492/index.html">Do not trust "people of the people"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>