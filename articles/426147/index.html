<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ASP.NET Core 2 Boilerplate with React, Redux and Buns</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Finally, that moment came when I could introduce you to the React Core Boilerplate ( GitHub , Visual Studio Marketplace ), or, in other words, a ready...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ASP.NET Core 2 Boilerplate with React, Redux and Buns</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/uk/yi/uy/ukyiuyzyeahoi3rebyllgcqv8ao.png"><br>  Finally, that moment came when I could introduce you to the React Core Boilerplate ( <a href="https://github.com/NickMaev/react-core-boilerplate">GitHub</a> , <a href="https://marketplace.visualstudio.com/items%3FitemName%3DNikolayMaev.ReactCoreBoilerplate">Visual Studio Marketplace</a> ), or, in other words, a ready-made project template on ASP.NET Core. </p><br><p>  Interesting?  Welcome under cat. </p><a name="habracut"></a><br><h1 id="osnovnye-elementy-shablona">  The main elements of the template: </h1><br><ul><li>  <a href="https://github.com/aspnet/Mvc">ASP.NET Core 2</a> - in fact, the foundation. </li><li>  <a href="https://www.typescriptlang.org/">TypeScript</a> - the front-end is written on it. </li><li>  <a href="https://reactjs.org/">React</a> + Server-side rendering (SSR), then - a library that works both on the client side and the server using NodeServices. </li><li>  <a href="https://github.com/nfl/react-helmet">React Helmet</a> - a plugin that allows you to manage title and meta tags, also works with SSR. </li><li>  <a href="https://redux.js.org/">Redux</a> is a container of application states. </li><li>  <a href="https://sass-lang.com/">SASS</a> - CSS styles preprocessor. </li><li>  <a href="https://webpack.js.org/">Webpack 4</a> is a module builder. </li><li>  <a href="https://github.com/axios/axios">Axios</a> - provides isomorphic fetch queries. </li><li>  <a href="https://github.com/dsherret/ts-nameof">ts-nameof</a> - allows using TypeScript expressions to get the path to nested objects, ala Html.NameFor in Razor;  Works together with NSerializeJson form serialization. </li></ul><br><p>  Own developments written in TypeScript and forks that I fixed: </p><br><ul><li>  <a href="https://github.com/NickMaev/domain-wait">domain-wait</a> is similar to domain-task, but allows using async / await.  Designed to wait for server rendering fetch requests. </li><li>  <a href="https://github.com/NickMaev/NVal">NVal</a> is a form validator (approximate by API with jquery.validation). </li><li>  <a href="https://github.com/NickMaev/NVal-Tippy">NVal-Tippy</a> is an addition to NVal, which allows using <a href="https://atomiks.github.io/tippyjs/">js</a> to make pop-up validation errors in tooltips. </li><li>  <a href="https://github.com/NickMaev/NSerializeJson">NSerializeJson</a> is a forms serializer in JSON with type settings (similar to <a href="https://github.com/marioizquierdo/jquery.serializeJSON">serializeJSON</a> ). </li><li>  <a href="https://github.com/NickMaev/bootstrap3-native">bootstrap3-native</a> - fixed fork <a href="https://github.com/thednp/bootstrap.native">native</a> , which allows to work with elements of bootstrap 3. </li></ul><br><h1 id="cel-proekta">  Objective of the project </h1><br><p>  The purpose of this project is to support the developers of this stack: to give the opportunity to immediately begin to develop projects, not bothering with the solution of problems of compatibility of technologies in the stack, their configuration.  Since the project was created ‚Äúfor people‚Äù and contains, in my opinion, an intuitive architecture, it will also be useful for beginners in teaching React, because  does not contain problems out of the box for building applications. </p><br><h1 id="detali">  Details </h1><br><h2 id="s-chego-vsyo-nachinalos">  How it all began </h2><br><p>  I am a full-stack developer.  Once I loved writing frontend on jQuery - from plugin development to complex sites.  However, one day it became clear: the more difficult the project is, the more difficult it is to support sites on this library.  Then I decided to study other tools for the development of the frontend.  I didn‚Äôt like Angular because of my thick abstraction, and after studying the advantages and disadvantages of each framework and library, I made a choice in favor of React, which attracted the fact that HTML and TypeScript can be written in one place (.tsx file) without switching between HTML and script files. </p><br><p>  Over time, I loved React.  But, to be honest, at first I had to use jQuery in React because of the plug-ins that require it.  And then, when I tried to master server rendering due to the well-known problems of SPA and SEO, I learned that jQuery either cannot be friends with it, or it will be a crutch (via jsdom, because a window object is required).  I knew that these jQuery plug-ins would be missed.  And since then, I started developing plugins for "Vanilla JS" that are somewhat similar in API to plugins running on jQuery. </p><br><h2 id="servernyy-rendering">  Server rendering </h2><br><p>  A few months ago, Microsoft released an update for Visual Studio 2017, which included an ASP.NET Core 2 + TypeScript + React + Redux + Webpack project template with a server prerender using NodeServices.  Studying the template, I spent a lot of time to connect SASS via WebPack and update the last one, because studying the documentation, forums and StackOverflow, I did not find the answers I needed to configure this stack, while the documentation was mainly stack with angular.  After some time, Microsoft replaced this template with create-react-app without TypeScript and server rendering.  Judging by the comments on the Internet, it embarrassed many others, like me.  However, I still have that template, and I decided to make my own with blackjack and buns, having dealt with it and solved all the problems at once. </p><br><p>  PS: Recently I read that there are so-called opponents of an isomorphic approach to developing applications.  What about SEO?  Or do you offer to render all paid third-party services?  As far as I know, Google can not always index a fat client without a pre-tender.  Anyway. </p><br><h2 id="tehnicheskaya-chast">  Technical part </h2><br><h3 id="react-react-router-redux">  React, React Router, Redux </h3><br><ul><li>  Both libraries have been updated to the latest version, except react-router-redux, something is wrong with it. </li><li>  Added examples of their sharing, including the use of Route, along with different Layout (component AppRoute). </li></ul><br><h3 id="webpack-i-moduli">  Webpack and modules </h3><br><ul><li>  Due to its special structure of the WebPack configuration, namely, its separation into server and client parts, it was necessary to use ingenuity to connect the loaders and update WebPack: put a stub for SASS in the WebPack server configuration to collect styles only in the client part (the style-loader requires the presence of the window).  And if you use Extract CSS plugin (now MiniCssExtractPlugin for WebPack 4), then, while updating files, the Hot Module Reload (HMR) did not work.  Since the original Microsoft template had the configuration for the old versions of the libraries and the WebPack itself, a lot had to be done. </li><li>  Aliases of frequently used paths in WebPack and tsconfig.json have been added. </li><li>  awesome-typescript-loader replaced by babel-loader. </li></ul><br><h3 id="nodeservices">  NodeServices </h3><br><p>  NodeServices documentation was not enough to solve some problems: either the HMR fell off, then something did not work.  However, having shown patience, after a month and a half, I finally managed to resolve critical moments: </p><br><p>  ‚¨ù Instead of the "asp-prerender-module" attribute for the DIV element in View Razor, I had to inject ISpaPrerender into it: </p><br><pre><code class="hljs scala"><span class="hljs-meta"><span class="hljs-meta">@inject</span></span> <span class="hljs-type"><span class="hljs-type">Microsoft</span></span>.<span class="hljs-type"><span class="hljs-type">AspNetCore</span></span>.<span class="hljs-type"><span class="hljs-type">SpaServices</span></span>.<span class="hljs-type"><span class="hljs-type">Prerendering</span></span>.<span class="hljs-type"><span class="hljs-type">ISpaPrerenderer</span></span> prerenderer</code> </pre> <br><p>  and, manually execute the script: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> prerenderResult = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> prerenderer.RenderToString(%     %, customDataParameter: data);</code> </pre> <br><p>  Then, from the prerenderResult object, you can drag the rendered HTML React'a and React Helmet into BODY / DIV and HEAD blocks, respectively. </p><br><p>  ‚¨ù The domain-task NPM package did not allow using async / await and tools for fetch requests except isomorfic-fetch and fetch from the same npm package.  This is fixed by me in the domain-wait package.  Now fetch requests are more pleasant to write, especially using axios. </p><br><h3 id="arhitektura-prilozheniya">  Application architecture </h3><br><p>  From personal experience, I made some achievements, for example, in all methods of services (except for authorization), to accept a ServiceUser and return a Result object with result or errors.  Both such objects + an imitation of the authorization service are already incorporated in the boilerplate.  I am an opponent of Identity, and authorization is not suitable for everyone.  So, nothing superfluous, and the imitation of authorization is easy to cut out (AccountService, Middleware, ControllerBase). </p><br><ul><li>  Two React's Layout - guest and for authorized users. </li><li>  The plug-ins written by me are also connected, which are available in NPM and are actively used.  Now it is easy to integrate forms with validation, and pull out JSON data from them.  All this is demonstrated in the example in the template. </li><li>  On the frontend side, all fetch requests are encapsulated into services that are also isomorphic, i.e.  can work on the server side. </li><li>  The project provides an example of how, in my opinion, the application should look like: an easily readable and intuitive application structure and code. </li></ul><br><div class="spoiler">  <b class="spoiler_title">File structure</b> <div class="spoiler_text"><pre> <code class="bash hljs">| .gitignore | AppSettings.cs | appsettings.Development.json | appsettings.json | Constants.cs <span class="hljs-comment"><span class="hljs-comment"># ,       . | package.json #  NPM. | Program.cs #   . | ReactSSR.WebApp.csproj #   Visual Studio 2017. | README.md | Startup.cs #     middleware  . | tsconfig.json #   TypeScript. | webpack.config.js #   WebPack      . | webpack.config.vendor.js #   WebPack     Vendor-. | +---ClientApp | | boot-client.tsx #       . | | boot-server.tsx #        . | | configureStore.ts #   Redux. | | global.d.ts #      TypeScript   (, ts-nameof, \*.png,  ..) | | Globals.ts #     (,   ). | | routes.tsx #    . | | Ui.ts #    UI (,  ). | | utils.ts #   . | | | +---components #  ( ). | | +---person | | | PersonEditor.tsx # ,    . | | | | | \---shared #  . | | AppRoute.tsx #      ,   . | | ErrorBoundary.tsx # ,    &amp;quot;error boundary&amp;quot;.    ,      . | | Footer.tsx #    . | | Loader.tsx # ,   . | | PagingBar.tsx #  . | | TopMenu.tsx #     . | | | +---images | | logo.png #  . | | | +---layouts #  (). | | AuthorizedLayout.tsx | | GuestLayout.tsx | | | +---models #  TypeScript,   . | | ILoginModel.ts | | IPersonModel.ts | | IServiceUser.ts | | ISessionData.ts | | Result.ts #   &amp;quot;Result&amp;quot;. | | | +---pages #  . | | ExamplePage.tsx | | HomePage.tsx | | LoginPage.tsx | | | +---services #  JS-,      . | | AccountService.ts # JS-  . | | PersonService.ts # JS- - . | | ServiceBase.ts #   TS-    JS-. | | | +---store #  Redux. | | index.ts #    Redux. | | LoginStore.ts | | PersonStore.ts #   . | | | \---styles | authorizedLayout.scss #    . | guestLayout.scss #    . | loader.scss #    . | main.scss #  . | preloader.css #     . | +---Controllers | AccountController.cs #   . | ControllerBase.cs #       . | MainController.cs #   . | PersonController.cs # -.. | +---Extensions | ServiceCollectionExtensions.cs #  ,   Lazy DI . | +---Infrastructure # ,     . | Result.cs #   &amp;quot;Result&amp;quot;   . | ServiceBase.cs #     ,   Facade/. | +---Models | LoginModel.cs #    . | PersonModel.cs #   . | ServiceUser.cs | SessionData.cs #    . | +---Services #  ,   &amp;quot;Facade&amp;quot;. | AccountService.cs #   . | PersonService.cs # -. | +---Views | | \_ViewImports.cshtml | | \_ViewStart.cshtml | | | +---Main | | Index.cshtml #   ,   ,    . | | | \---Shared | Error.cshtml | \---wwwroot #  ,     . favicon.ico</span></span></code> </pre> </div></div><br><p>  That's all.  Thank you all for your attention and, of course, Happy Coding! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/426147/">https://habr.com/ru/post/426147/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../426135/index.html">Private cloud for the Internet of Things</a></li>
<li><a href="../426137/index.html">Age of Honesty</a></li>
<li><a href="../426141/index.html">Red Hat replaces Docker with Podman</a></li>
<li><a href="../426143/index.html">3D animation - video or interactive?</a></li>
<li><a href="../426145/index.html">Seminar "Independent acceptance", October 23, Moscow</a></li>
<li><a href="../426149/index.html">Do-it-yourself Python installer for Android builds from TeamCity</a></li>
<li><a href="../426151/index.html">Friday programmer, or as I wrote a library for lexical and parsing code</a></li>
<li><a href="../426155/index.html">We optimize the web with Vitaly Friedman: download speed, memory, CPU</a></li>
<li><a href="../426157/index.html">PUE: know to bring down</a></li>
<li><a href="../426159/index.html">Is it possible to close back open source code?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>