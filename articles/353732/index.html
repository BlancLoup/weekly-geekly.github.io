<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Crypto Trading Automation with Django and Celery</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the light of the rapid development of cryptoindustry and cryptotrading in particular, our team, within the framework of the experiment, decided to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Crypto Trading Automation with Django and Celery</h1><div class="post__text post__text-html js-mediator-article"><p>  In the light of the rapid development of cryptoindustry and cryptotrading in particular, our team, within the framework of the experiment, decided to create a trading robot, whose main goal is to trade on the <a href="https://poloniex.com/">poloniex crypto site</a> .  In this article I will try to talk about all the difficulties encountered while writing the robot, as well as the results that we were able to achieve. </p><br><img src="https://habrastorage.org/webt/4k/z6/jc/4kz6jcapojmnba-3ztt2i-xonb0.png" alt="Trade"><br><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Why python?</b> <div class="spoiler_text">  While writing the robot, I actively studied Python 3 versions myself and one of its most popular frameworks - Django.  Therefore, there were no issues with the choice of development language. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Why django?</b> <div class="spoiler_text">  At first, we wrote a robot working in the terminal.  After it became necessary to visually observe the work of the robot, add several accounts for trading, configure the configuration - for all this, a certain Web-interface was needed. <br></div></div><br><br><h4>  Beginning of the story </h4><br><p>  At the beginning of our journey, we needed a resource where we could track our ‚Äúpossessions‚Äù - i.e.  balances of different currencies on different exchanges in one place, with charts and full amounts.  There was also the need to add wallets of major currencies, with tracking the history of transactions on them. </p><br><img src="https://habrastorage.org/webt/0z/mj/jq/0zmjjqqx1ajxefducrdlucdbnwo.jpeg" alt="Bot home page"><br><h4>  The algorithm of the robot </h4><br><p>  Initially, the robot polled the exchange once every few seconds, made some simple calculations using the <abbr title="A tool for technical analysis of financial markets, reflecting the current deviations of the stock, commodity or currency price.">Bollinger bands</abbr> ( <a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B8%25D0%25BD%25D0%25B8%25D0%25B8_%25D0%2591%25D0%25BE%25D0%25BB%25D0%25BB%25D0%25B8%25D0%25BD%25D0%25B4%25D0%25B6%25D0%25B5%25D1%2580%25D0%25B0">link</a> ) calculation and placed orders if it thought it was profitable. </p><br><p>  This algorithm worked for several months, after which the idea arose to fundamentally change the logic of work - the robot should not have questioned the exchange for changes in the exchange rate, it should have known about the price change at the very moment of its change.  At the time of writing the script, one of the cryptocurrency platforms that we used, poloniex, had such functionality.  This functionality is <a href="http://wamp-proto.org/">WAMP protocol</a> .  He allowed to subscribe to the necessary channel on the exchange, and receive timely messages about changes in rates. </p><br><blockquote>  Generally, by subscribing to Web Socket poloniex, we get not only information about exchange rates.  In addition, we receive information about the so-called "glasses" bids <br>  &amp; asks, about orders and even about messages in a local chat, but that‚Äôs another story. </blockquote><br><p>  After we received the most current information about the current situation on the stock exchange, it was necessary to figure out when to place an order, under what conditions to cancel it and how long a buy or sell order will live if it cannot be executed. </p><br><h4>  When to place an order? </h4><br><p>  The main goal of any robot with similar tasks is to determine the right moment for buying and selling.  In our script, we decided to use the mechanism of directions, when the algorithm tries to predict the next step, in which the rate of the necessary currency will go.  The following is an extract from the logs of the bot, where you can see the "directions" for a pair of BTC - ETH: </p><br><pre> 0, date: 2017-10-04 11: 14: 05.217362, last: 0.06349930 
 1, date: 2017-10-04 11: 14: 41.798799, last: 0.06349955 
 1, date: 2017-10-04 11: 19: 54.559547, last: 0.06360275 
 1, date: 2017-10-04 11: 20: 37.940202, last: 0.06370000 
 0, date: 2017-10-04 11:20: 52.351764, last: 0.06371080 
 1, date: 2017-10-04 11: 21: 23.222651, last: 0.06364501 
 1, date: 2017-10-04 11: 21: 42.255728, last: 0.06365983 
 1, date: 2017-10-04 11: 22: 02.589577, last: 0.06370500 
</pre><br><blockquote>  The algorithm itself of finding directions is not very difficult - if for a pair of currencies the highest bid and lower ask simultaneously increased relative to the previous values ‚Äã‚Äã- most likely the price will rise next time, otherwise it will be the other way around. </blockquote><br><p>  The first figure in this listing is the robot‚Äôs attempt to predict where the price will go next time, where 0 means the price will go down, 1 means the price will increase.  As a result, the bot has a lot of such directions for each of the more than 50 trading pairs. </p><br><h4>  Directions received.  What's next? </h4><br><p>  Now we need to decide what the mask will look like from <b>n</b> consecutive directions, when we can say with confidence that this point is the point after which the course will change and will start to grow in the opposite direction.  After long testing and changing the directional masks, we stopped at the variant where such a point is preceded by 5 (-1 for the assumption of correction on the exchange) of the same directions and 2 opposite ones.  For example: </p><br><pre> (1, 1, 1, 1, 1, 0, 0)
</pre><br><p>  Such a list of directions with a probability of 80% indicates that at that moment the exchange rate began to fall and should be sold. </p><br><h4>  At what price to exhibit? </h4><br><p>  Another important point was the issue of calculating the price at which the order should be placed.  This is where all the same data from WS comes in - the data on current orders on the exchange.  Knowing the whole "glass" of orders on the stock exchange, we descend in it until we reach the condition when the amount of currency that the bot wants to set is equal to the sum of the number of tokens placed in the orders. </p><br><h4>  Other settings </h4><br><p>  Settings such as the desired amount of currency and the pairs themselves, with which we want to work, we decided to bring the interface to the Web, so that during the work we could choose what to trade.  We set the lifetime of the order to 5 minutes - orders that are older than this time are simply canceled. </p><br><h4>  What is the result? </h4><br><p>  After implementing the algorithm described above, we got the following: </p><br><img src="https://habrastorage.org/webt/yt/e3/tf/yte3tff78xyiifrgrvamkgiq44e.jpeg" alt="Botwebinterface">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>  The screenshot above shows the final result Web interface.  The chart shows when the robot decided to place an order and at what price, when the order was canceled and for what reason.  In the right part of the interface, there are various settings, from disabling the main currencies of the site to setting the desired number of tokens as a percentage of the total amount of funds. </p><br><hr><br><p>  The end result of our work can be found in our repository on <a href="https://github.com/OnGridSystems/CATEd">GitHub</a> . </p></div><p>Source: <a href="https://habr.com/ru/post/353732/">https://habr.com/ru/post/353732/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353722/index.html">Guide to create your own shaders in the Unreal Engine</a></li>
<li><a href="../353724/index.html">Why it is not necessary to always obtain consent for the processing of personal data within the framework of the GDPR</a></li>
<li><a href="../353726/index.html">The device of special effects for games under NES. Part 1</a></li>
<li><a href="../353728/index.html">How to increase the number of friends in the company</a></li>
<li><a href="../353730/index.html">Mikrotik RoS, useful things</a></li>
<li><a href="../353734/index.html">Concepts of distributed architecture, which I met when building a large payment system</a></li>
<li><a href="../353736/index.html">Digest news from the world of PostgreSQL. Issue number 5</a></li>
<li><a href="../353738/index.html">Secure SOCKS5 proxy for Telegram for 1 Euro and 10 minutes</a></li>
<li><a href="../353740/index.html">Global lighting using voxel cone tracing</a></li>
<li><a href="../353744/index.html">Red Hat is heading for a hybrid cloud with Enterprise Linux 7.5: what does it mean</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>