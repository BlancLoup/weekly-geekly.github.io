<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PouchDB or what to do when the ‚Äúinternet is stable‚Äù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nowadays, the speed of the WEB-application greatly affects the loyalty of users. Often you have to transfer some business logic to client code running...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PouchDB or what to do when the ‚Äúinternet is stable‚Äù</h1><div class="post__text post__text-html js-mediator-article">  Nowadays, the speed of the WEB-application greatly affects the loyalty of users.  Often you have to transfer some business logic to client code running in the user's browser. <br><br>  In such a situation, it becomes necessary to quickly obtain data related to tasks.  But sometimes the time for their request from the server database is too large, and sometimes the connection to the network is completely unstable or absent.  In this situation, you can resort to storing data locally at the user and synchronize as needed. <br><br><h2>  Acquaintance </h2><br>  PouchDB is a database that works on the basis of existing solutions for storing information in the user's browser.  In fact, it acts as a facade and provides a universal API regardless of the conditions under which the application is launched. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/10b/49b/9c9/10b49b9c96e1cf88d6767b8df397dff5.png" alt="image"><br><br>  Browser versions in which PouchDB works: <br><br><ul><li>  Firefox 29+ (including Firefox OS and Firefox for Android) </li><li>  Chrome 30+ </li><li>  Safari 5+ </li><li>  Internet Explorer 10+ </li><li>  Opera 21+ </li><li>  Android 4.0+ </li><li>  iOS 7.1+ </li><li>  Windows Phone 8+ </li></ul><br>  Since this is a NoSQL database, the terminology is slightly different from the usual relational solutions.  You can see the difference in the correspondence table: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/31e/f51/a8c/31ef51a8cedae48c7b7a2a4694df2afa.png" alt="image"><br><br><a name="habracut"></a><h2>  Base API </h2><br>  To create a database, just run: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/42d63f588c179bab273a0ee195b7b26e.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006136" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-creation-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-creation-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-creation-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-c1">db</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">PouchDB</span>(<span class="pl-s"><span class="pl-pds">'</span>databaseName<span class="pl-pds">'</span></span>);</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-creation.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  and you can already work with it.  Creating, deleting and reading data from PouchDB is just as easy: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/a0da34448e2cdcf4e270003cee5a8d04.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006156" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-operations-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-operations-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-operations-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">db</span>.<span class="pl-en">put</span>(data)</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-operations-js-LC2" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">then</span>(<span class="pl-smi">response</span> <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handling result <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-operations-js-LC3" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">catch</span>(<span class="pl-smi">err</span> <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> errors handling <span class="pl-c">*/</span></span> });</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pouchdb-operations-js-LC4" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-pouchdb-operations-js-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">db</span>.<span class="pl-c1">remove</span>(data)</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-pouchdb-operations-js-LC6" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">then</span>(<span class="pl-smi">response</span> <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handling result <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-pouchdb-operations-js-LC7" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">catch</span>(<span class="pl-smi">err</span> <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> errors handling <span class="pl-c">*/</span></span> });</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-pouchdb-operations-js-LC8" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-pouchdb-operations-js-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">db</span>.<span class="pl-c1">get</span>(data)</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-pouchdb-operations-js-LC10" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">then</span>(<span class="pl-smi">doc</span> <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> do something with document <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-operations-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-pouchdb-operations-js-LC11" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">catch</span>(<span class="pl-smi">err</span> <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> errors handling <span class="pl-c">*/</span></span> });</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-operations.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br><h2>  Where to use? </h2><br>  One of the main areas of application of such functionality is continuous work from the user's point of view.  For example, the user started filling out a form with some data, until he finished, you can save them locally.  Thus, it is possible not only to enable the user to interrupt, but also to protect against the loss of the entered data in case of errors while sending them to the server. <br><br>  Local databases can also be used for caching.  For example, a user is viewing ads from his or her smartphone.  You can save the list locally and provide information much faster. <br><br>  Another direction is the work offline.  For example, a user can manage his notes without access to the Internet, while they are synchronized as soon as access appears.  Anyway, you can build full-fledged offline or desktop applications without limiting the functionality and without the additional costs of supporting or renting servers. <br><br><h2>  Replication and conflicts </h2><br>  The main feature of PouchDB is a flexible synchronization system.  This database can be synchronized with other local and remote systems.  Such functionality is available out of the box and does not require additional settings or writing a large amount of code. <br><br>  The only condition is that you can only synchronize with the CouchDB-like protocols.  This can be CouchDB, Cloudant, Couchbase Sync Gateway or PouchDB Server.  The latter, in turn, can be a layer between other services, like Redis, Riak, or MySQL, through the <a href="https://github.com/Level/levelup/wiki/Modules">LevelUP ecosystem</a> . <br><br><cut></cut>  Simple sync example: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/9d173f6449d2beb59868773658275494.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006170" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-simple-sync-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-simple-sync-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-simple-sync-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-c1">localDB</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">PouchDB</span>(<span class="pl-s"><span class="pl-pds">'</span>databaseName<span class="pl-pds">'</span></span>);</td>
      </tr>
      <tr>
        <td id="file-pouchdb-simple-sync-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-simple-sync-js-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-c1">remoteDbUrl</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://domain:5984/dbName<span class="pl-pds">'</span></span>;</td>
      </tr>
      <tr>
        <td id="file-pouchdb-simple-sync-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-simple-sync-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">localDB</span>.<span class="pl-en">sync</span>(remoteDbUrl, {live<span class="pl-k">:</span> <span class="pl-c1">true</span>, retry<span class="pl-k">:</span> <span class="pl-c1">true</span>});</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-simple-sync.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  During synchronization, a conflict may arise when the record has been changed on both sides since the last update.  PouchDB uses a record revision system to properly resolve such conflicts. <br><br>  Each entity has its own history of changes.  Each change, including ‚Äúcreation‚Äù, generates a unique identifier of the entity version: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/15bdac61b37baaa74d3adbae693b091c.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006182" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-entity-json" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-json ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-entity-json-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-entity-json-LC1" class="blob-code blob-code-inner js-file-line">{</td>
      </tr>
      <tr>
        <td id="file-pouchdb-entity-json-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-entity-json-LC2" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">"</span>_id<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>test-doc-1<span class="pl-pds">"</span></span>,</td>
      </tr>
      <tr>
        <td id="file-pouchdb-entity-json-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-entity-json-LC3" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">"</span>_rev<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>1-A6157A5EA545C99B00FF904EEF05FD9F<span class="pl-pds">"</span></span>,</td>
      </tr>
      <tr>
        <td id="file-pouchdb-entity-json-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pouchdb-entity-json-LC4" class="blob-code blob-code-inner js-file-line"> <span class="pl-s"><span class="pl-pds">"</span>content<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Some content<span class="pl-pds">"</span></span></td>
      </tr>
      <tr>
        <td id="file-pouchdb-entity-json-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-pouchdb-entity-json-LC5" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-entity.json</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  For any operations with entities, it is necessary to specify the revision number.  In the simplest cases, this helps to solve the so-called ‚Äúimmediate conflicts‚Äù using optimistic blocking. <br><br>  In real life there is a more serious problem - ‚Äúpossible conflicts‚Äù.  They may occur during the synchronization of databases, and then to understand which version of the record should remain ultimately becomes not so easy.  In PouchDB, to resolve such situations, an entity change history is recorded, and all versions are saved during synchronization. <br><br>  This allows you to resolve the conflict without blocking the synchronization process, both using the algorithm and manually. <br><br><cut></cut>  Synchronization options can be different: unidirectional replication to either of two sides, bi-directional replication. <br>  Customization occurs with a few lines of code: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/b2c76ef8c1c1a881fcdee835d6142f73.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006193" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-replication-to-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-replication-to-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-replication-to-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">localDB</span>.<span class="pl-smi">replicate</span>.<span class="pl-en">to</span>(remoteDB).<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>complete<span class="pl-pds">'</span></span>, () <span class="pl-k">=&gt;</span> {}).<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>error<span class="pl-pds">'</span></span>, (<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> {});</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-replication-to.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  or in the other direction: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/c684a8bfc2c942c05bbeb35e7fddbfb8.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006199" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-replication-from-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-replication-from-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-replication-from-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">localDB</span>.<span class="pl-smi">replicate</span>.<span class="pl-en">from</span>(remoteDB).<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>complete<span class="pl-pds">'</span></span>, () <span class="pl-k">=&gt;</span> {}).<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>error<span class="pl-pds">'</span></span>, (<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> {});</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-replication-from.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  or both at once: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/8d3154783bb1bc2df102396b1e9ed132.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006202" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-sync-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-sync-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-sync-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">localDB</span>.<span class="pl-en">sync</span>(remoteDB);</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-sync.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  As expected, you can handle the events generated during synchronization: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/bab9e81cdcc9b8e3a313d48bbc066993.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006207" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-sync-events-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-sync-events-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-sync-events-js-LC1" class="blob-code blob-code-inner js-file-line">localDB</td>
      </tr>
      <tr>
        <td id="file-pouchdb-sync-events-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-sync-events-js-LC2" class="blob-code blob-code-inner js-file-line"> .<span class="pl-en">sync</span>(remoteDB, { live<span class="pl-k">:</span> <span class="pl-c1">true</span>, retry<span class="pl-k">:</span> <span class="pl-c1">true</span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-sync-events-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-sync-events-js-LC3" class="blob-code blob-code-inner js-file-line"> .<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>change<span class="pl-pds">'</span></span>, (<span class="pl-smi">info</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span>       <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-sync-events-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pouchdb-sync-events-js-LC4" class="blob-code blob-code-inner js-file-line"> .<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>paused<span class="pl-pds">'</span></span>, (<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span>   <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-sync-events-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-pouchdb-sync-events-js-LC5" class="blob-code blob-code-inner js-file-line"> .<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>active<span class="pl-pds">'</span></span>, () <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span>   <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-sync-events-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-pouchdb-sync-events-js-LC6" class="blob-code blob-code-inner js-file-line"> .<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>denied<span class="pl-pds">'</span></span>, (<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span>      <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-sync-events-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-pouchdb-sync-events-js-LC7" class="blob-code blob-code-inner js-file-line"> .<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>complete<span class="pl-pds">'</span></span>, (<span class="pl-smi">info</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span>   <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-sync-events-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-pouchdb-sync-events-js-LC8" class="blob-code blob-code-inner js-file-line"> .<span class="pl-en">on</span>(<span class="pl-s"><span class="pl-pds">'</span>error<span class="pl-pds">'</span></span>, (<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span>      <span class="pl-c">*/</span></span> });</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-sync-events.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  You can use this functionality for different types of applications: <br><br><ul><li>  In-memory ‚áÑ Local (for data caching); </li><li>  Local ‚áÑ Local (between browsers or applications without a server side); </li><li>  Remote ‚áÑ Remote (replication); </li><li>  Local ‚áÑ Remote ‚áÑ Local (synchronization with backup on the server). </li></ul><br><br><cut></cut><h2>  Map / Reduce functions </h2><br>  To simplify and speed up content searching, PouchDB uses Map / Reduce functions.  A close analogy to them is building an index in a relational database. <br><br>  For example, to ‚Äúindex‚Äù the name field in a document, you can use the following construction: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/f4dd7ac7ad96391a22a6b48a45e65fb0.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006213" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-index-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-index-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-index-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-c1">ddoc</span> <span class="pl-k">=</span> {</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-index-js-LC2" class="blob-code blob-code-inner js-file-line">  _id<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>_design/my_index<span class="pl-pds">'</span></span>,</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-index-js-LC3" class="blob-code blob-code-inner js-file-line">  views<span class="pl-k">:</span> {</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pouchdb-index-js-LC4" class="blob-code blob-code-inner js-file-line">    by_name<span class="pl-k">:</span> {</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-pouchdb-index-js-LC5" class="blob-code blob-code-inner js-file-line">      <span class="pl-en">map</span><span class="pl-k">:</span> <span class="pl-k">function</span> (<span class="pl-smi">doc</span>) { </td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-pouchdb-index-js-LC6" class="blob-code blob-code-inner js-file-line">              <span class="pl-en">emit</span>(<span class="pl-smi">doc</span>.<span class="pl-c1">name</span>); </td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-pouchdb-index-js-LC7" class="blob-code blob-code-inner js-file-line">           }.<span class="pl-c1">toString</span>()</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-pouchdb-index-js-LC8" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-pouchdb-index-js-LC9" class="blob-code blob-code-inner js-file-line">  }</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-pouchdb-index-js-LC10" class="blob-code blob-code-inner js-file-line">};</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-pouchdb-index-js-LC11" class="blob-code blob-code-inner js-file-line">pouch</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-pouchdb-index-js-LC12" class="blob-code blob-code-inner js-file-line">  .<span class="pl-en">put</span>(ddoc)</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-pouchdb-index-js-LC13" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">then</span>(() <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> success <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-js-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-pouchdb-index-js-LC14" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">catch</span>((<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> errors handling <span class="pl-c">*/</span></span> });</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-index.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  Using the created function is as follows: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/26c1a5372e7c7b4e37f4727519a29089.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006221" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-index-using-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-index-using-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-index-using-js-LC1" class="blob-code blob-code-inner js-file-line">localDB</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-using-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-index-using-js-LC2" class="blob-code blob-code-inner js-file-line">  .<span class="pl-en">query</span>(<span class="pl-s"><span class="pl-pds">'</span>my_index/by_name<span class="pl-pds">'</span></span>, {key<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>foo<span class="pl-pds">'</span></span>})</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-using-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-index-using-js-LC3" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">then</span>((<span class="pl-smi">res</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handle result <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-index-using-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pouchdb-index-using-js-LC4" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">catch</span>((<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handle error <span class="pl-c">*/</span></span> });</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-index-using.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  You can use a large number of different parameters affecting the sample, for example, the maximum number of records, the display of complete information about the document or only its identifier and others: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/73bb0a8d63a557523f80ba5283295e82.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006232" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-map-example-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-map-example-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-map-example-js-LC1" class="blob-code blob-code-inner js-file-line">pouch</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-example-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-map-example-js-LC2" class="blob-code blob-code-inner js-file-line">  .<span class="pl-en">query</span>(mapFunction, {</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-example-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-map-example-js-LC3" class="blob-code blob-code-inner js-file-line">     startkey<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-pds">'</span></span>,</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-example-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pouchdb-map-example-js-LC4" class="blob-code blob-code-inner js-file-line">     endkey<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>C<span class="pl-cce">\uffff</span><span class="pl-pds">'</span></span>,</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-example-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-pouchdb-map-example-js-LC5" class="blob-code blob-code-inner js-file-line">     limit<span class="pl-k">:</span> <span class="pl-c1">5</span>,</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-example-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-pouchdb-map-example-js-LC6" class="blob-code blob-code-inner js-file-line">     include_docs<span class="pl-k">:</span> <span class="pl-c1">true</span></td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-example-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-pouchdb-map-example-js-LC7" class="blob-code blob-code-inner js-file-line">  })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-example-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-pouchdb-map-example-js-LC8" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">then</span>((<span class="pl-smi">result</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handle result <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-example-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-pouchdb-map-example-js-LC9" class="blob-code blob-code-inner js-file-line">  .<span class="pl-c1">catch</span>((<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handle errors <span class="pl-c">*/</span></span> });</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-map-example.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  First you need to create a map function, for example: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/d68c73ec7b17c396aea225deecba83e9.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006243" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-map-function-short-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-map-function-short-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-map-function-short-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">mapFunction</span>(<span class="pl-smi">doc</span>) {</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-function-short-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-map-function-short-js-LC2" class="blob-code blob-code-inner js-file-line">   <span class="pl-en">emit</span>(<span class="pl-smi">doc</span>.<span class="pl-c1">name</span>);</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-function-short-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-map-function-short-js-LC3" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-map-function-short.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br><cut></cut>  It will "index" the specified fields.  You can control the processing of each value.  In the example below, only documents with the type brick are processed, and only the color field.  In addition, the blue color will be processed and saved as the string ‚ÄúWow!  Blue brick! ‚Äù <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/03d7c3b695e7b7590d6ed3f2503c7179.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006266" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-map-reduce-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-map-reduce-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-map-reduce-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">pouch</span>.<span class="pl-en">query</span>(mapReduceFun, {</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-map-reduce-js-LC2" class="blob-code blob-code-inner js-file-line">   key<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>White<span class="pl-pds">'</span></span>, </td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-map-reduce-js-LC3" class="blob-code blob-code-inner js-file-line">   reduce<span class="pl-k">:</span> <span class="pl-c1">true</span>,</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pouchdb-map-reduce-js-LC4" class="blob-code blob-code-inner js-file-line">   group<span class="pl-k">:</span> <span class="pl-c1">true</span></td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-pouchdb-map-reduce-js-LC5" class="blob-code blob-code-inner js-file-line">})</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-pouchdb-map-reduce-js-LC6" class="blob-code blob-code-inner js-file-line">.<span class="pl-c1">then</span>((<span class="pl-smi">result</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handle result <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-pouchdb-map-reduce-js-LC7" class="blob-code blob-code-inner js-file-line">.<span class="pl-c1">catch</span>((<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handle errors <span class="pl-c">*/</span></span> });</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-map-reduce.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  Then, by created indexes, you can search or aggregate data by any parameter.  To do this, use reduce-functions, they combine all the data obtained after the work of the map-function and process them as needed.  Using the written map function you can implement: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/078e9f60d8530911548da45ba8556515.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006257" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-map-reduce-simple-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-map-reduce-simple-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-map-reduce-simple-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-c1">mapReduceFun</span> <span class="pl-k">=</span> {</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-simple-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-map-reduce-simple-js-LC2" class="blob-code blob-code-inner js-file-line">   map<span class="pl-k">:</span> mapFunction,</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-simple-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-map-reduce-simple-js-LC3" class="blob-code blob-code-inner js-file-line">   reduce<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>_count<span class="pl-pds">'</span></span></td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-simple-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pouchdb-map-reduce-simple-js-LC4" class="blob-code blob-code-inner js-file-line">};</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-map-reduce-simple.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br>  Thus, at first we will select records by the specified parameters and ultimately calculate the number of documents found: <br><br><div class="oembed"><script type="text/javascript" src="https://gist.github.com/03d7c3b695e7b7590d6ed3f2503c7179.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-b3b573358bfc66d89e1e95dbf8319c09.css"><div id="gist83006266" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pouchdb-map-reduce-js" class="file">
    

  <div itemprop="text" class="blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-pouchdb-map-reduce-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pouchdb-map-reduce-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-smi">pouch</span>.<span class="pl-en">query</span>(mapReduceFun, {</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pouchdb-map-reduce-js-LC2" class="blob-code blob-code-inner js-file-line">   key<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>White<span class="pl-pds">'</span></span>, </td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pouchdb-map-reduce-js-LC3" class="blob-code blob-code-inner js-file-line">   reduce<span class="pl-k">:</span> <span class="pl-c1">true</span>,</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pouchdb-map-reduce-js-LC4" class="blob-code blob-code-inner js-file-line">   group<span class="pl-k">:</span> <span class="pl-c1">true</span></td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-pouchdb-map-reduce-js-LC5" class="blob-code blob-code-inner js-file-line">})</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-pouchdb-map-reduce-js-LC6" class="blob-code blob-code-inner js-file-line">.<span class="pl-c1">then</span>((<span class="pl-smi">result</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handle result <span class="pl-c">*/</span></span> })</td>
      </tr>
      <tr>
        <td id="file-pouchdb-map-reduce-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-pouchdb-map-reduce-js-LC7" class="blob-code blob-code-inner js-file-line">.<span class="pl-c1">catch</span>((<span class="pl-smi">err</span>) <span class="pl-k">=&gt;</span> { <span class="pl-c"><span class="pl-c">/*</span> handle errors <span class="pl-c">*/</span></span> });</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pouchDB-map-reduce.js</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div><br><cut></cut><h2>  Conclusion </h2><br>  At this functionality PouchDB is not limited. <br><br>  There are many more features recommended for use by advanced users.  And if the possibilities out of the box are not enough, you can connect one or more plug-ins.  Their choice is large enough and constantly expanding. <br><br>  Faced with the problems of fast data access, organization of serverless architecture and unstable Internet connection, you can pay attention to PouchDB as one of the solutions. </div><p>Source: <a href="https://habr.com/ru/post/342318/">https://habr.com/ru/post/342318/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342308/index.html">Future of wikipedia</a></li>
<li><a href="../342310/index.html">Installing Proxmox VE on Debian Stretch using Ansible</a></li>
<li><a href="../342312/index.html">Configuring Jail on FreeBSD 11.1</a></li>
<li><a href="../342314/index.html">Playing with Nextgen-antivirus from Palo Alto Networks: it injects its dll into executable processes like * .exe</a></li>
<li><a href="../342316/index.html">Actors for fun and profit</a></li>
<li><a href="../342324/index.html">Errors in smart contracts or Parity's new Security Alert</a></li>
<li><a href="../342326/index.html">PVS-Studio report is now in Html format</a></li>
<li><a href="../342330/index.html">Insight on metrics: how do I understand what metrics are and what is their main charm</a></li>
<li><a href="../342332/index.html">Storage of personal data on a foreign hosting: if it is possible, how?</a></li>
<li><a href="../342334/index.html">Introduction to Neural Networks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>