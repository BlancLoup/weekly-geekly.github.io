<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Let the Internet bend under us</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you have long wanted to make the Internet a little better ( for yourself ), but everything was once lazy , then today is your happy day. For 21 ste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Let the Internet bend under us</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/web/101/9e0/90d/1019e090d34c4b5ea1e95d2b2f6e8fe6.jpg"></div><br><br>  If you have long wanted to make the Internet a little better ( <i>for yourself</i> ), but everything was once <s>lazy</s> , then today is your happy day.  For 21 steps, I will show you how to achieve this cherished goal. <br><br>  Free bonus!  In addition to the internet, Google search is also doing better.  Maybe Google will appreciate the idea and offer a hand and a heart (if anything, I agree, I will even give up my studies for the sake of it). <br>  &lt;/ joke&gt; 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this article, I will talk about how to make a plugin for the Chrome browser, FireFox and MS Edge using the example of my own experience in running a rake. <br><br>  The plugin will allow you to easily implement your own JavaScript / CSS on any pages viewed in the browser.  Those.  A sort of browser extensions API version of lite. <br><a name="habracut"></a><br>  In early spring, we were given a task for a term paper on the subject of ‚ÄúInternet technology‚Äù. <br>  As it seemed to me, I chose the easiest of the suggested topics: ‚ÄúUser interface and navigation in modern browsers‚Äù.  What I later regretted about later, but alas, it was already too late. <br><br>  TL; DR <br><br>  If someone does not want to read about all 21 steps, then you can do with five. <br><br>  The plugin code can be downloaded from <a href="https://github.com/ntpetrova/CustomActions">GitHub</a> . <br><br>  And after that: <br><br><ol><li>  Open chrome: // extensions in Chrome browser </li><li>  Put a tick in front of "Developer mode" </li><li>  Click on ‚ÄúLoad unpacked extensions‚Äù and select the directory where you saved the source code. </li><li>  After that, for the ‚ÄúCustomActions‚Äù plugin, select ‚Äúoptions‚Äù </li><li>  On the form of options, click "Demo config" and "Save" </li></ol><br><img src="https://habrastorage.org/web/607/8c6/a12/6078c6a1229f4a238ba846c10774e3c1.png"><br><br>  That's all, you can use, for example open google.com or Habr, correct the configuration or play around with the scripts. <br><br>  <i>Next comes the expanded version, with lyrical digressions.</i> <br><br>  If you believe the research of British scientists, then the spherical Internet user, fleeing from the amount of information they want to dump on him, creates for himself a cozy Internet world from 5-10 sites that he visits more or less constantly, and he goes back to the ‚Äúbig‚Äù Internet by chance. <br><br>  It would not be sad to admit, but looking in the mirror, I saw there this very spherical (granny, if you read this article, please do only diet cakes, but my geometry suffers) of the user. <br><br>  But it was even sadder to realize that my 9 and a half sites are not perfect.  Therefore, in the framework of the course work, it was decided to make them (well, along with the rest of the Internet) better. <br><br>  In most cases, this required writing only 3-4 lines in JavaScript and / or 2-3 in CSS. <br><br>  After the initial research and consultations, it became clear that browser vendors provide such an opportunity through functionality extensions. <br><br>  We define our Wishlist: <br><br><ol><li>  When opening a site, a custom  script associated with this site is introduced. </li><li>  Custom script configured on preference page </li><li>  Add a button to the browser toolbar to quickly recall the configuration </li></ol><br>  Terms of reference defined, starting to code. <br><br>  <b>Step 1.</b> <br><br>  I read <a href="https://developer.chrome.com/extensions/getstarted">getstarted</a> to enlightenment, or blue, depending on which side to look. <br><br>  <b>Step 2.</b> <br><br>  I define the project structure <br><br> <code>options.html <br> options.js <br> <br> popup.html <br> popup.js <br> <br> background.js <br> <br> manifest.json <br> <br> icon.png <br> images <br> images\icon128.png <br> images\icon16.png <br> images\icon48.png <br></code> <br>  <b>Step 3.</b> <br><br>  I create the manifesto. <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"CustomActions"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"plugin for CustomActions"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"background"</span></span> : { <span class="hljs-attr"><span class="hljs-attr">"scripts"</span></span>: [<span class="hljs-string"><span class="hljs-string">"background.js"</span></span>] }, <span class="hljs-attr"><span class="hljs-attr">"icons"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"128"</span></span>: <span class="hljs-string"><span class="hljs-string">"images/icon128.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"16"</span></span>: <span class="hljs-string"><span class="hljs-string">"images/icon16.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"48"</span></span>: <span class="hljs-string"><span class="hljs-string">"images/icon48.png"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"content_security_policy"</span></span>: <span class="hljs-string"><span class="hljs-string">"script-src 'self' 'unsafe-eval'; object-src 'self'"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"permissions"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"webRequest"</span></span>, <span class="hljs-string"><span class="hljs-string">"tabs"</span></span>, <span class="hljs-string"><span class="hljs-string">"activeTab"</span></span>, <span class="hljs-string"><span class="hljs-string">"http://*/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"https://*/*"</span></span>, <span class="hljs-string"><span class="hljs-string">"storage"</span></span>, <span class="hljs-string"><span class="hljs-string">"unlimitedStorage"</span></span>, <span class="hljs-string"><span class="hljs-string">"contextMenus"</span></span>, <span class="hljs-string"><span class="hljs-string">"&lt;all_urls&gt;"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"browser_action"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"default_title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Custom Actions Injection plugin"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default_icon"</span></span>: <span class="hljs-string"><span class="hljs-string">"icon.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"default_popup"</span></span>: <span class="hljs-string"><span class="hljs-string">"popup.html"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"commands"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"cmd-exec-1"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"suggested_key"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ctrl+Q"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Custom Action #1"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"cmd-exec-2"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"suggested_key"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ctrl+B"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Custom Action #2"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"cmd-exec-3"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"suggested_key"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ctrl+Y"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Custom Action #3"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"options_page"</span></span>: <span class="hljs-string"><span class="hljs-string">"options.html"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"manifest_version"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }</code> </pre><br>  <b>Step 4.</b> <br><br>  I am working on the options.html form. <br><br>  No wonder visited the previous session.  Knowledge of knockout.js from the course ‚ÄúDesign of Web pages 2.0‚Äù was useful <br><br>  I add the knockout-3.4.1.js and knockout.mapping-latest.js files to the project structure. <br><br>  Nothing works.  I dig.  Does not help.  Roy.  Naryl that chrome extensions does not like knockout. <br>  Forcing love, update manifest. <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"content_security_policy"</span></span>: <span class="hljs-string"><span class="hljs-string">"script-src 'self' 'unsafe-eval'; object-src 'self'"</span></span></code> </pre><br>  <b>Step 5.</b> <br><br>  After pain and suffering in an attempt to realize the user interface comes insight. <br><br>  We pull everything from chrome: // settings <br><br>  We got on the shoulders of a giant and it went: <br><br><img src="https://habrastorage.org/web/703/b56/aec/703b56aecc234cf5bbc34f5832a5e801.png"><br><br>  <b>Step 6.</b> <br><br>  Need to save data.  <a href="https://developer.chrome.com/extensions/storage">Read</a> about <a href="https://developer.chrome.com/extensions/storage">chrome.storage</a> <br>  The dilemma of choosing between chrome.storage.sync and chrome.storage.local <br><br>  chrome.storage.sync is more attractive, but hard limits. <br><br>  Another insight - I have the same test project, so local is our everything. <br>  I rule the manifest so that there are no problems with limits. <br><br>  And I use chrome.storage.local.set to save the configuration. <br><br><pre> <code class="javascript hljs"> chrome.storage.local.set(items, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ self.status(<span class="hljs-string"><span class="hljs-string">'Items saved.'</span></span>); setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ self.status(<span class="hljs-string"><span class="hljs-string">''</span></span>); }, <span class="hljs-number"><span class="hljs-number">750</span></span>); });</code> </pre><br>  <b>Step 7.</b> <br><br>  I understand that the saved configuration should be reloaded in background.js, but how ??? <br><br>  Yeah, sweet couple chrome.runtime.sendMessage: <br><pre> <code class="javascript hljs"> chrome.storage.local.set(items, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ self.status(<span class="hljs-string"><span class="hljs-string">'Items saved.'</span></span>); setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ self.status(<span class="hljs-string"><span class="hljs-string">''</span></span>); }, <span class="hljs-number"><span class="hljs-number">750</span></span>); chrome.runtime.sendMessage({ <span class="hljs-attr"><span class="hljs-attr">command</span></span>: <span class="hljs-string"><span class="hljs-string">'refreshConfig'</span></span> }); });</code> </pre><br>  and chrome.runtime.onMessage: <br><pre> <code class="javascript hljs"> chrome.runtime.onMessage.addListener( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request, sender, sendResponse</span></span></span><span class="hljs-function">) </span></span>{ onCommand(request.command); });</code> </pre><br>  <b>Step 8.</b> <br><br>  I open popup.js.  I'm closing.  I open it again.  And so 7 times.  Nothing is clear. <br><br>  Is this me alone or where?  A long-awaited morning is coming and here I stumbled over the <a href="https://developer.chrome.com/extensions/samples">samples</a> - thank you, invisible Google workers. <br><br>  Raking rubble precious knowledge.  In the end, I find the right example and use the magic ACV combination (Ctrl-A / Ctrl-C / Ctrl-V).  13 hours later - it's done. <br><br>  <b>Step 9.</b> <br><br>  It's time to get down to the main part, intercept and deploy. <br><br>  Interceptor - chrome.tabs.onUpdated: <br><pre> <code class="javascript hljs">chrome.tabs.onUpdated.addListener(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">tabId, changeInfo, tab</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (changeInfo &amp;&amp; changeInfo.url) url = changeInfo.url.toLowerCase(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tab &amp;&amp; tab.url) url = tab.url.toLowerCase(); <span class="hljs-comment"><span class="hljs-comment">// . . . });</span></span></code> </pre><br>  and implementer - chrome.tabs.executeScript: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.sourceType == <span class="hljs-string"><span class="hljs-string">'InjectCSS'</span></span>) chrome.tabs.insertCSS(item.output == <span class="hljs-string"><span class="hljs-string">'Owner tab'</span></span> ? tabId : <span class="hljs-literal"><span class="hljs-literal">null</span></span>, { <span class="hljs-attr"><span class="hljs-attr">code</span></span>: item.data }); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> chrome.tabs.executeScript(item.output == <span class="hljs-string"><span class="hljs-string">'Owner tab'</span></span> ? tabId : <span class="hljs-literal"><span class="hljs-literal">null</span></span>, { <span class="hljs-attr"><span class="hljs-attr">code</span></span>: item.source });</code> </pre><br>  Everything went easier than it could, but still longer than desired. <br><br>  Discovered a new, amazing world called <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions">regular expressions</a> .  It turns out difficult can be done easily. <br><br>  <b>Step 10.</b> <br><br>  All is ready.  You can go for honestly earned five ... <br><br>  ‚Ä¶ not so fast.  Instead, the five brought a bunch of comments and improvements. <br><br>  <b>Step 11.</b> <br><br>  Let's start with the easiest, in popup.js I add support for the function "add current site" <br><br>  No so easy as it seems, you need to transfer data from popup.js to options.js. <br><br>  I spent 3 hours trying to catch the messages, save them to the extension storage and read them back, but in the end I decided that the smart one wouldn't go uphill, he would bypass it. <br><br>  Query string is our answer to this grief. <br><br>  <b>Step 12.</b> <br><br>  The next function is more difficult, add context menu support. <br>  Examples save again.  Everything is simpler than it could be - chrome.contextMenus.create: <br><pre> <code class="javascript hljs">chrome.contextMenus.create({ <span class="hljs-attr"><span class="hljs-attr">id</span></span>: item.id, <span class="hljs-attr"><span class="hljs-attr">contexts</span></span>: [<span class="hljs-string"><span class="hljs-string">"page"</span></span>, <span class="hljs-string"><span class="hljs-string">"frame"</span></span>, <span class="hljs-string"><span class="hljs-string">"selection"</span></span>], <span class="hljs-attr"><span class="hljs-attr">title</span></span>: item.name, <span class="hljs-attr"><span class="hljs-attr">onclick</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">info, tab</span></span></span><span class="hljs-function">) </span></span>{ onCommand(info.menuItemId); } });</code> </pre><br>  <b>Step 13.</b> <br><br>  I do not believe in omens, but it was not a happy step. <br><br>  It is necessary to make support for the call through hot keys <br><br>  I do everything as in the examples, I correct the manifest: <br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"commands"</span></span>: { <span class="hljs-string"><span class="hljs-string">"cmd-exec-1"</span></span>: { <span class="hljs-string"><span class="hljs-string">"suggested_key"</span></span>: { <span class="hljs-string"><span class="hljs-string">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"Ctrl+Q"</span></span> }, <span class="hljs-string"><span class="hljs-string">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Custom Action #1"</span></span> } }</code> </pre><br>  and use chrome.commands.onCommand: <br><pre> <code class="javascript hljs">chrome.commands.onCommand.addListener(onCommand);</code> </pre><br>  Does not work.  After two days and nights and medical intervention, scrolling down the settings page I find an inconspicuous link to the desired settings. <br><br><img src="https://habrastorage.org/web/0a6/255/a85/0a6255a8537449438361dbe36f1faba1.png"><br>  That's where the dog has buried.  Itself to blame, too many examples instructed, here's a reference and ran off to the next screen. <br><br>  <b>Step 14.</b> <br><br>  Our head has a teacher of English.  Requires translate interface.  Have to learn English. <br><br>  Technology comes to the rescue.  Google translate vs English teacher - 1-0 in favor of life-giving Google! <br><br>  <b>Step 15.</b> <br><br>  Again we go for the top five, but in our heart we already agree to a four. <br><br>  I come back with a new word refactoring (before that I knew only the word FAKtoring. I spoke it especially often at the beginning of the project). <br><br>  And an additional requirement to make the program friendly to the user, to create a demonstration configuration and examples. <br><br>  It seems that the head of the department, in addition to his English wife, has a mistress from the UX / UI department. <br>  But remembering the good people from the Google examples, almost did not resist. <br><br>  <b>Step 16.</b> <br><br>  Refactoring is complete.  It's amazing how many bugs are hidden under the cover of the original version of the code, we should better remember this word. <br><br>  <b>Step 17.</b> <br><br>  Add an example for lorem ipsum.  Who advised this?  Latin teacher? <br><br>  Requirement: when you press a key combination, fill in the fields on the form with lorem sentences. <br><br>  I did, it seems to work. <br><br><pre> <code class="hljs perl"> var loremDemoData = { names: [ { firstName: <span class="hljs-string"><span class="hljs-string">"Victoria"</span></span>, lastName: <span class="hljs-string"><span class="hljs-string">"Veit"</span></span>, email: <span class="hljs-string"><span class="hljs-string">"Victoria.Veit@noreply.ru"</span></span> }, { firstName: <span class="hljs-string"><span class="hljs-string">"Gisele"</span></span>, lastName: <span class="hljs-string"><span class="hljs-string">"Gillard"</span></span>, email: <span class="hljs-string"><span class="hljs-string">"Gisele.Gillard@noreply.ru"</span></span> }, { firstName: <span class="hljs-string"><span class="hljs-string">"Edmund"</span></span>, lastName: <span class="hljs-string"><span class="hljs-string">"Edelson"</span></span>, email: <span class="hljs-string"><span class="hljs-string">"Edmund.Edelson@noreply.ru"</span></span> }, { firstName: <span class="hljs-string"><span class="hljs-string">"Joey"</span></span>, lastName: <span class="hljs-string"><span class="hljs-string">"Janelle"</span></span>, email: <span class="hljs-string"><span class="hljs-string">"Joey.Janelle@noreply.ru"</span></span> } ], lorem: [ <span class="hljs-string"><span class="hljs-string">"Orem ipsum dolor sit amet, consectetur adipiscing elit. Etiam sit amet purus condimentum, porta nulla sed, consequat felis. Phasellus quis condimentum odio. Maecenas scelerisque vehicula leo, sit amet tristique tellus molestie sed. Aenean lacus lorem, feugiat semper imperdiet a, vehicula ac orci. Pellentesque ac nisi commodo, pellentesque lorem quis, fringilla tellus. Fusce bibendum erat sit amet libero maximus rutrum. Integer dictum nibh sodales efficitur congue. Mauris nulla libero, hendrerit eget dictum nec, aliquam eu mi. Donec ipsum nisi, bibendum et consequat eu, imperdiet eget nisl. Duis tincidunt nibh et nibh tempor, quis mattis mi vulputate."</span></span>, <span class="hljs-string"><span class="hljs-string">"Suspendisse quis eleifend lectus. Sed nec vehicula elit. Praesent ac sollicitudin diam. Nam at venenatis lectus. Fusce condimentum tortor nec augue vestibulum tempus. Nullam faucibus vehicula lorem, et mollis justo dapibus a. Proin sagittis velit in lectus vehicula, id eleifend urna hendrerit. Integer rhoncus dui sed enim sollicitudin, a finibus magna fermentum."</span></span>, <span class="hljs-string"><span class="hljs-string">"Fusce at urna vitae magna semper scelerisque id volutpat tellus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Sed ut elit nisl. Duis sit amet ante accumsan nibh ultricies pharetra at vitae purus. Donec a felis eget ipsum euismod tempus. Donec elementum vel tortor vel efficitur. Nunc tristique, magna hendrerit sagittis placerat, odio sem commodo ligula, eu aliquam arcu elit sit amet diam. Etiam ultrices vehicula auctor."</span></span> ], loremShort: [ <span class="hljs-string"><span class="hljs-string">"Morbi nec sollicitudin augue."</span></span>, <span class="hljs-string"><span class="hljs-string">"Suspendisse sagittis fringilla aliquam."</span></span>, <span class="hljs-string"><span class="hljs-string">"Curabitur malesuada dolor."</span></span>, <span class="hljs-string"><span class="hljs-string">"Praesent quis lacus neque. Duis vitae vehicula felis"</span></span> ] };</code> </pre><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRandomInt</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">min, max</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() * (max - min)) + min; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name = data.names[getRandomInt(<span class="hljs-number"><span class="hljs-number">0</span></span>, data.names.length)]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hadEmail = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'input[type=text], textarea'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, l = t.length; i &lt; l; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = t[i]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ro = e.getAttribute(<span class="hljs-string"><span class="hljs-string">'readonly'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.disabled || ro === <span class="hljs-string"><span class="hljs-string">''</span></span> || ro === <span class="hljs-string"><span class="hljs-string">'true'</span></span> || ro == <span class="hljs-string"><span class="hljs-string">'1'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loremTxt = data.lorem[getRandomInt(<span class="hljs-number"><span class="hljs-number">0</span></span>, data.lorem.length)]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loremShort = data.loremShort[getRandomInt(<span class="hljs-number"><span class="hljs-number">0</span></span>, data.loremShort.length)]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> na = (<span class="hljs-string"><span class="hljs-string">''</span></span> + e.name).toLowerCase(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ia = (<span class="hljs-string"><span class="hljs-string">''</span></span> + e.id).toLowerCase(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (na == <span class="hljs-string"><span class="hljs-string">'firstname'</span></span> || ia == <span class="hljs-string"><span class="hljs-string">'firstname'</span></span> || na == <span class="hljs-string"><span class="hljs-string">'fname'</span></span> || ia == <span class="hljs-string"><span class="hljs-string">'fname'</span></span>) e.value = name.firstName; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (na == <span class="hljs-string"><span class="hljs-string">'lastname'</span></span> || ia == <span class="hljs-string"><span class="hljs-string">'lastname'</span></span> || na == <span class="hljs-string"><span class="hljs-string">'lname'</span></span> || ia == <span class="hljs-string"><span class="hljs-string">'lname'</span></span>) e.value = name.lastName; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!hadEmail &amp;&amp; (na.indexOf(<span class="hljs-string"><span class="hljs-string">'email'</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> || ia.indexOf(<span class="hljs-string"><span class="hljs-string">'email'</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>)) { e.value = name.email; hadEmail = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { e.value = (e.tagName == <span class="hljs-string"><span class="hljs-string">'TEXTAREA'</span></span> ? loremTxt : loremShort); } }</code> </pre><br>  <b>Step 18.</b> <br><br>  The following example for the site habrahabr.ru <br><br>  Requirement: when opening the site, hide articles for hubs and companies listed in the configuration.  For articles written on behalf of the company, make them seemingly different from articles written by independent authors. <br><br>  In the process, I learned about the existence of Habr and Hiktaims.  I would have known about them before, everything would have been at least twice as fast.  Spent three days reading without stopping.  I have been overwhelmed by articles only in the last year, there are still many interesting things ahead! <br><br>  At the next reception, my psychotherapist advised to write an article about his torment.  He says that this is an important step in the process of treating psychological trauma caused by the work on this coursework. <br><br>  On the proposal to replace the creation of the article by taking the correct pills, he refused.  In the end, agreed to the tablet, but with the condition of writing the article.  I sit.  Writing. <br><br>  It turned out that the article is easier to write than the code.  Maybe the Chukchi is not a reader, but a writer? <br><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"showCompanies"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"yandex"</span></span>, <span class="hljs-string"><span class="hljs-string">"mosigra"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"hideCompanies"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"hashflare"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"hideHubs"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"lib"</span></span> ] }</code> </pre><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hideParent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">el</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (el.classList &amp;&amp; el.classList.contains(<span class="hljs-string"><span class="hljs-string">'post_teaser'</span></span>)) el.style.display = <span class="hljs-string"><span class="hljs-string">'none'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (el.parentElement) hideParent(el.parentElement); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sanitizeParent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">el</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (el.classList &amp;&amp; el.classList.contains(<span class="hljs-string"><span class="hljs-string">'post_teaser'</span></span>)) { el.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'img'</span></span>).forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">img</span></span></span><span class="hljs-function">) </span></span>{ img.style.display = <span class="hljs-string"><span class="hljs-string">'none'</span></span>; }); el.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'.post__body_crop'</span></span>).forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">chld</span></span></span><span class="hljs-function">) </span></span>{ chld.style.maxHeight = <span class="hljs-string"><span class="hljs-string">'4em'</span></span>; chld.style.overflow = <span class="hljs-string"><span class="hljs-string">'hidden'</span></span>; el.addEventListener(<span class="hljs-string"><span class="hljs-string">'mouseover'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ chld.style.maxHeight = <span class="hljs-string"><span class="hljs-string">"inherit"</span></span>; chl d.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'img'</span></span>).forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">img</span></span></span><span class="hljs-function">) </span></span>{ img.style.display = <span class="hljs-string"><span class="hljs-string">'block'</span></span>; }); }, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); el.addEventListener(<span class="hljs-string"><span class="hljs-string">'mouseout'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ chld.style.maxHeight = <span class="hljs-string"><span class="hljs-string">"4em"</span></span>; chld.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'img'</span></span>).forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">img</span></span></span><span class="hljs-function">) </span></span>{ img.style.display = <span class="hljs-string"><span class="hljs-string">'none'</span></span>; }); }, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); }); el.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'.post__title a'</span></span>).forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">titl</span></span></span><span class="hljs-function">) </span></span>{ titl.style.color = <span class="hljs-string"><span class="hljs-string">'#707040'</span></span>; }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (el.parentElement) sanitizeParent(el.parentElement); } <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'a[href*="https://geektimes.ru/hub/"]'</span></span>).forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">el</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hub = el.getAttribute(<span class="hljs-string"><span class="hljs-string">'href'</span></span>).replace(<span class="hljs-regexp"><span class="hljs-regexp">/^.*\.ru\/hub\//</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-regexp"><span class="hljs-regexp">/\/.*$/</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data &amp;&amp; data.hideHubs &amp;&amp; data.hideHubs.indexOf(hub) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) hideParent(el); }); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'a[href*="https://geektimes.ru/company/"], a[href*="https://habrahabr.ru/company/"]'</span></span>).forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">el</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> company = el.getAttribute(<span class="hljs-string"><span class="hljs-string">'href'</span></span>).replace(<span class="hljs-regexp"><span class="hljs-regexp">/^.*\.ru\/company\//</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-regexp"><span class="hljs-regexp">/\/.*$/</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.hideCompanies &amp;&amp; data.hideCompanies.indexOf(company) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { hideParent(el); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.showCompanies &amp;&amp; data.showCompanies.indexOf(company) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } sanitizeParent(el); });</code> </pre><br>  <b>Step 19.</b> <br><br>  Wandering around the Internet, I saw an interesting idea and decided to implement it as an example for google search. <br><br>  Maybe he will appreciate the initiative and stop quibbling over trifles. <br><br>  Functionality: when opening Google, we show a hint with a list of the most frequently used words and sites for quick search. <br><br>  After the example for Harb, this is a couple of trivia. <br><br><pre> <code class="hljs swift"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> googleDemoData = [ { <span class="hljs-string"><span class="hljs-string">"keywords"</span></span>: <span class="hljs-string"><span class="hljs-string">"python"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"python"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"keywords"</span></span>: <span class="hljs-string"><span class="hljs-string">"javascript"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"javascript"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"keywords"</span></span>: <span class="hljs-string"><span class="hljs-string">"php"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"php"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"keywords"</span></span>: <span class="hljs-string"><span class="hljs-string">"mysql"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"mysql"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"keywords"</span></span>: <span class="hljs-string"><span class="hljs-string">"site:stackoverflow.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"at stackoverflow.com"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"keywords"</span></span>: <span class="hljs-string"><span class="hljs-string">"site:developer.mozilla.org"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"at developer.mozilla.org"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"keywords"</span></span>: <span class="hljs-string"><span class="hljs-string">"site:developer.chrome.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"at developer.chrome.com"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"keywords"</span></span>: <span class="hljs-string"><span class="hljs-string">"site:habrahabr.ru"</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"at habrahabr.ru"</span></span> } ];</code> </pre><br><pre> <code class="javascript hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ggSetTimeRange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> elemId = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getAttribute(<span class="hljs-string"><span class="hljs-string">'data-range'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> timeLimit = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'#'</span></span> + elemId + <span class="hljs-string"><span class="hljs-string">' a'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (timeLimit) timeLimit.click(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ggReplaceAndSearch</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> kw = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getAttribute(<span class="hljs-string"><span class="hljs-string">'data-search'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.location.href.indexOf(<span class="hljs-string"><span class="hljs-string">'chrome-search://'</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.location.href.indexOf(<span class="hljs-string"><span class="hljs-string">'https://www.google.com/_/chrome/newtab?'</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.location.href = <span class="hljs-string"><span class="hljs-string">"https://www.google.com/search?q="</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(kw); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> inputText = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'input[name="q"]'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inputText) { setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keyword = <span class="hljs-string"><span class="hljs-string">''</span></span> + inputText.value; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (kw.indexOf(<span class="hljs-string"><span class="hljs-string">'site:'</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; keyword.indexOf(<span class="hljs-string"><span class="hljs-string">'site:'</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { keyword = keyword.replace(<span class="hljs-regexp"><span class="hljs-regexp">/ *site:[^ ]+/</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (keyword.indexOf(kw) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; kw = <span class="hljs-string"><span class="hljs-string">' '</span></span> + kw; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (kw.indexOf(<span class="hljs-string"><span class="hljs-string">'site:'</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { inputText.value = keyword + <span class="hljs-string"><span class="hljs-string">' '</span></span> + kw; setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> btn = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'form[action="/search"]'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (btn) { btn.submit(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { btn = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'button[name="btnK"]'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (btn) { btn.click(); } } }, <span class="hljs-number"><span class="hljs-number">100</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { inputText.value = kw + <span class="hljs-string"><span class="hljs-string">' '</span></span> + keyword; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> strLength = (<span class="hljs-string"><span class="hljs-string">''</span></span> + inputText.value).length; inputText.setSelectionRange(strLength, strLength); } }, <span class="hljs-number"><span class="hljs-number">200</span></span>); setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ inputText.focus(); }, <span class="hljs-number"><span class="hljs-number">100</span></span>); }; }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ggHelper = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'ggHelper'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!ggHelper) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> helperHtml = <span class="hljs-string"><span class="hljs-string">'&lt;div id="ggHelper" style="position: fixed; '</span></span> + <span class="hljs-string"><span class="hljs-string">'box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12), 0 3px 1px -2px rgba(0, 0, 0, 0.2); '</span></span> + <span class="hljs-string"><span class="hljs-string">'background-color: #f0f0f0; border-radius: 2px; flex: 1; '</span></span> + <span class="hljs-string"><span class="hljs-string">'padding: 0.7em 1em 0.3em 1em; right: 1em; top: 12em; width: 13em; height: '</span></span> + (data.length + <span class="hljs-number"><span class="hljs-number">4</span></span>) + <span class="hljs-string"><span class="hljs-string">'em; '</span></span> + <span class="hljs-string"><span class="hljs-string">'font-size: 13px;"&gt;'</span></span> + <span class="hljs-string"><span class="hljs-string">'&lt;ul style="list-style-type: none; margin: 0; padding: 0;"&gt;'</span></span>; data.forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dataItem </span></span></span><span class="hljs-function">) </span></span>{ helperHtml += <span class="hljs-string"><span class="hljs-string">'&lt;li style="text-align: left; cursor: pointer;"&gt;&lt;a href="javascript: return false;" data-search="'</span></span> + dataItem.keywords + <span class="hljs-string"><span class="hljs-string">'" class="gg-keyword"&gt;'</span></span> + dataItem.title + <span class="hljs-string"><span class="hljs-string">'&lt;/a&gt;&lt;/li&gt;'</span></span>; }); helperHtml += <span class="hljs-string"><span class="hljs-string">'&lt;li style="margin: 0.5em;"&gt;&lt;hr size="1" style="height: 1px; border-color: #e0e0e0;"&gt;&lt;/li&gt;'</span></span>; helperHtml += <span class="hljs-string"><span class="hljs-string">'&lt;li style="cursor: pointer;"&gt;'</span></span> + <span class="hljs-string"><span class="hljs-string">'&lt;a href="javascript: return false;" data-range="qdr_w" class="gg-range"&gt;week&lt;/a&gt; :: '</span></span> + <span class="hljs-string"><span class="hljs-string">'&lt;a href="javascript: return false;" data-range="qdr_m" class="gg-range"&gt;month&lt;/a&gt; :: '</span></span> + <span class="hljs-string"><span class="hljs-string">'&lt;a href="javascript: return false;" data-range="qdr_y" class="gg-range"&gt;year&lt;/a&gt; :: '</span></span> + <span class="hljs-string"><span class="hljs-string">'&lt;a href="javascript: return false;" data-range="qdr_" class="gg-range"&gt;any&lt;/a&gt;&lt;/li&gt;'</span></span>; helperHtml += <span class="hljs-string"><span class="hljs-string">'&lt;/ul&gt;&lt;/div&gt;'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bodyTag = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bodyTag) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'div'</span></span>); e.innerHTML = helperHtml; bodyTag.appendChild(e.firstChild); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'#ggHelper .gg-keyword'</span></span>).forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">el</span></span></span><span class="hljs-function">) </span></span>{ el.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, ggReplaceAndSearch); }); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'#ggHelper .gg-range'</span></span>).forEach(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">el</span></span></span><span class="hljs-function">) </span></span>{ el.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, ggSetTimeRange); }); } }</code> </pre><br>  <b>Step 20.</b> <br><br>  According to the precepts of Habr, I sent the code for review to a group of experts.  Verdict - rewrite everything.  Crying, already sobbed. <br><br>  After the correspondence, I found at least 6 more bugs.  Review is power!  It is necessary to remember this word. <br>  It was nice to look at the code, I even began to understand what was written there and why. <br><br>  <b>Step 21</b> <br><br>  All is ready. <br><br>  I follow the five, counting on the four, but I agree on the three.  No more strength. <br>  Three weeks of life thrown into the fight against modern technology. <br><br>  Wish good luck! <br><br>  <b>Ps:.</b>  In the end, I would like to express heartfelt thanks to the creators and users of the site stackoverflow.com <br><br>  I can not imagine how the work looked like before its creation.  And before the advent of the web (the glory of TNB, I was born after its creation), the profession of a programmer was probably one of the most depressed and with the highest suicide rate per unit area. <br><br>  Even now, sometimes you still want to tear out all the vegetation on your head, and sometimes even worse. <br><br>  <b>Pps:</b>  Criticism is welcome.  Any. <br><br>  <b>Update 1</b> .  I made marks, I'm 4 ++. <br><br>  One ball subtracted with the wording: ‚ÄúToo much plagiarism with StackOverflow‚Äù, but added a plus for the article on Habr√©.  On questions about the second plus, mysteriously grins in his mustache. <br><br>  <b>Update 2</b> .  Two good news. <br><br>  <i>The first</i> .  The network technology teacher promised to put the exam automatically if I added the ‚Äúshare with a friend‚Äù function.  A group of extras spoke unfamiliar words. <br><br>  I sit, I smoke node.js, the campaign will have to start not only smoking, but also drinking.  No bottle to figure it out. <br><br>  Head in the clouds.  On Heroku I need it?  It may be better to hand over as usual - cribs and wonders.  And then health is more expensive. <br><br>  <i>The second</i> .  Zablab promised offset course in the next year, if I add three additional features of the voting results in the comments. <br><br>  So if there is an idea how to improve the functionality - offer, vote.  You can new demo function, template or UI tricky or something. <br><br>  Sound your wildest fantasies. <br><br>  <i>Third</i> .  If so, maybe a diploma on something ride? <br><br>  <b>Update 3</b> .  Hooray!  The first salary is in dollars.  In the work &amp; travel program I study English in the kitchen of the local McDonalds. <br><br>  The first learned idiom: "mania on grass."  I feel that by the end of the summer I will be fluent. <br><br>  I multiply dollars by 60, the number of zeros competes with the best offers for programmers in our regional center.  And in our district center, we need to enter the coefficient N. <br><br>  No N is small, we must take M. <br><br>  A group of experts, silently envying from afar, but hinting that upon arrival we will buzz.  Required to bring a tune.  But here those who don‚Äôt have 21, do not sell musical instruments, I don‚Äôt know what to do. <br><br>  I think a lot. <br><br>  Maybe my calling is cooking?  I'll write out my grandmother, open the cheburechnuyu, let‚Äôs trade in diet pies.  And then on a free McDonald's diet, I will definitely stay very spherical user. <br><br>  <b>Update 4</b> .  Instead of legal rest, I spent two sleepless nights programming (and as a result for those two days I spent the entire first salary on starbucks), but still converted the plug-in to FireFox and MS Edge. <br><br>  FireFox almost did not resist.  You can download the <a href="https://github.com/ntpetrova/CustomActionsFireFox">code</a> or <a href="">ready-made plugin</a> from GitHub. <br><br>  To allow downloading from source code, you need to use web-ext or through settings: <br><br><img src="https://habrastorage.org/web/682/78b/798/68278b798fc04c21af4358db0a4d76c8.png"><br><br>  To download the finished plug-in: <br><br><img src="https://habrastorage.org/web/6d3/375/1ec/6d33751ec6824afdb2d47ce86f7ddff2.png"><br><br>  And MS Edge rested against all limbs, barely fought.  I wanted to quit, but the cherished course machine still did not allow weaknesses to take precedence over strengths. <br><br>  Words from the documentation: Microsoft Edge extensions currently only support Default Policy Restrictions: script-src 'self';  object-src 'self', put an end to using knockout on the form of options.  I had to translate into angular.  Also not without incident. <br><br>  But the miracle happened and in the end everything happened.  The code can be picked up from <a href="https://github.com/ntpetrova/CustomActionsEdge">GitHub</a> . <br><br>  It is necessary to allow development in about: flags <br><br><img src="https://habrastorage.org/web/d2a/046/2fe/d2a0462feccf4d539d668ccefda5e154.png"><br><br>  and after that it can be downloaded for local use: <br><br><img src="https://habrastorage.org/web/5ab/934/f60/5ab934f600a04d81ac26a3254615cb4b.png"><br><br>  Have I already thanked StackOverflow?  Once again I take off my hat to this treasure trove of knowledge. </div><p>Source: <a href="https://habr.com/ru/post/333776/">https://habr.com/ru/post/333776/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../333762/index.html">Automatic creation of Liquibase migrations for PostgreSQL</a></li>
<li><a href="../333766/index.html">Fast data recovery. Regeneration butterfly pattern</a></li>
<li><a href="../333768/index.html">Automation IP-network. Part 3 - Monitoring TCP Anomalies</a></li>
<li><a href="../333772/index.html">We copy the human brain: operation "Convolution"</a></li>
<li><a href="../333774/index.html">How to work with UX contractors? Experience messenger "Answer"</a></li>
<li><a href="../333778/index.html">Especially for Habr: interview with Alan Kay</a></li>
<li><a href="../333780/index.html">The birth of Software Tools: how and why did GREP and AWK appear</a></li>
<li><a href="../333782/index.html">Sort by bubble in Qualcomm code</a></li>
<li><a href="../333784/index.html">A! Hack Summer - Alfa-Bank hackathon 5 and 6 August 2017</a></li>
<li><a href="../333786/index.html">How we added RAM to HPE servers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>