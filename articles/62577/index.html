<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Translate Class (Qt, C ++)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So, I decided to lay out a separate protocol, or rather a protocol class, Google Translate, through which my translator works. At the moment, the prot...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Translate Class (Qt, C ++)</h1><div class="post__text post__text-html js-mediator-article">  So, I decided to lay out a separate protocol, or rather a protocol class, Google Translate, through which my <a href="http://alexsnet.ru/opensource/translator/">translator</a> works.  At the moment, the protocol has the ability to install a proxy, make a translation (of course) and what everyone asked for, Google tips ... That is, if you don‚Äôt like the translation of something you can tell Google how it will be better translated in your opinion.  Well, in my opinion more is not necessary.  And if necessary - ficrequest and I will add! <br><br>  Code under the cut, see ... <br><br>  While you have not yet looked under the habrakat ... Immediately I apologize, the code is not so big, but it is still laid out directly, you can download it together with the source code of the translator from my blog. <br>  Do not scold.  I post it on a personal blog, I think it makes no sense to put it somewhere else. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  googleproto.cpp </h4><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#include <font color="#A31515">"googleproto.h"</font> <br> <br> GoogleProto::GoogleProto() <br> { <br> http = <font color="#0000ff">new</font> QHttp( <font color="#0000ff">this</font> ); <br> version = <font color="#0000ff">new</font> QString( <font color="#A31515">"0.9.5"</font> ); <br> <br> setTranslationArrays(); <br> <br> connect( http, SIGNAL(done( <font color="#0000ff">bool</font> )), <font color="#0000ff">this</font> , SLOT(textTranslated()) ); <br> } <br> <font color="#0000ff">int</font> GoogleProto::setProxy( <font color="#0000ff">const</font> QString &amp; host, <font color="#0000ff">int</font> port, <font color="#0000ff">const</font> QString &amp; username = QString(), <font color="#0000ff">const</font> QString &amp; password = QString() ) <br> { <br> <font color="#0000ff">return</font> http-&gt;setProxy( host, port, username, password ); <br> } <br> <font color="#0000ff">void</font> GoogleProto::suggestTranslation( <font color="#0000ff">int</font> <font color="#0000ff">from</font> , <font color="#0000ff">int</font> to, QString original, QString gtrans, QString suggest ) <br> { <br> QString url = QString( <font color="#A31515">"/translate_suggestion"</font> ); <br> QString langpair( <font color="#A31515">"|"</font> ); <br> langpair.append( translatesShort.at(to)  ); <br> langpair.prepend( translatesShort.at( <font color="#0000ff">from</font> ) ); <br> <br> QByteArray ba( <font color="#A31515">""</font> ); <br> ba.append( QString( <font color="#A31515">"gtrans=%1&amp;langpair=%2&amp;oe=UTF-8&amp;text=%3&amp;utrans=%4"</font> ).arg(gtrans, langpair, original, suggest).toUtf8() ); <br> <br> headers = QHttpRequestHeader( <font color="#A31515">"POST"</font> , url, 1, 1); <br> headers.setValue( <font color="#A31515">"Host"</font> , <font color="#A31515">"www.google.com"</font> ); <br> headers.setValue( <font color="#A31515">"User-Agent"</font> , <font color="#A31515">"Mozilla/5.0 (ASTranslator)"</font> ); <br> headers.setValue( <font color="#A31515">"Accept-Encoding"</font> , <font color="#A31515">"deflate"</font> ); <br> headers.setContentLength( ba.length() ); <br> headers.setValue( <font color="#A31515">"Connection"</font> , <font color="#A31515">"Close"</font> ); <br> <br> http-&gt;setHost( <font color="#A31515">"translate.google.com"</font> ); <br> http-&gt;request( headers, ba ); <br> } <br> <font color="#0000ff">void</font> GoogleProto::startTranslation( <font color="#0000ff">int</font> <font color="#0000ff">from</font> , <font color="#0000ff">int</font> to, QString text ) <br> { <br> QString url = QString( <font color="#A31515">"/translate_a/t?client=t&amp;sl="</font> + translatesShort.at( <font color="#0000ff">from</font> ) + <font color="#A31515">"&amp;tl="</font> + translatesShort.at(to) ); <br> <br> QByteArray ba( <font color="#A31515">"text="</font> ); <br> ba.append( text.toUtf8() ); <br> <br> headers = QHttpRequestHeader( <font color="#A31515">"POST"</font> , url, 1, 1); <br> headers.setValue( <font color="#A31515">"Host"</font> , <font color="#A31515">"www.google.com"</font> ); <br> headers.setValue( <font color="#A31515">"User-Agent"</font> , <font color="#A31515">"Mozilla/5.0 (ASTranslator)"</font> ); <br> headers.setValue( <font color="#A31515">"Accept-Encoding"</font> , <font color="#A31515">"deflate"</font> ); <br> headers.setContentLength(text.length()); <br> headers.setValue( <font color="#A31515">"Connection"</font> , <font color="#A31515">"Close"</font> ); <br> <br> http-&gt;setHost( <font color="#A31515">"www.google.com"</font> ); <br> http-&gt;request( headers, ba ); <br> <br> } <br> <font color="#0000ff">void</font> GoogleProto::textTranslated() <br> { <br> QString text; <br> text = text.fromUtf8( http-&gt;readAll() ); <br> <br> text = text.replace(QString( <font color="#A31515">"\\\""</font> ),QString( <font color="#A31515">"\""</font> )); <br> text = text.replace(QString( <font color="#A31515">"\\n"</font> ),QString( <font color="#A31515">"\n"</font> )); <br> text = text.replace(QString( <font color="#A31515">"\n "</font> ),QString( <font color="#A31515">"\n"</font> )); <br> text = text.replace(QString( <font color="#A31515">"\\x3c"</font> ),QString( <font color="#A31515">"&lt;"</font> )); <br> text = text.replace(QString( <font color="#A31515">"\\x3e"</font> ),QString( <font color="#A31515">"&gt;"</font> )); <br> <br> <font color="#0000ff">if</font> ( text.startsWith( QString( <font color="#A31515">"\""</font> ) ) ) { <br> <font color="#008000">// This is a text</font> <br> text = text.remove( text.length()-1, 1).remove(0,1); <br> } <font color="#0000ff">else</font> <font color="#0000ff">if</font> ( text.startsWith( QString( <font color="#A31515">"["</font> ) ) &amp;&amp; text.endsWith( QString( <font color="#A31515">"]"</font> ) ) ) { <br> <font color="#008000">// This is a word</font> <br> <font color="#008000">// Need dictionary mode</font> <br> QStringList tra; <br> <font color="#008000">//tra = text.split(QRegExp(QString("\"(.*)\"")));</font> <br> text = text.replace(QString( <font color="#A31515">"]"</font> ),QString( <font color="#A31515">""</font> )); <br> tra = text.split(QString( <font color="#A31515">"["</font> )); <br> text = QString( <font color="#A31515">""</font> ); <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i=0,j=0;i&lt;tra.count();i++) { <br> <font color="#0000ff">if</font> (tra.at(i)!= <font color="#A31515">""</font> ) { <br> <font color="#0000ff">if</font> (j==0) { <br> QString translation = tra.at(i); <br> translation = translation.replace( <font color="#A31515">"\""</font> , <font color="#A31515">""</font> ); <br> translation = translation.replace( <font color="#A31515">","</font> , <font color="#A31515">""</font> ); <br> text.append( translation ); <br> text.append( <font color="#A31515">"\n\n"</font> ) ; <br> } <font color="#0000ff">else</font> { <br> QString translation = tra.at(i); <br> QStringList translations = translation.split( <font color="#A31515">","</font> ); <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> y=0;y&lt;translations.count();y++) { <br> translation = translations.at(y); <br> translation = translation.replace( <font color="#A31515">"\""</font> , <font color="#A31515">""</font> ); <br> <font color="#0000ff">if</font> (y==0) { <br> text.append( QString( translation + <font color="#A31515">": "</font> ) ); <br> } <font color="#0000ff">else</font> { <br> text.append( QString( <font color="#A31515">"\t"</font> + translation + <font color="#A31515">"\n"</font> ) ); <br> } <br> } <br> text.append( <font color="#A31515">"\n"</font> ); <br> } <br> j++; <br> } <br> } <br> } <br> emit( translationComplete( text ) ); <br> } <br> <br> <font color="#0000ff">void</font> GoogleProto::setTranslationArrays() <br> { <br> translatesShort <br> &lt;&lt; <font color="#A31515">"sq"</font> &lt;&lt; <font color="#A31515">"ar"</font> &lt;&lt; <font color="#A31515">"bg"</font> &lt;&lt; <font color="#A31515">"ca"</font> <br> &lt;&lt; <font color="#A31515">"zh-CN"</font> &lt;&lt; <font color="#A31515">"zh-TW"</font> &lt;&lt; <font color="#A31515">"hr"</font> <br> &lt;&lt; <font color="#A31515">"cs"</font> &lt;&lt; <font color="#A31515">"da"</font> &lt;&lt; <font color="#A31515">"nl"</font> &lt;&lt; <font color="#A31515">"en"</font> <br> &lt;&lt; <font color="#A31515">"et"</font> &lt;&lt; <font color="#A31515">"tl"</font> &lt;&lt; <font color="#A31515">"fi"</font> &lt;&lt; <font color="#A31515">"fr"</font> <br> &lt;&lt; <font color="#A31515">"gl"</font> &lt;&lt; <font color="#A31515">"de"</font> &lt;&lt; <font color="#A31515">"el"</font> &lt;&lt; <font color="#A31515">"iw"</font> <br> &lt;&lt; <font color="#A31515">"hi"</font> &lt;&lt; <font color="#A31515">"hu"</font> &lt;&lt; <font color="#A31515">"id"</font> &lt;&lt; <font color="#A31515">"it"</font> <br> &lt;&lt; <font color="#A31515">"ja"</font> &lt;&lt; <font color="#A31515">"ko"</font> &lt;&lt; <font color="#A31515">"lv"</font> &lt;&lt; <font color="#A31515">"lt"</font> <br> &lt;&lt; <font color="#A31515">"mt"</font> &lt;&lt; <font color="#A31515">"no"</font> &lt;&lt; <font color="#A31515">"pl"</font> &lt;&lt; <font color="#A31515">"pt"</font> <br> &lt;&lt; <font color="#A31515">"ro"</font> &lt;&lt; <font color="#A31515">"ru"</font> &lt;&lt; <font color="#A31515">"sr"</font> &lt;&lt; <font color="#A31515">"sk"</font> <br> &lt;&lt; <font color="#A31515">"sl"</font> &lt;&lt; <font color="#A31515">"es"</font> &lt;&lt; <font color="#A31515">"sv"</font> &lt;&lt; <font color="#A31515">"th"</font> <br> &lt;&lt; <font color="#A31515">"tr"</font> &lt;&lt; <font color="#A31515">"uk"</font> &lt;&lt; <font color="#A31515">"vi"</font> ; <br> translatesFull <br> &lt;&lt; <font color="#A31515">"Albanian"</font> &lt;&lt; <font color="#A31515">"Arabic"</font> &lt;&lt; <font color="#A31515">"Bulgarian"</font> &lt;&lt; <font color="#A31515">"Catalan"</font> <br> &lt;&lt; <font color="#A31515">"Chinese (Simplified)"</font> &lt;&lt; <font color="#A31515">"Chinese (Traditional)"</font> &lt;&lt; <font color="#A31515">"Croatian"</font> <br> &lt;&lt; <font color="#A31515">"Czech"</font> &lt;&lt; <font color="#A31515">"Danish"</font> &lt;&lt; <font color="#A31515">"Dutch"</font> &lt;&lt; <font color="#A31515">"English"</font> <br> &lt;&lt; <font color="#A31515">"Estonian"</font> &lt;&lt; <font color="#A31515">"Filipino"</font> &lt;&lt; <font color="#A31515">"Finnish"</font> &lt;&lt; <font color="#A31515">"French"</font> <br> &lt;&lt; <font color="#A31515">"Galician"</font> &lt;&lt; <font color="#A31515">"German"</font> &lt;&lt; <font color="#A31515">"Greek"</font> &lt;&lt; <font color="#A31515">"Hebrew"</font> <br> &lt;&lt; <font color="#A31515">"Hindi"</font> &lt;&lt; <font color="#A31515">"Hungarian"</font> &lt;&lt; <font color="#A31515">"Indonesian"</font> &lt;&lt; <font color="#A31515">"Italian"</font> <br> &lt;&lt; <font color="#A31515">"Japanese"</font> &lt;&lt; <font color="#A31515">"Korean"</font> &lt;&lt; <font color="#A31515">"Latvian"</font> &lt;&lt; <font color="#A31515">"Lithuanian"</font> <br> &lt;&lt; <font color="#A31515">"Maltese"</font> &lt;&lt; <font color="#A31515">"Norwegian"</font> &lt;&lt; <font color="#A31515">"Polish"</font> &lt;&lt; <font color="#A31515">"Portuguese"</font> <br> &lt;&lt; <font color="#A31515">"Romanian"</font> &lt;&lt; <font color="#A31515">"Russian"</font> &lt;&lt; <font color="#A31515">"Serbian"</font> &lt;&lt; <font color="#A31515">"Slovak"</font> <br> &lt;&lt; <font color="#A31515">"Slovenian"</font> &lt;&lt; <font color="#A31515">"Spanish"</font> &lt;&lt; <font color="#A31515">"Swedish"</font> &lt;&lt; <font color="#A31515">"Thai"</font> <br> &lt;&lt; <font color="#A31515">"Turkish"</font> &lt;&lt; <font color="#A31515">"Ukrainian"</font> &lt;&lt; <font color="#A31515">"Vietnamese"</font> ; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><h4>  googleproto.h </h4><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">#ifndef GOOGLEPROTO_H <br> <font color="#0000ff">#define</font> GOOGLEPROTO_H <br> <br> #include &lt;QObject&gt; <br> #include &lt;QtNetwork&gt; <br> <br> <font color="#0000ff">class</font> QHttp; <br> <br> <font color="#0000ff">class</font> GoogleProto : <font color="#0000ff">public</font> QObject <br> { <br> Q_OBJECT <br> <font color="#0000ff">public</font> : <br> GoogleProto(); <br> <br> <font color="#0000ff">int</font> setProxy( <font color="#0000ff">const</font> QString &amp; host, <font color="#0000ff">int</font> port, <font color="#0000ff">const</font> QString &amp; username, <font color="#0000ff">const</font> QString &amp; password ); <br> <font color="#0000ff">void</font> suggestTranslation( <font color="#0000ff">int</font> <font color="#0000ff">from</font> , <font color="#0000ff">int</font> to, QString original, QString gtrans, QString suggest ); <br> <br> QStringList translatesShort; <br> QStringList translatesFull; <br> <br> <font color="#0000ff">public</font> slots: <br> <font color="#0000ff">void</font> textTranslated(); <br> <font color="#0000ff">void</font> startTranslation( <font color="#0000ff">int</font> <font color="#0000ff">from</font> , <font color="#0000ff">int</font> to, QString text ); <br> <br> signals: <br> QString translationComplete( QString text ); <br> <br> <font color="#0000ff">private</font> : <br> QHttp *http; <br> QHttpRequestHeader headers; <br> <br> <font color="#0000ff">void</font> setTranslationArrays(); <br> <br> QString *version; <br> }; <br> <br> <font color="#0000ff">#endif</font> // GOOGLEPROTO_H</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  And a small request ... Wake up to use ... Throw a link to me, anywhere ... This is not necessary, but I will be pleased =) It's also good if you write to me directly that you use it in this and such an application. <br><br>  Well, all the rest of the working week;) </div><p>Source: <a href="https://habr.com/ru/post/62577/">https://habr.com/ru/post/62577/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62565/index.html">Diploma Tips Part 1</a></li>
<li><a href="../62572/index.html">Diploma Tips Part 2</a></li>
<li><a href="../62573/index.html">Preparation for certification on Linux / Unix. Step 1</a></li>
<li><a href="../62574/index.html">Is Google's data center in Moscow launched?</a></li>
<li><a href="../62576/index.html">Alien Arena 2009 released</a></li>
<li><a href="../62581/index.html">Twitter: a sober look at the statistics. Part II</a></li>
<li><a href="../62585/index.html">Crop photos in the style of "VKontakte"</a></li>
<li><a href="../62588/index.html">Ideal office for small business</a></li>
<li><a href="../62589/index.html">Structured programming</a></li>
<li><a href="../62590/index.html">PhonePoint Pen - even more SMS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>