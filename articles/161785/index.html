<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dart + WebGL do cookies on the dark side taste good?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The history of web application development is very much like the life of Anaken Skywalker. About 15 years ago they were weak and clumsy. But as time p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dart + WebGL do cookies on the dark side taste good?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/bc9/95f/f23/bc995ff23c5903d7a497a4ac2ca52fc5.jpg"><br>  The history of web application development is very much like the life of Anaken Skywalker.  About 15 years ago they were weak and clumsy.  But as time passed, testosterone hit in the head and our ‚ÄúAnaken‚Äù falls into the red-hot lava of requirements for the quality and functionality of browser programs.  With his only surviving javascript, he rakes the ground beneath him.  Here the attentive reader will notice that we will not crawl away this way.  Unexpected, but in fact, quite natural plot twist and the savior Dart appears on the scene.  Let's try to stand on his side. <br><a name="habracut"></a><br>  Why Dart, simply because it is typed and it has a C-like syntax.  In addition, Google is developing VirtualMachine for Dart, which in the future could provide a significant advantage in the performance of this language. <br><br>  Why WebGL, because this technology, like Dart, is at the forefront, and 3D in the browser, in my opinion, is a very interesting topic. <br><br>  There is no point in expecting from the browser technology of the quality of board games.  WebGL is OpenGL 2.0, which means we have only vertex and fragment shaders in our hands, which means that the quality of the picture will lag behind board games by about 5 years.  For the masters of their craft, this is not an obstacle, the tanks online proved this, and even in the hands of the creators of the first tanks it was not. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First we need an IDE Dart editor.  It can be downloaded from the official website <a href="http://www.dartlang.org/">www.dartlang.org</a> <br>  At the heart of this IDE is, to many familiar, Eclipse, therefore, it is desirable to download a version of the bit that you have installed Java.  Otherwise, it will not be able to start. <br><br>  Create a new project: File-&gt; New application. <br><pre><code class="cs hljs">import <span class="hljs-string"><span class="hljs-string">'dart:html'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { }</code> </pre> <br>  This is the minimum bundle of the application on Dart.  The rest can be safely removed. <br>  To get an element from the page with a specific id, you need to call the querySelector function like this: <br>  var someElement = querySelector (‚Äú# someid‚Äù); <br>  Let's take a look at the minimum html file that we will use for experiments: <br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"status"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">canvas</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"canvas3d"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"800"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"600"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">canvas</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Simple.dart"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"application/dart"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"packages/browser/dart.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  This is how the code on Dart will look like to display a short message on the page: <br><pre> <code class="cs hljs">import <span class="hljs-string"><span class="hljs-string">'dart:html'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> status = querySelector(<span class="hljs-string"><span class="hljs-string">'#status'</span></span>); status.innerHtml = <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;    Dart.&lt;/p&gt;'</span></span>; }</code> </pre><br>  You can check the operation by clicking the start button: <br><img src="https://habrastorage.org/getpro/habr/post_images/853/60d/f74/85360df74017e2848982b611ad11d578.png"><br>  And compile for publishing to the web - right-click on the dart file in the window with the project file tree and click ‚ÄúRun as JavaScript‚Äù: <br><img src="https://habrastorage.org/getpro/habr/post_images/6b3/4b8/7dd/6b34b87dd97d090aa30cba5e0229eefe.jpg"><br>  To display 3D graphics, we need to get a 3D context from the canvas on which we will draw. <br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//  canvas = document.querySelector('#canvas3d'); // webGl     gl = (canvas.getContext("webgl")!=null)?canvas.getContext("webgl") : canvas.getContext("experimental-webgl");</span></span></code> </pre><br>  If after this request, gl is null, then the browser does not support webGl. <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gl == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { status.innerHtml = <span class="hljs-string"><span class="hljs-string">'&lt;p&gt;,     WebGl&lt;/p&gt;'</span></span>; }</code> </pre><br>  After receiving the context, it is necessary to initialize it, passing the horizontal shift, vertical shift, width and height of the display frame as parameters: <br><pre> <code class="cs hljs">gl.viewport(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, canvas.width, canvas.height);</code> </pre><br>  To display at least something on the canvas, you need to load two shaders, one vertex and one fragment (it's a pixel). <br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//  String vsSource = """ attribute vec3 aPosition; void main() { gl_Position = vec4(aPosition, 1); }"""; //   String fsSource = """ precision mediump float; uniform vec4 uColor; void main() { gl_FragColor = uColor; }"""; // ,        . // WebGLShader vs = gl.createShader(WebGLRenderingContext.VERTEX_SHADER); gl.shaderSource(vs, vsSource); gl.compileShader(vs); WebGLShader fs = gl.createShader(WebGLRenderingContext.FRAGMENT_SHADER); gl.shaderSource(fs, fsSource); gl.compileShader(fs); //    GPU WebGLProgram p = gl.createProgram(); gl.attachShader(p, vs); gl.attachShader(p, fs); gl.linkProgram(p); gl.useProgram(p); //    . if (!gl.getShaderParameter(vs, WebGLRenderingContext.COMPILE_STATUS)) { print(gl.getShaderInfoLog(vs)); } if (!gl.getShaderParameter(fs, WebGLRenderingContext.COMPILE_STATUS)) { print(gl.getShaderInfoLog(fs)); } if (!gl.getProgramParameter(p, WebGLRenderingContext.LINK_STATUS)) { print(gl.getProgramInfoLog(p)); }</span></span></code> </pre><br>  The print command prints information to the debugging console of the IDE used.  If something went wrong, then the reasons can be read. <br>  Now we need to load the vertex buffer into the GPU: <br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//     Float32List vertices = new Float32List.fromList([ -0.4, 0.4, 1.0, 0.4, 0.4, 1.0, -0.4, -0.4, 1.0]); //       gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER, gl.createBuffer()); gl.bufferDataTyped(WebGLRenderingContext.ARRAY_BUFFER, vertices, WebGLRenderingContext.STATIC_DRAW); //    int numItems = 3; //  ,       int aPosition = gl.getAttribLocation(program, "aPosition"); gl.enableVertexAttribArray(aPosition); gl.vertexAttribPointer(aPosition, 3, WebGLRenderingContext.FLOAT, false, 0, 0); //     (RedGreenBlueAlpha) gl.clearColor(0.9, 0.9, 0.9, 1); gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT); //  ,      WebGLUniformLocation uColor = gl.getUniformLocation(program, "uColor"); //          RGBA gl.uniform4fv(uColor, new Float32List.fromList([0.5, 0.9, 0.9, 1.0]));</span></span></code> </pre><br>  The only thing left to do is to give the draw command: <br><pre> <code class="cs hljs">gl.drawArrays(WebGLRenderingContext.TRIANGLES, <span class="hljs-number"><span class="hljs-number">0</span></span>, numItems);</code> </pre><br>  Now you can run the project and look at the result: <br><img src="https://habrastorage.org/getpro/habr/post_images/9f4/795/641/9f47956416e4a9c966703bd4b2ee2029.jpg"><br>  You can download the whole source dart file here: <a href="">dl.dropbox.com/u/41059365/Simple.dart</a> <br>  The purpose of this article was to show that Dart can be the same as JS, but more convenient.  Static typing and autocompletion greatly reduce development time, making it possible to keep unnecessary information in mind.  These and other buns are well told in the video, the link in the first comment. <br><br>  Our Sith is still young, but he is rapidly changing and growing up.  WebGl is getting stronger with it, albeit a bit slower.  Comparing Dart and JS, I would like to express my deepest respect for those who are able to write really complex projects on the second one.  The number of third-party libraries for Dart in a disproportionately smaller number than for JS, but the language and tools attached to it are so good that for new projects it will not rust.  And step by step debugging of the code, this is a treasure for novice programmers.  Cookies on the side of Dart and soon he will become the ruler of the entire Internet. </div><p>Source: <a href="https://habr.com/ru/post/161785/">https://habr.com/ru/post/161785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161771/index.html">Peter Westerback in Skolkovo</a></li>
<li><a href="../161773/index.html">‚ÄúSimple Business‚Äù received new perpetual licenses from the FSB and FSTEC</a></li>
<li><a href="../161775/index.html">Making OpenGL ES LiveWallpaper on Linderdaum Engine for Android</a></li>
<li><a href="../161779/index.html">Curved LCDs can be used as screens in contact lenses.</a></li>
<li><a href="../161783/index.html">Free distance education</a></li>
<li><a href="../161787/index.html">Amazon SQS vs RabbitMQ</a></li>
<li><a href="../161793/index.html">‚ÄúIT Infrastructure Under Control‚Äù: Web Conferencing Records Out</a></li>
<li><a href="../161801/index.html">Pre-holiday discount on IM + Pro</a></li>
<li><a href="../161803/index.html">Robot Loader Project: Determine Your Own Location</a></li>
<li><a href="../161805/index.html">Drawing a snowman in PowerShell</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>