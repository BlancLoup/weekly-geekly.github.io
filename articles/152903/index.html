<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CRIU 0.2 and Linux Containers - new features</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Habr√© already published an article dedicated to the release of CRIU 0.1. This version of the product was not functional enough and rather demonstra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CRIU 0.2 and Linux Containers - new features</h1><div class="post__text post__text-html js-mediator-article">  On Habr√© already published <a href="http://habrahabr.ru/post/148413/">an article</a> dedicated to the release of CRIU 0.1.  This version of the product was not functional enough and rather demonstrated the performance of a unique technology developed by Parallels. <br><br>  Since then, a lot of work has been done and the possibilities of the CRIU came very close to the main goal: the <a href="http://criu.org/LXC">preservation and restoration of the</a> Linux container.  Despite the fact that so far only an empty container with a standard set of processes is supported, there is every reason to believe that the project is doomed to success. <br><br>  And if you are not interested in containers, then you might like another new feature - <a name="habracut"></a>  support for saving and restoring pseudo-terminals, for which the screen session is well suited to illustrate.  First you need to run several applications, such as top and vim, and disconnect from the session.  After saving and restoring the screen-session and child processes using CRIU, you can reconnect to the screen-session and make sure that the running processes retain their state.  For greater persuasiveness, between the moments of saving and restoring you can restart the computer or restore the screen session on another machine. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The link is a video clip that demonstrates how the CRIU saves and restores the state of the vncserver with a screensaver to which the client is connected: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/QIs-3Rtbpps%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhjp-gOUVodu9FWFBVB3NVSvAYx9pQ" frameborder="0" allowfullscreen=""></iframe><br><br>  This example is notable because during the saving and restoration of the server state, the connection to the client is also restored.  That is, everything is transparent to the client (with the exception of a short service delay). <br><br><h1>  Several features of CRIU development. </h1><br>  I decided to slightly dilute the articles on new versions of CRIU with interesting points from the project development process.  Today I will talk about testing and the format of the dump files. <br><br><h2>  Unit tests </h2><br>  It is clear that for the success of the project can not do without quality testing.  Therefore, we decided that automated testing should be implemented at the earliest stages of development.  The groundwork was taken for testing the same functionality in the OpenVZ project.  After completion of the project, we have created a comprehensive system for unit-testing.  Each test is run separately and passes through 3 stages: preparation of the environment, ‚Äúdemonization‚Äù and waiting for a signal (which must be sent from the outside after saving and restoring the test), checking the result.  Tests are conditionally divided for two groups.  The first group is static tests that prepare a certain constant environment or state and ‚Äúfall asleep‚Äù waiting for a signal.  The second group is streaming tests that constantly change their state and / or environment (for example, data is sent via a TCP connection). <br>  Today, the unit-testing system of CRIU includes about 70 individual test programs.  In this case, the system allows you to run each of the tests both in the current and in the isolated namespace (that is, in fact, in the container). <br><br><h2>  Data file format </h2><br>  The architectural aspects of the program must be carefully considered at the design stage, since then it will be very difficult to change something.  The data retention format was one such architectural aspect for CRIU.  It was necessary to solve two main tasks, namely: <br><ul><li>  The format must be extensible with the ability to maintain backward compatibility; </li><li>  The format should be common to allow easy access to data from other applications. </li></ul><br>  We looked at all the most common and popular formats and settled on protobuf (Protocol Buffers), developed by Google, as it is supported by libraries for different programming languages ‚Äã‚Äãand its format allows you to add new fields with backward compatibility. <br>  Unfortunately, sometimes it is necessary not only to add new fields, but also to change the data structure.  Therefore, dump files are versioned. <br><br><h1>  Conclusion </h1><br>  Parallels Company is actively developing the CRIU project and our next major goal is to learn how to save and restore the state of the OpenVZ container.  This will eliminate the support for the migration of the OpenVZ container in the kernel, freeing up developer resources and thereby accelerating the development of the OpenVZ project. <br><br>  <a href="http://habrahabr.ru/post/148413/">habrahabr.ru/post/148413</a> <br>  <a href="http://ru.wikipedia.org/wiki/CRIU">ru.wikipedia.org/wiki/CRIU</a> <br>  <a href="http://lwn.net/Articles/517079/">lwn.net/Articles/517079</a> <br>  <a href="http://criu.org/LXC">criu.org/LXC</a> </div><p>Source: <a href="https://habr.com/ru/post/152903/">https://habr.com/ru/post/152903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../152887/index.html">15 years ago the world saw Fallout</a></li>
<li><a href="../152889/index.html">Through thorns to Haskell. 1/2</a></li>
<li><a href="../152895/index.html">Release the first version!</a></li>
<li><a href="../152897/index.html">NEC EA273WM - very angry 27 inches</a></li>
<li><a href="../152899/index.html">Spy in your pocket</a></li>
<li><a href="../152907/index.html">Free ASN.1: 2008 compliance test suite</a></li>
<li><a href="../152909/index.html">Meet the free and free font Yeseva</a></li>
<li><a href="../152911/index.html">Free internet distribution business</a></li>
<li><a href="../152913/index.html">Reception of applications for the Web Ready Internet projects competition is coming to an end</a></li>
<li><a href="../152915/index.html">Based on the article ‚ÄúWho owns the Bynet‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>