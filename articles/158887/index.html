<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Overview and configuration of deduplication tools in Windows Server 2012</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all! 

 Today I would like to review such an interesting new feature in Windows Server 2012 as data deduplication (data deduplication). Th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Overview and configuration of deduplication tools in Windows Server 2012</h1><div class="post__text post__text-html js-mediator-article">  Good day to all! <br><br>  Today I would like to review such an interesting new feature in <a href="http://technet.microsoft.com/ru-ru/evalcenter/hh670538.aspx">Windows Server 2012</a> as data deduplication (data deduplication).  The feature is extremely interesting, but still you first need to figure out how much it is needed ... <br><br><img src="https://habrastorage.org/storage2/f04/d23/88a/f04d2388ae75f7a146dd2c1ac0f3a13e.png"><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Do you really need deuplication? </h1><br><br>  Every year (if not during the day) hard drive volumes are growing, and at the same time, the carriers themselves are also becoming cheaper. <br>  Based on this tendency, the question arises: ‚ÄúDoes data deduplication necessary?‚Äù. <br>  However, if we live in our universe and on our planet, then almost everything in this world tends to obey the 3rd Newton's law.  Maybe the analogy is not completely transparent, but I conclude that the disk systems and disks themselves, no matter how much the carriers themselves become cheaper, the requirements from the business point of view of the data storage space are constantly increasing and thus level the increase. volume and price drop. <br>  According to IDC forecasts, in about a year, about <b>90 million terabytes</b> will be required in total volume.  The volume, frankly, is not small. <br><br><img src="https://habrastorage.org/storage2/c28/1f0/fdb/c281f0fdb1c3110faef77b951169f7b1.png"><br><br>  And this is where the issue of data deduplication becomes very relevant.  After all, the data that we use are of different types, and they can have different purposes - somewhere it is production-data, somewhere it is archives and backup copies, and somewhere it is streaming data - I specifically cited such examples, since in the first case the effect of using deduplication will be average, in the archived data it will be maximum, and in the case of streaming data it will be minimal.  But still, we can save space with you, especially since deduplication is now a matter of not only specialized storage systems, but also a component feature of the Windows Server 2012 server OS. <br><br><h2>  Types of deduplication and their use </h2><br><br>  Before turning to the review of the deduplication mechanism itself in <a href="http://technet.microsoft.com/evalcenter/hh670538.aspx">Windows Server 2012</a> , let's look at what types of deduplication are.  I propose to start from top to bottom, in my opinion so it will be clearer. <br><br>  1) <b>File deduplication</b> - like any deduplication mechanism, the operation of the algorithm is reduced to finding unique data sets and repetitive ones, where the second types of sets are replaced with references to the first sets.  In other words, the algorithm tries to store only unique data, replacing duplicate data with links to unique ones.  As you might guess from the name of this type of deduplication, all such operations occur at the file level.  If you recall the history of Microsoft products - this approach has been repeatedly used before - in the <a href="http://www.microsoft.com/click/services/Redirect2.ashx%3FCR_CC%3D200113306">Microsoft Exchange Server</a> and the <a href="http://www.microsoft.com/ru-ru/server-cloud/system-center/sp1-default.aspx">Microsoft System Center</a> Data Protection Manager - and this mechanism was called SIS (Single Instance Storage).  In the products of the Exchange line, it was abandoned in due time for performance reasons, but in Data Protection Manager, this mechanism is still successfully used and it will seem to continue to do so.  As you might guess, the file level is the highest (if you remember the storage system in general) - and therefore the effect will be the most minimal compared to other types of deduplication.  Scope - this type of deduplication is mainly applied to archived data. <br><br>  2) <b>Block deduplication</b> - this mechanism is more interesting, since it works at the sub-file level - namely, at the level of data blocks.  This type of deduplication is usually characteristic of industrial storage systems, and it is this type of deduplication that is used in Windows Server 2012. The mechanisms are the same as before - but at the block level (I think I said that, right?).  Here, the scope of deduplication is expanding and now extends not only to archived data, but also to virtualized environments, which is quite logical - especially for VDI scripts.  If we consider that VDI is a whole cloud of repetitive images of virtual machines, which still have differences from each other (this is why the file deduplication is powerless here) - then block deduplication is our choice! <br><br>  3) <b>Bit deduplica</b> - the lowest (deep) type of data deduplication - has the highest degree of efficiency, but it is also the leader in resource consumption.  It is understandable - to analyze data on uniqueness and plagiarism is a difficult process.  Honestly, I personally do not know storage systems that operate at this level of deduplication, but I know for sure that there are traffic deduplication systems that operate at the bit level, say the same Citrix NetScaler.  The meaning of such systems and applications is to save the transmitted traffic - this is very critical for scenarios with geographically distributed organizations, where there are many geographically dispersed branches of the enterprise, but there are no or extremely expensive data transmission channels in operation - here solutions in the field of bit deduplication will find themselves nowhere else will they reveal their talents. <br><br>  The <a href="https://www.usenix.org/conference/usenixfederatedconferencesweek/primary-data-deduplication%25E2%2580%2594large-scale-study-and-system">Microsoft report at USENIX 2012</a> , which took place in Boston in June, looks very interesting in this regard.  There was a fairly large-scale analysis of the primary data in terms of applying to them the block deduplication mechanisms in WIndows Server 2012 - I recommend reading this material. <br><br><h2>  Performance issues </h2><br><br>  In order to understand how effective deduplication technology in Windows Server 2012, you first need to determine on what type of data this very efficiency should be measured.  Typical file balls, user documents from the My Documents folder, distribution repositories and libraries, and virtual hard disk storage were taken as references. <br><br><img src="https://habrastorage.org/storage2/7db/c7c/0f2/7dbc7c0f23663e10c428272eb096002e.png"><br><br>  How effective deduplication in terms of workloads was checked at Microsoft in the software development department. <br>  The 3 most popular scenarios became the objects of study: <br><br>  1) <b>Software build build servers</b> ‚Äî a decent amount of builds of various products is collected every day at MS.  Not even a significant change in the code leads to the build process of the build - and therefore a lot of duplicate data is created. <br><br>  2) <b>Spheres with product distribution</b> kits <b>for release</b> - As it is not difficult to guess, all assemblies and ready versions of software need to be placed somewhere - inside Microsoft there are special servers for this, where all versions and language revisions of all products are placed - this is also quite an effective script where the efficiency of deduplication can reach up to 70%. <br><br>  3) <b>Group balls</b> are a combination of a ball with documents and developer files, as well as their roaming profiles and redirected folders, which are stored in a single central space. <br><br><img src="https://habrastorage.org/storage2/a8d/580/498/a8d580498b0aeab1be7f516ae34b8cec.png"><br><br>  And now the most interesting - below is a screenshot of the volumes in Windows Server 2012, on which all this data is placed. <br><br><img src="https://habrastorage.org/storage2/355/6b2/e7e/3556b2e7e63eddad862faa68e8202783.jpg"><br><br>  I think the words here will be superfluous - and everything is very clear.  Saving at 6 TB on media at 2 TB - thermonuclear storage?  Not so dangerous - but so effective! <br><br><h2>  Deduplication features in Windows Server 2012 </h2><br><br>  And now let's consider the main characteristics of deduplication in Windows Server 2012. <br><br>  1) Transparency and ease of use - <a href="http://technet.microsoft.com/en-us/library/hh831700.aspx">configuring deduplication is</a> extremely simple.  First, in the role wizard in Windows Server, you disclose the role of File and Storage Services, then File and iSCSI Services - and there you turn on the Data Deduplication option. <br>  After that, in Server Manager you select Fike and Storage Services, right-click - and there you select the item ‚ÄúEnable Volume Deduplication‚Äù.  <a href="http://technet.microsoft.com/en-us/library/hh848450.aspx">Special link for PowerShell lovers</a> .  Everything is extremely simple.  From the point of view of the end user and applications, access and work with data is carried out transparently and imperceptibly.  If we talk about deduplication from the point of view of the file system, only NTFS is supported.  ReFS cannot be deduplicated, just like volumes protected with EFS (Encrypted Fike System).  Also, files of less than 32 KB and files with extended attributes (extended attributes) are not subject to deduplication.  Deduplication, however, extends to dynamic volumes, BitLocker-encrypted volumes, but not CSV volumes, as well as system volumes (which is logical). <br><br>  2) Optimization for basic data - it is worth noting immediately that deduplication is not an online process.  Deduplications are files that reach a certain level of old age in terms of a given policy.  After a certain storage period is reached, data starts to go through the deduplication process - by default, this time interval is 5 days, but no one bothers you to change this parameter - but be reasonable in your experiments! <br><br>  3) Planning optimization processes - a mechanism that every hour checks files for compliance with deduplication parameters and adds them to the schedule. <br><br>  4) Mechanisms for excluding objects from the deduplication area - this mechanism allows you to exclude files from the deduplication area by their type (JPG, MOV, AVI - as an example, this is streaming data - something that is least susceptible to deduplication - if it can be).  You can also exclude entire file folders from the deduplication area at once (this is for fans of German films whose darkness is theirs). <br><br>  5) Mobility - the deduplicated volume is a complete object - it can be transferred from one server to another (this is exclusively Windows Server 2012).  In this case, you can easily access your data and can continue to work with them.  All that is needed for this is the included Data Deduplication option on the target server. <br><br>  6) Optimization of resource consumption - these mechanisms involve the optimization of algorithms to reduce the load on read / write operations, so if we are talking about the size of the hash index of data blocks, then the size of the index per 1 data block is 6 bytes.  Thus, deduplication can even be applied to very massive data sets. <br>  Also, the algorithm always checks whether there are enough memory resources for the deduplication process - if the answer is no, then the algorithm will delay the process until the required amount of resources is released. <br><br>  7) BranchCache integration - indexing mechanisms for deduplication are also common for BranchCache - therefore, the efficiency of using these technologies in conjunction is beyond doubt! <br><br><h2>  Reliability issues for deduplicated volumes </h2><br><br>  The issue of reliability is extremely acute for deduplicated data - imagine that a data block, at least 1000 files depend hopelessly damaged ... I think validol-ez-e-service then will definitely come in handy, but not in our case. <br><br>  1) Backup - Windows Server 2012, like System Center Data Protection Manager 2012 SP1, fully supports deduplicated volumes in terms of backup processes.  Also available is a <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/hh449202(v%3Dvs.85).aspx">special API</a> that allows third-party developers to use and maintain deduplication mechanisms, as well as restore data from deduplicated archives. <br><br>  2) Additional copies for critical data ‚Äî those data that have the most frequent conversion parameter are projected through the process of creating additional backup blocks ‚Äî these are features of the mechanism of the mechanism.  Also, in the case of using the Storage Spaces mechanisms, when finding a bad block, the algorithm automatically replaces it with the integral of the pair in the mirror. <br><br>  3) By default, once a week, the process of finding garbage and bad blocks starts, which corrects the data of acquired pathologies.  It is also possible to manually start this process at a deeper level.  If the default process corrects errors that were recorded in the event log, then a deeper process involves scanning the entire volume. <br><br><h2>  Where to start and how to measure </h2><br><br>  Before turning on deduplication, always the normal person would think about how effective this mechanism will be in his particular case.  To do this, you can use the <b>Deduplication Data Evaluation Tool</b> . <br>  After installing deduplication, you can find a tool called <b>DDPEval.exe</b> , which is in \ Windows \ System32 \ - this scrap can be ported to removable media or another volume.  Supports Windows 7 and higher.  So you can analyze your data and understand the value of sheep skins.  (smile). <br><br>  This completes my review.  I hope you were interested.  If you have any questions, feel free to find me on social networks - VKontakte, Facebook - by name and surname - and I will try to help you. <br>  For those who want to learn about new features in Windows Server 2012, as well as System Center 2012 SP1 - I invite everyone to visit <a href="https://msevents.microsoft.com/CUI/EventDetail.aspx%3FEventID%3D1032537501%26Culture%3Dru-RU%26community%3D0">IT Camp - November 26,</a> this event will take place on the eve of <a href="http://yabs.yandex.ru/count/CTFxXYxanRS40000ZhEDNme5KfK1cm9kGoI8gI2KK8cWas-KdgnyrG6Td5WMagwD9vkc18gXkoL3gW6behcW0Oq1aQOL5tQJXGr2Z91g6A2Gsngla6eOb96l4AULv4AeiK1PSmUai00001ckzxO6PGE8cCu4iG5x3G00">TechEd Russia 2012</a> - I, George Hajiyev and Simon Perriman will conduct it who specially flies to us from the USA. <br><br>  See you at IT Camp and at <a href="http://yabs.yandex.ru/count/CTFxXYxanRS40000ZhEDNme5KfK1cm9kGoI8gI2KK8cWas-KdgnyrG6Td5WMagwD9vkc18gXkoL3gW6behcW0Oq1aQOL5tQJXGr2Z91g6A2Gsngla6eOb96l4AULv4AeiK1PSmUai00001ckzxO6PGE8cCu4iG5x3G00">TechEd</a> ! <br><br>  Respectfully, <br>  fireman <br>  George A. Gadzhiev <br><br>  Microsoft Corporation </div><p>Source: <a href="https://habr.com/ru/post/158887/">https://habr.com/ru/post/158887/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../158867/index.html">CryptoParty in Moscow! I want to tell about:</a></li>
<li><a href="../158873/index.html">Why did Stanford University change its logo?</a></li>
<li><a href="../158877/index.html">100 days of curiosity</a></li>
<li><a href="../158881/index.html">How can a wife help freelancers?</a></li>
<li><a href="../158885/index.html">WiFi: who is to blame: Windows 8 or Intel</a></li>
<li><a href="../158889/index.html">For Linux came out Skype 4.1</a></li>
<li><a href="../158891/index.html">How did we get access to the database of banned resources</a></li>
<li><a href="../158893/index.html">From cassettes to online streaming</a></li>
<li><a href="../158895/index.html">What each developer needs to know about character encodings and character sets for working with text, part 2</a></li>
<li><a href="../158897/index.html">Should I use freemium model? Part 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>