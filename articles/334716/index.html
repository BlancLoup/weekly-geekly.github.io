<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create offline facial recognition with an accuracy of 99.38% in Python and Node.js</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is my story about how I created a free, offline, real-time open source application designed to help the organizers of any events in admitting / a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create offline facial recognition with an accuracy of 99.38% in Python and Node.js</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/7dc/3e2/997/7dc3e2997d3c46ffbb162b9639fa60ed.png" alt="image">  This is my story about how I created a free, offline, real-time open source application designed to help the organizers of any events in admitting / authorizing only invited people using face recognition technology or a QR code. <br><br>  If you can not wait to go directly to the code, then here is <a href="https://github.com/ageitgey/face_recognition">my repository</a> . <br><br>  So yes, face recognition is only part of the application, and the most difficult part.  So pour yourself some coffee and enjoy my story (I tried). <br><a name="habracut"></a><br>  Often there are dedicated to deep learning projects in Python, but not on Node.js.  The reason is that under Python, there are many more libraries for efficient computations, for example, Numpy, Pandas, tensorflow, and so on.  And the gap is big enough.  I know Node.js, well, I know a little, and I wanted to use it in the project in order to master it better while I was busy with machine learning. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It all started during an online competition that had a question about working with the AzureML API (facial expression definition).  I saw that there is also a face recognition API, but with some limitations.  In addition, you first need to upload an image to the service, then it calculates the result and sends it to me.  Too slow for me.  I wanted to play with him, but at that time the service was not available in my country.  So I want to thank the developers who gave me the idea to make something of my own.  Until then, I had only studied what others had already done.  I had certain doubts from the point of view of security, I needed a backup function.  In addition, I read <a href="https://hackernoon.com/unconventional-way-of-learning-a-new-programming-language-e4d1f600342c">an article by</a> my boss about learning a new language.  And I thought that it was a great opportunity to apply my knowledge in a completely new project. <br><br>  Well, and then what?  I plugged the power cord into my Macbook because I knew it would take a long time, and I took my buddy Google with me for a ridiculous search for the best resources to start the project with.  It turned out that people had already asked the network whether it was possible to realize what I had in mind, but there were no sensible answers.  At the time, I was alone with this task.  Then he came across an excellent <a href="https://medium.com/%40ageitgey/machine-learning-is-fun-part-4-modern-face-recognition-with-deep-learning-c3cffc121d78">series of publications by Adam Gaitgeya</a> .  I used to read his blog, but then somehow I got into other things.  And then I came across a wonderful article by Adam and found out that he created the <a href="https://github.com/ageitgey/face_recognition">face_recognition</a> package in Python.  I downloaded it and tested it.  Well, it did not work as smoothly as we would like. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/268/504/9ff/2685049ff08da5a4831b1739935fdd0f.gif" alt="image"></div><br><br>  So I felt myself when I installed <a href="http://dlib.net/">dlib</a> .  I do not know why, but there was a problem with the installation at the very last stage.  I spent many hours trying to figure out the reason, I didn‚Äôt even go to the gym that day. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/72b/5e2/dac/72b5e2dacc49b51192c545044a12abb0.gif" alt="image"></div><br>  I was on the verge of abandoning the project.  But then I found out that the reason was in conflict because of the path of the anaconda Python package, or something like that.  I was still studying the ecosystem, so I had to decide whether to leave anaconda and abandon the project, or get rid of the "snake".  In the end, I completely removed anaconda, and spent the day completing the complete removal of different versions of Python downloaded by different packages, leaving only the system version.  Then, using Homebrew, I correctly downloaded Python3, installed dlib, and by the end of the day I was able to launch it. <br><br>  There was a new problem: how to integrate the library in Node.js?  Again, I faced a dilemma: to study a Python-framework like Django, Flask, and so on, to continue working on a project, or get involved in a potentially endless task that might be completely unsolvable.  Once I read this phrase and it surfaced in my head: <br><br>  <b>The rule of mathematics: if it looks simple, then you are doing wrong.</b> <br><br>  The phrase inspired me along with the article of the chief, so I decided to continue with Node.js, who knew a little about some web projects. <br><br>  Therefore, I again began to look for ways to integrate Python and Node.js.  Learned about <b>child processes</b> in Node.js.  But my situation looked like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/830/6f7/175/8306f7175183eb3409b2e416949239d8.gif" alt="image"></div><br>  I read the documentation with scant examples.  Read blogs, and everywhere was the same.  But this time I intended to complete the project at any cost (read, with the help of an internship).  Since the beginning of the internship season was nearing, I needed to finish the preparations as soon as possible.  In addition, I needed enough time to create another such project next summer, but again on my own, with the help of Google alone.  If you are a little familiar with machine learning, then you will be close to it: <br><br>  <i>If the learning rate is too low, then achieving the optimum will take a lot of time, or you will be stuck at a local minimum.</i>  <i>If the speed is too high, then you can miss.</i>  <i>But if the speed is correct, or regulated depending on the conditions, then the algorithm will quickly find the optimal point.</i> <br><br>  For me, as for the algorithm, the internship was the right learning rate.  So I had to finish the project. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/211/9f3/7a9/2119f37a95baef471f7340a9f55a5542.gif" alt="image"></div><br>  So I worked hard, sometimes I worked until 5.45 in the morning.  It was an amazing time, I made a lot of stupid mistakes.  I did not update the tab when I changed the code on the server.  I changed the code several times on the client, but did not update the window.  I do not know why, perhaps, I too wanted to sleep, at a comfortable temperature of 22 degrees Celsius in my cozy bed.  There were amazing moments, like searching on Stackoverflow for an unnecessary logical error, which I later fixed by simply updating the tab. <br><br>  Finally, I was able to make friends with Python and Node.js. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4bc/0fc/2d9/4bc0fc2d9f71e08e917110d2b12207ad.gif" alt="image"></div><br>  After that incident with AzureML, I was in awe of creating a fully offline web application that could do everything planned without any kind of Internet.  I had to find alternative APIs or do them myself.  As you probably know, in computer science it is in the order of things: <b>time is inversely proportional to space</b> .  So I <b>tried to minimize the time</b> spent on ensuring the work of certain things.  Sending a photo / video to the cloud service takes time and a channel, which means you had to increase the occupied space.  Although cloud services are much more convenient, I like to write a lot of code if I do what interests me.  You can accept this by reading <a href="https://github.com/malikshubham827/get-me-through">the installation instructions for my repository</a> . <br><br>  I found many packages, tried one by one, took it to work, sometimes dropped it and looked again.  For example, it was necessary to integrate the recognition of QR codes as a fallback in case of a failure of face recognition.  There are many packages for generating codes, but not for scanning them.  In the end I found the Instascan package.  Had trouble with him.  The fact is that I used OpenCV3 for face recognition in Python, and with the same camera (it‚Äôs the only one in the laptop) scanned QR codes.  I needed a small video frame for scanning, but the size of the video for face recognition was also changed.  Well, that didn't seem like a problem.  I can stop the recognition process, scan the QR code and run it again.  Pretty simple, huh?  But if you read carefully, you noticed two points: <br><br><ul><li>  If it looks simple, then you are doing wrong. </li><li>  I'm trying to minimize time (the main reason not to wait for the API to become available). </li></ul><br>  So in order to solve this problem, I had to study the code of the packages and the processes they perform. <br><br><h2>  Library parsing </h2><br>  Yes, I started this task three times - I analyzed libraries to deal with all sorts of difficulties.  At least, the difficulties for me. <br><br><ol><li>  I studied the work of the face_recognition package to adapt it for my own purposes.  At the same time helped others. </li><li>  I studied a little Instascan to understand how it works with the camera, and how to work with the camera in general for a web application.  There are many cases that need to be handled: that if the user somehow stops the operation of the camera, for example, by clicking past a modal window or closing it altogether.  I changed the code, ran it many times, each time finding several bugs.  Once, my Mac almost ran out of memory, and I hung for a few seconds.  After repeated attempts, I finally achieved success, but again I found another bug. </li><li>  This time the bug was in the modal window of the Materialize framework.  Callback not working.  Googled, rummaged on Github and Stackoverflow - I did not find a solution.  I calculated the code responsible for the bug, tried to figure it out, ran it several times with the console.log () expressions, trying to understand what was happening, getting closer and closer to the bug, isolating the code in parts (I felt like a hacker bypassing the password).  I heard that the forms in this framework are not too good either, so I'll play with them in another web application. </li></ol><br><br><h2>  Event ++ </h2><br>  This is an amazing bug caused by jQuery.  The number of events increases with each click: 1, 2, 3, 4, 5, 6, 7, 8 ... My real-time notifications completely scored the entire right column into which they were displayed.  It turned out that in jQuery I use on () instead of click (), and also use socket.on () events outside the handler. <br>  Finally, after a long struggle, the server part began to work well with the client. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa5/145/ff0/aa5145ff01327d977bbe39f67a222a34.gif" alt="image"></div><br>  I thought everything was ready.  But then an idea came to me: what if we added support for the database so that the user could perform CRUD operations.  I wanted to leave to the discretion of users what they should use: SQL or NoSQL.  I thought that I would add support and, who knows, I can make money on it (it is possible to start heading too far in the clouds, having achieved some success).  Just a little bit, and I will have full functionality for automatic registration of incoming / outgoing visitors (face recognition, QR code scanning, no API restrictions, three-step authentication).  But: <br><br><ol><li>  I learned everything from the open-source community. </li><li>  I do not think that I can sell my product by knocking at different companies.  For this I am too lazy.  I would prefer to develop a few more similar products. </li><li>  Presented a scene from the film "Social Network" in which Mark wrote the application and laid out in free access, even though he had good purchase offers (I think from Microsoft), and here I am so handsome, with a small web application that doesn't even wrote from scratch. </li></ol><br>  I tried to integrate MongoDB because I was familiar with it a bit, and besides, I hadn‚Äôt studied SQL in college yet.  It will only be in the next semester.  So I left the implementation of this feature for another project, perhaps, fork or porting it. <br>  In general, I developed, integrated, spent several days studying, using, debugging, and so on. <br><br>  Finally, I saw this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/734/1c8/a52/7341c8a52c1ecced58e1304856597a63.gif" alt="image"></div><br>  Frontend, backend and database work in unison.  Of course, in the center - the server part (combining the power of Python and Node.js).  You can solve other problems, for example, to train the model, because I was able to integrate OpenCV3 (this requires installing binaries), face_recognition, numpy, pandas with dataset, and save the result in .csv format in my Python process.  So if you have the right hardware, you can do something completely different based on my project. <br><br>  I leave it to your discretion, who is on the front end gif, and who is the database. <br><br>  Signing.Off (); <br><br>  * * * <br>  <a href="https://github.com/malikshubham827/get-me-through">Link to the project</a> . <br><br>  Why did I write this text, although my codebase is not so great?  So what?  Well, for many of you, these are just a few hundred lines of code, but for me, integrating all parts, systematic study, updating of existing knowledge, self-correction of one base after another in this indefinite project (for me) is all a task that no one has yet solved (machine learning in Python and Node.js).  Well, maybe I was looking bad.  In general, for me it is a big project.  I hope someone will find it useful.  In addition, I wrote this post to revive moments of frustration and temporary happiness when something broke or worked.  That is life. </div><p>Source: <a href="https://habr.com/ru/post/334716/">https://habr.com/ru/post/334716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334704/index.html">Unified Style Language</a></li>
<li><a href="../334708/index.html">Practical examples of attacks inside the GSM network</a></li>
<li><a href="../334710/index.html">Dagger 2. Subcomponents. Best practice</a></li>
<li><a href="../334712/index.html">Character development for the game "Allods Online"</a></li>
<li><a href="../334714/index.html">"Man in the middle" using revoked certificates. Part 2</a></li>
<li><a href="../334718/index.html">The first Mail.Ru Group specialization is Coursera, the largest educational platform.</a></li>
<li><a href="../334720/index.html">Search for Go packages on PowerShell</a></li>
<li><a href="../334722/index.html">Digest of grocery design, July 2017</a></li>
<li><a href="../334724/index.html">Virtuozzo: What are the real benefits of distributed storage?</a></li>
<li><a href="../334726/index.html">Or meteor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>