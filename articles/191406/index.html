<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Developers in the struggle for the effectiveness of the programmer, team, teams</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. 

 Today we would like to discuss one very important aspect of effective work - reuse. 

 It will, of course, about the code. 
 Routine, which ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Developers in the struggle for the effectiveness of the programmer, team, teams</h1><div class="post__text post__text-html js-mediator-article">  Hello. <br><br>  Today we would like to discuss one very important aspect of effective work - reuse. <br><br><h5>  It will, of course, about the code. </h5><br>  Routine, which does not want to write twice, and even more than three times.  Infrastructure, which has to be written from project to project.  Ingenious, which simply expresses a great idea and which sin is not to allow others to use it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Yes, and let's admit - we all love to write ‚Äúframeworks‚Äù, which we use ourselves later and which others use.  This adds a little courage to our daily activities. <br><br>  And here the author finds himself doing what is wrong, starting to describe the situation - everyone already understands what this is about.  And you need to describe the technology and process.  So let's just dwell on an abstract thought, that suddenly there was a lot of code that could be useful to colleagues and it would be good to make it easily accessible.  We also take into account the second, much less pleasant, thought that in ‚Äúmature‚Äù projects you can find a large number of copy-paste code, which significantly decreases maintainability.  Yes, and work on such projects is difficult to call pleasant.  And with this we need to do something. <br><br><h5>  And we decided to do something about it. </h5><br><a name="habracut"></a><br>  The path we have taken was not so difficult, we can advise to repeat it to others, because the time spent pays for itself.  And since at some point this path became interesting and even funny, we decided to share our experience. <br><br><h5>  Well, enough of the preface. </h5><br>  So, today we will tell in detail: <br><ol><li>  How to deploy a corporate nuget-server (we omit the <a href="http://docs.nuget.org/docs/start-here/overview">basics of nuget</a> , assuming that most readers know what it is). </li><li>  How to deploy a corporate symbol-server integrated with nuget. </li><li>  Why a single nuget server is not enough to build an efficient process. </li><li>  We will also designate topics for the second part in advance, which we will be happy to produce if this topic finds its readers: </li><li>  What is SandCastle and what it is eaten with. </li><li>  How to configure continuous integration to automate everything we have done. </li><li>  A few thoughts about the (self) organization. </li></ol><br><br><h5>  Deploy corporate nuget server. </h5><br>  So nuget is great and fun.  This is not just a new tool that increases productivity, it is a new approach, a new way of thinking.  Almost as useful as a healthy diet and morning exercises.  So you need to use. <br><br>  If we are talking about the deployment of a corporate server, then there are two installation options: <br><ol><li>  Simple deployment of tape without UI and buns.  For this option, it is enough to create the MVC application and install the nuget server by downloading the <a href="http://www.nuget.org/packages/NuGet.Server">nuget package</a> (such is the recursion). </li><li>  The second option is created for a little less lazy, but it‚Äôs with UI and buns.  For it, you need to download the <a href="https://github.com/NuGet/NuGetGallery">source</a> and collect them according to the instructions on the same page.  After that, by pressing Ctrl + F5, we should see a (almost) complete analogue of the official tape. </li></ol><br><br><img src="https://habrastorage.org/storage2/798/55a/0a9/79855a0a9f6ce16c8dfd8649ba60e4c2.png"><br><br>  Actually, on this and everything - the process is extremely simple.  However, there are a few things that are not described in the documentation that have appeared in us and that may be useful to others: <br><br>  1. <b>IIS express</b> .  The option of working on IIS express using localdb is difficult to consider as production ready for a number of reasons.  Therefore, we moved our newborn to a full-featured IIS server.  Fortunately, there are no difficulties with this.  Just go to the properties tab of the ‚ÄúWebsite‚Äù project and remove the ‚ÄúUse IIS Express‚Äù checkbox in the ‚ÄúWeb‚Äù section.  Visual Studio will instantly react to such changes - will offer to create a Virtual Directory and change the Connection Strings in the web.config from localdb to SQL express. <br><br><img src="https://habrastorage.org/storage2/98c/049/2c7/98c0492c761a7030b0743f1660a67708.png"><br><br>  2. <b>Database Migrations</b> .  Nuget uses the Entity Framework to access data and actively uses the Database Migrations mechanism.  In the deployment guide there is a step number 4 - creating a database with the help of dancing with sabers around the order of opening tabs in the studio.  In fact, everything is easier.  Simply enter the name of the project in which migrations are stored when updating via the console.  And no dancing: <br><br><img src="https://habrastorage.org/storage2/d6d/151/d15/d6d151d1592ce4e87297718fc683cb17.png"><br><br>  3. <b>Security settings</b> .  The manual does not describe the moments concerning the security settings (although they were in the <a href="http://docs.nuget.org/docs/contribute/setting-up-a-local-gallery">outdated manual</a> ).  Apparently, it is assumed that everything is put unconditional admin and everything will be spinning under his own account.  If this is not the case, then we need: <br><br><ul><li>  a.  Write permissions to the application‚Äôs ‚ÄúAppData‚Äù folder.  There will be nuget-packages.  We give rights to the account under which the AppPool application is running.  In case if in the IIS settings there is an ApplicationPoolIdentity, and not a specific account, we give rights to the IIS_IUSRS group. </li><li>  b.  By the same principles, we grant rights to access the database in SQL. </li><li>  c.  After registration you can give yourself the same admin role.  To do this, after the standard registration through the UI, we insert the entry into the dbo.UserRoles table, having looked at the Id roles in the dbo.Roles table.  After that, at the address ‚Äú&lt;path to server&gt; / admin‚Äù, you will have access to the admin panel with all sorts of buns and bookmarklet <a href="http://getglimpse.com/">glimpse</a> . </li></ul><br><br><img src="https://habrastorage.org/storage2/25e/e5b/3d6/25ee5b3d6d904ec1a87064dc26900484.png"><br><br>  4. <b>GalleryOwner</b> .  It makes sense to change to the actual settings of the item ‚ÄúGallery.GalleryOwner‚Äù in the web.config.  From him will be sent letters at registration.  And you can completely disable this newsletter.  And be sure to list the current SiteRoot. <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Gallery.LuceneIndexLocation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AppData"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Gallery.Environment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Development"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Gallery.SiteRoot"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://your-server-name/"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Gallery.GalleryOwner"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%username% &lt;%usermail%&gt;"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Gallery.ConfirmEmailAddresses"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Gallery.HasWorker"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  5. <b>In the stats.js file there is a getStats function</b> .  At the time of this writing, invoking it resulted in an error on the main page. <br><br><img src="https://habrastorage.org/storage2/1be/3cb/8a8/1be3cb8a88b310780d6cce4fb2e11971.png"><br><br>  The reason is that in the local version of nuget, statistics are <a href="http://blog.nuget.org/20130226/Introducing-Package-Statistics.html">disabled</a> .  At the moment it is intended only for the cloud version. <br><br>  You can create your own implementation of IStatisticsService or simply disable the call.  We chose the second path. <br><br>  On this, in fact, everything.  Now we have a nuget server with a gallery and <a href="http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-package">packages</a> . <br><br>  But what if in our package (dll-ku from it) the bug crept in?  Or does the developer just want to understand what our ‚ÄúDoStuff‚Äù function is doing?  Obviously, the library needs debugging.  But it's not so easy when we only have the dll at our disposal.  That is why nuget can build not only library packages, but also <a href="http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-symbol-package">symbol packages</a> . <br><br><h5>  And we are going to learn to collect our own symbol server. </h5><br>  As a solution for debugging support, we decided to use <a href="http://www.symbolsource.org/Public">SymbolSource</a> , because it is so good friends with nuget that it supports it as a <a href="http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-symbol-package">default</a> symbol-server. <br><br>  Here we make a small digression and tell you how it all works. <br><br>  When creating a nuget package using the nuget pack command, we can specify the ‚Äú‚ÄìSymbols‚Äù flag.  As a result, nuget creates, in addition to the standard library package, the &lt;package_name&gt; .symbols.nupkg package, which will contain the pdb file and the sources.  Then this package can be placed on the SymbolSource server, which will index the pdb file and place the project sources in its internal directory.  Next, Visual Studio <a href="http://www.symbolsource.org/Public/Home/VisualStudio">configures access to the symbol server</a> and, if necessary, it downloads the pdb file and sources from the server.  This is how debugging becomes possible. <br><br>  But, if the library we decided not to add to the public feed, then there‚Äôs nothing to say about the source code.  In principle, SymbolSource makes it possible to start a private tape.  But it also supports the Community version, which allows you to deploy your internal server.  For a variety of reasons, we decided to go the last way. <br><br><h5>  And then the adventure began ... </h5><br>  As planned by the authors, deploying your symbol server is almost as simple as deploying your nuget feed ‚Äî creating an MVC application, downloading the <a href="http://www.nuget.org/packages/SymbolSource.Server.Basic/">nuget-package</a> , giving rights to the ‚ÄúApp_Data‚Äù and ‚ÄúData‚Äù folders ‚Äî everything works. <br><br>  Oh yes, there is one additional requirement - you need to put the <a href="http://msdn.microsoft.com/en-us/windows/hardware/gg463009">Debugging Tools for Windows</a> and set the path to them in the web.config: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SrcSrvPath"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"C:\Program Files\Debugging Tools for Windows (x64)\srcsrv"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">appSettings</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Actually, that's what we did - we downloaded version 1.3.2 of SymbolServer, set it up, set it up, saw the magic screen. <br><br><img src="https://habrastorage.org/storage2/38c/996/164/38c9961648d0228266c932528c96eecd.png"><br><br>  Diagnostics launched - all is well.  We set up Visual Studio exactly as <a href="http://www.symbolsource.org/Public/Home/VisualStudio">instructed</a> . <br><br><h5>  But Debug doesn't work ... </h5><br>  The problem was found quickly enough - the service did not save the source code in the ‚ÄúData‚Äù directory when loading the symbol-package.  Fiddling with the IIS settings for a while, we realized that the problem was different, and started debugging. <br><br><h5>  Exactly.  Debugging the SymbolSource server using the SymbolSource server. </h5><br>  The cause of the problem was also found quickly enough, and at first it seemed even ridiculous.  In the ManagedSourceExtractor class, there is an IsTemporaryCompilerFile method that returns, as the name implies, a sign if a certain file is a temporary compiler file.  And in this method there was an extra logical negation operator.  That is, this method reported that tempo files were just those that were not.  So one extra character broke the entire server. <br><br>  Well, what can you do ... They laughed, forked the <a href="https://github.com/SymbolSource/SymbolSource.Community">source code</a> , corrected it, got ready to do a pull request.  And here we find that a similar request <a href="https://github.com/SymbolSource/SymbolSource.Community/pull/22">already exists</a> , and it has been created for a long time.  Yes, and the package version 1.3.2 has been released for two months already, but the version of the package with fix has not been released yet.  This was not so funny.  More precisely, it is not funny at all. <br><br>  For a while, we even thought about whether we should use this server at all or better search for another one.  But the positive previous experience of using ... And the developers of nuget made it the default server, it means they trust.  And the package version 1.3.1 works fine.  As a result, we decided to run everything on the corrected source code.  For this, we additionally copied the settings from ‚ÄúWeb.config.transform‚Äù into ‚ÄúWeb.config‚Äù, since the local assembly does not perform transform: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">location</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WinDbg/pdbsrc"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.webServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">handlers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">clear</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Deny"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">verb</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*.config"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.HttpForbiddenHandler"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Allow"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">verb</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"GET,HEAD"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"System.Web.StaticFileHandler"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">handlers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">requestFiltering</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fileExtensions</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">allowUnlisted</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">clear</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fileExtensions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">requestFiltering</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">security</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.webServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">location</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Now it is ready and also works as it should.  And then it is time to think about <br><br><h5>  Why one nuget-server is not enough to build an effective process (beta). </h5><br>  But it is not enough for a very simple reason: nuget, as it is, is an accessible server for the entire company. <br><br>  Therefore, it is impossible to put packages into it, which may be unstable.  But when the development of final projects required changes to the assemblies hosted in nuget, then to make changes so that it worked immediately, the task from the category ‚Äúwrite code without bugs‚Äù. <br><br>  You can find a lot of different techniques and squats in order to somehow work with one server.  For example, replace the dll-ki pens in the ‚Äúpackages‚Äù folder of the final project, and publish to nuget only when everything is ready.  But we do it all to make life easier, and not vice versa.  Therefore, we decided to approach the issue more thoroughly.  A little thought, we came up with something. <br><br>  Written below is a beta version of the process that we are still experiencing and comprehending.  Therefore, it would be very nice to hear the views of readers in the comments. <br><br>  So, we decided that we would have three nuget tapes. <br><ol><li>  <b>Local feed</b> .  In fact, this is just a network folder (in Visual Studio, when setting up sources, you can specify not only the server address, but also the UNC path to the folder).  Packs are assembled on this tape for every commit in VCS.  No one except the developers reusable code source for this tape does not configure. </li><li>  <b>Test feed</b> .  This role quite logically falls on the SymbolSource server, which has its own tape (just a tape, not a gallery) for packages, where the usual nuget-package is automatically placed when the symbol-package is published.  The publication in this tape is done when the changes are made to the base code and you can start using it.  The source for this tape is for all the developers of the company and for the build-machines that assemble test versions of the final products. </li><li>  <b>Server release packages</b> .  This server was the one that we deployed at the beginning of the article - beautiful, with UI and other buns.  The most important bun is the ApiKey requirement.  The local tape does not require it, just as the SymbolSource tape (more precisely, SymbolSource requires, but does not verify).  And there they are not needed.  Here everything is more serious, so it makes sense to make it so that not everyone can publish.  And if someone could, it would be clear who it is.  The publication on this server goes only when the basic code is tested both by itself and in work with end products.  Source for this server is configured in all developers, build-machines, collecting test versions of the final products, build-machines, collecting release versions of the final products. </li></ol><br>  It turns out, on the one hand, that build machines that compile release versions of final products <b>will never</b> build a project if it refers to a test version of the package. <br><br>  On the other hand, the order in which the servers are specified in the Package Sources settings in Visual Studio (Tools-&gt; Library Package Manager-&gt; Package Manager Settings) sets the priority for downloading packages.  Therefore, for example, developers of the base code have access to all three tapes and the order in the settings is set as release feed, test feed, local feed. <br><br>  In Visual Studio, it looks like this: <br><br><img src="https://habrastorage.org/storage2/c7e/504/d71/c7e504d713aa097b9c275cbc04293b7b.png"><br><br>  By the way, it is here that the argument in favor of local server deployment becomes quite weighty - independence from access to the Internet and greater speed when working in a local network. <br><br>  ‚ÄúWhat if one of the servers fell?‚Äù You ask.  Well, it does not matter.  After all, the build process ‚Äúframework‚Äù is one for all tapes.  That is, if the package version 1.2.3.4 is declared release, then it lies in all three tapes.  And access to it, for example, the developer will always be. <br><br>  On the one hand, this process is not very simple, but on the other hand, it turned out to be very natural, so it‚Äôs not often necessary to think about its complexity - it just falls on the standard work flow. <br><br>  Well, thought out.  Now you can go back to technology and think about Continuous Integration, which automates the whole process. <br><br><h5>  But the article has already dragged on. </h5><br><br>  Therefore, we will say goodbye and leave some material for the second part.  And here we would like to appeal to our readers.  If the topic seemed interesting to you - let us understand it, leave comments.  They will help us to make the second part more useful and informative, as well as motivate for its early release. <br><br>  Thank you for your attention. <br><br>  <b>UPD:</b> as it usually happens, exactly the next day after the article was added, the <a href="http://www.nuget.org/packages/SymbolSource.Server.Basic/">SymbolSource.Server.Basic update</a> (version 1.3.3) was updated, <a href="http://www.nuget.org/packages/SymbolSource.Server.Basic/">fixing the</a> bug mentioned in the section on deploying the symbol-server. </div><p>Source: <a href="https://habr.com/ru/post/191406/">https://habr.com/ru/post/191406/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../191384/index.html">Find and neutralize. How to reveal the location of a mobile subscriber</a></li>
<li><a href="../191386/index.html">Tor offer to embed Firefox into browser as standard</a></li>
<li><a href="../191392/index.html">Mail.ru launched its cloud, the first users - up to 100 GB for free</a></li>
<li><a href="../191398/index.html">One day left for the special offer to register in the Windows Phone Store</a></li>
<li><a href="../191404/index.html">EU Framework Program "Horizon 2020"</a></li>
<li><a href="../191408/index.html">Presentation of Microsoft DOS 4.01 in the USSR (1990), Bill Gates</a></li>
<li><a href="../191414/index.html">Adblock collects money for adblock ads</a></li>
<li><a href="../191416/index.html">Is Snowden's international popularity a myth or a reality? Global Social Media Monitoring Results</a></li>
<li><a href="../191418/index.html">Reed-Solomon codes. Simple example</a></li>
<li><a href="../191420/index.html">POS lending online</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>