<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calculation of binomial coefficients using Fourier transforms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When solving problems of combinatorics, it is often necessary to calculate the binomial coefficients. Bin Newton, i.e. decomposition  also uses binomi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calculation of binomial coefficients using Fourier transforms</h1><div class="post__text post__text-html js-mediator-article">  When solving problems of combinatorics, it is often necessary to calculate the binomial coefficients.  Bin Newton, i.e.  decomposition <img src="https://habrastorage.org/getpro/habr/post_images/fad/203/7ac/fad2037acc6dff013bb9e1b5307eb82c.png" alt="image">  also uses binomial coefficients.  For their calculation, you can use the formula expressing the binomial coefficient through factorials: <img src="https://habrastorage.org/getpro/habr/post_images/01d/df4/164/01ddf4164554f2f65f67842dd8ea7dbf.png" alt="image">  or use the recurrence formula: <img src="https://habrastorage.org/getpro/habr/post_images/3f1/8bd/ee1/3f18bdee1558db7cb7b6b6c3458cda5f.png" alt="image">  From the Newton binomial and the recurrent formula, it is clear that the binomial coefficients are integers. <br><br>  One of the methods to significantly reduce the number of calculations is the use of Fourier transforms and discrete Fourier transforms. <br><br>  The presence of a large number of libraries that implement Fourier transforms (in all sorts of fast versions) makes the implementation of algorithms not a very difficult task for programming. <br>  The implemented algorithms are part of the open source FFTTools library.  Internet address: <a href="https://github.com/dprotopopov/FFTTools">github.com/dprotopopov/FFTTools</a> <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The Fourier transform of the function f by a real variable is integral and is given by the following formula: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a78/401/195/a784011956b6daeb35c695fc5036eb50.png" alt="Fourier transform"><br><br>  Different sources may give definitions that differ from the above given by choosing the coefficient before the integral, as well as the sign "-" in the exponent.  But all the properties will be the same, although the form of some formulas may change. <br><br>  In addition, there are various generalizations of this concept. <br><br><h2>  Discrete Fourier Transform </h2><br>  Discrete Fourier transform (in the English-language DFT literature, Discrete Fourier Transform) is one of the Fourier transforms that are widely used in digital signal processing algorithms (its modifications are used in audio compression in MP3, image compression in JPEG, etc.), as well as in other areas associated with the analysis of frequencies in a discrete (for example, digitized analog) signal.  The discrete Fourier transform requires a discrete function as an input.  Such functions are often created by sampling (sampling values ‚Äã‚Äãfrom continuous functions).  Discrete Fourier transforms help solve partial differential equations and perform operations such as convolutions.  Discrete Fourier transforms are also actively used in statistics when analyzing time series.  There are multidimensional discrete Fourier transforms. <br><br><h2>  Discrete Transform Formulas </h2><br>  Direct conversion: <br><br><img src="https://habrastorage.org/getpro/habr/comment_images/0fe/66e/fd0/0fe66efd0c6151565e3a6a3bc3c5a888.png" alt="image"><br><br>  Inverse transform: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/de5/663/408/de56634082741492c8b949377fc3288c.png" alt="image"><br><br>  The discrete Fourier transform is a linear transform that translates a vector of time samples into a vector of spectral samples of the same length.  Thus, the transformation can be implemented as a multiplication of a symmetric square matrix by a vector: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7d/125/fae/c7d125fae17a50b837e5e3e382d230fe.png" alt="image"><br><br><h2>  Convolution of two functions </h2><br>  According to the definition, the convolution of two functions F and G is the function FG: <br><blockquote>  FxG (t) = SUM F (i) * G (j) | i + j = t </blockquote><br><br><h2>  Fourier Transforms for Convolution Calculation </h2><br>  One of the remarkable properties of Fourier transforms is the ability to quickly calculate the correlation of two functions defined, either on a real argument (using the classical formula) or on a finite ring (using discrete transformations). <br><br>  And although such properties are inherent in many linear transformations, for practical use, to calculate the convolution operation, according to our definition, the formula is used <br><blockquote>  FxG = BFT (FFT (F) * FFT (G)) </blockquote><br>  Where <br><ul><li>  FFT - direct Fourier transform operation </li><li>  BFT is the operation of the inverse Fourier transform </li></ul><br>  It is rather easy to verify the equality of equality by explicitly substituting into formulas of Fourier transforms and reducing the resulting formulas <br><br><h2>  Binomial coefficients </h2><br>  Consider the polynomial F (x) = 1 + x and its convolution with itself n times <br>  Fx..xF = SUM C (i, n-1) * x ^ i = BFT (FFT (F) * ... * FFT (F)) = BFT (FFT (F) ^ (n-1)) <br>  That is, the binomial coefficients C (i, n-1) can be obtained from the values ‚Äã‚Äãof the coefficients of the polynomial (1 + x) ^ (n-1) <br><br><h2>  We program: </h2><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Drawing; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Numerics; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">FFTTools</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BinomialBuilder</span></span> : <span class="hljs-title"><span class="hljs-title">BuilderBase</span></span>, <span class="hljs-title"><span class="hljs-title">IBuilder</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Performs application-defined tasks associated with freeing, releasing, or resetting unmanaged resources. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public void Dispose() { } public static void GetLongs(long[] array, long x = 1) { var n = array.Length - 1; if (array.Length &gt; 0) array[0] = 1; for (var i = 0; i </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt; n; i++) array[i + 1] = x*array[i]*(n - i)/(i + 1); } public static void GetDoubles(double[] array, double x = 1.0) { var complex = new Complex[array.Length]; if (array.Length &gt;</span></span></span><span class="hljs-comment"> 0) complex[0] = Complex.One; if (array.Length &gt; 1) complex[1] = x; if (array.Length &gt; 0) { Fourier(complex, FourierDirection.Forward); complex = complex.Select( value =&gt; Complex.Pow(value, array.Length - 1)/array.Length).ToArray(); Fourier(complex, FourierDirection.Backward); } var index = 0; foreach (var value in complex) array[index++] = value.Real; } public Bitmap ToBitmap(Bitmap source) { throw new NotImplementedException(); } } }</span></span></code> </pre> <br><br><h2>  Checking: </h2><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.TestTools.UnitTesting; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">FFTTools.UnitTest</span></span> { [TestClass] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BinomialUnitTest</span></span> { [TestMethod] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BinomialTestMethod</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doubles = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[count]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> longs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>[count]; BinomialBuilder.GetLongs(longs); BinomialBuilder.GetDoubles(doubles); Console.WriteLine( <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Join(Environment.NewLine, longs.Zip(doubles, (x, y) =&gt; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0} - {1} = {2}"</span></span>, x, y, x - y))) + Environment.NewLine); Assert.IsTrue(doubles.Zip(longs, (x, y) =&gt; x - y).All(x =&gt; Math.Abs(x) &lt; <span class="hljs-number"><span class="hljs-number">0.001</span></span>)); } } }</code> </pre><br><br><h2>  What for? </h2><br>  When calculating using Pascal's triangle, laboriousness has the estimate O (n ^ 2). <br>  When calculating with the help of fast Fourier transforms, laboriousness has an estimate of O (n * log n). <br><br><h2>  Note: </h2><br>  The article borrows fragments from the article <a href="http://habrahabr.ru/post/274689/">Calculation of binomial coefficients in C (C ++)</a> <br><br>  PS <br>  The complexity of the calculation of binomial coefficients can be reduced to O (n): <br>  Cn [0] = 1 <br>  Cn [i + 1] = Cn [i] * (ni) / (i + 1) <br>  Evidence: <br>  Cn [i] * (ni) / (i + 1) = n! / ((Ni)! I!) * (Ni) / (i + 1) = n! / ((Ni-1)! (I + 1)!) = Cn [i + 1] </div><p>Source: <a href="https://habr.com/ru/post/274729/">https://habr.com/ru/post/274729/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../274719/index.html">Parametric design. Next half step after Design in browser</a></li>
<li><a href="../274721/index.html">BEM obsession. Consequence of parametric design</a></li>
<li><a href="../274723/index.html">[Translation] Associative arrays in the D language</a></li>
<li><a href="../274725/index.html">Setting the problem of computer vision</a></li>
<li><a href="../274727/index.html">Critical errors in the design of process control systems and PLC programming</a></li>
<li><a href="../274731/index.html">Easy setup Asterisk + Fail2Ban</a></li>
<li><a href="../274733/index.html">Using LSM engine from SQLite 4 as a separate NoSQL database using Python</a></li>
<li><a href="../274735/index.html">How much does it cost: Gigabyte traffic in Africa</a></li>
<li><a href="../274739/index.html">Translation: The tragedy of common lisp</a></li>
<li><a href="../274741/index.html">Steam CEG from Valve and what it eats. Introduction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>