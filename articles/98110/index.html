<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attack on the browser: confrontation of armor and shell</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the modern world it is difficult to find a person using the Internet, but not installing additional extensions for his browser. Extensions like Fla...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attack on the browser: confrontation of armor and shell</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/0d0/a12/bdb/0d0a12bdb29f850d3d9f8bb99a84ca87.png" alt="image"><br><br>  In the modern world it is difficult to find a person using the Internet, but not installing additional extensions for his browser.  Extensions like Flash are installed by the vast majority of users.  But it was the emergence of such plug-ins that influenced the landscape change in modern exploit engineering.  Now, user-side security cannot be controlled solely by browser developers.  No less important is the security of each of the installed plugins, because attackers can use it to inject malicious code into the system.  For example, the appearance of vulnerabilities in the products of the notorious Adobe company entails an increase in the number of exploits aimed specifically at these vulnerabilities. <a name="habracut"></a><br>  Moreover, the inoperative closure of these very vulnerabilities by Adobe gives attackers a sufficiently large time window for successful attacks.  There is no need to go far, and a <a href="http://habrahabr.ru/company/eset/blog/96879/">vivid example of</a> this is CVE-2010-1297, when this hole was covered only <a href="http://www.adobe.com/support/security/bulletins/apsb10-15.html">on June 29</a> , and the vulnerability was made public on June 4.  It turns out the window for more than three weeks for successful zero-day attacks.  From the beginning of this year, we have noted a strong increase in the flow of exploits targeting Adobe products. <br>  The popularity of exploit for Adobe and those able to bypass DEP and ASLR is greatly increasing.  The most interesting thing is that mechanisms of automatic checking of the site‚Äôs blacklisting of popular reputation systems began to appear in some of the hotpacks. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f92/ec4/849/f92ec4849e58fe76da4da4722a885375.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Cybercriminals use in their creation the polymorphic obfuscation mechanisms of the exploit, which allows either for each visitor or at some time intervals to modify the exploit code without changing its functionality.  Such functionality is necessary to counter signature-based detection and rather effectively knocks down primitive detection methods.  Recently, a functional has appeared on countering public sandboxes and automatic analysis tools, such as: <a href="http://wepawet.iseclab.org/index.php">Wepawet</a> , <a href="http://jsunpack.jeek.org/dec/go">Jsunpack,</a> and some well-known methods of automatic unpacking of obfuscated JavaScript programs. <br>  They drive traffic to the site with the exploit pack also automatically, there can be both a direct redirect and a whole chain.  Cybercriminals selling this kind of traffic are, for the most part, affiliate programs that own a botnet from infected websites.  The redirect is usually performed using a simple iframe injection. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9db/844/271/9db844271129103bba6afa347ee63082.png" alt="image"><br><br>  In recent years, there has been a clear focus on client-side attacks using exploits.  In principle, many different mechanisms have already been introduced to counter them at the operating system level.  It is thanks to these mechanisms that the threshold for mastery for the person developing the exploit has greatly increased.  And now let's look (at a glance, of course :)) on those techniques that are used by attackers in modern exploit engineering. <br><br>  <b>DEP and other ASLR</b> <br><br>  Bypassing DEP has long ceased to be a problem, and on this topic the first open publications began to appear several years ago.  Nevertheless, over time, the situation was complicated by the emergence of technology permanent DEP.  The essence of this technology lies in the fact that the process at startup itself sets its own DEP by calling the function <a href="http://msdn.microsoft.com/en-us/library/bb736299(VS.85).aspx"><i>SetProcessDEPPolicy ()</i></a> .  DEP cannot be turned off during execution, since  This raises the problem of calling <a href="http://www.securitylab.ru/analytics/263899.php"><i>NtSetInformationProcess ()</i></a> , which is impossible.  By default, in modern browsers (on XP SP3 and above), as we see, this mechanism is used, which complicates the lives of modern developers of exploits.  This is good news for us as developers of security software. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/47b/176/188/47b176188f78141062f38aaa2a2e784e.png" alt="image"><br><br>  But, in spite of the provided countermeasure mechanisms, not all mass software developers take them equally seriously.  Let's see how things are in dynamics. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/998/6de/6ed/9986de6ed92c71d21ed98f609439ec83.png" alt="image"><br><br>  Despite the obvious progress compared with 2008, we still see that, for example, ASLR is used.  And for Adobe products, there are bypass mechanisms, which is why the options for supporting defense mechanisms with an asterisk stand with the table.  This data is taken from Secunia‚Äôs recent <a href="http://secunia.com/blog/105/">‚ÄúDEP / ASLR Neglected in Popular Programs‚Äù</a> report.  ASLR is a real problem for intruders only if it is used everywhere. <br>  Now let's talk a little about the workarounds and effectiveness of the above protection technologies, which are now the most popular. <br><br>  <b>Heap spraying</b> <br><br>  Despite the obvious progress in the mechanisms of opposition from the operating system, researchers in both white and black hats do not cease to look for ways to circumvent them.  After all, the well-known methods of operation with overwriting the return address and the capture of the SEH handler stopped working and new equipment was needed.  <a href="http://www.phreedom.org/about/">Aleksandr Sotirov</a> can rightly be considered an evangelist of exploitation methods with the help of JIT spraying, who was one of the first to discuss this topic in detail and talk about various methods of exploitation using this technique. <br>  If you try to identify the technology of attack JIT spraying in general, it will look like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/813/d4a/e98/813d4ae9837334f09b7b2df3dfcd78a8.png" alt="image"><br><br>  And at the system level like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b4d/5a4/427/b4d5a4427c4a1d7ad327e893ca6c66a2.png" alt="image"><br><br>  Below we provide a summary table of attacks using this technique and ways to counter them: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f66/f72/72b/f66f7272bde6c5110d9da3aae233e013.png" alt="image"><br><br>  Recently, when using JIT spraying, shell-code using return-oriented programming is often encountered.  In the exploits for CVE-2010-1297, this technique is actively used, although the use of this technique entails the application of a multi-level architecture for the shell code. <br><br>  <b>ROP</b> <br><br>  Return-oriented programming (ROP) or simply ROP is primarily aimed at enabling circumvention of protective mechanisms, such as non-executable memory segments.  ROP is, of course, a new milestone in exploit engineering, but the prerequisites for its appearance have been noticed long ago.  An interesting scheme of the evolution of these methods was taken from the <a href="http://blog.zynamics.com/2010/03/12/a-gentle-introduction-to-return-oriented-programming/">article ‚ÄúA gentle introduction to return-oriented programming‚Äù</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f7c/890/b26/f7c890b264bb0e21a1c57e9a0f70fef8.png" alt="image"><br><br>  Using the ROP technique requires the researcher to have a sufficiently high level of knowledge and training, which increases the entry threshold for people who want to understand this.  Debugging such a shellcode also takes a lot of time. <br>  Everything described above about the complexity of development does not mean that we can rejoice, and soon we will all fall into nirvana.  No, it is not, rather, it means that further we will have an interesting development of these techniques and, of course, the emergence of new ones. </div><p>Source: <a href="https://habr.com/ru/post/98110/">https://habr.com/ru/post/98110/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../98096/index.html">The head of Google does not deny creating your own social network</a></li>
<li><a href="../98098/index.html">Vulnerability on the virtual hosting infobox</a></li>
<li><a href="../98100/index.html">Additional 24 hours per day. Games with time</a></li>
<li><a href="../98101/index.html">Transferring the equipment of the hosting company ‚ÄúLiderhost‚Äù to the site of the hosting company ‚ÄúLogol‚Äù</a></li>
<li><a href="../98105/index.html">Pioneer ePad A10 - Windows 7 based tablet</a></li>
<li><a href="../98111/index.html">The problem with a drop in the signal level in the iPhone 4 while holding it in your hand is solved</a></li>
<li><a href="../98112/index.html">Overview of banks and Internet banking systems</a></li>
<li><a href="../98115/index.html">Canobuvosti, 46th edition</a></li>
<li><a href="../98116/index.html">Step out of the sandbox</a></li>
<li><a href="../98117/index.html">Review of HD-player Cowon V5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>