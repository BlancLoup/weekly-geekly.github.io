<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The story of one hacking</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I am the administrator of one not very large site. I want to tell an interesting story. 

 Yesterday our site was infected. The hacker, using the expl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The story of one hacking</h1><div class="post__text post__text-html js-mediator-article">  I am the administrator of one not very large site.  I want to tell an interesting story. <br><br>  Yesterday our site was infected.  The hacker, using the exploit, uploaded the resident script and wrote a code to each executable file.  The problem was in the Coppermine gallery of the old version - a leaky script (mea culpa, did not follow).  Hacker used the classic <a href="http://en.wikipedia.org/wiki/Google_hacking">google hacking</a> to find a gallery. <br><br>  The sequence of actions is very thought out and it is difficult to prove the crime of a hacker.  From the German IP (217.20.118.150, apparently rented server) the version of the gallery was probed, then the script loader was poured through the hole in the script.  From the same German IP, this script is requested via HTTP, which leads to its execution on the side of our site.  The executing script loader sucks the resident script from IP server 78.157.140.3 (IP address is accessed) copper.txt, packs / writes it into one of the folders where writing is allowed (already in php format) and writes in the first line of all php files its calling code (also packed).  After this, the script loader is self-obliterated (I don‚Äôt know if this script is visible from the Internet on the German server, there is no copy left on our server).  Further, when opening any page where php is used, a resident script is launched that requests the executable code from the server at nomcen.biz (the domain now corresponds to the same IP 78.157.140.3).  In the script script, there was a syntax error in each file, so the site simply gave out blank pages (the error message was eaten as a result of using ob_start).  Had it not been the case, the resident script would quietly work out the work that the hacker needed. <br>  And now the most interesting thing: I don‚Äôt have enough evidence from the German server (there are only two entries in the log, the script itself is unknown and where to look for it on the network is of course not known).  With IP 78.157.140.3, the executable code was taken exactly by our server (the script loader worked).  Appeal to the domain was also a script working on our site (the work of the resident script).  The domain registrar accepts claims only about spam; they recommend contacting the hosting provider about the distribution of exploits. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Total: we see hacker technology with a certain degree of protection against criminal prosecution. <br><br>  PS: This text does not claim to be new and is not written for instruction.  The main idea with which he wrote "let him lie down here, maybe someone will be interested." </div><p>Source: <a href="https://habr.com/ru/post/40965/">https://habr.com/ru/post/40965/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../40953/index.html">Building a semantic web using .NET</a></li>
<li><a href="../40955/index.html">Microblogging client</a></li>
<li><a href="../40958/index.html">New MacBook Pro</a></li>
<li><a href="../40961/index.html">New profile page in LiveJournal</a></li>
<li><a href="../40962/index.html">Federation XMPP - new site, getting SSL certificates made easy</a></li>
<li><a href="../40966/index.html">BullDoc 0.31 Released</a></li>
<li><a href="../40968/index.html">Project 10 ^ 100</a></li>
<li><a href="../40970/index.html">Winning startups at the 2008 Seedcamp competition</a></li>
<li><a href="../40971/index.html">2d-code reader from ScanLife on Samsung phones</a></li>
<li><a href="../40972/index.html">My friend developer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>