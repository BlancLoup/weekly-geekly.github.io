<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cordova integration into native iOS project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing a small series of articles " Crosswalk Project - replacement of Android WebView ", it makes sense to make out a similar task for iOS. This ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cordova integration into native iOS project</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/43a/d27/1be/43ad271be1a348e3b686b30c8833e209.png" alt="image"><br><br>  Continuing a small series of articles " <a href="https://habrahabr.ru/post/308538">Crosswalk Project - replacement of Android WebView</a> ", it makes sense to make out a similar task for iOS.  This time the Cordova project was chosen as the basis for integration, since  It has more functionality and in this case is better suited for the task. <br><br>  Both Cordova and Crosswalk solutions are based on WKWebView in their version for iOS.  Therefore, in this case, they are not a direct replacement for the system WebView, but only expand it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The target language of the demo project is Swift, but for an Objective-C project everything will be the same.  It is not necessary only to perform the last step in adapting Cordova for use with Swift. <br><a name="habracut"></a><br>  <b>NB!</b>  For Crosswalk, there is a simple <a href="https://crosswalk-project.org/documentation/ios/quick_start_guide.html">integration guide</a> using Cocoa Pods and there is support for the main <a href="https://crosswalk-project.org/documentation/ios/cordova_plugin_support.html">Cordova plugins</a> that can be expanded. <br><br>  There are 2 options for embedding Cordova into your application: <br><br><ol><li>  Manual Cordova Embedding </li><li>  Add the necessary components through Cocoa Pods. </li></ol><br>  <b>NB!</b>  In fact, there is 1 more simple option.  After setting up the environment for Cordova, you will get a working Xcode project that can be used separately from Cordova for further development.  Just keep in mind that this project is on Objective-C. <br><br><h2>  Manual Cordova Embedding </h2><br>  I will consider the first option first and add Cordova with the necessary components manually.  This option is a bit more complicated, but more flexible and allows you to use the latest versions of cordova-ios and plug-ins, regardless of the creators of the pods. <br><br>  Software versions used: <br><br><ul><li>  Xcode 8.3.2, Swift 3.1 </li><li>  Cordova 7.0.1, <a href="http://cordova.apache.org/announcements/2017/04/26/ios-release.html">Cordova iOS 4.4.0</a> </li><li>  MacPorts 2.4.1 </li><li>  npm 4.6.1 </li></ul><br><h3>  Setting up the environment </h3><br>  To implement the 1st option, you must first install the Cordova project itself and the necessary utilities.  The installation process is quite simple and is described in detail in the <a href="http://cordova.apache.org/">Cordova documentation</a> ; I will only focus on the necessary steps for creating a demo project. <br><br>  <b>1. Install the npm package manager</b> , with which we will later install Cordova and the necessary plug-ins (I used MacPorts to install npm): <br><br><pre><code class="bash hljs">sudo port install npm4</code> </pre> <br>  <b>2. Install Cordova directly</b> : <br><br><pre> <code class="bash hljs">sudo npm install -g cordova</code> </pre> <br>  Similarly, you can install only cordova-ios: <br><br><pre> <code class="bash hljs">sudo npm install -g cordova-ios</code> </pre> <br>  This can be useful if you do not plan to work with other platforms.  However, in this case it will be slightly less convenient to use <a href="http://cordova.apache.org/docs/en/latest/guide/platforms/ios/index.html">commands in the console</a> .  For example, you will need to use: <br><br><pre> <code class="bash hljs">cordova-ios/bin/create</code> </pre> <br>  with full path instead of short command: <br><br><pre> <code class="bash hljs">cordova create</code> </pre> <br>  NB!  All packages installed using npm will be located here: <i>/ opt / local / lib / node_modules /</i> . <br><br>  <b>3. Next, create a project Cordova</b> , go to its folder and <b>add the target platform iOS</b> : <br><br><pre> <code class="bash hljs">cordova create cordova_full <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> cordova_full/ cordova platform add ios</code> </pre> <br>  The files we need will be located in the cordova_full / platforms / ios / folder.  We will get a similar set with minimal differences if we use the cordova-ios package directly. <br><br>  <b>NB!</b>  When creating a project, you can specify the name of the application and the bundle identifier.  See the Cordova documentation for details. <br><br>  <b>4. Additionally, you can install the plugman utility for working with Cordova plugins</b> : <br><br><pre> <code class="bash hljs">sudo npm install -g plugman</code> </pre> <br>  <b>5. We will also install 2 plug-ins for displaying messages in the console and working with the system status bar</b> , they will be useful to us for work.  To do this, go to the folder with resources for ios and execute the following commands: <br><br><pre> <code class="bash hljs">plugman install --platform ios --project . --plugin cordova-plugin-console plugman install --platform ios --project . --plugin cordova-plugin-statusbar</code> </pre> <br>  <b>NB!</b>  For those who want to work with the Ionic Framework toolbar (http://ionicframework.com/) and use its templates, everything looks the same. <br><br><h3>  Project creation </h3><br>  <b>1. The project was based on the standard Tabbed Application template</b> from Xcode.  The created demo project with all resources can be found on <a href="https://github.com/yaroslav-v/cordova-embedded-ios">github</a> . <br><br>  The minimally supported Cordova iOS 4.4.0 version of iOS is 9.0, we choose it for the demo project. <br><br>  <b>2. Transfer to our demo project the necessary resources</b> : <br><br><ul><li>  folder with the project CordovaLib <i>cordova_full / platforms / ios / CordovaLib /</i> </li><li>  folder with installed plug-ins <i>cordova_full / platforms / ios / HelloCordova / Plugins /</i> </li><li>  configuration file Cordova <i>cordova_full / platforms / ios / HelloCordova /config.xml</i> </li><li>  resource folder for the web application <i>cordova_full / platforms / ios / www /</i> </li></ul><br>  <b>NB!</b>  After adding <i>CordovaLib</i> , check in the settings of the main project in the <i>Build Phases ‚Üí Compile Sources</i> tab.  Delete the <i>CordovaLib</i> files from there to avoid conflicts during the build <i>process</i> . <br><br>  <b>NB!</b>  When adding a folder with <i>www /</i> resources, you must select the ‚ÄúCreate folder references‚Äù option so that the resources are located along the standard path for Cordova. <br><br>  <b>3. You need to set up a demo project for correct assembly</b> : <br><br><ul><li>  In Build Settings ‚Üí Other Linker Flags add flag -ObjC </li><li>  In Build Settings ‚Üí Header Search Paths add paths: <br><br><pre> <code class="objectivec hljs"><span class="hljs-string"><span class="hljs-string">"$(TARGET_BUILD_DIR)/usr/local/lib/include"</span></span> <span class="hljs-string"><span class="hljs-string">"$(OBJROOT)/UninstalledProducts/include"</span></span> <span class="hljs-string"><span class="hljs-string">"$(OBJROOT)/UninstalledProducts/$(PLATFORM_NAME)/include"</span></span> <span class="hljs-string"><span class="hljs-string">"$(BUILT_PRODUCTS_DIR)"</span></span></code> </pre> <br></li><li>  in Build Phases ‚Üí Target Dependencies add CordovaLib </li><li>  in Build Phases ‚Üí Link Binaries with Libraries add libCordova.a </li></ul><br>  <b>NB!</b>  Note that you need to add the entire string with quotes. <br><br>  In the Objective-C version, the configuration is complete and the project can be used. <br><br>  <b>4. Adaptation for Swift</b> .  The Cordova iOS project was originally implemented in Objective-C language and at the moment it is not known about the official plans for porting it to Swift.  There is <a href="https://github.com/masahirosuzuka/cordova.swift">an unofficial port</a> , but it is not finished. <br><br>  However, there is no fundamental problem for using Cordova in a Swift project.  <b>You only need to add a Bridging Header</b> to connect the world of Swift and Objective-C. <br><br>  To do this, you need to create a file in the .h file (for example, Bridging-Header.h): <br><br><pre> <code class="objectivec hljs"><span class="hljs-meta"><span class="hljs-meta">#ifndef Bridging_Header_h #define Bridging_Header_h #import </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CDVViewController.h"</span></span></span><span class="hljs-meta"> #endif /* Bridging_Header_h */</span></span></code> </pre> <br>  And add to Build Settings -&gt; Objective-C the Bridging Header path to it: <br><br><pre> <code class="objectivec hljs">CordovaEmbedded/Libraries/Bridging-Header.h</code> </pre> <br>  <b>5. After that we can use Cordova WebView</b> .  For example, inherit from the <i>SecondViewController</i> demo project from <i>CDVViewController</i> instead of <i>UIViewController</i> .  And with a flick of the wrist, our second tab turns into a full-fledged Cordova app. <br><br>  <b>6. A few words about Cordova plugins</b> .  Initially, we connected 2 plugins to the project: <br><br><ul><li>  to display messages in the console </li><li>  to work with the system status bar </li></ul><br>  The first plugin allows us to receive messages in the Xcode console in an adequate form: <br><br><pre> <code class="objectivec hljs">CordovaEmbedded[<span class="hljs-number"><span class="hljs-number">31857</span></span>:<span class="hljs-number"><span class="hljs-number">638683</span></span>] Received Event: deviceready</code> </pre> <br>  The second plugin allows you to configure the status bar - set the style, color, etc. <br><br>  Configuration of plugins is carried out in the <i>config.xml</i> file.  In the project template used, the status bar is initially transparent, using the settings of the plugin, you can change its appearance and get a transparent status bar for the first tab and opaque for the second.  This shows well the performance of the entire integrated system. <br><br><img src="https://habrastorage.org/web/583/551/bc0/583551bc01124e0aaa2028f2c6129445.png"><br><br><h2>  Adding prerequisites through Cocoa Pods </h2><br>  <b>1. To illustrate connecting Cordova through CocoaPods, take the same Tabbed Application project template</b> from Xcode.  The created demo project with all resources can be found on <a href="https://github.com/yaroslav-v/cordova-embedded-ios">github</a> . <br><br>  <b>2. Create a pod file</b> using the <code>pod init</code> command and add pods to it: <br><br><pre> <code class="bash hljs">pod <span class="hljs-string"><span class="hljs-string">'Cordova'</span></span> <span class="hljs-comment"><span class="hljs-comment"># Cordova framework and plugins pod 'CordovaPlugin-console' pod 'cordova-plugin-camera' pod 'cordova-plugin-contacts' pod 'cordova-plugin-device' pod 'cordova-plugin-device-orientation' pod 'cordova-plugin-device-motion' pod 'cordova-plugin-globalization' pod 'cordova-plugin-geolocation' pod 'cordova-plugin-file' pod 'cordova-plugin-media-capture' pod 'cordova-plugin-network-information' pod 'cordova-plugin-splashscreen' pod 'cordova-plugin-inappbrowser' pod 'cordova-plugin-file-transfer' pod 'cordova-plugin-statusbar' pod 'cordova-plugin-vibration' pod 'cordova-plugin-wkwebview-engine' pod 'phonegap-ios-template' # Cordova template</span></span></code> </pre> <br>  <b>NB!</b>  All plugins are added, because  they are used in the <i>phonegap-ios-template</i> resource <i>template</i> .  Practically, you can add only the necessary ones, but then you will need to adjust the <i>config.xml</i> in the template. <br><br>  <b>3. Install the pods</b> with the <code>pod install</code> command and open the resulting <i>.xcworkspace</i> .  <b>Next, you must perform step 4 from the previous section</b> , on the adaptation of the project for use with the Swift language. <br><br>  <b>4. Now there is a problem with the configuration and the project does not find all the necessary headers when building</b> .  This can be solved by adding the path (with the recursive flag) to the <i>Build Settings ‚Üí User Header Search Paths</i> : <br><br><pre> <code class="objectivec hljs"><span class="hljs-string"><span class="hljs-string">"${PODS_ROOT}"</span></span></code> </pre> <br>  <b>5. - 6. To illustrate the health of Cordova, you can repeat steps 5 and 6</b> from the previous section.  Everything works the same way. <br><br><h2>  Conclusions and useful resources </h2><br>  The manual Cordova version is not much more complicated than using Cocoa Pods in this case, but it is more flexible and allows using the latest versions of cordova-ios and plug-ins. <br><br>  But when using Cocoa Pods there are several drawbacks: <br><br><ul><li>  there is no possibility to upgrade to the required version of Cordova iOS or plugin; </li><li>  all the same it is necessary to make a project configuration </li><li>  It is necessary to change the configuration of Cordova in the pod-project. </li></ul><br>  By and large, the main disadvantages are not very good support for pods for Cordova :) <br><br>  In addition, you can study the integration of Cordova WebView into a native iOS project: <br><br><ul><li>  Cordova Documentation: <a href="https://cordova.apache.org/docs/en/latest/guide/platforms/ios/webview.html">Embed Cordova in Native apps ‚Üí iOS WebViews</a> </li><li>  <a href="http://docs.phonegap.com/develop/1-embed-webview/ios/">Phonegap</a> Documentation: <a href="http://docs.phonegap.com/develop/1-embed-webview/ios/">Embedding the Webview</a> </li><li>  <a href="https://github.com/phonegap/phonegap-webview-ios">Repository with pod files</a> for Cordova integration and instructions </li><li>  Created demo projects with all resources can be found on <a href="https://github.com/yaroslav-v/cordova-embedded-ios">github</a> </li></ul><br>  <b>NB!</b>  Please note that the official integration documentation is somewhat outdated and may have extra or missing steps. </div><p>Source: <a href="https://habr.com/ru/post/330508/">https://habr.com/ru/post/330508/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330498/index.html">Yii 1.1.19</a></li>
<li><a href="../330500/index.html">Brocade Ethernet Switches</a></li>
<li><a href="../330502/index.html">awless.io, mighty CLI for AWS</a></li>
<li><a href="../330504/index.html">How I participated in the Angular Attack hackathon, and what came of it</a></li>
<li><a href="../330506/index.html">TSic digital temperature sensor: addresses, passwords, turnout</a></li>
<li><a href="../330510/index.html">Interview with Yakov Shuvaev about a team of engineers, motivation and interviews</a></li>
<li><a href="../330512/index.html">Multiplayer game on Go via telnet</a></li>
<li><a href="../330514/index.html">Why do hackers steal trading algorithms for hedge funds and HFT companies?</a></li>
<li><a href="../330516/index.html">Bank branches of the future and who needs them</a></li>
<li><a href="../330518/index.html">Addition to the analysis of algorithms</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>