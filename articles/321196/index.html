<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cloud Bottlenecks: Pokemon Go and Trivia Crack Stories</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The lesson: "A system that works with two million users will not necessarily be able to cope with ten million." 

 After the release of Pok√©mon Go in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cloud Bottlenecks: Pokemon Go and Trivia Crack Stories</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/f27/111/4c2/f271114c2cb0a260fa57c8a78c1601d1.png" alt="image"><br><br>  <b>The lesson: "A system that works with two million users will not necessarily be able to cope with ten million."</b> <br><br>  After the release of <i>Pok√©mon Go</i> in the USA in July 2016, it became the most popular game in augmented reality at that time.  This product is a multi-year collaboration between game developer Niantic and Google (until Niantic got to its feet, it was an internal Google startup).  Therefore, the Pok√©mon Go infrastructure depended heavily on the cloud platform and Google application services.  (Nintendo and <i>Pok√©mon</i> also took part in creating an exciting gameplay for raising small monsters for mobile platforms.) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This was <a href="http://arstechnica.com/gaming/2016/07/heres-every-opinion-youll-ever-need-about-pokemon-gos-success/">not the first Niantic game in augmented reality</a> .  Previously, the company created <i>Ingress</i> , a game about alien invasion, released in 2013 for Android devices.  But <i>Pok√©mon Go</i> has become a completely different level game - Pokemon has long been a cultural phenomenon.  The game interested the audience, for many years waiting for a mobile game.  Therefore, the number of installations grew rapidly.  For half a day the game took the first position in terms of income on the iPhone.  To some extent, it was <a href="http://www.businessofapps.com/pokemon-go-breaks-daily-active-user-record-mobile-games-u-s/">the world's largest</a> release of a mobile game. <br><a name="habracut"></a><br>  But its success increased the load on the platform: two days after the release, Niantic technical director John Hanke announced that the company was postponing the global release of Pok√©mon Go, which was caused by overloaded servers.  At the same time, <a href="http://arstechnica.com/gaming/2016/07/pokemon-go-on-ios-gets-full-access-to-your-google-account/">confidentiality issues</a> have arisen due to the way Niantic works with Google's identification and location services.  The company had to correct a lot of mistakes, while simultaneously solving problems with server capacities. <br><br>  In theory, the cloud must cope with periods of peak loads, simplifying the management of the application, and the services provided by cloud solution providers should have simplified the development of various mobile applications (not just games).  And the capabilities of the clouds <i>really</i> simplified the use of new features that require large computing powers (such as augmented reality). <br><br>  But, as in the cases with other network platforms of the past, the developers found out that the presence of all these capacities is not important if there is no possibility to connect to them.  The more interactive mobile applications, the more difficult it becomes to exchange data between mobile devices and the cloud infrastructure.  Add a factor of differences in data transfer speeds from telecom operators around the world and get a system in which you need to take into account many parameters to ensure the necessary speed for users. <br><br>  Few applications ‚Äúfly up‚Äù in the same way as Pokemon Go that has become viral on a global scale.  Those developers who want to scale games and applications will find it useful to study how Niantic and other game developers coped with unexpected success.  If hit mobile games can cope with obstacles encountered when testing and debugging the performance of the interaction between devices and the cloud, then corporations are also able to solve problems with unexpected peaks of user activity. <br><br><h2>  We will process all of them </h2><br>  To learn the lessons learned from Pok√©mon Go, Arstechnica recently spoke with Niantic Technical Director Phil Keslin.  We talked about the complex interactions between open-source parts of the Google cloud and internal data. <br><br>  Pok√©mon Go uses Google Compute Engine, its cloud storage and a full stack of networking technologies, including data processing and query infrastructures.  Of course, the game also uses Google Maps to determine the player‚Äôs location.  According to Keslin, all changes in the gameplay AI require that the mobile client make calls to the Niantic data store.  "Each time you change the state of the game - throwing a pokeball, catching a pokemon, or other action, it interacts with the data warehouse." <br><br>  When the first big peak appeared, then, according to Keslin, ‚ÄúGoogle didn‚Äôt even notice, but the game at least doubled the amount of data being processed.‚Äù  However, this did not lead to system overload.  ‚ÄúThe easiest way to say this: we had a forecast of the worst scenario, but the game even surpassed it.‚Äù  On the day of release, there was a real explosion.  ‚ÄúWe found bottlenecks that slowed down performance.  After their elimination we rested against the new bottleneck. ‚Äù <br><br>  Some of the bottlenecks were in the Niantic code, ‚Äúbut we had problems with a couple of open source libraries, which we didn‚Äôt expect - they were the hardest to solve.‚Äù  Overall, Niantic found five or six bottlenecks, and it took one or two days to eliminate each of them. <br><br>  But malfunctions arose from Google.  Pok√©mon Go has problems with cloud infrastructure;  the container engine contained subsystems that were never tested under this load.  There are a couple of problems with the network stack. <br><br>  Removing bottlenecks required a lot of work from a team of five, consisting of Keslin, the team leader and three service engineers.  ‚ÄúIn the first two weeks, we barely slept,‚Äù says Keslin.  "The guys from Google, too, were laid out in full." <br><br>  Another factor affecting performance in different regions, according to Keslin, was the differences between mobile operators in different parts of the world.  ‚ÄúWe designed Pok√©mon Go so that the game could work in mobile devices with low bandwidth.  The problems that arose were more concerned with the marketing programs of telecom operators. ‚Äù  For example, a large mobile operator in the Philippines provided all its subscribers with free access to Pok√©mon Go, so Niantic needed to ensure that users were turned on and turned off after the promotion was completed. <br><br>  Despite the initial chaos, Keslin said that Niantic did not have to change the architecture of Pok√©mon Go after the game was released.  (The company continues to streamline the application and is preparing for the release of the second generation Pok√©mon Go, which, it hopes, will give the game a second wind after the Pok√©man wave has subsided.)  ‚ÄúThe core of the system will remain the same, we just add a new gameplay.  We were lucky that we managed to create a scalable system, we did not test it.  Fortunately, the created architecture reliably scales. ‚Äù <br><br>  What can Keslin advise other developers seeking to create a new phenomenon of augmented reality?  ‚ÄúThink about scaling from the start.  Our game development team focused on performance.  Thanks to this, we were able to maximize performance at low cost, and were able to scale the system. ‚Äù <br><br><h2>  Addicted to <i>Trivia Crack</i> </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/dc8/179/04e/dc817904ee75e05ca163e6d5f01a1e9a.png"><br>  <i>Etermax Trivia Crack logo</i> <br><br>  Other companies also went through a public cloud with a gaming infrastructure, the results were inconsistent.  Two years before Pok√©mon Go hit the jackpot, Argentinean company Etermax created its own mobile gaming hit: Trivia Crack, a game from a set of competitive games running on Amazon Web Services. <br><br>  According to the technical director of Etermax, Gonzalo Garcia, the tremendous success of Trivia Crack came to her in two waves: the first, in March 2014, marked the success of the game in parts of South American countries.  Traffic at the same time increased from 100 thousand to 10 million daily active users.  The second wave started when the game became popular in the USA in October of the same year, increasing the number of daily active users to 25 million. <br><br>  ‚ÄúWe did not foresee this,‚Äù says Garcia.  ‚ÄúAccording to our estimates and tests, we knew that we could cope with one million players, and planned two million.  But we did not expect such growth - we did not even invest so much in advertising!  Without a cloud infrastructure server, we would never have done it. ‚Äù <br><br>  ‚ÄúWe thought we were releasing another game of the company,‚Äù adds Etermax Director of Information Technology, Martin Dominguez.  ‚ÄúPreviously, our limit was one million users, but what suits two million is not always enough for ten million.‚Äù <br><br>  Such a load has stressed the Agile company's development process.  ‚ÄúWe thought we were not tied to Scrum, and we always worked in Agile style,‚Äù says Dominguez.  ‚ÄúThe problem was that with such a jump in the number of users, sprints could not be completed in two weeks, we had to work day after day.‚Äù <br><br>  To cope with popularity, Etermax first had to abandon some of the functions.  She also had to change some databases and adapt processes to increase efficiency.  In particular, Etermax has changed how Amazon Relational Database Service (RDS) is used.  It implemented fragmentation, secondary servers, and data exchange between secondary servers.  She also collaborated with AWS to solve the problem with the number of packets per second. <br><br>  To support the advanced networking capabilities, Etermax had to migrate from the Amazon public network to a virtual private cloud.  ‚ÄúIt was quite difficult,‚Äù Dominguez recalls.  "At the second peak of users, which increased the number to 25 million, AWS employees said they had never seen a company that used RDS at that level." <br><br>  Garcia said that with the explosive growth of the popularity of Trivia Crack Etermax, one feature helped to cope.  "In Trivia Crack, the interface was almost entirely in the mobile device, so only small amounts of information were transmitted."  Thanks to this, synchronous connections have become less of a problem for Trivia Crack compared to other Etermax games, for example, the Bingo Crack mobile bingo game: ‚ÄúWe constantly needed to send information about bingo balls to know who would be the first, second or third Bingo!"".  What did Etermax teach about the success of Trivia Crack?  According to Dominguez, when it comes to infrastructure, you need to think quickly, be proactive when making changes, and guess what problems will arise.  ‚ÄúPok√©mon Go had the same problem ‚Äî it needed to survive every day.‚Äù  To prepare for the tests and be ready for the new popular hit, Etermax increased the number of employees from the core development team from three to ten engineers. <br><br><h2>  Success management </h2><br>  Patric Palm is the technical director and founder of the Swedish company Hansoft.  She created the Favro collaboration software used by many game developers, including Ubisoft and id Software.  Patrick has the opportunity to observe the company's customers solving their problems in the mobile gaming industry. <br><br>  Considering the problems that Pok√©mon Go has encountered, Palm highlights the question of differences in connection speeds in different regions of the world.  However, he emphasizes that due to cloud computing, scalability is now less of a hindrance. <br><br>  ‚ÄúA few years ago, scalability was a much more serious problem, which required many more people to solve.‚Äù  Since Niantic was able to shift the resolution of some of the problems to Google Cloud, she was able to focus on implementation and registration in various countries.  "Cloud systems solve one of the biggest business problems," Palm said. <br><br>  Due to the fact that the solution to the problem of scalability was found, attention was paid to other, smaller problems.  In the case of Pok√©mon Go, they became the rapid discharge of the phone's battery, forcing players to run around the city with external batteries.  ‚ÄúNiantic has dramatically discharged batteries,‚Äù says Palm.  "Cloud developers are now thinking much about power consumption." <br><br>  Another related problem: data transfer restrictions in different tariffs.  "Not every user has a good mobile operator rate."  This is another incentive for shifting most of the burden to the server side.  Games running in the background consume not only energy, but also data. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/557/d30/338/557d30338c53dc2de1b649db0ce76f2e.jpg"><br>  "We will need a bigger cloud." <br><br><h2>  Rules of the game </h2><br>  If Pok√©mon Go and Trivia Crack were able to cope with the problems of scaling cloud computing on mobile platforms, then you will succeed.  Here are tips for evaluating your own tasks: <br><br><ol><li>  <strong>Consider the worst-case scenario.</strong>  Of course, when it comes to assessments, you need to select some indicators.  But you also need to plan how to scale above the maximum limit.  The main advantage of cloud computing is in their elasticity, think about what will happen if these scales will expand faster than you tested. </li><li>  <strong>Discuss abnormal situations with your service provider.</strong>  As traffic grew, Niantic and Etermax had to work closely with Google and Amazon.  When choosing a cloud service provider, specifically discuss what services they can provide if your needs grow dramatically compared to the expected ones. </li><li>  <strong>Explore telecom operators and mobile devices.</strong>  If your cloud technology will run on users' own mobile devices (perhaps in different parts of the world), then consider how many connections will be transferred from device to cloud and rate the tariff plans with the slowest connections of the most problematic operators that your product will have to face. . </li></ol></div><p>Source: <a href="https://habr.com/ru/post/321196/">https://habr.com/ru/post/321196/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321184/index.html">The path from the programmer to entrepreneurs (and whether to go on it)</a></li>
<li><a href="../321186/index.html">Plans to develop 3CX and a new training video course for partners and administrators</a></li>
<li><a href="../321188/index.html">Procrastination How to cage the demon who prevented to move towards the goal</a></li>
<li><a href="../321192/index.html">The digest of interesting materials for the mobile developer # 189 (January 30-February 5)</a></li>
<li><a href="../321194/index.html">Blockchain based guide</a></li>
<li><a href="../321198/index.html">GameBoy Advance game protection against emulation</a></li>
<li><a href="../321202/index.html">The processor, it is a chipset, it is a chip, it is a platform, it is a system on a chip or what to pay attention to when choosing</a></li>
<li><a href="../321206/index.html">Analysis of Habrahabr and Geektimes articles</a></li>
<li><a href="../321208/index.html">Remote connection to the CodeMeter network key for ARCHICAD</a></li>
<li><a href="../321210/index.html">Classical labyrinth generation algorithms. Part 2: Immersion in Accident</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>