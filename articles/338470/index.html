<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Recommendations on Avito</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will discuss how to build personalized recommendations on Avito. Historically, the Avito business model has been designed so that the del...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Recommendations on Avito</h1><div class="post__text post__text-html js-mediator-article"><p>  This article will discuss how to build personalized recommendations on Avito.  Historically, the Avito business model has been designed so that the delivery of ads in the search takes place at the time of their placement.  In this case, the user can buy additional services in order to raise his ad in the search in the event that over time the ad has fallen far in the search results and stopped typing views and contacts. </p><br><p>  In the context of this business model, it is not obvious why we need personal recommendations.  After all, they just violate the logic of sorting by time and those users who pay for raising an ad may be offended that we ‚Äúraise‚Äù another person‚Äôs ad and show it to the user for free just because our recommendation model considered this ad more relevant to some user. </p><br><p>  However, now the personal recommendations become the ‚Äúmust have‚Äù for classic (and not only) worldwide.  We want to help the user in finding what he needs.  Already, an increasingly significant share of the views of ads on Avito is made from the recommendations on the main page of the applications or the recommendations of similar ads on the product card.  In this post I will tell you exactly what tasks our team at Avito solves. </p><br><p><img src="https://habrastorage.org/web/aab/46f/26a/aab46f26ae1041c9a7a7af5bdfc56d6c.jpg"></p><a name="habracut"></a><br><h1 id="vidy-rekomendaciy">  Kinds of recommendations </h1><br><p>  First, consider what types of recommendations may be useful on Avito. </p><br><h2 id="user-item-rekomendacii">  User-item recommendations </h2><br><p>  First of all, these are user-item recommendations, that is, recommendations of ads for the user.  They can be of two types.  The first is the goods or services that the user is currently looking for.  The second type is complementary goods or services.  For example, phone cases, if a person is looking for a phone.  Or furniture transportation services, if a person buys or sells an apartment.  Or klassery to store a collection of philatelist, if a person is looking for postage stamps. </p><br><p>  User-item recommendations we deliver to users now in three ways: </p><br><ul><li>  blocks with recommendations on the main page of mobile applications; </li><li>  banners with recommendations in search results on the desktop; </li><li>  email and push mailings with a selection of recommended ads. </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/646/220/02e/64622002e8c74ac933b0857040c6f870.jpg"></p><br><h2 id="user-category-rekomendacii">  User-category recommendations </h2><br><p>  It may also be necessary to recommend not specific ads, but product categories (user-category recommendations), by going to which the user himself specifies the search filters.  User-category recommendations are also divided into two types: recommendations of categories of current interests of the user and cross-category recommendations.  We now use this type of recommendation in the push lists and on the main application page. </p><br><p>  Cross-category recommendations are especially important for Avito, since the majority of Runet users have used Avito at least once, but often ‚Äúsit‚Äù in one category.  Many people do not realize that in addition to personal items on Avito, you can effectively sell an apartment or a car.  Cross-category recommendations help us expand the range of categories in which the user is a seller or buyer, and thus increase user involvement. </p><br><p><img src="https://habrastorage.org/web/bbd/00a/7ba/bbd00a7bad3f48979312860b2059a8d6.jpg"></p><br><h2 id="item-item-rekomendacii">  Item-item recommendations </h2><br><p>  Another promising area of ‚Äã‚Äãrecommendation for Avito is item-recommendation, that is, product recommendations for other products.  This type of recommendation is also divided into recommendations of similar products (analogues) and complementary goods or services.  This direction is especially important because, unlike media portals (movies, music), the user usually comes to Avito for something specific, and it is difficult for us to predict the current user preferences in advance.  But if the user is already looking at some product, then we can advise him alternatives or complementary products, and they are likely to be relevant to his current search.  Recommendations of similar ads are shown on the announcement card, as well as used in email and push mailings. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b0e/579/5dc/b0e5795dce6487e526fa0c107b76fc77.jpg"></p><br><h1 id="user-item-rekomendacii-dlya-klassifaydov">  User-item recommendations for classifications </h1><br><p>  Now we delve a little into the task user-item of recommendations, as the most interesting from a theoretical point of view.  Input data are: </p><br><ul><li>  history of user actions on the site: views, search queries, contacts, favorites; </li><li>  user profiles: data from linked social accounts  networks location; </li><li>  all active ads on Avito: title, description, parameters, price. </li></ul><br><p>  At the same time, the amount of data is relatively large: 20 million active users, 35 million active ads. </p><br><p>  Setting the task is as follows: for each active user, show top-N ads with the highest probability of contact request (call or send a message). </p><br><p><img src="https://habrastorage.org/web/585/af5/29f/585af529f79c4e29913c1e332d77988b.png"></p><br><p>  Despite the fact that the wording of the task sounds like a classic task of any recommendatory system, its construction for Avito has significant differences from the tasks of recommendations of the media content: films, music and other things.  Firstly, liquid goods of private traders are quickly sold, without even having time to collect a good story on views and contact requests.  Classical collaborative filtering algorithms are designed so that ads with a short history do not fall into the recommendations.  Longer-lived ads are more often recommended, which tend to be of less interest to buyers. </p><br><p>  Also, the user is usually interested in a typical product, for which there may be many active ads.  For example, he needs to buy a specific iPhone model, and from whom it is no longer so important.  Therefore, building recommendations is better not on ads, but on standard products.  To do this, we build special clustering algorithms. </p><br><p>  Another feature of Avito recommendations is that ads are created by ordinary users and contain errors, incomplete descriptions.  This leads to the fact that we have to seriously work on text processing, extracting useful traits from ad descriptions. </p><br><h1 id="metody">  Methods </h1><br><p>  Now a few words about what methods we use to build recommendations. </p><br><h2 id="offline-modeli">  Offline models </h2><br><p>  Historically, we have used and continue to use models that process click stream users in ‚Äúbatch‚Äù mode.  These algorithms allow you to respond to new actions performed by the user, with a delay of 1-2 hours.  We call them offline models. </p><br><p>  Offline-model recommendations are globally divided into collaborative and content.  Obviously, each of these models has its pros and cons, and the best results show hybrid models that take into account both the history of user actions and the content of ads.  We use the hybrid model as the main one for offline recommendations. </p><br><h2 id="online-modeli">  Online models </h2><br><p>  Offline-models are able to generate high-quality recommendations, but they can not quickly respond to changes in the interests of the user.  This is their significant disadvantage.  For example, if a user has started looking for some new product on Avito, then we want to begin recommending suitable products to him within the same session.  To do this, we must take into account the interests of the user in real time.  We call such models online-models. </p><br><p>  Their feature is that they are more complex from an architectural point of view (the time from the moment the user performs the action until the recommendations are updated - no more than 1 second).  The classic online model is based on the construction of an online profile of user interests, with the help of which the most recent and relevant ads are selected.  Due to stringent performance requirements, online algorithms are usually simpler than offline. </p><br><h1 id="ocenka-kachestva-modeley">  Model quality assessment </h1><br><p>  After the new model is created, it needs to be somehow assessed.  The target metric for the company is the increase in the number of transactions on Avito.  All offline and online metrics must somehow correlate with it. </p><br><p>  To evaluate offline-models, there are a number of excellent metrics, such as <a href="https://en.wikipedia.org/wiki/Precision_and_recall">precision, recall</a> , <a href="https://en.wikipedia.org/wiki/Discounted_cumulative_gain">NDCG</a> , <a href="https://en.wikipedia.org/wiki/R_score">R-score</a> and others. </p><br><p>  It is not always possible to select such offline-metrics that correlate well with the target metric of the company.  This is where online metrics come to the rescue (CTR, conversion to contacts, growth in unique customers).  On online split tests, we can compare recommendations from different models and different frontend interfaces.  The method of <a href="https://habrahabr.ru/company/ods/blog/325416/">multi-armed bandits is</a> well suited to optimize the metaparameters of the models. </p><br><h1 id="itogi">  Results </h1><br><p>  The Avito recommendation team faces ambitious tasks that require in-depth and active research of recommendation methods that can withstand Avito's performance loads and show excellent results on target metrics. </p><br><p>  In order to find optimal approaches, we read a lot of articles, we go and speak at conferences and hold contests.  Not so long ago, our <a href="http://dataring.ru/competitions/avito-recommendations/">recommendation contest</a> ended, and we do not plan to stop there.  We call upon all interested to help us in this difficult work by participating in our contests.  And we will try not to skimp on the prize :).  We also occasionally open vacancies, which we are sure to announce in the slack channel ODS. </p><br><p>  In addition, we ourselves participate in contests.  BTW, in 2016 and 2017 we entered the top ten teams in the largest international competition in recommendation systems Recsys Challenge. </p><br><p>  Thanks for attention! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/338470/">https://habr.com/ru/post/338470/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338452/index.html">Broadcast from the gamedev conference 4C in St. Petersburg. The first day</a></li>
<li><a href="../338454/index.html">The book "ASP.NET Core. Application Development"</a></li>
<li><a href="../338460/index.html">Automate penetration testing with apt2</a></li>
<li><a href="../338462/index.html">JavaScript scope and closures</a></li>
<li><a href="../338468/index.html">Do you need financial data?</a></li>
<li><a href="../338472/index.html">How we transferred 400 stores to electronic cash registers</a></li>
<li><a href="../338478/index.html">"Invisible design": we design together with cars</a></li>
<li><a href="../338480/index.html">Kali Linux: filtering traffic using netfilter</a></li>
<li><a href="../338482/index.html">Comodo Group reports a fourfold increase in the number of cyber threats</a></li>
<li><a href="../338484/index.html">Fujitsu will build a supercomputer for the study of artificial intelligence</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>