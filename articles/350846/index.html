<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using the render props template outside of the render</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="React represents a new API ( context API ) that uses the render props pattern ( template ). At seminars, meetings and on Twitter, I see that there are...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using the render props template outside of the render</h1><div class="post__text post__text-html js-mediator-article"><p> React represents a new API ( <a href="https://github.com/jamiebuilds/create-react-context">context API</a> ) that uses the <code>render props</code> pattern ( <em>template</em> ).  At seminars, meetings and on Twitter, I see that there are many questions about using <code>render props</code> outside of the render, for example, in event handlers or lifecycle hooks. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/823/2ed/146/8232ed146858054ab590d2cd4979f4b5.jpg" alt="image"></p><a name="habracut"></a><br><p>  A year and a half ago, when I was working on React Router v4, I was particularly interested in solving the problem of "deep updates" just once and for all.  I created a library called <code>react-context-emission</code> (later <code>react-broadcast</code> ) with an API that is conceptually identical to what React presented in its new context API. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// React context emission API const { LocationEmitter, LocationSubscriber } = createContextEmission('location') &lt;LocationEmitter location={value}/&gt; &lt;LocationSubscriber&gt;{({ location }) =&gt; (...)}&lt;/LocationSubscriber&gt; //  React Context API const { Provider, Consumer } = React.createContext() &lt;Provider value={location}/&gt; &lt;Consumer&gt;{value =&gt; (...)}&lt;/Consumer&gt;</span></span></code> </pre> <br><p>  After using this template, I really liked to associate variable values ‚Äã‚Äãwith components through the context and draw properties ( <em>render props</em> ), however I tried my best to get access to contextual values ‚Äã‚Äãoutside of rendering.  In my implementation, I used to get them from <code>this.context</code> everywhere.  This was one of the reasons why we returned to using the current (outdated?) <code>contextTypes</code> API in the React Router. </p><br><p>  Solving this problem is not so difficult.  It took me a while to understand this.  However, once you see the solution, it will seem obvious to you.  See for yourself! </p><br><h2 id="dostup-k-znacheniyam-v-obrabotchikah-sobytiy">  Access to values ‚Äã‚Äãin event handlers </h2><br><p>  It is only necessary ... to transfer the value to the handler: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Something</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ handleClick = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, stuff</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(stuff); }; render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">SomeContext.Consumer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {stuff =&gt; ( </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Cool! {stuff}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{event</span></span></span></span><span class="xml"><span class="hljs-tag"> =&gt;</span></span></span><span class="xml"> this.handleClick(event, stuff)}&gt; Click me </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> )} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">SomeContext.Consumer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ); } }</span></span></code> </pre> <br><h2 id="dostup-k-znacheniyam-v-lifecycle-hooks">  Access to values ‚Äã‚Äãin lifecycle hooks </h2><br><p>  In the case of <code>lifecycle hooks</code> previous template does not work, because  we do not call hooks, but React.  I suggest three templates that I used, choose which one you like best (the third is my favorite!). </p><br><h2 id="oborachivaem">  Wrapping up </h2><br><p>  You can access data by creating two components: a container that uses a context and a container that accepts a context as a property. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   (,   ) const SomethingContainer = () =&gt; ( &lt;SomeContext.Consumer&gt; {stuff =&gt; &lt;Something stuff={stuff} /&gt;} &lt;/SomeContext.Consumer&gt; ); // ,  stuff  prop! Context      class Something extends React.Component { componentDidMount() { console.log(this.props.stuff); } render() { return ( &lt;div&gt; &lt;h1&gt;Cool! {this.props.stuff}&lt;/h1&gt; &lt;/div&gt; ); } }</span></span></code> </pre> <br><h2 id="sozdaem-komponenty-vysshego-poryadka-hoc-komponenty">  Create higher order components (HOC components) </h2><br><p>  Perhaps you are used to decorating some components with others (for example, using the HOC - <em>High Order Component</em> ).  You can quickly turn the <code>render prop</code> component into a higher order component.  I don‚Äôt really like this method, because for implementation it requires significant shuffling in the code and a lot of concepts. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// HOC const withStuff = Comp =&gt; props =&gt; ( &lt;SomeContext.Consumer&gt; {stuff =&gt; &lt;Comp stuff={stuff} /&gt;} &lt;/SomeContext.Consumer&gt; ); //   class SomethingImpl extends React.Component { componentDidMount() { console.log(this.props.stuff); } render() { return ( &lt;div&gt; &lt;h1&gt;Cool! {this.props.stuff}&lt;/h1&gt; &lt;/div&gt; ); } } // the actual decoration const Something = withStuff(SomethingImpl)</span></span></code> </pre> <br><h2 id="komponentnyy-komponent-moya-novaya-lyubov">  Component component: my new love. </h2><br><p>  Once I created a component that simply took a function as a property and called a function in <code>componentDidUpdate</code> .  I already did a property called <code>render</code> and now I have another one called <code>didUpdate</code> .  I realized that it is possible to convert each method of a component class into a component property, and this is how <a href="https://reactions.github.io/component/">@ reactions / component</a> ! </p><br><p>  It is very convenient to compose <code>render props</code> in life cycle hooks without any shuffles in the code: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Component <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@reactions/component'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Something = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">SomeContext.Consumer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {stuff =&gt; ( </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Component</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">didMount</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{()</span></span></span></span><span class="xml"><span class="hljs-tag"> =&gt;</span></span></span><span class="xml"> console.log(stuff)}&gt; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Cool! {stuff}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Component</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> )} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">SomeContext.Consumer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> );</span></span></code> </pre> <br><p>  Typically, properties can be compared in <code>componentDidUpdate</code> , this also works well: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Something = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">SomeContext.Consumer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> {stuff =&gt; ( </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Component</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">stuff</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{stuff}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">didUpdate</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{({prevProps,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">props</span></span></span></span><span class="xml"><span class="hljs-tag">}) =&gt;</span></span></span><span class="xml"> { console.log(prevProps.stuff === props.stuff); }} &gt; </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Cool! {stuff}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Component</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> )} </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">SomeContext.Consumer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> );</span></span></code> </pre> <br><p>  This is my favorite method.  The code can change and move without any inconsistencies, because it does not carry new concepts, the whole structure is organized by components.  If you no longer need the methods of life cycles, you do not have to unravel the abstraction, just remove <code>&lt;Component/&gt;</code> . </p><br><p>  So now you have everything you need.  Everything is obvious, one has only to see once, but before that everything seemed complicated. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/350846/">https://habr.com/ru/post/350846/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../350836/index.html">Descriptor graphics in MATLAB: the second horizontal axis</a></li>
<li><a href="../350838/index.html">We study parallel computing with OpenMPI and a supercomputer on the example of hacking neighbor WiFi</a></li>
<li><a href="../350840/index.html">Sentenced to Russian hackers who attacked US exchanges</a></li>
<li><a href="../350842/index.html">Experience in the development of a non-commercial project by the Junior</a></li>
<li><a href="../350844/index.html">Design by Introspection</a></li>
<li><a href="../350848/index.html">Women in IT, an inside look</a></li>
<li><a href="../350850/index.html">Do you really need Redux?</a></li>
<li><a href="../350852/index.html">Information security of bank non-cash payments. Part 3 - Formation of requirements for the protection system</a></li>
<li><a href="../350854/index.html">FastTrack Training. "Network Basics". "Basics of data centers." Part 1. Eddie Martin. December 2012</a></li>
<li><a href="../350856/index.html">Interface Composition in Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>