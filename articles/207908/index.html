<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>An animation of the SVG path element</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think many have seen reviews of the new generation of game consoles from Polygon (Vox Media) . These are the ones where consoles were drawn in the s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>An animation of the SVG path element</h1><div class="post__text post__text-html js-mediator-article">  I think many have seen reviews of the new generation of game consoles from <b>Polygon (Vox Media)</b> .  These are the ones where consoles were drawn in the style of blueprints: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbe/302/7fd/fbe3027fdb6eb26c2d36c41ce1856b5c.gif" alt="Playstation 4"></div><br>  The reviews looked cool, rather unusual and new.  About how the main feature of reviews is implemented - <abbr title="Scalable Vector Graphics">SVG</abbr> animation, how to make something similar to yourself, and what other ‚Äúsecret‚Äù possibilities the good old <abbr title="Scalable Vector Graphics">SVG</abbr> hides in terms of animation of the <code>path</code> element - can be found under the cat. <a name="habracut"></a><br><br><h4>  Stroke-dasharray interpolation, theory </h4><br>  In general, the technique of such line animation is not new, just until recently, <abbr title="Scalable Vector Graphics">SVG</abbr> and everything connected with it, in my opinion, was unfairly forgotten, but fortunately the situation is changing.  So, the trick with the animation of the <code>path</code> element is possible thanks to the <a href="http://www.w3.org/TR/SVG/painting.html">stroke-dasharray</a> property of the <code>path</code> element.  This property allows you to set the parameters of the dotted line, namely the length of the stroke and the gap between the strokes.  If we set the length of the stroke equal to the entire length of the line, we get an ordinary solid line.  If we set the stroke length equal to zero, and the gap length is again equal to the entire length of the line, then we get an invisible line.  And gradually increasing the length of the stroke with the length of the gap equal to the length of the entire line, we can imitate its drawing.  With this approach, drawing will occur from the beginning of the line.  If you suddenly need to draw from the end, then you need to use another property: <a href="http://www.w3.org/TR/SVG/painting.html">stroke-dashoffset</a> .  This property defines the offset for the first stroke.  Thus, reducing the offset and increasing the length of the stroke, we get the drawing from the end of the line. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The guys from <b>Vox Media</b> used a hybrid version (which, in my opinion, is redundant), by the way, you can (and should) read how they did it in their blog: <a href="http://product.voxmedia.com/post/68085482982/polygon-feature-design-svg-animations-for-fun-and">Polygon feature design: SVG animations for fun and profit</a> . <br><br><h4>  SVG animation implementation </h4><br>  <b>Vox Media</b> suggests using <code>requestAnimationFrame</code> for smooth animation, but we have slightly different goals, so we will go more simply by using the <a href="http://d3js.org/" title="d3.js">D3.js library</a> and the duration-based animation implemented in it. <br><br>  This is actually the working code used to animate the console from the beginning of the article. <br><br><pre> <code class="javascript hljs">queue() .defer(d3.xml, <span class="hljs-string"><span class="hljs-string">"PS4.svg"</span></span>, <span class="hljs-string"><span class="hljs-string">"image/svg+xml"</span></span>) .await(ready); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ready</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error, xml</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Adding our svg file to HTML document var importedNode = document.importNode(xml.documentElement, true); d3.select("#pathAnimation").node().appendChild(importedNode); var svg = d3.select("svg"), svgWidth = svg.attr("width"), svgHeight = svg.attr("height"); var paths = svg.selectAll("path") .call(transition); function transition(path) { path.transition() .duration(5000) .attrTween("stroke-dasharray", tweenDash) .each("end", function() { d3.select(this).call(transition); }); // infinite loop } function tweenDash() { var l = this.getTotalLength(), i = d3.interpolateString("0," + l, l + "," + l); // interpolation of stroke-dasharray attr return function(t) { return i(t); }; } }</span></span></code> </pre><br>  In the <code>transition(path)</code> function, we use <a href="https://github.com/mbostock/d3/wiki/Transitions">transition.attrTween (name, tween)</a> , which calls the interpolator defined in the <code>tweenDash()</code> function.  To calculate the length, use the <a href="http://www.w3.org/TR/SVG/paths.html">getTotalLength ()</a> method defined for the SVG <code>path</code> elements.  Then, using the <a href="https://github.com/mbostock/d3/wiki/Transitions">d3.interpolateString (a, b), the</a> interpolator of the property <code>stroke-dasharray</code> , which interpolates the values ‚Äã‚Äãfrom the <code>stroke-dasharray: 0,l;</code>  before <code>stroke-dasharray: l,l;</code>  (here the first value specifies the length of the stroke, and the second length of the gap).  You can see how this works on <b>bl.ocks.org</b> : <a href="http://bl.ocks.org/KoGor/8160770" title="PlayStation 4 animation">PlayStation 4: SVG animation</a> . <br><br>  I think you noticed that some of the elements are displayed constantly, this is because they are not drawn using <code>path</code> .  In general, the preparation and optimization of vector images for the web is a rather extensive topic with a lot of nuances pulling on a separate article. <br><br><h4>  Movement along the path element </h4><br>  <code>path</code> has another very useful method - <a href="http://www.w3.org/TR/SVG/paths.html">getPointAtLength (distance in float)</a> .  It allows you to get the coordinates of a point located at a given distance from the beginning of the line.  With it, you can realize the movement of any marker along the line, and, importantly, a smooth rotation by calculating the tangent to the existing line. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/70a/0bb/a56/70a0bba5667a805dea6c92f291d003a1.gif" alt="Rocket along path animation"></div><br>  We start simply with the movement along the line, while without rotation. <br><br><pre> <code class="javascript hljs">queue() .defer(d3.xml, <span class="hljs-string"><span class="hljs-string">"wiggle.svg"</span></span>, <span class="hljs-string"><span class="hljs-string">"image/svg+xml"</span></span>) .await(ready); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ready</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error, xml</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Adding our svg file to HTML document var importedNode = document.importNode(xml.documentElement, true); d3.select("#pathAnimation").node().appendChild(importedNode); var svg = d3.select("svg"); var path = svg.select("path#wiggle"), startPoint = pathStartPoint(path); var marker = svg.append("circle"); marker.attr("r", 7) .attr("transform", "translate(" + startPoint + ")"); transition(); //Get path start point for placing marker function pathStartPoint(path) { var d = path.attr("d"), dsplitted = d.split(" "); return dsplitted[1].split(","); } function transition() { marker.transition() .duration(7500) .attrTween("transform", translateAlong(path.node())) .each("end", transition);// infinite loop } function translateAlong(path) { var l = path.getTotalLength(); return function(i) { return function(t) { var p = path.getPointAtLength(t * l); return "translate(" + px + "," + py + ")";//Move marker } } } }</span></span></code> </pre><br>  Here <code>pathStartPoint(path)</code> pulls the coordinates of the beginning of the line from the attribute <a href="http://www.w3.org/TR/SVG/paths.html">d</a> of the <code>path</code> element.  In <code>translateAlong(path)</code> , using the interpolator, we set the coordinates of our marker.  An example can be found here: <a href="http://bl.ocks.org/KoGor/8162640" title="Marker animation along SVG path">Marker animation along SVG path element with D3.js.</a>  You can also combine line drawing animation and marker movement, it can look like this: <a href="http://bl.ocks.org/KoGor/8163022" title="Marker animation along SVG path">Marker animation along SVG path element with D3.js II</a> . <br><br>  Let's complicate the task, add rotation (well, let's change the marker from the circle to something more interesting).  As a marker, we will have a rocket with a width of <code>48</code> and a length of <code>24</code> .  Since by default the marker's snap point is the upper left corner, we need to shift it so that the snap is to the center of the marker.  It is also necessary to take this into account when rotating, because it also occurs by default around the upper left corner.  With an offset sort of sorted out.  Now let's proceed directly to the rotation, here the <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B0%25D1%2581%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BF%25D1%2580%25D1%258F%25D0%25BC%25D0%25B0%25D1%258F">tangent definition</a> will help us, the angle will be determined using the arctangent. <br><br>  The <code>translateAlong(path)</code> function that defines the interpolator will look like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">translateAlong</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">path</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> l = path.getTotalLength(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t0 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> p0 = path.getPointAtLength(t0 * l);<span class="hljs-comment"><span class="hljs-comment">//previous point var p = path.getPointAtLength(t * l);////current point var angle = Math.atan2(py - p0.y, px - p0.x) * 180 / Math.PI;//angle for tangent t0 = t; //Shifting center to center of rocket var centerX = px - 24, centerY = py - 12; return "translate(" + centerX + "," + centerY + ")rotate(" + angle + " 24" + " 12" +")"; } } }</span></span></code> </pre><br>  The implementation can be viewed here: <a href="http://bl.ocks.org/KoGor/8163268" title="Marker animation along SVG path">Marker animation along SVG path element with D3.js III</a> . <br><br><h4>  Where and for what it can be used </h4><br>  First, to achieve an interesting effect in terms of design.  You can display objects as you scroll, you can animate the text, though you have to take into account that by default each letter is a separate element of the <code>path</code> , and there is a lot to come up with. <br><br>  And you can use it from a practical point of view, for example, to animate movement along routes on charts and plans (animation of arrows, etc.).  And also for infographics, there are a lot of options, if correctly used, you can very effectively manage the reader's attention. <br><br>  That's all.  Try, experiment, create - everything is in your hands.  And may good luck accompany you this year. <br><br>  <b>UPD:</b> <br>  More articles on this topic: <br><ul><li><img alt="en" src="https://habrastorage.org/getpro/habr/post_images/ac2/60c/6b4/ac260c6b4b683a38a76035e30080ea57.gif">  <a href="http://tympanus.net/codrops/2013/12/30/svg-drawing-animation/">SVG drawing animation</a> </li><li><img alt="en" src="https://habrastorage.org/getpro/habr/post_images/ac2/60c/6b4/ac260c6b4b683a38a76035e30080ea57.gif">  <a href="http://jakearchibald.com/2013/animated-line-drawing-svg/">Animated line drawing in SVG</a> </li><li><img alt="en" src="https://habrastorage.org/getpro/habr/post_images/ac2/60c/6b4/ac260c6b4b683a38a76035e30080ea57.gif">  <a href="http://24ways.org/2013/animating-vectors-with-svg/">Animating Vectors with SVG</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/207908/">https://habr.com/ru/post/207908/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../207898/index.html">12 security levels in Windows Phone 8 using the example of Lumia 1520</a></li>
<li><a href="../207900/index.html">To girls: five reasons to marry an IT person and five reasons to think about it before</a></li>
<li><a href="../207902/index.html">Intuitive and easy-to-use user interface (GUI) layout for communicators and tablet PCs</a></li>
<li><a href="../207904/index.html">Spine - first steps</a></li>
<li><a href="../207906/index.html">Papers: a simple game for tonight</a></li>
<li><a href="../207910/index.html">Briefly about the new: Samsung has developed the world's first 8-gigabit module of mobile DRAM-memory LPDDR4</a></li>
<li><a href="../207912/index.html">New Year's greetings from the robot</a></li>
<li><a href="../207918/index.html">The exhibition "Informatics in the USA": a documentary film about the exhibition</a></li>
<li><a href="../207920/index.html">Development of tile games in JavaScript (Robbo)</a></li>
<li><a href="../207922/index.html">Identification based on movement data (tracking)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>