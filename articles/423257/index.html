<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Arguments of functions as bit constants in PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! I present to you the translation of an article by Liam Hammett : Bitmask Constant Arguments in PHP . 

 PHP contains many standard functions...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Arguments of functions as bit constants in PHP</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <em>Hi, Habr!</em>  <em>I present to you the translation of an article by <a href="https://twitter.com/LiamHammett">Liam Hammett</a> : <a href="https://medium.com/%40liamhammett/bitmask-constant-arguments-in-php-cf32bf35c73">Bitmask Constant Arguments in PHP</a> .</em> </blockquote><p>  PHP contains many standard functions that take boolean arguments in the form of embedded constants with values ‚Äã‚Äãof binary numbers. <br>  These values ‚Äã‚Äãare combined into a single function argument in order to pass multiple Boolean flags in a compact manner. </p><br><p>  They may work a little differently than many people imagine and use in their code, so I propose to consider how it actually works. <a name="habracut"></a></p><br><hr><br><h1 id="kak-eto-ispolzuetsya-v-funkciyahphp">  How it is used in PHP functions </h1><br><p> PHP 7.2, including extensions, contains over 1800+ predefined constants and some of them are used as function arguments. <br>  One example of such an application is a new option in PHP 7.3 that allows you to throw an exception to the <code>json_encode</code> function for conversion errors. </p><br><pre> <code class="php hljs">json_encode($value, JSON_THROW_ON_ERROR);</code> </pre> <br><p>  Using <code>|</code>  (or) bitwise operator; several function arguments work as one.  <a href="http://php.net/manual/en/function.json-encode.php">Example</a> from PHP documentation: </p><br><pre> <code class="php hljs">json_encode($value, JSON_HEX_TAG | JSON_HEX_APOS | JSON_HEX_QUOT | JSON_HEX_AMP | JSON_UNESCAPED_UNICODE);</code> </pre> <br><p>  Very nothing. </p><br><h1 id="no-vse-taki-kak-zhe-eto-rabotaet">  But still, how does it work? </h1><br><p>  Using bitwise operations to achieve the same effect in the world of user-defined functions is actually simple, but it requires at least a basic knowledge of what bits are and how bitwise operations work in PHP. </p><br><blockquote>  Integers can be specified in decimal (base 10), hexadecimal (base 16), octal (base 8) or binary (base 2) number system.  [...] <br>  To write in binary notation, you must put in front of the number 0b. <br>  - <a href="http://php.net/manual/ru/language.types.integer.php">php.net</a> </blockquote><p>  Examples of constants with a different set of binary numbers: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> A = <span class="hljs-number"><span class="hljs-number">0b0001</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 1 const B = 0b0010; // 2 const C = 0b0100; // 4 const D = 0b1000; // 8</span></span></code> </pre> <br><p>  Pay attention to the example and sequence of numbers.  Each binary value represents a value twice as high for each zero at the end.  Zeros between 0b and 1 are optional, but may help align the source code. </p><br><p>  Fortunately, we need to understand how only two bitwise operations work. </p><br><h1 id="pobitovoe-ilior">  Bitwise OR (OR) </h1><br><p>  Do not confuse the operator <code>|</code>  ( <em>bitwise "OR"</em> ) with the frequently used operator <code>||</code>  ( <em>logical "OR"</em> ), which is commonly found in <code>if else</code> . <br>  Bitwise "OR" is a binary operation, the action of which is equivalent to applying a <em>logical "OR"</em> to each pair of bits at the same positions in the binary representations of the operands.  In other words, if both the corresponding bits of the operands are 0, the binary bit of the result is 0;  if at least one bit of the pair is 1, the binary bit of the result is 1. </p><br><p>  An example of a bitwise OR operation: </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> A = <span class="hljs-number"><span class="hljs-number">0b0001</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> B = <span class="hljs-number"><span class="hljs-number">0b0010</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> C = <span class="hljs-number"><span class="hljs-number">0b0100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> D = <span class="hljs-number"><span class="hljs-number">0b1000</span></span>; A | B === <span class="hljs-number"><span class="hljs-number">0b0011</span></span>; A | C | D === <span class="hljs-number"><span class="hljs-number">0b1101</span></span>;</code> </pre> <br><h1 id="pobitovoe-iand">  Bitwise ‚ÄúAND‚Äù (AND) </h1><br><p>  Similarly, the <code>&amp;</code> operator ( <em>bitwise ‚ÄúAND‚Äù</em> ) should not be confused with the frequently used <code>&amp;&amp;</code> operator ( <em>logical ‚ÄúAND‚Äù</em> ). <br>  Bitwise "AND" is a binary operation, the action of which is equivalent to applying a <em>logical "AND"</em> to each pair of bits at the same positions in the binary representations of the operands.  In other words, if both corresponding bits of the operands are 1, the resulting binary bit is 1;  if at least one bit of the pair is 0, the resulting binary bit is 0. </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> A = <span class="hljs-number"><span class="hljs-number">0b0001</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> B = <span class="hljs-number"><span class="hljs-number">0b0010</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> C = <span class="hljs-number"><span class="hljs-number">0b0100</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> D = <span class="hljs-number"><span class="hljs-number">0b1000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> VALUE = <span class="hljs-number"><span class="hljs-number">0b1010</span></span>; A &amp; B === <span class="hljs-number"><span class="hljs-number">0b0000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      A  B A &amp; C &amp; D === 0b0000; //      A, B  C A &amp; A === 0b0001; //      A  A &amp; VALUE === 0b0000; //      A  VALUE B &amp; VALUE === 0b0010; //  1    B,    VALUE</span></span></code> </pre> <br><h1 id="mozhet-li-chislo-imet-logicheskiy-tip-boolean">  Can a number have a boolean type? </h1><br><p>  It is worth noting that in PHP there is the concept of "type <em><a href="http://php.net/manual/ru/language.types.type-juggling.php">manipulation</a></em> " ( <strong>type juggling</strong> ).  In the language of non-specialists, this means that he (PHP) will automatically try to convert data of one type to another, if necessary. <br>  If you understand how such transformations occur, then this can be a useful tool. <br>  For example, we know that the number <code>0</code> acts as a <code>false</code> when converting to a boolean (boolean) type, while all other numbers will be <code>true</code> .  Remember that these binary values ‚Äã‚Äãwe work with are actually integers? </p><br><h1 id="podvedem-itogi">  Let's sum up! </h1><br><p>  Now we can combine this knowledge to create an if construct, the code in which will be executed only if the result of the bitwise operation between the numbers is not <code>0b0000</code> (or <code>0</code> , which is converted to <code>false</code> ). </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> A = <span class="hljs-number"><span class="hljs-number">0b0001</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> B = <span class="hljs-number"><span class="hljs-number">0b0010</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($arg = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($arg &amp; A) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'A'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($arg &amp; B) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">'B'</span></span>; } } f(); <span class="hljs-comment"><span class="hljs-comment">// nothing f(A); // 'A' f(B); // 'B' f(A | B); // 'AB'</span></span></code> </pre> <br><p>  By the same principle, other PHP built-in functions (for example <code>json_encode</code> ) work. </p><br><h1 id="stoit-li-onotogo">  Is it worth it? </h1><br><p>  Perhaps you now have a desire to apply this approach to functions with a large number of arguments that participate in conditional constructions, but there are a number of drawbacks in the processing of bitwise function flags: </p><br><ul><li>  You cannot pass non-boolean values ‚Äã‚Äãthrough an argument. </li><li>  There is no standard way to document arguments using docblocks. </li><li>  You lose general tips and support for most IDEs. </li><li>  Instead, you can pass an associative array as an argument to be able to set non-null values ‚Äã‚Äã(or even a <a href="https://steemit.com/php/%40crell/php-use-associative-arrays-basically-never">class</a> ). </li><li>  There are compelling reasons why you should avoid using <a href="https://martinfowler.com/bliki/FlagArgument.html">logical "function flags" as arguments</a> and instead use another function or method for mutable functionality. </li></ul><br><p>  However, now you know how to do it. </p><br><hr><br><p>  Reading a long list of definitions of constants can be verbose and difficult, so <a href="https://gist.github.com/ImLiam/b740732b72fdb80685b540e9f021860d">here‚Äôs an auxiliary function that</a> simplifies their definition. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/423257/">https://habr.com/ru/post/423257/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423243/index.html">Vector averaging method for measuring wind direction</a></li>
<li><a href="../423247/index.html">What is intelligence?</a></li>
<li><a href="../423249/index.html">Release Rust 1.29</a></li>
<li><a href="../423251/index.html">Personal account from Megafail</a></li>
<li><a href="../423253/index.html">Domestic CAD-platform nanoCAD Plus 10: a universal complex for those who design</a></li>
<li><a href="../423259/index.html">7. Check Point for maximum. Sandboxing Conclusion</a></li>
<li><a href="../423261/index.html">Analogs in the "Nomenclature". Another way to save wisely. Part 2</a></li>
<li><a href="../423263/index.html">PROSTOR conference about storage: from a partner meeting to an international technological event</a></li>
<li><a href="../423265/index.html">European Union adopted copyright directive</a></li>
<li><a href="../423267/index.html">Clean in the boom workshop. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>