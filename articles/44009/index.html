<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>kiosk-type windows shell or how to surround employees with care and understanding</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not long ago, a friend of mine asked me to block all programs on my work computers, except for one and it was not an explorer :). 

 I tried to block ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>kiosk-type windows shell or how to surround employees with care and understanding</h1><div class="post__text post__text-html js-mediator-article">  Not long ago, a friend of mine asked me to block all programs on my work computers, except for one and it was not an explorer :). <br><br>  I tried to block the launch of all programs except the one needed through policies - but the explorer on the hot keys still started, but with it you can mess up a lot of things if you wish. <br><br>  I tried to replace windows shell - I installed the right program instead of explorer.exe.  But it turned out that, firstly, the required program works in graphic mode, and direct-x did not seem to have time to initialize and the program complained about its absence.  Also, when exiting the program, the user session did not end. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I was still hoping to solve the problem with available tools. <br><br>  The next step was a baht file with the launch of the desired program and logoff.exe after - so that when you exit the program the session is closed.  Everything seems to be nothing, but first, the program continued to complain about the lack of direct X (although it was launched later), second, even by running the batch file in a minimized state, its window was visible ‚Äî you can interrupt it, i.e.  the user could, if desired, participate in the process and create problems, which is generally unacceptable. <br><br>  I tried a basic script for the Vijayal script - but to launch it you need to launch the explorer with all the following circumstances (it is possible somehow without an explorer, but I didn‚Äôt find how). <br><br>  Since I didn‚Äôt find a simple solution, I quickly decided to write a simple shell that will launch the necessary program and terminate the session upon its completion. <br><br>  As a writing tool I downloaded the latest with ++ express visual studio, I made a program. <br><br>  It turned out that if we immediately launch the graphics program, it also complains about the lack of direct-x, but if you launch it from the menu, it started silently and with pleasure. <br><br>  I brought this shell to the computers - I found that the code was compiled under .net - and I considered it only for my micro program as blasphemy.  When I came home and rummaged through the settings of the visual studio, I realized that I wouldn‚Äôt be able to get a clean win32 code - I‚Äôll not even have a php programmer and I don‚Äôt have much desire to program thick solutions for a small-scale platform. <br><br>  Not really upset, I decided to do the same thing on win32 api using the good old visual studio 6.0.  At the same time I decided to add some amenities for myself, my beloved - for example, configuring the list of allowed programs through the registry (it is more difficult to protect the file from changes), i.e.  All settings of this shell are stored in the global registry section, inaccessible for change for mere mortals.  I also think to hang a hook on launching programs (if some advanced user launches the game of cards through the open or save file dialog) and either interrupt unresolved processes or prevent them from running at all - have not yet figured out how to correctly / easier to do).  I also think to figure out how to copy files through the open or save file dialog - block them too, in general.  Also, in theory, it is necessary to prohibit a simple user from mounting devices. <br><br>  In general, the sunset manually :) <br><br>  Who can already solved similar tasks?  Here is a feeling that it is solved in three kicks, and here I am, God has spread the message that already. </div><p>Source: <a href="https://habr.com/ru/post/44009/">https://habr.com/ru/post/44009/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../44003/index.html">News has ended in the country</a></li>
<li><a href="../44004/index.html">Zoo</a></li>
<li><a href="../44005/index.html">Chip that increases the stability of the car</a></li>
<li><a href="../44007/index.html">Modding on Digromania 2008</a></li>
<li><a href="../44008/index.html">Moving from one development planning tool to another - from XPlanner to Redmine</a></li>
<li><a href="../44010/index.html">SaleStep.ru - anti-crisis startup</a></li>
<li><a href="../44011/index.html">Unpleasant glitch Mozilla Firefox 3 c position: fixed</a></li>
<li><a href="../44012/index.html">Creating a Custom Default User Profile in Windows XP</a></li>
<li><a href="../44013/index.html">Usability: sawing state budgets is far away</a></li>
<li><a href="../44014/index.html">Alternative browsers - the lot of marginals?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>