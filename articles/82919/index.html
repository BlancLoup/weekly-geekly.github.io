<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mutt, ssmtp and sending reports</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At one time, when I was not yet on Habr√©, this article was published in a sandbox. Unfortunately, nobody liked it and was eventually removed. Long tho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mutt, ssmtp and sending reports</h1><div class="post__text post__text-html js-mediator-article"> At one time, when I was not yet on Habr√©, this article was published in a sandbox.  Unfortunately, nobody liked it and was eventually removed.  Long thought what to do with it - to score, post it yet on Habr√© or on your blog <a href="https://eax.me/">Notes programmer</a> .  I decided, since it was written for Habr, let it be published on it.  So, under the cut - an article on the practice of sending reports by e-mail.  Now, rereading the text, I understand that the article is not a fountain, but maybe someone will come in handy. <a name="habracut"></a><br><br>  Often there is a task like this: it is necessary to process such logs monthly (or weekly / daily), build a report on them and send it to the specified E-Mail.  In this article I just would like to tell about the second part of such a task, namely about sending reports.  It would seem such a routine operation, but difficulties arise with it more often than it might seem at first glance. <br><br>  I prefer to use ready-made, time-tested programs, rather than writing my own scripts each time.  In most cases, the necessary program was once written by someone, why reinvent the wheel? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I use mutt to send reports.  I am attracted to the simplicity of the interface, the age (read stability) of the program and the fact that mutt is ported to almost all unix-like systems if not all.  In my favorite FreeBSD, look for it in / usr / ports / mail / mutt. <br><br>  To send a letter with an attach with the help of mutt, the command is enough <br><br> <code>mutt -s Subject -a File User@Host.com</code> <br> <br>  where Subject is the subject of the message, File is the name of the attached file, and User@Host.com is the recipient of the letter.  You can attach several files to the letter or specify several recipients.  The program reads the text of the letter from stdin. <br><br>  By default, mutt uses sendmail as the MTA.  Usually there is no difficulty with this - after installing the mutt, we can immediately start writing scripts and everything will work fine.  But I had to deal with the situation when sending letters directly from the server is simply prohibited by the firewall rules.  In this case, use a third-party SMTP server. <br><br>  The problem is that mutt does not have MTA functions, that is, working with SMTP is not his task.  However, you can teach him to send mail through a given smtp-server and the ssmtp program will help him with this. <br><br>  Strictly speaking, ssmtp is not an MTA, but simply an smtp client that emulates the work of sendmail.  If you, like me, are using FreeBSD, you can install ssmtp from ports - / usr / ports / mail / ssmtp. <br><br>  Configuring ssmtp is done by editing the file /usr/local/etc/ssmtp/ssmtp.conf (the path to the file may be different on your OS).  Here is how it looks like: <br><br> <code>root=reports@example.ru #      <br> mailhub=smtp.example.ru:465 # smtp-   <br> hostname=localhost #   ,    <br> UseTLS=Yes #    <br> AuthUser=reports@example.ru #  <br> AuthPass=qwerty #  <br> FromLineOverride=Yes #  From:   mutt</code> <br> <br>  If you want to send reports via Gmail, the config will look a little different: <br><br> <code>root=reports@gmail.com <br> mailhub=smtp.gmail.com:587 <br> hostname=localhost <br> UseSTARTTLS=YES <br> AuthUser=reports@gmail.com <br> AuthPass=qwerty</code> <br> <br>  We are trying to send a test letter using ssmtp: <br><br> <code>echo "" | ssmtp -v -s Hello admin@example.ru</code> <br> <br>  If the letter is successfully reached, then everything was done correctly.  If ssmtp says something like: <br><br> <code>. . . <br> [-&gt;] MAIL FROM:&lt;root@localhost&gt; <br> [&lt;-] 573 root@localhost failed to route the address <br> ssmtp: 573 root@localhost failed to route the address</code> <br> <br>  also not a problem, just ssmtp indicated the wrong address of the sender, and the smtp-server noticed this.  When we send mail through mutt, everything will be set correctly. <br><br>  To mutt send mail via ssmtp, in the home directory of the user, on behalf of which we are going to send reports, you need to correct the file .muttrc <br><br> <code>set sendmail="/usr/local/sbin/ssmtp" #   ssmtp <br> set realname="Example Report System" #   <br> set from="reports@example.ru" # e-mail </code> <br> <br>  Checking the work of mutt: <br><br> <code>echo "" | mutt -s Hello admin@example.ru</code> <br> <br>  The letter must successfully reach the recipient.  If you want to use mutt in cron scripts, you should keep in mind that mutt is in the / usr / local / bin directory, which by default is not set in the PATH environment variable in your crontab.  Decisions two - either correct the PATH environment variable in the crontab, or use the full name mutt in the scripts. <br><br>  It also happens that on the server from which you have to send reports, we do not have root privileges.  In this case, you either have to persuade the admin to install and configure mutt, or still write your own script to send email.  But that's another story. </div><p>Source: <a href="https://habr.com/ru/post/82919/">https://habr.com/ru/post/82919/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../82910/index.html">And again, history repeats itself ... Spam with viruses, act two</a></li>
<li><a href="../82913/index.html">What is the global torrent traffic?</a></li>
<li><a href="../82915/index.html">The first site in the zone. RF opened ... and does not work</a></li>
<li><a href="../82916/index.html">N Building: QR code building</a></li>
<li><a href="../82917/index.html">Is Intel LGA775 Platform Dead? From SLI to Intel X48 - hardly!</a></li>
<li><a href="../82920/index.html">MediaWiki can use open video - it is involved in wiki.mozilla.org</a></li>
<li><a href="../82921/index.html">All-Russian Olympiad in Applied Informatics</a></li>
<li><a href="../82923/index.html">Wait, the letter, do not hurry</a></li>
<li><a href="../82926/index.html">First Nexus One Update Released</a></li>
<li><a href="../82932/index.html">IPhone OS 3.1.3 released</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>