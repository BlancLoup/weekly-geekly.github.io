<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hg Init: Part 4. Correcting errors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the fourth part of the Hg Init Series : A Mercurial Study Guide by Joel Spolsky . Previous parts: 


- "Retraining for Subversion Users" 
- "T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hg Init: Part 4. Correcting errors</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/eebea7f1/5482efc4/01467053/55589e0f.png" align="left">  This is the fourth part of the <b>Hg Init</b> Series <b>: A Mercurial Study Guide by</b> <a href="http://www.joelonsoftware.com/">Joel Spolsky</a> .  Previous parts: <br><ul><li>  <a href="http://habrahabr.ru/blogs/development_tools/108443/">"Retraining for Subversion Users"</a> </li><li>  <a href="http://habrahabr.ru/blogs/development_tools/108658/">"The Basics of Mercurial"</a> </li><li>  <a href="http://habrahabr.ru/blogs/development_tools/108904/">‚ÄúWe get used to working in a team‚Äù</a> </li></ul><br><br>  One of the main advantages of Mercurial is that you can use personal repository clones to experiment and develop new features.  If something went wrong, you can fix it in an instant. <br><br><h4>  Part 4. Correcting errors </h4>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage/6fd42c43/97dcbec7/981c68fc/c68c9abb.png" align="left"><br>  Mercurial allows you to experiment freely.  Imagine that while you were working, you did something wrong in the editor, and something terrible happened: <br><br><a name="habracut"></a><br><br><img src="https://habrastorage.org/storage/ca13ab4d/255dd0bc/0bb0ae94/924be9f7.png"><br><br>  Emacs, how I love you.  Anyway, everything can be fixed.  The most common way to deal with such problems is to use the <code>hg revert</code> command: <br><br><img src="https://habrastorage.org/storage/64abc0c1/6b548170/8fb06654/8d15fb91.png"><br><br><blockquote> <code>hg revert</code> <br>  returns files to the state fixed in the repository. <br></blockquote><br><br>  This command will return the files to the exact state they had at the time of the last commit.  Mercurial doesn‚Äôt like to delete anything, so instead of <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D1%2580%25D0%25BE%25D1%2581%25D1%258F%25D1%2587%25D1%258C%25D1%258F_%25D0%25BB%25D0%25B0%25D1%2582%25D1%258B%25D0%25BD%25D1%258C">wiping the</a> recipe in <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D1%2580%25D0%25BE%25D1%2581%25D1%258F%25D1%2587%25D1%258C%25D1%258F_%25D0%25BB%25D0%25B0%25D1%2582%25D1%258B%25D0%25BD%25D1%258C">Latin</a> , he renamed the file: <br><br><img src="https://habrastorage.org/storage/6bd1f78e/ff44c2ff/2af58601/3d594470.png"><br><br>  And what if everything has gone too far and you are already commited? <br><br><img src="https://habrastorage.org/storage/9de936e9/28f4c3ef/539275c3/d981bd2d.png"><br><br>  There is a <code>hg rollback</code> command that will save your skin, but only if you have not yet pushed (push) an erroneous commit into another repository.  This command cancels <i>one</i> commit. <br><br><img src="https://habrastorage.org/storage/25fdbb00/217ac772/0e6e63d8/beaa92be.png"><br><br><blockquote> <code>hg rollback</code> <br>  cancels one commit, provided that you do not push it into another repository. <br></blockquote><br><br>  Imagine you want to make a big experiment in your free time.  Your boss hired a new designer, Jim.  Since then, the designs that you receive have become simply absurd.  They have an acidic green text, nothing is aligned (there are ‚Äúartistic‚Äù reasons for this, yeah) and usability is lame.  You want to come to work on the weekend and redo everything, but you are afraid to commit your changes, because you are not 100% sure that your ideas are better than that of this crazy designer.  Jim smokes grass almost all the time from the moment he wakes up until he goes to bed.  You do not want to use it against him, and everyone thinks that this habit does not concern anyone until the designs are in order.  But there is a limit to everything.  Right?  And Jim's designs are not in order, and in general he is a brash one. <br><br>  When working with Mercurial, you can simply create a clone of the entire repository: <br><br><img src="https://habrastorage.org/storage/68c027bf/7ef55f11/c341dc59/60dc90f0.png"><br><br>  It is not as wasteful as it may seem.  Since the <b>recipes</b> and <b>recipes-experiment</b> repositories store the same thing (for now), Mercurial will use the ‚Äú <a href="http://ru.wikipedia.org/wiki/%25D0%2596%25D1%2591%25D1%2581%25D1%2582%25D0%25BA%25D0%25B0%25D1%258F_%25D1%2581%25D1%2581%25D1%258B%25D0%25BB%25D0%25BA%25D0%25B0">hard links</a> ‚Äù.  So, a copy of the repository will be created quickly and does not take a lot of additional disk space. <br><br>  Now you can make a number of changes in the experimental branch: <br><br><img src="https://habrastorage.org/storage/96ad9731/6fd2c79f/d458d7b9/235b60bd.png"><br><br>  We begin my great experiment on the recipe for guacamole: <br><br><img src="https://habrastorage.org/storage/c49c10f0/cfdb23e3/4d84fb94/fa0ded5b.png"><br><br>  In the experimental repository, you can commit without fear: <br><br><img src="https://habrastorage.org/storage/71deac19/a844b427/b4ed24c9/e60a80d9.png"><br><br>  You can safely make changes, fixing the result whenever you want.  It gives you all the power of version control even for your crazy experiment, and no one gets hurt. <br><br>  If you decide that the experiment failed, you can simply delete the entire directory with the experimental repository.  No repository - no problem. <br><br>  But if everything worked out, then you only need to push through your new edits: <br><br><img src="https://habrastorage.org/storage/01fcf609/6a0e9029/b4787faa/73f02234.png"><br><br>  And where are they pushed? <br><br><img src="https://habrastorage.org/storage/5b52ac76/64573441/dfe23550/342d9ba9.png"><br><br><blockquote> <code>hg paths</code> <br>  displays a list of known remote repositories. <br></blockquote><br><br>  The line starting with ‚Äúdefault‚Äù contains the path to the repository, in which <code>hg push</code> pushes the changes unless you explicitly specify another repository.  Usually this line contains the path to the repository from which you made the clone.  In this case, it is a local directory, but the URL can also be a path. <br><br><img src="https://habrastorage.org/storage/f6f677ed/a911d2d6/f822cef7/33993dea.png"><br><br>  Don't forget that pushing changes into this <i>repository ...</i> <br><br><img src="https://habrastorage.org/storage/5b3e3e5b/cf6dbd5e/0f29418a/c0738e7e.png"><br><br>  ... does not cause changes to appear in the working directory. <br><br><img src="https://habrastorage.org/storage/742d905e/607cbf55/51688a01/bb5b1f96.png"><br><br><blockquote> <code>hg parent</code> <br>  displays the change set in the working directory. <br></blockquote><br><br>  See you  Edits about ‚ÄúQueso‚Äù in the fifth set of changes.  But in my main repository, the work stopped at the fourth set of changes.  From the fact that someone pushed changes to the <i>repository</i> , the working directory was not updated, and the fifth set of changes in it did not appear.  So I'm still working on the fourth set of changes. <br><br><img src="https://habrastorage.org/storage/81287b1f/9096f4a3/eae68e64/5fe130a5.png"><br><br>  If I want to know that in the fifth set of changes, then I will need to use the <code>hg update</code> command: <br><br><img src="https://habrastorage.org/storage/023fc2aa/41243289/e94f5f67/35276977.png"><br><br>  See what happened?  Changes were received, but they were after the version with which I worked.  The <code>push</code> and <code>pull</code> commands simply forward changes between repositories.  These commands do not affect what I'm working with at the moment. <br><br>  Now the repositories look like this: <br><br><img src="https://habrastorage.org/storage/6ebe8da2/5fac7827/7dd53ab1/5a118ca1.png"><br><br>  Mercurial is flexible when it comes to forwarding changes from repository to repository.  You can push changes directly from the experimental to the central repository: <br><br><img src="https://habrastorage.org/storage/5b5c8de5/3a4fa941/a7e099f2/bc357932.png"><br><br>  So the fifth changeset was sent from the pilot straight to the central repository.  Now, if I return to my main repository, I‚Äôll see that there‚Äôs nothing more to push through! <br><br><img src="https://habrastorage.org/storage/bbd0ef75/4601b945/c3774a27/4df5c17c.png"><br><br>  This is because Mercurial knows that in the central repository this (fifth) set of changes is already from somewhere.  This is truly useful, because otherwise Mercurial might try to reapply the changes and become seriously confused. <br><br>  Designer Jim, after being offered a job, promised to get down to business right away.  However, he did not appear at work for another two months.  Almost everyone has already forgotten about him and about the fact that they offered him a job, so when he was all so tanned first appeared in the office, honestly, no one could really understand who he was and what was going on at all.  That was pretty funny.  His appearance is typical.  In the end, everything was sorted out, but since he was new, everyone was ashamed to ask him what the hell had happened.  And about the scars and bruises on his face, too, did not ask.  Never mind.  We just hate this guy. <br><br>  Sometimes it happens that after months, you find that you made a mistake. <br><br><img src="https://habrastorage.org/storage/deaea912/fe92dd6c/ec887aaa/889f199f.png"><br><br>  Potato chips?  What a..?! <br><br>  Mercurial can remove the old changeset from the history.  Mercurial looks at the change set, determines the reverse actions, and changes the current working directory.  Let's try to remove that old revision number 2. <br><br><img src="https://habrastorage.org/storage/4667451a/25bdb499/f632481c/2a066f45.png"><br><br>  Mother of God, what was that? <br><br><img src="https://habrastorage.org/storage/fd39bd64/6a0afc42/b16be42c/96ff7f13.png"><br><br>  Generally speaking, a lot of time could pass.  Chips in general could disappear from the recipe.  A lot of creepy things could happen.  This means that sometimes after a revision is deleted, the changes cannot be merged.  In such cases, you will get merge conflicts that you need to somehow resolve.  We will talk about this in the next section. <br><br><h5>  check yourself </h5><br><br>  Here is what you should be able to do after reading this part: <br><ol><li>  Roll back random changes.  Before they are fixed in the repository, and after. </li><li>  Locate the repository locally for experiments. </li><li>  Push changes to different repositories. </li><li>  Roll back the old error, which was long ago fixed in the repository. </li></ol><br><br>  Continued here: <br>  <a href="http://habrahabr.ru/blogs/development_tools/109203/">Hg Init: Part 5. The merger process</a> </div><p>Source: <a href="https://habr.com/ru/post/109074/">https://habr.com/ru/post/109074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../109067/index.html">Student Startup of the Year Award</a></li>
<li><a href="../109068/index.html">Bye Cupertino!</a></li>
<li><a href="../109069/index.html">Startup Weekend Moscow: Schedule for December 3, 4 and 5</a></li>
<li><a href="../109072/index.html">Motorola DEFY: first impressions</a></li>
<li><a href="../109073/index.html">Multitvittering, statistics, convenience, scheduled posting and all that CoTweet</a></li>
<li><a href="../109075/index.html">Overview: 10 Russian SaaS project management systems</a></li>
<li><a href="../109076/index.html">Candy for Valerka</a></li>
<li><a href="../109077/index.html">Functional testing of pain-free web applications</a></li>
<li><a href="../109078/index.html">GPS satellite has been in orbit for the third decade</a></li>
<li><a href="../109079/index.html">HTML5 File API: multiple files upload to server</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>