<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability in MS SQL Server 2000</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Hello! 

 Today I want to share with you one very unpleasant observation on the work of MS SQL Server 2000. 

 I work in a company that still u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability in MS SQL Server 2000</h1><div class="post__text post__text-html js-mediator-article">  Hello, Hello! <br><br>  Today I want to share with you one very unpleasant observation on the work of MS SQL Server 2000. <br><br>  I work in a company that still uses MS SQL Server 2000 in its branches. I don‚Äôt know what goals they are pursuing with this, but this is not important, since the system is stable and the goals and tasks are fulfilled. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's start in order.  I ask under habrakat. <br><a name="habracut"></a><br><br><h4>  Objectives of the solution </h4><br>  MS SQL Server 2000 performs the role of a database server, collecting and storing information and sharing it with Moscow and our subordinate representative offices, which are located at a distance of 100 km or more from our branch. We ourselves are at a distance of more than 2500 km from Moscow. This is so for the big picture. <br><br>  When appearing in our branch office, as well as in the subordinate representative offices of normal and stable access to the Internet, it was decided to tie up with sending files by mail for data exchange.  To this end, it was decided to connect at that time two ADSL modems for me and at the representative office through the DynDNS service for data exchange. <br><br><h5>  No sooner said than done </h5><br>  We register two free accounts on DynDNS.org, we get a host, register in modems in the DDNS section, set up virtual servers in modems and forward to port 3389 (RDP), for more convenient operation.  With this, when connecting to a remote host, via Linux rdesktop, I received the connected disk of my Linux machine and quietly exchanged files. <br><br>  Files are Access databases, which are formed on a remote MS SQL Server 2000, and by means of programs written by Moscow, uploaded to my MS SQL Server 2000. <br><br>  After such not tricky manipulations, the work went faster, but did not suit one, every day began with one thing: <br>  Morning, I came to work formed a file at myself, connected, formed a file on a remote server, transferred my file to a remote one, transferred it from a remote file to my own, uploaded them with special programs on MS SQL Server.  Tired out. <br><br>  It was decided to combine two MS SQL Servers using DynDNS with port forwarding in TCP modems 1433-1434 and UDP 1433-1434. <br><br><h5>  No sooner said than done </h5><br>  We go into the ADSL modem in the virtual servers section, forwarding TCP TCP ports.  Connect special programs to a remote server and exchange data: <br>  MS SQL Server Branch &lt;-&gt; MS SQL Server Representation.  Hurray would say everything, so I said, but in the morning the most terrible and incomprehensible happened.  Intrigue? <br><br>  The next morning, after the automatic exchange of data between the SQL servers was set up at night, I received two dead MS Windows 2003. What do you mean dead: <br><ul><li>  My MS Windows 2003 on which the Filial SQL server stood, fell off the domain on the network, did not let the network go to the ball and after reboot did not connect to the domain. </li></ul><br><ul><li>  remote MS Windows 2003 on which the SQL Server of the representative office stood, although it somehow responded to the connections, but behaved extremely inadequately, it would not allow to connect via RDP, then IIS fell, which was simply necessary in the representative office. </li></ul><br>  The blessing in the branch for such cases lay the backup of your MS Windows 2003, and the SQL databases were backed up on the SLES server.  The work of the branch server was restored in a short period of time.  Remote remind 100 km.  go, was tested for viruses that have not been identified!  After checking the server manually, what is wrong with it, it was found that the owner of the C: drive changed on the server and the remaining drives were undefined.  For the sake of interest, I tried to return it on all the disks of the owner, the Administrator.  After several hours of changing attributes, the server began to work normally.  With peace of mind, I checked the exchange and info in the databases, everything was in place. <br><br>  The next morning.  The same picture !!!  Horror. <br><br>  I decided to try the owner recovery method on the Filial server because the owner was not defined.  Restored at home, Restored at the remote all earned.  And then the question arose because of what is happening.  The answer was found the next morning, when, before this, I also remotely removed the forwarding of SQL Server ports, and remind TCP UDP 1433-1434.  In the morning the server worked without errors. <br><br>  Bug  Breaking into?  Vulnerability?  What?  It tormented me for a long time while I was transferring files between computers in the old way.  Finally, a fiber optic Internet with white IP appeared in the branch.  Well, now I think everything will be fine.  Although the representative office still had a dynamic IP with a transfer to 3389 (RDP). <br><br><h4>  Solution of the problem of combining SQL servers using OpenSUSE, DynDNS </h4><br>  The task remained the same, to combine two SQL servers. <br><br><h5>  No sooner said than done </h5><br>  At first there was a simple goal, through OpenSUSE performing the role of a Router to push the port to the SQL server of the network in the firewall, we write <br><br>  FW_FORWARD_MASQ = "0/0, ip_sql_server, tcp, 1433.1434, our_white_IP 0/0, ip_sql_server, udp, 1433.1434, our_white_IP" <br><br>  Opening ports 1433-1434 <br><br>  This means that the traffic going to the machine with white ip on ports 1433 1434 is redirected to the machine with the SQL server of the internal network. <br><br>  From a remote computer we try to connect to the SQL of our network, the connection was successful.  Hooray!  But one thing remains, as my SQL server to connect to a remote server.  I make the decision to forward the SQL port on the ADSL modem of the remote computer.  And by means of DynDNS connect from yourself to it.  Forward, connect, share data.  Well, we are waiting for the morning. <br><br>  Morning.  Nde  This time is not so bad! <br>  1. on my server in the root of the C drive: the files are: <br>  xp5.exe <br>  server.exe <br>  hex.exe <br>  and a bunch of incomprehensible dll'ok <br>  Someone was on the server!  :) Also, tasks like a.exe server.exe appeared in the job server SQL server and so on, and what is interesting is not to be determined by all antivirus. <br>  2. the same story on a remote server. <br>  But besides, the ADSL modem is hanging, I cannot remove the forwarding. <br>  Simple manual cleaning, deleting these files, killing processes, cleaning the SQL job. <br>  Connect via telnet, reset the modem completely. <br>  Reboot <br><br>  In general, the solution to this problem was always in plain sight. <br><br><h4>  Climax </h4><br>  We are raising to openSUSE vpn server pptpd (did not bother with openvpn) in the firewall we write: <br><br>  FW_FORWARD = ‚Äùnet_vpn, ip_server_sql_local ip_server_sql_local, net_vpn‚Äù <br><br>  The remote server connects to the vpn server, gets an IP and only sees the sql server on my network.  The exchange is normal and calm MORNING. <br><br>  That's all.  Works like a clock. <br><br>  Shl.  I wrote on my own, without going into details of the settings, if that is not what I suffer in the comments. </div><p>Source: <a href="https://habr.com/ru/post/142386/">https://habr.com/ru/post/142386/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142377/index.html">Headache-free resources</a></li>
<li><a href="../142381/index.html">Memo to the system administrator: templates - the first step of migration to the cloud</a></li>
<li><a href="../142382/index.html">Let's pause. A way to improve thread synchronization</a></li>
<li><a href="../142383/index.html">How to increase the mobility of home desktop or ‚Äúdo not part with your loved ones‚Äù</a></li>
<li><a href="../142385/index.html">10 best tools for developing and administering MySQL</a></li>
<li><a href="../142387/index.html">How to find a letter from the past</a></li>
<li><a href="../142388/index.html">What platform does your phone work on?</a></li>
<li><a href="../142389/index.html">Proxy for Android</a></li>
<li><a href="../142390/index.html">My way to backup Oracle database on Windows</a></li>
<li><a href="../142392/index.html">1C-Hosting by ColoBridge</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>