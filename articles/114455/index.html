<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Design Pattern "Team" / "Command"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Read the description of other patterns. 


 Problem 
 It is necessary to have an effective presentation of requests to a certain system, while not hav...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Design Pattern "Team" / "Command"</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://spiff.habrahabr.ru/blog/84706/">Read the</a> description of other patterns. <br><img src="https://habrastorage.org/getpro/habr/post_images/238/6e3/f3f/2386e3f3f7d74791d5ef725b3f6d51f3.jpg" alt="A" align="right"><br><br><h4>  Problem </h4><br>  It is necessary to have an effective presentation of requests to a certain system, while not having knowledge of their nature or of how to handle them. <br><br><h4>  Description </h4><br>  There are at least three motivations for using the ‚ÄúTeam‚Äù template: <br><ul><li>  encapsulating the request as an object for subsequent logging / logging, etc. </li><li>  endowing the entity ‚Äúcalling the object's method‚Äù with the properties of an independent object; </li><li>  object-oriented callback; 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  In fact, all of the above motivations boil down to one thing - <b>‚Äúencapsulating a request as an object‚Äù</b> .  There are a large number of types of systems where such an approach is effective and justified.  First of all, this is any more serious desktop application with undo and redo user actions (undo / redo).  Secondly, these are network distributed systems that use requests in the form of objects as the main primitive for initializing any operations.  Third, systems with asynchronous call support encapsulate a callback in the form of a callback object.  The list can be infinite, it is important to understand that the command pattern is one of the most common patterns, which, one can say, appeared literally at the stage of the establishment of the OOP and only then was formalized and described in the GoF book. <br><br>  The basic idea of ‚Äã‚Äãthe template is to use a single interface to describe all types of operations that can be performed with the system.  Then, to add support for a new operation to the system, it suffices to implement the proposed interface.  Thus, each operation is represented as an independent object encapsulating some set of additional properties.  The system, in turn, acquires the ability to perform an additional set of actions on requests (objects).  These are logging, cancellation of the previous action, repetition of the subsequent one, etc. <br><br><h4>  Practical example </h4><br>  Consider the most obvious motivation for using a pattern - logging / undo-redo.  To do this, imagine that it was <pre>  &lt;sarcasm&gt; </pre>  if Stephen Bourne (by bash) had read the GoF book and knew what the ‚ÄúTeam‚Äù design pattern is <pre>  &lt;/ sarcasm&gt; </pre>  .  It would be about the following: <br><ul><li>  each shell command would be encased in a separate class ‚Äî a descendant of the class Command; </li><li>  the command shell would support logging / logging mechanisms and, most importantly, undo and redo (undo / redo) user actions, i.e.  teams; </li></ul><br><br>  We will try to change the problems in the design of the existing solutions and write our <s>bike</s> going <i>with the possibility of canceling and repeating commands</i> . <br><br>  To achieve this goal, it is enough to introduce the concept of a queue of executed commands to which any command (object, successor to Command) falls after the execution and a queue of canceled commands to which any canceled command goes.  In addition, it is necessary to have separate mechanisms for executing and canceling a team‚Äôs actions.  Obviously, these mechanisms are individual for each team.  Then, for the implementation of a complete system, it is enough for us, in terms of two queues, to apply corresponding actions to the objects located at their apex - execution or cancellation. <br><br><h4>  Class diagram </h4><br>  Each command supported by the shell must extend the Command class, implementing three methods - execute (), cancel () and name () - execution, cancellation and the name of the command, respectively. <br><br>  The command shell class is shown only for clarity.  In the above implementation, it is replaced by the main () method. <br><img src="https://habrastorage.org/storage/e9bab559/da34b323/95939d70/b134d6b7.png"><br><br><h4>  Python implementation </h4><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: cp1251 -*- from sys import stdout as console #   exit class SessionClosed(Exception): def __init__(self, value): self.value = value #   class Command: def execute(self): raise NotImplementedError() def cancel(self): raise NotImplementedError() def name(): raise NotImplementedError() #  rm class RmCommand(Command): def execute(self): console.write("You are executed \"rm\" command\n") def cancel(self): console.write("You are canceled \"rm\" command\n") def name(self): return "rm" #  uptime class UptimeCommand(Command): def execute(self): console.write("You are executed \"uptime\" command\n") def cancel(self): console.write("You are canceled \"uptime\" command\n") def name(self): return "uptime" #  undo class UndoCommand(Command): def execute(self): try: cmd = HISTORY.pop() TRASH.append(cmd) console.write("Undo command \"{0}\"\n".format(cmd.name())) cmd.cancel() except IndexError: console.write("ERROR: HISTORY is empty\n") def name(self): return "undo" #  redo class RedoCommand(Command): def execute(self): try: cmd = TRASH.pop() HISTORY.append(cmd) console.write("Redo command \"{0}\"\n".format(cmd.name())) cmd.execute() except IndexError: console.write("ERROR: TRASH is empty\n") def name(self): return "redo" #  history class HistoryCommand(Command): def execute(self): i = 0 for cmd in HISTORY: console.write("{0}: {1}\n".format(i, cmd.name())) i = i + 1 def name(self): print "history" #  exit class ExitCommand(Command): def execute(self): raise SessionClosed("Good bay!") def name(self): return "exit" #    COMMANDS = {'rm': RmCommand(), 'uptime': UptimeCommand(), 'undo': UndoCommand(), 'redo': RedoCommand(), 'history': HistoryCommand(), 'exit': ExitCommand()} HISTORY = list() TRASH = list() #  def main(): try: while True: console.flush() console.write("pysh &gt;&gt; ") cmd = raw_input() try: command = COMMANDS[cmd] command.execute() if not isinstance(command, UndoCommand) and not isinstance(command, RedoCommand) and not isinstance(command, HistoryCommand): TRASH = list() HISTORY.append(command) except KeyError: console.write("ERROR: Command \"%s\" not found\n" % cmd) except SessionClosed as e: console.write(e.value) if __name__ == "__main__": main()</span></span></code> </pre> <br><br><h4>  Using </h4><br><pre> <code class="bash hljs">$ python pysh.py pysh &gt;&gt; rm You are executed <span class="hljs-string"><span class="hljs-string">"rm"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> pysh &gt;&gt; rm You are executed <span class="hljs-string"><span class="hljs-string">"rm"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> pysh &gt;&gt; rm You are executed <span class="hljs-string"><span class="hljs-string">"rm"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> pysh &gt;&gt; <span class="hljs-built_in"><span class="hljs-built_in">history</span></span> 0: rm 1: rm 2: rm pysh &gt;&gt; undo Undo <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> <span class="hljs-string"><span class="hljs-string">"rm"</span></span> You are canceled <span class="hljs-string"><span class="hljs-string">"rm"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> pysh &gt;&gt; <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> Good bay!</code> </pre><br><br><h4>  Note </h4><br>  In some sources, the pattern is called <b>Action / Action</b> or <b>Transaction / Transaction</b> . </li></ul></div><p>Source: <a href="https://habr.com/ru/post/114455/">https://habr.com/ru/post/114455/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../11445/index.html">Mail.ru will find the main character for the third "Antikiller"</a></li>
<li><a href="../114450/index.html">Assessing the harmfulness of files using sandboxes, Part 2. Analysis offline</a></li>
<li><a href="../114452/index.html">Algorithms for image contour selection</a></li>
<li><a href="../114453/index.html">Belarus faces 38 years in prison for setting up CallService.biz</a></li>
<li><a href="../114454/index.html">Initializr - HTML5 based project generator</a></li>
<li><a href="../114456/index.html">Thunderbolt - like a bolt from the blue</a></li>
<li><a href="../114457/index.html">We collect Mini Bedlam Cube</a></li>
<li><a href="../114459/index.html">Little coders</a></li>
<li><a href="../11446/index.html">Lebedev and Nokia</a></li>
<li><a href="../114460/index.html">What do people do to make the computer faster</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>