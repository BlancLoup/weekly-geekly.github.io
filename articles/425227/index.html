<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Researchers have found a way to detect and circumvent Honeytoken keys in a number of Amazon services.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the modern information security paradigm for the masses, the opinion is firmly entrenched that cyber security is expensive, difficult, and virtuall...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Researchers have found a way to detect and circumvent Honeytoken keys in a number of Amazon services.</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/im/8r/zp/im8rzpzvpzydngx55gtihmbput0.png"></div><br><br>  In the modern information security paradigm for the masses, the opinion is firmly entrenched that cyber security is expensive, difficult, and virtually impossible for the average user.  So if you want to fully protect your data and personal information, get yourself an account with Google or Amazon, nail it to identify the owner and periodically check the alarm alerts that a large and strong company has stopped another login attempt. <br><br>  But people who understand information security always knew that cloud services are much more vulnerable than a separate workstation.  Indeed, in the case of a force majeure PC, you can physically restrict access to the network, and there already begins the race for changing turnouts and passwords in all the attacked directions.  The cloud infrastructure is huge, often decentralized, and data from several clients can be stored on the same physical medium, or vice versa, the data of one client is spread across five continents, and only an account can unite them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In short, when the Internet was relatively fresh and young (as it was in 2003), then information security specialists took a close look at <a href="https://en.wikipedia.org/wiki/Buffer_overflow_protection">the buffer overflow protection system of</a> 1997, and released the technology that we now call <a href="https://en.wikipedia.org/wiki/Honeytoken">Honeytoken</a> or Canarytoken.  And for fifteen years they have been working properly (and are still working), only the latest study says that instead of the last line of defense in a number of AWS services, Honeytoken turned into a gaping hole in information security due to the implementation on the Amazon side. <br><a name="habracut"></a><br><h3>  What is Honeytoken? </h3><br>  Honeytoken, like its ideological progenitor in the stack overflow protection system, uses a ‚Äúwarn, not prevent‚Äù approach.  In fact, Honeytoken is a bait for intruders, which is left under the guise of valuable information and can be presented in the form of, for example, links.  The most obvious Honeytoken in the practice of ordinary users - a link-alarm, hidden in the letter with the title "data on bank accounts" or "my accounts."  The principle is also simple: as soon as the attacker covet the information that Honeytoken pretends to be, the latter sends a notification to the owner / administrator that the security perimeter has been violated. <br><br>  In the perimeter itself, Honeytoken obviously does not include: in the classical form, this is a banal dummy, which is already inside the perimeter and fulfills the same role that the dying canaries in the miners' faces played in - the danger warning. <br><br><img src="https://habrastorage.org/webt/kx/kb/lf/kxkblfq7t1jl5c_ghvrdrq2o-4e.png"><br>  <i>And here is the progenitor of technology</i> <br><br>  Such "signaling systems" are now fairly common and are used to alert personal account holders and prior to AWS security breach notification.  At the same time, there is no single standard Honeytoken - it could be anything.  For example, several special dead boxes are added to the lists of e-mail addresses of customers, the appearance of a mailing list on which will indicate that the entire database has been drained. <br><br><h3>  What is a vulnerability found in AWS </h3><br>  Amazon Web Services is actively using Honeytokens to receive alerts about the perimeter violation of the cloud security service.  Amazon's ‚ÄúCanaries‚Äù are fake account access keys.  For all its simplicity, this tool is extremely important: cloud services are subject to constant hacking attempts and other attacks.  The mere fact of owning knowledge about the ‚Äúbreakthrough‚Äù of the AWS cybersecurity perimeter in one direction is half the battle for Amazon engineers. <br><br>  Yesterday, October 2, 2018, experts from Rhino Security Labs <a href="https://rhinosecuritylabs.com/aws/aws-iam-enumeration-2-0-bypassing-cloudtrail-logging/">published an</a> extremely unpleasant study, the essence of which is expressed by the following statement: Honeytokens Amazon Web Services can be circumvented without disturbing the cloud signaling system.  This gives attackers the opportunity to quietly "enter", "take" what they need and also quietly "leave." <br><br>  The entire Honeytokes AWS architecture is based on the use of fake keys in conjunction with <a href="https://aws.amazon.com/ru/cloudtrail/">CloudTrail</a> , which also maintains activity logs.  But in the free access in the userguide Amazon has a whole list of addresses and services that do not support CloudTrail.  In fact, this means that any requests towards these services, including through the API, are not recorded anywhere.  In this case, the reverse message with access error Amazon returns with the <a href="https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html">ARN</a> . <br><br>  Next, researchers from Rhino Security knocked <a href="https://aws.amazon.com/ru/appstream2/">AWS AppStream</a> through <a href="https://docs.aws.amazon.com/appstream2/latest/APIReference/API_DescribeFleets.html">the DescribeFleets API</a> and obtained the following information about the test account: <br><br><img src="https://habrastorage.org/webt/lt/2g/el/lt2gela4ingue5c7vrxcy3aml5u.png"><br><br>  Then, using it, the attacker extracts information about the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction.html">IAM</a> user / role of the following plan: <br> <code>IAM User: <br> arn:aws:iam::111111111111:user/the-path/TheUserName <br> <br> IAM Role: <br> arn:aws:iam::111111111111:role/the-path/TheRoleName/TheSessionName</code> <br> <br>  As a result, thanks to the return of the ARN and the obtained IAM user / role data, the experts were able to compromise the Honeytokes bait keys on the listed services through the parsing. <br><br><h3>  Countermeasures </h3><br>  The found path puts at risk not only AWS, but also developers of popular honeytoken-systems for Amazon systems, such as <a href="https://canarytokens.org/generate">CanaryToken</a> and <a href="https://bitbucket.org/asecurityteam/spacecrab">SpaceCrab</a> .  Both developers have been notified and take all possible measures to eliminate the problem. <br><br>  Also, experts from Rhino Security have <a href="https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/awshoney_check/awshoney_check.py">published a</a> PoC script <a href="https://github.com/RhinoSecurityLabs/Security-Research/blob/master/tools/aws-pentest-tools/awshoney_check/awshoney_check.py">on GitHub</a> , which will check if the AWS key provided to you is not a token, since not all configurations have been updated yet. <br><br><h3>  Amazon reaction </h3><br>  Amazon replied to the report from Rhino Security Labs that the ARN is not sensitive information, CloudTrain works (and does not work) where needed, and there is no problem as such. </div><p>Source: <a href="https://habr.com/ru/post/425227/">https://habr.com/ru/post/425227/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425217/index.html">Resiliency of the application when updating the cluster Cubernetes</a></li>
<li><a href="../425219/index.html">What is mental health: a view from the psychology / psychotherapy</a></li>
<li><a href="../425221/index.html">How to produce plastic for 3D printing</a></li>
<li><a href="../425223/index.html">Android applications on JPHP</a></li>
<li><a href="../425225/index.html">How to see the links inside your PowerShell module</a></li>
<li><a href="../425229/index.html">How we helped CDN MegaFon.TV not to fall on the 2018 World Cup</a></li>
<li><a href="../425231/index.html">FAQ about the work of the stewardess</a></li>
<li><a href="../425233/index.html">Python 3 to facebook</a></li>
<li><a href="../425235/index.html">A little more about graphs, or how to detect dependencies between your applications.</a></li>
<li><a href="../425237/index.html">Time measurement with nanosecond precision</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>