<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Terabytes and tebibytes, traffic rating, the consequences of not understanding the difference and how to save on a video online project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, we had an interesting incident that really requires separate coverage and will help to avoid possible misunderstandings in the future...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Terabytes and tebibytes, traffic rating, the consequences of not understanding the difference and how to save on a video online project</h1><div class="post__text post__text-html js-mediator-article">  Not so long ago, we had an interesting incident that really requires separate coverage and will help to avoid possible misunderstandings in the future.  The case is unique in its own way, because the client, with whom we have successfully cooperated almost from the day of its official opening (2009, 7 years of work!), Accused us of fraud and very strange traffic accounting. <br><br>  And here the reason was not only in the lack of awareness of the client, but also of the administrators who trivially did not notice the difference, or did not realize it either.  It is for this reason that we decided to make out this case. <br><a name="habracut"></a><br><h2>  Prehistory </h2><br>  Elena came to us in 2009, not having the funds for her own dedicated server, but having a rather interesting project, we decided to give a chance - and gave a significant part of our own dedicated server resources, almost at cost.  Over time, the project grew and began to generate dozens and even hundreds of megabits of traffic, it required several dedicated servers.  And when the traffic became equal to 2 Gbit / s and the third was required, it became obvious that there is no better solution than the server with 10Gbps Unmetered connection for Elena.  After all, it was beneficial, both in price and in software optimization, although it provided less fault tolerance compared to the case of using multiple servers. <br><br>  For a while, the project worked and only gained momentum, but the situation changed, the dollar rose, advertising prices fell, online streaming faced difficulties from copyright advocates, the project‚Äôs popularity declined, as did the need for server support.  At the beginning, the project switched to a server with a 2x1 Gbit / s connection, then to 1 Gbit / s, and then it became obvious that it was more profitable to rent several promotional servers with 100 TB of traffic and a 1 Gbit / s connection than a single server with a gigabit connection and no traffic accounting. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For example, we offer a dedicated server in the Netherlands <a href="http://www.ua-hosting.company/servers">http://www.ua-hosting.company/servers</a> with a traffic limit of 100TB and a gigabit connection: <br><br>  2 x Intel Quad Core Xeon E5504 / 32GB DDR3 / 4 x 240GB SSD / 1Gbps 100TB - $ 139 / month, <br><br>  and those who need more disk space and do not need SSD - they can choose the same configuration with the E5620 processor and 6 drives of 2 TB each at about the same price. <br><br>  It is usually 3-4 times cheaper than 1 such server with 1 Gb / s connection and traffic without accounting, and at the same time, the offer is more profitable, because the result: <br><br>  - the subscriber receives a more fault-tolerant environment, since in the event of a hardware failure, only a part of the computing power and bandwidth becomes inaccessible; <br>  - a greater number of CPU, RAM, SSD or HDD drives (3-4 times); <br>  - it is possible to give more traffic. <br><br>  The last point is a paradox, but this is so, 3 servers with a connection of 1 Gbit / s and a traffic limit of 100 TB will allow more traffic than one server with a gigabit connection without traffic (in almost all cases), since in fact there is access to the channel at 3 Gb / s.  With a connection of 1 Gbit / s, it is unlikely to generate 300 TB of traffic, since the daily consumption curve is uneven, they pump much less at night than during the day, and 300 TB are achievable only with almost 100% channel utilization 100% of the time during the month so that this figure is real except in cases: <br><br>  - when there is saturation of the channel (users can consume more traffic, but does not allow the channel and as a result, the band is distributed between users, as a result of which each of the users can no longer get the maximum speed, and in some cases, for example, in the case of saturation of the channel with a large% of packet loss, even necessary, resulting in video buffering tupit); <br><br>  - in the case of a large% of incoming traffic (proxying, processing incoming requests, etc.). <br><br><h2>  Recommendations </h2><br>  Different providers consider traffic differently.  Someone removes data from the port of the switch, and someone only on the border, the root border router of the data center.  As a result, not all traffic can be taken into account, or even traffic that did not physically reach the server can be taken into account in the case of using the same netflow (the same DDOS over UDP, which was cut on the border).  Someone this statistics is updated online every few minutes, and someone - once a day.  For example, in the case of large volumes of traffic on border routers or a large amount of data for analysis, hundreds or even thousands of gigabits, it is quite difficult and expensive to update statistics more often than once a day, with the result that full statistics are available, but with delayed. <br><br>  For this reason, we always recommend our clients to keep 5-15% of unused traffic in reserve, depending on the intensity of daily consumption and the time required to supply and configure an additional server, to redistribute the load on it. <br><br>  Also, the reserve will be necessary in case one of the nodes fails and the load falls on the remaining nodes. <br><br>  As a result of this backup, you can save a lot of nerves, avoid problems with overspending, including due to the delay in updating statistics, delivering equipment, quietly waiting for the delivery of the server and setting it up, as well as reliving the worst scenario - the case of a node failure. <br><br>  Do not save these 5-15% of the budget, they are not worth it. <br><br>  In our case, the situation was more interesting, one that is not described by anything that is indicated above.  Although it took place only for the reason that the client did not leave a sufficient reserve, because there would be a reserve - this would not have arisen, and there would be no discrepancies in the traffic data, although they really did not exist ... <br><br><h2>  What happened </h2><br>  The client wanted to use traffic by almost 100%, despite the fact that 3 servers were in operation, a good discount was provided, but the 4th server, for another $ 100, the budget probably did not allow renting.  However, this is the client's choice, he has the right to it.  Moreover, we always make concessions to our subscribers and when it comes to adding a new server, in case of problems with payment, we give the opportunity to use the server for up to a month almost free of charge, as equipment is often available in reserve and when it is not available - we order for the client and provide the necessary delay. <br><br>  Nevertheless, Elena decided that she would get into the 100 TB limit, despite the fact that her statistics already talked about using almost 84, and there were 5 days left until the end of the month, and a banal calculation showed that there should not be enough traffic. hoped that the load was associated with the holidays and the traffic is still enough. <br><br>  To Elena's surprise, the traffic almost ended the next day, reaching a value of 87 TiB (according to her data) and 96 TB of ours, about which we informed Elena that it would be good to add a server. <br><br>  Elena, there are logical questions, why is our value greater, how is it? <br><br>  She appealed both to our support and to the support of the data center, since the statistics are still provided by the data center, with the question and the accusations, saying that the traffic is incorrectly calculated. <br><br>  The engineers were silent for a long time, updating the statistics data, but they did not reveal any discrepancies in the accounting and could not clearly answer this question to the client immediately.  And this was, by the way, the weekend, when people from the NOC department were available only by phone or very in critical cases, because they promised to give a detailed analysis of the situation no earlier than Monday. <br><br>  Our technical department apparently went down to work, or simply didn‚Äôt notice a small detail in the message from administrator Elena displaying data from vnstat, which its administrator used to collect statistics and who also thought that we had a problem, either on the data side center, because of which he sees not all traffic, and sent the following request through us to the data center, in which he stated that there was a discrepancy of 10% with his data and at the end even indicated possible reasons, in his opinion: <br><br><blockquote>  eth2 / monthly <br><br>  month rx |  tx |  total |  avg.  rate <br>  ------------------------ + ------------- + ----------- - + --------------- <br>  Jul '15 459.59 GiB |  16.68 TiB |  17.13 TiB |  54.93 Mbit / s <br>  Aug '15 1.05 TiB |  47.04 TiB |  48.10 TiB |  154.25 Mbit / s <br>  Sep '15 847.71 GiB |  37.69 TiB |  38.52 TiB |  127.66 Mbit / s <br>  Oct '15 865.86 GiB |  35.36 TiB |  36.21 TiB |  116.13 Mbit / s <br>  Nov '15 638.09 GiB |  28.18 TiB |  28.80 TiB |  95.45 Mbit / s <br>  Dec '15 483.77 GiB |  21.62 TiB |  22.09 TiB |  70.84 Mbit / s <br>  Jan '16 840.79 GiB |  36.21 TiB |  37.04 TiB |  118.78 Mbit / s <br>  Feb '16 2.20 TiB |  83.32 TiB |  85.52 TiB |  293.19 Mbit / s <br>  Mar '16 1.90 TiB |  84.92 TiB |  86.82 TiB |  304.64 Mbit / s <br>  ------------------------ + ------------- + ----------- - + --------------- <br>  estimated 2.08 TiB |  92.91 TiB |  94.99 TiB | <br><br>  Can you provide traffic for 1 day / 1 month for 7 days and etc? <br><br>  See it‚Äôs your server‚Äôs VLAN and multicast for example. <br><br>  Thank you. </blockquote><br>  Helen, without waiting for a response from the data center engineers, despite 7 years of successful cooperation, decided to publish on the Internet a review that we strangely consider traffic and even conduct dishonest records, and publicly, in forums, ‚ÄúIf you take hosting a server from limited traffic, you will have many surprises.  And it turns out that they consider the traffic as something special and they always have 10% more.  Moreover, the data is manipulated as they see fit. ‚Äù <br><br>  It also announced its intention to refuse our services. <br><br>  The information reached me and I tried to figure out what was the matter.  Immediately struck by the fact that the statistics still indicate TiB, and not TB.  Tebibytes, not terabytes.  That is, accounting is done on the binary system, and not decimal, based on the fact that in kilobyte, or rather in kibibite - 1024 bytes, and not 1000. <br><br>  It should be noted that in order for this distinction not to be used for marketing purposes, ISO (International Standartization Organization) has long introduced the prefix "bi" for binary bytes, that is, kibibytes, mebibytes, gibibytes, tebibytes.  However, marketing did take place, and if manufacturers of drives use decimal bytes ‚Äî they indicate smaller volumes of storage capacity, then when measuring and recording traffic, the situation worked exactly the opposite.  Data Center, providing 100 TB of traffic, provides it less than it can actually be. <br><br>  It would seem that the difference is small, only 24 bytes per 1000, the error from this is only 2.4%, but why does the client have such a big difference, at the level of 10%?  Can some traffic really be considered? <br><br>  And here I have already made a mistake, forgetting that the ‚Äúerror‚Äù is growing, namely: <br><br>  1024 bytes in a kibibete (if we speak in accordance with ISO standards), in mebibyte already 1024 * 1024 = 1 048 576 bytes, in a gibibite - 1024 * 1024 * 1024 = 1 073 741 824, and in tebibite - 1024 * 1024 * 1024 * 1024 = 1,099,511,627,776. <br><br>  Unexpected turn?  Yes? <br><br>  It turns out that on large volumes of traffic, the ‚Äúerror‚Äù reaches just 10%, which is observed by our client. <br><br>  The incident was exhausted and the client, after providing this information and detailed explanations, decided to continue working with us. <br><br><h2>  Findings. </h2><br>  - to ignore the effect of the difference between decimal and binary bytes with large traffic is no longer possible, for clarity, the differences in percentages - we give a screen from Wikipedia: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f83/7d1/8b3/f837d18b31af4404915ccdd63934bc50.png"></div><br>  - data centers have found a legal way to save traffic, because even giving the user a small amount of traffic, they often like to specify it in terabytes (the savings are maximum and 3% more than if specified in gigabytes), thus saving up to 5-10% of the traffic additionally, with a total consumption of, say, 2.4 terabits / s, it will provide up to a quarter of terabits of bandwidth savings!  And this, if we take the case of the channel from the first-level backbone operator - 600 * 256 = $ 153,600 per month or over a million dollars a year. <br><br>  It is precisely because taking into account the difference between decimal and binary bytes is extremely important, especially in the era of video streaming and the constant growth of traffic consumption, we decided to focus on this issue on Habr√©, perhaps many of you knew this difference, but surely far not everyone wondered how important it could be and how this knowledge could be effectively used, including for marketing purposes. <br><br>  We are very interested in whether this article was useful, because we want to conduct a small survey.  Please answer only honestly. </div><p>Source: <a href="https://habr.com/ru/post/309768/">https://habr.com/ru/post/309768/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309756/index.html">Modest - development of an open-source HTML rendering engine on the ‚Äúbare‚Äù C</a></li>
<li><a href="../309758/index.html">Shared Folders in OpenVZ 7.0</a></li>
<li><a href="../309760/index.html">How does the Center for the operational management of the MTS mobile network. Answers to your questions</a></li>
<li><a href="../309762/index.html">Home word splitting algorithm (with pictures)</a></li>
<li><a href="../309764/index.html">Susan Wojitsky: From CS50 Student to CEO Youtube</a></li>
<li><a href="../309772/index.html">Sorry, we are updating the protocol</a></li>
<li><a href="../309774/index.html">Happy programmer, or 10 facts about C ++++</a></li>
<li><a href="../309776/index.html">Your Data is so big: An introduction to Spark in Java</a></li>
<li><a href="../309778/index.html">Do I need a license to provide hosting services? (Telematic communication services) Or a conspiracy of consulting companies</a></li>
<li><a href="../309780/index.html">Using blocks in iOS. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>