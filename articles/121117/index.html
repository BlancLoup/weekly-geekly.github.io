<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Powerful database server for a little over $ 2000</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello habravchane. 

 A couple of months ago, the moment came when one of my portals ‚Äî the Tatar dating site stopped bearing the load in the evenings ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Powerful database server for a little over $ 2000</h1><div class="post__text post__text-html js-mediator-article">  Hello habravchane. <br><br>  A couple of months ago, the moment came when one of my portals ‚Äî the Tatar dating site stopped bearing the load in the evenings and stupidly fell.  Online reached up to 1,800 users with attendance of over 50 thousand per day (&gt; 20 thousand unique visitors).  The portal was located on one dedicated server.  During the analysis, it was found out that not only the processor, but also the entire disk subsystem, did not cope.  It was necessary to decide what to do next. <br><a name="habracut"></a><br>  For the coming year, at least a 1.5-fold increase in registered users and a corresponding increase in attendance and workload were planned.  At the moment, the database was about 15 GB in size. <br><br>  The portal was written on ASP.NET in conjunction with MS SQL Server 2008 R2 DBMS. <br>  The current server had the following configuration: processor - Intel Core Quad 9550 (12MB cache), 4 GB of memory, 2 disks - WD server with 7200 revolutions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The disk subsystem problem was solved simply by buying a 90 gigabyte SSD disk and placing photos on it, at the moment there are about 40 gigabytes (I can write a separate post about the experience of using SSD disks on servers). <br><br>  The second problem related to the processor could be solved by transferring the database to an additional server.  Since the budget was quite limited (about $ 2500), I decided that it was more profitable not to buy, but to assemble the server myself.  It was necessary to squeeze as much power as possible for this money, while maintaining sufficient reliability. <br><br>  Having a certain experience in both configuring and building servers, I decided to stop at a 2-processor server with 4 fast disks. <br>  server platform (the cheapest with support for 4 hot-swap drives and 2 processors): <br>  Tyan GT20B7002 - 1 pieces ~ $ 700, <br>  processors (under 1366 socket): <br>  Intel "Xeon E5620" - 2 pieces ~ $ 760 ($ 380 per piece) <br>  hard drives (the SAS budget was not allowed to take, SSD did not dare to use the database on the server): <br>  WD "VelociRaptor WD1500HLFS" - 4 pieces ~ $ 480 ($ 120 per piece), <br>  memory: <br>  2 GB ECC Kingston - 8 pcs ~ $ 540 <br><br>  Next, a photo report about the assembly and then a few tests: <br><img src="https://habrastorage.org/getpro/habr/post_images/5a4/365/dc6/5a4365dc6059ff6262b61ef713e6e201.jpg"><br>  Processors, memory, disks <br><br><img src="https://habrastorage.org/getpro/habr/post_images/768/614/4a5/7686144a5047e37fa995fcecd3227388.jpg"><br>  Everything is ready for assembly <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d6b/345/27c/d6b34527ce23f914828adfda502f559b.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/759/03f/0cb/75903f0cb06b654ab29f17dfc8454915.jpg"><br>  It remains to install the disks and run. <br><br>  After the build, I tested a server for several days under load, checked the disks and merged them 2 into software RAID 1. The first raid on the system and logs, and the second on the data.  Why not immediately in hardware RAID 10 you ask?  Yes, because I simply did not understand the BIOS of the motherboard of this platform.  There, as it is not obvious this is done. <br><br>  Installed MS SQL Server 2008R2 Standard.  In addition, I posted a base (25 GB) of another project with a slightly lower attendance (10 thousand hosts, maximum 800 online).  Here are graphs that reflect the peak hours (evening, 19-22 hours): <br><img src="https://habrastorage.org/getpro/habr/post_images/36a/9a6/c44/36a9a6c440bfb4a00a4987694744fec1.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/901/9bd/649/9019bd649453c41004ba7dc5e121a27b.png"><br>  Notice here about 2500 users online (total number of registered approximately 170 thousand). <br><br>  In conclusion, I want to note that I am very satisfied with the server, it met my expectations and reduced costs - I completely refused to rent servers.  It will be necessary to slightly suboptimize the database itself, then, I think, such an architecture will withstand 10 thousand online with several hundred thousand registered users. <br><br>  <b>UPD:</b> pictures stored in the file system. </div><p>Source: <a href="https://habr.com/ru/post/121117/">https://habr.com/ru/post/121117/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../121104/index.html">What can Ctrl in Visual Studio</a></li>
<li><a href="../121106/index.html">Mayor Cupertino approved Apple spacecraft</a></li>
<li><a href="../121107/index.html">ICQ dropped</a></li>
<li><a href="../121113/index.html">Quick build C ++ libraries for Android</a></li>
<li><a href="../121114/index.html">Workshop Zend Framework. Part One: Authentication and Acl</a></li>
<li><a href="../121118/index.html">VNC monitor from Playboy / Vogue player ‚Äúfor dummies‚Äù</a></li>
<li><a href="../121120/index.html">Script backup vps servers</a></li>
<li><a href="../121125/index.html">About today's ICQ crash</a></li>
<li><a href="../121126/index.html">Using TileMill</a></li>
<li><a href="../121128/index.html">Google charges its employees for free</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>