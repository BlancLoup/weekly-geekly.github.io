<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kubernetes success stories in production. Part 2: Concur and SAP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue to tell on the example of well-known companies that Kubernetes in production is not only dreams and hopes. This article is again about wor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kubernetes success stories in production. Part 2: Concur and SAP</h1><div class="post__text post__text-html js-mediator-article">  We continue to tell on the example of well-known companies that Kubernetes in production is not only dreams and hopes.  This article is again about world-famous techies: SAP and its convergent cloud based on OpenStack and Kubernetes.  But let's start with the less well-known Concur, and here's why ... <br><br><img src="https://habrastorage.org/web/f2c/a60/e15/f2ca60e15cdc40878d3c383813127676.jpg"><br><a name="habracut"></a><br><h2>  Concur </h2><br>  Concur Technologies is an American company that has existed since 1993 and today has 6,800 employees.  Her business is SaaS for travel and cost management services for businesses.  In 2010, she managed to get into the hundred best small companies according to Forbes magazine, and according to actual data (2017), about 70% of Forbes 100 and Forbes 500 lists use its services.  In September 2014, <a href="https://dealbook.nytimes.com/2014/09/18/sap-buys-concur-technologies-for-8-3-billion/">it became known</a> that SAP buys Concur Technologies for 8.3 billion USD, and the takeover was completed in December of the same year. <br><br>  I decided to start the article about SAP with Concur, because this company, already a division of SAP, was an excellent example of one of the early serious users of Kubernetes in production.  The first information about this appeared in May 2016.  At the ContainerDays 2016 event held in Boston at the time, the leading engineer of Dale Ragan <a href="http://searchitoperations.techtarget.com/news/450297178/Tech-firms-roll-out-Kubernetes-in-production">gave an interview</a> in which he spoke about the experience of Concur. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The use of Kubernetes in the company began with a single piece of infrastructure - for a check management service.  At that time, Concur was already working with Amazon Web Services and wanted to run its application both locally (on-premises) and in the cloud.  To use EC2 Container Service, which was then in beta testing, they did not want to at Concur because of the emerging dependency on one supplier (Amazon). <br><br>  One of the noticeable obstacles in the operation of Kubernetes was the lack of support for AWS Availability Zones for NoSQL-storage etcd - the problem was solved by the efforts of the company's engineers and promised to transfer to the Open Source-community.  The result of the implementation of Kubernetes, according to the engineer Concur, was the ‚Äúimmutable infrastructure‚Äù (immutable infrastructure) - such that when you make changes to it, instead of modifying the existing cluster, a new one is created (and migration takes place there).  This allowed them to "feel confident during migrations, when versioning is done for the entire infrastructure, just as new versions of the application are deployed."  Prometheus and Grafana were introduced in the company to monitor performance, and the main problem for the Kubernetes project was that they didn‚Äôt provide good / detailed documentation for their implementation at Concur. <br><br>  <a href="https://developer.concur.com/blog/2016/06/20/ContainerDays-in-Boston.html">Speaking</a> about this event in his blog, Dale Ragan presented a general outline of the company's infrastructure in AWS based on Kubernetes: <br><br><img src="https://habrastorage.org/web/a46/3a1/437/a463a14372404f9099d63e766497d4bc.png"><br><br>  ... and promised to tell more about this project, but for some reason this did not happen. <br><br>  Despite this, the use of Kubernetes in Concur was actively pursued and developed.  In the autumn of the same year, the senior architect Dan Wilson <a href="https://www.youtube.com/watch%3Fv%3DeQ9R8prQUHU">spoke</a> at KubeCon 2016 with a report on scaling microservices using Kubernetes, and a year later at CoreOS Fest 2017 with a <a href="https://www.youtube.com/watch%3Fv%3DJLI900bldU0">report</a> ( <a href="http://schd.ws/hosted_files/coreosfest2017/4a/CoreOSFest-KubernetesClusterSelector.pptx">PowerPoint presentation</a> ) about using Federated Cluster Selector from Kubernetes 1.7. <br><br>  In the last report, architect Concur explained the choice of Kubernetes for the following reasons: <br><br><img src="https://habrastorage.org/web/fc2/642/017/fc264201727b4900b0f00555692557ad.png"><br><br>  Separate remarks are worth the fact that by 2017, Concur fell in love with CoreOS products (although they started with the use of only native Kubernetes components), including explaining this as ‚Äúthe best documentation for Kubernetes‚Äù.  The architecture of clusters in the company received the following form: <br><br><img src="https://habrastorage.org/web/581/66d/468/58166d46858a4582b3d4aef00b7f7182.png"><br><br>  In the same report, Dan Wilson presented one of the Open Source-projects Concur for Kubernetes - <a href="https://github.com/concur/kubegowatcher">kubegowatcher</a> .  This is a plug-in template that is designed to run in a container inside Kubernetes and track changes in services, sub-nodes and nodes (with the ability to add your business logic to add / modify / delete events of events).  Additionally, I note that the architect Concur makes his edits in the upstream Kubernetes itself. <br><br><h2>  SAP: DevOps, Microservices, Kubernetes (2016) </h2><br>  There is no official confirmation that Concur has had a solid experience with Kubernetes from SAP.  However, the general ideas were at least ‚Äúin the air‚Äù - even after the purchase of Concur, the head of SAP <a href="https://www.concur.com/sap">expressed</a> enthusiasm for ‚Äúexpanding the SAP <b>cloud</b> portfolio with leading travel and expense management solutions‚Äù. <br><br>  Anyway, the first public mention of Kubernetes for SAP needs is met in the summer of 2016, when cloud infrastructure architect Darren Hague spoke at the DevOps Enterprise Summit 2016 (DOES16) in London with the report " <a href="https://www.slideshare.net/ITRevolution/darren-hague-sa-ps-devops-journey">SAP's DevOps Journey: From Building App to Building a Cloud</a> " .  The company came to DevOps in 2010‚Äì2013 <i>(see the <a href="https://www.youtube.com/watch%3Fv%3DNJJdPlcCYK4">presentation of</a> the same author at FlowCon San Francisco 2013)</i> , and Kubernetes was the next logical step in its evolution. <br><br>  Representing Kubernetes, Darren conducted an analogy with pets and livestock borrowed from a CERN employee: if the former ‚Äúhave their own names, are unique, receive care with love and restore health in the event of problems,‚Äù the latter ‚Äúget numbers instead of names, are almost identical to each other and they are easily replaced in the case of diseases ‚Äù <i>(I‚Äôd personally add that I don‚Äôt completely share this attitude towards animals, but this goes far beyond the article)</i> .  So Kubernetes, in the opinion of the SAP architect, is the ability to "handle containers like cattle, not pets." <br><br>  One of the peculiarities of using the Kubernetes system in the SAP infrastructure was its use as a foundation, on top of which (that is, in the Docker containers of which) the cloud platform OpenStack was launched.  Already in the middle of 2016, the company's task was announced to implement such a new platform in 13 regions and 18 data centers so that it would be used simultaneously ‚Äúfor SAP cloud services and for internal innovations‚Äù.  Communication vision of the platform was as follows: <br><br><img src="https://habrastorage.org/web/cfa/d15/737/cfad15737bc941e28537ff3fba041a29.jpg"><br><br>  The penultimate item deserves special mention: the company's engineers created their own ‚Äúautomation agent‚Äù called Arc, which, unfortunately, there are not so many references on the Internet.  The existing project on <a href="https://launchpad.net/arc">Launchpad</a> describes the development as ‚Äúa secure framework for remote execution of commands in OpenStack for setting up and running tasks on guest systems in Linux and Windows‚Äù, referring to the now missing <a href="https://github.com/sapcc/arc">repository in GitHub</a> . <br><br>  The statistics on the R &amp; D of the created platform turned out to be interesting: less than 10% of the work on the project are categorized as "new developments", and more than 90% are improvements to the existing Open Source code.  In particular, SAP experts have made changes to the upstream of such projects as OpenStack, Kubernetes, Docker and Grafana.  <i>(However, according to <a href="http://stackalytics.com/">Stackalytics</a> , SAP is not included in any significant top most active contributors either for OpenStack as a whole, nor for the Kubernetes component in particular - the check was made for OpenStack releases of 2016‚Äì2017.)</i> <br><br>  We will return to the details of this platform, but for now we will follow the chronology.  In November of the same year, a report ( <a href="http://schd.ws/hosted_files/cnkc16/47/Multi-site%2520SAP%2520Microservices%2520with%2520K8%2520and%2520CoreOS-CloudNativeCon_KubeCon_PPT_11.08.2016.pdf">PDF</a> ) of two SAP Labs employees on a pilot project to launch containers with enterprise-services to Kubernetes was <a href="https://cnkc16.sched.com/event/8K98/running-multi-site-hybrid-sap-applications-on-kubernetes-and-coreos-nishi-davidson-sap-victoria-rozhina">heard</a> at KubeCon 2016.  From it, one could learn about the continuing interest of SAP engineers in translating monolithic applications to the microservice architecture and the available methods for its implementation.  The common architecture in SAP is as follows: <br><br><img src="https://habrastorage.org/web/a45/874/7e9/a458747e9ccc40d6b69483e17075dda2.png"><br><br>  A note to this slide states that SAP works with both HashiCorp and the Mesosphere, but the default container implementation chosen is Docker, and a specific report is dedicated to their use with Kubernetes and CoreOS.  The result of the SAP Labs research project is that it is not finished at that time: there are a number of difficulties (mainly standardization and integration of various components and processes of the company) that engineers intend to overcome before the practice will be universally adapted.  Separate mention in this project is the <a href="https://thenewstack.io/sap-bringing-multi-site-microservices-enterprise-kubernetes/">intention of</a> SAP Labs "to release in the near future, Open Source-tool for managing Kubernetes - a tool that will be useful for developers and operating teams." <br><br><h2>  SAP: Converged Cloud (2017) </h2><br>  In March 2017, the history of the SAP cloud platform based on Kubernetes and OpenStack received a public continuation: the corporate blog <a href="https://blogs.sap.com/2017/03/19/the-sap-converged-cloud-is-live/">announces the</a> SAP Converged Cloud (SAPCC) production-status of the SAP.  It is claimed that it is intended only for internal use in the company, but its scale is still impressive: the project combined 23 other cloud solutions used previously.  There were so many of them for various reasons: ‚Äúfrom fast innovation in different areas of business to the many acquisitions made by SAP in recent years‚Äù (companies such as SuccessFactors, Ariba and, of course, the already mentioned Concur, had their clouds at the time of their accession to SAP). <br><br>  According to the announcement, "OpenStack is deployed 100% containerized using an automated system based on Kubernetes."  Some details about the technical features and difficulties of Kubernetes can be found in the <a href="https://youtu.be/N6qjasf5wvM%3Flist%3DPLu6oZi_cmx64wxb3dXTcQWk6bMbhqMWW_%26t%3D1189">report</a> <i>(by the way, this video contains a 4-minute demonstration of how a new data center can be deployed in SAP Converged Cloud) by</i> architect Michael Schmidt at the OpenStack Summit 2016: <br><br><img src="https://habrastorage.org/web/825/590/044/8255900446ac45a39f7bb5ac4f72976e.jpg"><br><br>  The entire CI / CD pipeline to SAP (used by <a href="https://concourse.ci/">Concourse</a> ) is integrated with containers from the cloud (using <a href="https://wiki.openstack.org/wiki/Kolla">OpenStack Kolla</a> ), and the package manager <a href="https://github.com/kubernetes/helm">Helm is</a> used to conveniently manage the infrastructure deployed by Kubernetes.  GitHub publishes various Helm Charts: for deploying a <a href="https://github.com/sapcc/openstack-helm">basic IaaS based on OpenStack</a> , as well as <a href="https://github.com/sapcc/helm-charts">additional ones</a> that are required for SAP Converged Cloud. <br><br>  To work with SAPCC, a web interface has been created that allows you to manage cloud resources.  The speaker emphasizes that in the server management interface, an additional terminal is also offered for executing the usual OpenStack console commands in it: <br><br><img src="https://habrastorage.org/web/5d2/a31/987/5d2a3198745f4b77a119b0e5c9eaf931.png"><br><br>  At the time of the announcement of the SAP Converged Cloud, only one availability zone in Australia was available with plans to add two more European ones for the next 2 weeks and to achieve cloud propagation to 19 data centers in 13 regions by the end of 2018.  In <a href="https://github.com/sapcc">the SAPCC project GitHub, you</a> can find other interesting repositories of components used in the infrastructure - for example, <a href="https://github.com/sapcc/kubernetes-operators">operators</a> for managing OpenStack on Kubernetes <i>(we have written in more detail about operators for Kubernetes in <a href="https://habrahabr.ru/company/flant/blog/326414/">this article</a> )</i> or a <a href="https://github.com/sapcc/kube-detective">utility for checking the</a> network settings of the Kubernetes cluster. <br><br>  Finally, I note that in the same year, SAP HANA DBMS <a href="https://www.blog.google/topics/google-cloud/google-cloud-and-sap-forge-partnership-develop-enterprise-solutions/">was certified</a> to run on the Google Cloud Platform (GCP). <br><br><h2>  Other articles from the cycle </h2><br><ul><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/334140/">Kubernetes success stories in production.</a>  <a href="https://habrahabr.ru/company/flant/blog/334140/">Part 1: <b>4,200 pods and TessMaster on eBay</b></a> . ‚Äù </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/335814/">Kubernetes success stories in production.</a>  <a href="https://habrahabr.ru/company/flant/blog/335814/">Part 3: <b>GitHub</b></a> . </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/339724/">Kubernetes success stories in production.</a>  <a href="https://habrahabr.ru/company/flant/blog/339724/">Part 4: <b>SoundCloud (by Prometheus)</b></a> . ‚Äù </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/342412/">Kubernetes success stories in production.</a>  <a href="https://habrahabr.ru/company/flant/blog/342412/">Part 5: <b>Monzo Digital Bank</b></a> . </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/345780/">Kubernetes success stories in production.</a>  <a href="https://habrahabr.ru/company/flant/blog/345780/">Part 6: <b>BlaBlaCar</b></a> . </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/347098/">Kubernetes success stories in production.</a>  <a href="https://habrahabr.ru/company/flant/blog/347098/">Part 7: <b>BlackRock</b></a> . </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/349940/">Kubernetes success stories in production.</a>  <a href="https://habrahabr.ru/company/flant/blog/349940/">Part 8: <b>Huawei</b></a> . </li><li>  ‚Äú <a href="https://habr.com/company/flant/blog/349940/">Kubernetes success stories in production.</a>  <a href="https://habr.com/company/flant/blog/349940/">Part 9: <b>CERN and 210 K8s clusters.</b></a> ‚Äù </li><li>  ‚Äú <a href="https://habr.com/ru/company/flant/blog/441754/">Kubernetes success stories in production.</a>  <a href="https://habr.com/ru/company/flant/blog/441754/">Part 10: <b>Reddit</b></a> . </li></ul></div><p>Source: <a href="https://habr.com/ru/post/334770/">https://habr.com/ru/post/334770/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334756/index.html">Python Click Generator for Data Engineer</a></li>
<li><a href="../334760/index.html">Javascript as a phenomenon</a></li>
<li><a href="../334762/index.html">Business of Software Europe - conference about IT business (almost) without Growth Hacks</a></li>
<li><a href="../334764/index.html">The fate of programmers in the Russian Federation or how to leave the city of Ensk</a></li>
<li><a href="../334766/index.html">About "Elegant Objects" and Evangelicals</a></li>
<li><a href="../334772/index.html">Using async / await in nodejs today</a></li>
<li><a href="../334774/index.html">Simple initial authorization using iptables</a></li>
<li><a href="../334776/index.html">Laravel - an ecosystem, not just a PHP framework</a></li>
<li><a href="../334778/index.html">Basics of computer networks. Subject number 8. Link Aggregation Protocol: Etherchannel</a></li>
<li><a href="../334780/index.html">Register for the webinar "How to safely and profitably protect the company from unknown threats and cryptographers"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>