<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Thinking out loud about developing javascript applications on the example of a small Line Of Business framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 

 Not so long ago, we ourselves set the task - to build a SPA application. Complicated, large, fast, with support for multiple devices, wit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Thinking out loud about developing javascript applications on the example of a small Line Of Business framework</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr! <br><br>  Not so long ago, we ourselves set the task - to build a SPA application.  Complicated, large, fast, with support for multiple devices, without memory leaks.  In addition, constantly evolving to make it easy to maintain.  In general, as we love - all at once. <br><br>  The theme of SPA-applications and javascript-applications as a whole is not new, but we could not find even on paid resources <b>solid</b> guidelines on application development.  They are more like a story about a particular MV * library than an example to follow.  It does not consider examples of splitting into layers, building inheritance hierarchies and subtleties of inheritance in javascript, etc. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We will try to go the other way and describe, rather, the course of thoughts during development (with code and links), than any particular tool.  We have to start at the hello world level in order to set one starting point for readers and a writer.  But from the second section, the narrative will accelerate sharply. <br><br><h5>  We believe that this article will be useful: </h5><br><ol><li>  Front-end developers who already have some experience, but want to grow. </li><li>  Back-end developers who at some point had to start working on js-development and who feel some insecurity when working with javascript. </li><li>  The makers, who began to engage in js-development and would like to pump their skills. </li></ol><br><img src="https://habrastorage.org/files/699/5c7/0bc/6995c70bc4214672884ea62968f5c361.png"><br><br>  Fiction turned out to be very voluminous, but we hope that it is just as useful. <br><a name="habracut"></a><br><h5>  For a good understanding of the article is necessary: </h5><br><ul><li>  Understanding the basic principle of MV * -patterns (a good article to start <a href="http://habrahabr.ru/post/151219/">is on Habr√©</a> ). </li><li>  Knowledge of the <a href="http://requirejs.org/">approach of AMD and the library requirejs</a> (in Russian <a href="http://habrahabr.ru/post/152833">there is a habr</a> ). </li><li>  It will help, but it seems to us that it is not strictly necessary to know knockout. </li></ul><br><h4>  Formulation of the problem </h4><br>  We tried to choose a task that would be quite complex, but at the same time it would be realistic and understandable without long immersion into the context.  We will build the foundation for lists with sorting, paging, filtering, displaying master-details, selection of rows, etc.  We will also briefly touch upon the issues of maintaining the state of the application, interaction with the back end, etc. <br><br>  We will take the <a href="http://durandaljs.com/get-started.html">starter kit</a> and the <a href="http://durandaljs.com/">Durandal</a> + <a href="http://knockoutjs.com/">knockout</a> bundle as the basis of our application, because both libraries are as simple as two kopecks (you can complete the <a href="http://learn.knockoutjs.com/">tutorial knockout in</a> just an hour; you will spend as much time on <a href="http://durandaljs.com/docs.html">Durandal</a> , and we almost don‚Äôt need its specificity just use it as a quick start platform). <br><br>  We sincerely hope that the choice of technologies will not narrow the circle of potential readers.  After all, in the end, all MV * frameworks have similar functionality, or the missing items add ECMAScript of a higher version if you are not interested in browser support like IE 8/9. <br><br><h4>  Hello world (expand starter kit) </h4><br>  First we need to start the application and add a stub model there, on which we will set up experiments: <br><ol><li>  Download <a href="http://durandaljs.com/get-started.html">HTML starter kit</a> . </li><li>  Open it in any convenient editor. </li><li>  Remove from the <b>app / viewModels</b> and <b>app / views</b> folders all files except <b>shell.html</b> and <b>shell.js</b> . </li><li>  Add the file TestList.js with the following code to the app / viewModels folder: <br><pre><code class="hljs actionscript">define([], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> testListDef = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> testListDef; });</code> </pre> <br></li><li>  Add the <b>TestList.html</b> file to the <b>app / views</b> <b>folder</b> and draw the following markup there: <br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>Hello<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></li><li>  In the <b>shell.js</b> file, <b>we</b> change the configuration of the router with this: <br><pre> <code class="hljs css">{ <span class="hljs-attribute"><span class="hljs-attribute">route</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, title:<span class="hljs-string"><span class="hljs-string">'Welcome'</span></span>, moduleId: <span class="hljs-string"><span class="hljs-string">'viewmodels/welcome'</span></span>, nav: true }, { <span class="hljs-attribute"><span class="hljs-attribute">route</span></span>: <span class="hljs-string"><span class="hljs-string">'flickr'</span></span>, moduleId: <span class="hljs-string"><span class="hljs-string">'viewmodels/flickr'</span></span>, nav: true }</code> </pre>  On this one: <br><pre> <code class="hljs css">{ <span class="hljs-attribute"><span class="hljs-attribute">route</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, title: <span class="hljs-string"><span class="hljs-string">'Test list'</span></span>, moduleId: <span class="hljs-string"><span class="hljs-string">'viewmodels/TestList'</span></span>, nav: true }</code> </pre><br></li><li>  We also need the <a href="http://underscorejs.org/">underscore</a> and <a href="http://momentjs.com/">moment</a> libraries.  They can be installed in any convenient way and put them in the config for <b>requirejs</b> in the <b>main.js</b> file in the <b>paths</b> section: <br><pre> <code class="hljs cs"><span class="hljs-string"><span class="hljs-string">'underscore'</span></span>: <span class="hljs-string"><span class="hljs-string">'../lib/underscore/underscore'</span></span>, <span class="hljs-string"><span class="hljs-string">'moment'</span></span>: <span class="hljs-string"><span class="hljs-string">'../lib/moment/moment'</span></span></code> </pre><br></li><li>  We start and make sure that we see a page with the inscription ‚ÄúHello‚Äù. </li></ol><br>  Then you can go directly to the writing of our application. <br><br><h4>  Getting down to business </h4><br>  To begin, let's look at the pages of the application that we have to write, and highlight the general points.  As we conduct our narration on the basis of real events, we have an abundance of pictures.  At the same time, allow yourself to brag a little about our design. <br><br><img src="https://habrastorage.org/files/c13/f4e/bd2/c13f4ebd219e4a15bead46b62ebf3cd8.png"><br><br>  From the general moments you can see the presence of the title and the clock.  Also, each page follows the data on the server, and it makes sense to add a sign to display the status. <br><br>  So, add the <b>BaseViewModel.js</b> file to the <b>viewModels</b> folder with this code: <br><pre> <code class="hljs javascript">define([<span class="hljs-string"><span class="hljs-string">'ko'</span></span>, <span class="hljs-string"><span class="hljs-string">'underscore'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ko, _</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> baseViewModelDef = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">title</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.title = ko.observable(title || <span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = ko.observable(ETR.ProgressState.Done); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.busy = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state() === ETR.ProgressState.Progress; }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ready = ko.computed(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state() !== ETR.ProgressState.Progress; }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.disposed = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.inited = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }; _.extend(baseViewModelDef.prototype, { <span class="hljs-attr"><span class="hljs-attr">nowDate</span></span>: ko.observable(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>()).extend({ <span class="hljs-attr"><span class="hljs-attr">timer</span></span>: <span class="hljs-number"><span class="hljs-number">5000</span></span> }), <span class="hljs-attr"><span class="hljs-attr">baseInit</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.inited = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }, <span class="hljs-attr"><span class="hljs-attr">baseDispose</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ready.dispose(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.busy.dispose(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.disposed = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> baseViewModelDef; });</code> </pre><br>  Let us explain some structural points, conventions, etc .: <br><ol><li>  We will write all the code in <a href="http://learn.javascript.ru/strict-mode">strict mode</a> . </li><li>  All modules we declare as named functions instead of anonymous.  This practice will be of great service to you when you will be profiling your code for memory leaks, for example, using <a href="https://developer.chrome.com/devtools/docs/javascript-memory-profiling">chrome developer tools</a> , as it will allow you to easily determine what kind of object is stuck in memory. </li><li>  Instead of using the common approach of <a href="http://habrahabr.ru/post/103760/">capturing context using closures</a> , we will write code <a href="http://habrahabr.ru/post/149516/">using this</a> .  Perhaps the most important reason for this is discipline and clarity.  Yes, there are often situations when this cannot be transmitted correctly.  But in 99% of cases, the code can and should be written in such a way that this context is correct.  For the remaining 1% of cases, we use <a href="http://javascript.ru/Function/call">call</a> , <a href="http://javascript.ru/Function/apply">apply</a> , <a href="http://underscorejs.org/">underscore bind</a> , but we do it with an understanding of why and why. </li><li>  All that can be crammed into prototype, stuffed into prototype.  The reasons for this are many.  Starting from a more efficient use of memory and in some cases a noticeable difference in the speed of work (you can start research on this topic <a href="http://blog.cowchimp.com/prototype-optimizing-memory-usage/">with this article</a> ) and ending with the same discipline (there will be no possibility of being tied to any closures). </li><li>  We use the <a href="http://underscorejs.org/">underscore extend</a> function so that all declarations are in one object.  Such code is easier to read, plus in many code editors such a block can be collapsed and hidden if it is not needed.  In the case of writing a la <pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span>.prototype.something = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span></code> </pre>  so do not work. </li><li>  Instead of using <a href="http://en.wikipedia.org/wiki/Magic_string">magic strings</a> and <a href="http://en.wikipedia.org/wiki/Magic_number_(programming)">magic numbers,</a> we declare some sort of enumeration.  In the case of the code above, this is an ETR.ProgressState enumeration, which looks like this: <br><pre> <code class="hljs">ETR.ProgressState = { Done: 0, Progress: 1, Fail: 2 };</code> </pre><br>  We do not hesitate to put such objects into the global object ETR (acronym for the name of our company), believing that we do not violate the AMD approach, because if some static objects are needed almost in every module, then they can be easily rendered into global context instead of passing them as dependencies. </li><li>  In the markup, we will need to determine, for example, the view model state in order to show / not show the progress bar.  But writing expressions in markup is not good and fraught.  Therefore, we are very actively using <a href="http://knockoutjs.com/documentation/computedObservables.html">knockout computeds</a> .  This allows us to write bindings like <b>if: busy</b> instead of <b>if: state === 1</b> . </li><li>  In the case of complex hierarchies, some semblance of virtual methods is sometimes necessary with the possibility of calling basic methods.  So, for example, will be with our <b>baseInit</b> and <b>baseDispose</b> .  In modules-heirs, we will definitely define methods with the same name, but we should not lose the ‚Äúbase‚Äù one.  For this we will use <a href="http://underscorejs.org/">underscore wrap</a> .  As for the base prefix in the names, we agreed to call the methods that belong to the ‚Äúabstract‚Äù modules, that is, which are intended only for inheritance.  This naming allows you to simply <b>dispose the</b> method in the final modules, without wrapping the base method with <b>wrap</b> .  That is, the final code (which you often have to look at) will be a bit cleaner. </li><li>  Each ‚Äúpage‚Äù of our application will have its own life cycle, which, in general, is superimposed on the <a href="http://durandaljs.com/documentation/Hooking-Lifecycle-Callbacks.html">life cycle of ViewModels in Durandal</a> .  In the case of the code above, these are the <b>baseInit</b> and <b>baseDispose methods</b> .  Most often, these methods overlap with the <b>activate</b> and <b>deactivate</b> methods from Durandal, but sometimes you have to bind them to <b>attached / detached</b> methods, sometimes models do not participate in the Durandal life cycle, and you still need to initialize and clean them (for example, nested view model).  Therefore, we called the methods so as to clearly separate the flies from cutlets. </li><li>  Flags <b>inited</b> and <b>disposed</b> are needed to avoid re-initialization / cleaning, working with an already destroyed object.  They can also be useful for debugging and for profiling.  Personally, we have to use only <b>inited</b> , and then only occasionally (but just in case we have them). </li></ol><br><h4>  Inherit and draw </h4><br>  First of all, we need the inheritance function.  We decided not to think too much and took it <a href="http://javascript.ru/tutorial/object/inheritance">from here</a> .  To use it, we put it in the Object class and called inherit: <br><pre> <code class="hljs javascript"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.inherit = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">subClass, superClass</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ }; f.prototype = superClass.prototype; subClass.prototype = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> f(); subClass.prototype.constructor = subClass; subClass.superclass = superClass.prototype; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (superClass.prototype.constructor === <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.prototype.constructor) { superClass.prototype.constructor = superClass; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> subClass; };</code> </pre><br>  <i><b>Note:</b> in general, it is recommended to create a separate module and load it just before starting the application to accommodate such a ‚Äúsetup‚Äù code (type extension, declaration declaration like ETR.ProgressState, etc.).</i>  <i>In this particular example, we will not have much of it, so you can simply put such definitions in the <b>main.js</b> file.</i> <br>  After inheritance, our <b>TestList</b> class will look like this: <br><pre> <code class="hljs kotlin">define([<span class="hljs-string"><span class="hljs-string">'underscore'</span></span>, <span class="hljs-string"><span class="hljs-string">'BaseViewModel'</span></span>], function (_, baseViewModelDef) { <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> testListDef = function () { testListDef.superclass.<span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.activate = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseInit; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.deactivate = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseDispose; }; Object.inherit(testListDef, baseViewModelDef); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> testListDef; });</code> </pre><br>  The case remains for the markup.  Here it is worth highlighting one moment: the display of hours.  Since you don‚Äôt have a clock in one html element on our design, then when approaching ‚Äúon the forehead‚Äù in the model, we will need at least two fields: for the date and time.  You also have to solve the issue of formatting time into a string, and doing it in the view model is not the best solution.  Therefore, we will write a <a href="http://knockoutjs.com/documentation/custom-bindings.html">custom binding</a> for knockout, which with the help of the library of the <a href="http://momentjs.com/">moment</a> will solve this question: <br><pre> <code class="hljs pgsql">ko.bindingHandlers.dateFormat = { <span class="hljs-keyword"><span class="hljs-keyword">after</span></span>: [<span class="hljs-string"><span class="hljs-string">'text'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">update</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> (element, valueAccessor, allBindings) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (allBindings.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-string"><span class="hljs-string">'text'</span></span>)) { var <span class="hljs-keyword"><span class="hljs-keyword">format</span></span> = ko.unwrap(valueAccessor()) || <span class="hljs-string"><span class="hljs-string">'L'</span></span>; var <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = ko.unwrap(allBindings.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-string"><span class="hljs-string">'text'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) { var dateVal = moment(<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>); var <span class="hljs-type"><span class="hljs-type">text</span></span> = dateVal.isValid() ? dateVal.format(<span class="hljs-keyword"><span class="hljs-keyword">format</span></span>) : <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-type"><span class="hljs-type">text</span></span> = <span class="hljs-string"><span class="hljs-string">''</span></span>; } $(element).text(<span class="hljs-type"><span class="hljs-type">text</span></span>); } } };</code> </pre><br>  In general, nothing complicated.  Interesting in this is the binding array <b>after</b> , which signals the knockout that you need to start processing this binding after the binding text has been processed.  Thus, we guarantee that we will already have text in the markup, which we should reformat as a date. <br><br>  In view we get something like this: <br><pre> <code class="hljs javascript">&lt;div data-bind=<span class="hljs-string"><span class="hljs-string">"dateFormat, text: nowDate"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"date"</span></span> data-bind=<span class="hljs-string"><span class="hljs-string">"dateFormat: 'DD MMM', text: nowDate"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>=<span class="hljs-string"><span class="hljs-string">"year"</span></span> data-bind=<span class="hljs-string"><span class="hljs-string">"dateFormat: 'YYYY', text: nowDate"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre><br>  Cute and compact. <br><h4>  Create a list </h4><br>  This time we will not post all the code at once, but will consistently add the necessary functionality, simultaneously voicing our thoughts.  Routine and obvious code snippets, we leave behind brackets. <br><br>  Let's take another look at the picture with the application and try to evaluate what we need from the lists: <br><img src="https://habrastorage.org/files/9fa/c99/b5c/9fac99b5c4b441f5a06c6a783247d1b0.png"><br><br><h5>  Additionally, add two more things: </h5><br><ol><li>  Lists can be simply lists with the display of the number of records, with pagination, buffer loading, infinite loading by scroll. </li><li>  Each list must save its state (paging, sorting, values ‚Äã‚Äãin filters) in the query string so that the user can send the link and the recipient opens the application in the same state.  Also, when leaving the window, the state of the list should be remembered and restored when you return to the window. </li></ol><br>  So it goes.  Let's start with the sorting. <br><pre> <code class="hljs javascript">define([<span class="hljs-string"><span class="hljs-string">'jquery'</span></span>, <span class="hljs-string"><span class="hljs-string">'underscore'</span></span>, <span class="hljs-string"><span class="hljs-string">'ko'</span></span>, <span class="hljs-string"><span class="hljs-string">'BaseViewModel'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">jquery, _, ko, baseViewModelDef</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> listViewModelDef = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">title</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items = ko.observableArray([]).extend({ <span class="hljs-attr"><span class="hljs-attr">rateLimit</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.defaultSortings = []; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sortings &amp;&amp; ko.isObservable(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sortings)) { jquery.extend(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.defaultSortings, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sortings()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sortings.extend({ <span class="hljs-attr"><span class="hljs-attr">rateLimit</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sortings = ko.observableArray([]).extend({ <span class="hljs-attr"><span class="hljs-attr">rateLimit</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }); } listViewModelDef.superclass.constructor.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, title); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseInit = _.wrap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseInit, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">baseInit, params</span></span></span><span class="hljs-function">) </span></span>{ baseInit.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, params); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (params &amp;&amp; params.sort &amp;&amp; jquery.isArray(params.sort)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sortings(jquery.extend(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, [], params.sort)); } }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseDispose = _.wrap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseDispose, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">baseDispose</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.defaultSortings = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items.disposeAll(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sortings.removeAll(); baseDispose.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }); }; _.extend(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.inherit(listViewModelDef, baseViewModelDef).prototype, { <span class="hljs-attr"><span class="hljs-attr">setSort</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fieldName, savePrevious</span></span></span><span class="hljs-function">)</span></span>{‚Ä¶}, <span class="hljs-attr"><span class="hljs-attr">changeSort</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{‚Ä¶}, <span class="hljs-attr"><span class="hljs-attr">resetSettings</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{‚Ä¶}, <span class="hljs-attr"><span class="hljs-attr">reload</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{‚Ä¶} }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> listViewModelDef; });</code> </pre><br>  We also need a <b>customBinding</b> to draw the sorted columns on the UI: <br><pre> <code class="hljs php">ko.bindingHandlers.sort = { init: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(element, valueAccessor, allBindingsAccessor, viewModel)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $el = $(element); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fieldName = ko.unwrap(valueAccessor()); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> clickHandler = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(evt)</span></span></span><span class="hljs-function"> </span></span>{ viewModel.setSort(fieldName, evt.ctrlKey); viewModel.changeSort(); }; $el.addClass(<span class="hljs-string"><span class="hljs-string">'sortable'</span></span>).click(clickHandler); ko.computed( { read:{<span class="hljs-comment"><span class="hljs-comment">/*  asc/desc      */</span></span>}, disposeWhenNodeIsRemoved: element }); ko.utils.domNodeDisposal.addDisposeCallback(element, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $el.off(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, clickHandler); $el = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }); } };</code> </pre><br>  The logic of what happens in the <b>view model is as</b> follows: <br><ol><li>  <b>We declare the defaultSortings</b> array and copy the values ‚Äã‚Äãfrom the <b>sortings</b> array <b>into it</b> , if it was declared in the child class.  This is necessary in order to restore the original sorts by pressing the reset button ( <b>resetSettings</b> method).  Please note that we copy via <a href="http://api.jquery.com/jquery.extend/">jquery.extend</a> with the <b>deep</b> flag in order to make a full copy and not get problems later due to the change of the reference object.  If there is no sorting, we ourselves declare an array. </li><li>  <b>We wrap the baseInit</b> and <b>baseDispose methods</b> .  In the first one, we try to pull out the sorting parameters from the query string (passing us the parameters is Durandal care).  In the <b>baseDispose</b> method, <b>we</b> simply make order. </li><li>  The <b>resetSettings</b> and <b>reload</b> methods are tied to the buttons on the UI.  Also, these methods will be wrapped in inheriting modules, making up some kind of pipeline.  Thus, the entire functionality of these buttons (which, after the implementation of the entire functionality of the lists becomes very voluminous) will be hidden in the basic modules. </li><li>  The purpose of the <b>setSort</b> method is perhaps obvious from the name, and its code is trivial.  Note only the <b>savePrevious</b> flag.  We pass this parameter from the <b>custom binding</b> in case if <b>Ctrl</b> was pressed with the mouse on the header.  This is exactly what should be divided: the logic of working with sortings is in <b>ListViewModel</b> , and the logic for which user actions to save sortings is in the UI part, that is, in <b>custom binding</b> . </li><li>  The <b>changeSort</b> method exists separately and forces the list to reload when the sort is <b>changed</b> .  It is rendered separately in order to abstract from the UI, because there may be a situation when the user first selects several sorts and only after that we need to load the data.  Also, we may need (and need) to be embedded in the method in the modules-heirs. </li><li>  At the very beginning we declare an array of <b>items</b> , that is, our records.  We need it in order to clean the records from it when loading data in the list with the <b>reload</b> button and when <b>dispose is</b> called.  Notice that the <b>disposeAll</b> method, our extension to <b>observableArray</b> , is used for cleaning.  Its essence is that we call <b>removeAll</b> , after which we <b>iterate</b> over all the records, and, if they have a dispose method, we call it.  We also do this via <a href="http://learn.javascript.ru/events-and-timing-depth">setTimeout 0</a> , so that the loop works while data is being downloaded from the server, and not in front of it ‚Äî it improves usability a little if there are a couple of thousand entries in the list: <br><pre> <code class="hljs javascript">ko.observableArray.fn.disposeAll = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">async</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> === <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> ? <span class="hljs-literal"><span class="hljs-literal">true</span></span> : !!<span class="hljs-keyword"><span class="hljs-keyword">async</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> items = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.removeAll(); setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ko.utils.arrayForEach(items, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.dispose) { item.dispose(); } }); items = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }, <span class="hljs-number"><span class="hljs-number">0</span></span>); };</code> </pre><br></li></ol><br>  Now, in order for our <b>TestList</b> class <b>to</b> get the sorting functionality, change the base class in it from <b>BaseViewModel</b> to <b>ListViewModel</b> and in the markup we draw something like this: <br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"table table-bordered table-striped table-hover"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sort: 'Column1Name', localizedText: 'Column1Title'"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sort: 'Column2Name ', localizedText: 'Column2Title'"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"foreach: items"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tfoot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tfoot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Now we should be puzzled by how to send these sorts to the server when requested.  Since we don‚Äôt want to write code for this in every final view model, we will add one more conveyor method to our lists - <b>toRequest</b> .  Modules-heirs will also wrap it, additionally stacking information about the number and size of the page, filters, etc.  As a result, we will eliminate the need for the final module to write copy-paste code to collect the request to the server: <br><pre> <code class="hljs actionscript"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toRequest = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = {}; result.sort = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.sortings(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; };</code> </pre><br>  This method is also useful for saving the state of the model in the query string and in a certain cache (we described this as the requirements above), in order to restore this state when returning to the page.  To save the state, you can create a separate stateManager class, which will save the state in the cache (for example, in <b>localStorage</b> ) and <a href="http://durandaljs.com/documentation/api">replace the url using the router</a> .  Also, this module will be <a href="http://durandaljs.com/documentation/api">integrated into the router</a> and, when navigating through route, it will search the cache for the state of the object.  If it is found, then it is necessary to supplement them with parameters that Durandal <a href="http://durandaljs.com/documentation/api">recognized from the query string</a> .  We will not give a detailed code here, since everything is trivial.  We note only that Durandal has a rather weak query string parsing function.  For example, it does not know how to parse arrays that <a href="http://durandaljs.com/documentation/api">jquery.param</a> can serialize.  Therefore, the standard function in Durandal can be replaced with the <a href="https://github.com/chrissrogers/jquery-deparam">jquery.deparam</a> extension: the inverse function <b>param</b> . <br><h4>  Paging </h4><br>  As we said above, we will have three pages: <br><br>  <b>1. Simple</b> (in general, not paging, but simply a display of the number of records). <br><img src="https://habrastorage.org/files/a69/733/edf/a69733edfff84133bb9c10ccca34a4b8.png"><br><br>  <b>2. Page by page:</b> <br><img src="https://habrastorage.org/files/e9d/1d1/1cb/e9d1d11cbdb1403499b8216d4b3bc3db.png"><br><br>  <b>3. Buffer loading:</b> <br><img src="https://habrastorage.org/files/f41/5be/c4b/f415bec4ba634cbfaf52711bc0e0b5cd.png"><br><br>  The latter will be additionally with auto-upload by scroll. <br><br>  First of all, we will need information on how many records are now uploaded to the list and how many are there in total.  Add two properties to the <b>ListViewModel</b> : <br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.totalRecords = ko.observable(<span class="hljs-number"><span class="hljs-number">0</span></span>).extend({ rateLimit: <span class="hljs-number"><span class="hljs-number">0</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadedRecords = ko.observable(<span class="hljs-number"><span class="hljs-number">0</span></span>).extend({ rateLimit: <span class="hljs-number"><span class="hljs-number">0</span></span> });</code> </pre><br><h5>  And then another thought comes to mind ... </h5><br><br>  We need to read this information with the back end, otherwise nothing.  Yes, the <b>loadedRecords</b> property <b>will</b> also come from the server, and not be defined as the length of the array of incoming records, since the list can be grouped.  Plus, we already have (at the expense of <b>BaseViewModel</b> ) a sign of <b>state</b> , which we still do not exhibit anywhere.  And this is just the beginning.  Further - more, but I don‚Äôt want to deal with copy-paste code.  In addition, to implement pagers, we need to know exactly how to call the method of loading data from the server when changing the page, that is, we need a contract. <br><br>  Here we decided to make the thing a bit strange, but quite workable.  We will impose one restriction on the <b>ListViewModel</b> successor classes: all of them must have a <b>loadData</b> method that will return a <a href="http://blog.mediumequalsmessage.com/promise-deferred-objects-in-javascript-pt1-theory-and-semantics">promise</a> (strictly speaking, <a href="http://blog.mediumequalsmessage.com/promise-deferred-objects-in-javascript-pt1-theory-and-semantics">jquery deferred</a> will be returned, but in this context it does not matter much).  We will also expect that data will come into the callback promise, from which we can pull out the <b>totalRecords</b> and <b>loadedRecords</b> we <b>need</b> .  Further, we will wrap this method with our <b>loadData</b> method and add <b>promise</b> interceptors that will do all the necessary work.  It turns out some kind of replacement of the abstract method, which is not in javascript. <br><br>  Ultimately, for <b>ListViewModel,</b> it will look something like this: <br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">var</span></span> listViewModelDef = function (title) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!this.loadData) { throw '<span class="hljs-type"><span class="hljs-type">In</span></span> order to inherit <span class="hljs-string"><span class="hljs-string">"ListViewModel"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> you must provide "loadData" method'; } ‚Ä¶ this.loadData = _.wrap(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loadData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">q</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">var</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">opts</span></span></span><span class="hljs-class"> = { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">total</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">totalCount'</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loaded</span></span></span><span class="hljs-class">: '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">selectedCount'</span></span></span><span class="hljs-class"> }; //-       if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namingOptions</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">opts</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extend</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">opts</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">namingOptions</span></span></span><span class="hljs-class">); } this.totalRecords(0); this.state(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ETR</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ProgressState</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Progress</span></span></span><span class="hljs-class">); var promise = q.apply(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Array</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">prototype</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">slice</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span><span class="hljs-class">, 1)); promise.done(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loadedRecords</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">[</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">opts</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">loaded</span></span></span><span class="hljs-class">]); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">totalRecords</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class">[</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">opts</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">total</span></span></span><span class="hljs-class">] || 0); </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">state</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ETR</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ProgressState</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Done</span></span></span><span class="hljs-class">); }).fail(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">function</span></span></span><span class="hljs-class"> () { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">state</span></span></span><span class="hljs-class">(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ETR</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ProgressState</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Fail</span></span></span><span class="hljs-class">); }); if (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">saveStateOnRequest</span></span></span><span class="hljs-class"> === </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">true</span></span></span><span class="hljs-class">) { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">this</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">saveRequestState</span></span></span><span class="hljs-class">(); } return promise; }); ‚Ä¶ }</span></span></code> </pre><br>  The code in our successor class is now complemented like this: <br><pre> <code class="hljs javascript">define([<span class="hljs-string"><span class="hljs-string">'underscore'</span></span>, <span class="hljs-string"><span class="hljs-string">'BaseViewModel'</span></span>, <span class="hljs-string"><span class="hljs-string">'SomeViewModel'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_, baseViewModelDef, someViewModelDef</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> testListDef = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ testListDef.superclass.constructor.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>); }; _.extend(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.inherit(testListDef, baseViewModelDef).prototype, { <span class="hljs-attr"><span class="hljs-attr">loadData</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.someService.getSomeData(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toRequest()) .done(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.someCustomPropertyToSet(result.someCustomPropertyToSet); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items.initWith(result.items, someViewModelDef); }); }, ‚Ä¶ }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> testListDef; });</code> </pre><br>  The result was quite good.  We do not need to copy-paste the code for setting the properties of the parent classes, but at the same time - complete freedom in sending a request to the back end and in receiving a response from it. <br><br>  Next, we need to define two heir modules ‚Äî <b>PagedListViewModel</b> and <b>BufferedListViewModel</b> .  We will not show the whole and explain the code, due to their triviality, we just give the general structure.  A noteworthy point is the use of <a href="http://knockoutjs.com/documentation/computed-writable.html">writable computeds</a> , the existence of which is not yet known to all users of this library.  Their use allows us to check that the user enters strictly row numbers in the rowCount field, and the input value does not exceed the specified number of records per request, as well as the total number of records in the list. <br><pre> <code class="hljs javascript">define([<span class="hljs-string"><span class="hljs-string">'ko'</span></span>, <span class="hljs-string"><span class="hljs-string">'underscore'</span></span>, <span class="hljs-string"><span class="hljs-string">'ListViewModel'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ko, _, listViewModelDef</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bufferedListViewModelDef = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">title</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.defaultRowCount = <span class="hljs-number"><span class="hljs-number">20</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.minRowCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.maxRowCount = <span class="hljs-number"><span class="hljs-number">200</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rowCountInternal = ko.observable(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.defaultRowCount); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.skip = ko.observable(<span class="hljs-number"><span class="hljs-number">0</span></span>).extend({ <span class="hljs-attr"><span class="hljs-attr">rateLimit</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rowCount = ko.computed({ <span class="hljs-attr"><span class="hljs-attr">read</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rowCountInternal, <span class="hljs-attr"><span class="hljs-attr">write</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{‚Ä¶}, <span class="hljs-attr"><span class="hljs-attr">owner</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> }); bufferedListViewModelDef.superclass.constructor.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, title); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadData = _.wrap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loadData, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">q</span></span></span><span class="hljs-function">) </span></span>{‚Ä¶}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseInit = _.wrap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseInit, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">baseInit, params</span></span></span><span class="hljs-function">) </span></span>{‚Ä¶}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resetData = _.wrap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resetData, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">baseResetData</span></span></span><span class="hljs-function">) </span></span>{‚Ä¶}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toRequest = _.wrap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toRequest, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">baseToRequest</span></span></span><span class="hljs-function">) </span></span>{‚Ä¶}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.changeSort = _.wrap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.changeSort, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">baseChangeSort</span></span></span><span class="hljs-function">) </span></span>{‚Ä¶}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseDispose = _.wrap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseDispose, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">baseDispose</span></span></span><span class="hljs-function">) </span></span>{‚Ä¶}; }; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.inherit(bufferedListViewModelDef, listViewModelDef); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bufferedListViewModelDef; });</code> </pre><br>  Now, just changing the base class for <b>TestList</b> , we almost get the paging functionality.  To get it all, we need a few bindings.  View with them will look like this: <br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tfoot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progress"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">colspan</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"6"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progress-row"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nodata"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">colspan</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"6"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"localizedText: 'CommonUserMessageNoData'"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pagination-row"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pager"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tfoot</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Here we also do without the obvious code and briefly explain in words: <br><ul><li>  <b>progress</b>  <b>nodata</b>    view model- <b>state</b>  <b>selectedCount</b> , ‚Äî     ,    . </li><li>  <b>infinite</b> ,    <b>bufferedListViewModel</b> ,      <b>scroll</b>  window,      . </li><li>  <b>pager</b>        ,  view model  : <br><pre> <code class="hljs actionscript">ko.bindingHandlers.pager = { init: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(element, valueAccessor, allBindingsAccessor, viewModel)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (viewModel <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> bufferedListViewModelDef) { ko.bindingHandlers.bufferedListPager.init(element, valueAccessor, allBindingsAccessor, viewModel); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (viewModel <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> pagedListViewModelDef) { ko.bindingHandlers.pagedListPager.init(element, valueAccessor, allBindingsAccessor, viewModel); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (viewModel <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> listViewModelDef) { ko.bindingHandlers.simpleListPager.init(element, valueAccessor, allBindingsAccessor, viewModel); } } };</code> </pre><br></li></ul><br>     ,    instanceof   ,      (    proxy-,     prototype  ‚Äú‚Äù ). <br><br>   ,    <b>bufferedListPager</b> , <b>pagedListPager</b> , <b>simpleListPager</b>  ,     .  ,   <b>tbody</b>      ,      .  ,   Durandal   knockout,      <a href="http://durandaljs.com/documentation/Creating-A-Widget.html">Durandal widgets</a>  <a href="http://knockoutjs.com/documentation/component-registration.html">knockout components</a> .      ,         , <b>widget</b>    <a href="http://knockoutjs.com/documentation/custom-bindings-for-virtual-elements.html"> binding</a> ,          div-,     .        ,     ,     code base. <br><h4>  </h4><br>    ,     ,   ,  :     ? <br><br> ,     , , ,       back-end,    query string       ,      view model: <br><pre> <code class="hljs javascript">define([<span class="hljs-string"><span class="hljs-string">'underscore'</span></span>, <span class="hljs-string"><span class="hljs-string">'BufferedListViewModel'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_, bufferedListViewModelDef</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> testListDef = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ testListDef.superclass.constructor.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span>); }; _.extend(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.inherit(testListDef, bufferedListViewModelDef).prototype, { <span class="hljs-attr"><span class="hljs-attr">loadData</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.someService.getSomeData(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toRequest()) .done(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)</span></span>{‚Ä¶}); }, <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseInit(); }, <span class="hljs-attr"><span class="hljs-attr">dispose</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.someService.dispose(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseDispose(); } }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> testListDef; });</code> </pre><br>    View: <br><pre> <code class="hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sort: 'SomeProperty'&gt;Some Property&lt;/span&gt;&lt;/td&gt; &lt;td&gt;&lt;span data-bind="</span></span></span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sort:</span></span></span><span class="hljs-tag"> '</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">OtherProperty</span></span></span><span class="hljs-tag">'&gt;</span></span>Other Property<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">thead</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"foreach: items "</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text: someProperty"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text: otherProperty "</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tbody</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tfoot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progress"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">colspan</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"progress-row"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nodata"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">colspan</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"localizedText: 'CommonUserMessageNoData'"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pagination-row"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-bind</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pager"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">td</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">tfoot</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">table</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> ,  , ,    .     ,     ‚Ä¶ <br><h4>  </h4><br>   <b>TestList</b>    ,          .        <b>toRequest</b> .       ,      .       query string    . <br>        <b>init</b>     query string (,   <b>params</b> ,    query string+  ).        <b>resetSettings</b> ,       .    ,    <b>toRequest</b> ,     <b>init</b>    <b>resetSettings</b> ‚Äî .      ? <br><h5> ,      . </h5><br> ,     ,       ,       .          knockout ‚Äî <a href="http://knockoutjs.com/documentation/extenders.html">extenders</a> (  ,       ). ,    <a href="http://knockoutjs.com/documentation/rateLimit-observable.html">extender rateLimit</a> . <br> ,   extender,     observable  .  Like this: <br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.filterProperty = ko.observable(<span class="hljs-literal"><span class="hljs-literal">null</span></span>).extend({filter: { fieldName: <span class="hljs-string"><span class="hljs-string">'nameForRequest'</span></span>, owner: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> }});</code> </pre><br> ,    ,    .  For example: <br><ul><li>    (      observable ‚Äî   ); </li><li> ,        query string  (      ); </li><li>       . </li></ul><br>         observable. ,      : <br><pre> <code class="hljs pgsql">ko.extenders.<span class="hljs-keyword"><span class="hljs-keyword">filter</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> (target, <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">owner</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">filter</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">owner</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">filter</span></span> || {}; <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">owner</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">filter</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.fieldName] = target; target.defaultValue = <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.defaultValue === undefined ? target() : <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.defaultValue; target.ignoreOnAutoMap = (!!<span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.ignoreOnAutoMap) || <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; target.formatter = <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.formatter || undefined; target.emptyIsNull = <span class="hljs-keyword"><span class="hljs-keyword">options</span></span>.emptyIsNull || <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> target; };</code> </pre><br>  ,   view model-     filter,    ,   ,  ,    -. <br><br>   /  ,  ,   .      ‚Äúconvention‚Äù,     . <br><br>  ,        ,    .  ,   reusable,     extender    ‚Äî  copy paste.   ,          <b>toRequest</b> , ,    ,      . ,   back end,  ,  wcf-  Sharepoint 2010,      ‚Äù/Date(1234567890000)/‚Äù.       ,   : <br><pre> <code class="hljs javascript"><span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.prototype.toRequest = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'\/Date\('</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getTime() + <span class="hljs-string"><span class="hljs-string">')\/'</span></span>; };</code> </pre><br>   ,   :       ?   ‚Äî    <b>*listViewModel</b>   <b>BaseViewModel</b> .     ‚Äî  ,        .   <b>BaseViewModel</b> ‚Äî  ,     . <br><br>       <a href="http://habrahabr.ru/post/132340/">mixin</a> -.     ,   <b>mixin</b>   <b>ListViewModel</b>   : <br><pre> <code class="hljs kotlin">modelWithFilterExtender.apply.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>);</code> </pre><br>   <b>extender</b>    : <br><pre> <code class="hljs actionscript">define([<span class="hljs-string"><span class="hljs-string">'ko'</span></span>, <span class="hljs-string"><span class="hljs-string">'underscore'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ko, _)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> modelWithFilterExtenderDef = { apply: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.filter = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.filter || {}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.initFilterParams = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(baseInit, params)</span></span></span></span>{‚Ä¶}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.apllyFilterParams = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function"> </span></span>{‚Ä¶}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resetFilterToDefault = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{‚Ä¶}; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.clearFilterParams = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{‚Ä¶}; } }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> modelWithFilterExtenderDef; });</code> </pre><br> ,   , . <br><h5>   success story. </h5><br>   mixin-        selection  (  ,  ,   ,      ).    ,       , ,  Tab   Ctrl  Shift   .     selectionExtender ( )  selectedExtender ( ).       ‚Äú / ‚Äù, ‚Äú / ‚Äù,        /,  master/details.  ,      . <br><br>     ,        mixin-,     . ,   , ‚Äî   view model      : <br><pre> <code class="hljs kotlin">selectedExtender.apply.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.key);</code> </pre><br> : <br><pre> <code class="hljs kotlin">selectedExtender.apply.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.key); selectionExtender.apply.call(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.items);</code> </pre><br>           . <br><br>       .  Thanks to everyone who read to the end.  See you soon! </div><p>Source: <a href="https://habr.com/ru/post/244745/">https://habr.com/ru/post/244745/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244731/index.html">GPS monitoring for personal use (part 2. Systems overview)</a></li>
<li><a href="../244735/index.html">Is Telegram Safe? v2</a></li>
<li><a href="../244737/index.html">rusEfi: results of 2014 and plans</a></li>
<li><a href="../244741/index.html">"Iron" vulnerability in DRAM allows you to change the contents of someone else's memory</a></li>
<li><a href="../244743/index.html">Digital Guard Key_P1: creation history and first results</a></li>
<li><a href="../244747/index.html">IT Pro Community Day December 17: from server to cloud</a></li>
<li><a href="../244751/index.html">What is an interactive projector?</a></li>
<li><a href="../244753/index.html">Study of the causes of abnormal voting on the ROI website or the specifics of e-democracy in Russia</a></li>
<li><a href="../244755/index.html">Completion of the Android developer contest Moverio Apps Market</a></li>
<li><a href="../244757/index.html">Registration for the DevCon 2015 conference is open</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>