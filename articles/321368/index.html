<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Andrew Un's draft of The Thirst for Machine Learning, Chapters 1-7</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last December, in a correspondence with American colleagues in data science, a wave of discussion of the long-awaited draft of the new book of machine...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Andrew Un's draft of The Thirst for Machine Learning, Chapters 1-7</h1><div class="post__text post__text-html js-mediator-article">  Last December, in a correspondence with American colleagues in data science, a wave of discussion of the long-awaited draft of the new book of machine learning guru <a href="https://ru.wikipedia.org/wiki/%25D0%25AB%25D0%25BD,_%25D0%25AD%25D0%25BD%25D0%25B4%25D1%2580%25D1%258E">Andrew Ng</a> ( <a href="https://ru.wikipedia.org/wiki/%25D0%25AB%25D0%25BD,_%25D0%25AD%25D0%25BD%25D0%25B4%25D1%2580%25D1%258E">Andrew Ng</a> ) ‚ÄúThirst for machine learning: strategies for engineers in the era of deep learning‚Äù swept.  The long-awaited, because the book was <a href="http://www.mlyearning.org/">announced</a> in the summer of 2016, and now, finally, several chapters appeared. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/279/2ad/59c/2792ad59c25a4c2582da22f1c08d286d.PNG" alt="image"></div><br>  I present to the Habra community the translation of the first seven chapters of the currently available fourteen chapters.  I note that this is not the final version of the book, but a draft.  There are a number of inaccuracies.  Andrew Eun offers to write your comments and comments <a href="https://www.reddit.com/r/mlyearning/">here</a> .  The author begins with things that seem obvious.  Further more complex concepts are expected. <br><a name="habracut"></a><br><h1>  1. Why are machine learning strategies? </h1><br>  Machine learning (ML) is the foundation of an infinite number of important products and services, including Internet search, anti-spam, speech recognition, recommendation systems, and so on.  I assume that you and your team are working on products with machine learning algorithms, and you want to make rapid progress in development.  This book will help you with this. <br><br>  Let's say you are creating a startup that will provide a continuous stream of photos of cats for cat lovers.  You use a neural network to create a computer vision system to detect cats in a photo taken with smartphones. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/files/10d/027/237/10d0272377fb45c3a41be8defbc927a2.PNG" alt="image"></div><br><br>  But, unfortunately, the accuracy of your algorithm is not high enough.  You are under tremendous pressure, you have to improve the ‚Äúcat detector‚Äù.  What to do? <br><br>  Your team has lots of ideas, for example: <br><br>  ‚Ä¢ Collect more data: take more images of cats. <br>  ‚Ä¢ Collect a more diverse training set: for example, cats in unusual poses, cats of rare color, photos taken with different camera settings, ... <br>  ‚Ä¢ Teach the model longer, use more iterations of the gradient descent. <br>  ‚Ä¢ Try a larger neural network: more layers / connections / parameters. <br>  ‚Ä¢ Experiment with a smaller network. <br>  ‚Ä¢ Add regularization, for example, L2. <br>  ‚Ä¢ Change network architecture: activation function, number of hidden layers, etc. <br>  ‚Ä¢‚Ä¶ <br><br>  If the choice among possible alternatives is successful, then you will be able to create a leading system for finding photos of cats, and this will lead the company to success.  If the choice is unsuccessful, then lose months.  How to act in such a situation? <br>  This book will tell you how.  Most machine learning tasks leave key clues that say it is useful to try and what not.  The ability to see such tips can save months and years of development time. <br><br><h1>  2. How to use this book to help your team? </h1><br>  After reading this book, you will know how to set design directions in a project with machine learning algorithms.  However, your colleagues may not understand why you have chosen this or that direction.  You might want your team to define a quality metric as a single numerical parameter, but colleagues disagree on using only one indicator.  How to convince them?  That is why I made the chapters in this book short: just print and let your colleagues read 1-2 pages of key information they need to know. <br><br>  Minor changes in the priority of tasks can have a huge effect on team performance.  I hope you can become a superhero if you help your team make such changes. <br><br><h1>  3. What should you know? </h1><br>  If you studied the course ‚ÄúMachine Learning‚Äù on a <a href="https://www.coursera.org/">Coursera</a> or have experience in applying learning algorithms with a teacher (supervised learning), then this is enough to understand the text of the book.  I assume that you are familiar with the teaching methods with the teacher: finding a function that, by the values ‚Äã‚Äãof x, allows you to get y for all x, having a marked training set for some (x, y).  These types of algorithms include, for example, linear regression, logistic regression, and neural networks.  There are many areas of machine learning, but most of the practical results are achieved with the help of learning algorithms with a teacher. <br><br>  I will often talk about neural networks (NN) and deep learning.  You only need a general understanding of their concepts.  If you are not familiar with the concepts mentioned above, then first watch the lecture video of the <a href="http://ml-class.org/">‚ÄúMachine Learning‚Äù course</a> on Coursera. <br><br><h1>  4. What large-scale changes contribute to progress in machine learning? </h1><br>  Many in-depth learning / neural network ideas have been in the air for many years.  Why we started using them right now?  The greatest contribution to the progress of recent years has been given by two factors: <br><br>  ‚Ä¢ Data availability: now people are constantly using digital devices (laptops, smartphones, etc.), their digital activity generates huge amounts of data that we can ‚Äúfeed‚Äù to our algorithms. <br>  ‚Ä¢ Computational power: only a few years ago it became possible to massively train large enough neural networks to experience the benefits of the huge data sets that are available now. <br><br>  Usually, the quality score of ‚Äúold‚Äù algorithms, such as logistic regression, goes to a constant level, even if you have accumulated more training data, i.e.  from a certain limit, the quality of the algorithm performance ceases to improve with an increase in the training sample.  If you train a small neural network on the same task, you can get a little better result.  Here, under the ‚Äúsmall‚Äù neural network, I mean a network with a small number of hidden layers, connections and parameters.  After all, if you are teaching a larger and larger network, then you can get better results. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5e7/23f/df2/5e723fdf21dd4be7afffac543f1cecfc.PNG" alt="image"></div><br><br>  <i>Author's note: This graph shows that NN works better than traditional ML algorithms, even in the case of a small amount of data for training.</i>  <i>This is less correct than for a huge amount of data.</i>  <i>For small samples, traditional algorithms may be better or worse, depending on the characteristics that are manually constructed.</i>  <i>For example, if you have only 20 samples / use cases for training, then it doesn‚Äôt matter if you use logistic regression or a neural network, the feature set will have a significantly greater effect compared with the choice of algorithm.</i>  <i>But if you have a million samples to learn, then I prefer to use a neural network.</i> <br><br>  Thus, the best results are achieved: <br><br>  1. when a very large neural network is being trained (so as to be on the green curve in the figure); <br>  2. when a huge amount of data is used for training. <br><br>  There are also many other details, such as the network architecture, where many innovations constantly appear.  Nevertheless, one of the most reliable ways to improve the quality of the algorithm remains (1) to train a large NN and (2) to use more data for training.  In practice, following points (1) and (2) is extremely difficult.  This book discusses the details of this process.  We begin with general approaches that are useful for both traditional ML algorithms and NN, then select the most effective strategies for building depth learning systems. <br><br><h1>  5. What should be the sample? </h1><br>  <i>Translator's note: Andrew Un uses the term ‚Äúdevelopment set‚Äù to refer to the sample on which the model parameters are tuned.</i>  <i>Currently, this sample is more commonly called the ‚Äúvalidation set‚Äù - validation sample.</i>  <i>Indeed, the term ‚Äúvalidation‚Äù does not correspond to the variety of tasks for which this sample is applied, and the name ‚Äúdevelopment set‚Äù more corresponds to the status quo.</i>  <i>However, I was not able to find a good translation for the ‚Äúdevelopment set‚Äù, so I am writing a ‚Äúdevelopment sample‚Äù or a ‚Äúdevelopment work sample‚Äù.</i>  <i>It may be reasonable to call this sample ‚Äútuning‚Äù (thanks to <a href="https://habrahabr.ru/users/kfmn/" class="user_link">kfmn</a> ).</i> <br><br>  Let's go back to the example with photos of cats.  So, you are developing a mobile application, users download various photos into your application, which automatically finds among them photos of cats.  Your team has created a large data set by uploading photos of cats (positive samples) and non-cats (negative samples) from the websites.  Then this data set was divided into training (70%) and test (30%) samples.  Using the sample data, a ‚Äúcat detector‚Äù was created that worked well for objects from test and training samples.  But when this classifier was implemented in a mobile application, you found that the quality of its work is really low!  What happened? <br><br>  You found out that the photos that users upload to your application look different than the images from the websites that make up the training sample: users upload photos taken by smartphones, these images have a different resolution, less clear, and the scene is not perfectly lit.  Since the training and test samples were compiled from images from web sites, your algorithm does not generalize to the actual distribution of the data for which the algorithm is being developed, i.e.  Does not summarize photos from smartphones. <br><br>  Before the ‚Äúbig data‚Äù era, the general rule in machine learning was to randomly break a 70% / 30% data set into a training and test set.  This approach may work, but it is a bad idea for more and more tasks, where the distribution of data in the training set is different from the distribution of data, for which, ultimately, the problem is solved. <br><br>  Usually we define three samples: <br><br>  ‚Ä¢ training, which runs the learning algorithm; <br>  ‚Ä¢ For development (development set), which is used to adjust parameters, select features and make other decisions regarding the learning algorithm, sometimes such a sample is called held for cross-validation (hold-out cross validation set); <br>  ‚Ä¢ Test, which assess the quality of the algorithm, but based on it do not make any decisions about which learning algorithm or parameters to use. <br><br>  As soon as you make a test sample and sample for development, your team will begin to try many ideas, for example, the various parameters of the learning algorithm to see what works best.  These samples allow you to quickly assess how well the model works.  In other words, the goal of test and work (development) samples is to direct your team towards the most important changes in the development of machine learning systems.  Thus, you should do the following: create a working and test sample so that they correspond to the data you expect to receive in the future, and on which your system should work well.  In other words, your test sample should not just include 30% of the available data, especially if in the future you expect data (photos from smartphones) that differ from the data in the training sample (images from websites). <br><br>  If you have not yet begun to distribute your mobile application, then as long as you do not have users, and it is not possible to collect exactly the data that you expect in the future.  But you can try to approximate them.  For example, ask your friends and acquaintances to take photos with mobile phones and send them to you.  As soon as you publish the mobile application, you will be able to update the developmental and test sample with real user data. <br><br>  If there is no possibility of obtaining data that approximates what is expected in the future, then perhaps you can start working with images from web sites.  But you must clearly understand that it is a risk to create a system that has a low generalizing ability for a given task. <br><br>  It is necessary to estimate how much time and effort you are willing to invest in creating two powerful samples: for development and test.  Do not make blind assumptions that the distribution of data in the training sample is exactly the same as in the test sample.  Try to choose test examples that reflect what should work well in the end, and not any data that you are lucky enough to have for training. <br><br><h1>  6. Development and test samples must be from the same source and have the same distribution. </h1><br>  The feline mobile app photos are segmented into four regions that correspond to the largest application markets: USA, China, India and the rest of the world.  You can create a working sample from the data of two randomly selected segments, and put the data of the two remaining ones into the test sample.  Right?  No, mistake!  Once you determine these two samples, the team will focus on improving the quality of the working sample.  Consequently, this sample should reflect the whole task that you are solving, and not part of it: you need to work well in all markets, not just in two. <br><br>  There is another problem in the inconsistency of the data distribution in the working and test samples: there is a chance that your team will create something well working on the sample for development, and then make sure that it does not work well on the test sample.  As a result, there will be a lot of frustration and wasted effort.  Avoid this. <br><br>  Suppose your team has developed a system that works well on a sample for development, but not on a test one.  If both samples were obtained from the same source / distribution, then there is a fairly clear diagnosis of what went wrong: you have overtrained on the working sample.  The obvious cure: increase the amount of data in the work sample.  But if these two samples do not match, then there are a lot of things that could ‚Äúgo wrong.‚Äù  In general, it is quite difficult to work on applications with machine learning algorithms.  The discrepancy between the working and test samples introduces additional uncertainty in the question: will the improvement in the work on the working sample lead to improvements in the test sample?  Having such a discrepancy, it is difficult to understand what is not working, it is difficult to prioritize: what should have been tried first. <br><br>  If you are working on a task, when a sample is provided by a third-party company / organization, then the working and test sample may have different distributions, and you cannot influence this situation.  In this case, luck, not skill, will have a greater impact on the quality of the model.  Learning a model on data that has one distribution, for processing data (also with a high generalizing ability) that has a different distribution, is an important research problem.  But if your goal is to get a practical result, not a study, then I recommend using data from the same source and equally distributed for the working and test samples. <br><br><h1>  7. What size should be test and working (development) of the sample? </h1><br>  The working sample should be large enough to detect the difference between the algorithms that you are trying.  For example, if classifier A gives an accuracy of 90.0%, and classifier B has an accuracy of 90.1%, then a working sample of 100 samples will not allow to see a change of 0.1%.  In general, a working sample of 100 samples is too small.  Common practices are samples from 1,000 to 10,000 samples.  With 10,000 samples, you have a chance to see a 0.1% improvement. <br><br>  <i>Author's note: it is theoretically possible to conduct statistical tests in order to determine whether changes in the algorithm led to significant changes in the working sample, but in practice most teams do not bother with this (unless they write a scientific article), I also do not find such tests useful for assessing interim progress.</i> <i><br></i> <br>  For developed and important systems, such as advertising, search, recommendation systems, I saw teams that were striving to achieve improvements even at 0.01%, as this directly affected the profits of their companies.  In this case, the working sample must be well over 10,000 to be able to determine the slightest change. <br><br>  What can be said about the size of the test sample?  It should be large enough to evaluate with high confidence the quality of the system.  One popular heuristic was to use 30% of the available data for a test sample.  This works quite well when you have a small amount of data, say, from 100 to 10,000 samples.  But in the era of ‚Äúbig data‚Äù, when there are tasks with more than a million samples for training, the proportion of data in the working and test sample is reduced, even when the absolute size of these samples is growing.  There is no need to have working and test samples much larger than the volume that allows you to evaluate the quality of your algorithms. </div><p>Source: <a href="https://habr.com/ru/post/321368/">https://habr.com/ru/post/321368/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321358/index.html">A / B tests are not needed *</a></li>
<li><a href="../321360/index.html">Technosphere Mail.Ru - three years</a></li>
<li><a href="../321362/index.html">Testing Ethereum smart contracts on the example of DAO</a></li>
<li><a href="../321364/index.html">Lightshot client for Ubuntu Linux (and not only)</a></li>
<li><a href="../321366/index.html">NetApp ONTAP & VMware vVOL</a></li>
<li><a href="../321370/index.html">Why VIPER is a bad choice for your next application.</a></li>
<li><a href="../321372/index.html">Why Zuckerberg chasing a ghost</a></li>
<li><a href="../321374/index.html">Configuring the launch of the GRUB bootloader menu when installing Linux from Windows on one computer with a GPT partition table</a></li>
<li><a href="../321376/index.html">Facebook shareholders want to remove Zuckerberg from the chair of the board of directors</a></li>
<li><a href="../321378/index.html">How to work with JIT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>