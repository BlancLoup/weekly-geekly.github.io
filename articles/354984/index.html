<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Erlang-like microservices in Clojure application: it‚Äôs just</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As it is known in the circle of Erlang developers: only Erlang developers know how to "live" correctly  and everyone else "live" is wrong  . Without a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Erlang-like microservices in Clojure application: it‚Äôs just</h1><div class="post__text post__text-html js-mediator-article"><p>  As it is known in the circle of Erlang developers: only Erlang developers know how to "live" correctly <del>  and everyone else "live" is wrong </del>  .  Without attempting to dispute this fact, let us give an example of a Clojure application in the Erlang style using the <a href="https://github.com/suprematic/otplike">Otplike</a> library. </p><a name="habracut"></a><br><p>  For understanding the article, the reader may need to know the basics of Clojure <del>  (Are there still people who do not know Clojure? ...) </del>  and the basic principles of Erlang / OTP (processes, sending messages, <a href="http://erlang.org/doc/design_principles/gen_server_concepts.html">gen_server</a> and <a href="http://erlang.org/doc/design_principles/sup_princ.html">supervisor</a> behaviors).  In order to deal with everything else, the average Clojure developer has everything you need: <a href="">code with examples</a> , REPL and a "tambourine". </p><br><h2 id="pochemu-clojure">  Why clojure? </h2><br><p>  In fact, there are many answers to the question "Why Clojure".  We give our favorite: </p><br><p>  ‚Ññ1.  Clojure is a very effective language for prototyping.  Compared to Java, writing a Clojure application layout is very simple: it is very easy to develop data models and assemble them together. </p><br><p>  ‚Ññ2.  Clojure is very easy to test the application: REPL + ease of layout is decided here.  Whatever the test case in the application, it is sufficient to simply construct the context in which to test the desired case. </p><br><p>  The first two points accelerate the development and support of the application (which falls under the specified conditions) by a factor of 2. But we just started listing ... </p><br><p>  Number 3.  Clojure is fully interoperable with Java / JVM.  This means, in particular, that you can use classes in a Clojure application and export a Clojure application as classes (for example, we <a href="https://habr.com/post/171361/">integrate a clojure library into a java application</a> ).  It also means that all the accumulated code of humanity for the JVM is available for the Clojure application.  So, the Clojure language is not alternative and does not contradict the development of the JVM, but as an addition to the JVM (a very important addition, I would like to say). </p><br><p>  So, we mentioned that through Clojure it is convenient to get to any part of the "heritage of mankind" in the JVM and it is convenient to test.  And now, why all the same Clojure ... </p><br><p>  ‚Ññ4.  Clojure is a language designed to make complex things simple and, in our opinion, they succeeded thanks to the experience and genius of Rich Hickey, who formulated the main ideas of the language (which, in turn, can be read, for example, here: <a href="https://habr.com/post/173071/">Why study Clojure?</a> ) </p><br><p>  Well, personally, my favorite reason .... </p><br><p>  ‚Ññ5.  Clojure programming is <i>fun</i> , i.e.  "lively", interesting and stress free.  Just download the project, just read the code, just think, just write and just <del>  ship unicorns </del>  You give the result. </p><br><h2 id="pochemu-erlangotp-dlya-clojure">  Why Erlang / OTP for Clojure? </h2><br><p>  In the last section, we found out that Clojure is a silver bullet. </p><br><p>  However, for industrial programming in the era of multi-threaded applications, in addition to a convenient and cool language, a practical methodology is needed for developing these multi-threaded applications themselves. </p><br><p> The standard solution for multithreaded applications on Clojure at the moment is the <code>core.async</code> library (for example, <a href="https://habr.com/post/312748/">Prepare multithreading with core.async</a> ).  Practical experience however shows that although the library itself is good, for practice, higher-level ‚Äúbuilding blocks‚Äù are needed. </p><br><p>  And here we return to the happy Erlang developers and to their "charms".  Erlang / OTP has absorbed considerable experience in developing multi-threaded applications, perhaps, like no other language.  Having the implementation of the basic ideas of Erlang / OTP using the <a href="https://github.com/suprematic/otplike">Otplike</a> library, we get: </p><br><ul><li>  Erlang-like processes, messaging between processes and links between processes; </li><li>  implementation of an OTP process like <code>supervisor</code> ( <code>supervisor behaviour</code> ): a process that monitors and overloads other processes, depending on the settings; </li><li>  OTP implementation of a process of the <code>gen_server</code> type ( <code>gen_server behaviour</code> ): a process implementing microservice; </li><li>  start processes on a timer ( <i>scheduling</i> ). </li></ul><br><p>  And not to be unfounded, we give ... </p><br><h2 id="minimalistichnyy-primer-prilozheniya-s-mikroservisom">  Minimalistic sample application with microservice </h2><br><h3 id="servis-dlya-spiska-zadach-todo">  TODO task list service </h3><br><p>  We want to create a microservice for the TODO task list, which accepts the following commands: </p><br><ol><li>  create entity todo: <code>create-todo [params] -&gt; [:ok todo] | [:error reason]</code> <code>create-todo [params] -&gt; [:ok todo] | [:error reason]</code> </li><li>  return todo by id: <code>find-todo-by-id [id] -&gt; [:ok todo] | [:error reason]</code> <code>find-todo-by-id [id] -&gt; [:ok todo] | [:error reason]</code> </li><li>  terminate todo: <code>terminate-todo [id] -&gt; [:ok updated_todo] | [:error reason]</code> <code>terminate-todo [id] -&gt; [:ok updated_todo] | [:error reason]</code> </li><li>  delete todo: <code>delete-todo [id] -&gt; [:ok nil] | [:error reason]</code> <code>delete-todo [id] -&gt; [:ok nil] | [:error reason]</code> </li><li>  return the list of active todo: <code>enumerate-active-todos [] -&gt; [:ok todos] | [:error reason]</code> <code>enumerate-active-todos [] -&gt; [:ok todos] | [:error reason]</code> </li></ol><br><p>  Strangely enough, but from this description, the public API for the TODO service follows directly (you can see the complete code sample on GitHub <a href="">here</a> ): </p><br><pre> <code class="hljs lisp">(<span class="hljs-name"><span class="hljs-name">defn</span></span> create-todo [params] (<span class="hljs-name"><span class="hljs-name">call*</span></span> [<span class="hljs-symbol"><span class="hljs-symbol">:create-todo</span></span> params])) (<span class="hljs-name"><span class="hljs-name">defn</span></span> find-todo-by-id [id] (<span class="hljs-name"><span class="hljs-name">call*</span></span> [<span class="hljs-symbol"><span class="hljs-symbol">:find-todo-by-id</span></span> id])) (<span class="hljs-name"><span class="hljs-name">defn</span></span> terminate-todo [id] (<span class="hljs-name"><span class="hljs-name">call*</span></span> [<span class="hljs-symbol"><span class="hljs-symbol">:terminate-todo</span></span> id])) (<span class="hljs-name"><span class="hljs-name">defn</span></span> delete-todo [id] (<span class="hljs-name"><span class="hljs-name">call*</span></span> [<span class="hljs-symbol"><span class="hljs-symbol">:delete-todo</span></span> id])) (<span class="hljs-name"><span class="hljs-name">defn</span></span> enumerate-active-todos [] (<span class="hljs-name"><span class="hljs-name">call*</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:enumerate-active-todos</span></span>))</code> </pre> <br><p>  Calling a <code>call*</code> means simply sending a message to the service. </p><br><p>  The essence of the processing of messages for the <code>gen_server</code> service is that all these messages are processed sequentially, passing the value of the <code>state</code> service from one message processing to another.  Even if many processes in parallel send their requests to our service, it will not break the <i>consistency of</i> our <code>state</code> , since all these requests will be executed sequentially.  In practice, this simplifies the development of the service life cycle. </p><br><p>  For the development of the Otplike service <code>gen_server</code> usual OTP <i>callbacks</i> are available for implementation: </p><br><ol><li>  initialization handler of the <code>state</code> service: <code>init [args] -&gt; [:ok initial_state]</code> </li><li>  handler for messages that must return the result to the client process (synchronous messages): <code>handle-call [message from state] -&gt; [:reply reply updated_state] | [:noreply updated_state]</code> <code>handle-call [message from state] -&gt; [:reply reply updated_state] | [:noreply updated_state]</code> </li><li>  message handler without a result to the client process (asynchronous messages): <code>handle-cast [message state] -&gt; [:noreply updated_state]</code> </li><li>  system message handler: <code>handle-info [message state] -&gt; [:noreply updated_state]</code> </li><li>  service <code>terminate [reason state] -&gt; nil</code> handler: <code>terminate [reason state] -&gt; nil</code> </li></ol><br><h3 id="prodvinutyy-primer-supervayzera-dlya-peregruzki-servisov-v-repl">  Advanced example supervisor for reloading services into REPL </h3><br><p>  Suppose we implemented a TODO service, and from the REPL we launched it in a new process.  After that we made changes to the code of this service and now we want to run the modified code in order to test it.  How do we do this? </p><br><p>  One solution is to kill the process with the old code and run the new code in the new process. <br>  However, these services we can have a lot and they can depend on one another.  In addition, the order of launching services can also be important. </p><br><p>  Therefore, there is another radical solution that comes from OTP: you need to have a supervisor process that will monitor our services and who will be able to overload them. <br>  In addition, we want to be able to overload the supervisor himself so that we can bring our application from the REPL to a known initial state. </p><br><p>  For these requirements, we get the following code for Otplike: </p><br><pre> <code class="hljs ruby">;;;;;;;;;;;;;;;;;;;;;;;;; supervision-tree (defn- app-sup [_config] [<span class="hljs-symbol"><span class="hljs-symbol">:ok</span></span> [{<span class="hljs-symbol"><span class="hljs-symbol">:strategy</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:one-for-one</span></span>} [{<span class="hljs-symbol"><span class="hljs-symbol">:id</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:todo-server</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:start</span></span> [todo-server/start-link [{}]]}]]]) ;;;;;;;;;;;;;;;;;;;;;;;;; boot-proc (defn- start-app-sup-link [config] (supervisor/start-link <span class="hljs-symbol"><span class="hljs-symbol">:app-sup</span></span> app-sup [config])) (defn- start-boot-sup-link [config] (supervisor/start-link <span class="hljs-symbol"><span class="hljs-symbol">:boot-sup</span></span> (fn [cfg] [<span class="hljs-symbol"><span class="hljs-symbol">:ok</span></span> [{<span class="hljs-symbol"><span class="hljs-symbol">:strategy</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:one-for-all</span></span>} [{<span class="hljs-symbol"><span class="hljs-symbol">:id</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:app-sup</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:start</span></span> [start-app-sup-link [cfg]]}]]]) [config])) (defn start [] (<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-let [pid (process/whereis <span class="hljs-symbol"><span class="hljs-symbol">:boot-proc</span></span>)] (log/info <span class="hljs-string"><span class="hljs-string">"already started"</span></span> pid) (let [config (config/get-config)] (process/spawn-opt (process/proc-fn [] (match (start-boot-sup-link config) [<span class="hljs-symbol"><span class="hljs-symbol">:ok</span></span> pid] (loop [] (process/receive! <span class="hljs-symbol"><span class="hljs-symbol">:restart</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">do</span></span> (log/info <span class="hljs-string"><span class="hljs-string">"------------------- RESTARTING -------------------"</span></span>) (supervisor/terminate-child pid <span class="hljs-symbol"><span class="hljs-symbol">:app-sup</span></span>) (log/info <span class="hljs-string"><span class="hljs-string">"--------------------------------------------------"</span></span>) (supervisor/restart-child pid <span class="hljs-symbol"><span class="hljs-symbol">:app-sup</span></span>) (recur)) <span class="hljs-symbol"><span class="hljs-symbol">:stop</span></span> (process/exit <span class="hljs-symbol"><span class="hljs-symbol">:normal</span></span>))) [<span class="hljs-symbol"><span class="hljs-symbol">:error</span></span> reason] (log/error <span class="hljs-string"><span class="hljs-string">"cannot start root supervisor: "</span></span> {<span class="hljs-symbol"><span class="hljs-symbol">:reason</span></span> reason}))) {<span class="hljs-symbol"><span class="hljs-symbol">:register</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:boot-proc</span></span>})))) (defn stop [] (<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-let [pid (process/whereis <span class="hljs-symbol"><span class="hljs-symbol">:boot-proc</span></span>)] (process/! pid <span class="hljs-symbol"><span class="hljs-symbol">:stop</span></span>) (log/info <span class="hljs-string"><span class="hljs-string">"already stopped"</span></span>))) (defn restart [] (<span class="hljs-keyword"><span class="hljs-keyword">if</span></span>-let [pid (process/whereis <span class="hljs-symbol"><span class="hljs-symbol">:boot-proc</span></span>)] (process/! pid <span class="hljs-symbol"><span class="hljs-symbol">:restart</span></span>) (start)))</code> </pre> <br><p>  The full code can be viewed on GitHub <a href="">here.</a> </p><br><p>  In the <code>app-sup</code> function, we list the child processes for our main supervisor. <br>  And the rest of the code is the <i>workaround</i> for restarting the supervisor. </p><br><p>  Well, finally ... </p><br><h3 id="testirovanie">  Testing </h3><br><p>  Head over to the REPL and see how our TODO service and application restart work. </p><br><p>  We start the REPL from the console from the <a href="">project</a> root: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">lein</span></span> repl</code> </pre> <br><p>  We start the application: </p><br><pre> <code class="hljs pgsql">erl-<span class="hljs-keyword"><span class="hljs-keyword">like</span></span>-app.<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>=&gt; (erl-<span class="hljs-keyword"><span class="hljs-keyword">like</span></span>-app.<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>) &lt;proc1@<span class="hljs-number"><span class="hljs-number">1</span></span>&gt; <span class="hljs-number"><span class="hljs-number">18</span></span><span class="hljs-number"><span class="hljs-number">-05</span></span><span class="hljs-number"><span class="hljs-number">-11</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">29</span></span>:<span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span> - todo <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> initialized</code> </pre> <br><p>  Create a TODO pair and mark the first TODO as done: </p><br><pre> <code class="hljs ruby">erl-like-app.server=&gt; (erl-like-app.todo.todo-server/create-todo {<span class="hljs-symbol"><span class="hljs-symbol">:title</span></span> <span class="hljs-string"><span class="hljs-string">"task #1"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:description</span></span> <span class="hljs-string"><span class="hljs-string">"create task #2"</span></span>}) [<span class="hljs-symbol"><span class="hljs-symbol">:ok</span></span> {<span class="hljs-symbol"><span class="hljs-symbol">:title</span></span> <span class="hljs-string"><span class="hljs-string">"task #1"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:description</span></span> <span class="hljs-string"><span class="hljs-string">"create task #2"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:id</span></span> <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:created</span></span> <span class="hljs-number"><span class="hljs-number">1526049427586</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:updated</span></span> <span class="hljs-number"><span class="hljs-number">1526049427586</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:status</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:active</span></span>}] erl-like-app.server=&gt; (erl-like-app.todo.todo-server/create-todo {<span class="hljs-symbol"><span class="hljs-symbol">:title</span></span> <span class="hljs-string"><span class="hljs-string">"task #2"</span></span>}) [<span class="hljs-symbol"><span class="hljs-symbol">:ok</span></span> {<span class="hljs-symbol"><span class="hljs-symbol">:title</span></span> <span class="hljs-string"><span class="hljs-string">"task #2"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:id</span></span> <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:created</span></span> <span class="hljs-number"><span class="hljs-number">1526049434985</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:updated</span></span> <span class="hljs-number"><span class="hljs-number">1526049434985</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:status</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:active</span></span>}] erl-like-app.server=&gt; (erl-like-app.todo.todo-server/terminate-todo <span class="hljs-string"><span class="hljs-string">"1"</span></span>) [<span class="hljs-symbol"><span class="hljs-symbol">:ok</span></span> {<span class="hljs-symbol"><span class="hljs-symbol">:title</span></span> <span class="hljs-string"><span class="hljs-string">"task #1"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:description</span></span> <span class="hljs-string"><span class="hljs-string">"create task #2"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:id</span></span> <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:created</span></span> <span class="hljs-number"><span class="hljs-number">1526049427586</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:updated</span></span> <span class="hljs-number"><span class="hljs-number">1526049443912</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:status</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:terminated</span></span>}]</code> </pre> <br><p>  What remained active TODO: </p><br><pre> <code class="hljs ruby">erl-like-app.server=&gt; (erl-like-app.todo.todo-server/enumerate-active-todos) [<span class="hljs-symbol"><span class="hljs-symbol">:ok</span></span> ({<span class="hljs-symbol"><span class="hljs-symbol">:title</span></span> <span class="hljs-string"><span class="hljs-string">"task #2"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:id</span></span> <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:created</span></span> <span class="hljs-number"><span class="hljs-number">1526049434985</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:updated</span></span> <span class="hljs-number"><span class="hljs-number">1526049434985</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:status</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:active</span></span>})]</code> </pre> <br><p>  What is the value of the <code>state</code> service: </p><br><pre> <code class="hljs ruby">erl-like-app.server=&gt; (erl-like-app.todo.todo-server/get-state) {<span class="hljs-symbol"><span class="hljs-symbol">:counter</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:db</span></span> {<span class="hljs-string"><span class="hljs-string">"1"</span></span> {<span class="hljs-symbol"><span class="hljs-symbol">:title</span></span> <span class="hljs-string"><span class="hljs-string">"task #1"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:description</span></span> <span class="hljs-string"><span class="hljs-string">"create task #2"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:id</span></span> <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:created</span></span> <span class="hljs-number"><span class="hljs-number">1526049427586</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:updated</span></span> <span class="hljs-number"><span class="hljs-number">1526049443912</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:status</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:terminated</span></span>}, <span class="hljs-string"><span class="hljs-string">"2"</span></span> {<span class="hljs-symbol"><span class="hljs-symbol">:title</span></span> <span class="hljs-string"><span class="hljs-string">"task #2"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:id</span></span> <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:created</span></span> <span class="hljs-number"><span class="hljs-number">1526049434985</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:updated</span></span> <span class="hljs-number"><span class="hljs-number">1526049434985</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:status</span></span> <span class="hljs-symbol"><span class="hljs-symbol">:active</span></span>}}}</code> </pre> <br><p>  Reload the application: </p><br><pre> <code class="hljs pgsql">erl-<span class="hljs-keyword"><span class="hljs-keyword">like</span></span>-app.<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>=&gt; (erl-<span class="hljs-keyword"><span class="hljs-keyword">like</span></span>-app.<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">restart</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span><span class="hljs-number"><span class="hljs-number">-05</span></span><span class="hljs-number"><span class="hljs-number">-11</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>:<span class="hljs-number"><span class="hljs-number">30</span></span>:<span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INFO</span></span> - <span class="hljs-comment"><span class="hljs-comment">------------------- RESTARTING ------------------- 18-05-11 14:30:28 INFO - todo server stopped 18-05-11 14:30:28 INFO - -------------------------------------------------- 18-05-11 14:30:28 INFO - todo server initialized</span></span></code> </pre> <br><p>  What is the <code>state</code> value of the service now? </p><br><pre> <code class="hljs pgsql">erl-<span class="hljs-keyword"><span class="hljs-keyword">like</span></span>-app.<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>=&gt; (erl-<span class="hljs-keyword"><span class="hljs-keyword">like</span></span>-app.todo.todo-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-state) {:counter <span class="hljs-number"><span class="hljs-number">0</span></span>, :db {}}</code> </pre> <br><h2 id="itog">  Total </h2><br><p>  And what is the result: </p><br><ul><li>  there is an <a href="https://github.com/suprematic/otplike">Otplike</a> library that opens a ‚Äúdoor‚Äù in Erlang in Clojure, and </li><li>  There is <a href="">an example of an application</a> that opens the "door" in Otplike. </li></ul><br><p>  I can't know if you need this door, but from our experience I can say that behind this door you get a cool code (which means effective and easy). </p><br><p>  Good coding! </p><br></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/354984/">https://habr.com/ru/post/354984/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../354974/index.html">"Fant" and Okmeter: a symbiosis for the benefit of monitoring</a></li>
<li><a href="../354976/index.html">SmartMailHack. Solution of the 1st place in the problem of logo classification</a></li>
<li><a href="../354978/index.html">CPU Design I (First ver.)</a></li>
<li><a href="../354980/index.html">Do-it-yourself interactive 3D maps</a></li>
<li><a href="../354982/index.html">An open letter to marketers and other PR people involved in content on Habr√© and other resources</a></li>
<li><a href="../354986/index.html">Comparison of keyword automatic clustering services for SEO</a></li>
<li><a href="../354988/index.html">The digest of fresh materials from the world of the frontend for the last week No. 313 (April 30 - May 6, 2018)</a></li>
<li><a href="../354990/index.html">Module Nchan web server nginx. Work with Websocket, EventSource (Server-Sent Events), Long-Polling</a></li>
<li><a href="../354992/index.html">Web application security: fighting with oneself, or drawing the line of adequacy</a></li>
<li><a href="../354996/index.html">Product Design Digest April 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>