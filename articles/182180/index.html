<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>As I taught Africans from South Africa to protect SAP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Open the column Infosectravel , - we will write notes about trips to conferences and exhibitions on information security around the world such as Kuwa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>As I taught Africans from South Africa to protect SAP</h1><div class="post__text post__text-html js-mediator-article">  Open the column <i>Infosectravel</i> , - we will write notes about trips to conferences and exhibitions on information security around the world such as Kuwait, Africa, Australia, etc.  Although European and American events such as BlackHat and Confidence and others, too, will not disregard. <br><br>  Welcome wishes and comments.  The format is completely new, although a couple of attempts have already been ( <a href="http://habrahabr.ru/company/dsec/blog/144383/">Kuwait</a> , <a href="http://habrahabr.ru/company/dsec/blog/140897/">BlackHat</a> , <a href="http://habrahabr.ru/company/dsec/blog/145872/">Confidence</a> ) and we do not yet know for ourselves what will be the result. <br><br>  It so happened that on the May holidays I went not to rest in Turkey, but to work in Africa :) <br>  In a nutshell, from May 7 to 9, in Johannesburg - the capital of South Africa - the international security exhibition and conference ITWEB was held.  This year we decided to take an active part in it, to make a report and to communicate with clients that you don‚Äôt often see with your own eyes.  The trip seemed all the more attractive because my colleagues, because of the heightened criminal situation in the region, refused to go. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>First impressions</b> <br><br>  The first thing I saw when I checked into the hotel was IT.  Sorry for the quality of the photo - used for shooting what was at hand. <br><img src="http://imageshack.us/a/img854/7826/pic1vt.jpg" alt="image"><br><br>  Great, new stock.  And I heard that in Africa the children are starving ... Then there were Maserati and Bentley, but this was no longer so epic. <br><a name="habracut"></a><br>  The first impression of South Africa is apparently no different from America, the same shopping malls, the same buildings and roads, about the same number of African Africans.  But I still had two days not to wander around the streets, but <s>to protect the booth at the exhibition from the invasion of zombie mutants</s> about the advantages of our product. <br><br>  ITWEB is a rather large event.  Of course, this is not RSA or BlackHat, or even Infosecurity, but its 50 exhibitors will be typed on it.  According to this indicator, the exhibition is much larger than the average European counterparts.  Although if you consider that the conference is designed mostly for business, it is clear where so many stands come from.  About half of the exhibitors are well-known international brands (RSA, Splunk, IBM, Kaspersky) and other local companies are consultants and resellers.  By the way, I was pleasantly surprised that Sensepost, known for its technical surveyors, has its headquarters in South Africa and is successfully developing its second office in England. <br>  Unfortunately, I can‚Äôt say anything intelligible about the program, because I didn‚Äôt attend any speech except my own, and nothing supernatural was expected, except The Grugq, which, by the way, is from South Africa. <br><br>  <b>Day two</b> <br>  On the second day of the exhibition, I was pleasantly surprised by the news that our company and I, in particular, won the Hot Companies And Best Products Award awards, which at that time were being presented in <a href="http://www.networkproductsguide.com/world/index.html">Las Vegas</a> . <br><br><img src="http://imageshack.us/a/img850/3715/pic3ttx.jpg" alt="image"><br><br>  I won the gold prize in the R &amp; D nomination professional of the year, and our product received bronze in the categories ‚ÄúInformation Security and Risk Management‚Äù and ‚ÄúSecurity Software", not bad, especially considering that the competitors were Net Optics, Cenzic, RedSeal, Norman, Application Security Inc and even SAP with the Afaria platform. <br>  In order to celebrate this event, I treated the visitors to the exhibition Beluga.  The people at first were slightly surprised, but then willingly joined the holiday. <br><img src="http://imageshack.us/a/img837/4011/pic2jq.jpg" alt="image"><br>  In general, the exhibition was not particularly impressed: as elsewhere, among the presented solutions, the SIEM and various magic "prevention from cyber attacks and APT" prevailed.  It was nice, therefore, to hear from one visitor such a review about us: ‚ÄúWell, at least something interesting, and then cyber-something-there is the same everywhere.‚Äù <br><br>  <b>Report</b> <br><br>  It is time to talk about the <a href="http://www.itweb.co.za/media/jukebox/SecuritySummit2013/Alexander%2520Polyakov.pdf">report</a> .  This time it was not very technical, as the public was appropriate.  And the area that we are investigating lately - investigating incidents and analyzing attacks in SAP - in general, is not at all about vulnerabilities, but quite the opposite: how to detect traces of these vulnerabilities using different log files, traces and other specific things.  I'll tell you about the report in general. <br>  Since the topic of SAP security is still new for the region, half of the speech had to be devoted to common things, however, taking into account South African specifics.  For example, some figures were presented on the results of scanning the Internet for the presence of open SAP ports this year.  In South Africa, as it turned out, quite a lot of information security threats are associated with routers: about 20% of these devices are vulnerable to information disclosure, and 5% - to bypass authentication.  As for other services, then, on average, the situation looks worse than global statistics by about 2-3 times (we are talking about unsafe services offered via the Internet). <br><br>  Actually, the main thesis of the report was: ‚Äúyou will not protect yourself from everything, however, it is necessary to analyze system events in order to quickly detect attacks and react to them as quickly as possible.‚Äù <br>  Why is this important for SAP systems?  First, the thesis is applicable to any systems.  Secondly, about six months ago, the news about how Anonymus broke into the Greek Ministry of Finance after 0-day the vulnerability in SAP and published secret information on the Internet.  Despite the fact that no official confirmation of the fact of hacking has been received either from the organization or from SAP, I can safely say that such a scenario is more than likely.  And finally, thirdly, how many companies can really claim that they have not been attacked from the SAP system? <br>  On the one hand, even if an event took place, it is unlikely to be made public.  On the other hand, the results of our audits demonstrate that a very small percentage of companies have the ability to detect the fact of an attack.  Even such a simple thing as logging very few people include.  We did a little research, and here are the results: about 70% of companies have a configured HTTP-log for SAP, and then only because it is configured by default.  As for other magazines, everything is much sadder there.  The percentage of various logs, respectively: Security audit log in ABAP - 10%, Table access logging - 4%, Message Server log - 2%, SAP Gateway access log - 2%. <br>  Looking at these numbers, you understand that it is unlikely that everyone can get a clear picture of possible hacking attempts.  More importantly, it is that even with customized logging, only a small percentage centrally collects information in a place inaccessible for modification, and also processes events and has the ability to carry out correlation. <br><br>  <b>Attacks on SAP Portal and J2EE applications</b> <br><br>  Now for special cases.  In this report, we have examined in detail only the attacks on SAP Portal, since this application is critical because of its accessibility from the Internet and has connections to other systems.  In fact, it is the first link in the chain of a possible attack on internal SAP resources. <br>  In general, attacks are reduced to two types of detection.  The first one is simple attacks that can be traced in the standard HTTP request log, where headers are stored.  The second is more advanced attacks that are contained in POST requests and do not fall into the standard log. <br><br>  To analyze the attacks of the second type, the simplest option is to configure extended logging of all requests.  However, in this case, a huge amount of unnecessary information will be written, including the Cookie and Jsessionid fields and passwords sent in forms.  In addition, it is unsafe.  Naturally, there are settings that allow you not to save these fields, which you can see in more detail in the report, but still this solution is not the best option if there are no corresponding additional tools to analyze this entire stream of POST requests. <br><br>  But if you do not analyze the POST request, then what then?  Several alternative methods have been shown that are also difficult to call ideal.  For example, you can use the analysis of indirect events. <br>  In SAP Portal and WebDynpro applications, all data is transmitted in a huge ‚ÄúPOST‚Äù sheet of requests reaching hundreds of parameters, and in logs any action looks like a call to the same service with a link to its URL.  That is, in the general case, it is impossible to understand what was happening without analyzing POST requests. <br>  Various tricks come to mind, for example.  In the portal interface there are various icons that are often found alongside critical actions, including changing the level of event logging or disabling logs, or uploading files to the server.  Both can be used by an attacker for attacks such as loading an HTML file with the COOKIE hijacking script into a common directory or trying to disable logging.  Such actions create a request to the web server to upload the corresponding icon, which is clearly displayed in the log files and makes it possible to indirectly detect the fact of an attack. <br>  It is characteristic that ordinary users do not load images when performing such actions, since they are already loaded into the browser cache (except for the first time), thanks to which we will see only illegitimate references, which will allow us to talk about a possible attack. <br><br>  Naturally, there are a lot of nuances and false positives, as well as ways to circumvent such a mechanism, but, firstly, not knowing what it is, you would hardly have guessed to circumvent it, and, secondly, with proper combination with other details, You can set up a quite good system, alternative to full logging, or combine the recording of full logs only in the presence of such events so as not to store all the data. <br>  In general, since the topic is rather new, a bunch of options applied to SAP, and I have just stated the basic things, but my colleagues will probably tell about the others during the presentation at Confidence. <br><br>  <b>PS</b> <br>  After the conference, I decided to relax a bit by visiting the beautiful J-Bay beach - one of the world's best surfing spots, with perfectly long waves, where you can surf along with dolphins, until the albatros have eaten them.  There was no one to shoot me, because only an empty beach with small waves, since in normal times there was no time for filming. <br><img src="http://imageshack.us/a/img593/1820/pic5yg.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f1d/0ed/5b3/f1d0ed5b398f67c796284c8e27f174c7.jpg" alt="image"><br>  On the coast, the atmosphere is very friendly and relaxed, and the food is very tasty and cheap, so I do not understand why go to Egypt and similar places when there is so much beautiful in the world. <br>  Naturally, there is crime in South Africa.  For example, the Johannesburg center is in principle not recommended for visiting, since there is no police there, people are simply killed without any questions.  At best, you will be left without clothes with a knife wound and you will tell all your life what kind robbers you have met. <br>  Thank you all, reports from the conference can be downloaded <a href="http://www.itweb.co.za/index.php%3Foption%3Dcom_jukebox%26view%3Dcategory%26id%3D755:security-summit-2013">here</a> , wait for the next post from Australia. </div><p>Source: <a href="https://habr.com/ru/post/182180/">https://habr.com/ru/post/182180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../182168/index.html">Wedding ring glows, if you take the hand</a></li>
<li><a href="../182170/index.html">What languages ‚Äã‚Äãdo our users speak?</a></li>
<li><a href="../182174/index.html">In Humble Indie Bundle 8 added new games</a></li>
<li><a href="../182176/index.html">Competency model of a computer security specialist</a></li>
<li><a href="../182178/index.html">Detected a network of cyber espionage, operating in 40 countries</a></li>
<li><a href="../182182/index.html">Domestic developer of autonomous chassis robots or our response to Google cars</a></li>
<li><a href="../182184/index.html">AurumXchange doesn‚Äôt seem to be all right</a></li>
<li><a href="../182188/index.html">DVR AdvoCam FD5 - decent work on the bugs</a></li>
<li><a href="../182190/index.html">Cache to speed</a></li>
<li><a href="../182192/index.html">PrivatBank will release an application for Google Glass</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>