<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Continuous Delivery in Yandex. How to overclock your development cycle using only Open Source solutions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There were always two tasks before testing - to help the team maintain a high level of development quality and do it without delaying the whole proces...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Continuous Delivery in Yandex. How to overclock your development cycle using only Open Source solutions</h1><div class="post__text post__text-html js-mediator-article">  There were always two tasks before testing - to help the team maintain a high level of development quality and do it without delaying the whole process.  And this is true not only for our projects in Yandex, where we are working on a very large number of services.  Often the main task is altogether formulated as an increase in the speed of testing while maintaining an adequate level of quality.  The speed of the development process, commitment to the values ‚Äã‚Äãof frequent and quick releases - these are fundamental factors for the success of any product.  The team has more opportunities for maneuver, the team quickly finds and corrects errors, gets feedback quickly.  How to accelerate without losing quality, how to achieve a zen of continuous change delivery? <br><br> <a href="http://habrahabr.ru/company/yandex/blog/237017/"><img src="https://habrastorage.org/files/305/4c6/2c3/3054c62c38af46a889b5fb440744a9aa.jpg"></a> <br><br>  Today we show that Continuous Delivery is easy and fun!  And the benefit from it can be obtained by incorporating it even partially.  We have been using a similar approach for our open source libraries, <a href="https://github.com/allure-framework">Allure Framework</a> or <a href="https://github.com/yandex-qatools">Yandex QATools,</a> for several years in testing Yandex.  The process is simple, significantly scalable and can be used for huge teams of one person, and for small teams of dozens of people.  And most importantly - the entire toolkit is available in Open Source! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      By the way, before September 30, you <a href="https://tech.yandex.ru/education/autoschool/spb-2014/">can apply</a> and enroll in our School of automation of development processes in St. Petersburg.  Training in it is free and will consist not only of a course of lectures - an obligatory stage will be team work on an educational project. <br><br>  Now back to the topic.  Imagine the picture: a cozy workplace, you write code, add unit tests and send changes to the version control system, and after a couple of hours they ‚Äúgo‚Äù to the combat servers.  And everything works. <br><a name="habracut"></a><br>  It seems that such a process is characteristic either for the development method of ‚Äúchloby, khloby and in production‚Äù (by removing part of the unit tests), or for the commercial of a company specializing in innovation in software development.  At the same time, a running line is required under it, similar to the signature under stunt tricks: ‚ÄúDanger, do not try to repeat at home!‚Äù. <br><br><h4>  As it was before </h4><br>  <b>The history of one developer</b> .  I heard a backup task somewhere: ‚ÄúHow many trucks do you need for the administrator to start making backup copies?‚Äù.  Humor is black, so the decision is waiting in the comments.  Here we are talking about the development process, but the essence does not change.  The developer sends any change to the main branch and, considering that it is time to assemble the package for testing and display, stops at a stable, in his opinion, state of the code, updating the branch from which the packages are collected.  Now the question arises: "What is contained in the new package after the next assembly?".  Any answer to this question may be wrong.  After all, the developer is sure that only he changes the code, so it‚Äôs not necessary to look at the change history.  It used to be, literally a miracle, found when testing anomalies that could seriously complicate the lives of the users of our services.  Anomalies turned out to be inconsistent changes, which fell into a branch either from a developer from another project who decided to fix the bug, or collected ‚Äúfor the company‚Äù and simply forgotten.  Difficulties expected and those who would decide to join the development process.  Which branch is being developed?  In which branch is the stable version?  How to build a package? <br><br>  And if there were errors in the package, after their revisions the tester could wait for a surprise - along with the corrections several more new features could ‚Äúarrive‚Äù.  With a lot of luck after a couple of cycles, the package could increase the initial number of tasks several times and ‚Äúswell‚Äù to unimaginable sizes. <br><br>  <b>The story of several developers</b> .  This story differs only in that in the list of the daily routine, each developer in the team is added the merging of their changes with the changes of their colleagues.  And after all, everyone trusts each other and no one looks at these very changes of colleagues - they know what they write!  Everyone would be happy to see what is happening with the project, especially when a colleague goes on vacation, you still have to figure it out, but where to do it?  There is nowhere to leave a comment in the development environment.  Personally, it is not always convenient to say, especially if the development is carried out in different offices.  And the changes are already in the project - it‚Äôs so easy not to redo it in case of errors. <br><br>  What do these stories have in common?  Excuses.  Everyone believes that it is too difficult to simplify your life by entering an understandable process and automating the routine.  In addition, everyone will have to break themselves on the knee to get used to the new realities.  This is not true.  We have already destroyed such a myth in our teams. <br><br>  It is unproductive to rush to destroy harmful, but insignificant myths, about which no one has heard or from whom nobody suffered.  Therefore, having experienced the first difficulties with delivering changes to the final consumers, the current development scheme had to be changed. <br><br><h4>  Tools </h4><br>  For total fun, you will need: GitHub Flow as an immediate process, CI server.  A bit, right?  Our libraries live on GitHub, so I will use its terminology, giving comments along the way.  This whole process is quite possible on almost any combination of CI servers and popular platforms for IT projects, such as <a href="https://about.gitlab.com/">GitLab</a> , <a href="https://bitbucket.org/">Bitbucket</a> .  The key is only one thing: you need a glue called the Pull Request Builders extension family. <br><br><h4>  Salt in 5 seconds </h4><br>  Fork, commit, push, request, build, review, merge, release. <br><br><h4>  Salt in three stages </h4><br>  I will not use all these funny words anymore.  Though very pulling!  The one who knows them and regularly uses, most likely, introduced a similar process long ago.  These short incomprehensible words are as easy to learn as they are to implement the following basic steps as part of the task of easy process construction: <br><ol><li>  developer makes change; </li><li>  others are watching the change; </li><li>  The change falls into the main branch of the version control system. </li></ol><br><h4>  Developer makes change </h4><br>  The entry point is the main repository, the master branch.  One of the main benefits of the approach is always known where the stable working code is located, which was seen not only by the developer.  Direct modification of this branch is prohibited.  Even if you really want. <br><br>  <b>At this stage, only GitHub or equivalent is required.</b>  The first thing to do is to duplicate the current master branch of the main repository to your personal repository.  Here the developer is free to build the encoding process as he likes.  This is his personal repository, and here he is the absolute master.  The ultimate goal is simple - a set of changes, based on the master branch of the main repository, in any branch of the personal one. <br>  At this stage, the biggest challenge is getting used to writing unit-tests for your changes.  The most interesting thing is that the difficulty is not to write these tests, but to train yourself to do them.  But if you develop such a habit, it will pay for almost any effort on the writing of tests.  Start small: cover positive scenarios.  They are easy to think through, easy to implement in tests.  Having got used not to be afraid for breakage of the declared functionality, it is easy to add negative scenarios.  This will eliminate the fear of irreparably breaking in unexpected places.  Are the changes ready for the demonstration? <br><br><h4>  Changes are watched by others </h4><br>  On the set of possible cookies and implementation options, this is the most technologically advanced stage.  The stage is not just called ‚Äúwatching others‚Äù - without the word ‚Äúdevelopers‚Äù.  Automation! <br><br>  To get started, the developer needs to start the process - to offer his changes to the merge into the main branch of the project.  I think it is not necessary to say that telepaths are usually away, so the messages for each change should clearly reflect their essence.  This is especially felt when you come back after a break to work on a project and discover other people's changes.  Well, if it is clear what happened on the headings in the history of GIT.  After all, after a vacation, I don‚Äôt really want, looking at the difference, to digest tons of changes to make a small correction.  In open source projects, this is more than important - here hundreds of people are already watching your story! <br><br><img src="https://habrastorage.org/files/f9e/579/d42/f9e579d420d344c2ba2ff3eff93c023b.png"><br><br>  <b>This is where the CI server comes in.</b>  We use two: <a href="http://www.jetbrains.com/teamcity/">TeamCity</a> &amp; <a href="http://jenkins-ci.org/">Jenkins</a> .  What exactly to use, we have not yet decided.  It depends mainly on the preferences setting up a new build task.  In order for the assembly to begin, as soon as the merge proposal arrives in the main repository, you will need the same glue ‚Äî one of the extensions of the Pull Request Builders family. <br><br>  For example, for Jenkins + GitHub, this is <a href="https://wiki.jenkins-ci.org/display/JENKINS/GitHub%2Bpull%2Brequest%2Bbuilder%2Bplugin">GitHub PRBP</a> . <br>  For Jenkins +, Bitbucket is a <a href="https://github.com/nishio-dens/bitbucket-pullrequest-builder-plugin">Bitbucket PRBP</a> . <br>  For Teamcity + Github, this is <a href="https://github.com/jonnyzzz/TeamCity.GitHub">TeamCity.GitHub</a> . <br><br>  The CI server will carefully collect the proposed change, run the tests and be sure to report problems in the merge proposal itself: <br><br><img src="https://habrastorage.org/files/386/d09/60b/386d0960b69c41cfae5176a0ab2ab6b7.png"><br><br>  Right here you need to configure and static code analysis.  Now you can automatically find a huge number of errors in the code!  For example, using the <a href="http://www.sonarqube.org/">SonarQube</a> .  He will be able to measure the test coverage and warn you if it suddenly drops.  Getting feedback takes minutes!  You can correct errors in the same branch from which there was a sentence: <br><br><img src="https://habrastorage.org/files/c73/1be/0fe/c731be0fe7704ccbb33d519d00ec20c0.png"><br><br>  Do not be afraid to completely overwrite the story in this thread.  GitHub, for example, will quickly update the sentence, and the CI server will re-compile it again.  In many open source projects, such a rule is separately stated. <br><br>  After successful assembly - time to inspect the code a living person.  Of course, if you are the only developer, you may have no one to ask to see your code.  In this case, it is an excellent chance to take a critical look at the changes made.  After the assembly has been completed and the code is scanned, it remains only to press one button - upload the changes to the main branch.  Responsible step.  All systems reflect who did it. <br>  With small changes, reading this section takes much more time than what it is written about. <br><br><h4>  Changes fall into the main branch of the version control system. </h4><br>  As soon as the changes hit the main branch, the time comes for integration testing.  Here it is most convenient to put the task of assembling test packets on guard.  We at our moment are updating the SNAPSHOT version in the Maven repository in our libraries.  There are already chasing heavy integration tests that test interaction with third-party components, browser tests are run, where it is required.  At this stage, it is quite possible to give the packages in manual testing. <br><br><blockquote>  What is pleasant and convenient this whole process?  He is very flexible.  All these actions are easy to spread into several cascades.  For example, you should first make a merge request to an unstable branch, carry out all the heavy testing activities in it, and after them send a merge request to the main branch, within which you can assemble a package for sending to combat servers.  And accept the request to merge only after a successful calculation.  Or vice versa - all-all testing is carried out within one request, working and reassembling packages on the go, sending changes already ready for display to the main branch.  It depends on the specific situation and ingrained habits of the team. </blockquote><br><br>  As soon as a sufficient number of changes have accumulated in the main branch, with which all participants are satisfied to the extent necessary, the time for release comes.  Usually this is another task for the assembly with a manual call.  In GitHub, for example, use the command for HuBot for this.  It is very convenient to mark the head change with a tag at this moment.  This will allow at any time if you want to be able to build the desired version without remembering the change number. <br><br><img src="https://habrastorage.org/files/d8e/f67/8bd/d8ef678bd7ca496c84c22af0d2cb9b1d.png"><br><br>  Choosing a release version is a separate process for which even <a href="http://semver.org/">specific standards</a> exist.  For small libraries, we use two-digit notation: the youngest grows each release, the older one, with the loss of backward compatibility, resets the younger one.  For larger libraries - three-digit with the same logic. <br><br><h4>  I want it too! </h4><br>  In order to organize such a process, you do not even need to have your own CI server.  For small projects it is very convenient to use <a href="http://www.cloudbees.com/jenkins">www.cloudbees.com/jenkins</a> , which will give a full-fledged Jenkins server with a limit on the number of assemblies.  Starting to build merge offers on GitHub is quite realistic using <a href="https://buildhive.cloudbees.com/">buildhive.cloudbees.com</a> - it has no limits.  Or <a href="https://travis-ci.org/">travis-ci.org</a> , for which you need to put a small configuration file in the root of the project. <br><br>  If you have your server at hand, set up Jenkins or TeamCity on it - it's half an hour.  The default settings in these servers cover 80% of basic needs, and you just need to add the necessary extensions. <br><br>  And having set up a complete chain on a small project once - it is possible to scale a solution to neighboring projects of even larger sizes in a couple of hours from absolute zero. <br><br><h4>  We will teach! </h4><br>  If you are interested in doing such things, it is interesting to build automatically scalable systems that facilitate development, assembly, and most importantly, testing, if it is interesting to improve the quality of products used from small to large, welcome to our <a href="https://tech.yandex.ru/education/autoschool/spb-2014/">School of Development Automation</a> ! </div><p>Source: <a href="https://habr.com/ru/post/237017/">https://habr.com/ru/post/237017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../237003/index.html">Experiment with a triangular QETUO keyboard</a></li>
<li><a href="../237005/index.html">Virtualization: history and development trends</a></li>
<li><a href="../237007/index.html">Mail.ru bought VKontakte</a></li>
<li><a href="../237011/index.html">Why should we spend money on corporate style ...</a></li>
<li><a href="../237015/index.html">Stephen Wolfram has released an online version of Mathematica</a></li>
<li><a href="../237019/index.html">Tor Hidden Service as Nat Traversal Technique</a></li>
<li><a href="../237021/index.html">"Port Singapore"</a></li>
<li><a href="../237023/index.html">The creator of Minecraft Markus "Notch" Persson leaves Mojang. Farewell letter</a></li>
<li><a href="../237025/index.html">Software Freedom Day</a></li>
<li><a href="../237029/index.html">Related lists in ExtJs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>