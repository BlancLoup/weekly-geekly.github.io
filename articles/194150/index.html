<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we built a simulator: an invaluable experience</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! 

 A little less than a year ago, I was involved in the process of building a device, which is located somewhere between the simulator a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we built a simulator: an invaluable experience</h1><div class="post__text post__text-html js-mediator-article">  Hello to all! <br><br>  A little less than a year ago, I was involved in the process of building a device, which is located somewhere between the simulator and the professional simulator.  This was not the first experience - in 2009 we had already solved such a task, therefore, starting the realization of a very ambitious dream, we tried not to step on all the possible rakes.  Here I will describe the background with the "first pancake", and how it affected the second.  If it is interesting, I will write in detail about our second simulator. <br><br>  Fasting in ‚ÄúDIY‚Äù because none of us had any experience in building airplanes or professional simulators before.  Moreover, as it turned out later, the approaches to the design of a low-budget aircraft simulator are radically different from the approaches in the professional field.  In general, both the first and second simulator were built by amateurs, albeit with a technical background. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Beware</b> , a lot of pictures, causing a nervous tic in aviation enthusiasts and engineers. <br>  So‚Ä¶ <br><img src="https://habrastorage.org/storage3/299/6b6/4b6/2996b64b6c1032e8a2acdc720709a7a6.jpg"><br><a name="habracut"></a><br><h4>  Prehistory </h4><br>  In July 2009, one of my friends called and said that a businessman in Moscow is building a Boeing 737-800 airplane simulator for himself, and that he doesn‚Äôt have everything, and say if I would like to participate in the project.  I wanted, came to this businessman, was stunned, and immediately joined the work. <br><br>  I must say that as a result, the simulator was built, perhaps, the most expensive and with the maximum number of rakes.  This was due to the lack of experience with us, to a very large extent - with the extreme underdevelopment of the market for low-cost flight simulators and their components, and, most importantly, we did not plan.  It was a pure laboratory, knee and impromptu: we were extremely limited in time. <br><br>  As a result, somehow, our gizmo came to life, appeared on MAKS, and we began to roll everyone on it. <br><br>  Soon after the construction of the Boeing was completed, I left the company and returned to it in the summer of 2012.  I was called back, because that wonderful businessman decided to build a second simulator.  This time they became the Airbus A320. <br><br>  This time we decided to approach the issue more proactively: a joint decision was made to spend time and energy for planning.  In addition, I insisted on first appearing papers and pictures, and only then were purchases of numerous components. <br><br>  Of course, one of the main tasks was to reduce the total cost of ownership, and for this we needed to analyze and think about the rake, which we stepped on with Boeing. <br><br><h4>  Rake </h4><br>  For a start, I decided to analyze the rake.  In the end, these very rakes at the design and construction stage led to unexpected downtime for the simulator, which resulted in very tangible financial and image losses for the company.  It was necessary not to try them in the second round. <br><br><h5>  Lack of IT infrastructure </h5><br>  In fact, when the Boeing came into being, it was supposed that ‚Äúeverything will work by itself‚Äù.  There were only three suppliers: a cabin with all the electronics, a mobile platform and a video system.  Soft (Project Magenta if it says something to someone) was supplied by the cab supplier, respectively, and the infrastructure was "given to us from above."  As operation showed, it was necessary to at least correctly scatter components on computers, but even this was not done. <br><br>  In the future, the constant changes (which I will discuss separately) led to the fact that the system healed with its own life.  Every time a failure or failure occurred, it was necessary to untangle a node from a multitude of components in order to eventually discover that one of them stopped working if the log file reached a certain size. <br>  There was no question of any regular backup, control of component versions and speech. <br><br>  As for performance, as the installation of new scenarios, the performance of the simulator fell very significantly, which resulted in the replacement of MSFS with X-Plane.  Why exactly this election was made - I do not know, I did not take part in it, but the fact remains. <br><br>  Even after replacing the monolithic MSFS with a scalable X-Plane, the performance of the graphics subsystem was not calculated, with the result that the hardware of these servers was upgraded twice. <br><br>  From this disaster, I concluded that it is just necessary to draw the architecture of the entire simulator, paint which component will work on which computer, provide for possible extensions, paint hardware performance requirements, estimate network load and make a small margin for further development.  Ultimately, the purpose of the simulator is not the constant development of new technologies, but smiles on customers' faces. <br><br><h5>  Constant changes and multivendor </h5><br>  Oh, it's just a holiday. <br>  While MSFS was used as a simulator, everything was more or less stable: put a curve to the curve ‚Äî get the simulator out of the way.  Simply and without frills. <br><br>  When we switched to X-Plane and scaled the system by installing four copies (one considers the dynamics, and each draws his own picture on his projector), it turned out that it is much more difficult to extend the same script to four copies without errors.  Especially when you consider that one of them works under Windows, and three - under Linux.  Errors and problems began, the flight of scenarios on one of the projectors (the most unpleasant).  At some point, the control over the scenarios was completely lost, and a willful decision was made to completely synchronize all installations with one.  This made it possible to almost completely get rid of the problems with the visualizer, but the root of the problem remained - we have four different installations of simulators, three of which form an image on one screen. <br><br>  Sometimes iron (controllers) failed.  Instead of reconciling and buying the same thing, controllers from other manufacturers were bought.  As a result, after three years, as many as 5 vendors stood in Boeing, and each of them had their own interface software with their own features.  Of course, it works together, but in the case of some unknown problems, the diagnosis turns into a living hell. <br><br>  Again, new controllers are new cables on board, and at some point we came to the realization that we no longer know what the wire is, where it goes and what it is for.  I had to stop the work of the simulator for several days, and to do almost complete re-wiring. <br><br>  From these rakes, I concluded that the simulator should be built, if not for ages, then at least for years.  It is necessary to assess in advance the directions of possible development, fix them and build a system based on these directions.  If at some point there is a desire to improve something in another direction - well, well, something will have to be abandoned in favor of operational reliability. <br><br><h5>  Exploitation </h5><br>  The operation of the simulator was not like that at all. <br><br>  There were no operating instructions, no restrictions on changes, a backup plan, routine maintenance, and there wasn‚Äôt much else. <br><br>  Different hands climbed into the same simulator, changed settings, quickly checked and left, and the next morning the simulator did not start. <br><br>  The lamps in the projectors burned out at the most inopportune moment, and the spare ones were in the store somewhere in Vidnoe, and on Friday evening our courier rushed through all Moscow in order to buy the last lamp in Moscow (except for jokes). <br><br>  The oil in the cylinders of the drives of the movable platform imperceptibly flowed out, and we found that it only flows when a puddle has formed on the floor.  And, of course, this brand of oil was not to buy. <br><br>  Summarizing: the simulator worked, but was not exploited.  Breaking - fix.  Do not break - fly. <br><br>  In the new project it was very important to foresee and describe the operation process: what kind of spare parts and accessories we need, how often we make diagnostics, what we do if this and that breaks, what updates we install and how, how we test them, how often do we make backups, etc.  Looking ahead to say that this approach helped a lot.  It turned out that if you agree on at least regular backups and don‚Äôt make changes when you hit, the system lives much longer and better. <br><br><h5>  Electrical problems </h5><br>  It would seem that in such a technically complex device electrical problems should not take up much space. <br>  But no!  When I first joined Boeing, spontaneous shutdowns of the controllers appeared, which we could not diagnose for a long time.  At some point, I figured out how to measure the potential difference between the ‚Äúground‚Äù of USB controllers and the computer in which this connector was plugged in: there were many, too many for the controllers, and for the USB hubs on the motherboards of the computers.  It turned out that in some unknown way our suppliers managed to unleash the ‚Äúlands‚Äù of the booths and racks with computers.  Power supply was made from one point, with the correct layout of the "earth" and neutral - the number of rolls off has sharply decreased. <br>  Another time, we had one of the phases knocked out, and an autopsy revealed that there was no load balancing.  After that, I analyzed the power supply circuit of all components of the simulator and redid it, the problem is gone. <br><br>  The conclusion was the need for the power supply scheme with the calculation and balancing of loads, their distribution among bespereboynikam, and, of course, with protection from short-circuit and from electric shock.  At first - on paper, with checks ‚Äúwhat will happen if this posting breaks off‚Äù, with the calculation of the cross-sections of wires, nominal values ‚Äã‚Äãof automata and the like electrical things.  And only after the scheme has not changed - the purchase of components and the assembly of an electrical panel. <br><br><h5>  USB </h5><br>  We never exactly considered how many bulbs and buttons are in the cabin, but the number of I / O controllers exceeds a dozen and a half.  And each of them ends in USB, and it should turn on in the computer. <br>  I have already written about the problems with the lack of a common ‚Äúground‚Äù, we have successfully solved it, but when there are three bundles of cables on three different computers, there are no problems to avoid. <br>  We tried several different USB extenders, tried to install hubs from different manufacturers, tried to assemble all devices on one computer, in general, tried a lot of things, but the problem with the USB device ‚Äúfalling off‚Äù at the most inopportune moment even though this day. <br><br>  The obvious conclusion was the rejection of the use of USB, but as I said, in our enlightened age, the market for low-budget simulators (i.e., those that individuals up to $ 50k can afford) is extremely underdeveloped, and USB reigns there.  Moreover, none of the suppliers of components have in mind that the cabin can move - almost all (with the exception of units) of such simulators here - are fixed.  We built the simulator on a mobile platform, and hence the need for long cables, and problems with vibration. <br><br>  Well, well, if so, then there is no getting away from it, which means you need to make the cables as short as possible, do not drag the USB through extension cables 10 meters, and put the computers on board.  Looking ahead: this meant that diskless computers should be on board.  This is a separate beautiful task, which I will discuss in one of the following parts. <br><br><h5>  Mechanical problems </h5><br>  Mobility + people in the cockpit = various problems with the mechanics. <br>  From vibration unscrew the threaded connections, self-tapping screws fall out, over time the plastic begins to crumble. <br>  Our clients are not professional pilots, but ordinary people, sometimes not even very enthusiastic about aviation.  They do not know what to do and what not to do. <br>  An ordinary average man in the prime of his life may unknowingly tear the handle off a real aviation instrument, and not even notice it.  However, according to the stories of our engineering friends from the ‚Äúadult‚Äù training centers, real pilots sometimes do the same. <br><br>  In the new simulator, we won this percent rake by 95%: all cables must be fixed, all threaded connections are locked.  No screws.  Screed, screed, screed.  The remaining 5 percent is still our customers.  Alas, here - only a gentle, but persistent word.  This I attribute to the organizational conclusions. <br><br><h4>  findings </h4><br>  Plan, design, write, think, analyze. <br>  "From the sheet" you can probably make a scooter for a couple of evenings, but the meat grinder is no longer there.  A flight simulator - and even more so. <br>  Analysis of past failures played an important, if not decisive role.  It was thanks to the systematization of the ‚Äúlearned lessons‚Äù that the need to think and draw, and then to do, became obvious. <br><br>  Of course, having avoided parts of the old rake, we found new, but semi-annual experience showed that the operational reliability of the new simulator is much higher.  Much less forced downtime, failures and failures.  There are much more happy customers, and this is precisely the goal. <br><br>  In the following posts, I will describe the process of building the A320 in detail. <br><br><h4>  Update </h4><br>  I found photos from the construction of Boeing, spread. <br><br>  The base of the cab with hand wheels.  Originally used computer power supply, which turned out to be a great evil.  Now MeanWell <br><img src="https://habrastorage.org/storage3/e90/d59/ae6/e90d59ae6b5728a393ff71a782f26ff0.jpg"><br><br>  Arrived movable platform from Italy.  The mass of the most mobile platform is about 800 kg, the control cabinet is another 800. <br><img src="https://habrastorage.org/storage3/07a/3a7/6a4/07a3a76a47877bb35b47750556266432.jpg"><br><br>  We had the opportunity to use a loader (with Airbas - no longer, there was no room).  On the left - the first version of the rack with servers.  On the right - metal structures, on which the projection screen will be stretched. <br><img src="https://habrastorage.org/storage3/29a/6bb/076/29a6bb0768824e7029651d55ea01e3cf.jpg"><br><br>  Cockpit assembly.  MIP (Main instrument panel) is almost assembled. <br><img src="https://habrastorage.org/storage3/eb5/4b5/5f5/eb54b55f59998390a89c3307c56121d3.jpg"><br><br>  Cockpit with base and frame. <br><img src="https://habrastorage.org/storage3/3c0/4d8/caa/3c04d8caa3dc7176be7a0830d05aa651.jpg"><br><br>  View through the windows on the open ceiling panel.  Subsequently, it became clear that the chosen method of laying cables was incorrect. <br><img src="https://habrastorage.org/storage3/b62/09f/66e/b6209f66e391bb21c1f5dc7fc3f7b177.jpg"><br><br>  Our Canadian experts configure the interface software - a layer between FSUIPC and controllers.  Each button, toggle-lamp-indicator "tied" to the variable FSUIPC.  Once we lost this configuration - it was fun. <br><img src="https://habrastorage.org/storage3/a41/cff/4b5/a41cff4b5927e444cf8338d3e98ddb75.jpg"><br><br>  Start the assembly of the base on which the ladder will ride. <br><img src="https://habrastorage.org/storage3/cd7/a38/f49/cd7a38f491595111656746139e15f08d.jpg"><br><br>  Cab, platform, platform control cabinet.  The ‚Äúheart‚Äù of the control cabinet is Siemens PLC.  Drive drivers - Baumuller.  Drivers with engines deserve a separate article.  For example, the driver inside considers the temperature of the motor windings depending on the load on the motor.  In addition, there are several temperature sensors in the winding, which, of course, are also connected to the controller.  That, however, does not prevent him from issuing an alarm signal and stopping all mobility, if the calculated temperature has jumped out of the permissible limit.  A calculation is based on the unique parameters of the engine, which are removed in the process of testing at the factory.  When we faced this difficulty (with an estimated temperature), we had to get in touch with the plant. <br><img src="https://habrastorage.org/storage3/d15/25b/923/d1525b923e5915226b2279374fff5a21.jpg"><br><br>  Platform control cabinet and rack with servers as they were 4 years ago. <br><img src="https://habrastorage.org/storage3/4a3/34a/342/4a334a3427a1de5c687d110480283323.jpg"><br><br>  And now - rrraz, and we loader hoisted the cabin on the platform. <br><img src="https://habrastorage.org/storage3/a5b/9d0/7c6/a5b9d07c614891ef662c554e01d471af.jpg"><br><br>  ORE block (engine controls, Throttle Quadrant in English).  Actually, the reason for my appearance in the project.  It did not work at all.  The block is made of a real block from a Boeing 737-300 by a German craftsman.  Unfortunately, the craftsman threw out most of the Kondovoy Boeing mechanics, and replaced it with ridiculous rods, and in some places (no joke) with a lighter cap.  A screw terminal decided to pour solder.  Used controllers - Phidgets.  There are 6 of them in one unit. <br><img src="https://habrastorage.org/storage3/b39/54f/dd7/b3954fdd7e095ff38896cd1dae5cddf7.jpg"><br><br>  If I remember correctly, here we are trying to figure out how food is distributed (there are two of them - 12 and 5) inside the unit.  This power is used to drive the motors (from the wipers) that emulate the operation of the traction machine when the handles are driven ‚Äúby themselves‚Äù. <br><img src="https://habrastorage.org/storage3/978/34b/c46/97834bc46068a71e7cd386ef84e32532.jpg"><br><br>  View of the base of the cabin.  Pay attention to the number of USB extenders.  These were the first, after them were more, and more, and more.  Cables are not fixed, this was one of the reasons for the extension of the extension cords. <br><img src="https://habrastorage.org/storage3/ad4/884/f3b/ad4884f3beddec683121ae90777874e2.jpg"><br><br>  We pulled the projection screen and reduce the image.  TrippleHead2Go was used as an image divider, and Sol7 was used as a software for curving the image under a cylindrical screen. <br><img src="https://habrastorage.org/storage3/c3a/8f5/b46/c3a8f5b46acc1ce2f0a800575dcdbc76.jpg"><br><br>  One of the working moments.  If memory serves, we swore on the topic of how to make OREs move properly. <br><img src="https://habrastorage.org/storage3/999/94e/8f7/99994e8f7a6e1348dd3785761fa7b745.jpg"><br><br>  Running in <br><img src="https://habrastorage.org/storage3/d9c/581/95d/d9c58195d7e3c84f7d0d96124705270e.jpg"><br><br>  The final view of the cockpit in 2009. <br><img src="https://habrastorage.org/storage3/eaf/3bb/bc8/eaf3bbbc8b925b3184533d6a8b06a4e9.jpg"><br><br>  View outside during operation of the mobile platform. <br><img src="https://habrastorage.org/storage3/ed1/69e/1d2/ed169e1d2d77dd427ab82e625d0bf12b.jpg"><br><br><h4>  Update # 2 </h4><br><br>  Right now the Boeing from this post looks like this: <br><img src="https://habrastorage.org/storage3/562/a1a/e5d/562a1ae5d41db18380e89c74761b7cd0.jpg"><br>  and so <br><img src="https://habrastorage.org/storage3/1d2/45e/802/1d245e8023713f8d8cd43615eddd3165.jpg"><br>  so: <br><img src="https://habrastorage.org/storage3/43e/155/34c/43e15534c4d7dcb2d1a21a6501f4c772.jpg"><br><br>  All this is called the word "overhaul." <br><br>  If someone has time and itching to pick our dusty trainer tomorrow and Friday, write to me in PM. </div><p>Source: <a href="https://habr.com/ru/post/194150/">https://habr.com/ru/post/194150/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../194128/index.html">Daisy, Daisy ...</a></li>
<li><a href="../194130/index.html">The widget becomes a new elementary part of the Internet.</a></li>
<li><a href="../194132/index.html">New WebStorm 7: everything you need to hand</a></li>
<li><a href="../194136/index.html">Riddles of Da'Vinci: Renaissance. 1 million rubles for the summer</a></li>
<li><a href="../194142/index.html">Database connection pools - why and why</a></li>
<li><a href="../194154/index.html">D-Link IP Security Hole? No, this is ‚ÄúFeature‚Äù!</a></li>
<li><a href="../194160/index.html">UNIX early history</a></li>
<li><a href="../194162/index.html">Free Month at CodeSchool by NewRelic</a></li>
<li><a href="../194166/index.html">Subsoil payphone</a></li>
<li><a href="../194168/index.html">OpenZFS: a truly open source ZFS successor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>