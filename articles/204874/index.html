<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How does roaming work - international, national, emergency</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The behavior of the phone in roaming sometimes seems unclear and predictable, for example, in terms of network selection. 

 Let's try to figure out f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How does roaming work - international, national, emergency</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3a6/010/009/3a6010009919ca21544908a2e2de5149.jpg" alt="The first transatlantic bell (January 7, 1927)"><br><br>  The behavior of the phone in roaming sometimes seems unclear and predictable, for example, in terms of network selection. <br><br>  <b>Let's try to figure out from a technical point of view some issues:</b> <br><ul><li>  What is the phone guide when choosing a network when roaming? </li><li>  How do black lists of networks work? </li><li>  Is it possible to influence the choice of a network in roaming? </li><li>  What is roaming management? </li><li>  When and why can you be roaming without even leaving Russia? </li><li>  How does Emergency Inter-Roaming (AMR) work? </li></ul><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First of all, the following applies not only to phones, but to all GSM-UMTS-LTE mobile terminals ‚Äî tablets, modems, routers, and so on.  To understand the process, it is important that there is a transceiver at each base station that constantly transmits radio signals containing ‚Äúsystem information‚Äù.  The system information is grouped into system messages (in the GSM network) or system blocks (in the UMTS and LTE networks) that carry the information necessary for mobile stations to navigate the situation and make decisions for performing certain actions when accessing services and work in a mobile network. <br><br>  <b>In particular, the system information contains parameters:</b> <br><ul><li>  The country code and network (MCC and MNC - Mobile Country Code and Mobile Network Code), which determine the identity of a specific base station transceiver in the network of a particular operator. </li><li>  Received signal levels at which access to a specific BS is allowed. </li><li>  Output power levels that mobile phones can use at the start of a communication session. </li><li>  Location Area Code (LAC) is a zone identifier (group of base stations) within the network that are allocated to register the location of mobile devices and distribute signaling traffic. </li><li>  Cell ID - the identifier of a specific radio transmitter serving the sector ("cell"). </li><li>  In the context of packet information transfer, identifiers are transmitted: </li><li>  Routing Area ID - identifier of the service area in the packet information network. </li><li>  Tracking Area ID (TAC) is a kind of analogue of LAC and RAC for LTE network. </li></ul>  and other necessary telephone information. <br><br>  Further, for simplicity, we will assume that this all works both on base stations and on the phone, providing the necessary information to higher levels of software on the phone. <br><br><h4>  Turn on the phone and ... </h4><br>  So, arriving in another country, we turn on the phone to access mobile services. <br><br>  After switching on to get access to mobile phone services, you need to complete a number of tasks.  To speed up access to services, some tasks are performed in parallel, but there are several key procedures that must be performed. <br><br><h4>  And what networks work in the district? </h4><br>  It is obvious that in order to access the telephone services, it is necessary to establish a communication channel from one of the base stations.  To do this, the phone must search for base station signals for all radio access technologies it supports and in all supported frequency bands.  It is clear that this task is quite long, which can cause not the most pleasant emotions for the user, especially for the models with the greatest capabilities in the supported radio access technologies and frequency ranges.  Therefore, standards allow manufacturers to optimize this process. <br><br>  As a result of the search, the phone for each supported radio access technology should compile a list of detected BS signals, from the signals of which it extracts the information necessary to decide on further actions when choosing a network: <br><ul><li>  Network Code (MCC + MNC). </li><li>  LAC, CellID. </li><li>  Received signal level in order to select the communication channel with the best conditions </li><li>  Information on restrictions in access to the cell, imposed by the operator, etc. </li></ul><br><h4>  Golden Key to the network services </h4><br>  In order to provide access to mobile services, the operator needs to make sure that the subscriber can provide these services - he has a subscription to these services.  The key to accessing services is a (U) SIM card.  Therefore, immediately after powering on the mobile terminal and establishing operating voltages for its nodes, the initialization procedure of the (U) SIM card begins, during which the phone searches for files and tries to read from them the information necessary to make a decision on choosing a network and then registering with the selected network. <br><br><h4>  6F7B - EF fplmn (Forbidden PLMN) - the list of "forbidden" networks </h4><br>  This is a small file for recording MCC + MNC codes for four networks organized in the order of "queue" (FIFO).  In the manufacture of (U) SIM-card, this file has no entries (in all fields recorded value FF).  When the phone gets a refusal with the reason code # 11 PLMN not allowed when trying to register in a ‚Äúforeign‚Äù network, the MCC + MNC code of this network is written to this file.  Then, when choosing a network for automatic registration, the terminal no longer makes any attempts to automatically register with networks whose codes are present in this file at this moment. <br><br>  If the user manually selects the network whose code is contained in this file, the phone will try to register on this network, despite the fact that the network code is in the list of "forbidden". <br><br>  If the registration is successful, the phone will remove the code of this network from the list of "prohibited" (fill the place with the FF value).  If manual registration is denied, everything will remain unchanged. <br><br><h4>  6F30 - EF plmnsel (PLMN selector) </h4><br>  This is one of the oldest files that affect network roaming selection.  It contains network codes (at least 8 MCC + MNC codes) in order of priority of their choice in roaming.  This list can be created both by the user through the phone interface and by the operator, and not only in the manufacture of the (U) SIM card, but also later, by downloading information ‚Äúby air‚Äù. <br><br>  In the course of further development of standards and technologies, several more files appeared in which the influence of the user and the operator were already separated, but information about radio access technologies available in each of the networks was added to the files. <br><br><h4>  6F60, 6F61, 6F62 </h4><br>  <b>6F60 - EF plmnwact (User controlled HPLMN Selector with Access Technology)</b> <b><br></b>  <b>6F61 - EF oplmnwact (Operator controlled PLMN Selector with Access Technology)</b> <b><br></b>  <b>6F62 - EF hplmnwact (HPLMN Selector with Access Technology)</b> <br>  These three files have the same structure.  They may contain a code list (MCC + MNC) for at least 8 networks, but with additional information about radio access technologies supported by each of the networks (GSM, GSM-Compact, UTRAN, E-UTRAN, cdma2000 HRPD, cdma20001xRTT). <br><br>  The 6F60 file can be filled by the user, usually via the phone interface, if the phone manufacturer provides such an interface. <br><br>  The contents of the 6F61 file are controlled by the operator who issued the (U) SIM card, both when ordering a batch of (U) SIM cards, and subsequently, when he can change the list, transferring the new contents of the file ‚Äúover the air‚Äù. <br><br><h4>  6F31 - EF hpplmn (Higher Priority PLMN Search Period) </h4><br>  This is a short file containing a number that defines the length of the interval, after which the phone should try to search for a network with a higher priority (home, etc.). <br><br><h4>  So what does the phone choose? </h4><br>  So, the moment comes when the included phone after (U) initialization of the SIM card, finished reading the files necessary for making a decision on network selection, and as a result of the search, found signals from the base stations of mobile networks, and collected the system information transmitted by them.  How does the decision about the automatic selection of the network? <br><br>  3GPP-ETSI TS 23.122 automatically instructs the phone to select the network (PLMN) with the highest priority of those networks that are available and not prohibited.  "Forbidden" network phone checks in the file 6F7B - EF fplmn (Forbidden PLMN). <br><br>  But what is the highest priority?  A mobile phone sequentially searches and tries to register in networks using different technologies in the following order: <br><ol><li>  The Home Network (HPLMN - Home Public Mobile Network), or equivalent, has the highest priority. </li><li>  Each of the networks and the radio access technologies it supports in order of priority from a 6F60 file - EF plmnwact (User controlled HPLMN Selector with Access Technology). </li><li>  Each of the networks and the radio access technologies it supports in order of priority from the file 6F61 - EF oplmnwact (Operator controlled PLMN Selector with Access Technology).  If there are no files in the SIM card installed in the phone that contain information about radio access technologies supported in the listed networks, then the phone should use the list of networks from the 6F30 file - EF plmnsel (PLMN selector) and all supported radio access technologies. </li><li>  Randomly selected network and radio access technology from those whose signals are received with high quality. </li><li>  Other networks and radio access technologies in descending order of signal quality. </li></ol><br><br><h4>  Which mode of network selection, automatic or manual, is better to use in international roaming? </h4><br>  First of all, it should be remembered that the phone will start working in the network selection mode (automatic or manual), in which it was at the time of power off.  It seems trivial, but if the phone is automatically automatically inserted into the pocket immediately after switching on, and the network was manually selected for some reasons at home (because other networks were not allowed to come to you anyway!), The network will not automatically select the phone when roaming, and the subscriber can stay in touch indefinitely! <br><br>  In addition, you need to understand that when using the phone while roaming in the manual mode of network selection and subsequently there are chances to remain without communication, if you find yourself in places where the coverage of the selected operator disappears - the phone will wait for the owner‚Äôs decision about choosing a network from others available in this place.  Therefore, it is useful to either manually select one of the local networks and wait for the successful registration, or switch the phone to the automatic network selection mode and make sure that it is registered in one of the local networks. <br><br><h4>  How the operator can influence the automatic selection by the phone of networks in roaming </h4><br>  The recommendations of the operator who issued the (U) SIM card are written to the file 6F61 - EF oplmnwact (Operator controlled PLMN Selector with Access Technology) and / or 6F30 - EF plmnsel (PLMN selector). <br><br>  Many operators are part of a group of companies providing mobile services in several countries.  Naturally, in such cases, operators are interested in that subscribers receive roaming services in the networks of partners.  And the point here is often not so much in the desire to receive additional income due to higher prices, but in the desire to leave income within a group of companies.  Therefore, many operators implement roaming management systems (Steering of Roaming).  Many people, having turned on the phone upon arrival in the country, found a welcome text message from the operator, which contained practical recommendations on the use of voice mail, etc. <br><br>  It appears because at the time of registering in roaming the ‚Äúhome‚Äù operator receives a request from the ‚Äúvisiting‚Äù network for information that is necessary to provide services to the subscriber, which means that the ‚Äúhome‚Äù operator finds out which country its subscriber is located.  Having such information, you can send a subscriber a ‚ÄúSMS-ku‚Äù of a special format that will not be displayed to the user, but will be ‚Äúdownloaded‚Äù by the phone to a (U) SIM card, where it will update the contents of the desired file.  Using this mechanism, the operator prompts the phone to prioritize the automatic selection of networks in roaming. <br><br><h4>  How the user can influence the automatic selection of his phone networks in roaming </h4><br>  Since it was already noted that in international roaming, in order not to remain without a connection, it is better to use automatic network selection, but you do not want to rely on the operator, the question arises as to how the subscriber can influence network selection in automatic mode. <br><br>  First of all, it is useful to get acquainted in advance with the list of operators providing services in the visited country (or countries) and tariffs for their services.  Based on this information, you can create your own list of priorities for choosing networks in the host country.  In the phone menu in the settings section, you need to find the network settings and the list of priority networks.  Since this interface is not governed by standards, the name and location of this menu item may be different in different models, and in some models this item may be completely absent!  If the item is found, then the list of networks that may be present there should be edited in accordance with the chosen preferences. <br><br><h4>  Why are only 2G or 3G networks listed in the list of preferred networks? </h4><br>  No need to be embarrassed if only one radio access technology is listed for a particular network, although it is known that the operator uses several technologies - GSM, UMTS, LTE.  After the phone detects the necessary network and gets access to it, it will be able from the system information transmitted by the BS to learn about network support and other technologies in order to then choose the one that is optimal in terms of radio conditions. <br><br>  It is also worth noting that it is better to do manual adjustment of the list of priorities for selecting networks already being in the country, after the operator could correct the list of preferences according to his own understanding.  Or, at a minimum, check that the prioritization setting made before has not changed.  This is especially true for those cases where both the operator and the user use the same 6F30 file - EF plmnsel (PLMN selector) for managing priorities. <br><br><h4>  Should I buy a local operator's SIM card for the holidays? </h4><br>  Everyone can solve this issue based on their interests, needs and preferences.  Recently, Russian operators have significantly reduced the prices of roaming services, or have begun to offer special options or packages that optimize the cost of communication in roaming.  Of course, if there is a lot of communication with the owners of local numbers, the use of a local operator's SIM can be really more profitable.  However, you can be inaccessible for incoming calls from the homeland - after all, not everyone knows the phone number assigned to the local SIM card, and it is not always convenient to force people to make international calls.  In general, this question is solved individually, based on specific conditions. <br><br><h4>  Emergency Internet Roaming (AMR) </h4><br>  This concept appeared several years ago, and even now is not very well known to a wide audience. <br><br>  The fact is that the Russian regulatory framework does not allow roaming services to be provided to subscribers of another operator that has licenses in the same territory (republic, territory, region).  That is why the files with the lists of "forbidden" networks (6F7B) in (U) SIM cards of Russian users usually contain the codes of all the "alien" networks operating where the subscribers live.  After all, BS operators are placed at different points, and almost always you can find a place (elevator, basement, middle of a large reinforced concrete building, etc.), where the phone for some time loses the ‚Äúhome‚Äù network, and at the same time detects the network of another operator.  For the first time in such a situation, the phone will try to access services on the network of this operator.  Due to a roaming ban, the phone usually receives a denial of service with the reason code # 11 PLMN not allowed, and the code of this network is put on the list of ‚Äúprohibited‚Äù on the (U) SIM card in order to prevent repeated attempts of automatic registration to the ‚Äúalien‚Äù network. <br><br>  But in cases of natural disasters (for example, the recent flooding in the <a href="http://habrahabr.ru/company/beeline/blog/200784/">Far East</a> ), serious accidents in the networks of operators (for example, when a meteorite falls in the Chelyabinsk region), a very large number of citizens are left without communication.  They cannot call for help, such as a doctor, tell their relatives about their whereabouts or find out about their condition.  In cases of such serious disasters, it is customary to help the victims of the ‚Äúwhole world‚Äù.  For such cases, on the initiative of the regulator (Ministry of Communications) or at the request of the affected operator, the inclusion of Emergency Inter-Network Roaming in the area covered by an emergency may be allowed.  In this case, subscribers get the opportunity to use the services of any of the operators whose network is available at a particular moment.  Unlike emergency calls (to number 112), with AMR enabled, you can call not only the Emergencies Ministry, but also contact relatives and friends by their usual phone numbers ‚Äî mobile or wired, if they work. <br><br>  In such difficult situations it is important for subscribers not to get confused and know what needs to be done in order to use the networks of other operators in an emergency situation, because without special actions by the user, their phones will not be registered in the networks of other operators in order to be available for incoming communication. <br><br>  If the phone has lost contact with the network of the home operator due to the failure of network equipment, the phone will automatically find the signal from one of the remaining base stations of the other operator, and will be in the Limited Service state, waiting for the owner‚Äôs command to call the emergency call ( 112).  In this case, you can simply try to call the desired number.  If AMR is enabled, the ‚Äúforeign‚Äù network must provide a connection. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the phone continues to receive signals from the base stations of the "home" network, but the network does not allow you to call, then you need to manually search for available networks and select one of the "alien" networks detected by the phone. </font><font style="vertical-align: inherit;">If the ‚Äúalien‚Äù network provides access, then AMR is on, and such a subscriber will be able to make outgoing calls and receive incoming calls. </font><font style="vertical-align: inherit;">If the network denies access, then you should try to repeat the manual selection of other networks detected by the phone until it registers with one of the networks. </font><font style="vertical-align: inherit;">If none of the ‚Äúforeign‚Äù networks has completed registration, then this means that AMR is not included in this place, and only the Emergency Call service can be used in the ‚Äúforeign‚Äù networks.</font></font></div><p>Source: <a href="https://habr.com/ru/post/204874/">https://habr.com/ru/post/204874/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../204862/index.html">YotaPhone Review: The world's first dual-screen smartphone</a></li>
<li><a href="../204864/index.html">The programmer is trying to sell</a></li>
<li><a href="../204868/index.html">Chromebook in Russia</a></li>
<li><a href="../204870/index.html">Crowdfunding, freedom and cinema</a></li>
<li><a href="../204872/index.html">Next year, a new USB interface will appear, and it can be inserted by either side.</a></li>
<li><a href="../204876/index.html">Launch iframe application in Vkontakte</a></li>
<li><a href="../204878/index.html">Using Backload for Downloadable Files in ASP.NET MVC</a></li>
<li><a href="../204886/index.html">Yandex conducts an experiment on encrypting the request text in the Referer header</a></li>
<li><a href="../204894/index.html">Beeline + Apple = L ...</a></li>
<li><a href="../204896/index.html">KM in games</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>