<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sinusoidal modeling and typographical errors in Caltech</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This post is about a relatively new method of signal processing, described in the article Adaptive data analysis via sparse time-frequency representat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sinusoidal modeling and typographical errors in Caltech</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/405/99f/177/40599f177f04c569a50697db229d4cad.png"><br><br>  This post is about a relatively new method of signal processing, described in the article <a href="http://users.cms.caltech.edu/~hou/papers/AADA_paper.pdf">Adaptive data analysis via sparse time-frequency representation</a> , as well as about a tiny, but confusing me personally, error.  This article was published in 2011 by Professor of Applied Mathematics at the California Institute of Technology, Thomas I. Hou and Shi Zoqiang, and, probably, by the time you read it, they had already corrected it. <br>  I stumbled upon this article in the search for various methods of time-frequency analysis of nonlinear and non-stationary signals - in my case, ultrasound signals from moving formed blood elements in human vessels.  The essence of this analysis is to track changes in the signal characteristics, in other words, we want to know the dependence of the frequency components of the signal on time.  With the exception of the widely used methods - spectral and wavelet analysis, such methods as EMD (empirical mode decomposition) and sinusoidal modeling were found, which will be discussed further here. <br>  The empirical mode method is fairly simple to use, but is not particularly developed in terms of the validity of the results obtained.  Thomas Hou and Shi Zoqiang went further in the development of the mathematical apparatus and proposed their own method of sinusoidal signal modeling.  His idea is sparse decomposition of a harmonic signal with smooth amplitudes.  What result we expect to get - in the picture above.  In this case, the signal received by the function f (t) = 6t + cos (8œÄt) + 0.5 cos (40œÄt) was decomposed.  The decomposition of the signal, of course, is not unique; therefore, the criterion of the minimum harmonic components was introduced, and the problem was formed as follows: <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f3/bb2/473/0f3bb24738134d9b0b10819830f47708.png"></div><br>  The solution of the P0 problem will be harmonics with amplitudes a and phase theta functions, whose derivatives will correspond to the signal frequencies.  The authors propose to solve this problem recursively: extract one harmonic component, get the remainder (median) - work with it, extract the next harmonic from it, get the remainder, and so on.  Since the median should be much smoother than the signal, finding the harmonic boils down to solving the following problem: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dc4/1c2/ade/dc41c2adefa115dc08f9be8a365c6e62.png"></div><br>  where a1 * cos (theta1 (t)) is the resulting harmonic, a0 is the median.  The smoothness of the amplitude is determined by the total variation: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/678/328/710/6783287103d6971fb1c5f5dc57837abc.png"></div><br>  The greater the smoothness of the function g, the closer to zero its (n + 1) derivative, the lower the total variation of the nth order, respectively.  One can say more: the smaller the order of the polynomial with which we can interpolate, the smoother the function.  It is logical to assume that it would be best to look for a minimum of zero order variation, however, in this case we risk getting a piecewise constant function (staircase effect) and losing some of the higher order information we need (for example, curvature).  The authors of the article propose to reduce the variation of the third order, directing the fourth derivatives to zero, thereby making something similar to approximation by cubic splines.  As a result, we are looking for min TV ^ 3 (a0).  But it is also important for us that a1 is sufficiently smooth, so at best we have to find min TV ^ 3 (a0) + min Œª * TV ^ 3 (a1), where Œª is the Lagrange multiplier, which in this case plays the role of the weighting factor .  For simplicity, the authors left Œª = 1 and arrived at the following problem: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52e/f88/bae/52ef88bae28861ba844556954f5e2c20.png"></div><br><h5>  Algorithm </h5><br>  To solve this problem, an iterative algorithm is proposed.  One more harmonic is added to the condition - b1 * sin (theta1 (t)), its smoothness also becomes our goal.  Initialize the phase function theta ^ 0 so that it is an increasing function that satisfies the condition cos (theta ^ 0) = f (t), and run the main iteration: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/757/d6c/184/757d6c1846f3173b68a21cf0f0e3c33f.png"></div><br>  In the first step, we minimize the total amplitude variations.  On the following - we update theta using the above formula, then check how much it has changed.  By the end of the algorithm, it is assumed that the amplitude b1 will be already negligible, respectively, the artcg (b1 / a1) will be small, and theta will converge to some value.  This will be our phase function.  Having received theta ^ n, we select the first harmonic a1 * cos (theta1 (t)), where theta1 = theta ^ n.  Then we run this algorithm on the remainder, that is, we work with the values ‚Äã‚Äãf (t) = a0 + b1 * sin (theta1 (t)).  Select the next harmonic a2 * cos (theta2 (t)), continue with the remainder.  And so on until the norm of the residue is negligible.  I took the first norm.  For those who do not remember its definition: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/125/5b0/12c/1255b012cfe8529f8450df9df80b2ed8.png"></div><br>  To apply the problem of finding the minimum of the general variation, the authors reduced to the L1-minimization problem, replacing the differential equation with the difference one.  We have a signal, or rather an ordered set of N points (nodes), which we want to expand, that is, to represent as the sum of the vectors a0, a1 * cos (theta1 (t)) and b1 * sin (theta1 (t)).  And in the reformulated problem an unfortunate typo was noticed: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/328/4c7/2e7/3284c72e761bb72f5a70059be5bcaa2f.png"></div><br>  Assuming that a0 ^ n, a1 ^ n, b1 ^ n are grid functions, we approximate their fourth derivatives by multiplying them by the matrix D ^ 4.  Then, minimizing the sum of the moduli of the obtained values, we reduce the corresponding variations.  Everything is logical and plausible, but, having implemented this algorithm, I was horrified to see the results - it turned out something completely chaotic.  Long trying to detect an error in the code, I finally realized that the error was in the article. <br>  The fact is that by multiplying Phi by x, we get a vector, where the elements are the sums of the derivatives a0 ^ n, a1 ^ n, b1 ^ n at the corresponding points.  That is, we minimize the total variation from (a0 ^ n + a1 ^ n + b1 ^ n), rather than the sum of the three variations, as indicated above. <br>  Error is an error, found, corrected and forgotten for several months.  And so, on the May holidays, I was still torn to write a letter to professors with the proposal to replace the article min || Phi * x ||  at min || D ^ 4 * a0 ^ n ||  + || D ^ 4 * a1 ^ n ||  + || D ^ 4 * b1 ^ n ||.  Surprisingly, an hour later, an answer came from Professor Hou with the phrase ‚ÄúThanks for your email.  We will study your note and get back to you soon ‚Äùand a simple‚Äú Tom ‚Äùsignature. <br><br>  After another 6 hours, a letter came from Professor Shi: <br><blockquote>  Dear Aleksandr, <br><br>  Thanks a lot for your email.  We did make a typo here. <br>  \ Phi should be diag (D4, D4, D4) <br>  algorithm.  Thanks. <br><br>  Best, <br>  Zuoqiang shi </blockquote><br>  Naturally, my amendment and what they wanted to write are identical.  The only thing I must note is that if you do not store the matrix Phi under the assumption that it is sparse, that is, to store a bunch of zero elements, the memory may soon end. <br><br><h5>  How the L1-minimization problem is solved </h5><br>  For their algorithm, professors propose the Bregman iteration and L1-regularized least square method split methods.  However, these methods are quite fresh and, probably, not all packages are sewn up.  Who is lazy (like me) to implement any of the algorithms for finding the minimum of the first norm, it will be useful for him to find out how this problem reduces to the more common linear programming problem.  The original task is as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d7e/3d8/a25/d7e3d8a2578fffc50291d582d17070e1.png"></div><br>  provided <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c58/22f/347/c5822f3471b1aee3951fec7ea2cc4fb2.png"></div><br>  where A is the NxM matrix, Phi is the KxM matrix, x is a vector of dimension M. <br><br>  It is equivalent to the following linear programming problem: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cf6/ed1/cab/cf6ed1cab7bc53921a8700e01ba513af.png"></div><br>  under conditions <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/22f/620/e8b/22f620e8b13ca02de184b81c07d80b0a.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a14/946/4a9/a149464a94272c95db04d490217c3309.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c58/22f/347/c5822f3471b1aee3951fec7ea2cc4fb2.png"></div><br>  where phi (i, j) are elements of the matrix Phi. <br><br>  Formally, the transition can be done as follows.  To the vector x is added K variables, thus it becomes the dimension of K + M: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b5c/30d/410/b5c30d4104a82e0985cdf2698736db6e.png"></div><br>  To matrix A is added a zero matrix of NxK dimension: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/968/e37/029/968e370295ef95b3eb0d4b99dfa6526d.png"></div><br>  The vector c (coefficients in the LP problem) consists of M zeros and K units: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/673/2e6/523/6732e6523cc2d6ac128ccc8e851c8338.png"></div><br>  The matrix F is composed of the matrix Phi and the unit matrix I. The dimension F - (2 * K) x (M + K): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6c/ac7/160/e6cac71603e115aa22aa07580cffcbc1.png"></div><br><br>  Thus, a formalized task looks like this: <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a8/b06/a9e/5a8b06a9e34d794366db1ef92721fa1a.png"></div><br>  under conditions <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc4/17e/5e8/fc417e5e88226fa1b9d496e67d15f998.png"></div><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/364/c92/e3b/364c92e3bf48f7e9635cd24e566ad965.png"></div><br><br><h4>  results </h4><br>  Here are the results of the algorithm for the previously mentioned example f (t) = 6t + cos (8œÄt) + 0.5 cos (40œÄt).  On the graphs, the values ‚Äã‚Äãobtained by this algorithm (blue) are compared with the analytical values ‚Äã‚Äã(red) and the values ‚Äã‚Äãobtained by decomposition into empirical modes (black). <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/82f/912/ab0/82f912ab06803b8824cc9edab608d1fc.png"></div><br>  The following example shows how this method helps to track frequency variations of a signal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/610/2dc/196/6102dc196020cfbd88bc40011b927393.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/287/7ef/bbf/2877efbbface0205aa2d694e8c86a8f0.png"></div><br>  The article contains other examples, as well as the results of the algorithm on real data. <br><br><h5>  Total </h5><br>  The algorithm is very interesting and, in my opinion, requires further analysis, the benefit of space for thought is full here.  Its obvious disadvantages are high computational complexity, as well as sensitivity to noise and, as a result, unstable operation with noisy data.  The authors propose to solve the problem of sensitivity using low-pass filtering and Fourier transform.  But more about that another time. <br>  Finally, I want to once again boast and say that, apparently, it happens that professors in Caltech make, however small, mistakes, but a Russian student, who does not have a bachelor so far, can point this out to them. </div><p>Source: <a href="https://habr.com/ru/post/221361/">https://habr.com/ru/post/221361/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221347/index.html">Configuring LDAP Authentication in InterSystems Cach√© Based on Microsoft Active Directory</a></li>
<li><a href="../221349/index.html">Mozilla released Firefox 29</a></li>
<li><a href="../221351/index.html">waSlideMenu.js. Multi-level scrolling menu</a></li>
<li><a href="../221355/index.html">APSB14-13 - New Flash Player Update</a></li>
<li><a href="../221359/index.html">Transition to ISO / IEC 27001: 2013. Subtleties of translation and not only</a></li>
<li><a href="../221365/index.html">Comparative review: Nokia X versus typical Android state employee</a></li>
<li><a href="../221367/index.html">Porting Netsukuku to Vala Completed</a></li>
<li><a href="../221373/index.html">"Performance" and "Live" - ‚Äã‚Äãinnovations in the statistics of Openstat</a></li>
<li><a href="../221375/index.html">User is drunk</a></li>
<li><a href="../221377/index.html">[Translation] Investigation of manipulations with the control panel. Part 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>