<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating Clustered Storage Spaces in Windows Server 2012</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 

 Today I would like to talk a little about a new feature in Windows Server 2012 - Storage Spaces or Data Spaces. 

 In essence, this is so...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating Clustered Storage Spaces in Windows Server 2012</h1><div class="post__text post__text-html js-mediator-article">  Good day! <br><br>  Today I would like to talk a little about a new feature in <a href="http://technet.microsoft.com/en-US/evalcenter/hh670538.aspx">Windows Server 2012</a> - Storage Spaces or Data Spaces. <br><br>  In essence, this is some kind of disk subsystem virtualization mechanism that abstracts us from the physical layer of the disk subsystem.  However, a more interesting implementation of this mechanism is Clustered Storage Spaces.  Let's take a closer look at how to configure this mechanism. <br><img src="https://habrastorage.org/storage2/9d4/c86/da0/9d4c86da01fb1b6e37764419ceec3e93.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h1>  Preliminary Requirements </h1><br><br>  To begin with, let's deal with those necessary conditions of our ‚Äúgiven‚Äù for the implementation of the customization process. <br>  So: <br><br>  1) To create a Storage Spaces in the failover cluster mode, you need at least 3 physical disks, the size of which is at least 4 GB for each disk. <br>  2) All disks inside the Storage Pools <b>must be Serial Attached SCSI (SAS)</b> - independent of whether these disks are directly connected to the system, whether there is any layer between the OS and the disks in the form of RAID controllers and other disk subsystems or not. <br>  3) All physical disks that will be in a clustered pool must successfully pass the validation test in Failover Clustering.  In order to do this, open <b>Failover Cluster Manager - cluadmin.msc</b> and select the <b>Validate Cluster</b> option. <br><br><img src="https://habrastorage.org/storage2/6b1/5b0/b84/6b15b0b843d318c784f45f6a3c60c928.png"><br><br>  4) A clustered data space should use a fixed type of resource provision (this is the type of <b>vhd (x) disk</b> that is used for Storage Spaces). <br>  5) Simple <b>(simple)</b> and mirror <b>(mirror)</b> types of <b>Storage Spaces</b> are supported - the type with integrity control <b>(parity) is</b> not supported. <br>  6) The disks that are used in the failover pool must be <b>allocated</b> .  This means that they cannot be used in other pools, only in one and only one. <br>  7) Storage spaces that are formatted in <b>ReFS</b> format <b>cannot be added to a shared cluster volume (CSV)</b> . <br><br><h1>  How to set up - step by step instructions </h1><br><br>  1) Add the <b>File Services</b> role and the <b>File Services Role Administration Tools</b> toolkit to all cluster nodes in Failover Cluster. <br>  2) Open the <b>Failover Cluster Manager</b> management <b>console (cluadmin.msc)</b> . <br>  3) On the left side of the panel, expand the <b>Storage</b> item, right-click on <b>Pools</b> and select the item to create a new <b>New Storage Pool</b> .  Next you will see the <b>New Storage Pool Wizard</b> setup wizard. <br><br><img src="https://habrastorage.org/storage2/d35/081/353/d3508135373614c61bcda8000e2053f2.png"><br><br>  4) Set a name for the Storage Pool and select the disk subsystem available for the cluster and click <b>Next</b> . <br><br><img src="https://habrastorage.org/storage2/389/cda/802/389cda802759fd8dde16aa492ac8b0ac.png"><br><br>  5) Select the physical disks in the <b>Physical Disks</b> section for the new pool (remember the requirements !!!) and confirm the creation of the pool.  The pool will be added to the cluster transferred to the active state <b>(Online)</b> . <br><br><img src="https://habrastorage.org/storage2/8cd/705/0ce/8cd7050ceb0cd091df358fc590c681b5.png"><br><br>  6) The next step is to create a virtual disk or data space that will be associated with our pool.  In the <b>Failover Cluster Manager,</b> select the <b>storage pool of</b> interest that the virtual disk will provide.  Right click and the item <b>New Virtual Disk</b> is our choice! <br><br><img src="https://habrastorage.org/storage2/146/c72/90b/146c7290b82970e2d8197d1597ce5449.png"><br><br>  7) Next, the <b>New Virtual Disk Wizard</b> Virtual Hard <b>Disk Wizard</b> will start.  Select the server and pool for the virtual disk and click <b>Next</b> .  Note that in the server list will be specified the node that hosts the pool. <br><br><img src="https://habrastorage.org/storage2/c78/040/e9a/c78040e9a6714295dd774a387c523efc.png"><br><br>  8) Specify the name of the virtual disk and its description.  Click <b>Next</b> . <br><br><img src="https://habrastorage.org/storage2/f2a/260/e1b/f2a260e1b853d8f6e99a2149d2fbda3e.png"><br><br>  9) Select the type of disk subsystem - Simple <b>(Simple)</b> or Mirror <b>(Mirror)</b> .  Remember that the Parity option is not supported for cluster implementation. <br><br><img src="https://habrastorage.org/storage2/209/d29/477/209d29477fb915457c3d6b32155255a2.png"><br><br>  10) Specify the size of the virtual disk and click <b>Next</b> .  After confirmation, the disc will be created.  If you did not uncheck the check box, then the <b>New Volume Wizard</b> will start. <br><br><img src="https://habrastorage.org/storage2/1cc/9e2/4ca/1cc9e24ca09607604f7d5a92c6e2beaa.png"><br><br>  11) Set the correct ‚ÄúServer-Disk‚Äù for your configuration and click <b>Next</b> . <br><br><img src="https://habrastorage.org/storage2/d6d/970/bdc/d6d970bdcac5c76ac0090f10419fc315.png"><br><br>  12) Specify the size of the volume and click <b>Next</b> . <br><br><img src="https://habrastorage.org/storage2/2bb/bbc/4d0/2bbbbc4d06cacdb799a3611324793e8b.png"><br><br>  13) You can also assign a letter to a new volume - then click <b>Next</b> . <br><br><img src="https://habrastorage.org/storage2/920/dbf/b76/920dbfb76859de65b527e42a51ab0261.png"><br><br>  14) Select the file system type (we remember that only <b>NTFS</b> is suitable for our task) and click <b>Next</b> to confirm the settings.  A new volume will be created on top of the virtual disk and given to the cluster ownership. <br><br><img src="https://habrastorage.org/storage2/b3c/e89/e0c/b3ce89e0c59a3557dd42260487c4f2e5.png"><br><br>  15) Well, our cluster space has been successfully created!  Now it is possible to place clustered loads on top of it.  To view the pool properties, log in to the <b>Failover Cluster Manager</b> . <br><br><img src="https://habrastorage.org/storage2/a37/f7d/dd0/a37f7ddd0861247cafa2cbcb0f520b7d.png"><br><img src="https://habrastorage.org/storage2/ef3/a51/3d8/ef3a513d8895767d87b4a9fe2389791a.png"><br><img src="https://habrastorage.org/storage2/a69/676/d23/a69676d237cb01beb0b92004546ede13.png"><br><br><h1>  PowerShell lovers </h1><br><br>  And lastly. <br>  All the same, but without GUI))) <br><br>  1. Create a new space <br><br>  a.  Select physical disks and add to pool <br><br>  <b><i>$ phydisk = Get-PhysicalDisk ‚ÄìCanPool $ true |</i></b>  <b><i>Where BusType -eq "SAS"</i></b> <br><br>  b.  Getting the disk subsystem for the pool <br><br>  <b><i>$ stsubsys = Get-StorageSubsystem</i></b> <br><br>  c.  Create a new pool <br><br>  <b><i>$ pool = New-StoragePool -FriendlyName TestPool -StorageSubsystemFriendlyName $ stsubsys.FriendlyName -PhysicalDisks $ phydisk -ProvisioningTypeDefault Fixed</i></b> <br><br>  d.  Adding a disk for hot swapping <b>(Hot Spare)</b> <br>  <b><i>$ hotSpareDisk = Get-PhysicalDisk ‚ÄìCanPool $ true | Out-GridView -PassThru</i></b> <br><br>  <b><i>Add-PhysicalDisk -StoragePoolFriendlyName TestPool -PhysicalDisks $ hotSpareDisk -Usage HotSpare</i></b> <br><br>  2. Creating data space on top of previously created pool <br><br>  a.  <b><i>$ newSpace = New-VirtualDisk ‚ÄìStoragePoolFriendlyName TestPool ‚ÄìFriendlyName space1 -Size (1GB) -ResiliencySettingName Mirror</i></b> <br><br>  3. Initialization, markup and formatting of previously created data space <br><br>  <b><i>a.</i></b>  <b><i>$ spaceDisk = $ newSpace |</i></b>  <b><i>Get-disk</i></b> <b><i><br><br></i></b>  <b><i>b.</i></b>  <b><i>Initialize-Disk -Number $ spaceDisk.Number -PartitionStyle GPT</i></b> <b><i><br><br></i></b>  <b><i>c.</i></b>  <b><i>$ partition = New-Partition-DiskNumber $ spaceDisk.Number -DriveLetter $ driveletter -size $ spaceDisk.LargestFreeExtent</i></b> <b><i><br><br></i></b>  <b><i>d.</i></b>  <b><i>Format-Volume -Partition $ partition -FileSystem NTFS</i></b> <br><br>  4. Adding data space to the cluster <br><br>  <b><i>a.</i></b>  <b><i>$ space = Get-VirtualDisk -FriendlyName space1</i></b> <b><i><br><br></i></b>  <b><i>b.</i></b>  <b><i>Add-ClusterDisk $ space</i></b> <br><br>  This seems to be all.  It remains to add that if you want to learn more about the new features of Windows Server 2012, then we invite everyone to IT Camps, which will be held in Moscow.  Schedule you will find <a href="http://blogs.technet.com/b/rutechnews/archive/2012/10/29/windows-server-2012-microtest-seminar-free.aspx">here</a> . <br>  And do not forget about a very useful resource - <a href="http://microsoftvirtualacademy.com/">Microsoft Virtual Academy</a> <br><br>  Merry IT adventures! <br><br>  Respectfully, <br>  George A. Gadzhiev <br>  Information Infrastructure Expert <br>  Microsoft Corporation </div><p>Source: <a href="https://habr.com/ru/post/156777/">https://habr.com/ru/post/156777/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../156757/index.html">48 cores for smartphones and tablets</a></li>
<li><a href="../156761/index.html">To hell with such innovations!</a></li>
<li><a href="../156763/index.html">The age of your smartphone (age model)</a></li>
<li><a href="../156771/index.html">Curiosity conducted the most detailed geological research on Mars</a></li>
<li><a href="../156775/index.html">Sandbox for fonts</a></li>
<li><a href="../156779/index.html">Unambiguous Layout Switch</a></li>
<li><a href="../156781/index.html">Compact Java servlet for mobile web</a></li>
<li><a href="../156783/index.html">Google Play caught up with Apple App Store</a></li>
<li><a href="../156787/index.html">Windows 8 Summit through the eyes of a Delphi programmer</a></li>
<li><a href="../156789/index.html">Free WiFi traffic</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>