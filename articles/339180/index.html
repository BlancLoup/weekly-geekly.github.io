<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>[CppCon 2017] Lars Knoll: C ++ Qt framework: History, Present and Future</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The content of the cycle review speeches CppCon 2017: 


- Bjarne Stroustrup: Learning and teaching modern C ++ 
- Lars Knoll: C ++ Qt framework: Hist...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>[CppCon 2017] Lars Knoll: C ++ Qt framework: History, Present and Future</h1><div class="post__text post__text-html js-mediator-article"><p>  The content of the cycle review speeches CppCon 2017: </p><br><ul><li>  <a href="https://habrahabr.ru/post/339036/">Bjarne Stroustrup: Learning and teaching modern C ++</a> </li><li>  Lars Knoll: C ++ Qt framework: History, Present and Future </li><li>  <em>(in the process)</em> </li></ul><br><p>  Review of the performance of Lars Knoll, technical director of Qt Company.  Do not expect too much from this performance.  In square brackets italics are my notes. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/YWiAUUblD34" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><p>  Thanks for the opportunity to talk a bit about Qt.  This is a C ++ framework.  Its principles and philosophy are slightly different from those familiar to you in the standard library.  [ <em>Question to the audience</em> ] Just for information, how many of you know Qt and used it before?  Wow  Thank you, great!  It's fantastic!  Then I will talk about things that you probably already know. </p><br><h2 id="chto-takoe-qt">  What is Qt? </h2><br><p>  Perhaps this is the most comprehensive C ++ framework.  But this is not only a framework, it is also a variety of tools that help develop embedded devices, Qt Quick's UI technology, not related to C ++, but integrated with it. </p><br><p>  Two licenses: commercial and LGPLv3 / GPLv3.  This is an open project. </p><br><p>  Two products: </p><br><ul><li>  Qt for Application Development (Desktop &amp; Mobile Platforms: Android, Linux, Windows, Mac, iOS) </li><li>  Qt for Device Creation (Embedded platforms: Android, Linux, Windows, QNX, VxWorks, Green Hills Software (IOT, Internet of Things)) </li></ul><br><h3 id="qt-for-application-development">  Qt for Application Development </h3><br><p><img src="https://habrastorage.org/webt/59/d2/85/59d28560e00d4310644249.png" alt="Qt modules"></p><br><p>  At the core are the integral libraries.  The most important is Core, which contains main classes, I / O, work with files, etc.  GUI library - the basis of the graphical interface.  And many others. </p><br><h3 id="qt-for-device-creation">  Qt for Device Creation </h3><br><p><img src="https://habrastorage.org/webt/59/d2/85/59d28560caba0277056805.jpeg" alt="Qt embedded"></p><br><h3 id="qt-creator">  Qt creator </h3><br><p>  Cross-platform development environment for desktop, mobile and embedded systems.  Many people use it to program in pure C ++, without Qt.  Supports the integration of various tools (profilers, debuggers ...), autocompiles, VCS ... </p><br><p><img src="https://habrastorage.org/webt/59/d2/85/59d2856080dbf421981584.png" alt="Qt creator"><br>  <em>Early error detection with Qt Creator and CLang static analyzer</em> </p><br><h2 id="istoriya">  Story </h2><br><p>  Fast forward to 26 years ago.  Students Haarvard Nord and Eirik Chambe-Eng are thinking about a new project.  At that time, they were developing GUIs for a system that ran on Unix, Macintosh, and Windows.  That was hard.  In the summer of 1990, they decided that they needed an object-oriented display system. </p><br><p>  In 1993, the first graphics core was developed. </p><br><p><img src="https://habrastorage.org/webt/59/d2/85/59d285603c71a001678060.jpeg" alt="early Qt"></p><br><p>  This version was called Quasar.  Then there were no namespaces.  Motif (a library of interface elements and a set of specifications for developing graphical interfaces under the X Window System) had its prefix.  Therefore, the prefix "Q" was added, which played the role of the namespace.  Now from that version much remained.  That left the QObject - the central part that implements the signals / slots mechanism.  And also QEvent, QFont, QPainter, QColor. </p><br><p>  In 1994, they persuaded their wives to support them financially for a couple of years, and founded the company Trolltech. </p><br><p><img src="https://habrastorage.org/webt/59/d2/85/59d285603c739566183175.jpeg" alt="Trolltech Site"><br>  <em>Early version of the site Trolltech</em> </p><br><p>  The project was still pretty raw.  In addition, sales of software via the Internet in those days were not popular, preferred by physical media.  Accordingly, there was little money. </p><br><h3 id="1996-qt-10">  1996: Qt 1.0 </h3><br><p>  Worked completely without templates.  Therefore, there were several specialized lists for pointers, integers, etc. Windows 95 / NT and UNIX / X11 were supported.  The UNIX version was open source, since the small company needed to somehow distribute its product. </p><br><h3 id="new-project-kool-desktop-environment-kde">  New Project: Kool Desktop Environment (KDE) </h3><br><p>  In 1997, Mattias Ettrich (known for his contribution to the KDE project) decided to use Qt to create KDE.  This was probably the reason why Qt "took off." </p><br><p><img src="https://habrastorage.org/webt/59/d2/85/59d285608887b844198740.jpeg" alt="first_kde"></p><br><h3 id="1999-qt-20">  1999: Qt 2.0 </h3><br><p>  It was released under the GPL license.  Unicode support has been added.  The project was granted venture capital.  The number of employees for the year increased from 5 to 50. </p><br><p>  Basic widgets were developed, as well as layers that provide a ‚Äúflexible‚Äù interface.  But people did not want to write code for this.  Then Qt Designer appeared. </p><br><p><img src="https://habrastorage.org/webt/59/d2/85/59d28560bd4ca950388230.jpeg" alt="qt_designer"><br>  <em>first version</em> </p><br><p>  At this time I went to work in Trolltech [ <em>And therefore the author began to use the pronoun "we" further</em> ] </p><br><h3 id="2001-qt-3">  2001: Qt 3 </h3><br><p>  We have replaced explicit sharing with implicit sharing for strings.  People got a bunch of problems with strings.  Then we decided to leave implicit sharing, but to create a new internal copy when the string changes (copy-on-write) [ <em>more detailed</em> ]. </p><br><p>  Began to use more templates, C ++ 98.  A qobject_cast &lt;&gt; appeared (an analogue of dynamic_cast for a QObject, but not using RTTI).  Open source for Mac. </p><br><h3 id="2005-qt-4">  2005: Qt 4 </h3><br><p>  Carefully reviewed the template and auxiliary classes.  Moving from storing pointers to values ‚Äã‚Äãin containers to storing the values ‚Äã‚Äãthemselves.  Implicit sharing containers began to use atomic reference counting.  Open source for Windows.  For Windows, this was done last, because we needed income and customers to survive. </p><br><h3 id="nokia-priobretaet-trolltech">  Nokia acquires Trolltech </h3><br><p>  Nokia was interested in a common API for their platforms (S40, Symbian &amp; Maemo / MeeGo).  Huge investments have been received in Qt.  We have long wanted to develop a cross-platform IDE, but there was no means.  The guide offered Eclipse, but it is not very good for C ++.  With Nokia, our desire became possible and was created by Qt Creator.  And also Qt Quick.  We also began to work on the integration of the WebKit engine.  Nokia changed the license from the GPL to the LGPL, which made the framework even more free. </p><br><p>  In 2012, we broke up with Nokia. </p><br><h3 id="20112012-qt-5">  2011/2012 Qt 5 </h3><br><p>  Digia acquired Qt. </p><br><p>  Porting to new platforms was difficult, so they added a layer of abstraction.  We did a good job on the graphical interface, it stopped being static.  For example, this can be seen in the Dock Widget window during the move. </p><br><h3 id="2016-qt-company-otdelilas-ot-digia">  2016: Qt Company separated from Digia </h3><br><h3 id="qt-company-segodnya">  Qt Company today </h3><br><p>  250 employees, annual income of 32 million euros.  About a million active users. </p><br><h2 id="qt-seychas">  Qt now </h2><br><p>  Our goals: </p><br><ul><li>  Support for old code </li><li>  Intuitiveness </li><li>  Self-documenting </li><li>  API, easy to learn and use </li><li>  Performance </li></ul><br><h3 id="sohranenie-prostoty">  Simplicity preservation </h3><br><p>  C ++ has a very steep learning curve, which makes it hard for newbies.  All this complexity is required in rare cases.  And Qt is not only used by C ++ gurus.  You rarely see an application developer fiddling with patterned metaprogramming. </p><br><h3 id="realizaciya">  Implementation </h3><br><p>  [It is <em>superficially told about the basics of QObject, Signals / Slots, moc, about which it is written in any manual, missed</em> ] </p><br><h3 id="implicitly-shared">  Implicitly shared </h3><br><p>  <em>Read more: <a href="https://doc.qt.io/qt-5/implicit-sharing.html">Implicitly shared</a></em> </p><br><p>  Many classes are implemented like this: </p><br><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QFont</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPointerSize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pt)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (d-&gt;refCount != <span class="hljs-number"><span class="hljs-number">1</span></span>) detach(); d-&gt;pointSize = pt; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: detach(); QFontPrivate *d; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QFontPrivate</span></span></span><span class="hljs-class"> {</span></span> QBasicAtomicInt refCount; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pointSize = <span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> weight = QFont::Normal; };</code> </pre> <br><p>  This allowed us to be more free when adding and removing members of a class.  When you change an object, a copy of the internal data is created.  The advantages of this approach: </p><br><ul><li>  Objects behave almost like primitive types. </li><li>  Easy and quick copying of the object </li><li>  The object can be passed by value. </li><li>  Thread safe </li></ul><br><p>  Disadvantages: </p><br><ul><li>  Slight performance degradation due to atomic counter </li><li>  Minor change in iteration semantics </li><li>  Range-for cycles may have problems: </li></ul><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> c : qvector) <span class="hljs-comment"><span class="hljs-comment">// (detached)     for(auto c : qAsConst(qvector)) //</span></span></code> </pre> <br><p>  [ <em>In the first line, detach is actually called, but the creation of an internal copy will occur only if the counter is greater than one, for example:</em> ] </p><br><pre> <code class="cpp hljs">QVector&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; v1 = { <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span> }; QVector&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; v2 = v1; <span class="hljs-comment"><span class="hljs-comment">//    ,  v1  v2         for (auto c : v1) //   ,   v1.begin()</span></span></code> </pre> <br><h3 id="zapolnenie-nedostayuschego-v-standartnoy-biblioteke">  Filling the missing in the standard library: </h3><br><ul><li>  QString with unicode support, which C ++ does not normally support. </li><li>  Qlocale </li><li>  QDate / QTime / QDateTime / QTimeZone </li><li>  QAtomic and threads.  Implemented before C ++ 11 </li><li>  Work with file system, I / O, network </li><li>  Graphics </li></ul><br><h2 id="qt-quick">  Qt quick </h2><br><p>  [ <em>The very, very basics of QML, nothing new.</em>  <em>Missed</em> ] </p><br><h2 id="buduschie-relizy">  Future releases </h2><br><ul><li>  Qt 5.9 - current release (long term supported - 3 years) </li><li>  Qt 5.9.2 - coming soon </li><li>  Qt 5.10 - Beta Coming Soon, November Release </li><li>  Qt 5.11 - May 2018 </li><li>  Qt 5.12 - November 2018 (a possible candidate for the next long term supported) </li></ul><br><h3 id="grafika">  Graphics </h3><br><p>  Enabling various graphics APIs in Qt Scene (OpenGL, Vulkan, Metal, Direct3D, Software Rasterization) </p><br><h3 id="planovaya-rabota">  Planned work </h3><br><ul><li>  Performance improvement </li><li>  Speech recognition (digital assistant?) </li><li>  AR / VR </li><li>  IDE tools (refactoring, workflow) </li></ul><br><h3 id="c14--17">  C ++ 14 &amp; 17 </h3><br><p>  We use C ++ 11 to the extent that VS2013 allows.  We would like to use: </p><br><ul><li>  if constexpr </li><li>  Initializers in if / switch </li><li>  Structured bindings </li><li>  Overaligned data </li></ul><br><p>  We are already using <code>__has_include</code> , <code>[[deprecated]]</code> , <code>[[fallthrough]]</code> , <code>[[nodiscard]]</code> .  Added QStringView. </p><br><h3 id="c20">  C ++ 20 </h3><br><p>  It could be very interesting for Qt: concepts, modules, reflection (maybe it would even be possible to get rid of moc sometime in the future). </p><br><h2 id="voprosy-i-otvety">  Questions and answers </h2><br><blockquote>  What do you think about Qt security? </blockquote><p>  Of course, we are working on it, spending a lot of time, releasing patches, updates.  Our security mailing list is quite small. </p><br><blockquote>  How do you pronounce: ‚ÄúkyutI‚Äù or ‚ÄúkyuT‚Äù [ <em>very soft ‚Äút‚Äù in both cases</em> ]? </blockquote><p>  Good question!  Our company and those who work with us use kyuT, although in the United States it is predominantly kyuT.  [ <em>And how are you?</em>  <em>Added poll</em> ] </p><br><blockquote>  Qt programming is different from C ++ programming.  What do you think about duplication of functionality - for example, QVector and much more?  Planning to merge or what? </blockquote><p>  Ideally, yes, but there are problems.  First, because of the support of the old code.  Secondly, some Qt classes are better, for example QString (interface methods such as case conversion, unicode).  Ask a lot of questions about similar containers.  I advise you to choose the most suitable. </p><br><blockquote>  Now Qt uses raw owning pointers.  Is it time to replace them with smart ones?  Now an object with a smart pointer cannot be passed to Qt, because it will have a parent. </blockquote><p>  It is very difficult.  And all the old code will break. </p><br><blockquote>  If your code is open source, then where does the income come from? </blockquote><p>  From sales of the commercial version. </p><br><blockquote>  Why not add a displacement constructor to QObject and derived classes?  With the copy constructor, this is understandable [ <em><a href="https://doc.qt.io/qt-5/object.html">why there is no copy constructor</a></em> ]. </blockquote><p>  Everything will break.  If we had foreseen the appearance of the semantics of displacement, then perhaps we would not use the current mechanism.  Now it is impossible to change it. </p><br><blockquote>  Did you evaluate the performance of the copy-on-write model for strings versus simple copying? </blockquote><p>  For shorter lines, copying is faster.  An update will be released soon, which will implement a similar mechanism for short lines. </p><br><blockquote>  How about support for other graphics APIs? </blockquote><p>  If we are talking about 3D API, such as Apple Metal, Vulkan, Direct 3D 12, then it is difficult. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/339180/">https://habr.com/ru/post/339180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339170/index.html">How to successfully implement the Help Desk? 12 examples (part 1)</a></li>
<li><a href="../339172/index.html">Online consultants: a test review of 7 popular systems. What do you get if you fold advertising?</a></li>
<li><a href="../339174/index.html">GitLab 10.0 released: Auto-DevOps and group task boards</a></li>
<li><a href="../339176/index.html">Node.js and transition from PHP to JavaScript</a></li>
<li><a href="../339178/index.html">How to permanently delete 100,000 users and stay alive?</a></li>
<li><a href="../339184/index.html">Ivan Ponomarev and Nikolai Potashnikov on the display of tabular data, Celesta and Flute on jug.msk.ru</a></li>
<li><a href="../339186/index.html">[CppCon 2017] Herb Sutter: Metaprogramming and Code Generation in C ++</a></li>
<li><a href="../339190/index.html">Obvious non-obviousness in assembly using a webpack</a></li>
<li><a href="../339192/index.html">Why in Go ampersand and asterisk (& and *)?</a></li>
<li><a href="../339194/index.html">Next billion users: who these people are and how they will affect the global economy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>