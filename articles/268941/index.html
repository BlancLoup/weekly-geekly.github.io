<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mail Productivity: How Evernote was created for Outlook</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Productivity is probably one of the most popular trends of recent years, and the Evernote solution is a prime example in this niche. Great news for Ev...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mail Productivity: How Evernote was created for Outlook</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <em>Productivity is probably one of the most popular trends of recent years, and the Evernote solution is a prime example in this niche.</em>  <em>Great news for Evernote users - now the opportunity to work with the solution in Outlook is also available, which will be discussed further.</em> <em><br></em>  <em>I want to thank for the preparation of the article by Rodion Nasakin (Market Development Director Evernote in Russia and the CIS), as well as Actimind, an expert in plug-in development for various applications, including Microsoft Office applications.</em> </blockquote><br>  In this article we want to talk about why Evernote needed to create an add-on for Outlook and share its development experience. <br><br><img src="https://habrastorage.org/files/190/ffd/12b/190ffd12b5f245958d81d79cd644124b.png"><br><a name="habracut"></a><br><h1>  <font color="#1DC669"><b>Why Evernote needed Outlook</b></font> </h1><br>  Evernote service has become popular largely due to its versatility, allowing you to collect, synchronize and organize a variety of information.  These can be text notes, handwritten sketches, scans, photos, articles copied from the Internet, task lists, voice recordings, and much more. <br><br>  70% of users use Evernote in work and business, and it is obvious that a significant part of the necessary information comes to them by email.  For Evernote, in turn, it is important that users can quickly collect all the information related to the working project in one place and work with it without leaving the application. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Therefore, in addition to a set of mobile and desktop applications, Evernote has several tools for working with incoming email.  This, in particular, is copying chains of letters from Gmail with the Evernote Web Clipper plugin and sending it to a special Evernote address.  And, of course, as soon as Office 365 added support for third-party add-ons (add-in), the service team thought about a special solution for such a prominent tool. <br><br>  The development of <a href="https://store.office.com/evernote-for-outlook-WA104379617.aspx%3Fassetid%3DWA104379617">Evernote for Outlook</a> was assigned to the independent team <a href="http://www.actimind.com/">Actimind</a> , our compatriots from St. Petersburg.  Previously, the guys had already worked on <a href="https://evernote.com/webclipper/">Evernote Web Clipper</a> add-ons for browsers, so they had an idea about the <a href="https://dev.evernote.com/">Evernote API</a> and the specifics of the service as a whole. <br><br>  With Evernote for Outlook, users were able to copy a letter, correspondence in whole or in part to Evernote to their account, specifying the destination notebook and the necessary tags.  Corporate notepads and tags for users of the Evernote Business solution are also supported. <br><br>  By default, all files attached to emails are also saved to Evernote as attachments to a note.  At the same time, printed and handwritten text in the attached images becomes searchable.  You can send to Evernote and only a quote from the letter, highlighting the desired text. <br><br>  The application works and "in the opposite direction" - you can quickly add notes from Evernote to the email created in Outlook to share them with colleagues. <br><br><h1>  <font color="#1DC669"><b>How does the add-on for Outlook</b></font> </h1><br>  An <a href="http://dev.office.com/getting-started/addins">add-in</a> or <a href="http://dev.office.com/getting-started/addins">add-in (add-in) for Outlook</a> is a manifest file, as well as one or more web pages.  The manifest is an XML file that stores some information about the application, including the address from which Outlook will load the start page.  Pages are directly responsible for the main logic and interface of the application.  They will be opened in a secure frame on the Outlook website, and will be able to communicate with the service through a specially provided API. <br><br>  Unlike classic add-ons for Outlook, new applications are launched only manually, in the context of one element.  While the application is not running, it has no idea about the actions of the user.  In addition, new applications can only work with letters and invitations.  Support tasks, journal entries and calendar events in the online version of Outlook yet.  But new applications are cross-platform and can work in any Outlook.com clients (Outlook 2013 or 2016, Outlook Online), including mobile ones. <br><br><h1>  <font color="#1DC669"><b>Development environment</b></font> </h1><br>  You can develop the add-in in any HTML + JS + CSS editor, but we would highlight two options. <br><br>  First, <a href="https://msdn.microsoft.com/en-us/library/office/jj220038.aspx">Napa Office 365 Development Tools</a> (www.napacloudapp.com), a cloud solution that is great for rapid prototyping. <br><br><img src="https://habrastorage.org/files/8f6/270/13f/8f627013ff8b44f4aa970a52e450f062.png"><br><br>  Here you can quickly get acquainted with the main settings of the manifest and try out the JS API in action.  Napa hosts the application files and automatically updates the manifest as it changes.  When the online editor is no longer enough, the project can be exported, for example, to Visual Studio. <br><br>  <a href="https://www.visualstudio.com/en-us/features/office-tools-vs.aspx">Visual Studio, starting with the 2012</a> version, supports the ability to develop add-ins for Office 365: it updates the manifest, raises IIS with files, and allows you to debug through IE.  However, for the work you will need to install an additional component, which you can read more about <a href="https://msdn.microsoft.com/library/office/fp142159.aspx">here</a> . <br><br>  Other editors may have an embedded web server, but the manifest will most likely have to be downloaded and updated manually via the Outlook Manage add-ins menu item.  However, this is not required so often. <br><br><h1>  <font color="#1DC669"><b>Development process</b></font> </h1><br>  The mithril + require.js bundle was chosen as the basis, the code was written mainly in CoffeeScript and Less.  The assembly was carried out with the help of Grunt. <br>  We took the exported file from Napa as the basis for the manifesto - it already has everything you need. <br><br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OfficeApp</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MailApp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/office/appforoffice/1.1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Id</span></span></span><span class="hljs-tag">&gt;</span></span>e8df9484-022a-479e-8175-c08d2d540bdb<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Id</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DisplayName</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DefaultValue</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Evernote DEV"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">IconUrl</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DefaultValue</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://localhost:44555/app/images/app-icon.png"</span></span></span><span class="hljs-tag"> /&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FormSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ItemRead"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DesktopSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SourceLocation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DefaultValue</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://localhost:44555/app/html/home-read.html"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RequestedHeight</span></span></span><span class="hljs-tag">&gt;</span></span>350<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RequestedHeight</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DesktopSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TabletSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SourceLocation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DefaultValue</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://localhost:63342/app/html/home-read.html?mobile"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RequestedHeight</span></span></span><span class="hljs-tag">&gt;</span></span>350<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RequestedHeight</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TabletSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PhoneSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SourceLocation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DefaultValue</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://localhost:44555/app/html/home-read.html?mobile"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PhoneSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ItemEdit"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DesktopSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SourceLocation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">DefaultValue</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://localhost:44555/app/html/home-compose.html"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DesktopSettings</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FormSettings</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Permissions</span></span></span><span class="hljs-tag">&gt;</span></span>ReadWriteMailbox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Permissions</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">OfficeApp</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The main parts of the manifest include the application ID, its name and description, as well as modes of operation and links.  The Evernote application works in read mode (ItemRead) and in letter editing mode (ItemEdit), on desktops, tablets and mobile phones.  If you wish, you can specify different links for each of these cases. <br><br>  Since HTTPS is mandatory for all resources, a certificate is required.  For the first time, a self-signed one will suffice for local development, but for a full-fledged verification, mobile clients will need a real one. <br><br>  After adding the application manifest to your Outlook account, an application icon will appear above the email in read mode (or on the top panel in edit mode). <br><br>  As mentioned above, all add-ins are launched manually, in the opening frame from above (or from the side, in edit mode) from the letter body.  The corresponding page from the manifest will be loaded into it.  The page should contain a link to office.js, which will create a global Office object and initialize it.  All that remains is to put the application launch logic into Office.initialize. <br><br><pre> <code class="javascript hljs"> Office.initialize = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">reason</span></span></span><span class="hljs-function">) =&gt;</span></span> language = Office.context.displayLanguage context.init()</code> </pre><br>  After calling initialize, you can start using the JS API, for example, to get the interface language chosen by the user.  By the way, good localization support is available, including manifest fields. <br><br><img src="https://habrastorage.org/files/606/0ec/a72/6060eca723604496aaf6e70d51690f60.png"><br><br>  We used a scheme with several versions of the add-in ‚Äî for development, for testing builds, and one stable for presentation.  From the point of view of Outlook, these are different applications, each of them has its own manifest with a unique ID, and they refer to different places.  This way you can develop and test without interfering with each other.  In our case, the DEV-version manifest points to the path of the form "localhost: 44555", which is convenient for joint development.  But if necessary, each developer can create his own version of the manifest for convenience or experiments. <br><br>  As mentioned at the beginning, in the reading mode of the letter, the application should be able to save the current letter or the entire correspondence, as well as attachments of these letters. <br><br><img src="https://habrastorage.org/files/1de/3f9/c2c/1de3f9c2cdcd443e9d3d194ca34f11ab.png"><br><br>  When saving a letter, we also save all its attributes.  In the JS API, getting them is very easy: <br><br><pre> <code class="javascript hljs"> item = Office.context.mailbox.item mail.subject = item.subject mail.sender = item.from.displayName + <span class="hljs-string"><span class="hljs-string">" ("</span></span>+ item.from.emailAddress+<span class="hljs-string"><span class="hljs-string">")"</span></span></code> </pre><br>  With the body of the letter is more difficult, in reading mode it will not work.  Fortunately, if the application has the ReadWriteMailbox access level, it is allowed to execute the makeEwsRequestAsync method, which allows you to execute a manually generated SOAP request to the service, though not any, but from a limited list.  Using this method from the service, you can get some things that are not yet available through the JS API. <br><br><pre> <code class="javascript hljs"> Office.context.mailbox.makeEwsRequestAsync( @getItemUniqueBodyRequest(Office.context.mailbox.item.id), (asyncResult) -&gt; @processMailSoap(asyncResult, callback))</code> </pre><br>  getItemUniqueBodyRequest forms a SOAP request based on the letter identifier, processMailSoap parses the response sent.  makeEwsRequestAsync, like many other potentially durable JS API methods, is asynchronous.  The restriction applies to asynchronous methods - no more than three can be executed at the same time, besides, the maximum size of the returned result is limited to one megabyte. <br><br>  In the same way, you can get a chain of letters, but with attachments any problems arise.  The JS API does not provide direct access to attachment bodies.  But there is a way to get them, for this you need to call the Office.context.mailbox.getCallbackTokenAsync function, get a short-term access token from it, and transfer it to the server along with a link to the Exchange service, which is located in Office.context.mailbox.ewsUrl.  The server part has the ability to perform a limited set of SOAP requests to Exchange using a token, including receiving attachment data.  The set of requests that the service can perform with the token is wider than the available client part with makeEwsRequestAsync, besides, the restriction of 1MB does not apply to it.  But, unfortunately, the token is limited to access to one element, in the context of which the add-in was opened, even if ReadWriteMailbox permission is specified in its manifest, therefore it is not yet possible to save a chain of emails with attachments. <br><br>  Users have the ability to set a notepad and Evernote tags to be used by default.  To store these settings, the JS API provides an Office.context.roamingSettings object, which is synchronized for a specific add-in between all devices of this Outlook user.  Values ‚Äã‚Äãare stored in JSON form. <br><br><pre> <code class="javascript hljs"> notebook = Office.context.roamingSettings.get(defaultNotebookSettingName) Office.context.roamingSettings.set(defaultTagsSettingName, [<span class="hljs-string"><span class="hljs-string">"tag1"</span></span>,<span class="hljs-string"><span class="hljs-string">"tag2"</span></span>]) Office.context.roamingSettings.saveAsync(callback)</code> </pre><br>  In the letter writing mode, the user can add a link to any of his notes.  Recipients will be able to open the note in the browser, even if they are not users of Evernote. <br><br><img src="https://habrastorage.org/files/401/e6a/3ca/401e6a3ca5604116959da6777113a375.png"><br><br>  Outlook JS API supports methods for inserting HTML fragments into the body.  Along the way, we determine in what format the letter body is text and HTML, RTF as a letter format in Outlook 365 is not available. <br><br><pre> <code class="javascript hljs"> Office.context.mailbox.item.body.getTypeAsync (result) =&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> result.status == Office.AsyncResultStatus.Failed then <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> result.value when Office.MailboxEnums.BodyType.Html noteUrl = @getNoteShareUrl(note.guid, notebook, shareKey) imgSrc = @getNoteShareThmbUrl(note.guid, notebook, shareKey) html = @generateHtml(note, createdBy, noteUrl, imgSrc) Office.context.mailbox.item.body.setSelectedDataAsync(innerHtml, { <span class="hljs-attr"><span class="hljs-attr">coercionType</span></span>: Office.MailboxEnums.BodyType.Html }) when Office.MailboxEnums.BodyType.Text noteUrl = remote.getNoteShareUrl(note.guid, notebook, shareKey) + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> Office.context.mailbox.item.body.setSelectedDataAsync(noteUrl, { <span class="hljs-attr"><span class="hljs-attr">coercionType</span></span>: Office.MailboxEnums.BodyType.Text })</code> </pre><br>  Attachments can be added to the letter if you have a direct link to them.  Outlook will download and attach the file.  But the ability to insert inline-elements is limited.  The ContentID is not supported, and the base64 links Outlook filters.  You can contrive and create an attachment, and then refer to it through the name, but this method is unreliable, besides the result will not appear immediately, but only after updating and saving the letter.  It remains only to use absolute links to images.  At the moment, the icon disappears if the user closes access to the note, due to the peculiarities of the operation of this mechanism in Evernote. <br><br><h1>  <font color="#1DC669"><b>Difficulties</b></font> </h1><br>  In general, <a href="https://msdn.microsoft.com/en-us/library/office/fp142185.aspx">Office JS API is fairly well documented</a> , but of course it didn‚Äôt go without difficulties.  Some points worthy of mention are listed below. <br><br>  Almost immediately, we encountered the same-origin policy problem.  It is good if you have the opportunity to immediately place the add-in files along with its server part, or you have access to <a href="https://msdn.microsoft.com/en-us/office/office365/howto/create-web-apps-using-CORS-to-access-files-in-Office-365">the CORS settings</a> .  We had no such possibility during development.  To save time, we developed in parallel with the preparation of the server part. <br><br>  The easiest way to bypass the same-origin policy is Chrome, launched with the --disable-web-security flag.  Similar opportunities exist for almost all major browsers, but to fully test and support mobile devices, we had to raise a small proxy server. <br><br>  Debugging an application running in a desktop browser is not a problem.  You have the choice of IDE and browser debugger.  But debugging on mobile devices and in the desktop client can cause some difficulties, because the application is hidden inside the Outlook client.  The most interesting thing is that the behavior of the application in the mobile client may differ from the behavior of the application opened in the online version of Outlook on the same device (most styles, of course, suffer).  The internal log helps a little with output to the interface, but a full-fledged debugger in such circumstances is sometimes not enough, but the recent announcement of the release of <a href="https://blogs.office.com/2015/08/31/introducing-office-ui-fabric-your-key-to-designing-add-ins-for-office/">Office UI Fabric</a> - the debugger interface, according to the Office 365 development team, has to fill this gap. <br><br><h1>  <font color="#1DC669"><b>Add-In Evernote for Outlook</b></font> </h1><br>  However, in general, we managed to create a fairly functional and convenient solution at the level of Evernote Web Clipper extensions for browsers.  So if your audience is actively working with Outlook, cross-platform and mobility is important to you, and also you are thinking about integration, we hope that our experience will be useful for you. <br><br> <a href="https://store.office.com/evernote-for-outlook-WA104379617.aspx%3Fassetid%3DWA104379617%26sourcecorrid%3Dcea2e063-bcde-4ac8-8c9e-10265d423169%26searchapppos%3D4"><img src="https://habrastorage.org/files/8e8/c31/c53/8e8c31c538a14efd95e1ff45b8ffb71e.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/268941/">https://habr.com/ru/post/268941/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268929/index.html">Event-oriented Python backtesting step by step. Part 4</a></li>
<li><a href="../268931/index.html">5 internships for programmers abroad</a></li>
<li><a href="../268933/index.html">Megahakaton IoT Russia from Intel and Microsoft</a></li>
<li><a href="../268935/index.html">Programming Philosophy 10 - AI</a></li>
<li><a href="../268939/index.html">Cybercriminals use Win32 / Brolux.A banking trojan to compromise users in Japan</a></li>
<li><a href="../268945/index.html">The program of the second international conference of mobile developers MBLTdev is published.</a></li>
<li><a href="../268947/index.html">A multi-line textarea placeholder that works in Firefox</a></li>
<li><a href="../268949/index.html">PostgreSQL Evangelist Memo: criticize MySQL correctly</a></li>
<li><a href="../268951/index.html">Git is enough to be (less) dangerous</a></li>
<li><a href="../268957/index.html">Starting module of the course ‚ÄúAlgorithms. Olympiad programming "or Year in transit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>