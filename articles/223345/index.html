<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Game 2048 in Wolfram Mathematica</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translation of the post 2048, Wolfram Style , written for the official blog of Wolfram Research by Dan Fortunato , junior programmer of Wolfram | Alph...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Game 2048 in Wolfram Mathematica</h1><div class="post__text post__text-html js-mediator-article"> <i>Translation of the post <a href="http://blog.wolfram.com/2014/05/09/2048/">2048, Wolfram Style</a> , written for the official blog of Wolfram Research by <a href="http://blog.wolfram.com/author/dan-fortunato/">Dan Fortunato</a> , junior programmer of Wolfram | Alpha Parser Content.</i> <br><br>  <i>The archive with the Wolfram Mathematica file, which contains the code, you can download <a href="">here</a> .</i> <br><br><img alt="2048-Game-In-Wolfram-Mathematica_43.gif" height="375" src="https://habrastorage.org/getpro/habr/post_images/1dc/d7d/2a8/1dcd7d2a8a192b8539d925aebb2c81cb.png" width="549">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If during the past few weeks you went online, then you could hardly not meet with a game called <a href="http://gabrielecirulli.github.io/2048/">2048</a> , developed by Gabriel Chirulli.  Based on similar games, <a href="https://itunes.apple.com/us/app/1024!/id823499224">1024!</a>  from Veewo Studio and <a href="http://asherv.com/threes/">THREES</a> from Asher Wallmer, this game has a simple mechanic that will drag you down for a long time - move the chips on which the powers of 2 are written and connect them in pairs to get even higher degrees.  The main goal of the game is to get a 2048 chip. It is quite difficult to explain how interesting and exciting this game is in reality, so I recommend that you play it yourself. <br><br>  To pay tribute to this simple game (and in honor of all math games!), I decided to demonstrate the full power of the <a href="http://www.wolfram.com/language/">Wolfram Language</a> , using it to develop our own version of 2048. Let's start! <br><a name="habracut"></a><br><br>  The 4x4 matrix, filled with empty elements (rows of zero length) will serve as the main structure for the playing field: <br><br>  In [1]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_1.gif" height="42" src="https://habrastorage.org/getpro/habr/post_images/5ba/a83/3f9/5baa833f92ff1f624c2a24205607652b.gif" width="222"><br><br>  Out [2] = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_2.png" height="18" src="https://habrastorage.org/getpro/habr/post_images/07e/902/cda/07e902cdacc5c47d3b18d68adb371988.png" width="340"><br><br>  After the start of the new game, I will randomly place two chips on the field with values ‚Äã‚Äãof 2 or 4. I will give higher priority to chip 2, so it will appear on the field more often. <br><br>  In [3]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_3.png" height="88" src="https://habrastorage.org/getpro/habr/post_images/b9d/859/802/b9d859802ac587386527bf35683c0b63.png" width="519"><br><br>  In [4]: ‚Äã‚Äã= <br><br><img alt="2048-Game-In-Wolfram-Mathematica_4.png" height="203" src="https://habrastorage.org/getpro/habr/post_images/04a/c44/57c/04ac4457c0e571d76661c08bca9cdbed.png" width="518"><br><br>  Out [4] = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_5.png" height="18" src="https://habrastorage.org/getpro/habr/post_images/627/d95/8bc/627d958bc09e48aa52a85dd5cba3b13c.png" width="360"><br><br>  It is time to make our playing field a little more beautiful.  I can completely replicate the style of the original game by importing its CSS style (CSS ‚Äî Cascading Style Sheets, cascading style sheets).  As you can see, in CSS I was able to find the colors for the background and the text of all the chips. <br><br>  In [5]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_6.gif" height="548" src="https://habrastorage.org/getpro/habr/post_images/162/619/f77/162619f77e40856319429ccbe4ffcd56.gif" width="594"><br><br>  Out [8] = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_7.png" height="249" src="https://habrastorage.org/getpro/habr/post_images/3e1/50b/574/3e150b57499a5b831599461a55d190f2.png" width="447"><br><br>  Now I have a list containing each chip number and its corresponding colors!  Next, I can process it by creating a function to search for color and translate it from HEX (hexadecimal color used in CSS) to RGB (a color model based on a combination of red, green, and blue).  I also define colors for the rest of the playing field and, just in case, for some colors by default. <br><br>  In [9]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_8.png" height="88" src="https://habrastorage.org/getpro/habr/post_images/b26/2ad/d81/b262add815d141e3c13b814bff71bd6d.png" width="600"><br><br>  In [10]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_9.gif" height="180" src="https://habrastorage.org/getpro/habr/post_images/2a0/985/f66/2a0985f66c38acddbb81b1382694c8f7.gif" width="607"><br><br>  In [13]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_10.gif" height="65" src="https://habrastorage.org/getpro/habr/post_images/173/49d/b4a/17349db4a36a1cb8ed1d359b7fad693c.gif" width="570"><br><br>  Now I use color information to write the function that draws the chips.  You need to be careful and make the font size smaller when the number of digits in the number grows. <br><br>  In [15]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_11.png" height="65" src="https://habrastorage.org/getpro/habr/post_images/d6f/40a/44a/d6f40a44a2d5a3bfab3088c95b33cfa9.png" width="579"><br><br>  In [16]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_12.png" height="180" src="https://habrastorage.org/getpro/habr/post_images/ca8/ba0/f1c/ca8ba0f1cc47f1d9df05e1ccbcaa7d66.png" width="528"><br><br>  In [17]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_13.png" height="18" src="https://habrastorage.org/getpro/habr/post_images/178/156/888/178156888751f503078ee9f006c356dc.png" width="260"><br><br>  I defined the drawTile function so that it can be easily changed later ... <br><br>  In [18]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_14.png" height="18" src="https://habrastorage.org/getpro/habr/post_images/ca5/887/4f4/ca58874f423bbd0fb6b1812402e7a56b.png" width="609"><br><br>  Out [18] = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_15.gif" height="227" src="https://habrastorage.org/getpro/habr/post_images/fce/705/a37/fce705a37da5540adabe2e843f33dd8f.gif" width="600"><br><br>  To apply this style to the original playing field, I simply consider each element of the playing field in the matrix and place the corresponding chip in the right place. <br><br>  In [19]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_16.png" height="111" src="https://habrastorage.org/getpro/habr/post_images/0fc/39f/213/0fc39f2138abfd5e3ae4864932d2bcc6.png" width="492"><br><br>  In [20]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_17.png" height="203" src="https://habrastorage.org/getpro/habr/post_images/2d3/023/4f5/2d30234f5dbf90edaf10eb1b913c0af6.png" width="458"><br><br>  Out [20] = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_18.gif" height="474" src="https://habrastorage.org/getpro/habr/post_images/03f/e07/ca0/03fe07ca04c044c7b98fb7fcb84d0cfb.gif" width="472"><br><br>  Looks beautiful!  Now we need to learn how to control the game. <br><br>  When one of the keys is pressed, I want all the pieces to move along the board in the indicated direction as far as possible, and the same pieces should be combined.  I can use the <a href="http://reference.wolfram.com/mathematica/ref/NotebookEventActions.html">NotebookEventActions</a> option to register keystrokes and respond accordingly.  I will make the control be carried out with the wasd keys, you can choose any others: <br><br>  In [21]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_19.png" height="88" src="https://habrastorage.org/getpro/habr/post_images/697/7df/9e4/6977df9e4c55d4f5a7388a14d8ded6db.png" width="383"><br><br>  In [22]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_20.png" height="88" src="https://habrastorage.org/getpro/habr/post_images/7a0/e2a/fbd/7a0e2afbd40a45f89c0920b784f50861.png" width="382"><br><br>  Now let's think about what happens when the chips move, say, to the left.  First of all, I need to implement the union of identical chips.  Each line should be considered separately, since with a horizontal offset, vertical matches are not combined.  I want to find sequences of two identical numbers, perhaps with empty cells between them, and replace them with the sum.  Here the power of the Wolfram Language comes to the rescue, and I can use the mapping to a given patterned expression to make it easy. <br><br>  In [23]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_21.png" height="65" src="https://habrastorage.org/getpro/habr/post_images/f84/70d/acc/f8470daccd45d6d7bd1b18599c8ea389.png" width="535"><br><br>  After adding the same chips, all I have to do is add a few empty elements to the right to fill the line.  The procedure is repeated for all lines of the playing field. <br><br>  In [24]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_22.png" height="42" src="https://habrastorage.org/getpro/habr/post_images/7ff/ac7/f17/7ffac7f1703ba25161dff6c038eabe94.png" width="594"><br><br>  The right shift is performed in the same way, with one minor change - I want the combinations of identical chips on the right to unite before the combinations to the left.  Consider the string {$ empty, 2, 2, 2} as an example.  Using the combineLeft function and clicking the left arrow, I get the string {$ empty, $ empty, 4, 2}, but in fact I want the right pair of twos to first merge.  Reversing the line, shifting the cells to the left and reverse flip easily solve the problem. <br><br>  In [25]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_23.png" height="18" src="https://habrastorage.org/getpro/habr/post_images/b51/a27/9bc/b51a279bc822d69a8f7a162d52132f07.png" width="550"><br><br>  In [26]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_24.png" height="42" src="https://habrastorage.org/getpro/habr/post_images/30a/f34/603/30af34603697427d6b693c4850dff014.png" width="594"><br><br>  Now that we have these two functions, it‚Äôs very easy to shift up and down!  A shift up is the same as a left shift in a transposed playing field, followed by reverse transposition.  Shifting operations to the right and down are also related. <br><br>  In [27]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_25.gif" height="111" src="https://habrastorage.org/getpro/habr/post_images/361/efb/644/361efb644471fd497c75e8d96b2fa2d8.gif" width="460"><br><br>  If the key is pressed, new chips on the field should be added only if the state of the field has changed, that is, if some of the chips have moved or merged.  To do this, you need to track the previous state of the playing field. <br><br>  Now we will learn how to keep counting points during the game.  Every time when two chips are combined, I collect their sum by the <a href="http://reference.wolfram.com/mathematica/ref/Sow.html">Sow</a> function, and then I use the <a href="http://reference.wolfram.com/mathematica/ref/Reap.html%3Fq%3DReap%26amp%3Bamp%3Blang%3Den">Reap</a> function on all the amounts, when all possible unions are completed.  I also derive the value of the highest received at the moment chips. <br><br>  In [29]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_26.png" height="88" src="https://habrastorage.org/getpro/habr/post_images/a19/1a0/36b/a191a036b670c36976e7170fbbfcc327.png" width="501"><br><br>  Finally, let's add a win and lose test.  A game is considered to be won if the largest chip on the field is 2048 or higher.  I lost if the board is full and I no longer have possible moves.  In this case, I can again use the pattern expression language to determine if possible combinations of chips remain on the board. <br><br>  In [30]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_27.png" height="88" src="https://habrastorage.org/getpro/habr/post_images/82f/6dd/4b8/82f6dd4b8f55b3fbdb328fa7d743b2d2.png" width="592"><br><br>  In [31]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_28.png" height="42" src="https://habrastorage.org/getpro/habr/post_images/f8d/609/e03/f8d609e0381cc87bb69681399a18b76f.png" width="486"><br><br>  Using the <a href="http://reference.wolfram.com/mathematica/ref/Dynamic.html%3Fq%3DDynamic%26amp%3Bamp%3Blang%3Den">Dynamic</a> function, I can maintain the displayed playing field in full accordance with the changes made.  In addition, I can surround this with the <a href="http://reference.wolfram.com/mathematica/ref/DynamicModule.html%3Fq%3DDynamicModule%26amp%3Bamp%3Blang%3Den">DynamicModule</a> function and use <a href="http://reference.wolfram.com/mathematica/ref/Initialization.html%3Fq%3DInitialization%26amp%3Bamp%3Blang%3Den">Initialization</a> to customize the keystroke processing and the playing field.  By placing the DynamicModule inside <a href="http://reference.wolfram.com/mathematica/ref/CreateDialog.html">CreateDialog</a> we can open the game in a separate window. <br><br>  Finally, the game is completely ready. <br><br>  In [32]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_31.png" height="1399" src="https://habrastorage.org/getpro/habr/post_images/e49/f9a/0f2/e49f9a0f2c44fea1f874adc6bce4b429.png" width="624"><br><br><img alt="2048-Game-In-Wolfram-Mathematica_32.gif" height="375" src="https://habrastorage.org/getpro/habr/post_images/d0a/885/dd2/d0a885dd251215446270bd28ea1f4208.gif" width="549"><br><br>  Now everything looks quite nice, but at Wolfram Research we love something more ... pointy.  Such as Spikey - logos of different versions of Mathematica and Wolfram | Alpha.  Let's change the colors of the chips and their shape. <br><br>  In [33]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_33.gif" height="340" src="https://habrastorage.org/getpro/habr/post_images/610/888/a35/610888a3526b427d004781034b56793c.gif" width="582"><br><br>  In [34]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_34.png" height="111" src="https://habrastorage.org/getpro/habr/post_images/4b5/c43/54b/4b5c4354b00730ff4879cdbedc4ed663.png" width="507"><br><br>  Out [34] = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_35.gif" height="341" src="https://habrastorage.org/getpro/habr/post_images/b65/e1c/ae1/b65e1cae14b1658f2b76d28d3a019166.gif" width="452"><br><br>  In [35]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_36.png" height="88" src="https://habrastorage.org/getpro/habr/post_images/2ce/a30/fd2/2cea30fd2008ff2e8538342a912ef209.png" width="579"><br><br>  In [36]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_37.png" height="42" src="https://habrastorage.org/getpro/habr/post_images/cfe/eb4/3cd/cfeeb43cdb84b8e3f07a9c4e4255f2aa.png" width="488"><br><br>  In [37]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_38.gif" height="42" src="https://habrastorage.org/getpro/habr/post_images/f7d/d7b/25a/f7dd7b25a2e10a6c7b92d0b82f7de846.gif" width="426"><br><br>  In [39]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_39.png" height="18" src="https://habrastorage.org/getpro/habr/post_images/6b5/56a/add/6b556aadd7f080231a779a5d80f6b582.png" width="261"><br><br>  Now we can switch between the two styles with the buttons. <br><br>  In [40]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_40.png" height="180" src="https://habrastorage.org/getpro/habr/post_images/4e5/a9f/2b2/4e5a9f2b26170a5dc61a4f64fbc44708.png" width="612"><br><br>  Out [40] = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_41.png" height="27" src="https://habrastorage.org/getpro/habr/post_images/45b/bad/abf/45bbadabfca90456fc7eef3090f9218c.png" width="209"><br><br>  In [41]: = <br><br><img alt="2048-Game-In-Wolfram-Mathematica_42.png" height="1606" src="https://habrastorage.org/getpro/habr/post_images/5aa/f2f/8a3/5aaf2f8a3a91ca6d5f86080ce037d762.png" width="624"><br><br><img alt="2048-Game-In-Wolfram-Mathematica_43.gif" height="375" src="https://habrastorage.org/getpro/habr/post_images/057/5ce/f19/0575cef19f2568bbfda8ba8aa2bd8457.gif" width="549"><br><br>  Good luck to you game! </div><p>Source: <a href="https://habr.com/ru/post/223345/">https://habr.com/ru/post/223345/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../223335/index.html">Visual Website Optimizer - split testing of the landing page on the main domain and the third level domain</a></li>
<li><a href="../223337/index.html">Why gamers don't write about my game</a></li>
<li><a href="../223339/index.html">Google goes to Krasnoyarsk</a></li>
<li><a href="../223341/index.html">Two-factor SMS authorization with young ladies and preference</a></li>
<li><a href="../223343/index.html">We analyze the tasks of the second qualifying round of the Russian Code Cup 2014</a></li>
<li><a href="../223347/index.html">Mobile travel apps</a></li>
<li><a href="../223349/index.html">Python Meetup: April Meeting</a></li>
<li><a href="../223351/index.html">And systemd embraced me to the depths of my distribution</a></li>
<li><a href="../223355/index.html">SQA Days 15 "the most sociable testers conference" died down</a></li>
<li><a href="../223357/index.html">Mini CRT monitor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>