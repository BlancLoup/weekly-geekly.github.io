<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dynamic (non-linear) GUI testing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What? 
 Perform actions on GUI elements in random order. 

 What is it for? 
 The person performing the testing is Homo sapiens, i.e. he has some inte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dynamic (non-linear) GUI testing</h1><div class="post__text post__text-html js-mediator-article"><h5>  What? </h5><br>  Perform actions on GUI elements in random order. <br><br><h5>  What is it for? </h5><br>  The person performing the testing is Homo sapiens, i.e.  he has some intelligence.  This very intellect prevents (very rarely, but prevents) applications to find ‚Äúabsurdities of behavior‚Äù associated with unforeseen situations.  He simply cannot imagine such an illogical situation. <br>  The user is much higher than QA in quantity and may be significantly inferior to him in IQ.  Hence, the probability of unexpected user behavior is by no means extremely small. <br>  So, what to us, possessing free resources and desire, prevents to take measures on prevention of similar situations?  - Nothing. <br>  Now we will formulate specific tasks in which ‚Äúmeaningless clicking‚Äù on buttons can be useful: <br><ul><li>  Supplement existing application stability testing by introducing a non-linear user behavior model into the GUI. </li><li>  Investigate the consumption of resources for all possible variants of the application (initiated from the GUI). </li></ul><br>  First, the test variant described in this article should be used, indeed, only as an addition to the existing GUI testing.  To rely only on the chaotic "clatter" on the buttons is at least silly.  There is no check what exactly is happening and whether it is happening at all.  Therefore, the first option can be considered as additional negative stability testing. <br>  The second is the most effective on an infinite length of time, which is often impossible.  Therefore, choosing the measurement period, one should proceed from the complexity of the application, its type and purpose.  For example, it probably makes no sense to drive a ‚Äúnon-server‚Äù application for 24 hours, consisting of two buttons and one check box, which multiplies something by two, and then the result is halved. <br><br><h5>  How do we do? </h5><br>  The following description is intended for testing applications on the Windows platform. <br>  I suggest to use the python + pywinauto bundle.  Although <a href="http://sourceforge.net/projects/pywinauto/">pywinauto</a> has some limitations in terms of access to window elements, for most cases this should be enough. <br>  Frankly, I do not see an alternative.  All the GUI testing automation tools I know do not have the dynamism shown below - already during the execution of the test, we receive a list of controls, determine their type and perform a valid action. <br>  Also, do not underestimate the capabilities of the Python itself and its modules.  Here you can remove the video, measure the CPU and send the message to the right place, in which case send it <br><a name="habracut"></a><br><h5>  What do we need? </h5><br><ul><li>  Python 2.7 <a href="http://python.org/getit/">http://python.org/getit/</a> </li><li>  pywinauto <a href="http://sourceforge.net/projects/pywinauto/">http://sourceforge.net/projects/pywinauto/</a> </li><li>  virtual machine (to taste) </li></ul><br>  I also recommend using the <a href="http://code.google.com/p/swapy/">SWAPY</a> utility, with its help it is convenient to look at the properties of the controls, it also generates code for pywinauto.  It can also be used to check whether pywinauto controls for your application or not. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Test specification </h5><br><ol><li>  Launch the application window. </li><li>  Click on the available control (close the window). </li><li>  Check the fail criteria. </li><li>  Repeat steps 1 - 3 for the specified time. </li><li>  At the end of this time, consider the test passed. </li></ol><br>  Fail criteria - the condition under which the test is considered failed.  For example, if the Crash report window is running, the Internet is not pinged, etc.  The test is also considered to be failed in any event (unforeseen situation). <br><br><h5>  Underwater rocks </h5><br><ul><li>  Sometimes the window needs to be closed. <br>  Example: a child window does not have a button that closes it and returns focus to the parent window. </li><li>  The window can not process Close - do not fail the test. <br>  Example: a dialog box with OK and Cancel buttons only. </li><li>  Pywinauto may not see the controls on the window. <br>  Here we will not do anything - we are looking for another bundle.  Check through <a href="http://code.google.com/p/swapy/">SWAPY</a> or through <pre><code class="python hljs">pywinauto.application.WindowSpecification.PrintControlIdentifiers</code> </pre> </li></ul><br><h5>  Code </h5><br>  According to the specification: <br><ol><li>  Run the binary, wait for the main window to appear: <br><pre> <code class="python hljs">pywinauto.application.Application().start_(binary_path) pywinauto.timings.WaitUntil(WAIT_TIMEOUT, CHECK_INTERVAL, _check_window)</code> </pre> <br></li><li>  Using <code>enabled_and_visible()</code> we get a list of available controls.  Randomly select which element to click or close the window: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ready_contr_list <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>,len(ready_contr_list)): control = random.choice(ready_contr_list) print(<span class="hljs-string"><span class="hljs-string">'Click on - "%s"'</span></span> % control.Texts()[<span class="hljs-number"><span class="hljs-number">0</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'unicode-escape'</span></span>, <span class="hljs-string"><span class="hljs-string">'replace'</span></span>)) highlight_control(control) control.Click() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: window.Close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print(<span class="hljs-string"><span class="hljs-string">'Close window'</span></span>)</code> </pre><br></li><li>  Fail criteria.  Nothing came to mind.  Put the stub: <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>==<span class="hljs-number"><span class="hljs-number">0</span></span>: print(<span class="hljs-string"><span class="hljs-string">''</span></span>) result = TEST_FAILED <span class="hljs-keyword"><span class="hljs-keyword">break</span></span></code> </pre> <br></li></ol><br>  Full text below.  I would like to note a few points: <br><ol><li>  <code>make_action</code> is only able to send a single left click signal to a control (or close the window).  If the topic is interesting, it will be possible to complicate the logic. </li><li>  <code>highlight_control</code> highlights the active control.  Just beautiful. </li><li>  To run the script you will need to specify: <br><ul><li>  The path to the executable file.  You can with the parameters: <br> <code>BINARY_PATH = r'"C:\path\app.exe" ‚Äìparams 1 2 3'</code> </li> <li>  Regular for the header of the main window: <br> <code>TITLE_RE = 'My app - .*'</code> </li> <li>  The class of the main window.  We look in <a href="http://code.google.com/p/swapy/">SWAPY</a> : <br> <code>CLASS_NAME = '#32770'</code> </li> </ul><br></li></ol><br><h5>  Result </h5><br>  Tested a native Windows RDP client. <br>  Literally in an hour, I managed to catch the crash of the RDP client.  Success?  - Maybe.  Manually failed to repeat. <br>  However, no one has yet canceled the dumps, so an autopsy will show ... <br><br>  The full text of the script: <br><habracut><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pywinauto <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> thread <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-string"><span class="hljs-string">''' GUI dynamic testing '''</span></span> TEST_FAILED = <span class="hljs-number"><span class="hljs-number">1</span></span> TEST_PASSED = <span class="hljs-number"><span class="hljs-number">0</span></span> TEST_EXEC_TIME = <span class="hljs-number"><span class="hljs-number">60</span></span> * <span class="hljs-number"><span class="hljs-number">60</span></span> WAIT_TIMEOUT = <span class="hljs-number"><span class="hljs-number">30</span></span> CHECK_INTERVAL = <span class="hljs-number"><span class="hljs-number">0.2</span></span> BINARY_PATH = <span class="hljs-string"><span class="hljs-string">r'"C:\WINDOWS\system32\mstsc.exe"'</span></span> TITLE_RE = <span class="hljs-string"><span class="hljs-string">'Remote Desktop Connection'</span></span> CLASS_NAME = <span class="hljs-string"><span class="hljs-string">'#32770'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_check_window</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' Check window is opened '''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: pywinauto.findwindows.find_windows(title_re=TITLE_RE, class_name=CLASS_NAME)[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_binary</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(binary_path)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' Start a binary, wait for window opens '''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> _check_window(): pywinauto.application.Application().start_(binary_path) pywinauto.timings.WaitUntil(WAIT_TIMEOUT, CHECK_INTERVAL, _check_window) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_top_window</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(title_re, class_name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' Return the top window of the binary '''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> _check_window(): start_binary(BINARY_PATH) app = pywinauto.application.Application() <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: app.Connect_(title_re=TITLE_RE, class_name=CLASS_NAME) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> pywinauto.findwindows.WindowAmbiguousError: app.Connect_(title_re=TITLE_RE, class_name=CLASS_NAME, active_only=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> app.top_window_() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enabled_and_visible</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(all_conrt_list)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' Return list of ready for action controls '''</span></span> ready_contr_list = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> contr <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> all_conrt_list: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> contr.IsEnabled() <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> contr.IsVisible(): ready_contr_list.append(contr) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ready_contr_list <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">highlight_control</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(control)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' Highlight control '''</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_highlight_control</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(control, repeat = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> repeat &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>: repeat -= <span class="hljs-number"><span class="hljs-number">1</span></span> control.DrawOutline(thickness=<span class="hljs-number"><span class="hljs-number">1</span></span>) time.sleep(<span class="hljs-number"><span class="hljs-number">0.7</span></span>) control.DrawOutline(colour=<span class="hljs-number"><span class="hljs-number">0xffffff</span></span>, thickness=<span class="hljs-number"><span class="hljs-number">1</span></span>) time.sleep(<span class="hljs-number"><span class="hljs-number">0.4</span></span>) thread.start_new_thread(_highlight_control,(control,<span class="hljs-number"><span class="hljs-number">3</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">make_action</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(window)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' Make action on a control or close a window '''</span></span> all_conrt_list = window.Children() ready_contr_list = enabled_and_visible(all_conrt_list) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ready_contr_list <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>,len(ready_contr_list)): control = random.choice(ready_contr_list) print(<span class="hljs-string"><span class="hljs-string">'Click on - "%s"'</span></span> % control.Texts()[<span class="hljs-number"><span class="hljs-number">0</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'unicode-escape'</span></span>, <span class="hljs-string"><span class="hljs-string">'replace'</span></span>)) highlight_control(control) control.Click() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: window.Close() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print(<span class="hljs-string"><span class="hljs-string">'Close window'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">''' main section '''</span></span> start_time = time.time() result = <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-comment"><span class="hljs-comment">#start testig build start_binary(BINARY_PATH) #testing cycle while (time.time() - start_time) &lt; TEST_EXEC_TIME: #get top window window = get_top_window(TITLE_RE, CLASS_NAME) #make an action make_action(window) #check fail criteria if 1==0: print('') result = TEST_FAILED break else: result = TEST_PASSED print('Test passed') except Exception, e: result = TEST_FAILED print('Test failed.\n Exception %s' % e) sys.exit(result) if __name__ == '__main__': main()</span></span></code> </pre> </habracut></div><p>Source: <a href="https://habr.com/ru/post/138963/">https://habr.com/ru/post/138963/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138958/index.html">Trojan.Tenagour.9 helps attackers in DDoS attacks</a></li>
<li><a href="../138959/index.html">If we want replicable science, the program code must be open.</a></li>
<li><a href="../13896/index.html">Social bookmarking service Delicious is preparing a new version</a></li>
<li><a href="../138960/index.html">Unusual WebKit bug with CSS selector</a></li>
<li><a href="../138962/index.html">Simple audio DAC with USB connection (sound card)</a></li>
<li><a href="../138964/index.html">‚ÄúAnatomy of anonymous attacks‚Äù - how does Anonymous work?</a></li>
<li><a href="../138965/index.html">Preview of 2 smartphones of a new line - Sony Xperia P and Sony Xperia U</a></li>
<li><a href="../138967/index.html">We collect your Bluetooth machine running on Android</a></li>
<li><a href="../138968/index.html">Greeting</a></li>
<li><a href="../13897/index.html">Web office goes to corporate level</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>