<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Let's beat Ruby together! Drop eleventh</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Another drop in our glass is Ruby ( 1 , 2 , 3 , 4 , 5 , 6 , 7 , 8 , 9 , 10 ). Let's talk about self , working with CSV and exception handling. 

 When...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Let's beat Ruby together! Drop eleventh</h1><div class="post__text post__text-html js-mediator-article"> Another drop in our glass is Ruby ( <a href="http://habrahabr.ru/blogs/starting_programming/48559/">1</a> , <a href="http://habrahabr.ru/blogs/starting_programming/48607/">2</a> , <a href="http://habrahabr.ru/blogs/starting_programming/48667/">3</a> , <a href="http://habrahabr.ru/blogs/starting_programming/48756/">4</a> , <a href="http://habrahabr.ru/blogs/starting_programming/48859/">5</a> , <a href="http://habrahabr.ru/blogs/starting_programming/48961/">6</a> , <a href="http://habrahabr.ru/blogs/starting_programming/49013/">7</a> , <a href="http://habrahabr.ru/blogs/starting_programming/49149/">8</a> , <a href="http://habrahabr.ru/blogs/starting_programming/49353/">9</a> , <a href="http://habrahabr.ru/blogs/starting_programming/49418/">10</a> ).  Let's talk about <code>self</code> , working with CSV and exception handling. <br><br>  When describing and discussing computer programs, we often use figurative and human metaphors.  For example, we say that we are in a class or returning from a method call.  Sometimes it makes sense to speak in the second person, for example, <code>object.respond_to?("x")</code> : ‚ÄúHey, object, will you answer <code></code> ?  And while the program is interpreted, the context changes again and again. <br><br>  Some objects always mean the same thing, for example, numbers and keywords like <code>def</code> and <code>class</code> .  However, the meaning of most elements depends on the context. <br><a name="habracut"></a><br><h4>  self and current object </h4><br>  One of Ruby's cornerstones is the current object, accessible via the <code>self</code> keyword.  At each moment of the program there is only one <code>self</code> , this object can be recognized using several rules.  First of all, you need to know the context, its types are few, here they are: the top level, the class definition blocks, the module definition blocks, and the method definition blocks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The highest level refers to code written outside of any classes or modules.  For example, if we open a new <code>.rb</code> file and write only <code>x=1</code> , then we will create a top-level local variable <code></code> .  If we write <blockquote> <code><font color="blue">def</font> <font color="#4e009b">m <br></font> <font color="blue">end</font></code> </blockquote> <br>  then we get the top level method.  At the highest level, Ruby provides us with a start (start up) <code>self</code> and, in an attempt to identify it, will return <code>main</code> .  <code>main</code> is a special term that uses the <code>self</code> object by default when referring to itself. <br><br>  In the definition of a class or <code>self</code> module - the object of the class itself, here's a demo: <blockquote> <code><font color="blue">class</font> <font color="#0000bb">C <br></font> puts <font color="maroon">"Started class C:" <br></font> puts <font color="blue">self</font> <font color="green"># C <br></font> <font color="blue">module</font> <font color="#5c5c5c">M <br></font> puts <font color="maroon">"Module C::M:" <br></font> puts <font color="blue">self</font> <font color="green"># C::M <br></font> <font color="blue">end <br></font> puts <font color="maroon">"Back C:" <br></font> puts <font color="blue">self</font> <font color="green"># C <br></font> <font color="blue">end</font></code> </blockquote>  <code>self</code> inside the definition of the instance method is tricky, and that's the point.  When the interpreter reads the <code>def/end</code> block, it determines the method immediately.  However, the code inside the method is executed only when it is called by the object, which will be <code>self</code> for this method. <br><br>  Here is a small summary of the <code>self</code> behavior: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/42b/8cc/892/42b8cc8924b6ed98ddbf84f8809bc818.png" alt="image"><br><br><h4>  Db in .txt </h4><br>  Many applications need to store and manipulate data.  Sometimes files are opened for this, necessary changes are made and the result is displayed on the screen or saved back to a file.  In some situations, however, a database is required.  A database is a system for organizing and storing data on a computer in a systematic way.  The database can be simple as a text file that is manipulated by the program itself or complex, for example, it can consist of terrabytes of data distributed on dedicated servers.  By the way, Ruby can be used in this case too, but we will consider the variant with the simplest database. <br><br>  The database can be a simple text file, as in the case of CSV (Comma-Separated Values), where for each data item you can store attributes separated by commas.  Let's create a file <code>db.txt</code> , in which we write the CSV data, for example, such: <br><br><blockquote> <code>Fred Bloggs,Manager,Male,45 <br> Laura Smith,Cook,Female,23 <br> Debbie Watts,Professor,Female,38</code> </blockquote> <br>  Each line is a separate person and each attribute is separated by commas. <br><br>  Ruby contains the standard cvs library, which allows text files containing CSV data to be used as a simple database that is easy to manipulate.  The library contains a class CSV, which will help us in our work.  Load the data from the CVS file into the array using the <code>read</code> method of the CSV class and read and change that thread from the array: <blockquote> <code>require <font color="maroon">'csv' <br></font> a= <font color="gray">CSV</font> . <font color="#8f20ff">read</font> <font color="gray">(</font> <font color="maroon">'db.txt'</font> <font color="gray">) <br></font> puts a. <font color="#8f20ff">inspect <br></font> puts a <font color="gray">[</font> 0 <font color="gray">][</font> 0 <font color="gray">]</font> <font color="green"># Fred Bloggs <br></font> puts a <font color="gray">[</font> 1 <font color="gray">][</font> 0 <font color="gray">]</font> <font color="green"># Laura Smith <br></font> puts a <font color="gray">[</font> 2 <font color="gray">][</font> 0 <font color="gray">]</font> <font color="green"># Debbie Watts <br></font> a <font color="gray">[</font> 1 <font color="gray">][</font> 1 <font color="gray">]</font> = <font color="maroon">"Marine" <br></font> p <font color="gray">(</font> a <font color="gray">[</font> 1 <font color="gray">])</font> <font color="green"># ["Laura Smith", "Marine", "Female", "23"]</font></code> </blockquote> <br>  Now that we have the data we need, we need to save the CSV back, the csv module will do everything for us: <blockquote> <code><font color="gray">CSV</font> . <font color="#8f20ff">open</font> <font color="gray">(</font> <font color="maroon">'bd.txt'</font> , <font color="maroon">'w'</font> <font color="gray">)</font> <font color="blue">do</font> |csv| <br> a. <font color="#8f20ff">each</font> <font color="blue">do</font> |a| <br> csv &lt;&lt; a <br> <font color="blue">end <br> end</font></code> </blockquote> <br><br><h4>  Exceptions </h4><br>  In any program, there are moments when things are not going the right way: people enter incorrect data, files that you rely on do not exist (or you do not have access rights to them), memory runs out, etc. There are several ways out of similar situations.  The easiest way to exit the program is when something wrong happened. <br><br>  A less radical solution is that each method must return something like status data that indicates whether the processing was successful, and then you need to test the data from the method.  However, testing each result will make the code poorly readable. <br><br>  Another alternative approach is to use exceptions.  When something goes wrong (i.e. an exception condition appears), exceptions are thrown.  At a high level, the program will have a piece of code (exception handler), which will monitor the appearance of such a signal and respond to it in a certain way. <br><br>  Also in one program there can be many exception handlers, each of which handles certain types of errors.  An exception passes through all the handlers until it meets the required one, if it does not exist, the program closes.  This behavior is in C ++, Java and Ruby. <br><br>  Imagine a text editor.  The user must enter the name in the <code>SaveAs</code> dialog and click <code></code> .  Since the user himself decides what data to enter, we can not know whether he has the right to write this file, whether there is free space on the disk.  We will use exceptions: <blockquote> <code>text = editor <font color="gray">() <br></font> location = ask_user <font color="gray">() <br></font> <font color="blue">begin <br></font> <font color="gray">File</font> . <font color="#8f20ff">open</font> <font color="gray">(</font> location, w <font color="gray">)</font> <font color="blue">do</font> |file| <br> save_work <font color="gray">(</font> file, text <font color="gray">) <br></font> <font color="blue">end <br> rescue <br></font> puts <font color="maroon">"  . : #{$!}" <br></font> <font color="blue">end</font></code> </blockquote> <br>  Now if something goes wrong, the program will not complete the work, the data will not be lost and we will have a second chance.  Everything between <code>begin</code> and <code>rescue</code> is protected.  If an exception occurs, control is transferred to the block between the <code>rescue</code> and <code>end</code> .  Global variable <code>$!</code>  sends an error message and it is displayed on the screen.  In order to control only certain types of exceptions, we write out from in <code>rescue</code> .  For example, to handle only errors when writing a file, use the expression <code>rescue IOError</code> .  If we want to catch several types of exceptions in one handler, then we list them separated by commas, or (which is more convenient) to write a handler for each type: <blockquote> <code><font color="blue">rescue</font> <font color="gray">IOError <br></font> puts      -- $!. <br> <font color="blue">rescue</font> <font color="gray">SystemCallError <br></font> puts     -- $!. <br> <font color="blue">end</font></code> </blockquote> <br><br><h4>  Epilogue </h4><br>  Yes, I do not forget about pure Ruby and as far as possible and necessary I will continue to write.  Maybe the pieces are jerky, but I am writing what is of interest at the moment - I hope you will like it too.  As always - waiting for comments! </div><p>Source: <a href="https://habr.com/ru/post/50151/">https://habr.com/ru/post/50151/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../50142/index.html">Experienced marketers</a></li>
<li><a href="../50143/index.html">Gentoo + drbd + ocfs2</a></li>
<li><a href="../50147/index.html">HTTP request types and REST philosophy</a></li>
<li><a href="../50148/index.html">25 most dangerous mistakes in programming</a></li>
<li><a href="../50149/index.html">ABBYY released a specific developer toolkit for the Android platform</a></li>
<li><a href="../50152/index.html">Script for recursive directory comparison</a></li>
<li><a href="../50153/index.html">Legend of the Black Point</a></li>
<li><a href="../50155/index.html">Increasing the speed of SQL queries</a></li>
<li><a href="../50157/index.html">rails scaffold news - how?</a></li>
<li><a href="../50158/index.html">Parser math expressions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>