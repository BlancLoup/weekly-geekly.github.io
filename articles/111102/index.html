<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Learning to cook: Spring 3 MVC + Spring Security + Hibernate</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! My name is Anton Shchastny. 

 This is my next article on the development of web applications in Java. I want to suggest that you make a sma...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Learning to cook: Spring 3 MVC + Spring Security + Hibernate</h1><div class="post__text post__text-html js-mediator-article">  Good day!  My name is Anton Shchastny. <br><br>  This is my next article on the development of web applications in Java.  I want to suggest that you make a small client accounting system, written using the Spring framework and the Hibernate library. <br><br><h3>  What will be in the application: </h3><br>  There will be a simple contact manager that allows you to add new entries to the database, view existing ones, delete unnecessary ones.  The information will be stored in a database.  Access to the application - via the web, with user authentication and authorization. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  What we will use: </h3><br><ul><li>  Spring MVC web framework </li><li>  Spring Security framework </li><li>  ORM library Hibernate, </li><li>  MySQL as a DBMS. </li></ul><br>  Infrastructure: <br><ul><li>  SpringSource Tool Suite editor </li><li>  Maven Project Collector, </li><li>  Log4j logging system </li><li>  permanent internet connection. </li></ul><br><br>  In my <a href="http://habrahabr.ru/blogs/java2ee/83860/">previous article on Spring MVC</a> , I missed a number of points about using annotations in Java code and using Maven to build a project.  In this article I tried to correct the omission. <br><br>  <i>The purpose of the article is to show beginner web developers how to use various technologies of the Java platform.</i> <br><br><a name="habracut"></a><br><h1>  Content </h1><br><ol><li>  Creating a new project in the IDE. </li><li>  Creating a package structure. </li><li>  Adding an entity class to a domain model. </li><li>  Data access layer </li><li>  Service layer </li><li>  Adding web. </li><li>  Controller. </li><li>  View. </li><li>  Application launch. </li><li>  Security. </li><li>  Conclusion </li></ol><br><br><img src="https://habrastorage.org/getpro/habr/post_images/647/324/2c8/6473242c8f6bc178b6586548cdeebda8.png" alt="Architecture of the developed application."><br>  Architecture of the developed application. <br><br><h1>  1. Creating a new project in the IDE </h1><br><br>  The project will be developed in the <a href="http://www.springsource.com/developer/sts">SpringSource Tool Suite</a> (STS) - a handy editor based on the Eclipse IDE. <br><br>  After installing the STS, create a template project: <br>  <i>File&gt; New&gt; Spring Template Project&gt; Spring MVC Project.</i> <br><br>  Project name: <i>ContactManager</i> <br>  Top level package: <i>net.schastny.contactmanager</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ab6/a57/aa1/ab6a57aa142814c22f492e539d8ec601.png" alt="Sts"><br><br>  The editor will create a template web project with basic settings, which has the following structure: <br><table border="1"><tbody><tr><td>  src / main / java </td><td>  Java classes of the application. </td></tr><tr><td>  src / main / resources </td><td>  All other files (resources) necessary for operation: for example, the <i>log4j.xml</i> logger settings file, the <i>META-INF</i> folder. </td></tr><tr><td>  src / test / java </td><td>  JUnit test folder. </td></tr><tr><td>  src / test / resources </td><td>  Folder of unit tests. </td></tr><tr><td>  src / main / webapp </td><td>  The folder in which the files of the web component of the contact manager are located: application deployment descriptor web.xml, xml files with the Spring framework settings, jsp pages. <br>  <i>Attention, static application resources: images, css, js-scripts are in the resources folder.</i> </td></tr><tr><td>  pom.xml </td><td>  The project settings file for Maven contains the project name and a list of project dependencies on third-party libraries. </td></tr></tbody></table><br><br>  Let's change in the project settings (pom.xml) the Spring version from <i>3.0.4.RELEASE</i> to <i>3.0.5.RELEASE</i> . <br><br>  Note: how to create Maven projects outside the IDE read <a href="http://habrahabr.ru/blogs/java/77382/">here</a> . <br><br><h1>  2. Creating package structure </h1><br><table border="1"><tbody><tr><td>  net.schastny.contactmanager.dao </td><td>  <b>Data access layer</b> <br>  In it we will place Data Access Objects - objects of data access. </td></tr><tr><td>  net.schastny.contactmanager.domain </td><td>  <b>Domain layer.</b> <br>  This is where the POJO-classes are located, which describe the entity-entities of the system.  In our case, this is the class Contact. </td></tr><tr><td>  net.schastny.contactmanager.service </td><td>  <b>Service layer of the application.</b> <br>  Contains interfaces that describe application functionality.  Also contains one or more practical implementations of these interfaces. </td></tr><tr><td>  net.schastny.contactmanager.web </td><td>  <b>Web layer application.</b> <br>  Here are the controller classes that describe the order of user interaction with the system through the web. </td></tr></tbody></table><br>  Note: the controller class created by the editor can be deleted. <br><br><h1>  3. Adding an entity class to the domain model </h1><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.schastny.contactmanager.domain; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.persistence.Column; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.persistence.Entity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.persistence.GeneratedValue; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.persistence.Id; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.persistence.Table; <span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(name = <span class="hljs-string"><span class="hljs-string">"CONTACTS"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Contact</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"ID"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Integer id; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"FIRSTNAME"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String firstname; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"LASTNAME"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String lastname; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"EMAIL"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String email; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"TELEPHONE"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String telephone; <span class="hljs-comment"><span class="hljs-comment">// Getters and setters }</span></span></code> </pre> <br>  Do not forget to add methods getters and setters for bean properties. <br><br>  Add the project dependencies to the <i>pom.xml</i> file.  Note that the class from the domain model will not depend on either Spring or Hibernate. <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>javax.persistence<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>persistence-api<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Explanation of annotations used. <br><table border="1"><tbody><tr><td> <code>@Entity</code> </td> <td>  A class represents an object to be stored for a long time. </td></tr><tr><td> <code>@Table(name = "CONTACTS")</code> </td> <td>  Class properties will be stored in the CONTACTS table. </td></tr><tr><td> <code>@Column(name = "FIRSTNAME")</code> </td> <td>  This property will be stored in the firstname column. </td></tr><tr><td> <code>@Id</code> </td> <td>  This field is unique for objects, that is, we will search for objects using it. </td></tr><tr><td> <code>@GeneratedValue</code> </td> <td>  The value of this field will not be assigned by us, but generated automatically. </td></tr></tbody></table><br><br><h1>  4. Data Access Layer </h1><br>  Interface and practical implementation of the object of data access. <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.schastny.contactmanager.dao; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.schastny.contactmanager.domain.Contact; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContactDAO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Contact contact)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;Contact&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">listContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer id)</span></span></span></span>; }</code> </pre><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.schastny.contactmanager.dao; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.schastny.contactmanager.domain.Contact; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.hibernate.SessionFactory; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Repository; <span class="hljs-meta"><span class="hljs-meta">@Repository</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContactDAOImpl</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContactDAO</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SessionFactory sessionFactory; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Contact contact)</span></span></span><span class="hljs-function"> </span></span>{ sessionFactory.getCurrentSession().save(contact); } <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>(<span class="hljs-string"><span class="hljs-string">"unchecked"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;Contact&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">listContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sessionFactory.getCurrentSession().createQuery(<span class="hljs-string"><span class="hljs-string">"from Contact"</span></span>) .list(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer id)</span></span></span><span class="hljs-function"> </span></span>{ Contact contact = (Contact) sessionFactory.getCurrentSession().load( Contact.class, id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">null</span></span> != contact) { sessionFactory.getCurrentSession().delete(contact); } } }</code> </pre><br>  Update the project dependencies in the <i>pom.xml</i> file.  Add Hiberneit. <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.hibernate<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>hibernate-core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.3.2.GA<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.hibernate<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>hibernate-annotations<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.3.1.GA<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.hibernate<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>hibernate-commons-annotations<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.3.0.ga<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Explanation of annotations used. <br><table border="1"><tbody><tr><td> <code>@Repository</code> </td> <td>  The summary shows that the class functions as a repository and requires a transparent translation of exceptions.  The advantage of exceptions translation is that the service layer will deal with the general hierarchy of exceptions from Spring (DataAccessException) regardless of the data access technologies used in the DAO layer. </td></tr><tr><td> <code>@Autowired</code> </td> <td>  Annotation allows you to automatically set the value of the SessionFactory field. </td></tr></tbody></table><br><br><h1>  5. Service layer </h1><br>  We describe the user interface with the system. <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.schastny.contactmanager.service; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.schastny.contactmanager.domain.Contact; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContactService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Contact contact)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;Contact&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">listContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer id)</span></span></span></span>; }</code> </pre><br>  The practical implementation of the service interface is the class ContactServiceImpl.java. <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.schastny.contactmanager.service; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Service; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.transaction.annotation.Transactional; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.schastny.contactmanager.dao.ContactDAO; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.schastny.contactmanager.domain.Contact; <span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContactServiceImpl</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContactService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ContactDAO contactDAO; <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Contact contact)</span></span></span><span class="hljs-function"> </span></span>{ contactDAO.addContact(contact); } <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;Contact&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">listContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> contactDAO.listContact(); } <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Integer id)</span></span></span><span class="hljs-function"> </span></span>{ contactDAO.removeContact(id); } }</code> </pre><br>  Update the project dependencies in the <i>pom.xml</i> file.  Add transaction support. <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-tx<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${org.springframework-version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-orm<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${org.springframework-version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Explanation of annotations used. <br><table border="1"><tbody><tr><td>  @Service </td><td>  We use this annotation to declare that this class represents a service ‚Äî a component of the service layer.  Service is a subtype of the @Component class.  Using this annotation will allow you to search for bin services automatically (see later in root-context.xml). </td></tr><tr><td>  @Transactional </td><td>  Before executing the method marked with this annotation, the transaction begins, after the method is executed, the transaction commits, and when thrown, RuntimeException is rolled back. </td></tr></tbody></table><br><br><h1>  6. Adding a web </h1><br>  Setting up a web application will start with the most important thing - with the darkness of xml-files.  In a large application it is very convenient to store various settings in different files. <br><br>  After the xml-spoilers, write a simple controller. <br><br>  Settings files can be found at the links below. <br><table border="1"><tbody><tr><td>  <a href="">web.xml</a> </td><td>  This is <b>the deployment descriptor</b> .  A file that describes the application deployment settings on the server. </td></tr><tr><td>  <a href="">spring / root-context.xml</a> </td><td>  <b>Root Context</b> .  The context of the entire application.  The beans described here will be available to all servlets and filters.  Also here you should describe the security and data access beans (in our configuration, they are in separate files). </td></tr><tr><td>  <a href="">spring / data.xml</a> </td><td>  The file with the settings of <b>resources for working with data</b> . </td></tr><tr><td>  spring / security.xml </td><td>  File with <b>security settings</b> . </td></tr><tr><td>  <a href="">spring / appServlet / servlet-context.xml</a> </td><td>  <b>DispatcherServlet Context</b> .  Defines single servlet and bean settings that are available only to this servlet. </td></tr><tr><td>  <a href="">spring / appServlet / controllers.xml</a> </td><td>  File with <b>controller</b> settings for this servlet. </td></tr></tbody></table><br><br>  spring / security.xml <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">beans:beans</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.springframework.org/schema/security"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:beans</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.springframework.org/schema/beans"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-3.0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">beans:beans</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Explanation of used bins. <br><table border="1"><tbody><tr><td>  messageSource </td><td>  Bean to ensure the internationalization of the application.  Below we will create the files <b>messages_en.properties</b> and <b>messages_ru.properties</b> with localized messages in Russian and English. </td></tr><tr><td>  propertyConfigurer </td><td>  To download the file with the database settings <b>jdbc.properties</b> . </td></tr><tr><td>  dataSource </td><td>  <b>Datasors</b> , used to connect to the database.  We provide the jdbc driver class, username, password, and other settings. </td></tr><tr><td>  sessionFactory </td><td>  This is a Hibernate configuration bin.  The <b>hibernate.cfg.xml</b> file will contain mappings for entity classes. </td></tr><tr><td>  transactionManager </td><td>  Bean set up <b>transaction manager</b> .  We use a transaction manager to manage application transactions. </td></tr></tbody></table><br>  Files: <br>  <a href="https://raw.github.com/schastny/habraposts/master/111102/messages_en.properties">/src/main/resources/messages_en.properties</a> <br>  <a href="https://raw.github.com/schastny/habraposts/master/111102/messages_ru.properties">/src/main/resources/messages_en.properties</a> <br>  <a href="">/src/main/resources/hibernate.cfg.xml</a> <br>  <a href="https://raw.github.com/schastny/habraposts/master/111102/jdbc.properties">WEB-INF / jdbc.properties</a> <br><br><h1>  7. Controller </h1><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> net.schastny.contactmanager.web; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.schastny.contactmanager.domain.Contact; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.schastny.contactmanager.service.ContactService; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.beans.factory.annotation.Autowired; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.stereotype.Controller; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.validation.BindingResult; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.ModelAttribute; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.PathVariable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestMapping; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.web.bind.annotation.RequestMethod; <span class="hljs-meta"><span class="hljs-meta">@Controller</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContactController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Autowired</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ContactService contactService; <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/index"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">listContacts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Map&lt;String, Object&gt; map)</span></span></span><span class="hljs-function"> </span></span>{ map.put(<span class="hljs-string"><span class="hljs-string">"contact"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Contact()); map.put(<span class="hljs-string"><span class="hljs-string">"contactList"</span></span>, contactService.listContact()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"contact"</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">home</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"redirect:/index"</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(value = <span class="hljs-string"><span class="hljs-string">"/add"</span></span>, method = RequestMethod.POST) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@ModelAttribute(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"contact"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Contact contact, BindingResult result) </span></span>{ contactService.addContact(contact); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"redirect:/index"</span></span>; } <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(<span class="hljs-string"><span class="hljs-string">"/delete/{contactId}"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">deleteContact</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@PathVariable(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"contactId"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> Integer contactId) </span></span>{ contactService.removeContact(contactId); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"redirect:/index"</span></span>; } }</code> </pre><br>  Explanation of annotations used. <br><table border="1"><tbody><tr><td>  @Controller </td><td>  The annotation is used to magically transform any java class into a controller class. <br>  This class is a component similar to a <i>regular servlet (HttpServlet)</i> (working with HttpServletRequest and HttpServletResponse objects), but with advanced application capabilities in MVC applications. </td></tr><tr><td>  @RequestMapping </td><td>  The annotation is used for mapping the URL address of the request to the specified method or class.  The request can be mapped both on the class method and on the whole class.  It is allowed to specify a specific HTTP method that will be processed (GET / POST), transfer request parameters. </td></tr><tr><td>  @ModelAttribute </td><td>  An annotation connecting the method parameter or the return value of the method with the model attribute that will be used when displaying a jsp page. </td></tr><tr><td>  @PathVariable </td><td>  An annotation that indicates that the method parameter must be associated with a variable from the url address. </td></tr></tbody></table><br><br><h1>  8. View </h1><br>  <a href="https://raw.github.com/schastny/habraposts/master/111102/contact.jsp">/src/main/webapp/WEB-INF/views/contact.jsp</a> <br><br><h1>  9. Run the application </h1><br>  Before starting the system, we need to do two more things: <br><br>  First, create <b>a database for the application</b> and the user for it in accordance with the settings of the <i>jdbc.properties</i> file: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USER</span></span> contactmanager@localhost <span class="hljs-keyword"><span class="hljs-keyword">identified</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-string"><span class="hljs-string">'1234'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">GRANT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">usage</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> *.* <span class="hljs-keyword"><span class="hljs-keyword">TO</span></span> contactmanager@localhost <span class="hljs-keyword"><span class="hljs-keyword">identified</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-string"><span class="hljs-string">'1234'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DATABASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXISTS</span></span> contactmanager; <span class="hljs-keyword"><span class="hljs-keyword">GRANT</span></span> ALL <span class="hljs-keyword"><span class="hljs-keyword">privileges</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> contactmanager.* <span class="hljs-keyword"><span class="hljs-keyword">TO</span></span> contactmanager@localhost; <span class="hljs-keyword"><span class="hljs-keyword">USE</span></span> contactmanager; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> CONTACTS ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> AUTO_INCREMENT, firstname <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>), lastname <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>), telephone <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>), email <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">30</span></span>), created <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOW</span></span>() );</code> </pre><br>  Second, update the dependencies in <i>pom.xml</i> . <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>mysql<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mysql-connector-java<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>5.1.6<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Now we run the application on the server: <i>ContactManager&gt; Run As&gt; Run on Server&gt; SpringSource tc Server Developer Edition v2.0</i> . <br><br><img src="https://raw.github.com/schastny/habraposts/master/111102/3.png"><br><br>  Open <a href="http://localhost:8080/ContactManager">http: // localhost: 8080 / ContactManager</a> in your browser. <br><br><img src="https://raw.github.com/schastny/habraposts/master/111102/4.png"><br><br>  Note: Check the encoding of the database, tables in the database, connections to the database, the project encoding in the editor, because instead of native Cyrillic letters in the browser, cracks may appear. <br><br>  To debug Hibernate's work, you can add the following line to the <i>src / main / resources / log4j.xml</i> file: <br><pre> <code class="xml hljs"> <span class="hljs-comment"><span class="hljs-comment">&lt;!--org.hibernate.SQL logger--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logger</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"org.hibernate"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">level</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"info"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">logger</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h1>  10. Security </h1><br>  Update the project dependencies in the <i>pom.xml</i> file.  Add Spring Security modules. <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework.security<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-security-web<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${org.springframework-version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework.security<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-security-config<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${org.springframework-version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework.security<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>spring-security-core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${org.springframework-version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Add a security filter to the <i>web.xml</i> that applies to the entire application. <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>springSecurityFilterChain<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-class</span></span></span><span class="hljs-tag">&gt;</span></span>org.springframework.web.filter.DelegatingFilterProxy<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>springSecurityFilterChain<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>/*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  For security reasons, the login page <i>should not be placed inside the WEB-INF folder</i> , so we will place it in the root of the web application - in the webapp folder. <br>  <a href="https://raw.github.com/schastny/habraposts/master/111102/login.jsp">webapp / login.jsp</a> <br><br>  In the same place we will place an error page 403: <a href="https://raw.github.com/schastny/habraposts/master/111102/error403.jsp">webapp / error403.jsp</a> <br><br>  Edit the security.xml file. <br>  <a href="">security.xml</a> <br><br><h4>  Explanation of the settings made in the security.xml file </h4><br>  We select in the application three groups of users (user roles): <br><ul><li>  anonymous user (ROLE_ANONYMOUS), </li><li>  just user (ROLE_USER), </li><li>  administrator (ROLE_ADMIN). </li></ul><br>  We delimit access to the application: <br><ul><li>  We make it possible to view contacts available to all categories of users. </li><li>  Add new contacts can only registered users. </li><li>  Only admin can delete entries. </li></ul><br><br><h4>  Where to store user data </h4><br>  You can directly in the configuration file, if they are few.  It is possible in the database, it is possible in the LDAP storage. <br><br>  An example of a record ( <i>security.xml</i> ) when using a database for storing passwords. <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication-manager</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication-provider</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">jdbc-user-service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-source-ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dataSource"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication-provider</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication-manager</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Explanation of some elements. <br><table border="1"><tbody><tr><td><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">remember-me</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> </td><td>  Multisession support.  After restarting the browser does not need to re-login. </td></tr><tr><td><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">anonymous</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">username</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"guest"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">granted-authority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ROLE_ANONYMOUS"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> </td><td>  Defining an anonymous user and endowing him with roles so that you can work with him as with an ordinary user of the application. </td></tr><tr><td><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password-encoder</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hash</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"md5"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> </td><td>  Storing passwords in encrypted form. <br>  In our application is not used. </td></tr></tbody></table><br><br><h1>  11. Conclusion </h1><br>  That's all!  It remains to fasten the design, ryushechki on jQuery ( <a href="http://anton.shevchuk.name/javascript/jquery-for-beginners/">article for beginners</a> ) and sell crafts for money.  But this, my dear readers, is another story. <br><br>  After performing all the manipulations, you should have the following project structure: <br><img src="https://habrastorage.org/getpro/habr/post_images/8dd/f6d/84c/8ddf6d84c099d1f480c0f006324b21a2.png" alt="image"><br><br>  I would be grateful for these errors and inaccuracies in the article. <br><br><h4>  Resources used: </h4><br>  1. Spring Recipes: Problem-Solution Approach, Second Edition, Gary Mak, Ken Sipe, Josh Long, Daniel Rubio. <br>  2. <a href="http://viralpatel.net/blogs/2010/11/spring3-mvc-hibernate-maven-tutorial-eclipse-example.html">Create Spring 3 MVC Hibernate 3 Example using Maven in Eclipse</a> , <br>  3. The Spring Framework Reference Documentation, <br>  4. <a href="https://src.springframework.org/svn/spring-samples/mvc-showcase/MasteringSpringMVC3.pdf">Mastering Spring MVC 3 by Keith Donald</a> . <br><br>  You can download the finished project <a href="">here</a> , and the database for the project <a href="">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/111102/">https://habr.com/ru/post/111102/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111089/index.html">Another way to manage event listeners</a></li>
<li><a href="../111090/index.html">Producers, copyright holders and Mosfilm are afraid of free licenses and trying to stop the "revolutionary" amendments to the Civil Code</a></li>
<li><a href="../111092/index.html">We update the message counter Vkontakte without reloading the page</a></li>
<li><a href="../111095/index.html">A little more about TDD and unit tests.</a></li>
<li><a href="../111100/index.html">Azure. Debugging applications on the 80th port</a></li>
<li><a href="../111103/index.html">Monoblock for the "difficult" user</a></li>
<li><a href="../111105/index.html">Development using the Model-View-ViewModel design pattern on the example of the Twitter client step by step</a></li>
<li><a href="../111106/index.html">OV-Chipkaart: contactless smart cards in the service of the community</a></li>
<li><a href="../111108/index.html">Browser usage statistics for December 2010 according to StatCounter</a></li>
<li><a href="../111109/index.html">How does Opera make money (aka most frequently asked question)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>