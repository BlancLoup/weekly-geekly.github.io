<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Levitron on Arduino</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good evening! In this publication I will talk about my little homemade product, which I had planned for a long time. 

 Some time ago I read an articl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Levitron on Arduino</h1><div class="post__text post__text-html js-mediator-article">  Good evening!  In this publication I will talk about my little homemade product, which I had planned for a long time. <br><br>  Some time ago I read an article about interesting devices - <a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B5%25D0%25B2%25D0%25B8%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD">Levitrons</a> , which are both purely mechanical and electronically controlled. <br><br>  Naturally, I wanted to collect such a toy for myself, but, searching on the Internet, to my surprise I found (at least at that time) that most of the circuits were exclusively analog.  Since I understand little in analog technology, I decided to ‚Äúreinvent‚Äù Levitron again.  For experiments, the Arduino Uno was at hand.  He ordered a linear Hall sensor in China (what is <a href="https://ru.wikipedia.org/wiki/%25DD%25F4%25F4%25E5%25EA%25F2_%25D5%25EE%25EB%25EB%25E0">the Hall effect</a> ), namely the UGN3503UA, collected a number of old transformers for winding test coils and began experiments. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      That's what came out of it: <br><br><img src="https://habrastorage.org/files/a02/e36/e10/a02e36e105c44b048cf84f0d58a629c4.jpg"><br><a name="habracut"></a><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/ho9_rQ7fbMY%3Ffeature%3Doembed&amp;xid=17259,1500004,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhwsEe7gHSbdCX9RNdRcjM4uqVkPg" frameborder="0" allowfullscreen=""></iframe><br><br>  How it works.  At the bottom of the coil in the center there is a Hall sensor, measuring the distance to the neodymium magnet, which is glued to the ‚Äúlevitating‚Äù traffic jam.  The sensor has three outputs - 5V power and analog output, which is connected to the Arduino ADC. <br><br><img src="https://habrastorage.org/files/7c4/58f/a87/7c458fa871354a818006030ffeed95ce.jpg"><br><br>  The control solenoid circuit is assembled on a field-effect transistor. <br><br><img src="https://habrastorage.org/files/daa/e87/96a/daae8796add84d34b72b8dd18780243e.png"><br><br><img src="https://habrastorage.org/files/9e5/473/1f2/9e54731f243f4c13b16848ce01d9d38a.jpg"><br><br>  The solenoid is connected to the J1 pins, pin 1 of the J2 connector to the Arduino PWM.  Connecting a Hall sensor to the input of the ADC is not on the diagram, but there should be no difficulties here. <br><br>  I can‚Äôt say the number of turns of the coil, as I made 3 or 4 coils during the experiments, shook it according to the principle ‚Äúhow many wires are left on the transformer‚Äù.  The remaining parameters: coil resistance of about 12 ohms, diameter 30 mm, height 10 mm, wire thickness 0.3 mm, coil without a core. <br><br>  The firmware in the first version was extremely simple; when the value leaves the permissible range, the circuit either turns off or turns on at full capacity; in the video above, the device just works according to this algorithm.  In the next firmware version, the MC tries to smoothly adjust the voltage on the solenoid, as a result of which the tendency to oscillations in the system has decreased. <br><br><div class="spoiler">  <b class="spoiler_title">Firmware</b> <div class="spoiler_text"><pre><code class="hljs go">#define sensorPin A0 #define pwmPin <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sensorValue = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> levitPoint = <span class="hljs-number"><span class="hljs-number">370</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> deltaLevit = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> maxL, minL; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> induction = <span class="hljs-number"><span class="hljs-number">128</span></span>; void setup() { pinMode(pwmPin, OUTPUT); maxL = levitPoint - deltaLevit; minL = levitPoint + deltaLevit; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sensorRead(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sensorPin) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> s = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> i =<span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>; i++) {s += analogRead(sensorPin);} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s/<span class="hljs-number"><span class="hljs-number">5</span></span>; } void loop() { sensorValue = sensorRead(sensorPin); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensorValue &lt; <span class="hljs-number"><span class="hljs-number">490</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensorValue &lt; maxL) induction = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensorValue &gt; minL) induction = <span class="hljs-number"><span class="hljs-number">250</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sensorValue &gt;= maxL and sensorValue &lt;= minL) induction = ((sensorValue - maxL)*<span class="hljs-number"><span class="hljs-number">25</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> induction = <span class="hljs-number"><span class="hljs-number">0</span></span>; analogWrite(pwmPin, induction); }</code> </pre> <br></div></div><br>  The circuit is powered by 12V, the sensor is powered by the built-in Arduino stabilizer.  Consumption in maximum mode is about one amp, in hover mode 0.3-0.4 A. <br><br>  The device has worked, but for more than one minute it is dangerous to work, the transistor is very hot, the coil is also heated, until the glue melts (everything is assembled on hot melt). <br><br>  I plan to further remake the solenoid and transfer the circuit to power from 5 volts, put a more powerful transistor with a radiator.  Well, replace the Arduino with ATiny.  It does not hurt to also put a large-capacity capacitor on the input circuits, or even a battery of capacitors to protect the power supply (the first power supply is 1.5A, it burns down after 10 seconds of operation from load jumps). <br><br>  On this, perhaps, finish, thank you for your attention. </div><p>Source: <a href="https://habr.com/ru/post/255647/">https://habr.com/ru/post/255647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255631/index.html">"Operator Overloading" in Scala</a></li>
<li><a href="../255633/index.html">Nakapcha Mail.Ru - captcha, which is not shown</a></li>
<li><a href="../255637/index.html">Is there a USB in this MK?</a></li>
<li><a href="../255643/index.html">Online streaming. Monitoring: from server to application. System Center Operations Manager 2012 R2</a></li>
<li><a href="../255645/index.html">Again about AUTO_INCREMENT</a></li>
<li><a href="../255649/index.html">Best approaches to moving a MATLAB code to a fixed point</a></li>
<li><a href="../255651/index.html">Create a beautiful date / time / data picker in android</a></li>
<li><a href="../255653/index.html">Developing a cross-platform application using the Ionic Framework</a></li>
<li><a href="../255655/index.html">Video surveillance through 3 / 4G (part 1)</a></li>
<li><a href="../255657/index.html">Our devices to control the lighting in the smart home</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>