<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Extortionist KeRanger for OS X: our analysis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In our previous corporate blog post, we presented information about an extortionist for OS X called KeRanger. The KeRanger data was taken from the rep...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Extortionist KeRanger for OS X: our analysis</h1><div class="post__text post__text-html js-mediator-article">  In our <a href="https://habrahabr.ru/company/eset/blog/278725/">previous</a> corporate blog post, we presented information about an extortionist for OS X called KeRanger.  The KeRanger data was taken from the report of the Palo Alto Networks company, which experts were the first to report on this threat.  Our analyst Anton Cherepanov also analyzed KeRanger, however, he did not have time to publish this data before the aforementioned specialists. <br><br><img src="https://habrastorage.org/files/265/1ad/bb0/2651adbb007d425e993a0a074bae0621.jpeg"><br><br>  In this post, we will present information from the first extortioner's own research for OS X, and also describe the features of KeRanger detection using our anti-virus products.  Since the authors of Transmission have released a new version of their application with the identifier 2.91, we recommend that all users of this software upgrade to this version. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/files/163/b25/80f/163b2580fcde4f1590b2b1d97e1f3a53.png"><br>  Fig.  An update alert that displays an already outdated version of Transmission on OS X. <br><br>  According to the above warning, which is displayed by the Transmission application itself, and is also present on the official website, version 2.90 of the application was compromised by the extortionist, so all users are invited to upgrade to the latest version 2.91. <br><br>  Answers to the following questions will help users quickly understand the situation. <br><br>  1. Is the KeRanger malware just an experimental version or is it designed for in-the-wild distribution? <br><br>  Attackers use KeRanger for mass distribution. <br><br>  2. How do attackers spread extortionist? <br><br>  For distribution, the attackers chose an effective way to compromise the legitimate distributions of the Transmission application, which is a free BitTorrent client.  The malicious version of the distribution was available for download from the official website between March 4 and 5, 2016. It was also signed with a legitimate digital certificate. <br><br>  3. Are malicious Transmission distributions now distributed? <br><br>  On March 5, a malicious version of the program was removed from the website.  In addition, Apple has revoked the digital certificate used to sign it.  This measure will help OS X users protect themselves from the threat of infected distributions that can be downloaded from other places. <br><br>  4. I did not receive the ransom request message.  Does this mean that my poppy was not compromised? <br><br>  Not necessary.  The in-the-wild version of KeRanger performs its destructive actions three days after the initial infection.  To detect the infection of poppies in manual mode, you should check the presence of the following files on your system.  If they are present, they should be removed, just like the application itself. <br><br>  /Applications/Transmission.app/Contents/Resources/ General.rtf <br>  /Volumes/Transmission/Transmission.app/Contents/Resources/ General.rtf <br>  % HOME_DIR% / Library / kernel_service <br>  % HOME_DIR% / Library / .kernel_pid <br>  % HOME_DIR% / Library / .kernel_time <br><br>  5. Is it possible to decrypt files without paying the ransom? <br><br>  Unfortunately not.  The extorter uses a pair of RSA-2048 and AES-256 cryptographic algorithms that make this process impossible. <br><br>  6. How can I protect my data? <br><br>  To do this, use an antivirus program.  Users of ESET anti-virus products are protected from this threat, KeRanger shows up as OSX / Filecoder.KeRanger.A.  We also strongly recommend that users regularly back up their data. <br><br>  As we have written repeatedly, the malicious distribution kit of the application is supplied with a legitimate digital signature with the date of signing on March 4, 2016. <br><br><img src="https://habrastorage.org/files/920/b84/62c/920b8462c8d848d9802e7853d459d05f.png"><br>  Fig.  Information about the digital signature of a malicious application. <br><br>  The signature identifier corresponds to the ‚ÄúPOLISAN BOYA SANAYI VE TICARET ANONIM SIRKETI‚Äù line, while the legitimate application was signed with a certificate with the Digital Ignition LLC certificate identifier. <br><br>  After its launch on the system, the malicious application Transmission checks the module's activity with the name <i>kernel_service</i> .  In the absence of a file, the malicious code copies the executable file called <i>General.rtf</i> to the location <i>% HOME_DIR% / Library / kernel_service</i> and executes it. <br><br><img src="https://habrastorage.org/files/f3c/f3c/c99/f3cf3cc9961544afa1db786ccef75a9c.png"><br>  Fig.  Decompiled code of a malicious application. <br><br>  The executable kernel_service file is the main part of the ransomware, which encrypts the user's files using the symmetric AES algorithm and an asymmetric RSA, and then requests a ransom for decryption.  After its execution in the system, KeRanger postpones the execution of its malicious functions for three days.  The time counter is located in the .kernel_time file.  At the end of the time, the extortioner connects to one of the six sites hosted on the anonymous TOR network to download a text message with a ransom request, as well as a public RSA key for encrypting the AES file encryption key.  Connection to the TOR is performed using the TOR2WEB public interface. <br><br><img src="https://habrastorage.org/files/868/cb7/bfd/868cb7bfdcab4f01bba47af32d38c8a3.png"><br>  Fig.  Captured ransomware OSX / Filecoder.KeRanger.A request to the managing C &amp; C server. <br><br>  The extortioner gets a list of all the files in the / Users and / Volumes directories and tries to encrypt them.  For this operation, strong encryption is used ‚Äî the malicious program generates a random 256-bit AES key, with which it encrypts files, then the key is encrypted using the RSA public key, after which it is stored in the body of an already encrypted file.  Thus, for each file its own encryption key is generated. <br><br><img src="https://habrastorage.org/files/4c7/44d/1a0/4c744d1a04d647bea5f28f289ae91b59.png"><br>  Fig.  A list of file extensions that the extortionist aims to encrypt. <br><br>  Extortionist specializes in encrypting more than 300 different file types, including documents, photos, videos, archives, etc. After encryption, the extension .encrypted is added to the original file name.  KeRanger creates a text file with a ransom demand in each directory with encrypted files.  The information for the text file is downloaded by the extortioner from the C &amp; C server.  This means that the text can be modified by attackers at any time, allowing them to change the requested ransom amount or other features.  Extortionist does not block the user's desktop with such a message. <br><br><img src="https://habrastorage.org/files/ac5/106/fbb/ac5106fbbf61431d9cd1383c825b5c1c.png"><br>  Fig.  A message demanding redemption. <br><br>  In order to prevent the ransomware infection, you should use the ESET Cyber ‚Äã‚ÄãSecurity and ESET Cyber ‚Äã‚ÄãSecurity Pro antivirus products, which have a regular virus signature database update mechanism to quickly respond to emerging threats.  For maximum speed in response to the detection of new threats, you must enable the ESET Live Grid setting.  Read more about this <a href="http://support.eset.com/kb5911/">here</a> .  We recommend that users regularly back up their data on OS X. <br><br>  <b>Compromise identifiers</b> <br><br>  SHA-1: <br><br>  5F8AE46AE82E346000F366C3EABDAFBEC76E99E9 <br>  FD1F246EE9EFFAFBA0811FD692E2E76947E82687 <br><br>  Addresses of C &amp; C Servers Managers: <br><br>  lclebb6kvohlkcml.onion [.] link <br>  lclebb6kvohlkcml.onion [.] nu <br>  bmacyzmea723xyaz.onion [.] link <br>  bmacyzmea723xyaz.onion [.] nu <br>  nejdtkok7oz5kjoc.onion [.] link <br>  nejdtkok7oz5kjoc.onion [.] nu </div><p>Source: <a href="https://habr.com/ru/post/278749/">https://habr.com/ru/post/278749/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278737/index.html">The story about cunning ... Indian, encrypted procedures, DAC and "God mode"</a></li>
<li><a href="../278741/index.html">Gorgeous Six: girls who had a thermonuclear blast counted</a></li>
<li><a href="../278743/index.html">django-controlcenter</a></li>
<li><a href="../278745/index.html">FLIF - free image compression format</a></li>
<li><a href="../278747/index.html">Sublime Text: syntax validation, autocompletion (v.1.1)</a></li>
<li><a href="../278751/index.html">Work with private repositories and other updates of the FlyElephant platform</a></li>
<li><a href="../278755/index.html">Asynchronous parallel execution in PHP</a></li>
<li><a href="../278757/index.html">Windows-way synchronization settings between systems</a></li>
<li><a href="../278759/index.html">The idea of ‚Äã‚Äãan educational game for schoolchildren</a></li>
<li><a href="../278763/index.html">KTV. New JSON</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>