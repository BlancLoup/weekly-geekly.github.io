<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Release Java project with Maven in a new way</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All of us have long been accustomed to Maven , to the versioning of their proposed and dependency management. Maven was born, when the daily assembly ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Release Java project with Maven in a new way</h1><div class="post__text post__text-html js-mediator-article">  All of us have long been accustomed to <a href="https://maven.apache.org/">Maven</a> , to the versioning of their proposed and dependency management.  Maven was born, when the daily assembly of the project was the lot of the most daring, when it was considered normal to release at least a couple of times a year, <a href="https://jenkins.io/">Jenkins was</a> then called <a href="http://hudson-ci.org/">Hudson</a> , and the trees were big ... <br><br>  The ideas that brought maven to the world of development were in great demand and quickly gained popularity: the definition of a standard workflow project, the standard directory model, and much more that has long been taken for granted. <br><br>  As one of the innovations, maven introduced the standard versioning system.  The version was stored in the project file and changed whenever we released a new release.  In a world where making a branch and merdzhunt it was a feat not available to everyone, this approach was quite common. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All this greatly simplified the development, start of new projects, introduction to the project of developers, release of version and dependency management. <br><br>  But the world does not stand still, and, despite the fact that many ideas implemented by maven are still living and moving from one project to another, the version of maven has started to deliver more problems than advantages. <br><br>  Next, we will try to change the world for the better and simplify our lives. <a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">Disclaimer</b> <div class="spoiler_text">  I assume that the reader is familiar with Java, Maven, the development lifecycle and setting up the CI / CD, he understands why he needs all this and he needs to be a <s>ninja</s> . <br></div></div><br>  In modern realities, it is considered the goal, if not the norm, to release several versions a week or even a day.  And, in such conditions, storing the version in a project file leads to very large overheads. <br><br>  Each release leads to two commits to the repository, and as a result, with the active development and release of the project, such technical commits become more than useful.  The history of the project is littered and becomes difficult to perceive. <br>  Also, this approach leads to duplication of information: it has become customary to store the version not only in the project file, but also as a repository tag. <br><br>  Besides, there was a security issue: when you have one big project, the build machine only needs access to it.  When there are a lot of projects, access is needed to many projects and we either create a super user with access to all projects with write access, or get an additional burden on administering a large number of users with a narrow set of rights, but still with write access to the repository, and often, and the right to commit to the master without a pool of requesting and review. <br><br>  When using maven with a release plugin, another interesting feature appears: the reassembly is not performed by the same set of commands as the original version. <br><br>  Perhaps, all these problems will seem to someone far-fetched, but with a less or more large number of projects, managing and tuning the CI / CD turns into an extremely unpleasant and confusing process. <br><br>  Now that the problem is visible, let's try to solve it, so as not to greatly change the set of tools, processes, and in general so that it itself, somehow. <br><br>  What is needed: <br><br><ul><li>  the version is stored once, as a repository tag </li><li>  reassembly of any release is possible, the set of steps should be the same as in the case of a new release </li><li>  no rights to write to the repository </li><li>  we still use maven as a project manager </li></ul><br>  Suppose that CI / CD will make for us getting the tag and checkout the project. <br><br>  Suppose that the tag for us is filled with CI / CD in the environment variable RELEASE_TAG, then in order to release a release, we must execute the following commands: <br><br><pre><code class="bash hljs">mvn -B versions:<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> -DnewVersion=<span class="hljs-variable"><span class="hljs-variable">$RELEASE_TAG</span></span> (1) mvn -B deploy (2)</code> </pre> <br>  1 - updates versions in the pom-files of the project and its modules <br>  2 - builds and, if the project is properly configured, loads artifacts into the repository <br><br>  Do not forget to set the <b>-B</b> flag, otherwise the execution log turns into a pumpkin. <br><br>  Important: in order to avoid confusion and clearly see how and where the assembly is coming from, you need to install the project version into something abstract, for example, DEVELOPMENT-SNAPSHOT.  You can use the same command: version: set.  The operation is a one-time, because we no longer store the version of the project in the file. <br><br>  As a result of the changes, you can remove the configuration of the maven-release-plugin and scm block from the pom file. <br><br>  "Of the minuses: <br>  If you are using SNAPSHOT versions anywhere, confusion may start, now all SNAPSHOT versions look the same.  And perhaps this way to release projects is not for you. <br><br>  There may be a feeling that an artifact collected from the same commit but with different tags will be the same, but, unfortunately, this is not the case.  We, all the same, expose the version in the file, and, as a result, the collected packages will be different. <br><br>  "Of the benefits: <br><br><ul><li>  All requirements are satisfied, and even more! </li><li>  the version is stored only in the project tag </li><li>  building a new one and rebuilding the old version is done by the same set of commands as the original version </li><li>  there is no need for rights to commit to the project </li><li>  the toolbox stayed the same </li><li>  bonus: project configuration simplified </li></ul><br>  So, two lines again saved the world. <br>  That's all, thank you for your attention! </div><p>Source: <a href="https://habr.com/ru/post/424425/">https://habr.com/ru/post/424425/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../424415/index.html">The difficult solution of simple problems HighLoad WEB-services</a></li>
<li><a href="../424417/index.html">Roskomnadzor reported on the results of a three-year struggle with pirates</a></li>
<li><a href="../424419/index.html">What happens when creating a Flexbox container?</a></li>
<li><a href="../424421/index.html">Common business mistakes on the Internet that you can avoid</a></li>
<li><a href="../424423/index.html">Google Chrome 69 automatically enters the account and does not erase Google cookies when clearing the history</a></li>
<li><a href="../424427/index.html">Roskomnadzor and Telegram bots through a proxy</a></li>
<li><a href="../424429/index.html">Science Art and Sound: 4 impressive projects</a></li>
<li><a href="../424431/index.html">Valve has introduced a rating of game controllers used in Steam</a></li>
<li><a href="../424433/index.html">What for the hackers Mikrotik and how I hid 100 thousand. RouterOS from the botnet</a></li>
<li><a href="../424435/index.html">Zoo on Nefteburovoy: we bring order</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>