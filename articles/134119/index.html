<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to start learning Windows Installer?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows Installer Technology (MSI) is the de facto standard in the world of system administrators involved in distributing and maintaining software fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to start learning Windows Installer?</h1><div class="post__text post__text-html js-mediator-article"><img align="left" alt="Installer pic" src="https://habrastorage.org/storage1/1c7bdc63/64c2f5b5/1d4c06eb/6f588e9a.png">  Windows Installer Technology (MSI) is the de facto standard in the world of system administrators involved in distributing and maintaining software for desktop and server versions of Windows.  The MSI format is supported by all major configuration management systems (Microsoft SCCM, CA Unicenter, and many others), and for some software distribution systems it is the only supported format. <br>  My experience with this technology ‚Äî both theoretical and practical ‚Äî was acquired during my time at Infopulse Ukraine and connected with the creation of MSI packages and the preparation of ready-made MSI packages for automatic installation in a corporate environment. <br><a name="habracut"></a><br><br><h4>  Why do you need it? </h4><br>  If you are doing centralized installation of applications on Windows networks, knowledge of the MSI format and the ability to create and edit packages in this format can be useful to you when preparing a package for deployment and diagnosing problems.  In Europe and the United States, Windows Installer technology is in demand by many large customers, so MSI knowledge can be a plus for a system administrator when finding employment. <br><br><h4>  What you need to know and be able to start learning? </h4><br>  Nothing complicated.  If you have experience in administering and maintaining a small (and preferably large, hierarchical) network of Windows machines, you most likely have already encountered the main issues and concepts you need.  Before you begin, make sure that you understand the structure of the Windows file system, the structure of the user profile and the structure of the registry, know what processes and services are in Windows, know how to manage user accounts and know where the event logs are located.  In order to learn how to create MSI packages, you do not need to have developer experience, although of course it is better if you have such experience.  And it‚Äôs not at all necessary to be able to write SQL queries, although this can also be useful (after all, each MSI file is a small relational database).  But be sure to be able to read and understand the technical documentation in English, without this, most likely nothing happens.  When studying the theory (and when creating packages in practice), try to follow the Windows Installer standards at least at first, avoiding supporting utilities such as InstallShield / InstallScript, so you better understand how to create an MSI package correctly. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  We are preparing the sandbox and begin the practice. </h4><br><br>  You need to start with the installation and configuration of the virtual machine.  In the process of learning you will have to experiment a lot, so it's best to do it in the sandbox.  If you need free products, install <a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a> or <a href="http://www.vmware.com/go/downloadplayer/">VMWare Player</a> (for professional tasks, their functionality may not be enough, but for training it will be fine).  In a virtual machine, of course, you need to install Windows of your choice (XP and higher). <br>  If you already have experience with utilities from Sysinternals - fine.  If not, it's time to fill the gap.  We will need at least two: to monitor the file and registry activity of the application during installation or during its operation - <a href="http://technet.microsoft.com/en-us/sysinternals/bb896645">Process Monitor</a> , to run the installation on behalf of the LocalSystem account - <a href="http://technet.microsoft.com/en-us/sysinternals/bb897553">PsExec</a> .  Practice using these utilities on a simple notepad-type application (what resources does the notepad work with when opening a file, when saving a file; run notepad as a LocalSystem user, experiment with saving files and setting file associations), these skills will be useful later. <br><br>  Install <a href="http://dm-soft.narod.ru/download.htm">Panda QuickShot</a> or other software to compare system conditions.  Understand the basic functionality, learn how to track file and registry changes in the system when installing a new application or changing system parameters (the simplest thing is to register a new file association for notepad, change the desktop wallpaper and track where these settings are stored).  Get creative with this, the field for experimentation is vast. <br><img alt="Panda orca pic" src="https://habrastorage.org/storage1/52f3ebf7/c15418fe/8f93564c/97fc0ca2.png"><br>  Download the MSI installer of a simple application (for example, Orca, InstEd or Firefox).  Install the package on a virtual machine, using the utilities described above, examine the resources installed by it.  Learn how to use the Windows Installer command line (msiexec /?), Experiment with various installation options and compare the result.  Perform uninstall from the command line, install the package in silent mode. <br>  Install InstEd or Orca on the host machine.  Open the MSI package that you installed on the virtual machine using one of these utilities.  Compare the records of the main tables in the MSI package (File, Directory, Registry) with the resources (files, folders, registry keys) installed by this package on your virtual machine (the result of comparing state snapshots using Panda QuickShot). <br><img alt="InstEd Orca pic" src="https://habrastorage.org/storage1/29d3a9c5/f906955c/2255df78/02a5a183.png"><br><br><h4>  A bit of theory </h4><br>  Now is the time to tackle the theory.  I will not duplicate the official documentation and some useful articles on the links below, just try to list the things that you need to figure out to start: <br><ul><li>  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa370889(v%3Dvs.85).aspx">Property</a> table, product code (ProductCode), package code (PackageCode), <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa370905(v%3Dvs.85).aspx">standard properties</a> in MSI; </li><li>  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa372379(v%3DVS.85).aspx">Upgrade</a> table and upgrade code (UpgradeCode); </li><li>  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa368585(v%3DVS.85).aspx">Feature</a> tables, <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa368007(v%3DVS.85).aspx">Component</a> and their purpose; </li><li>  Tables <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa368295(v%3DVS.85).aspx">Directory</a> , <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa368596(v%3DVS.85).aspx">File</a> , <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa371168(v%3DVS.85).aspx">Registry</a> , <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa371847(v%3DVS.85).aspx">Shortcut</a> ; </li><li>  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa372406(v%3DVS.85).aspx">Ways to store</a> application <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa372406(v%3DVS.85).aspx">files</a> that come with the MSI package, <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa369801(v%3DVS.85).aspx">Media</a> table; </li><li>  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa369805(v%3DVS.85).aspx">Transforms</a> , their creation and use from the command line. </li></ul><br>  Reading the documentation on these topics is supported by experiments on the finished packages, and over time you can try <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa367563(v%3DVS.85).aspx">to make the package yourself</a> .  This knowledge will be enough for you to make small changes to MSI packages when preparing for deployment in a corporate environment (typical tasks are setting package properties, editing the registry, deleting files and shortcuts, disabling the Remove button for an application in Add / Remove Programs).  Just do not forget after making any changes to the package to perform thorough testing before launching the package into commercial operation.  When testing, be sure to use the recommendations provided in <a href="http://habrahabr.ru/blogs/sysadm/132164/">this article</a> . <br>  I think on this you can finish the introductory part.  In the future (if there is interest) I will try to talk about the features of some off-the-shelf MSI packages provided by software vendors for deployment in a corporate environment and consider other issues of interest to system administrators. <br>  Suggestions, comments, and suggestions for topics for the following articles are welcome. <br><br><h4>  Utility and Documentation Overview </h4><br>  You can use simple editors of MSI files with limited functionality for free - here mention is made of Microsoft's classic Orca and the rather handy InstEd.  These editors allow you to make small changes to ready-made MSI files, create and apply transforms, but creating MSI packages from scratch is not easy at all (and for large packages it makes no sense at all).  But if you really want to learn the MSI technology, you just need to build a couple of simple packages in InstEd or Orca and validate them for compliance with the Windows Installer standard. <br>  Specialized utilities for performing setup capture (creating or converting installation packages from so-called ‚Äúold formats‚Äù to MSI format using comparing system ‚Äúsnapshots‚Äù before and after installing the application or monitoring changes in the system on the fly) - free <a href="http://www.appdeploy.com/tools/repackager/">AppDeploy Repackager</a> , or a more serious <a href="http://www.infopulse.com.ua/eng/Solutions/MSI-Generator/">MSI Generator</a> . MSI packages created using these utilities may require some refinement, which can be done using the MSI editor. <br>  Serious full-featured (and very expensive) IDEs that provide support for the full cycle of working with MSI packages ‚Äî if you work with MSI technology professionally, you most likely cannot do without these programs.  Until recently, two products dominated in this segment - <a href="http://www.flexerasoftware.com/products/adminstudio.htm">AdminStudio</a> from Flexera and <a href="http://www.symantec.com/business/package-studio">Wise Package Studio</a> from Symantec, but recently Symantec announced the discontinuation of the development work of Wise Package Studio, and the market goes into the hands of Flexera.  In addition to working with MSI, AdminStudio allows you to work with virtual packages of the Microsoft App-V, VMware Thin App and Citrix XenApp formats.  For trial purposes <a href="http://learn.flexerasoftware.com/content/AR-EVAL-AdminStudio">, a</a> trial 21-day version is available. <br>  We should also mention <a href="http://wix.codeplex.com/">WIX</a> (Windows Installer XML) - a set of utilities for creating MSI files from XML descriptions.  This project was released by Microsoft under the open license Common Public License, supports the command line interface and can be used to automate the creation of versions of installation packages.  The good description is <a href="http://habrahabr.ru/blogs/development/68616/">on Habr√©</a> . <br><br><h4>  Useful resources: </h4><br>  Windows Installer articles on the RSDN: <a href="">one</a> , <a href="">two</a> .  They are good because they describe the basic concepts and concepts of MSI in Russian and in a fairly readable form.  Articles are a bit outdated (they describe standard 2.0), but they have not lost relevance.  It is important to understand that these articles are not enough to study MSI - you need to read a lot of MSDN and practice a lot. <br>  <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/cc185688(v%3DVS.85).aspx">Articles on MSDN</a> - the most complete source of information that will be needed in the process of studying and further work.  There are step-by-step <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa367563(v%3DVS.85).aspx">exercises</a> for practicing the creation of MSI packages from scratch. <br>  <a href="http://www.appdeploy.com/">AppDeploy.com</a> is an open- <a href="http://www.appdeploy.com/">source</a> application knowledge base; you can often find features for installing or configuring ready-made packages produced by large vendors (Adobe, Microsoft), command lines for automating installation, and other useful things. <br>  For convenience, I will duplicate links to programs from the text in one list: <br><ul><li>  Virtual machines: <a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a> or <a href="http://www.vmware.com/go/downloadplayer/">VMWare Player</a> . </li><li>  Utilities Sysinternals: <a href="http://technet.microsoft.com/en-us/sysinternals/bb896645">Process Monitor</a> , <a href="http://technet.microsoft.com/en-us/sysinternals/bb897553">PsExec</a> , a complete <a href="http://technet.microsoft.com/en-us/sysinternals/bb545027">list of</a> utilities with descriptions. </li><li>  Programs for editing MSI files: <a href="http://www.instedit.com/download.html">InstEd</a> , Orca (must be installed as part of the <a href="http://www.microsoft.com/download/en/details.aspx%3Fdisplaylang%3Den%26id%3D3138">Windows 7 SDK</a> ). </li><li>  Programs for creating MSI files: <a href="http://www.appdeploy.com/tools/repackager/">AppDeploy Repackager</a> , <a href="http://infopulse.com.ua/eng/Solutions/MSI-Generator/">MSI Generator</a> , <a href="http://learn.flexerasoftware.com/content/AR-EVAL-AdminStudio">AdminStudio</a> (trial version). </li></ul></div><p>Source: <a href="https://habr.com/ru/post/134119/">https://habr.com/ru/post/134119/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134111/index.html">Post of Russia</a></li>
<li><a href="../134114/index.html">Preparing .psd for layout</a></li>
<li><a href="../134115/index.html">What is really a terrible figure eight</a></li>
<li><a href="../134117/index.html">Advertisement of Samsung's flexible transparent 3D displays</a></li>
<li><a href="../134118/index.html">Create a web application for GNOME 3</a></li>
<li><a href="../134120/index.html">The first alpha release of Ubuntu 12.04</a></li>
<li><a href="../134121/index.html">GAMER.ru launches the second season of the MISS GAMER contest</a></li>
<li><a href="../134122/index.html">Sketch - 100 seconds about Adobe history</a></li>
<li><a href="../134123/index.html">The module for receiving screenshots from the video - nginx-video-thumbextractor-module</a></li>
<li><a href="../134124/index.html">DDoS attacks on online media: event chronicles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>