<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating MMC Management Console</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Have you seen the cockpit? Everything is at hand, no unnecessary gestures. In order to take off, the pilot does not go to the other end of the aircraf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating MMC Management Console</h1><div class="post__text post__text-html js-mediator-article">  Have you seen the cockpit?  Everything is at hand, no unnecessary gestures.  In order to take off, the pilot does not go to the other end of the aircraft to turn on the engine. <br><br><img src="https://habrastorage.org/files/65c/2ce/e3e/65c2cee3eec5449ea2d2ff40ab17035c.jpg"><br><br>  So in the situation with MMC consoles.  You create for yourself a ‚Äúcontrol panel‚Äù and in certain situations press the necessary ‚Äúbuttons‚Äù. <br>  The publication is designed for system administrators who want to get acquainted with the method of creating Windows management consoles by using mmc.exe. <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What is MMC? </h4><br>  Microsoft <a href="http://windows.microsoft.com/ru-ru/windows-vista/what-is-the-microsoft-management-console-mmc">responds</a> : <br><blockquote>  The Microsoft Management Console (MMC) is a place to store and display administration tools created by Microsoft and other software vendors.  These tools are called snap-ins and are used to manage Windows hardware, software, and network components.  Some of the tools located in the Administration folder, such as Computer Management, are MMC snap-ins. </blockquote><br><br><h4>  Introduction </h4><br>  I prefer to characterize the MMC console as a control panel.  By adding all the necessary tools to it, you can save great time.  Everything you need is always in front of you, in one place. <br>  <b>Pros of use:</b> <br>  + You are not constantly looking for shortcuts to used snap-ins, programs, scripts; <br>  + To start the working day, you need to run only one file; <br>  + Ability to create your own console for different tasks, projects, or under each serviced office. <br><br>  The modular system allows you to combine different snap-ins in one place, it can be both a server resource monitor and the most common web browser.  We will look at the latest MMC version 3.0 that comes with Windows Server 2003 SP2, Windows Server 2003 R2, Windows Vista, Windows 7 and Windows Server 2008. The history of management consoles began with MMC 1.0 and Windows 95. <br><br>  The management console is located at the path <b>C: \ Windows \ System32 \ mmc.exe</b> . <br><br><img src="https://habrastorage.org/files/a10/606/115/a10606115c15450587b7d1d603951172.png"><br><br>  Launching the console in this way, we will open it in the <b>Author</b> mode, i.e.  we can make changes to the structure.  MMC consoles have two launch modes: <br><ul><li>  Author's - in which we will have complete freedom of action and we will be able to remove and add accessories; </li><li>  User - prohibiting changes in the structure and suitable for the end user. </li></ul><br>  You can change the launch mode in the console itself or, for example, for authoring mode, start with the <b>/ a</b> parameter.  We will look at this moment at the end, when we will create our first console. <br>  The empty console looks like this: <br><br><img src="https://habrastorage.org/files/b6d/72a/45c/b6d72a45cb944cbe84bf49b08658cd6a.png"><br><br><h5>  The moment about the bit console (MMC32 and MMC64) </h5><br>  To run 32-bit MMC consoles on 64-bit systems, you need to start the console with the / 32 switch. <br>  If you run a 64-bit console on a 32-bit system, it will be completed. <br><br><h4>  "My first console" </h4><br>  We decided that the console should simplify the system administration process.  For clarity, I propose to highlight a set of snap-ins and functionality that a typical system administrator has in one or another form at any of the companies: <br><br><ul><li>  Snap Active Directory; </li><li>  DHCP snap-in; </li><li>  Manage print servers; </li><li>  Computer management; </li><li>  Service management; </li><li>  A set of scripts and utilities; </li><li>  Network Resource Kit; </li><li>  A set of remote desktops; </li></ul><br>  Having chosen the most basic, let's start creating our own management console. <br>  The process of adding snap-ins to the console is intuitive: <b>File - Add or remove snap-</b> ins <b>...</b> <br><br><img src="https://habrastorage.org/files/802/f14/1cb/802f141cb54e46fcb5fa4ef50c005f9a.png"><br><br>  To add some snap-ins, you will not need to immediately make any additional settings: <br><br><img src="https://habrastorage.org/files/556/ef2/359/556ef23594e848fd9206e4fcedd38e9d.png"><br><br>  When adding others, you will be prompted to configure them immediately: <br><br><img src="https://habrastorage.org/files/243/61b/021/24361b021d9e4abeaf33c8de5406ed51.PNG"><br><br>  When adding a number of snap-ins, it is proposed to select a computer for management.  For example, when adding <b>Computer Management</b> and <b>Services</b> snap-ins.  Since we plan to use the console to control other computers, you should pay attention to the checkbox and put it down: <br><blockquote>  Allow to change the selected control computer when starting from the command line.  Used when saving the console. </blockquote><br>  If you make a snap universal, to connect to any computer, then the best option at this point - the <u>local computer</u> .  If there is a ‚Äúother computer‚Äù, then each time the console created by us starts, there will be requests to the remote computer ... And if it is turned off?  It will have to wait until the equipment understands this and gives an error. <br><br><img src="https://habrastorage.org/files/70e/fe3/42e/70efe342e7f249ed92672f16da7f2183.PNG"><br><br>  After clicking on OK, we will get a console with snap-ins added by us: <br><br><img src="https://habrastorage.org/files/bb7/c02/90b/bb7c0290bef94c649c26ed1f27c54ae5.png"><br><br>  But we are not satisfied with how it looks, we want to hide some elements.  The <b>Action</b> field takes up too much space, we want to get rid of it and, for example, get rid of the <b>status bar</b> .  View settings can be made in the <b>View - Configure ...</b> menu of the console. <br><br><img src="https://habrastorage.org/files/fd8/545/4c1/fd85454c18504d67a5a5ec5f9eb9a0d7.png"><br><br>  Here we can remove and enable the display of the elements we need.  Put down the checkboxes and see the result: <br><br><img src="https://habrastorage.org/files/831/44d/f0d/83144df0d20a47a6b71d46b441cb8f5a.png"><br><br>  On the taskbar of some snap-ins, we can see a set of some standard actions and properties.  Other snap-ins may not have a standard taskbar at all. <br>  The <b>Service</b> snap-in, for example, contains buttons that allow you to <b>Stop</b> and <b>Restart the</b> service.  We can change the appearance of the taskbar and add to it the actions that we need. <br><br><img src="https://habrastorage.org/files/6e7/b11/110/6e7b111109eb4cecbb7e9030dd08d69b.PNG"><br><br>  To do this, we first click on the snap-in in the root of the console (in this case, click on <b>Services (local)</b> ) and fall into the <b>Actions</b> menu <b>- New view of the taskbar ...</b> <br><br><img src="https://habrastorage.org/files/caa/b73/7d0/caab737d01be448b98c514c9070bdf37.png"><br><br>  The taskbar view creation wizard opens.  Click next. <br><br><img src="https://habrastorage.org/files/6a9/e63/363/6a9e633632a1420ea4f9b80557cd9044.png"><br><br>  Choose a style for our new taskbar.  We draw attention to the fact that the wizard gives us hints on what style is suitable for what and shows in the preview window how it will look like: <br><br><img src="https://habrastorage.org/files/02e/d80/3fa/02ed803fa81f462c9470a0571cba5793.png"><br><br>  In the next step, we select to which console elements we add the taskbar type we created.  If you select the item <b>For all items that have the type of the selected item</b> , then if we had another <b>Service</b> snap-in in the console, this view would also apply to it.  If you select <b>To selected item in the tree</b> , the view is applied only to the selected snap-in in the console root. <br><br><img src="https://habrastorage.org/files/1d0/32f/cac/1d032fcacfc64a48b7240db7d8332d15.png"><br><br>  Now we need to give the name of the taskbar and, if we want, add a description. <br><br><img src="https://habrastorage.org/files/320/bb6/d44/320bb6d44d4a4060b0a028aba1b10a90.png"><br><br>  In the final step, we are asked to click on the <b>Done</b> button to add a new task to the newly created taskbar. <br><br><img src="https://habrastorage.org/files/ba7/223/57a/ba722357ace24997b334fd431be2e644.png"><br><br>  Since we didn‚Äôt remove the checkbox at the last step, the <b>task creation wizard</b> opens before us. <br><br><img src="https://habrastorage.org/files/970/570/177/970570177cdf407483323bd20e7d40f6.png"><br><br>  Select the type of team for the task being created.  We are given three types to choose from: <br><ul><li>  Menu command - launches standard snap menu command. </li><li>  Team operating system - allows us to run a program, script or script. </li><li>  Transition Command ‚Äî Displays the taskbar for an item in the favorites list MMC. </li></ul><br><br>  We will select the <b>menu command item</b> . <br><br><img src="https://habrastorage.org/files/20b/e47/bf1/20be47bf19af486b87465a046ee3bdf8.png"><br><br>  From the command source select <b>Element in the results pane</b> . <br><br><img src="https://habrastorage.org/files/39e/983/ea4/39e983ea437a41a091940c00fe87bb31.png"><br><br>  Specify the name and optional description of our team. <br><br><img src="https://habrastorage.org/files/d8f/2ec/531/d8f2ec531cb7439eb2d4891123ddc391.png"><br><br>  Choose the desired task icon from the existing ones or load your own. <br><br><img src="https://habrastorage.org/files/90c/a44/794/90ca4479453a48fab1302ca2b34ed6c3.png"><br><br>  At the final step, click <b>Finish</b> .  If we want to add another task, set the corresponding checkbox <br><br><img src="https://habrastorage.org/files/f5d/148/ce6/f5d148ce6ff94926992b356ed48daf22.png"><br><br>  After completing the wizard, choosing a service on the taskbar we created, we will see the task we added, Restart, when clicked, the service will restart. <br><br><img src="https://habrastorage.org/files/a25/740/98f/a2574098f714437eb7b54d69014a8406.png"><br><br><img src="https://habrastorage.org/files/eeb/27c/c76/eeb27cc76dc542d48f61282b6551665d.png"><br><br>  You can add such taskbars with tasks for any snap-in. <br>  The next step, we will add to the root of our console an item from which we will run our working scripts and scripts: <b>File - Add or remove a snap-in ...</b> <br>  Add a snap <b>folder</b> : <br><br><img src="https://habrastorage.org/files/68c/4f3/d13/68c4f3d1384e48febd88e424ecd9f024.png"><br><br>  At the root of the console, rename it and create a new taskbar: <b>Action - New view of the taskbar ...</b> <br><br><img src="https://habrastorage.org/files/abe/810/3c0/abe8103c064442ba82473404bd48d28a.png"><br><br>  For convenience, we select the panel style without a list and apply it to the selected list item. <br><br><img src="https://habrastorage.org/files/147/eca/ea9/147ecaea94af44d5bd9dbccf9640cab1.png"><br><br>  We finish the creation by choosing a name and adding a description. <br>  Launch the task creation wizard and this time select the item <b>Command of the operating system</b> : <br><br><img src="https://habrastorage.org/files/562/72a/ebe/56272aebeaa046bfb1c70dd3abf3afae.png"><br><br>  To run, for example, a PowerShell script, in the Command field, write <i>powershell</i> , and in the <b>Parameters</b> field ‚Äî the path to the script.  In our case, we specify the path to the script <i>C: \ Console \ script \ new-user.ps1</i> . <br>  If we save our console in the folder <i>C: \ Console</i> , then before the script we can specify the path <i>script \ new-user.ps1</i> . <br><br><img src="https://habrastorage.org/files/b5e/bac/6d1/b5ebac6d1ac94422bbf461f3e4876777.png"><br><br>  Add a name and description, select the task icon and complete the creation. <br><br><img src="https://habrastorage.org/files/441/66b/64b/44166b64bd6f438fa61e356c9a96fc32.png"><br><br>  When selecting the Scripts folder in the root of the console, we see the link to the script just created. <br><br><img src="https://habrastorage.org/files/421/4c7/eba/4214c7eba2fd4279bb77fdd6bb80ee44.png"><br><br>  This way you can add all the utilities and scripts we need. <br>  In order to add another task, after exiting the wizard, we select the necessary equipment in the console root: <b>Action - Edit the taskbar view ...</b> <br><br>  <b>General</b> tab for setting the style of displaying the taskbar. <br><br><img src="https://habrastorage.org/files/c59/265/4a2/c592654a240546aaa585a5c45784275c.png"><br><br>  <b>Tasks</b> tab to add new tasks, delete and modify existing ones. <br><br><img src="https://habrastorage.org/files/e45/83f/4c4/e4583f4c48964e3bbd1066446a62b728.png"><br><br>  To add a new task, click the <b>Create ...</b> button, the <b>New</b> <b>Task Wizard</b> opens and we can add a new task, similar to the previous one.  We, for example, add a link to the execution of the .reg file.  To do this, when creating a command in the field, assign the path <i>C: \ Console \ Settings.reg</i> . <br>  To run, for example, an .exe file with parameters, we will need to enter the path to the file in the <b>Command</b> field and run parameters in the <b>Parameters</b> field. <br><br><img src="https://habrastorage.org/files/ad2/6a9/1c8/ad26a91c8451455ca9328c04aaf3d688.png"><br><br>  Next, we proceed to add to the links to network resources.  These can be either folders located locally on a computer or on the network, or links to web pages. <br>  <b>File - Add or Remove Snap-In ...</b> <br>  Since we want all the resources to be ordered, we add a new snap-in. <b>Folder</b> and so that other snap-ins can be added to it, click on the <b>Advanced</b> button and set the <b>Allow to change parent snap-in</b> checkbox. <br><br><img src="https://habrastorage.org/files/57e/ca3/eb9/57eca3eb91b94c2188cbc120133d665a.png"><br><br>  In the <b>Parent snap</b> -in drop-down list, select <b>Folder</b> and add another snap-in - <b>Link to the web resource</b> : <br><br><img src="https://habrastorage.org/files/680/3ac/529/6803ac5293cc4e5ba2fac386c5e741b1.png"><br><br>  If the location is online, enter the path.  For example, on <i>server1, the shared</i> folder is <i>soft</i> <br><br><img src="https://habrastorage.org/files/960/8d1/1da/9608d11da54d45dfa0423486c15594fd.png"><br><br>  Enter the name and click <b>Done.</b> <br><br><img src="https://habrastorage.org/files/e16/e34/2df/e16e342df6644f97b48423abf1c803c6.png"><br><br><img src="https://habrastorage.org/files/39b/5eb/24e/39b5eb24e3c34f90ba69461b8764d39a.png"><br><br>  In the root of the console, rename our folder, for example, to Network resources.  We open it and we see the link to the network folder created by us <i>soft</i> .  Clicking on the <i>soft</i> folder, we will see its contents. <br>  As mentioned earlier, this way you can add links to local and network folders, as well as web resources. <br><br><img src="https://habrastorage.org/files/c3e/24f/204/c3e24f204bca459cb08531bc9d63dfc4.png"><br><br>  Finally, we will add the <b>Remote Desktops</b> snap-in to our console. <br><br><img src="https://habrastorage.org/files/05f/104/775/05f1047752cd4d0cac425b06fbdee909.png"><br><br>  After adding a snap, we right-click on it and select the item <b>Add a new connection ....</b> <br><br><img src="https://habrastorage.org/files/207/beb/233/207beb23368f46c1b24b257d361dc6be.png"><br><br>  Enter the computer name or ip-address and name to connect. <br><br><img src="https://habrastorage.org/files/f72/fb3/44f/f72fb344fe6b40fba89c47cb0a248914.png"><br><br>  When choosing our terminal, we will connect to it from the console window. <br><br><img src="https://habrastorage.org/files/0ed/c89/380/0edc8938037b428fafe1fa16ef370eb4.png"><br><br>  In the beginning, we talked about the fact that some of the snap-ins work either with the current local computer or with other remote ones. <br>  Take, for example, <b>the Computer Management</b> snap <b>-in</b> .  Make a right click on the snap - <b>Connect to another computer ....</b> <br><br><img src="https://habrastorage.org/files/b5d/d1a/33e/b5dd1a33e46642ba96d614d399d8547e.png"><br><br>  Enter the name of another computer, click <b>OK</b> . <br><br><img src="https://habrastorage.org/files/2ef/d15/230/2efd15230a004dd8a2f7dbec40d7596e.png"><br><br>  If the computer exists, we get the console to control another computer. <br><br><img src="https://habrastorage.org/files/413/5f3/030/4135f3030b574da4a923255e8d339208.png"><br><br>  If not, we see an error. <br><br><img src="https://habrastorage.org/files/975/9c3/952/9759c3952d9349938897eced3071e1a1.png"><br><br>  Now we need to save our new console.  <b>File - Save As ....</b> <br>  When you exit the console, we will receive suggestions to save the changes. <br><br><img src="https://habrastorage.org/files/270/99e/374/27099e37429144fcb0925ae0391358c2.png"><br><br>  When you re-open the console, we will re-enter it in the Author mode, allowing you to make changes in the structure.  But we, for example, do not want the end user to make any changes.  To do this, change the default startup mode. <br>  Select <b>File - Options ...</b> <br><br><img src="https://habrastorage.org/files/0b5/a6d/657/0b5a6d6570be445baf979b69779feddb.png"><br><br>  We select, for example, <b>User - full access</b> .  Click <b>Apply</b> and <b>OK</b> . <br>  This mode will allow working with existing snap-ins and will not allow adding or removing new ones. <br><br><img src="https://habrastorage.org/files/931/72a/c70/93172ac7006941c3be9e50ddf13e3123.png"><br><br>  We leave from equipment with preservation. <br>  If at exit, for example, we had the Computer Management snap-in, while saving and after re-opening the console, we will also see the expanded Computer Management snap-in. <br><br><img src="https://habrastorage.org/files/bf9/edc/687/bf9edc687bdf4850b7fcf8faf15acf80.png"><br><br>  This is where we‚Äôve finished creating our management console.  It is fully ready for use by the system administrator. <br>  Create consoles, experiment, simplify work! <br><br><h4>  Additional Information </h4><br><ul><li>  <a href="https://technet.microsoft.com/en-us/library/bb742441.aspx">Microsoft Management Console - Overview</a> </li><li>  <a href="https://technet.microsoft.com/ru-ru/library/cc709659.aspx">Microsoft Management Console 3.0</a> </li><li>  <a href="https://technet.microsoft.com/en-us/magazine/hh505659.aspx">Windows 7: All About the Snap-Ins</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/251155/">https://habr.com/ru/post/251155/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251133/index.html">CxxMock - principle of operation</a></li>
<li><a href="../251137/index.html">We write a bot for MMORPG with assembler and draenei. Part 0</a></li>
<li><a href="../251141/index.html">Another software UART on ATtiny13</a></li>
<li><a href="../251143/index.html">Own implementation of https using crypto ++ for I2P bootstrapping</a></li>
<li><a href="../251149/index.html">We write a bot for MMORPG with assembler and draenei. Part 1</a></li>
<li><a href="../251157/index.html">The most needed plugins for Grunt</a></li>
<li><a href="../251161/index.html">Introduction to the course "Image and video analysis". Lectures from Yandex</a></li>
<li><a href="../251163/index.html">About Intel Hyper-Threading and Virtual Machine Performance</a></li>
<li><a href="../251165/index.html">22 tips, tricks and shokkat for Android Lollipop</a></li>
<li><a href="../251167/index.html">Adding Wi-Fi to various devices</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>