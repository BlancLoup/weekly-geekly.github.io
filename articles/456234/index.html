<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why Cisco doesn't buy Splunk or a story about how the Cisco platform works for threat hunting</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About once every six months, some American journalist publishes a conspiracy note that Cisco is about to buy Splunk and enter the SIEM segment, since ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why Cisco doesn't buy Splunk or a story about how the Cisco platform works for threat hunting</h1><div class="post__text post__text-html js-mediator-article">  About once every six months, some American journalist <a href="https://www.investors.com/news/technology/cisco-stock-splunk-acquisition-target/">publishes a</a> conspiracy note that Cisco is about to buy Splunk and enter the SIEM segment, since this is exactly what we lack for the final conquest of the global information security market (although we already were named vendor number 1 in March).  However, writing journalists usually forget that Cisco has already developed a SIEM, which it called <a href="https://habr.com/ru/company/cisco/blog/310138/">OpenSOC</a> and <a href="https://habr.com/ru/company/cisco/blog/310138/">donated</a> for further development at the Apache Foundation (where OpenSOC is being developed under the name Apache Metron).  But this is a joke, but in reality the reason is different.  There is no vendor in the world who has a wide product portfolio on information security and at the same time could support the multi-vendor solution SIEM.  Rare attempts of this kind either lead to the fact that the vendor cannot make a normal vendor-independent monitoring solution and starts losing to niche players (Splunk, IBM, Micro Focus, Elastic, LogRhytm, etc.) focused only on the development of its flagship product, or to the fact that the SIEM turns into a regular console for its own products without a normal management and response subsystem (all forces rush to monitoring).  Cisco, entering the river twice under the name ‚ÄúSIEM‚Äù (the first time with CiscoWorks SIMS, and the second with Cisco MARS), today focuses on a slightly different solution, namely <a href="https://www.cisco.com/c/ru_ru/products/security/threat-response.html">Cisco Threat Response</a> , which is a threat hunting platform and that in the future should be a link for all Cisco cybersecurity solutions. <br><br><img src="https://habrastorage.org/webt/7q/4i/zv/7q4izvfpleqq9pcf_kthrhhx9ru.png" alt="image"><br><a name="habracut"></a><br>  When communicating with customers, they usually describe roughly the same tasks, which sound like this: <br><br><ul><li>  we see millions of events from various defenses, but we are not sure whether they are missing something targeted and directed against us </li><li>  we have a lot of raw security events and we would like to enrich them with data on threat intelligence </li><li>  we receive bulletins from GosSOPKI, FinCERT and commercial companies, but we do not know what to do with them and how to check that the indicators of compromise described in them do not occur, and if they do, then immediately understand where exactly </li><li>  We would like to visualize the relationship between various artifacts and indicators of compromise in relation to our infrastructure and understand the scale of the disaster. </li><li>  we would like to find the threat, quickly block it in the best way </li><li>  we would like to record the picture of the IB at different points in time to track the dynamics </li><li>  we would like to share the results of the investigation with our subsidiaries or within a group of companies </li><li>  we need something simpler and preferably in one low-cost solution. </li></ul><br><img src="https://habrastorage.org/webt/zj/va/pd/zjvapdzfqzgoi6k3wegs6i9gvw8.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If it were not for the last desire, one could offer a whole range of different solutions for Threat Hunting, each of which solves its own problem.  Or you can offer a ‚Äúcombine‚Äù based on any SIEM or SOAR solution, which, however, stands like a spaceship.  We decided to do it easier by developing a lightweight and free threat-hunting platform, Cisco Threat Response, which, as an intermediary between SIEM / SOAR and protection tools, allows you to get the most out of using Cisco solutions by combining them into an integrated cybersecurity system. <br><br><img src="https://habrastorage.org/webt/wd/q5/ku/wdq5kucquxsf0sh0epctxfty9x0.png" alt="image"><br><br>  A year ago, when we just released this platform (it was also called differently - <a href="https://habr.com/ru/company/cisco/blog/417345/">Cisco Visibility</a> ), it could only receive data from three Cisco solutions - AMP for Endpoints, Threat Grid and Umbrella (as well as from an external source of VirusTotal).  Over the past year, we have significantly expanded the possible CTR, integrating it with Cisco Email Security and Cisco Firepower.  Now we have the opportunity to analyze security events received not only at the terminal device level, but also at the email and network security level. <br><br>  Let's take a look at how CTR integration with Cisco Email Security (ESA) works.  Suppose you receive an email notification from Cisco ESA about a malicious attachment found in one of the email messages.  Please note that this is not about detecting a threat on the fly, but about a retrospective analysis, which allowed some time after receiving a letter with an unknown attachment to make a conclusion about its harmfulness.  Now we are faced with the task of understanding who ‚Äúgot under the distribution‚Äù and who among the recipients did not have time to open the attachment and infect their computer, thereby beginning the spread of malicious code over the corporate or departmental network. <br><br><img src="https://habrastorage.org/webt/je/6w/nf/je6wnficxo9p1puyeusep0chhg0.png" alt="image"><br><br>  The resulting indicators (in this case, this hash of the attachment) are placed in the initial CTR window.  We can copy the text of the entire letter received from Cisco ESA - CTR will pull out all indicators of compromise from it. <br><br><img src="https://habrastorage.org/webt/vx/oi/nb/vxoinbwfx5fdsteg7wmmeedyx74.png" alt="image"><br><br>  Further CTR begins its work and reveals that the attachment fell into five mailboxes.  In addition, this file was found on one of the internal nodes of the company. <br><br><img src="https://habrastorage.org/webt/sf/fm/7r/sffm7r9cufzfxmyvrviskli9x9i.png" alt="image"><br><br>  The user may have already managed to open this attachment or save it on his computer.  The user may have received this file in a different way (for example, on a flash drive or by downloading it from any site on the Internet).  In this case, we are most likely dealing with the first option, since the name of the compromised computer coincides with one of the mailboxes that received the malicious attachment. <br><br><img src="https://habrastorage.org/webt/zl/y3/fg/zly3fgidwqddb1q_o0olvwlc-zu.png" alt="image"><br><br>  It seems that the problem is solved and we can block this threat using Cisco AMP for Endpoints without leaving the CTR.  But within the framework of the investigation, we are also interested in whether the PC with the address 192.168,243.108 has become a springboard for the development of the attack or is it connected to an external command server? <br><br><img src="https://habrastorage.org/webt/zr/6j/-l/zr6j-lwzos2ng0ztfneeyjbcfxq.png" alt="image"><br><br>  Our suspicions were justified - the victim's computer is connected to an external and malicious host with the address 62.210.170.57, which in turn is associated with two other malicious files that we can, with a clear conscience, blacklist on AMP for Endpoints or other means of protection. <br><br><img src="https://habrastorage.org/webt/tf/a5/uf/tfa5ufymu8kshuirb_gep2lx0p0.png" alt="image"><br><br>  By the way, please note that you can use as indicators of compromise not only hash data that is checked through Cisco Email Security, but also the names of the senders / recipients of email messages, as well as their topics and other e-mail header fields.  This feature allows you to turn the CTR into a tool for analyzing not only malicious activity, but also other aspects of the organization‚Äôs activities.  I dare to call the CTR visualizer for DLP, which is built into the Cisco ESA. <br><br>  In general, CTR integration with Cisco ESA allows information security analysts to answer the following questions: <br><br><ul><li>  What e-mail messages contain a file with such a name or such and such a hash? </li><li>  Which e-mail messages contain such a topic? </li><li>  What email messages were sent by such a sender? </li><li>  What e-mail messages are associated with such-or-such IP or the sender's domain? </li><li>  What are the details of a message with such a Message ID? </li></ul><br>  At Cisco Live, which took place in San Diego in early June, we announced the integration of CTR with our flagship security tool, Cisco Firepower, a multifunctional security solution.  Its next-generation firewall and intrusion detection subsystems can ‚Äúsend‚Äù security events to CTR related to malicious activity originating from an IP or URL.  This information is displayed in the CTR and is associated with other data received from the terminal device or e-mail.  Also through CTR, malicious IPs or URLs can be blocked on Cisco Firepower. <br><br><img src="https://habrastorage.org/webt/go/b4/cf/gob4cfi64iago7owkefibsk0jsm.png" alt="image"><br><br>  Another new feature in CTR is the Chrome and Firefox browser plugin, which allows you to analyze the current web page and pull out all indicators of compromise ‚Äúin one click‚Äù (for example, from a blog of some company or information security researcher).  In addition to automating the process of capturing indicators of compromise and reducing the number of errors when copying them, this plugin allows you to immediately mark for each IOC its status (pure or malicious), and also include the necessary indicators in the corresponding ticket (it is called Casebook), with which you can work in CTR. <br><br><img src="https://habrastorage.org/webt/sd/uq/pi/sduqpitviltcvtamrpfemfvkkca.png" alt="image"><br><br>  One of the functions, the absence of which caused questions from our customers, was the impossibility of enriching IP addresses or file hashes with external sources of Threat Intelligence.  At the time of launch, Cisco Threat Response supported only TI sources from Cisco (Cisco Talos, Cisco AMP Global, Cisco Threat Grid, and Cisco Umbrella), and from external sources, only VirusTotal.  But now everything has changed - we opened an API that allows you to connect other TI sources, for example, GosSOPKU or FinCERT, BI.ZONE, Group-IB, Kaspersky Lab, or foreign services.  Using the API, you can also automate the process of responding to detected incidents through third-party solutions.  If your infrastructure uses Cisco security solutions, then response functions are already built into Cisco Threat Response: <br><br><ul><li>  blocking a file with an appropriate hash or quarantining a file / process via Cisco AMP for Endpoints </li><li>  domain blocking via Cisco Umbrella </li><li>  Mail Email Quarantine via Cisco Email Security (in future releases) </li><li>  IP and URL blocking via Cisco NGFW / NGIPS (in future releases) </li><li>  URL blocking via Cisco Web Security / SIG (in future releases) </li><li>  internal site quarantine through Cisco ISE (in future releases). </li></ul><br>  In the last <a href="https://habr.com/ru/company/cisco/blog/417345/">article</a> about Cisco Visibility, I was asked if we could integrate not only with Cisco solutions, but also with third-party solutions.  Then I answered in the affirmative, and today I can even show one example of such integration.  In February, Signal Science turned to us, which is known in the world for its next generation WAF.  This company wanted to integrate its solution with CTR.  We gave them access to the documentation and code samples and 10 days later (only ten days), we were shown a working integration that allowed us to send data about events recorded by WAF to the CTR, including data on IP, compromise indicators and meta-data related to attack. <br><br><img src="https://habrastorage.org/webt/oq/3i/yj/oq3iyjriqgf4e2pimwwtu9gbzww.png" alt="image"><br><br>  If you need more details about the incident, the analyst can open the Signal Science WAF directly from the CTR interface. <br><br><img src="https://habrastorage.org/webt/o2/xt/st/o2xtstxabyhvvsayf2qlaktsxza.png" alt="image"><br><br>  Using the API, users of Cisco and Signal Science solutions were able to: <br><br><ul><li>  analyze and correlate data from different information security solutions that complement each other </li><li>  combine in a single ticket indicators of compromise from different solutions </li><li>  cross-react to threats detected by Signal Science using Cisco solutions. </li></ul><br>  I think you noticed above when I mentioned that this solution is free?  Yes it's true.  But to access it, you must have one of the following Cisco solutions deployed - Cisco AMP for Endpoints, Cisco Threat Grid, Cisco Umbrella, Cisco Email Security and Cisco NGFW / NGIPS (and other solutions in the future).  If you are a happy owner of one of these products, then you can easily try out and start actively using the platform for analyzing threats to Cisco Threat Response.  If you are a developer and want to integrate your security solutions with CTR, then you can easily do this after going through a little training and studying code examples on the <a href="https://developer.cisco.com/threat-response/">Cisco DevNet Cisco Community Developer</a> Platform. </div><p>Source: <a href="https://habr.com/ru/post/456234/">https://habr.com/ru/post/456234/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../45622/index.html">Presentations from the User Experience 2008 conference</a></li>
<li><a href="../456220/index.html">Generalization of the Brocard problem</a></li>
<li><a href="../456222/index.html">Genetic engineering of human embryos will be safe and effective within two years</a></li>
<li><a href="../45623/index.html">Browser performance when the page loads</a></li>
<li><a href="../456230/index.html">Quest with iobroker for games ‚ÄúQuests in reality‚Äù</a></li>
<li><a href="../456236/index.html">Peter - Insider Dev Tour: Insider Conference for Microsoft Developers</a></li>
<li><a href="../456240/index.html">Chat bot development (laravel + botman)</a></li>
<li><a href="../456242/index.html">A little more about multitasking in microcontrollers</a></li>
<li><a href="../456246/index.html">Item size zero</a></li>
<li><a href="../456248/index.html">How I caught the styles: before for the focus element</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>