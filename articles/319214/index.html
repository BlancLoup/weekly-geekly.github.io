<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cheap Ways to Heat Up Storage with an SSD</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In articles about the storage system from the ‚Äúadministrator's notes‚Äù, the technologies of software organization of the disk array were practically no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cheap Ways to Heat Up Storage with an SSD</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/a1b/ac3/66f/a1bac366f1404269bb83dba0a394d16f.jpg" alt="image alt text"></p><br><p>  In articles about the storage system from the ‚Äúadministrator's notes‚Äù, the technologies of software organization of the disk array were practically not considered.  In addition, a whole layer of relatively cheap scenarios for accelerating storage using solid-state disks remained behind the scenes. </p><br><p>  Therefore, in this article I will consider three quite good options for using SSD disks to speed up the storage subsystem. <a name="habracut"></a></p><br><h1 id="pochemu-prosto-ne-sobrat-massiv-iz-ssd--nemnogo-teorii-i-rassuzhdeniy-na-temu">  Why not just assemble an array of SSD - a bit of theory and reasoning on the topic </h1><br><p>  Most often, solid-state drives are considered simply as an alternative to HDD, with more bandwidth and IOPS.  However, such a head-on replacement often costs too much (HP branded disks, for example, cost as low as $ 2,000), and the usual SAS drives are returned to the project.  Alternatively, fast disks are simply used dotted. </p><br><p>  In particular, the use of an SSD for a system partition or for a database partition is convenient. You can read the specific performance gains in the <a href="https://habrahabr.ru/post/200464/">corresponding materials</a> .  From the same comparisons, it can be seen that when using conventional HDDs, the bottleneck is disk performance, and in the case of SSDs, the interface will be holding back.  Therefore, replacing a single disk will not always give the same return as a comprehensive upgrade. </p><br><p>  The servers use SSD with SATA interface, or more productive SAS and PCI-E.  The majority of server-side SSD with SAS interface on the market are sold under the HP, Dell and IBM brands.  By the way, even in branded servers, you can use OEM drives Toshiba, HGST (Hitachi) and others that allow you to make the upgrade as cheap as possible with similar characteristics. </p><br><p>  With the widespread use of SSD, a separate protocol for accessing disks connected to the PCI-E bus ‚Äî <a href="https://en.wikipedia.org/wiki/NVM_Express">NVM Express</a> (NVMe) was developed.  The protocol was developed from scratch and considerably exceeds the usual SCSI and AHCI with its capabilities.  Solid state drives with PCI-E, U.2 (SFF-8639) interfaces and some M.2, which are <strong>more than twice</strong> faster than conventional SSDs, usually work with NVMe.  The technology is relatively new, but over time it will definitely take its place in the fastest disk systems. </p><br><div class="spoiler">  <b class="spoiler_title">It is a little about DWPD and influence of this characteristic on a choice of specific model.</b> <div class="spoiler_text"><p>  When selecting SATA solid-state drives, you should pay attention to the DWPD parameter, which determines the durability of the drive.  DWPD (Drive Writes Per Day) is the permissible number of rewriting cycles of the entire disk per day during the warranty period.  Sometimes there is an alternative characteristic of TBW / PBW (TeraBytes Written, PetaBytes Written) - this is the declared volume of recording on the disc during the warranty period.  In SSD for home use, the DWPD indicator can be less than one, in the so-called "server" SSD - 10 or more. </p><br><p>  Such a difference arises due to different types of memory: </p><br><ul><li><p>  <strong>SLC NAND</strong> .  The simplest type - one bit of information is stored in each memory cell.  Therefore, these drives are reliable and have good performance.  But you have to use more memory cells, which negatively affects the cost; </p><br></li><li><p>  <strong>MLC NAND</strong> .  Each cell already contains two bits of information - the most popular type of memory. </p><br></li><li><p>  <strong>eMLC NAND</strong> .  The same as MLC, but increased resistance to rewriting due to more expensive and high-quality chips. </p><br></li><li>  <strong>TLC NAND</strong> .  Each cell stores three bits of information - the disk is as cheap as possible in production, but it has the lowest performance and durability.  To compensate for speed loss, SLC memory is often used for the internal cache. </li></ul><br></div></div><br><p>  Thus, when spot-replacing conventional drives with solid-state drives, it makes sense to use MLC models in RAID 1, which will give excellent speed with the same level of reliability. </p><br><blockquote>  Using RAID with an SSD is not a good idea.  The theory is based on the fact that SSDs in a RAID wear out synchronously and at some point all disks can fail at once, especially when rebuild an array.  However, the situation with HDD is exactly the same.  Unless, damaged blocks of a magnetic surface will not even allow to read information, unlike SSD. </blockquote><p>  Still, the high cost of solid-state drives makes you think about their alternative use, in addition to the point replacement or use of data storage systems based on SSD alone. </p><br><h1 id="rasshiryaem-kesh-raid-kontrollera">  Expanding RAID Controller Cache </h1><br><p>  The size of the array as a whole depends on the size and speed of the RAID controller cache.  You can expand this cache using SSD.  The technology resembles Intel's <a href="https://habrahabr.ru/company/intel/blog/143855/">Smart Response</a> solution. </p><br><p>  When using such a cache, data that is used more often is stored on cache SSDs, from which reading or further writing to a regular HDD is made.  There are usually two modes of operation, similar to the usual RAID: write-back and write-through. </p><br><p>  In the case of write-through, only reading is accelerated, and in the case of write-back, reading and writing are accelerated. </p><br><div class="spoiler">  <b class="spoiler_title">You can read more about these parameters under the spoiler.</b> <div class="spoiler_text"><ul><li><p>  When setting the write-through cache, the recording is performed both in the cache and on the main array.  This does not affect write operations, but speeds up reading.  In addition, power outages or the entire system for data integrity is not so bad; </p><br></li><li>  Setting the write-back allows you to write data directly to the cache, which speeds up read and write operations.  In RAID controllers, this option can be enabled only when using a special non-volatile memory protecting battery, or when using flash memory.  If you use a separate SSD as a cache, then the power problem is no longer worth it. </li></ul><br></div></div><br><p>  Work usually requires a special license or hardware key.  Here are the specific names of the technology among popular manufacturers: </p><br><ul><li><p>  LSI (Broadcom) MegaRAID CacheCade.  Allows you to use up to 32 SSDs under the cache, with a total size of no more than 512 GB, RAID is supported from caching drives.  There are several types of hardware and software keys, the cost is about 20 000 r; </p><br></li><li><p>  Microsemi Adaptec MaxCache.  Allows you to use up to 8 SSDs in cache in any RAID configuration.  You do not need to buy a separate license, the cache is supported in the Q series adapters; </p><br></li><li>  HPE SmartCache in the <a href="https://servermall.ru/catalog/model-hp-dl380e-gen8/server-hp-dl380e-gen8-2/">eighth</a> and <a href="https://servermall.ru/catalog/model-hp-dl380-gen9/server-hp-dl380-gen9/">ninth</a> generation ProLiant servers.  Current price available on request. </li></ul><br><p>  The operation scheme of the SSD cache is extremely simple - frequently used data is moved or copied to the SSD for quick access, while less popular information remains on the HDD.  As a result, the speed with repetitive data increases significantly. </p><br><p>  To illustrate the operation of the SSD-based RAID cache, the following graphs can be given: </p><br><p><img src="https://habrastorage.org/files/986/465/efc/986465efc94e491299d0d365e7173e80.jpg" alt="image alt text"></p><br><p>  <a href="http://www.storagereview.com/">StorageReview</a> is a comparison of the performance of different arrays when working with a database: regular disks and their alternative based on LSI CacheCade are used. </p><br><p>  But if there is a hardware implementation, then surely there is a software equivalent for less money. </p><br><h1 id="bystryy-kesh-bez-kontrollera">  Fast cache without controller </h1><br><p>  In addition to software RAID, there is also a software SSD cache.  In Windows Server 2012, an interesting technology Storage Spaces, which allows you to collect RAID-arrays from any available drives.  Drives are combined into pools, on which data volumes are already placed - the scheme resembles most hardware storage systems.  From the useful features of Storage Spaces can be distinguished storage storage (Tiers) and write cache (write-back cache). </p><br><p><img src="https://habrastorage.org/files/5e9/311/a2d/5e9311a2d8924fa196b6b1735460321e.jpg" alt="image alt text"></p><br><p>  Storage Tiers allows you to create a single pool of HDD and SSD, where more popular data is stored on the SSD.  The recommended ratio of SSD to HDD is 1: 4-1: 6.  When designing, it is worth considering the possibility of mirroring or parity (analogs of RAID-1 and RAID-5), since each part of the mirror should have the same number of regular disks and SSD. </p><br><p>  The write cache in Storage Spaces is no different from the usual write-back in RAID arrays.  Only here the necessary volume "bites off" from the SSD and the default is one gigabyte. </p><br><p>  The general scheme of work is as follows: </p><br><ul><li><p>  When writing to a blank disc, the data is stored on the SSD; </p><br></li><li><p>  When the SSD is full, the data is written to the write-back cache, which is written to the HDD; </p><br></li><li><p>  If the cache is full, recording is done directly to the HDD; </p><br></li><li>  In the process, the data is reorganized so that the ‚Äúhot‚Äù information is stored on the SSD, and the ‚Äúcold‚Äù information is stored on the HDD. </li></ul><br><p>  If you consider other operating systems, the technology is available even more.  For example, GNU \ Linux has <a href="http://bcache.evilpiepirate.org/">bcache</a> , <a href="http://www.stec-inc.com/product/ssdcache.php">EnhanceIO</a> , <a href="https://github.com/mingzhao/dm-cache">dm-cache</a> and <a href="http://man7.org/linux/man-pages/man7/lvmcache.7.html">lvmcache</a> , <a href="http://www.zfsbuild.com/2010/04/15/explanation-of-arc-and-l2arc/">L2ARC</a> in ZFS, <a href="http://docs.ceph.com/docs/giant/rados/operations/cache-tiering/">Cache Tiering</a> and <a href="http://docs.ceph.com/docs/giant/dev/cache-pool/">Cache Poo</a> l in Cephs. </p><br><p>  If we talk about software acceleration of the disk system, then an interesting option is the use of RAM for this purpose.  There are a number of applications that allow you to "bite off" part of the RAM under the cache - for example, <a href="https://www.romexsoftware.com/en-us/primo-cache/">PrimoCache</a> .  Such solutions, in addition to speeding up work, will help extend the life of the SSD.  The main thing is to provide protection from <a href="https://habrahabr.ru/company/pc-administrator/blog/310698/">power problems</a> and not to place too important data in such sections. </p><br><h1 id="itogo">  Total </h1><br><p>  File and web servers work well with a cache on the SSD, and for placing the production database, the RAID array from regular disks is better than the data and the separate SSD mirror for transaction logs.  The remaining data scenarios require more creative approach and knowledge of the specifics of use. </p><br><p>  <strong>If you have your own techniques for the proper use of solid-state drives - share in the comments to supplement the examples from the article.</strong> </p><br><p>  <strong>At the same time, tell us what you think about RAM disks - is this just for fun technology, in your opinion?</strong> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/319214/">https://habr.com/ru/post/319214/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319202/index.html">Pure Python Architecture: A Walkthrough. Part 2</a></li>
<li><a href="../319204/index.html">VulnHub: Parse the shortest quest DC416 Fortress</a></li>
<li><a href="../319208/index.html">Learn ActionBlock: or a short story about otherwise deadlock</a></li>
<li><a href="../319210/index.html">Bitrix Start Performance on Proxmox and Virtuozzo 7 & Virtuozzo Storage</a></li>
<li><a href="../319212/index.html">"IT infrastructure": Where we go with the "cloud" in 2017</a></li>
<li><a href="../319216/index.html">Simple FDTD implementation in Java</a></li>
<li><a href="../319218/index.html">Detection in the code of the defect "null pointer dereferencing"</a></li>
<li><a href="../319222/index.html">Reducing the amount of PostgreSQL data on disk</a></li>
<li><a href="../319226/index.html">Simple and fast terrain generation algorithm</a></li>
<li><a href="../319228/index.html">Saving and loading the game in the Unreal Engine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>