<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúSteal in 60 seconds‚Äù using one car sharing example</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúWithout disappointment you will not feel the taste of victory‚Äù ¬© Memphis Reims 

 The story began trite. In some video on YouTube they told about car...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúSteal in 60 seconds‚Äù using one car sharing example</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/d67/f48/899/d67f48899df64210f2ea2489cae38ccc.jpg" alt="image"><br>  <i>‚ÄúWithout disappointment you will not feel the taste of victory‚Äù ¬© Memphis Reims</i> <br><br>  The story began trite.  In some video on YouTube they told about car sharing.  With the demonstration of the function "greetings" when you can not find a car in a large parking lot.  I immediately had the idea to check - and if I can not activate the function of greeting on absolutely all the cars of this company?  Well, fun.  Large Russian city.  And at some point, thousands of cars on command begin to signal and blink headlights.  Almost like in the movie "Die Hard 4". <br><br>  As a result, everything turned out much more interesting.  After all, in fact, I found the possibility of theft of any car. <br><a name="habracut"></a><br>  Inside the application for users, everything is standard.  Downloading resources, splash-screen and application login form. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But then my idea of ‚Äã‚Äãmanipulating all the cars crashed against the stones.  Recently, I do not live in Russia and the application can not enter without a Russian phone number.  The application does not support international number format.  And for some reason I didn‚Äôt remember about virtual numbers. <br><br>  In desperation, I guessed to enter +7 000 0000000. And there was no limit to surprise when the next step appeared with a proposal to enter the code from sms.  Another 60 second countdown started, hinting that the password is very short.  And what you need to hurry. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c17/a52/da4/c17a52da4a8f71367a7373dbbc95d042.jpg" alt="image"><br><br>  How so?  What sms if the number can not be real at all? <br><br>  This situation led me to draw several conclusions: <br><br><ul><li>  The application does not check the format of the phone. </li><li>  Probably, the format of the number can be thrown by another, just by intercepting the request and changing it on the fly </li><li>  the application, regardless of which phone is received, sends a command to generate a password to the user. </li></ul><br>  Ie somewhere in the database waiting for us a password.  Which was assigned to our beautiful number +7 000 0000000. <br><br>  In general, this user authentication method is called OTP (One Time Password). <br>  Ie, the password that was ‚Äúassigned‚Äù to us should be used only once. <br><br>  It seems to be a dead end.  You can turn off the laptop, phone and go to bed.  But the thought did not let me go - what if I picked up this password?  After all, we have only 10,000 possible options!  The success of this venture was dubious.  It was possible to catch the captcha, blocking, in the end, with my choice I could provoke a single call to the ‚Äúsuccessful password‚Äù.  And in the OTP format, reuse of this password is not allowed.  What can we say about the countdown timer, which has long ended. <br><br>  The right moment for this gif. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f19/c37/60f/f19c3760fd0c359b2e5df7d9cad05bf6.gif" alt="image"><br><br>  I catch a password request.  I make the password a dynamic parameter.  I set the range of possible values ‚Äã‚Äãfor enumeration.  With crossed fingers, I launch an attack on the pick.  In the process of such attacks, I never try to disguise my actions.  I do not replace the ip address.  I do not use VPN.  I do not put a small number of threads.  I do not need it.  I have no motivation not to notice me. <br><br>  After 60 seconds, the server‚Äôs response is visible.  Successful password found. <br><br>  But will it be reused?  After all, this is One Time Password. <br><br>  In the application, the countdown timer already sadly highlighted the password entry field in gray.  Alluding to the fact that I was late. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/734/6f5/3ef/7346f53ef962b47470a04977754ddfd3.jpg" alt="image"><br><br>  I put the cursor in the field with a password.  I erase the previously entered one, enter the successfully selected password and press the login button. <br><br>  And here is another problem.  The application says that we are some kind of "not confirmed user".  And throws in a couple of seconds on the main page. <br><br>  Or I could not realize all our plans.  Or my user really did not pass any moderation, document confirmation and all that ... <br><br>  In this situation, there were only two options.  Or look for friends who use this service.  Or search for active users who have lit up their mobile numbers on the Internet. <br><br>  Well, as you understand friends at such a late time, I would not even find it if I wanted to. <br>  That's why I went to look for users.  It was the easiest.  In social networks found the official car sharing community.  Looked at the comments of the latest publications.  Opened the pages of several users.  On 3 or 4 profiles of one of the users managed to find a published mobile number. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27e/901/620/27e901620bae2c8122916ec711986e27.jpg" alt="image"><br><br>  I took this number and went to check the theory of hacking. <br><br>  A few minutes later I was wandering through the application and studied its possibilities.  The user had a huge travel history.  Several tens of thousands of bonus money that can be used for travel.  Well, a few cards for payment, which were tied to the profile of this user. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/257/9ec/041/2579ec04139efb0d55a60feccad340b3.jpg" alt="image"><br><br>  Having studied videos on YouTube and reviews, it became clear that when renting a car from this user, I would not have to enter any additional combination of numbers protecting the car from theft through a hacked account. <br><br>  Ie I had an absolutely open opportunity to rent any car without presenting the required documents.  At the same time take the car and pay on behalf of the hacked user.  Pay for possible fines from the traffic police would have the same way our victim. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e65/2fc/4d1/e652fc4d1ee05f18bc4da4bef0ea237a.jpg" alt="image"><br><br>  At this point, I just lost sleep.  Of course, the fact that I got access to a user account is not correct.  But because of this, I was able to detect dangerous logical vulnerabilities. <br><br>  A few seconds later I wrote posts to the carsharing manager and the head of the IT department.  Find them was not difficult. <br><br>  People responded adequately to the situation.  Without objection, I took into account all the problems that I discovered.  And started to correct.  After 1-2 weeks the problems were resolved.  I was even offered a car for free use for several days.  But I preferred not to complicate my life for someone else's car in a foreign city (during a business trip). <br><br>  From this whole story you need to draw the following conclusions: <br><br><ul><li>  Do not neglect the protection from Brute-force. </li><li>  Check the format of the phone number if it is used as a login. </li><li>  After using a single OTP should not work. </li><li>  The life span of an OTP should be short, even if it is not used. </li><li>  You should not use a phone number as a login. </li><li>  It is better to do additional user authorization when renting a car through a PIN code (the code that the user himself sets during registration).  The user must enter this PIN code in order to unlock the vehicle. </li></ul><br>  So it goes. </div><p>Source: <a href="https://habr.com/ru/post/343090/">https://habr.com/ru/post/343090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343068/index.html">Black Friday in the Infobox</a></li>
<li><a href="../343082/index.html">Data from Google Spreadsheets on your site</a></li>
<li><a href="../343084/index.html">WebGL: transfer game from mobile platform to desktop</a></li>
<li><a href="../343086/index.html">Example of reengineering a real business process or when there is no forest behind the trees</a></li>
<li><a href="../343088/index.html">Black Friday in a new light: non-standard strategies from global brands</a></li>
<li><a href="../343092/index.html">Course Fortinet Getting Started</a></li>
<li><a href="../343094/index.html">Interviews with representatives of Google Play Apps and Games on the mobile gaming market in Russia</a></li>
<li><a href="../343096/index.html">Learn OpenGL. Lesson 4.3 - Mixing colors</a></li>
<li><a href="../343098/index.html">Pros and cons of development on Xamarin</a></li>
<li><a href="../343100/index.html">A new and promising development methodology, which has already been called the ‚ÄúAgile killer‚Äù *</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>