<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Linux assembler development</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In general, programming in assembler in Linux is not very common and is done by him, perhaps, assembler fans. Today we will talk about programming in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Linux assembler development</h1><div class="post__text post__text-html js-mediator-article">  In general, programming in assembler in Linux is not very common and is done by him, perhaps, assembler fans.  Today we will talk about programming in assembler and toolkit. <a name="habracut"></a>  What we need: <br><ul><li>  FASM.  Take on the flatassembler.net version for Linux </li><li>  ald.  We take on ald.sourceforge.net </li><li>  shed.  We take on shed.sourceforge.net </li><li>  ld.  There are in most distributions </li></ul><br>  Actually everyone chooses the tools for himself.  I chose these for me. <br><br><h4>  FASM installation </h4><br>  After downloading the archive off.  Site unpack it: <br><br> <code>tar zxvf fasm-1.69.11.tgz</code> <br> <br>  In the folder we will have a binary file fasm, which we can use for compilation.  For convenience, you can create a symlink to it: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>sudo ln -s /home/username/fasm/fasm /usr/local/bin</code> <br> <br>  ald and shed are installed no more difficult: <br><br> <code>$ ./configure <br> $ make <br> # make install</code> <br> <br>  As a result, we will have 3 useful tools for programming in assembler. <br><br><h4>  System calls </h4><br>  Like most other operating systems, Linux provides so-called.  API - a set of useful functions for the programmer.  In most cases, the system function is called using the 80h interrupt.  It should be noted that Linux uses the fastcall convention of passing parameters.  According to it, parameters are passed through registers (in windows, for example, stdcall is used, where parameters are passed through the stack).  The number of the function being called is put in eax, and the parameters in the registers: <br><br>  Parameter Number / Register <br><br>  1 / ebx <br>  2 / ecx <br>  3 / edx <br>  4 / esi <br>  5 / edi <br>  6 / ebp <br><br>  As you can see everything is not so difficult.  You can find out the number of the system function, its description and parameters, at least <a href="http://www.unusedino.de/linuxassembly/syscall.html">here</a> .  Take <code>sys_exit</code> for example.  As you can see on that page, it has one parameter - the return code and it has the sequence number 1. Thus, we can call it with the following code: <br><br> <code>mov eax, 1 ; 1 -    <br> sub ebx, ebx ;   (   mov ebx, 0) <br> int 80h ;   80h</code> <br> <br>  I hope that everything is clear. <br><br><h4>  Hello, World! </h4><br>  Well then.  We will not write anything, because  everything is written for us :) In the <code>fasm/examples/elfexe</code> there is a file hello.asm, which contains the following code: <br><br> <code>; fasm demonstration of writing simple ELF executable <br> <br> format ELF executable 3 <br> entry start <br> <br> segment readable executable <br> <br> start: <br> <br> mov eax,4 <br> mov ebx,1 <br> mov ecx,msg <br> mov edx,msg_size <br> int 0x80 <br> <br> mov eax,1 <br> xor ebx,ebx <br> int 0x80 <br> <br> segment readable writeable <br> <br> msg db 'Hello world!',0xA <br> msg_size = $-msg</code> <br> <br>  As you can see, 2 system functions are called here - <code>sys_write</code> (with sequence number 4) and <code>sys_exit</code> .  <code>sys_write</code> takes 3 parameters ‚Äî an output stream handle (1 - stdout), a pointer to a string, and a string size.  The number of the function itself, as already mentioned, we must put in eax.  The <code>sys_exit</code> function <code>sys_exit</code> already been <code>sys_exit</code> .  You can <code>fasm hello.asm</code> this miracle like this: <code>fasm hello.asm</code> (but not necessary, because there is a binary in the same place where the source is located). <br><br><h4>  Let's see what's inside </h4><br>  I think it's time to look at our binary.  To begin with, let's use the hex editor to see what we did.  Run the command: <br><br> <code>shed hello</code> <br> <br><img src="http://62.149.5.84.nyud.net/i4/e6/70/672d86efdd3eccad5d5b8eb26f62.jpeg" alt="image"><br><br>  We see our entire program, data, elf-header.  Not bad?  Now we look at our program in the debugger.  We type in the console: <br><br> <code>ald hello</code> <br> <br>  We should greet the line with a proposal to enter a command.  You can find the list of commands by typing <code>help</code> or get help from a separate command by typing <code>help command</code> .  Disassembling our program is possible with the <code>disassemble</code> command (or its alias is " <code>d</code> ").  You will see a disassembled listing of your program.  The address on the left, the command itself on the right, and the command opcode in the middle. <br><br>  You can get the dump command <code>dump</code> (strange, but it is not in the output command <code>help</code> ). <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/768/59a/310/76859a3103f27b97179667ef3739dc07.jpg" alt="image"><br><br>  Now let's try working with the <code>next</code> command.  Execute it and in response you will be shown the values ‚Äã‚Äãof the registers, the set flags, as well as the address, opcode and disassembled command that should be executed next.  Try to execute commands and watch for changes in flags and registers.  After calling the first interruption, you should see ‚ÄúHello world!‚Äù On your screen. <br><br>  The purpose of this article was to show the basics of programming in assembler in linux, and not programming in assembler in general.  I hope that you have learned something useful from here. <br><br>  Ps.  The first article on Habr√©. <br><br><h4>  useful links </h4><br>  <a href="http://asm.sourceforge.net/">asm.sourceforge.net</a> <br>  <a href="http://www.int80h.org/">www.int80h.org</a> </div><p>Source: <a href="https://habr.com/ru/post/79454/">https://habr.com/ru/post/79454/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79445/index.html">NPL Snowman by NPL</a></li>
<li><a href="../79446/index.html">iWebkit as a way to optimize your site for iPhone</a></li>
<li><a href="../79447/index.html">Weekday gamedev</a></li>
<li><a href="../79448/index.html">Samsung GT-i5700 Galaxy Spica Review</a></li>
<li><a href="../79449/index.html">Social hacking in everyday life (defending ourselves from stupid things)</a></li>
<li><a href="../79455/index.html">Hypertext Vector Fidonet</a></li>
<li><a href="../79461/index.html">About the exact time</a></li>
<li><a href="../79462/index.html">Approved the concept of using open software in the state bodies of Ukraine</a></li>
<li><a href="../79463/index.html">Meet, http://erlanger.ru/</a></li>
<li><a href="../79464/index.html">Use Google Text To Speech</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>