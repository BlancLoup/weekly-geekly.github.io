<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WPA2-Enterprise, or the right approach to Wi-Fi network security</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, there have been many ‚Äúexposing‚Äù publications about hacking into any regular protocol or technology that compromises the security of wireless...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WPA2-Enterprise, or the right approach to Wi-Fi network security</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/storage2/8ca/3bc/210/8ca3bc2102f7a45a3fb29ff666745a70.jpg">  Recently, there have been many ‚Äúexposing‚Äù publications about hacking into any regular protocol or technology that compromises the security of wireless networks.  Is it really so, what is it worth being afraid of, and how to ensure that access to your network is as secure as possible?  The words WEP, WPA, 802.1x, EAP, PKI mean little to you?  This short overview will help bring together all the applied encryption technology and authorization of radio access.  I will try to show that a properly configured wireless network is an insurmountable barrier for an attacker (up to a certain limit, of course). <br><br><a name="habracut"></a><br><br><h4>  The basics </h4><br>  Any interaction between the access point (network) and the wireless client is built on: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <b>Authentication</b> - as the client and the access point are presented to each other and confirm that they have the right to communicate with each other; </li><li>  <b>Encryption</b> - which scrambling algorithm of the transmitted data is applied, how the encryption key is generated, and when it changes. </li></ul><br><br>  Wireless network settings, first of all its name (SSID), are regularly announced by the access point in broadcast beacon packets.  In addition to the expected security settings, wishes are transmitted on QoS, on 802.11n parameters, supported speeds, information on other neighbors, and so on.  Authentication defines how a client is presented to a point.  Possible options: <br><br><ul><li>  <b>Open</b> - the so-called open network, in which all connected devices are authorized immediately </li><li>  <b>Shared</b> - the authenticity of the device to be connected must be verified with a key / password </li><li>  <b>EAP</b> - the authenticity of the connected device must be verified by the EAP protocol by an external server </li></ul><br>  The openness of the network does not mean that anyone can work with it with impunity.  In order to transmit data in such a network, it is necessary to match the encryption algorithm used, and, accordingly, to establish the encrypted connection correctly.  The encryption algorithms are as follows: <br><br><ul><li>  <b>None</b> - no encryption, data is transmitted in the clear </li><li>  <b>WEP</b> - cipher based on RC4 algorithm with different length of static or dynamic key (64 or 128 bits) </li><li>  <b>CKIP</b> is Cisco's proprietary replacement of WEP, an early version of TKIP </li><li>  <b>TKIP</b> - Improved WEP Replacement with Additional Checks and Security </li><li>  <b>AES / CCMP</b> is the most advanced algorithm based on AES256 with additional checks and security. </li></ul><br><br>  The combination of <b>Open Authentication, No Encryption is</b> widely used in guest access systems such as the provision of the Internet in a cafe or hotel.  To connect you need to know only the name of the wireless network.  Often such a connection is combined with an additional check on the Captive Portal by redirecting a custom HTTP request to an additional page where you can request confirmation (login and password, agreement with the rules, etc.). <br><br>  <b>WEP encryption is</b> compromised and cannot be used (even in the case of dynamic keys). <br><br>  The widely used terms <b>WPA</b> and <b>WPA2</b> define, in fact, the encryption algorithm (TKIP or AES).  Since client adapters support WPA2 (AES) for quite some time, it makes no sense to use TKIP encryption. <br><br>  The difference between <b>WPA2 Personal</b> and <b>WPA2 Enterprise</b> is where the encryption keys come from, which are used in the mechanics of the AES algorithm.  For private (home, small) applications, a static key (password, code word, PSK (Pre-Shared Key)) is used with a minimum length of 8 characters, which is set in the access point settings, and all clients of this wireless network are the same.  The compromise of such a key (they let the neighbor talk, the employee was dismissed, the laptop was stolen) requires that all remaining users immediately change the password, which is realistic only in the case of a small number of them.  For corporate applications, as the name implies, a dynamic key is used that is individual for each working client at the moment.  This key can be periodically updated as you work without breaking the connection, and an additional component ‚Äî the authorization server ‚Äî is responsible for generating it, and it is almost always a RADIUS server. <br><br>  All possible security parameters are summarized in this table: <br><table><tbody><tr><td>  Property </td><td>  Static WEP </td><td>  Dynamic WEP </td><td>  WPA </td><td>  WPA 2 (Enterprise) </td></tr><tr><td>  Identification </td><td>  User, computer, WLAN card </td><td>  User computer <br></td><td>  User computer <br></td><td>  User computer <br></td></tr><tr><td>  Authorization <br></td><td>  Shared key <br></td><td><br>  EAP <br></td><td><br>  EAP or Shared Key <br></td><td><br>  EAP or Shared Key <br></td></tr><tr><td><br>  Integrity <br></td><td><br>  32-bit Integrity Check Value (ICV) <br></td><td><br>  32-bit ICV <br></td><td><br>  64-bit Message Integrity Code (MIC) <br></td><td><br>  CRT / CBC-MAC (Counter Mode Cipher Block Chain Auth Code - CCM) Part of AES <br></td></tr><tr><td><br>  Encryption <br></td><td><br>  Static key <br></td><td><br>  Session key <br></td><td><br>  Per key via TKIP <br></td><td><br>  CCMP (AES) <br></td></tr><tr><td><br>  Key distribution <br></td><td><br>  Single, manually <br></td><td><br>  Pair-wise Master Key (PMK) Segment <br></td><td><br>  Derived from PMK <br></td><td><br>  Derived from PMK <br></td></tr><tr><td><br>  Initialization vector <br></td><td><br>  24 bit text <br></td><td><br>  24 bit text <br></td><td><br>  Extended vector, 65 bits <br></td><td><br>  48-bit packet number (PN) <br></td></tr><tr><td><br>  Algorithm <br></td><td><br>  RC4 <br></td><td><br>  RC4 <br></td><td><br>  RC4 <br></td><td><br>  AES <br></td></tr><tr><td><br>  Key length, bit <br></td><td><br>  64/128 <br></td><td><br>  64/128 <br></td><td><br>  128 <br></td><td><br>  up to 256 <br></td></tr><tr><td><br>  Required infrastructure <br></td><td><br>  Not <br></td><td><br>  RADIUS <br></td><td><br>  RADIUS <br></td><td><br>  RADIUS <br></td></tr></tbody></table><br><br>  If everything is clear with WPA2 Personal (WPA2 PSK), the corporate solution requires additional consideration. <br><br><h4>  WPA2 Enterprise </h4><br><img src="https://habrastorage.org/storage2/501/177/e68/501177e68355ba582e372648ba160712.jpg"><br>  Here we are dealing with an additional set of different protocols.  On the client side, a special software component, supplicant (usually part of the OS), interacts with the authorizing part, the AAA server.  This example displays the operation of a unified radio network built on lightweight access points and a controller.  In case of using ‚Äúwith brains‚Äù access points, the entire point of intermediary between clients and the server can be assumed by the point itself.  In this case, the data of the client supplikant are transmitted by radio to the 802.1x protocol (EAPOL), and on the controller side, they are wrapped in RADIUS packets. <br><br>  The use of EAP authorization mechanism in your network leads to the fact that after successful (almost certainly open) client authentication by the access point (together with the controller, if any), the latter asks the client to authorize (confirm its credentials) from the RADIUS infrastructure server <br><br><img src="https://habrastorage.org/storage2/2a6/cce/a30/2a6ccea309a4329d87191d6d93ecce1c.jpg"><br><br>  Using <b>WPA2 Enterprise</b> requires that you have a RADIUS server on your network.  To date, the most efficient are the following products: <br><ul><li>  <b>Microsoft Network Policy Server (NPS), formerly IAS</b> - configurable via MMC, is free, but you need to buy Windows </li><li>  <b>Cisco Secure Access Control Server (ACS) 4.2, 5.3</b> ‚Äî configurable via a web interface, enhanced by functionality, allows you to create distributed and fault-tolerant systems, it is expensive </li><li>  <b>FreeRADIUS</b> is free, configurable by text configs, it is not convenient to manage and monitor </li></ul><br><br>  In this case, the controller closely monitors the ongoing exchange of information, and waits for successful authorization, or failure of it.  If successful, the RADIUS server is able to transfer additional parameters to the access point (for example, in which VLAN to place the subscriber, which IP address, QoS profile, etc.) to assign to it.  At the end of the exchange, the RADIUS server allows the client and the access point to generate and exchange encryption keys (individual, valid for this session only): <br><br><img src="https://habrastorage.org/storage2/f22/81f/e53/f2281fe53051e9253862120df340c242.jpg"><br><br><h4>  EAP </h4><br>  The EAP protocol itself is containerized, that is, the actual authorization mechanism is given at the mercy of the internal protocols.  To date, the following have become of some significant distribution: <br><ul><li>  <b><a href="http://en.wikipedia.org/wiki/Extensible_Authentication_Protocol">EAP-FAST</a></b> (Flexible Authentication via Secure Tunneling) - developed by Cisco;  allows to perform authorization using a login password transmitted within the TLS tunnel between the supplikant and the RADIUS server </li><li>  <b><a href="http://en.wikipedia.org/wiki/Extensible_Authentication_Protocol">EAP-TLS</a></b> (Transport Layer Security).  It uses the public key infrastructure (PKI) to authorize the client and server (supplikant and RADIUS server) through certificates issued by a trusted authority (CA).  It requires the issuance and installation of client certificates for each wireless device, therefore, it is suitable only for a managed corporate environment.  Windows Certificate Server has the means to allow the client to independently generate a certificate if the client is a member of a domain.  Blocking a client is easily done by revoking his certificate (or through accounts). </li><li>  <b><a href="http://en.wikipedia.org/wiki/Extensible_Authentication_Protocol">EAP-TTLS</a></b> (Tunneled Transport Layer Security) is similar to EAP-TLS, but a client certificate is not required when creating a tunnel.  In such a tunnel, similar to the SSL connection of the browser, additional authorization is made (by password or something else). </li><li>  <b><a href="http://en.wikipedia.org/wiki/Protected_Extensible_Authentication_Protocol">PEAP-MSCHAPv2</a></b> (Protected EAP) - similar to EAP-TTLS in terms of the initial establishment of an encrypted TLS tunnel between a client and a server, requiring a server certificate.  Further, in such a tunnel, authorization occurs according to the well-known MSCHAPv2 protocol. </li><li> <b><a href="http://en.wikipedia.org/wiki/Extensible_Authentication_Protocol">PEAP-GTC</a></b> (Generic Token Card) - similar to the previous one, but requires one-time password cards (and the corresponding infrastructure) </li></ul><br><br>  All of these methods (except EAP-FAST) require a server certificate (on a RADIUS server) issued by a certification authority (CA).  At the same time, the CA certificate itself must be present on the client device in the trusted group (which is easy to implement using Group Policy in Windows).  Additionally, EAP-TLS requires an individual client certificate.  Client authentication is performed both digitally and (optionally) comparing the certificate provided by the client to the RADIUS server with what the server extracted from the PKI infrastructure (Active Directory). <br><br>  Support for any of the EAP methods should be provided by the client side supplicant.  Standard, built-in Windows XP / Vista / 7, iOS, Android provides at least EAP-TLS, and EAP-MSCHAPv2, which makes these methods popular.  Intel client adapters for Windows come with a ProSet utility that extends the available list.  The Cisco AnyConnect Client does the same. <br><br><img src="https://habrastorage.org/storage2/11f/b3b/222/11fb3b222b1a405e9af9164f555b8eae.jpg"><br><br><img src="https://habrastorage.org/storage2/64a/393/d5c/64a393d5c1588c1a879aaa5227e7cc72.jpg"><br><br><h4>  How reliable is it </h4><br>  In the end, what does an attacker need to hack into your network? <br><br>  For Open Authentication, No Encryption - nothing.  Connected to the network, that's all.  Since the radio environment is open, the signal spreads in different directions, blocking it is not easy.  With the appropriate client adapters that allow you to listen to the broadcast, the network traffic is visible just as if the attacker connected to the wire, to the hub, to the SPAN port of the switch. <br>  WEP-based encryption requires only an IV scan time, and one of many freely available scanning utilities. <br>  For encryption based on TKIP or AES, direct decryption is possible in theory, but in practice there have been no cases of hacking. <br><br>  Of course, you can try to find a PSK key, or a password to one of the EAP methods.  Common attacks on these methods are not known.  You can try to apply the methods of social engineering, or <a href="http://lurkmore.to/%25D0%25A2%25D0%25B5%25D1%2580%25D0%25BC%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BA%25D1%2582%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BA%25D1%2580%25D0%25B8%25D0%25BF%25D1%2582%25D0%25BE%25D0%25B0%25D0%25BD%25D0%25B0%25D0%25BB%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2582%25D0%25BE%25D1%2580">thermorectal cryptanalysis</a> . <br><br>  You can get access to the network protected by EAP-FAST, EAP-TTLS, PEAP-MSCHAPv2 only if you know the username and password of the user (hacking is not possible as such).  Brute-force attacks, or those aimed at vulnerabilities in MSCHAP, are also not possible or difficult because the client-server EAP channel is protected by an encrypted tunnel. <br><br>  Access to a network closed by PEAP-GTC is possible either by hacking the token server or by stealing a token with its password. <br><br>  Access to a network closed by EAP-TLS is possible by stealing a user certificate (along with its private key, of course), or by issuing a valid, but fake certificate.  This is only possible if the certification center is compromised, which in normal companies is protected as the most valuable IT resource. <br><br>  Since all the above-mentioned methods (except PEAP-GTC) allow saving (caching) passwords / certificates, then if a mobile device is stolen, an attacker gets full access without unnecessary questions from the network.  As a measure of prevention, full encryption of the hard disk can be used with a password request when the device is turned on. <br><br>  <b>Remember: with proper design, the wireless network can be very well protected;</b>  <b>means of hacking such a network does not exist</b> (to a certain limit) </div><p>Source: <a href="https://habr.com/ru/post/150179/">https://habr.com/ru/post/150179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150173/index.html">Shell 3D in the first Intel-based smartphone</a></li>
<li><a href="../150175/index.html">Laser thermonuclear fusion: history</a></li>
<li><a href="../150176/index.html">Create a RESTful web service in Java using Eclipse + Jersey + Glassfish3</a></li>
<li><a href="../150177/index.html">Check ideas by fighting: fake landing page</a></li>
<li><a href="../150178/index.html">A small text report on SIGGRAPH 2012</a></li>
<li><a href="../150180/index.html">Zello: Turn the phone into a walkie-talkie</a></li>
<li><a href="../150181/index.html">We write Twitter bot based on GitHub API</a></li>
<li><a href="../150182/index.html">Interview with John Lindquist, JetBrains Evangelist</a></li>
<li><a href="../150183/index.html">Forecasting the effectiveness of internet marketing</a></li>
<li><a href="../150184/index.html">BackDoor.Wirenet.1 - the first cross-platform Trojan running on Linux and Mac OS X</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>