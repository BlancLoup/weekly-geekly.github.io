<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Family tree inside git</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Congratulations to all the programmer's day! I wish more bright "commits" made by "pull-rekvestov", less unplanned "merzhey" and that your branches of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Family tree inside git</h1><div class="post__text post__text-html js-mediator-article"><p>  Congratulations to all the programmer's day!  I wish more bright "commits" made by "pull-rekvestov", less unplanned "merzhey" and that your branches of life remain relevant as long as possible.  As an ideological gift, I propose the implementation of a genealogical tree by means of the Git version control system.  Well ... sounds like a plan! </p><br><p> <a href="https://habr.com/post/351158/"><img src="https://habrastorage.org/webt/yh/yy/rd/yhyyrddjg12ufgdhyvfvis06au8.png" alt="Kochurkins"></a> </p><br><p>  For those who immediately understood everything, I post the source of the generator: <a href="">GenealogyTreeInGit</a> and the family trees themselves - <a href="">mine</a> and the <a href="">presidents of the United States</a> . </p><br><p>  In addition, I implemented a simple <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BE%25D1%2586%25D0%25B8%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584"><strong>social graph</strong></a> .  It displays not only the degree of kinship, but also the status of relations between descendants, displays events such as wedding, divorce, childbirth, as well as contributions to the relations of various parties. </p><a name="habracut"></a><br><h2 id="git">  Git </h2><br><table><tbody><tr><td width="100"><img src="https://habrastorage.org/getpro/habr/post_images/f88/b0e/f64/f88b0ef6424badfdda8a5e700e04e39e.svg"></td><td>  Let me remind you that <b><a href="https://ru.wikipedia.org/wiki/Git">Git</a></b> is one of the most popular version control systems.  It is powerful: you can commit changes in it, create and merge branches (checkout and merge), compare different versions of files (diff), calculate authors of specific strings (blame), and do many other things. </td></tr></tbody></table><br><p>  Fortunately or unfortunately, Git is in some way similar to the winning state: it allows you to change the history, namely, change the dates, messages and authors of commits.  But this contributes to the contrary in that it allows you to add family members, as if they are the authors of events made on a specific date. </p><br><p>  I started with a simple one: I wrote several commands and voila - a fragment of the tree is ready.  Fine.  Now we have to do this with the whole army of relatives.  I am happy to write 200 lines of teams for them in which you can get confused, and for presidents - all 10K! </p><br><br><p>  Added me to the list of idiots?  Cross off.  Of course, I automated the process and wrote an application for converting genealogical data into a sequence of gita commands.  There are several formats for such data, I chose <strong>GEDCOM</strong> . </p><br><h2 id="gedcom">  Gedcom </h2><br><table><tbody><tr><td width="100"><img src="https://habrastorage.org/getpro/habr/post_images/1ae/970/cd2/1ae970cd20d60e45923e9399033ceafc.svg"></td><td>  <b><a href="https://ru.wikipedia.org/wiki/GEDCOM">GEDCOM</a></b> is a format for describing genealogical trees.  Pretty old, but textual and generally simple.  The format specification is well <a href="https://webtreeprint.com/tp_famous_gedcoms.php">described</a> on the Internet.  It is supported by almost all genealogical programs, so there are <a href="https://webtreeprint.com/tp_famous_gedcoms.php">many</a> examples for it: the tree of US presidents, the royal dynasty, Shakespeare. </td></tr></tbody></table><br><p>  I implemented all this mess on <a href="https://www.microsoft.com/net/learn/get-started-with-dotnet-tutorial">.NET Core</a> - it is convenient and cross-platform.  For parsing and processing GEDCOM there are several libraries under C #, for example, <a href="https://github.com/TheGeneGenieProject/GeneGenie.Gedcom">GeneGenie.Gedcom</a> , <a href="https://github.com/FamilySearch/gedcomx-csharp">gedcomx-csharp</a> .  I decided to write my own based on <a href="https://github.com/jaklithn/GedcomParser">GedcomParser</a> .  Well, because it has a <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D0%25B4%25D1%2580%25D0%25BE%25D0%25BC_%25D0%25BD%25D0%25B5%25D0%25BF%25D1%2580%25D0%25B8%25D1%258F%25D1%2582%25D0%25B8%25D1%258F_%25D1%2587%25D1%2583%25D0%25B6%25D0%25BE%25D0%25B9_%25D1%2580%25D0%25B0%25D0%25B7%25D1%2580%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D0%25BA%25D0%25B8">fatal flaw</a> ... In fact, no: I wanted to myself myself better understand the format and get rid of all dependencies, which will allow, if desired, to easily port the project to other languages. </p><br><h2 id="generaciya-komand">  Command generation </h2><br><p>  It is time to bypass the extracted personalities in a convenient format and generate Git commands for them.  It was decided to sort all events in chronological order, and then create branches, merge and commit them, moving in ascending order of dates.  Unfortunately, not all events have dates, so I had to pretty much tinker to sort all the events correctly.  On the nose, 2 ^ 2 ^ 3, and I realized that this approach is not entirely correct, since I wouldn‚Äôt have to bother with dates when going deeper into the depths.  I will correct later (but this is not accurate). </p><br><h3 id="inicializaciya">  Initialization </h3><br><p>  All that is required at this stage is to initialize the repository: </p><br><pre><code class="hljs pgsql">mkdir <span class="hljs-keyword"><span class="hljs-keyword">Family</span></span> cd <span class="hljs-keyword"><span class="hljs-keyword">Family</span></span> git init</code> </pre> <br><h3 id="sobytiya">  Developments </h3><br><p>  In this part of the script, all events are dealt with and committed.  For this, the following commands were used: </p><br><ul><li> <code>git checkout --orphan branch_name</code> </li> <li> <code>git merge @I1@ --allow-unrelated-histories --no-commit</code> </li> <li> <code>git commit -m "msg" --date "" --author "name &lt;email&gt;" --allow-empty</code> </li> </ul><br><p>  The first, <code>checkout</code> , creates a branch for each person.  The <code>--orphan</code> flag allows you to create orphan branches, i.e.  branches without parents.  The orphan branch is created once - when the next <code>checkout</code> switched, this parameter is omitted.  In the end, almost all commits have parents, with the exception of the most distant ancestors, because the earlier ones are unknown to them. </p><br><p>  The second team, <code>merge</code> , unites parents and creates a child.  We will write in the message of the Birth commit ‚Äî the birth with the corresponding year.  We also indicate the flags - <code>--allow-unrelated-histories</code> and - <code>--no-commit</code> for the possibility to merge orphan branches and to commit changes later.  Some children are foster, so for them we will write Adopted.  It's funny, but Git allows you to create Swedish families, i.e.  Merzhit at the same time several branches.  And the branches do not have sex, which will appeal to lovers of "parent 1" and "parent 2". </p><br><p>  Finally, the third command, <code>commit</code> , creates a commit with the message <code>-m</code> , the date <code>--date</code> and the author <code>--author</code> .  As already mentioned, Git allows you to replace the message, the author and the date of the commit.  Moreover, Git allows you to create commits without files using the <code>--allow-empty</code> flag and without messages using - <code>--allow-empty-message</code> .  The author also needs to specify an email, but Git accepts an empty one - you just need to pass <code>&lt;&gt;</code> .  Unfortunately, Git does not respect old people: for some reason, the date of the commit is limited to January 1, 1970 - the earlier date will not be displayed correctly.  However, everything is not so bad: you can simply write the real date in the description.  However, Git believes in the future and accepts dates in the future - pay attention to my son Git.  Mothers and single fathers, by the way, can also be created. </p><br><h4 id="socialnyy-graf">  Social graph </h4><br><p>  The social graph also records other events besides birth: baptism, change of residence, education, marriage, divorce, death, burial.  After death <del>  the branch goes to digital paradise </del>  the appearance of subsequent events in the branch is impossible except for funerals.  On the server, such a branch can be sealed at all, that is, you can make a <a href="https://help.github.com/articles/about-protected-branches/">protected branch</a> (do not worry: in the future it will be possible to resurrect if necessary). </p><br><p>  The event "Wedding" has two ancestors - spouses.  And "Divorce" has one ancestor - the previous event "Wedding".  We must work on family life as we do on children, so we can say that after the wedding a new descendant also appears - ‚Äúrelationships‚Äù that end after a divorce.  Well, they resume again after the next wedding divorce cycles.  In addition, several people may be involved in a relationship (merging several branches). </p><br><h3 id="finalizaciya">  Finalize </h3><br><p>  Add a cherry to the cake: make a backup repository and upload all people to GitHub, GitLab, or any other server that supports Git.  You can push all the branches one by one, but with the help of the <a href="https://stackoverflow.com/a/10479068/1046374">magic command we will</a> start them all, which is much faster and easier: </p><br><pre> <code class="hljs pgsql">git remote <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> origin https://gitlab.com/KvanTTT/<span class="hljs-keyword"><span class="hljs-keyword">Family</span></span>.git git push origin <span class="hljs-comment"><span class="hljs-comment">--all -u</span></span></code> </pre> <br><p>  To generate a regular genealogical tree, you must pass the <code>--only-birth-events</code> flag when the generator starts.  In this case, one commit per person (birth) will be created.  Otherwise, will be generated <del>  social network </del>  social graph. </p><br><h2 id="primery">  Examples </h2><br><p>  As a small example, which will open at least everywhere, I created my family tree, and as a large example, the tree of US presidents (2145 people).  They are available in the <a href="">Kochurkins</a> and <a href="">Presidents</a> repositories, respectively.  To create my own, I used the service <a href="https://geni.com/">geni.com</a> , from where I exported the tree to GEDCOM.  A generated script for creating a genealogical repository is available in <a href="https://gist.github.com/KvanTTT/4a713955a54a062313d43ebb5a96824a">Gist</a> . </p><br><p> <a href=""><img src="https://habrastorage.org/webt/m4/jo/3b/m4jo3bciwk6p18vffeuti6hqr6a.png" alt="Presidents"></a> </p><br><p>  On GitHub, and on GitLab, you can navigate through ancestors and descendants.  This is similar to the <a href="http://familypedia.wikia.com/">Familypedia</a> or <a href="https://www.werelate.org/">WeRelate</a> genealogical wiki.  True git (x | l) are somehow more advanced in some ways: the trees are easily pumped out of them (with the help of the - <code>--clone</code> ).  And most importantly, you can open the entire graph at once.  (In existing genealogical programs, for some reason, difficulties arose with the full discovery of even small graphs.) And this can be done using various tools (web service, <a href="https://gitextensions.github.io/">Git Extesions</a> , <a href="https://www.sourcetreeapp.com/">Sourcetree</a> , <a href="https://www.gitkraken.com/">GitKraken,</a> and others).  In addition, these services can be used for free, unlike most genealogical ones. </p><br><p>  It is noteworthy that even some semblance of analytics is available in git * abah: you can find out from whom <del>  instagram life </del>  eventful life.  Well, or the most open: the <code>Insights</code> tab displays a list of people in order of decreasing commits. </p><br><p> <a href="https://github.com/KvanTTT/Presidents/pulse"><img src="https://habrastorage.org/webt/7v/4p/xr/7v4pxrvctovcxeiwewy9g003uhq.png" alt="Pulse"></a> </p><br><p>  Unfortunately, the big trees of GitHub and GitLab do not display correctly, but they are stored correctly - you can tighten the repository and verify this.  Here is what my tree looks like in the gitlab web interface: </p><br><p> <a href="https://gitlab.com/KvanTTT/Kochurkins/network/%40I1%40"><img src="https://habrastorage.org/webt/ps/mt/qt/psmtqt55zoykekwsk1vndm2asy0.png" alt="Kochurkins GitLab"></a> </p><br><h2 id="problemy">  Problems </h2><br><p>  It is not very clear how to complement the story from the roots.  So far, you have to generate it completely from the GEDCOM file.  I do not exclude that this can be done with the help of a clever rebase - you can experiment and tell in the comments.  It would also be nice to rewrite the code so that it works ‚Äúcommit-oriented‚Äù and not ‚Äúevent-oriented‚Äù, since  it is more natural with respect to the guitar: in fact, the branches in it are a sequence of commits, and not separate entities.  I also thought how to attach <a href="https://git-scm.com/book/ru/v1/%25D0%259E%25D1%2581%25D0%25BD%25D0%25BE%25D0%25B2%25D1%258B-Git-%25D0%25A0%25D0%25B0%25D0%25B1%25D0%25BE%25D1%2582%25D0%25B0-%25D1%2581-%25D0%25BC%25D0%25B5%25D1%2582%25D0%25BA%25D0%25B0%25D0%25BC%25D0%25B8">tags</a> and <a href="https://git-scm.com/book/ru/v1/%25D0%2598%25D0%25BD%25D1%2581%25D1%2582%25D1%2580%25D1%2583%25D0%25BC%25D0%25B5%25D0%25BD%25D1%2582%25D1%258B-Git-%25D0%259F%25D0%25BE%25D0%25B4%25D0%25BC%25D0%25BE%25D0%25B4%25D1%2583%25D0%25BB%25D0%25B8">sub-modules</a> , but for now I know how to do it better. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  If you expand the idea of ‚Äã‚Äãfamily trees further, on web services for developers, then using <a href="https://help.github.com/articles/about-issues/">issues</a> you can create different global tasks and distribute them across different <a href="https://help.github.com/articles/about-milestones/">milestones</a> : childhood, adolescence, adult life, old age. </p><br><p>  In addition to the genealogical trees, you can <del>  turn other loaves of bread into trolley buses </del>  to encode in the gita the genealogical trees of programming languages ‚Äã‚Äã(this is even more ‚Äúcoderish‚Äù), syntactic trees, and in general any tree structures.  Git can be mastered and housewives to build relationships between the characters of the Brazilian TV series :) </p><br><p>  Practical benefits: this warm-up helps to better understand the structure of the gita, its teams, and the format for describing the GEDCOM family trees. </p><br><p>  <em>The source of the article itself is <a href="https://github.com/KvanTTT/Articles/tree/master/Genealogy-Tree-In-Git">available on GitHub</a> - send a pull request there if you find errors or want to add content.</em>  <em>To convert to the habr.com format, the MarkConv library is <a href="https://github.com/KvanTTT/MarkConv">used</a> .</em> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/351158/">https://habr.com/ru/post/351158/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351148/index.html">Richard Hamming: Chapter 5. The History of Computers ‚Äî A Practical Application</a></li>
<li><a href="../351150/index.html">Web-based devices</a></li>
<li><a href="../351152/index.html">Immersing in templates and taming Windows GPO</a></li>
<li><a href="../351154/index.html">How to take the right person to the team - preparing for the interview</a></li>
<li><a href="../351156/index.html">No need to complicate! Or how can redpolitika help promote your solutions to users?</a></li>
<li><a href="../351160/index.html">#PostgreSQL. We accelerate the deployment seven times with the help of "multithreads"</a></li>
<li><a href="../351162/index.html">Alexey Ragozin on Java Mission Control on jug.msk.ru</a></li>
<li><a href="../351164/index.html">Welcome to the Whatever Hack hackathon March 16</a></li>
<li><a href="../351166/index.html">Guide to background work in Android. Part 3: Executors and EventBus</a></li>
<li><a href="../351168/index.html">Understanding redux-saga: From action generators to sagas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>