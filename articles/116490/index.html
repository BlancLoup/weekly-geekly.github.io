<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Database: View Top Activity without Enterprise Manager</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When there is development related to databases, there is almost always a need to see what the base is doing at this particular point in time. 
 If a d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Database: View Top Activity without Enterprise Manager</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage/habraeffect/da/c1/dac173713d52884a319a6e02f9976066.png" alt="image">  When there is development related to databases, there is almost always a need to see what the base is doing at this particular point in time. <br>  If a developer approaches the database administrator and asks to see why his query ‚Äúslows down‚Äù, then the experienced DBA will get hand-written scripts wrappers over hidden x $ views and instantly tell you what is causing the developer disorder. <br><br>  But if the DBA is not so severe?  Is he a beginner DBA or not a DBA at all, but just watching the base? <br>  This will help him the tools described under the cut. <br><a name="habracut"></a><br><br><h4>  Enterprise manager </h4><br>  The most convenient way to see what the base is doing is to use Oracle Enterprise Manager.  Or rather, if we are talking about a single database, Database Manager. <br>  This is a web-based interface that allows you to view the status of the database, perform administrative actions and configure the database. <br>  I think many people know the screen Top Activity: <br><img src="https://habrastorage.org/storage/habraeffect/a0/f4/a0f4e8031501ad357a737046b0e6e97f.png" alt="image"><br>  Which shows what is currently going on in the database.  It is comfortable, beautiful, and it can be shown to the authorities :) <br>  But what if an OEM installation is impractical or the database is configured without an Enterprise Manager?  This will help us 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  ASH Viewer </h4><br>  A free, small, graphical utility written in Java. <br>  You can download Sourceforge: <a href="http://sourceforge.net/projects/ashv/">sourceforge.net/projects/ashv</a> <br>  Before the first start, you need to edit run.sh (or run.bat) and replace JAVA_HOME with the current one.  You also need to attach a driver for Oracle DB (ojdbc14.jar) to lib / so that the program can connect to the database.  In order to connect to the database, it is enough to know the SID / IP / port and user / password.  After launch, we have a beautiful picture: <br><img src="https://habrastorage.org/storage/habraeffect/3d/06/3d0657fd4c0928de64c80d2caa030e2e.png" alt="image"><br><br>  The interface practically repeats Top Sessions from the OEM and is therefore easy to learn. <br>  When you hover the cursor over the SQL ID, a hint appears with the text SQL.  The same SQL text can be viewed in the SQL Text tab: <br><img src="https://habrastorage.org/storage/habraeffect/3f/ad/3fad4e406b024a2fcc0492de7d5f88b1.png" alt="image"><br><br>  The request plan is also available in the corresponding tab: <br><img src="https://habrastorage.org/storage/habraeffect/67/ee/67eef86b2451f64969dd353afedac2cb.png" alt="image"><br><br>  Also available statistics about the cache and what events were at the selected point in time: <br><img src="https://habrastorage.org/storage/habraeffect/29/81/29810f6f8847980b42c63bb96aa9e64f.png" alt="image"><br><br>  If you need to see the graphs for each class of metrics separately, there is a Detail tab: <br><img src="https://habrastorage.org/storage/habraeffect/e8/00/e80024d1da0075832a32facd1bf12183.png" alt="image"><br><br>  All statistics are stored locally and in the future you can view statistics for the past days when ASH Viewer was launched: <br><img src="https://habrastorage.org/getpro/habr/post_images/832/03a/e31/83203ae3100d82fca31aac686e4a5e41.jpg" alt="image"><br><br>  The authors promise support for Oracle DB starting from 8i. <br>  ASH Viewer is convenient if there is no access to the OEM and you can configure the firewall (or ssh tunnel) to access the database.  However, these conditions are also not always met.  And you may need to look at the database load when there is no ASHV installed nearby or when only SSH is at hand. <br>  Output - monitoring on the server itself, for example through sqlplus.  All you need is to use <br><br><h4>  MOATS </h4><br>  As the developers note, this abbreviation stands for The (M) other (O) f (A) ll (T) uning (S) cripts.  The script provides the ability to monitor Top sessions and Top waits directly (and only) from the sqlplus console! <br>  After a simple installation of the utility for a specific user, he will be able to observe a similar image directly from the console: <br><pre> + INSTANCE SUMMARY ----------------------------------------------- ------------------------------ +
 |  Instance: ora112 |  Execs / s: 2.0 |  sParse / s: 0.0 |  LIOs / s: 219637.3 |  Read MB / s: 0.0 |
 |  Cur Time: 13-Aug 19: 25: 14 |  Calls / s: 0.0 |  hParse / s: 0.0 |  PhyRD / s: 0.5 |  Write MB / s: 0.0 |
 |  History: 0h 0m 26s |  Commits / s: 0.0 |  ccHits / s: 1.5 |  PhyWR / s: 2.9 |  Redo MB / s: 0.0 |
 + ------------------------------------------------- ---------------------------------------------- +

 + TOP SQL_ID (child #) ----- + TOP SESSIONS - + + TOP WAITS ------------------------- + WAIT CLASS - +
 |  50% |  bwx4var9q4y9f (0) |  71 |  |  100% |  latch: cache buffers chains |  Concurrency |
 |  50% |  bq2qr0bhjyv1c (0) |  133 |  |  50% |  SQL * Net message to client |  Network |    
 |  50% |  799uuu8tpf6rk (0) |  6 |  |  |  |    
 + ------------------------------------------ + + ----- --------------------------------------------- +

 + TOP SQL_ID - + PLAN_HASH_VALUE + SQL TEXT ----------------------------------------- ------------ +
 |  bwx4var9q4y9 |  2119813036 |  select / * + full (a) full (b) use_nl (ab) * / count (*) from |
 |  |  |  ys.obj $ b where a.name = b.name and rownum &lt;= 1000002 |
 + ------------------------------------------------- -------------------------------------------- +
 |  bq2qr0bhjyv1 |  644658511 |  select moats_ash_ot (systimestamp, saddr, sid, serial #, |
 |  |  |  audsid, paddr, er #, username, command, ownerid, taddr |
 + ------------------------------------------------- -------------------------------------------- +
 |  799uuu8tpf6r |  2119813036 |  select / * + full (a) full (b) use_nl (ab) * / count (*) from |
 |  |  |  ys.obj $ b where a.name = b.name and rownum &lt;= 1000001 |
 + ------------------------------------------------- -------------------------------------------- +
</pre><br>  I cut the example a bit wide so that it fits into the article.  An example of use can be viewed in the author's video: <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/InSeupwHHoY&amp;xid=17259,1500002,15700021,15700043,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhg1w0T-perHZXfrJ2Nra88qna1nPg" frameborder="0" allowfullscreen=""></iframe><br><br>  And you can download the script from the site: <a href="http://www.oracle-developer.net/utilities.php">www.oracle-developer.net/utilities.php</a> However, Oracle requires at least 10gR2 for its work. <br><br>  <b>UPD</b> : Clarification on licensing some features.  ASHV by default uses Active Session History (ASH) available starting at 10g.  ASH is included in the Oracle Diagnostic Pack and must be licensed for ODP to use it. <br>  But since ASHV also supports Oracle 9i (8i) on which the ASH functionality is emulated, when connecting to 10g, you can select the Standard database type and then ASH will be emulated to 10g (although some Diagnostic Pack functionality, such as AWR or ASH reports will be unavailable ). </div><p>Source: <a href="https://habr.com/ru/post/116490/">https://habr.com/ru/post/116490/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../116483/index.html">About password strength and some large Russian Internet services related to it</a></li>
<li><a href="../116484/index.html">Report on March 26th Master Classes</a></li>
<li><a href="../116485/index.html">Accurate keyboard setup</a></li>
<li><a href="../116486/index.html">Google calculated its economic benefits</a></li>
<li><a href="../116488/index.html">A new sheet has appeared in the book on solar energy.</a></li>
<li><a href="../116491/index.html">Heavy replenishment</a></li>
<li><a href="../116492/index.html">Manage PHPShop online store can now be directly in the interface 1C</a></li>
<li><a href="../116493/index.html">Why is that?</a></li>
<li><a href="../116494/index.html">WingBee - mobile ip telephony for Android</a></li>
<li><a href="../116496/index.html">There are indecent offers, but in my practice - a bit</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>