<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Programming-by-Contract in Java</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. 
 As part of the detailed development of the ‚ÄúJava Core‚Äù distance education course, I am writing a series of publications and doing several ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Programming-by-Contract in Java</h1><div class="post__text post__text-html js-mediator-article">  Good day. <br>  As part of the detailed development <a href="http://habrahabr.ru/company/golovachcourses/blog/218841/">of the ‚ÄúJava Core‚Äù distance education course,</a> I am writing a series of publications and doing several translations of the most popular articles. <br><br>  I also teach <a href="https://www.udemy.com/scala-for-java-developers-ru/%3FcouponCode%3DHABR-ASSERTIONS">Scala for Java Developers</a> on the udemy.com online education platform (equivalent to Coursera / EdX). <br><br>  Now I offer you for review my translation of <a href="http://docs.oracle.com/javase/7/docs/technotes/guides/language/assert.html">"Programming With Assertions"</a> with some comments. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The original publication not only explains in detail the options for using the <b>assert</b> keyword in Java and how support for this mechanism is implemented at the class load level, but is also a rather informal introduction to <a href="http://en.wikipedia.org/wiki/Design_by_contract">Design-by-Contract</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Other articles and translations for the Java Core course</b> <div class="spoiler_text">  <a href="http://habrahabr.ru/company/golovachcourses/blog/218841/">The program of the course "Java Core"</a> <br>  <a href="http://habrahabr.ru/company/golovachcourses/blog/215275/">1000+ hours of Java video in Russian</a> <br>  <a href="http://habrahabr.ru/company/golovachcourses/blog/217595/">Java Annotations, Part I</a> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Other articles and translations for Multicore Java programming</b> <div class="spoiler_text">  <a href="http://habrahabr.ru/company/golovachcourses/blog/217051/">The course program "Multicore programming in Java"</a> <br>  <a href="http://habrahabr.ru/company/golovachcourses/blog/217899/">Introduction to Actors Based on Java / GPars, Part I</a> <br>  <a href="http://habrahabr.ru/company/golovachcourses/blog/221133/">JSR 133 (Java Memory Model) FAQ (translation)</a> <br></div></div><br><br>  PS The author admits that for him personally the Russian language is much more complicated than the Java language, will gratefully hear in a personal about all the errors noticed and will try to fix them as soon as possible. <br><br><hr><br>  <b>Programming with statements (oracle.com: Programming With Assertions)</b> <br><br>  An assert is a statement of the Java programming language that allows you to test your assumptions about a program.  For example, if you write a method that calculates the speed of a particle, you can ‚Äúassert‚Äù that the calculated speed is less than the speed of light. <br><br>  Each statement contains a logical expression that you think will be true at the time of execution.  Otherwise, the system will throw an exception.  Checking that the logical expression is actually true, the statement (assert) confirms your assumptions (expectations) about the program's behavior, increasing the confidence that the program contains no errors. <br><a name="habracut"></a><br>  Experience shows that writing statements in programming is one of the fastest and most effective ways to detect and correct errors.  As an added benefit, assertions serve to document the internal workings of the program and enhance maintainability. <br><br>  This article shows how to program with assertions.  It covers the following topics: <br>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Introduction</a> <br>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">The introduction of statements in the code</a> <br>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Compiling Files Using Claims</a> <br>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Enable and Disable Assertions</a> <br>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Compatibility with existing programs</a> <br>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Design Frequently Asked Questions</a> <br><br><a name="10"></a><br><h4>  Introduction </h4><br>  The assert operator has two forms.  The first, simpler form is: <br><pre><code class="hljs swift"><span class="hljs-built_in"><span class="hljs-built_in">assert</span></span> <span class="hljs-type"><span class="hljs-type">Expression1</span></span>;</code> </pre> <br>  where <i>Expression <sub>1</sub></i> is a boolean expression.  When the system checks an assertion, it evaluates <i>Expression <sub>1</sub></i> and if it is false ( <i>false</i> ), then the system throws <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/AssertionError.html"><i>java.lang.AssertionError</i></a> without a detailed error message. <br>  The second form of statement is: <br><pre> <code class="hljs swift"><span class="hljs-built_in"><span class="hljs-built_in">assert</span></span> <span class="hljs-type"><span class="hljs-type">Expression1</span></span> : <span class="hljs-type"><span class="hljs-type">Expression2</span></span>;</code> </pre><br>  Where: <br><ul><li>  <i>Expression <sub>1</sub></i> is a logical expression. </li><li>  <i>Expression <sub>2</sub></i> is an expression that has a value (cannot be a call to the <i>void</i> method). </li></ul><br>  Use this version of the assert statement to provide a detailed error message.  The system passes the value of Expression <sub>2</sub> to the appropriate <i>AssertionError</i> constructor to use the string representation of the value as a detailed error message. <br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  <i>AssertError</i> contains separate constructors for each data type (short and byte are automatically cast to int, no constructors were provided for them) <br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> java.lang; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AssertionError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Error</span></span></span><span class="hljs-class"> </span></span>{ ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AssertionError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object detailMessage)</span></span></span><span class="hljs-function"> </span></span>{...} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AssertionError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params"> detailMessage)</span></span></span><span class="hljs-function"> </span></span>{...} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AssertionError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> detailMessage)</span></span></span><span class="hljs-function"> </span></span>{...} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AssertionError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> detailMessage)</span></span></span><span class="hljs-function"> </span></span>{...} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AssertionError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> detailMessage)</span></span></span><span class="hljs-function"> </span></span>{...} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AssertionError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> detailMessage)</span></span></span><span class="hljs-function"> </span></span>{...} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AssertionError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> detailMessage)</span></span></span><span class="hljs-function"> </span></span>{...} ... }</code> </pre><br>  This allows you to <i>use an expression of any primitive or reference type</i> as <i>Expression <sub>2</sub> :</i> <i><br></i> <pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : <span class="hljs-number"><span class="hljs-number">1.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : <span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] {<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>}; }</code> </pre><br>  or calls to arbitrary methods that return something <br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : f0(); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : f1(); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : f2(); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : f3(); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : f4(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">byte</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>;} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span>;} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>;} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Hello!"</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] f4() {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] {<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>};} }</code> </pre><br>  but not calling a method that returns void <br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> App { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> main(String[] args) { <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> args != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> : f(); //    } private static <span class="hljs-type"><span class="hljs-type">void</span></span> f() {} } &gt;&gt; COMPILATION ERROR: <span class="hljs-string"><span class="hljs-string">'void'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> allowed here</code> </pre><br></div></div><br><br>  The purpose of such an error message is to record and report information about the cause of the violation of the claim.  The message should allow you to diagnose and, ultimately, fix the error that caused the statement to fail.  Note that the message is NOT an error message for the user.  In general, there is no need to make these messages understandable on their own, or to internationalize them (translate into the user's language).  The detailed message should be interpreted in the context of a complete stack trace in conjunction with the source code, which contains a faulty statement. <br><br>  Like all unhandled exceptions, assertion failures, as a rule, contain a stack trace (stack trace) with the file number and the line from which they were thrown.  The second form of approval should be used in preference to the first only when the program has some additional information that can help diagnose the failure.  For example, if <i>Expression <sub>1</sub></i> assumes a relationship between two variables x and y, then the second form should be used.  Under these conditions, a reasonable variable for <i>Expression <sub>2</sub></i> will be <i>"x:" + x + ", y:" + y</i> . <br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  For example, the following example is meant. <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x, y; <span class="hljs-comment"><span class="hljs-comment">//   assert x &gt; y; } }</span></span></code> </pre><br>  just throw an <i>AsertionError</i> in case of an assertion violation (x&gt; y). <br>  But such an example <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x, y; <span class="hljs-comment"><span class="hljs-comment">//   assert x &gt; y : "x: " +  + ", : " + ; } }</span></span></code> </pre><br>  will throw an <i>AsertionError</i> with a message, say, <i>"x: 0, y: 123",</i> which will allow the programmer to analyze specific invalid values ‚Äã‚Äãof x and y at the time of the calculation. <br></div></div><br><br>  In some cases, <i>Expression <sub>1</sub></i> can be expensive to calculate.  For example, suppose that when writing a method that searches for the minimum element in an unsorted list, an assertion is added to verify that the selected element is indeed minimal.  In this case, the verification statement will be as ‚Äúexpensive‚Äù as the execution of the method itself.  In order to make sure that assertions do not degrade application performance, assertions can be turned on or off at the time the program starts.  By default, they are disabled.  Disabling an assertion completely eliminates a performance loss.  Once they are disabled, they are equivalent to an empty operator in semantics and performance.  For more information, see: <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Enabling and disabling assertions</a> . <br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  In the ArrayUtils.min (int []) method, two postinvariant checks and both are comparable in complexity to the complexity of finding the minimum element (O (N)) <br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ArrayUtils { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">int</span></span> min(<span class="hljs-type"><span class="hljs-type">int</span></span>[] <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>) { <span class="hljs-type"><span class="hljs-type">int</span></span> min; //     //  min -    <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> checkMin(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>, min); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> checkContains(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>, min); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> min; } // ,        private static <span class="hljs-type"><span class="hljs-type">boolean</span></span> checkMin(<span class="hljs-type"><span class="hljs-type">int</span></span>[] <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> min) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> elem : <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem &lt; min) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } // ,     "" private static <span class="hljs-type"><span class="hljs-type">boolean</span></span> checkContains(<span class="hljs-type"><span class="hljs-type">int</span></span>[] <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>, <span class="hljs-type"><span class="hljs-type">int</span></span> min) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> elem : <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (elem == min) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  the empty operator apparently means the semicolon operator (;) <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">String[] args</span></span></span><span class="hljs-function">)</span></span> { ;;;; ;;;;;;;; ;;; ;; ;;; ;;;;;;;;;; ;; ;; ;;;;;;;; ;;;; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> k = <span class="hljs-number"><span class="hljs-number">0</span></span>; k &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>; k++) { ; } } }</code> </pre><br></div></div><br><br>  Adding the <i>assert</i> keyword to Java has implications for existing code.  For more information, see <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Compatibility with Existing Programs</a> . <br><br><a name="20"></a><br><h4>  The introduction of statements in the code </h4><br>  There are many situations in which it is useful to use statements, including: <br><ul><li>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Internal invariants</a> </li><li>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Control flow invariants</a> </li><li>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Preconditions (preconditions), postconditions (postconditions) class invariants (class invariants)</a> </li></ul><br><br>  There are also situations where you should not use them: <br><ul><li>  Do not use statements to validate arguments to public (public) methods. <br><br>  As a rule, argument checking is part of the published specification (or contract) of the method, and this behavior must be observed whether assertions are turned on or off.  Another problem with using assertions to validate arguments is that erroneous arguments must result in appropriate exceptions when executed (such as <i>IllegalArgumentException</i> , <i>IndexOutOfBoundsException</i> or <i>NullPointerException</i> ).  Failure of the approval will not issue an appropriate exception. </li><li>  Do not use affirmations to complete a task whose result is expected by your application to work correctly. <br><br>  Assertions can be disabled and programs must not assume that the logical expression contained in the assertion will be evaluated (evaluate).  Breaking this rule can have dire consequences.  Suppose you want to remove all null elements from the list of names, knowing that the list contains at least one or more of these elements.  It would be wrong to do this: <br><pre> <code class="hljs pgsql">//  ! -     <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> names.remove(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>);</code> </pre><br>  The program will work normally provided that the statements were enabled, but it would fail if they were disabled.  Since  in this case, they will not delete null items from the list.  The correct approach would be to take an action before verifying the approval, and then checking the statement that the action was completed: <br><pre> <code class="hljs pgsql">// ! -      <span class="hljs-type"><span class="hljs-type">boolean</span></span> nullsRemoved = names.remove(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); //       . <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> nullsRemoved;</code> </pre><br>  As a rule, the expressions contained in the statements should be free from side effects: the evaluation of the expression (expression evaluations) should not affect any state that is used after the completion of the calculation.  The only exception to this rule is: assertions can modify a state that is used exclusively within other assertions.  The use of this idiom is demonstrated <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">below in the text</a> . </li></ul><br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  Side effect (side effects) - any action that changes the "visible world." <br>  The implication is simply to perform <br>  tmp x = 1 + 2 + 3; <br>  It does not change the ‚Äúvisible world‚Äù (if no one else in the program uses the <i>tmp</i> identifier), although the ‚Äúinvisible world to the programmer‚Äù may have changed (bytecodes are loaded, memory in the stack is allocated for a local variable, the processor added 1, 2 and 3) <br><br>  Performance <br>  System.out.println ("Hello!"); <br>  changes the "visible world" (has side effects) - a program with such a line obviously prints "more" to the console, but still it does not affect the program below - we do not change the read data. <br><br>  But the line <br>  tmp = 2 * tmp; <br>  affects the program below (has side effects) if below we read and use the value of the variable tmp. <br></div></div><br><br><a name="21"></a><br><h6>  Internal invariants </h6><br>  Before statements became available in the language, many programmers used comments to ‚Äúexpress‚Äù their assumptions about program behavior.  For example, to reveal their assumptions about the else-section in a long chain if-elseif-elseif- ....  Previously wrote something like this: <br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i % <span class="hljs-number"><span class="hljs-number">3</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>) { ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i % <span class="hljs-number"><span class="hljs-number">3</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span>) { ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    (i % 3 == 2) ... }</span></span></code> </pre><br>  Now you <b>should use a statement instead of every comment with an "obviously true statement</b> . <b>"</b>  For example, it is worth rewriting the previous code like this: <br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i % <span class="hljs-number"><span class="hljs-number">3</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>) { ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i % <span class="hljs-number"><span class="hljs-number">3</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span>) { ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">assert</span></span> i % <span class="hljs-number"><span class="hljs-number">3</span></span> == <span class="hljs-number"><span class="hljs-number">2</span></span> : i; ... }</code> </pre><br>  It is worth noting that the statement in the example above can fail if <i>'i' is</i> negative, since the% operator calculates the remainder from the division (remainder), which can be negative. <br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  example </div></div><br>  Another candidate for using assertions is the default-section switch statement.  The absence of a default section usually indicates that the programmer is confident that one of the case sections will always be selected.  The assumption that a variable will have one of a small number of values ‚Äã‚Äãis an invariant and should be tested with an assertion.  Suppose the following switch statement appears in a program that deals with a card game: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">switch</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">suit</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">caseSuit.CLUBS</span></span>: //  ... break; <span class="hljs-attribute"><span class="hljs-attribute">caseSuit.DIAMONDS</span></span>: //  ... break; <span class="hljs-attribute"><span class="hljs-attribute">caseSuit.HEARTS</span></span>: //  ... break; <span class="hljs-attribute"><span class="hljs-attribute">caseSuit.SPADES</span></span>: //  ... }</code> </pre><br>  Most likely this indicates the assumption that the suit type variable will have one of four values.  To test this assumption, add the following default section: <br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">assert</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> : suit;</code> </pre><br>  If the variable set takes on a different value and the assertions are included, the assertion will fail and throw an <i>AssertionError</i> exception. <br>  An acceptable option would be: <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AssertionError(suit);</code> </pre><br>  This idiom offers protection, even in the case of disabled statements.  And this additional protection costs nothing: the <i>throw</i> statement is executed only if the program fails.  In addition, this option is valid under certain circumstances, when not <i>assert</i> .  Let's say if a method's method returns a value, each case in the switch statement contains a return and there is no return result after the switch, then the first option will result in a syntax error. <br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  This program compiles <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">twice</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arg</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (arg) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AssertionError(arg); } } }</code> </pre><br>  but this one is not <br><pre> <code class="hljs java"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">twice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arg)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (arg) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> : arg; } } } COMPILATION ERROR: Missing <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> statement</code> </pre><br></div></div><br><br><a name="22"></a><br><h6>  Control flow invariants </h6><br><br>  In the previous example, not only the invariant is tested, it also tests the assumption about the flow of execution.  The author of the original switch statement probably assumes not only that the <i>suit</i> variable will always have one of four values, but also the fact that we ‚Äúgo into‚Äù one of the case sections.  This points to another area where you need to use assertions: <b>place an assertion anywhere that NEVER is supposed to be reached</b> .  You must use the following statement: <br><pre> <code class="hljs swift"><span class="hljs-built_in"><span class="hljs-built_in">assert</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;</code> </pre> <br>  Suppose you have the following method: <br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (...) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (...) {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;} ... } <span class="hljs-comment"><span class="hljs-comment">//      !!! }</span></span></code> </pre><br>  You need to replace the final comment so that the code looks like this: <br><pre> <code class="hljs java"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (...) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (...) {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;} } <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      !!! }</span></span></code> </pre><br><br>  <b>Note:</b> Use this method with caution.  If the status is determined to be inaccessible according to the Java specification, then you will get a compile-time error if you try to place a statement there.  Again, an acceptable alternative is to simply throw an AssertionError. <br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  According to the Java specification, the compiler is instructed to check the operators for "unavailability".  In case if ‚Äúunavailable‚Äù operators are detected, a compilation error occurs.  Prerequisite: a program with operators that are never executed ‚Äî most likely the result of a programmer's error <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">String[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    } } &gt;&gt; COMPILATION ERROR: Unreachable statement</span></span></code> </pre><br>  The inspection rules are rigidly spelled out and do not include all possible situations.  Let's say it is so easy to "cheat" the compiler: <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">String[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span>;} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   ,    } }</span></span></code> </pre><br></div></div><br><br><a name="23"></a><br><h6>  Preconditions (preconditions), postconditions (postconditions) class invariants (class invariants) </h6><br><br>  While assert does not provide a full-fledged design-by-contract opportunity, it can help support an informal design-by-contract programming style.  This section shows how to use statements for situations such as <br><ul><li>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Preconditions (what should be true at the time the method is called)</a> </li><li><ul><li>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Lock-status preconditions (lock-status preconditions) - should the lock be captured or free at the time the method is called)</a> </li></ul></li><li>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Postconditions - what should be true after successful completion of the method.</a> </li><li>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">Class invariants - what should be true for each instance of a class.</a> </li></ul><br><br><a name="231"></a><br><h6>  Preconditions (preconditions) </h6><br>  In accordance with agreement, preconditions in open (public) methods produce checks that throw particular specific exceptions.  For example: <br><pre> <code class="hljs pgsql"><span class="hljs-comment"><span class="hljs-comment">/** *    (refresh rate). * * @param rate  ,     . * @throws IllegalArgumentException  (rate &lt;= 0)  (rate &gt; MAX_REFRESH_RATE). */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> setRefreshRate(<span class="hljs-type"><span class="hljs-type">int</span></span> rate) { //       <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rate &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> || rate &gt; MAX_REFRESH_RATE) throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> IllegalArgumentException("Illegal rate: " + rate); setRefreshInterval(<span class="hljs-number"><span class="hljs-number">1000</span></span> / rate); }</code> </pre><br>  This agreement has not changed when adding the operator assert.  <b>Do not use assertions to check the parameters of the public method</b>  The use of assertions in this case is inappropriate, since the method guarantees that it will always check the argument.  He should check whether the statements are independent.  In addition, assert constructions cannot be specified to throw out exceptions of the specified type.  It can only generate an <i>AssertionError</i> . <br><br>  However, you can use statements to test the preconditions of the non-public method, which you calculate will be true, regardless of what the client does with the class.  For example, the statement is appropriate in the following auxiliary method, which is called by the previous public method: <br><pre> <code class="hljs cs"><span class="hljs-comment"><span class="hljs-comment">/** *    (    ) * * @param interval    . */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setRefreshInterval</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> interval</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     (nonpublic)  assert (interval &gt; 0) &amp;&amp; (interval &lt;= 1000 / MAX_REFRESH_RATE) : interval; ... //    }</span></span></code> </pre><br>  Note: this statement will fail if <i>MAX_REFRESH_RATE is</i> more than 1000 or the client selects an update rate of more than 1000. This, in fact, indicates an error in the library! <br><br><a name="2311"></a><br><h6>  Lock-status preconditions (lock-status preconditions) </h6><br><br>  Classes intended for multi-threaded use often have non-public (non-public) methods with preconditions such that some locks are captured or free.  It's not uncommon to see something like this: <br><pre> <code class="hljs java">privateObject[] a; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">synchronized</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object key)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> find(key, a, <span class="hljs-number"><span class="hljs-number">0</span></span>, a.length); } / /    -   c      <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object key, Object[] arr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> start, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> len)</span></span></span><span class="hljs-function"> </span></span>{ ... }</code> </pre><br>  A static method called <i>holdsLock (Object) has</i> been added to the <i>Thread</i> class to test whether the current thread has a lock on the specified object.  This method can be used in conjunction with a statement to add a comment, as shown in the following example: <br><pre> <code class="hljs java">/ /         : <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">find</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object key, Object[] arr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> start, intlen)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> Thread.holdsLock(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-comment"><span class="hljs-comment">// lock-status assertion ... }</span></span></code> </pre><br>  Please note, it is also possible to write a statement, which consists in the fact that some lock is <b>not captured</b> ! <br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  Similar checks are possible for many classes from java.util.concurrent: <br>  <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/ReentrantLock.html">ReentrantLock.isHeldByCurrentThread ()</a> is an exact equivalent <br>  <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html">ReentrantReadWriteLock.isWriteLockedByCurrentThread ()</a> is an exact equivalent <br>  <a href="http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Semaphore.html">Semaphore.availablePermits ()</a> - can be used for similar analysis <br>  ... <br></div></div><br><br><a name="232"></a><br><h6>  Postconditions </h6><br><br>  You can check the postcondition using assertions in both open (public) and closed (nonpublic) methods.  For example, the following public method uses a statement to test the postcondition: <br>  Returns the BigInteger whose value (this <sup>-1</sup> mod m). <br><pre> <code class="hljs java"> <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> m  * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> this^(-1) mod m. * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> ArithmeticException  m &lt;= 0   BigInteger *       * mod m ( BigInteger    m). */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> BigInteger </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">modInverse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BigInteger m)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.signum &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArithmeticException(<span class="hljs-string"><span class="hljs-string">"Modulus not positive: "</span></span> + m); } ... <span class="hljs-comment"><span class="hljs-comment">//   assert this.multiply(result).mod(m).equals(ONE) : this; return result; }</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Translator comment</b> <div class="spoiler_text">  A little algebra: in the residue ring on the base N (Z <sub>N</sub> ) every non-zero element x has (and a unique) inverse element, if x is mutually simple with N. If x is not mutually simple with N, then x has no inverse element. <br><br>  Example # 1 (backward in ring Z <sub>5</sub> ): <br>  for 1 - reverse = 1, 1 * 1 mod 5 = 1 <br>  for 2 - reverse = 3, 2 * 3 mod 5 = 1 <br>  for 3 - reverse = 2, 3 * 2 mod 5 = 1 <br>  for 4 - reverse = 4, 4 * 4 mod 5 = 1 <br><br>  Example # 2 (inverse in ring Z <sub>6</sub> ): <br>  for 1 - reverse = 1, 1 * 1 mod 6 = 1 <br>  for 2 - no return <br>  for 3 - no return <br>  for 4 - no return <br>  for 5 - reverse = 5, 5 * 5 mod 6 = 1 <br></div></div><br><anchor>  232.x </anchor><br>  Sometimes it is necessary to save some data before performing the calculations related to the postcondition check.  You can do this with two statements and a simple inner class that maintains the state of one or more variables so that they can be checked (or rechecked) after calculations.  For example, suppose you have a piece of code that looks like this: <br><pre> <code class="hljs cpp"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">array</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//     ... //          int- //    ,     }</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here's how to change the above method in order to turn the textual statement of a postcondition into a ‚Äúfunctional‚Äù one: </font></font><br><pre> <code class="hljs ruby">void foo(final int[] array) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  (inner)         <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DataCopy</span></span></span><span class="hljs-class"> { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">int</span></span></span><span class="hljs-class">[] </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arrayCopy</span></span></span><span class="hljs-class">;</span></span> DataCopy() { arrayCopy = (int[]) array.clone();} boolean isConsistent() {<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Arrays.equals(array, arrayCopy);} } DataCopy copy = null; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  ;         assert ((copy = new DataCopy()) != null); ... /<span class="hljs-regexp"><span class="hljs-regexp">/    array /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ ,   array   assert copy.isConsistent(); }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can easily generalize this approach to save more than one data element and to test assertions of arbitrary complexity. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">One could try to replace the first statement (which is performed solely for a side effect) with the following, more expressive:</font></font><br><pre> <code class="hljs pgsql">copy = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> DataCopy();</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do not do this. </font><font style="vertical-align: inherit;">The second example will copy the array regardless of whether the statements are included or not. </font><font style="vertical-align: inherit;">This would violate the principle that approvals should not contribute any cost if they are disabled.</font></font><br><br><a name="233"></a><br><h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Class invariants </font></font></h6><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Class invariants are one of the types of </font></font><a href="https://habr.com/ru/company/golovachcourses/blog/222679/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">internal invariants</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that persist for each instance of a class all the time, except for the moments of transition from one consistent state to another. A class invariant can indicate relationships between different attributes, and must be true before and after the completion of any method. Suppose you implement a balanced tree data structure of some kind. The class invariant can be like this: the tree is balanced and correctly ordered.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The approval mechanism does not impose any particular style for checking invariants. </font><font style="vertical-align: inherit;">However, it is sometimes convenient to combine expressions that check the necessary constraints into a single internal method that can trigger a statement. </font><font style="vertical-align: inherit;">In the continuation of the balanced tree example, it would be advisable to implement a private method that checks that the tree is really balanced in accordance with the requirements of the data structure:</font></font><br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">//  true     private boolean balanced() { ... }</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Since this method checks the constraint that should be true before and after the execution of any method, each public method and constructor must contain the following line immediately before returning it: </font></font><br><pre> <code class="hljs java"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">assert</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">balanced</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>;</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a rule, there is no need to place similar checks in the header of each open method, only if the data structure is not implemented through native methods. </font><font style="vertical-align: inherit;">In this case, it is possible that a memory corruption bug may damage the data structure outside the Java heap (‚Äúnative peer‚Äù) between method calls. </font><font style="vertical-align: inherit;">An assertion failure at the beginning of the method will indicate that this kind of memory corruption has occurred.</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This means that the class is implemented via the </font></font><a href="http://docs.oracle.com/javase/7/docs/technotes/guides/jni/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java native Interface (JNI)</font></font></a> </div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It may also be advisable to enable checking of class invariants at the beginning of each class method, if the state of the class can be changed by other classes. </font><font style="vertical-align: inherit;">It is still better to use such a design of classes that the state is not directly visible to other classes!</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">  ¬´ ¬ª   ( )  ¬´ ¬ª     .             .   ¬´¬ª       ,    ¬´¬ª  -  ,     . <br></div></div><br><br><a name="25"></a><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "Advanced" technology </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The following sections will discuss topics that apply only to devices with limited resources and systems in which approvals should not be disabled. </font><font style="vertical-align: inherit;">If you are not interested in this topic, go to the next section, </font></font><a href="https://habr.com/ru/company/golovachcourses/blog/222679/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compiling Files Using Assertions</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Eliminating Assertions from Class Files </font></font></h6><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmers developing applications for devices with limited resources may wish to completely eliminate assertions from class files. </font><font style="vertical-align: inherit;">Although this makes it impossible to activate assertions in principle, it reduces the size of the class file, which can lead to faster loading of classes. </font><font style="vertical-align: inherit;">In the absence of a high-quality JIT compiler, this can lead to a decrease in the required memory and an increase in performance at runtime. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The approval mechanism does not offer direct support for removing them from class files. </font><font style="vertical-align: inherit;">Statements, however, can be used in conjunction with the ‚Äúconditional compilation‚Äù idiom. </font><font style="vertical-align: inherit;">This approach is described in the Java specification and allows the compiler to eliminate all ‚Äúreferences‚Äù to statements in the generated class files:</font></font><br><pre> <code class="hljs axapta"> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> asserts = ... ; <span class="hljs-comment"><span class="hljs-comment">// false    if (asserts) assert &lt;expr&gt; ;</span></span></code> </pre><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text"> ¬´ ¬ª      .      <a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html">  </a> : <br><blockquote> ¬´An optimizing compiler may realize that the statement‚Ä¶ will never be executed and may choose to omit the code for that statement from the generated class file ...¬ª </blockquote><br>   (   ,    ) javac    ¬´optimizing compiler¬ª,       <br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> asserts = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   if (asserts) { //  B } //  C } }</span></span></code> </pre><br>    <br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> asserts = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   //  C } }</span></span></code> </pre><br></div></div><br><br><h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> How to require inclusion of statements </font></font></h6><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmers of some critical systems may want their code to work exclusively with assertions included. </font><font style="vertical-align: inherit;">The following approach based on static initialization prevents class initialization if its assertions have been disabled:</font></font><br><pre> <code class="hljs pgsql">static { <span class="hljs-type"><span class="hljs-type">boolean</span></span> assertsEnabled = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> assertsEnabled = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; //   !!! <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!assertsEnabled) throw <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RuntimeException("   !!!"); }</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Place this static initializer at the top of your class declaration. </font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">   ¬´ ¬ª  ,             ‚Äî  .  Those.      <br><pre> <code class="hljs java"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = f(); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> { System.err.println(<span class="hljs-string"><span class="hljs-string">"static{}"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = g(); <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> assertsEnabled = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> assertsEnabled = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!assertsEnabled) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeException(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ System.err.println(<span class="hljs-string"><span class="hljs-string">"f()"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">g</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ System.err.println(<span class="hljs-string"><span class="hljs-string">"g()"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; } } &gt;&gt; f() &gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span>{} &gt;&gt; g() &gt;&gt; Exception in thread <span class="hljs-string"><span class="hljs-string">"main"</span></span> java.lang.ExceptionInInitializerError &gt;&gt; ...</code> </pre><br>               . <br></div></div><br><br><a name="30"></a><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Compiling Files Using Claims </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order for the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">javac</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compiler to </font><font style="vertical-align: inherit;">accept code that contains assertions, you must use the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-source 1.4</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> command line </font><i><font style="vertical-align: inherit;">parameter</font></i><font style="vertical-align: inherit;"> , as in the following example:</font></font><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">javac</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-source</span></span> 1<span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">MyClass</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.java</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This flag is necessary in order not to cause a source code compatibility issue. </font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text"> <a href="http://docs.oracle.com/javase/7/docs/technotes/tools/windows/javac.html">javac       (-source  -target)</a> <br> <i>javac -source 1.3 -target 1.4</i> <br>         class-.       ,   .  Those.   ,    Java 5        Java 1.3,  -    Java 1.4. <br>   1.3 , ,   assert   ,   generics, varargs,‚Ä¶ <br>  class- 1.4 , ,     class-    Java 1.4. <a href="http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-4.html"> class-    </a> (minor_version, major_version) <br><pre> <code class="hljs">ClassFile { ... u2 minor_version; u2 major_version; ... }</code> </pre><br><blockquote> Oracle's Java Virtual Machine implementation in JDK release 1.0.2 supports class file format versions 45.0 through 45.3 inclusive. JDK releases 1.1.* support class file format versions in the range 45.0 through 45.65535 inclusive. For k ‚â• 2, JDK release 1.k supports class file format versions in the range 45.0 through 44+k.0 inclusive. </blockquote><br></div></div><br><br><a name="40"></a><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Enable and Disable Assertions </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By default, assertions are disabled at run time. </font><font style="vertical-align: inherit;">We have two command line switches. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To enable assertions at various levels of detail, use </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-enableassertions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-ea</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">To disable assertions at different levels of detail, use </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-disableassertions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-da</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">You specify the details of the flag arguments:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">no arguments </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enables or disables assertions in all classes except system</font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">packageName</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enables or disables assertions in the specified package and in all subpackages.</font></font></li><li>  ... <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Enable or disable assertions in the untitled package in the current working directory. </font></font></li><li> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">className</font></font></i> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Enables or disables assertions in the specified class.</font></font></li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, the following command launches </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BatTutor</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with assertions enabled only for the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.wombat.fruitbat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> package </font><font style="vertical-align: inherit;">and its subpackages:</font></font><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">java</span></span> -ea:com.wombat.fruitbat... BatTutor</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the command line contains several such "switches", they are processed in order before loading any class. </font><font style="vertical-align: inherit;">For example, the following command starts the BatTutor program with the com.wombat.fruitbat package assertions enabled, but with </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.wombat.fruitbat.Brickbat</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disabled for the class </font><font style="vertical-align: inherit;">:</font></font><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">java</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-ea</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:com.wombat.fruitbat...</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-da</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:com.wombat.fruitbat.Brickbat</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">BatTutor</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The above command line flags apply to all class loaders with one exception. This is a system ClassLoader. The exception concerns switches with no arguments, which (as stated above) do not apply to system classes. This behavior makes it easy to include assertions in all classes except for system classes, which is usually desirable. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To enable assertions in all system classes, use a different flag: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-enablesystemassertions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-esa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Similarly, to disable assertions in system classes use </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-disablesystemassertions</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-dsa</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> For example, the following command starts the BatTutor program with assertions included in both the system classes and the com.wombat.fruitbat package and its subpackages: </font></font><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">java</span></span> -esa -ea:com.wombat.fruitbat...</code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The status of an assertion for a class (on or off) is set at the time of class initialization and does not change more. </font><font style="vertical-align: inherit;">However, there is a separate case that requires special handling. </font><font style="vertical-align: inherit;">It is possible, though usually undesirable, to execute methods or constructors before initialization. </font><font style="vertical-align: inherit;">This can occur if the class hierarchy contains cyclicality in the static initialization procedure. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If an assertion is executed before the class is initialized, then the execution should behave as if the assertions were included in the class. </font><font style="vertical-align: inherit;">This topic is discussed in detail in the Java specification.</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">  <a href="http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html">   </a> : <br> An assert statement that is executed before its class has completed initialization is enabled. <br><br> This rule is motivated by a case that demands special treatment. Recall that the assertion status of a class is set no later than the time it is initialized. It is possible, though generally not desirable, to execute methods or constructors prior to initialization. This can happen when a class hierarchy contains a circularity in its static initialization, as in the following example: <br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Foo { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> main(String[] args) { Baz.testAsserts(); // Will <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> Baz <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> initialized. } } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Bar { static { Baz.testAsserts(); // Will <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">before</span></span> Baz <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> initialized! } } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Baz extends Bar { static <span class="hljs-type"><span class="hljs-type">void</span></span> testAsserts() { <span class="hljs-type"><span class="hljs-type">boolean</span></span> enabled = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> enabled = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span>.println("Asserts " + (enabled ? "enabled" : "disabled")); } } &gt;&gt; Asserts enabled &gt;&gt; Asserts disabled</code> </pre><br> Invoking Baz.testAsserts() causes Baz to be initialized. Before this can happen, Bar must be initialized. Bar's static initializer again invokes Baz.testAsserts(). Because initialization of Baz is already in progress by the current thread, the second invocation executes immediately, though Baz is not initialized (¬ß12.4.2). <br><br> Because of the rule above, if the program above is executed without enabling assertions. <br></div></div><br><br><a name="50"></a><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Compatibility with existing programs </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adding the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> keyword </font><font style="vertical-align: inherit;">to Java does not cause any problems with existing binaries ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.class</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> files). </font><font style="vertical-align: inherit;">If you try to compile an application that uses </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as an identifier, then you will receive a compiler warning or an error message. </font><font style="vertical-align: inherit;">In order to facilitate the transition from a world where assertion is a valid identifier to a world where this is not the case, the compiler supports two modes of operation in this version:</font></font><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source mode 1.3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (default) - the compiler accepts programs that use </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as an identifier, but gives warnings. </font><font style="vertical-align: inherit;">In this mode, programs are not allowed to use a statement.</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Source mode 1.4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the compiler generates an error message if the program uses </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as an identifier. </font><font style="vertical-align: inherit;">In this mode, programs are allowed to use a statement.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unless you specifically request source mode 1.4 with the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-source 1.4</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> flag </font><font style="vertical-align: inherit;">, the compiler works in source mode 1.3. </font><font style="vertical-align: inherit;">If you forget to use this flag, programs that use assertions will not compile. </font><font style="vertical-align: inherit;">The decision to force the compiler to use the old semantics as the default behavior (that is, allowing </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assert to</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> be used as an identifier) ‚Äã‚Äãwas made for the most favorable compatibility mode. </font><font style="vertical-align: inherit;">Source mode 1.3 is likely to work for a long time.</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">        ( Java 1.4),     .  Those.    javac  JDK 7  JDK 8   ,  -source 1.3 </div></div><br><br><a name="60"></a><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Design and Frequently Asked Questions </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> This section contains frequently asked questions regarding the internal design of assertions. </font></font><br>  <a href="https://habr.com/ru/company/golovachcourses/blog/222679/">General issues</a> <br> <a href="https://habr.com/ru/company/golovachcourses/blog/222679/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Compatibility </font></font></a> <br> <a href="https://habr.com/ru/company/golovachcourses/blog/222679/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syntax and semantics </font></font></a> <br> <a href="https://habr.com/ru/company/golovachcourses/blog/222679/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AssertionError class </font></font></a> <br> <a href="https://habr.com/ru/company/golovachcourses/blog/222679/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enabling and disabling assertions</font></font></a> <br><br><a name="61"></a><br><h6>  General issues </h6><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why provide the possibility of approval, given that it is possible to program assertions in the top of the Java programming language, without special support?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Although custom implementations are possible, they are often either ugly (requiring an if for each statement) or ineffective (condition evaluation, even if statements are disabled). In addition, each special implementation in its own way enables and disables assertions, which reduces the usefulness of these implementations, especially in debug mode. As a result of these flaws, assertions have never been part of the culture of Java programmers. Adding support for assertions to the platform has a good chance of rectifying this situation. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why is the introduction of this tool carried out through the expansion of the language, and not in the form of a library?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We recognize that changing the language is a serious step and should not be taken lightly. </font><font style="vertical-align: inherit;">Approach through the library was considered. </font><font style="vertical-align: inherit;">However, it is considered important that the cost of fulfilling statements can be neglected if they are turned off. </font><font style="vertical-align: inherit;">In order to achieve this in the case of the library, the programmer is forced to hard-code each statement as an if-operator. </font><font style="vertical-align: inherit;">Many programmers would not do this. </font><font style="vertical-align: inherit;">They will either omit the if operator and performance will suffer, or they will completely ignore the assertions. </font><font style="vertical-align: inherit;">Note also that the claims are contained in the original Java specification from James Gosling. </font><font style="vertical-align: inherit;">Claims have been removed from the Oak specification due to lack of time for satisfactory development and implementation.</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">    Java  Oak       . :). </div></div><br><br> <b>      -- (design-by-contract)  ,    ,     Eiffel?</b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We considered this possibility, but we could not convince ourselves that we could ‚Äúgraft‚Äù it to Java without massive changes in the platform‚Äôs libraries and a massive backward-compatibility violation between the old and new libraries. In addition, we were not sure that such an opportunity would be able to preserve the simplicity of the language, which is a distinctive feature of Java. In the end, we came to the conclusion that a simple conditional statement (boolean assertion facility) would be a fairly understandable decision and much less risky. It is worth noting that the addition of conditional approval to the language does not preclude the addition of full support for the Development-by-Contract (design-by-contract) sometime in the future. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A simple statement really allows the use of a limited form of </font></font><a href="http://en.wikipedia.org/wiki/Design_by_contract"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Development-on-Contract</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The statement (assert) is suitable for checking internal (nonpublic) preconditions, postconditions, and invariants of classes. </font><font style="vertical-align: inherit;">An external (public) precondition check can still be performed by checks inside methods that lead, in particular, to documented exceptions, such as IllegalArgumentException and IllegalStateException. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition to conditional statements (boolean assertions), why not provide an assert-like construct to disable the execution of a block of code if assertions are disabled? </font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Providing such a construction will encourage programmers to make complex inline statements, although it is better to make them into separate methods.</font></font><br><br><a name="62"></a><br><h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Compatibility </font></font></h6><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wouldn't a new keyword be a compatibility issue with existing programs that use 'assert' as an identifier?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Yes, at the source file level (binary files of classes using 'assert' as an identifier will continue to work correctly.) To ease the transition, we implemented a strategy according to which developers can continue to use 'assert' as an identifier during the transition period. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Does this tool not lead to the appearance of class-files that can not be run on the old JRE?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Yes, leads. The class files will contain calls to new class methods </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClassLoader</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Class</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> such as </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desiredAssertionStatus ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If the class file containing the calls to these methods is executed by the old JRE (whose </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ClassLoader</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> class </font><i><font style="vertical-align: inherit;">does</font></i><font style="vertical-align: inherit;"> not have such methods), the program will not be executed and will throw in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NoSuchMethodError</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This is the case when programs using new language features are not compatible with older versions.</font></font><br><br><a name="63"></a><br><h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Syntax and semantics </font></font></h6><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why are primitive types allowed in Expression </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is no compelling reason for limiting the type of this expression. </font><font style="vertical-align: inherit;">Allowing arbitrary types provides convenience for developers who, for example, want to associate unique integer code with each statement. </font><font style="vertical-align: inherit;">In addition, it makes the expression ‚Äúfeel‚Äù like an argument to </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System.out.println (...)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that looks desirable.</font></font><br><br><a name="64"></a><br><h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Class AssertionError </font></font></h6><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AssertionError is</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> generated by a statement that </font><font style="vertical-align: inherit;">does not </font><i><font style="vertical-align: inherit;">contain </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Expression </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , why does the program not report the status of the statement in a detailed text message, for example, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äúheight &lt;maxHeight‚Äù</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Although in some cases ‚Äúout-of-the-box usefulness‚Äù will increase, this does not justify adding all these string constants to class files and class representations of runtime (runtime images). </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why </font><font style="vertical-align: inherit;">doesn't </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AssertionError</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> provide access to the object that threw this exception? </font><font style="vertical-align: inherit;">Similarly, why not pass an arbitrary object from the statement to the </font><i><font style="vertical-align: inherit;">AssertionError</font></i><font style="vertical-align: inherit;"> constructor</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instead of an error message (string)? </font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Access to these objects will encourage programmers to try to restore the system after a failure in the statement, which is contrary to the purpose of this language feature. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why not provide contextual access methods (such as </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getFile ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getLine ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getMethod ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) for AssertionError? </font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This facility is already provided for </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Throwable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Therefore, it can be used for all exceptional situation (throwables), and not only for assertion errors. </font><font style="vertical-align: inherit;">We have this method in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Throwable.getStackTrace ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to provide this functionality.</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">   (  assert  <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/AssertionError.html">AssertionError</a> )      ,    <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Throwable.html">Throwable.getStackTrace()</a> ‚Äî   1.4. <br>        ++-    Throwable     AssertionError. <br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">    <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">String[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { f(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Throwable t) { StackTraceElement[] stack = t.getStackTrace(); StackTraceElement frame = stack[<span class="hljs-number"><span class="hljs-number">0</span></span>]; System.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span>.println(<span class="hljs-string"><span class="hljs-string">"FileName: "</span></span> + frame.getFileName()); System.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span>.println(<span class="hljs-string"><span class="hljs-string">"ClassName: "</span></span> + frame.getClassName()); System.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span>.println(<span class="hljs-string"><span class="hljs-string">"MethodName: "</span></span> + frame.getMethodName()); System.<span class="hljs-keyword"><span class="hljs-keyword">out</span></span>.println(<span class="hljs-string"><span class="hljs-string">"LineNumber: "</span></span> + frame.getLineNumber()); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeException(); } } &gt;&gt; FileName: App.java &gt;&gt; ClassName: App &gt;&gt; MethodName: f &gt;&gt; LineNumber: <span class="hljs-number"><span class="hljs-number">16</span></span></code> </pre><br></div></div><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why is </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AssertionError a</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> subclass of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Error</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> rather than a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RuntimeException</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> That's a moot point. A group of experts discussed it and concluded that Error is a more suitable ancestor in order to save programmers from trying to restore the program after </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AssertionError</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In general, it is rather difficult or even impossible to localize the source of the assert error. Such a failure means that the program ‚Äúmoves in an unknown direction‚Äù (‚Äúoutside of known space‚Äù) and attempts to continue execution are likely to be disastrous. In addition, coding agreements (convention) require that methods specify most runtime exceptions (meaning the heirs of </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exception</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but not </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Error</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) which they can throw away ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@throws</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in javadoc). </font><font style="vertical-align: inherit;">It hardly makes sense to include circumstances in the specification of a method under which it can generate assert errors. </font><font style="vertical-align: inherit;">Such information may be considered as an implementation detail, which may vary from implementation to implementation and from release to release.</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">        ¬´How to Write Doc Comments for the Javadoc Tool¬ª   <a href="http://www.oracle.com/technetwork/java/javase/documentation/index-137868.html">¬´Documenting Exceptions with @throws Tag¬ª</a> . <br></div></div><br><br><a name="65"></a><br><h6><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Enable and Disable Assertions </font></font></h6><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why do commands that enable and disable assertions use package-as-tree semantics instead of more traditional package semantics? </font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Control over the hierarchy can be useful, since programmers actually use packages as hierarchical structures for organizing their code. </font><font style="vertical-align: inherit;">For example, package-as-tree semantics allows you to enable or disable statements in all Swing for a single action.</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">         Java,         (  ). <br> :   . <br>  Those.    <i>aaa.bbb.ccc</i>   ¬´¬ª     <i>aaa.bbb</i>       <i>xxx.yyy.zzz</i> .       (public, protected, (package private), private)     :         .      ¬´ ¬ª. <br><br>  Swing     <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.border</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.colorchooser</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.event</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.filechooser</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.plaf</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.plaf</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.basic</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.plaf</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.metal</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.plaf</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.multi</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.plaf</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.nimbus</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.plaf</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.synth</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.table</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.text</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.text</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.html</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.text</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.html</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.parser</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.text</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.rtf</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.tree</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.undo</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span>.* <span class="hljs-selector-tag"><span class="hljs-selector-tag">javax</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.swing</span></span>.*</code> </pre><br>   --      <i>javax.swing.*</i>      . <br></div></div><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">does setClassAssertionStatus ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> return a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">boolean</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> instead of throwing an exception if it is called too late to set the status of the statement (that is, if the class has already been initialized)?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No action (except, perhaps, a warning message) is necessary or desirable if the flag is set too late. The exception seems unnecessarily heavy. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why not overload one method name instead of using two: </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setDefaultAssertionStatus ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">setAssertionStatus ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Clarity in naming methods is done for the common good. Overloading of methods tends to cause confusion. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why not customize the </font><i><font style="vertical-align: inherit;">desiredAssertionStatus</font></i><font style="vertical-align: inherit;"> semantics</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">so, to make it more ‚Äúprogrammer friendly‚Äù, returning the current state of the assertion statement if the class is already initialized?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It is not yet clear whether any benefit to the resulting method. This method is not intended for use by an application programmer and it seems impractical to make it slower and more difficult than necessary. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why is there no </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RuntimePermission</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to prevent applets from turning on / off assertions?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Although there is no reason for the applet to call any of the </font><i><font style="vertical-align: inherit;">ClassLoader</font></i><font style="vertical-align: inherit;"> methods</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for modifying the on / off status of assertions, allowing them to make such a call seems harmless. </font><font style="vertical-align: inherit;">In the worst case, an applet can create a lightweight version of the denial-of-service attack by including assertions in classes that still need to be initialized. </font><font style="vertical-align: inherit;">In addition, applets can only affect the status of class assertions that should be loaded by class loaders that applets can access. </font><font style="vertical-align: inherit;">And here already exists </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RuntimePermission</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to prevent the ability to access the class loader ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">getClassLoader</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) for unreliable code.</font></font><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Translator comment</font></font></b> <div class="spoiler_text">     ¬´¬ª Java. <br>    java.lang.SecurityManager (     ‚Äî  ,   ‚Äî )    RuntimePermission   ,   ‚Äî . <br><pre> <code class="hljs pgsql">//   "" <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> App { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> main(String[] args) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } }</code> </pre><br><pre> <code class="hljs pgsql">//   -  <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> App { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> main(String[] args) { <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Thread(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Runnable() { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> run() { <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>(<span class="hljs-number"><span class="hljs-number">123</span></span>); } }).<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } } &gt;&gt; Process finished <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> code <span class="hljs-number"><span class="hljs-number">123</span></span></code> </pre><br><pre> <code class="hljs lua">//      System.<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">123</span></span>); //         ... <span class="hljs-string"><span class="hljs-string">""</span></span>! public class App { public static void main(String[] args) { System.setSecurityManager(new SecurityManager() { public void checkExit(int <span class="hljs-built_in"><span class="hljs-built_in">status</span></span>) { throw new SecurityException(<span class="hljs-string"><span class="hljs-string">"You haven't permission to exit."</span></span>); } }); new Thread(new Runnable() { public void run() {System.<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">123</span></span>);} }).start(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>); } }</code> </pre><br><br>     /  ,    <a href="http://docs.oracle.com/javase/7/docs/technotes/guides/security/spec/security-spec.doc3.html"> ,   </a> .          <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">App</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">String[] args</span></span></span><span class="hljs-function">)</span></span> { ClassLoader loader = App.class.getClassLoader(); loader.setDefaultAssertionStatus(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); loader.setPackageAssertionStatus(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); } }</code> </pre><br>      SecurityException        <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">grant</span></span> { permission java.lang.RuntimePermission "getClassLoader"; };</code> </pre><br>   java.policy <br></div></div><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why not provide a construct that will query the assertion status of the "surrounding" class?</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Such a construction will push people to build a complex code of statements. And we see this as a bad decision. In addition, if you need to, use the following construct over the current API:</font></font><br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> assertsEnabled = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> assertsEnabled = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   !!! / /  assertsEnabled     </span></span></code> </pre><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Why </font><font style="vertical-align: inherit;">does an </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">assert</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is executed before class initialization, behave as if statements were included? </font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Very few programmers know that class constructors and methods can work before it is initialized. </font><font style="vertical-align: inherit;">When this happens, it is likely that class invariants have not yet been created, which can lead to serious and subtle errors. </font><font style="vertical-align: inherit;">Any statement that is executed in this state will most likely not work, warning the programmer about the problem. </font><font style="vertical-align: inherit;">Thus, it is generally useful for the programmer to fulfill all the statements that the code encounters in such an unusual situation.</font></font><br><br><h4>  Contacts </h4><br><br>  I do Java online training (here <a href="http://golovachcourses.com/">are the programming courses</a> ) and publish some of the training materials as part of the reworking <a href="http://habrahabr.ru/company/golovachcourses/blog/218841/">of the Java Core course</a> .  You can see videos of lectures in the audience on the <a href="http://www.youtube.com/user/KharkovITCourses">youtube channel</a> , perhaps the video of the channel is better organized in <a href="http://habrahabr.ru/company/golovachcourses/blog/215275/">this article</a> . <br><br>  skype: GolovachCourses <br>  email: GolovachCourses@gmail.com </div><p>Source: <a href="https://habr.com/ru/post/222679/">https://habr.com/ru/post/222679/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../222663/index.html">Ethernet gateway nooLite PR1132 - light control from a smartphone and tablet</a></li>
<li><a href="../222665/index.html">Ciklum .NET Saturday in Odessa on May 31! Registration is open</a></li>
<li><a href="../222669/index.html">Dedicated servers underwater, literally !? Prospects for breeding fish in servers?</a></li>
<li><a href="../222673/index.html">How to add help desk to your YouTrack tracker</a></li>
<li><a href="../222675/index.html">Machine learning for the intellectualization of your applications</a></li>
<li><a href="../222681/index.html">Work environment for SMM specialist</a></li>
<li><a href="../222687/index.html">Stroking the brain ASMR</a></li>
<li><a href="../222689/index.html">Inverse kinematics: simple and fast algorithm</a></li>
<li><a href="../222691/index.html">Wheel with integrated suspension for bicycle or wheelchair</a></li>
<li><a href="../222693/index.html">We had the Kotlin Challenge: what is the final?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>