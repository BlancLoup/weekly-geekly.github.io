<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic bird feeder</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Back in 2010, Leonid Kaganov (as you know, a great inventor) shared with the readers of his blog the idea of ‚Äã‚Äãa bird feeder with a webcam and filling...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic bird feeder</h1><div class="post__text post__text-html js-mediator-article">  Back in 2010, Leonid Kaganov (as you know, a great inventor) <a href="http://lleo.me/dnevnik/2010/08/29.html">shared</a> with the readers of his blog the idea of ‚Äã‚Äãa bird feeder with a webcam and filling the grain by sending paid SMS.  I liked the idea.  And now, 4 years have passed, the New Year holidays 2014 have come, I took out the arduino uno stumbled from the table, the tp-link 3020 router and, together with <a href="http://geektimes.ru/users/bitl/" class="user_link">bitl</a> (aka the admin of the city site), started the project. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a67/db7/364/a67db7364dab458ed18d3ea78e4f7fad.jpg"><br>  Under the cut a lot of photos. <br><a name="habracut"></a><br><h5>  Manger </h5><br>  The heart of the feeder is the Tp-Link 3020 router with OpenWrt firmware, to which the D-Link DCS-2310L camera and arduino via usb are connected via ethernet.  He himself goes to the Internet via wifi.  Every minute, cron runs a script that once every 4 seconds determines whether it is necessary and how many times to open the valve on the bunker with feed. <br><br><div class="spoiler">  <b class="spoiler_title">Script</b> <div class="spoiler_text"><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh COUNT=10 if [ -f /tmp/lock.ceed ]; then LOCK=`cat /tmp/lock.ceed` if [ "$LOCK" -lt "1" ]; then echo '1' &gt; /tmp/lock.ceed while [ "$COUNT" -gt "0" ]; do rm /tmp/status.php wget http://labinsk.ru/feeder/status.php -P /tmp/ -t 5 if [ -f /tmp/status.php ]; then CEED=`cat /tmp/status.php` if [ "$CEED" -gt "0" ]; then until [ $CEED -lt 1 ]; do echo 1 &gt; /dev/ttyACM0 let CEED=$CEED-1 let COUNT=$COUNT-1 sleep 4 done fi fi let COUNT=$COUNT-1 sleep 4 done echo '0' &gt; /tmp/lock.ceed fi else echo '0' &gt; /tmp/lock.ceed fi</span></span></code> </pre> </div></div><br>  Arduino listens to the com port and in the case of receiving one (0x31) opens the valve for 120 ms. <br><div class="spoiler">  <b class="spoiler_title">Sketch Arduino</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> incomingByte = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> relay0 = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> relay1 = <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>); pinMode(<span class="hljs-number"><span class="hljs-number">8</span></span>,OUTPUT); pinMode(<span class="hljs-number"><span class="hljs-number">12</span></span>,OUTPUT); digitalWrite(relay0,LOW); digitalWrite(relay1,HIGH); delay (<span class="hljs-number"><span class="hljs-number">200</span></span>); digitalWrite(relay0,HIGH); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Serial.available() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { incomingByte = Serial.read(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(incomingByte==<span class="hljs-number"><span class="hljs-number">49</span></span>){ digitalWrite(relay1,LOW); delay (<span class="hljs-number"><span class="hljs-number">120</span></span>); digitalWrite(relay1,HIGH); digitalWrite(relay0,LOW); delay (<span class="hljs-number"><span class="hljs-number">200</span></span>); digitalWrite(relay0,HIGH); } } }</code> </pre></div></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The mechanism is made of 50mm tee for sewage and car solenoid.  A cork from a 5 liter pet bottle is glued in the tee (the bottle acts as a feed hopper).  The valve is also made of a piece of sewer pipe. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c06/081/2cd/c060812cd2c3bb577c2bf429ebe9d3e0.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b0/cea/58f/3b0cea58f6574fc41b8c32382cc7cdfa.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/10c/4b4/7b1/10c4b47b1db4f0eb05aaaea48f3c244c.jpg"><br><br>  A self-made two-relay shield is connected to the Arduino, to which the solenoid is connected according to the standard polarity reversal pattern.  Eats everything from the power supply for the late USB-SATA adapter. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9f6/bc3/1d8/9f6bc31d85c80c008442caaab60e47c5.jpg"><br><br>  A house was made, with an installation box for electronics, a swivel mount for a bunker and a flip-down bottom: <br><img src="https://habrastorage.org/getpro/habr/post_images/4a9/970/fc3/4a9970fc3f42664fc8534cd656a528a2.jpg"><br><br>  So adding feed is much more convenient: <br><img src="https://habrastorage.org/getpro/habr/post_images/d2e/b40/0ee/d2eb400ee22bbcd345e8df52721d73ff.jpg"><br><br>  Initially, we wanted to install a feeder in a city park, but due to problems with electricity and wifi, it was decided to install it at home.  Actually installation: <br><img src="https://habrastorage.org/getpro/habr/post_images/6a7/84f/6a0/6a784f6a0e59256555190d36b5c96d7e.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/546/82c/5fd/54682c5fd2a9d46be026147b8b55cd92.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/49d/42b/7f1/49d42b7f194b2feb494e84ecb8737dc0.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/955/8fc/3af/9558fc3af5a32f173560d7be9dfcf6b6.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f57/40b/bfe/f5740bbfe3ece23707df7dd27edb7f2d.jpg"><br><br><h5>  Site </h5><br>  The feeder is available at <a href="http://www.labinsk.ru/index.php%3Fp%3Dfeeder%26stream%3Dmjpeg">http://www.labinsk.ru/index.php?p=feeder&amp;stream=mjpeg</a> <br><br>  A few words about the implementation on the server side of the site. <br>  It was decided to abandon the original idea of ‚Äã‚Äãpouring feed on SMS.  The project was not originally meant as commercial.  In fact, what kind of benefits can we talk about?  And, of course, those who want to send SMS-messages in order to see how the feed is poured - there would be not so much, and the birds would not appreciate such a "care".  Therefore, you can fill the feed by simply pressing a button on the page with the video broadcast.  So that users do not empty the entire bunker in a matter of hours - a timeout has been entered.  At the moment, the ‚ÄúFeed‚Äù button is available only 15 minutes after the previous filling of the feed. <br>  Well, it all works is trivial.  The user presses the button, the php script adds a record ‚Äúnot processed‚Äù to the SQL table, the feeder periodically polls the server, referring to another php script that informs the feeder that a request for filling appears, and then changes in the SQL table, the status of the corresponding record.  Thus, it is not the site that sends the command to the feeder, but the feeder periodically asks the site if it is necessary to pour it?  Not the most optimal implementation, but simple.  Moreover, in this case, we do not need a static ip-address (or some kind of DynDNS) for the Internet connection of the feeder. <br><br><h5>  Birds </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/d2d/0e9/4c6/d2d0e94c6fc2663d5dd4aa23856465c7.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/642/5bb/f15/6425bbf156e19b8d9d362978e53ead90.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4e3/4c8/c0d/4e34c8c0d6f7189e547d0273349a0b61.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ed/371/e7a/8ed371e7a47a0a0cd7e899cb48319977.jpg"><br><br>  PS <br>  The feeder has been working for 2 months, during this time the birds have eaten about 10 liters of feed (2 bunkers).  Food - Sunflower Seeds. <br><br>  UPD Video test mechanism. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/rUjlfPD1jNY%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700253&amp;usg=ALkJrhgi-jhpV5tyF5HtbRkbq4qIxUZfBg" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/217985/">https://habr.com/ru/post/217985/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../217969/index.html">Loading historical data in SAP using LSMW - we write "macro"</a></li>
<li><a href="../217973/index.html">ZNC bouncer on RPi</a></li>
<li><a href="../217977/index.html">Know How: P-branding as improving the appearance of the site and the desired advertising format</a></li>
<li><a href="../217979/index.html">Google now allows you to customize the services panel</a></li>
<li><a href="../217981/index.html">Yandex and the Higher School of Economics open the Computer Science faculty</a></li>
<li><a href="../217989/index.html">We write client for Yandex. Metrics for iPhone</a></li>
<li><a href="../217993/index.html">We are waiting for the summer webinars from Alexey Kibkalo</a></li>
<li><a href="../217995/index.html">Science fiction technology: light engines and systems (Star Trek)</a></li>
<li><a href="../217997/index.html">Learn BlackBerry 10 App Development is available for free download.</a></li>
<li><a href="../218001/index.html">Part 4.1 We return the sight. From points to the excimer laser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>