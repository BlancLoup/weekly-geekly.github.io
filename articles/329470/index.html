<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Do-it-yourself phishing. Experience of the company "Aktiv", part one</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Spam in our time will not see anyone. We are accustomed to it and are already taking it for granted. On the other hand, spam ceases to be just adverti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Do-it-yourself phishing. Experience of the company "Aktiv", part one</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/web/3a2/eba/e55/3a2ebae553af40a89befc3814119f47d.jpg"></div><br><p>  Spam in our time will not see anyone.  We are accustomed to it and are already taking it for granted.  On the other hand, spam ceases to be just advertising, more and more ‚Äúletters of happiness‚Äù are phishing.  The text of these letters is designed to encourage the recipient to perform an action. </p><a name="habracut"></a><br><h2 id="nemnogo-teorii">  Some theory </h2><br><p>  Fishing (eng. Phishing, from fishing - fishing, fishing) - a type of Internet fraud, the purpose of which is to gain access to confidential user data - logins and passwords. </p><br><p>  Spear phishing (English spear phishing) is a type of phishing, in which an attacker generates a phishing email for a specific recipient, using previously collected data about the recipient. </p><br><h2 id="pochemu-eto-vse-tak-opasno">  Why is it all so dangerous? </h2><br><p>  Clicking on a malicious link or opening an attachment to the letter, you launch a virus or trojan that can take control of your computer and company information systems.  Spear fishing is a more dangerous type of phishing.  Its malware is related to the fact that any person, having received a personal letter addressed to him, no longer considers this letter as spam and is inclined to trust and open any links / files. </p><br><h2 id="a-deystvitelno-li-eto-aktualno">  Is it really relevant? </h2><br><p>  Corporate email fraud is gaining momentum.  For the first half of 2016, the FBI recorded 22 thousand victims of this type of fraud, while financial losses amounted to more than $ 3 billion.  Mail today is the main method of penetration into the corporate network.  Attackers do not see the difference between small, medium and large businesses.  Cybercriminals play against large companies for a long time, but this does not mean that they are less interested in small business.  Below is an interesting <a href="https://www.symantec.com/content/dam/symantec/docs/infographics/istr-attackers-strike-large-business-en.pdf">infographic</a> showing that more and more attackers are interested in precisely small business. </p><br><img src="https://habrastorage.org/web/400/270/8dc/4002708dc1534144b3985569430dac6d.png"><br><img src="https://habrastorage.org/web/cca/eaa/ba4/ccaeaaba4c674aa1bdb80a5cf55d7470.png"><br><p><br>  Scammers are increasingly using encryption (mention <del>  Wannacry </del>  already becoming a bad tone) like a weapon.  2016 Cisco called the "Year of ransome".  For the first 3 months of 2016, fraudsters earned more than $ 200,000,000.  It is estimated that by the end of the year, "revenue" was more than a billion dollars. </p><br><img src="https://habrastorage.org/web/10c/007/836/10c00783658740fbb8748cc8dd507257.png"><br><p><br>  Experts, community, law enforcement agencies say: do not pay intruders, you encourage them to continue their activities.  But people and companies are paying, the level of cipher products is growing.  If the first cryptographers were similar to the work of first-year students in programming, now real professionals of the business have become involved in this.  There are already cryptographically secure encryption. </p><br><p>  The company can often face a choice: to pay, or simply to cease its activities.  Naturally, many, almost everyone pays.  You're scared as well as me?  Not?  Then let's add to this social engineering.  We all now use Facebook, vk, twitter, etc.  For our convenience, social networks unite people into groups.  We ourselves fill out profiles, indicate where we live, the name of the company in which we work. </p><br><img src="https://habrastorage.org/web/f52/63e/d50/f5263ed505744685a197d86069142366.png"><br><p><br>  I am paranoid and never indicate the name of the company where I work, you say?  Do you add colleagues to your friends from social networks?  Do they all not indicate the name of the company?  I do not think.  After spending a couple of hours online, researching any company that interests us, you can quickly and easily get a list of the names and surnames of the company's employees.  The hit will be quite large, and in addition to the last names, you can easily find out the list of hobbies and occupations of employees that can be used against them ... for example, to create personalized phishing emails.  But corporate email addresses are not so easy to find, you say?  Again disappoint.  Knowing the name of the company, it is easy to find its corporate website.  Accordingly, the domain is already there.  Often, corporate websites also have general postal contacts, they will also be useful to us.  Now the most difficult thing is that we need to get a couple of valid mailing addresses for company employees.  To do this, for example, write to one of the public addresses of the company.  Contact technical support, for example.  Try to buy something in sales.  If there is no public address on the site, you can always just call and talk with the secretary.  Social engineering works wonders. </p><br><p>  I was fortunate enough to attend the <a href="https://www.social-engineer.org/">Chris "loganWHD" Hadnagy performance</a> .  The organization holds annual competitions on voluntary hacking (pentest) of other companies.  The conclusion of the lecture was simple: social engineering can get any information.  An untrained person is not protected from this.  In addition, nothing prevents you from getting information about the company's secretary from social networks before calling.  This will help simplify the conversation.  So, we will assume that we found out a couple of employee addresses.  We look at the pattern in the addresses.  He is!  Admins because the mail is not out of my head every time they come up with.  There are not many patterns: last name, full name, last_name, etc.  We impose a pattern on the base of surnames and names, and here we have a base of postal addresses of the company.  Why do we need all this?  There is such a thing as a <a href="http://lukatsky.blogspot.ru/2016/10/kill-chain.html">Kill chain</a> . </p><br><img src="https://habrastorage.org/web/25f/d55/8bd/25fd558bdb934b18988e24a214ecec72.png"><br><p><br>  We are interested in the upper part of the picture.  So, we all understood that attackers could easily carry out exploration of us on social networks.  Accordingly, a list of addresses will be compiled and sent.  If we are talking about a targeted attack on a company, and taking intelligence into account, we assume that it is it that is going on, specifically to circumvent the standard spam protection, attackers have acquired several temporary domains and, accordingly, all our spam filters will be passed, and the letter will appear in the mail employee box.  What's next?  Run the attached file / click on the link.  Untrained user (certainly several among the employees of the company) will follow the link, open the attachment.  According to Positive Technologies, in 2015, 24% of users, after receiving a letter, followed the link, and 15% entered their credentials or installed software.  The percentage of such users from year to year only grows. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/web/f7c/cc0/6e6/f7ccc06e60904c89b9dfe0b66908df09.png"></div><br><p>  Will the exploit work?  Yes <del>  (here you can insert a lot about WannaCry) </del>  .  And that's why.  The HP Enterprise <a href="https://www.thehaguesecuritydelta.com/media/com_hsd/report/57/document/4aa6-3786enw.pdf">report</a> has such an interesting infographic, these are new software vulnerabilities that appeared in 2015.  Vulnerabilities are, and regularly find new ones.  And researchers even know about them: </p><br><img src="https://habrastorage.org/web/031/f77/fbe/031f77fbe5324433b9a522c5d6258f5e.png"><br><p>  Often no one knows about them.  And it happens like this (and there is also the NSA). </p><br><img src="https://habrastorage.org/web/59c/34a/21f/59c34a21f6dc4af59cd700e46bd0ce0c.png"><br><p>  On this "Kill chain" is over for us.  Infection occurred, the attacker took possession of our computer.  What will he do with him further of course interesting?  In any case, we leave the rest beyond the scope of this article.  We want to understand what we can oppose to this?  And we can oppose a little.  Yes, it is possible by corporate policies and regulations to prohibit people from using social networks and publishing information about work in them, but as the number of employees grows, this becomes unrealistic.  Yes, you can train spam filters and use expensive threat detection systems, but even the most advanced of them are often not 100% guaranteed to filter dangerous email. </p><br><p>  What remains?  It remains to train and once again train employees on a regular basis, to train to identify phishing and simply delete these letters, before notifying the IT department / security service of the receipt of a suspicious letter.  We recently conducted anti-phishing training at our company. </p><br><h2 id="obuchenie">  Training </h2><br><p>  How are we going to learn?  And we will teach, arranging a social pentest of his company.  You can go in several ways. </p><br><h3 id="pentest-na-zakaz">  Pentest to order </h3><br><p>  After wandering through the expanses of the Internet, you can quite easily find a few companies that will gladly release your social pentester: </p><br><p>  For example, <a href="http://www.infosec.ru/">www.infosec.ru</a> - <a href="http://phishman.ru/">phishman.ru</a> - <a href="http://www.antiphish.ru/">http://www.antiphish.ru</a> </p><br><p>  You can go this way, but you need to understand that the budget of this event will depend on the size of the organization and be several hundred thousand rubles in the minimum version.  At the request of the customer, representatives of pentestors can even conduct a full-fledged social search and retrieve mail addresses themselves, or they can work with ready-made data.  Training on the results of the foam will cost some money.  From the interesting on the Internet, we found a couple of SaS services: </p><br><p>  ‚Ä¢ phishme.com <br>  ‚Ä¢ infosecinstitute.com/phishsim </p><br><p>  Such services will cost about $ 20 a year for a postal address, but it must be remembered that the ready-made database of templates contained in them will be English-speaking (although you can always upload your templates) + all international services (apparently in order to avoid legal claims ) it is mandatory to write in small letters at the bottom of the letter that this is a phishing test, which, in my opinion, somewhat reduces the purity of the experiment. </p><br><h3 id="igrovye-varianty">  Game options </h3><br><p>  One of the best teaching methods is gaming.  For example, recently <a href="http://www.rbc.ru/technology_and_media/15/02/2017/58a430e69a79472ba6d0aaad%3Ffrom%3Dnewsfeed">Sberbank</a> did <a href="http://www.rbc.ru/technology_and_media/15/02/2017/58a430e69a79472ba6d0aaad%3Ffrom%3Dnewsfeed">it</a> .  The method is undoubtedly effective, but contains a couple of flaws.  Unfortunately, this method actually works once, and given the development of means and capabilities, you need to be trained in phishing on a regular basis.  But most importantly, the game must be done by yourself and by yourself.  In the open access ready-made solutions could not be found. </p><br><h3 id="gophish">  Gophish </h3><br><img src="https://habrastorage.org/web/b6f/dc7/c1c/b6fdc7c1c9a3425ea7541c898d4f5d30.png"><br><p><br>  Now let me tell you about the solution that we ultimately chose for us: GoPhish - OpenSource framework for phishing.  <a href="https://getgophish.com/">GoPhish</a> , perhaps, is undeservedly ignored by Habr√©.  Search could find only one article on this product, and the product is worth it. </p><br><h4 id="vozmozhnosti-gophish">  GoPhish features </h4><br><p> Gophish sends letters to predefined templates and lists of email-addresses.  Also, this software uses the embedded web server to display phishing pages.  Links to go to these pages are in the text of letters.  To control the phishing test process, the ‚Äúcampaign‚Äù entity is used - it combines a letter template, an address list with a list of ‚Äúuser-targets‚Äù (Last Name, First Name, email address), a phishing page and a set of SMTP parameters.  After the ‚Äúcompany‚Äù is launched in the software interface, you can see which of the users followed the link to the phishing page, and who did not.  Gophish also provides an <a href="https://www.gitbook.com/book/gophish/api-documentation/details">API</a> , but the basic functionality was enough for us. </p><br><h4 id="ustanovka-gophish">  Install GoPhish </h4><br><p>  The product is written in Go and in compiled form is one binary.  Installation is simple and does not cause problems, there is a good and simple <a href="https://www.gitbook.com/book/gophish/user-guide/details">manual</a> .  The entire installation procedure is reduced to generating an ssl certificate and creating a simple and understandable config.json file. </p><br><pre><code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"admin_server"</span></span> : { <span class="hljs-string"><span class="hljs-string">"listen_url"</span></span> : <span class="hljs-string"><span class="hljs-string">"127.0.0.1:3333"</span></span>, <span class="hljs-string"><span class="hljs-string">"use_tls"</span></span> : <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"cert_path"</span></span> : <span class="hljs-string"><span class="hljs-string">"gophish.crt"</span></span>, <span class="hljs-string"><span class="hljs-string">"key_path"</span></span> : <span class="hljs-string"><span class="hljs-string">"gophish.key"</span></span> }</code> </pre> <br><p>  To clarify something here, I consider it superfluous.  Everything is simple and clear.  It remains to start the service by running the following command: <br> <code>gophish@gophish.dev:~/src/github.com/gophish/gophish$ ./gophish</code> <br>  All further work is done using the framework web interface.  The first thing you need to do is add employees (Users &amp; Groups tab).  You can import a list of users from a csv file (for example, by unloading csv with the necessary fields from AD) or enter user data manually.  Next, you need to create letter templates (the Email templates tab).  Letter text can be entered as text (‚ÄúText‚Äù tab) or using HTML (‚ÄúHTML‚Äù tab). </p><br><img src="https://habrastorage.org/web/c0f/b3c/7bd/c0fb3c7bd4874703837bf2bcb39917b2.png"><br><p>  If the ‚ÄúAdd tracking image‚Äù checkbox is ticked, a 1x1 pixel ‚Äútracking image‚Äù will be added to the letter.  The picture is used to track the fact of opening a letter by the user.  The following reference values ‚Äã‚Äãcan be used in the text of the letter: </p><br><table><thead><tr><th>  Value </th><th>  Description </th></tr></thead><tbody><tr><td>  {{.FirstName}} </td><td>  Name </td></tr><tr><td>  {{.LastName}} </td><td>  Surname </td></tr><tr><td>  {{.Position}} </td><td>  Position </td></tr><tr><td>  {{.From}} </td><td>  Sender </td></tr><tr><td>  {{.TrackingURL}} </td><td>  url to track </td></tr><tr><td>  {{.Tracker}} </td><td>  Tracking image </td></tr><tr><td>  {{.URL}} </td><td>  conversion url </td></tr></tbody></table><br><p>  Next, create ‚Äúphishing‚Äù pages (‚ÄúLanding Pages‚Äù tab), the HTML page code should be entered into the appropriate interface window.  Since we are not going to engage in real phishing among our employees, but we want to train them, as a phishing page, we used a page with educational material that tells employees what phishing is and how not to fall for it.  (We will lay out the page template in the second part of the article). </p><br><img src="https://habrastorage.org/web/9bc/5f7/359/9bc5f73590d34181a1ba8d635182ee93.png"><br><p><br>  You can also create pages with input fields.  Moreover, there are options that preserve the numbers and passwords entered by users, but it is better to use this very carefully.  Now we create sending profiles (‚ÄúSending Profiles‚Äù tab), i.e.  essentially some postal data on behalf of whom, the employee will receive a letter and which mail server will we use for mailing.  In the last step, create a campaign (Campaigns tab).  "Company" combines all previously described.  After entering all the parameters, you need to click the "Launch campaign" button, and the company will start automatically. </p><br><p>  The results of the company can be monitored on the tab "Dashboard". </p><br><img src="https://habrastorage.org/web/e4b/db6/8e9/e4bdb68e97f1496baf6b16637658d21d.png"><br><p>  This tab shows the total percentage of users referred by links and the performance of each company as a percentage.  You can always go and see the details of the company and see the specific employees who clicked on the link. </p><br><h2 id="prodolzhenie-sleduet">  To be continued </h2><br><p>  This concludes the first part of our article.  Soon we will add the second half in which we will share with you templates for phishing emails and a learning page.  We will tell about the reaction of our employees (it was sometimes unpredictable and beautiful!) And share the results that we were able to achieve.  And we also mention our rakes, which we advise you not to attack. <br>  <a href="https://habrahabr.ru/company/aktiv-company/blog/329538/">Part 2</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/329470/">https://habr.com/ru/post/329470/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../329460/index.html">Mobile retargeting: setting in trackers and traffic sources</a></li>
<li><a href="../329462/index.html">ACM ICPC World Championship in Sports Programming: The winner is already known</a></li>
<li><a href="../329464/index.html">Attention! Linux version of EternalBlue exploit</a></li>
<li><a href="../329466/index.html">YiiConf 2017 June 16 in Moscow - a program is formed</a></li>
<li><a href="../329468/index.html">BDD - working method or TDD in a fashionable wrapper?</a></li>
<li><a href="../329472/index.html">Basic storage protocols: use and prospects</a></li>
<li><a href="../329474/index.html">Intel provides access to clDNN [high-performance library for deep learning]</a></li>
<li><a href="../329476/index.html">Russian Code Cup - in the wake of the qualifying round</a></li>
<li><a href="../329478/index.html">Survival Checklist</a></li>
<li><a href="../329480/index.html">The online store's productivity is sketchy or where to start improving it</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>