<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Directed IT attacks in the sphere of large business: how it happens in Russia</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few years ago, the state decided that targeted attacks were a threat to state security. This year, on the basis of the Ministry of Defense, special ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Directed IT attacks in the sphere of large business: how it happens in Russia</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/510/d63/b33/510d63b3336940f68f035546adc154c1.gif"><br><br>  A few years ago, the state decided that targeted attacks were a threat to state security.  This year, on the basis of the Ministry of Defense, special information security forces were created to protect military information systems and communication systems.  At the same time, banks, large retail, oil and gas enterprises and other large companies are in the civilian sector.  We protect them and other civilian teams. <br><br>  <b>Characteristics of a directed attack are usually:</b> <br><ul><li>  There is a professional group, usually financially motivated or by order.  Random goals are rare, most often selected segments of industries or individual enterprises. </li><li>  The most frequent vectors are a combination of 0-day and sotsinzhiniring.  0-day vulnerabilities are often purchased from special ‚Äúscouts‚Äù for large attacks. </li><li>  If the attack was detected and stopped, then the likelihood of a quick return on another vector is high.  The attack goes to the result. </li><li>  The main goal is corporate secrets, source code, correspondence of top management. </li><li>  Possible return after the primary attack.  There was an example of Nortel with an attack when the group came back 10 years later. </li><li>  Attacks are hidden, usually there is no Ponte.  Priority - as much as possible to clear the logs and other traces. </li></ul><br>  We have banks, retail, insurance and many others on protection.  I'll tell you about the practice and solutions. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Attack course </h4><br><br><img src="https://habrastorage.org/files/8b6/446/426/8b644642678f478d9938ddf5c17c3845.png"><br>  <i>RSA, Red October Attack</i> <br><br>  <b>As a rule, the attack develops according to standard principles:</b> <br><ul><li>  Intelligence and data collection.  Social networks are scanned, especially LinkedIn, it turns out a hierarchy of employees and their names, connections.  Technical methods investigate network architecture, gather IP addresses of services, information about equipment and software solutions, as well as about the means of protection used. </li><li>  The attack vector is selected, as a rule, the main question is how to deliver the malware for the DMZ.  It can be anything: from the road apple (flash drives in the back) to the infection of sites that are visited by users of the company.  Often the company's defense is so good that it takes another direct attack on one of the security providers in order to get the delivery vector inside the final goal.  When breaking into RSA, master keys were stolen, which were used to attack other companies. </li><li>  An intrusion is performed directly, as a rule, control is taken over one of the network nodes.  The malware uploads or assembles the main modules and begins distribution from this node, gradually increasing influence and privileges in the network. </li><li>  Influencing effect occurs.  At this step, the activity of protective equipment is suppressed, the malware receives almost complete control necessary to solve the problem. </li><li>  Search for information.  As a rule, some intermediate server for data storage is infected, for example, an update server.  On it, the group collects all the interesting things that you want to extract from the network.  Often the process of finding data takes days and weeks. </li><li>  Extract.  The intermediate server segments the data, archives it, hides (encrypts or uses steganography), then sends it out.  Methods - up to exotic, for example, mixing important data into technical traffic. </li><li>  Hiding tracks. </li><li>  Minimizing influence.  Usually, all active components of the malware are removed, and only a small tab remains that can recreate or load code for future meetings. </li></ul><br><br><h4>  Abstraction </h4><br>  According to the world practice, such attacks very often require masking, since they can be detected even in the early stages of scanning in the form of atypical activity within the network.  For this, a powerful DDoS attack on the target is launched very often.  It distracts security specialists from the target and helps to hide surgical movements along the real vector of attack. <br><br><h4>  Examples of protective equipment: </h4><br><ul><li>  NG FW class systems (Check Point, Stonesoft, HP Tipping Point); </li><li>  system for detecting potentially dangerous files (sandbox) (Check Point, McAfee, FireEye); </li><li>  Web application security (WAF) (Imperva SecureSphere WAF, Radware AppWall, Fortinet Fortiweb); </li><li>  network traffic anomaly detection systems (StealthWatch, RSA NetWitness, Solera Networks); </li><li>  systems for analyzing and optimizing the settings of the ME infrastructure (Algosec, Tufin, RedSeal, SkyBox); </li><li>  Code Security Audit (HP Fortify, ERPScan CheckCode, Digital Security, IBM AppScan Source); </li><li>  protection against fraud when accessing online banking systems (Versafe); </li><li>  digital information security incident investigation (Forensic Analysis and Incident Response) (AccessData); </li><li>  DDoS protection system (iron - Radware DefensePRO, ARBOR PRAVAIL, Check Point DDoS Protector; service - Kaspersky DDoS Prevention, QRATOR HLL). </li></ul><br><br><h4>  Counteraction (theory) </h4><br><ol><li>  At the stage of data collection, firewalls and systems for detecting and preventing network attacks are traditionally used.  The main problem is that they, as a rule, do not define a slow scan.  NG FW (firewalls of the new generation) allow you to correlate events on the network, compare parts of attacks and see the full picture.  For example, anomalies on the time of day, traffic on new ports and so on are investigated. </li><li>  At the intrusion stage, traditional query filtering, intrusion prevention systems, antiviruses, including ‚Äúheavy‚Äù on gateways, are now being applied.  In addition to the NG FW systems, two more methods are used - traps and sandboxes.  Pitfalls are pseudo-vulnerable services within the network, the sole purpose of which is to take over the attack and raise the alarm.  Sandboxes work to block intrusions as follows.  Suppose a user receives mail with an archive.  Within three minutes before delivery to the user, the sandbox ‚Äúswings‚Äù this archive.  To begin with, it turns out that inside there are three files, one is executable, it assembles its piece from the other two, and then creates a process and writes a key in the registry.  The task is to simulate a regular machine, because many malicious programs perfectly detect the hypervisor mode and are not activated.  In modern sandboxes, there is a network activity simulator (even allowing the malware to receive ‚Äúanswers‚Äù ‚Äã‚Äãfrom the command center), using both static disassembling and dynamic code analysis, the malware is offered various environments - server, user, and so on, and directly from standard images of the current network.  There is a GUI allowing you to see which code does what. </li><li>  If the intrusion has already passed, it is necessary to localize the threat and prevent data extraction.  For this purpose, incident investigation systems are used, analyzing logs and tracing the paths of malware distribution over the network.  If the extraction was still - the same systems help to understand what exactly was carried out.  For example, Sony blocked the first attack on its infrastructure before extraction and began to celebrate, but, as you know, then there were more vectors. </li><li>  At this next stage, you need to start a formal investigation and go to court.  For the court need evidence of attack.  Have you ever tried to collect them over the network?  So, the same Forensic Analysis can take a copy of the infrastructure and create a detailed report on the current number, and then close it with a digital signature.  And the American courts are already accepting such megatuy files with all the memory snapshots, a list of processes, logs, and so on as evidence.  They can be picked slowly and quietly. </li></ol><br><br><h4>  Counteraction (practice) </h4><br>  We have a customer - a large retail chain - the infrastructure of which has been under constant targeted attacks for several months.  A large botnet works with a wide range of IP, used as attempts to carry exploits, and good old brute force.  All this is accompanied by waves of DDoS.  I can‚Äôt tell you concretely on this occasion until the end of the attack is visible (and another two years ago), so I‚Äôll show you what I would do <i>in theory</i> to protect such a system.  In addition, that would have provided a deliberately unrevealed service under brute force. <br><ol><li>  I would update network security tools to a new generation in order to analyze slow events, see non-standard data collection algorithms and decrypt malware channels. </li><li>  Profiling data flows between hosts and establishing control over this. </li><li>  Would register restrictions in network rules. </li><li>  I would launch on a regular basis the system of searching for vulnerabilities from the inside - these are sets of utilities that run around the network and try to attack everything that is badly lying.  I would get a standard list of unclosed hardware exploits and un-updated software. </li><li>  Once a week, I would look at optimizing settings ‚Äî these are utilities that analyze network rules on nodes (including intermediate equipment), prioritize them for speed, look for obvious children‚Äôs schools, and help establish best practice.  Very useful, although quite expensive, solutions.  By the way, it helps to close the holes removed from the support of applications on intermediate devices due to filtering. </li><li>  I would connect a data cleaning center on a trunk channel (in Russia there are a couple of such pieces) in case of powerful DDoS in order to transfer traffic to it in a maximum of 30 seconds. </li><li>  I would connect to the knowledge base about hacker groups actions.  There are special teams that read hacker forums, merge minor vulnerabilities, and so on, seeking credibility in this environment.  They signal new methods and tools. </li></ol><br><br><img src="https://habrastorage.org/files/b0b/dda/e4c/b0bddae4cd864875a9cebe13308dee8e.png"><br>  <i>Algosec, an example of a GUI for setting up basic rules for an IT department manager (not a security officer)</i> <br><br><h4>  Code Security </h4><br>  If a company develops code, then often the code itself becomes the target for attacks and bookmark embedding.  For such situations, systems of checking the integrity of the code, analyzing references to it, source modification maps, and so on are used.  In general, they make it possible to understand who and when should not have referred to a specific site, but turned and added something.  In parallel, a static analysis is performed for vulnerabilities. <br><br><h4>  User protection </h4><br>  One of the frequent modern vectors in the banking sector is an attack not on the server part, but on the users equipment.  A frequent example is a trojan that can, when you click on the submit button of a form, replace the account for the transfer of funds and the amount of payment.  Some banks in their IB assume that the user equipment is obviously unreliable, and have protection against such attacks on their side. <br><br><h4>  Cases </h4><br>  The problem of cases in security is whether to consider the success of a non-happening attack as success.  For example, there is a situation with Infostruktura (Lithuania) - an analogue of RSNet in Russia, its example is indicative.  The company provides communication services to the Government of Lithuania.  Uses the full range of AMS to protect government sites and some commercial structures (more than 200 sites).  Uses AppWall, DP, Alteon, over 2 years reflecting attacks at all levels.  The only provider that survived the massive attack on Lithuania during the European forum there last year.  But, of course, the best defense is when an attack does not even occur, because it is too expensive.  If interested, I will provide more cases on your field when you request to plutsik@croc.ru. <br><br><h4>  Summary </h4><br>  Attacks on large companies are not myths.  Right now, one of our customers is experiencing several dozen different attacks a day, the other is defending himself against weekly DDoS, and several more consistently catch interesting files from sandboxes.  Theoretically, with due attention, the race of the shield and sword in the field of information security continues all the time, and the balance is maintained.  The only effective vulnerability is humans.  Sotsinzhiniring is the most effective and timeless method.  And the task of educating users, plus regular exercises, lies not only on our technical side, but also on the side of the customer‚Äôs staff. </div><p>Source: <a href="https://habr.com/ru/post/236411/">https://habr.com/ru/post/236411/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236397/index.html">How to make nandroid backup device directly to your computer, bypassing the sdcard</a></li>
<li><a href="../236399/index.html">RailsClub'Moscow 2014: Interview with Bozhidar Batsov</a></li>
<li><a href="../236401/index.html">Disassemble and reassemble the USB stack</a></li>
<li><a href="../236403/index.html">String enum - string enum</a></li>
<li><a href="../236409/index.html">Mailbox eyes of letters</a></li>
<li><a href="../236413/index.html">LinkMeUp. Issue number 19. The company Zelaks, technical support and data transmission through power lines</a></li>
<li><a href="../236415/index.html">Global interface update for Skype for Windows Desktop</a></li>
<li><a href="../236417/index.html">Free calls from Hangouts</a></li>
<li><a href="../236423/index.html">Perception Neuron: Motion Capture in every home</a></li>
<li><a href="../236425/index.html">The world's smallest A4 inkjet printer Epson WorkForce WF-100W</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>