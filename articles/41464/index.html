<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MemcacheDB and MemcacheQ are key components of a high-performance infrastructure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will talk about the components for a high-performance and scalable memcached server-based architecture, namely, a distributed database for st...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MemcacheDB and MemcacheQ are key components of a high-performance infrastructure</h1><div class="post__text post__text-html js-mediator-article">  Today we will talk about the components for a high-performance and scalable memcached server-based architecture, namely, a distributed database for storing <a href="http://memcachedb.org/"><strong>MemcacheDB</strong></a> data and <a href="http://memcachedb.org/memcacheq/"><strong>MemcacheQ</strong></a> message queue system. <br><br><div style="text-align:center;"><img src="http://abrdev.com/wp-content/uploads/2008/10/intro.png" width="432" height="93"></div><br><br>  First, consider what we have available for creating a distributed storage infrastructure for a web application.  Well, the first thing that comes to mind is database clustering; it is now supported in all common systems, as well as various replication technologies.  For example, the most popular DBMS for web projects, MySQL supports both replication and clustering.  You can also refer to the traditional file system and store data in the file system, for example, <a href="http://hadoop.apache.org/core/">Apache Hadoop</a> .  But often this is too high-level solution, usually the options are much simpler - when it is necessary to store and operate just key-value pairs.  If you look seriously, this functionality will cover the needs of 90% of web applications.  And if we add to this the ability to operate very, very quickly with data, store them in the form of a distributed multi-server system and the possibility of permanent storage that is resistant to failures - we get a very attractive platform. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  <a href="http://www.danga.com/memcached/"><strong>Memcached</strong></a> has long been known as a data caching server that is used on many high-load projects, including Wikipedia and LiveJournal, and allows you to cache any data in memory and quickly operate on it, while only the simplest operations are supported, this is clearly not a complete database.  And the use of memory as a data storage is ideal for the case of data caching, but if it comes to reliability or fault tolerance, then the work is shifted to the server itself and the equipment. <br><br>  That's to solve all these issues, to combine high speed, simple interface and the principles of memcached, and the reliability of conventional databases, and MemcacheDB was developed.  This is a system of distributed data storage in the form of key-value pairs, which is compatible with the memcached API, which means that any client can work transparently with both the cache and the data storage without even noticing it.  But, unlike the cache, the memcacheDB data is stored on disk - <a href="http://www.oracle.com/technology/products/berkeley-db/index.html"><strong>BerkeleyDB‚Äôs</strong></a> embedded industrial database is used as a backend and all features are used to ensure efficient and reliable storage, in particular, transactionality and replication. <br><br><div style="text-align:center;"><img src="http://abrdev.com/wp-content/uploads/2008/10/berkeleydb.png" width="409" height="330"></div><br><br>  According to the speed of access to data, memcacheDB is at the same memcache level and is comparable to specialized databases, for example, <a href="http://couchdb.org/">CouchDB</a> , and in numbers this amounts to tens of thousands of write and read operations per second (and here is a <a href="http://memcachedb.org/benchmark.html">benchmark</a> , as well as a <a href="http://fatalerror.in/content/benchmarking-couchdb-against-memcachedb">comparison with CouchDB</a> ).  The developers themselves warn that memcacheDB is not a cache, so you should not use it everywhere as a replacement for memcached itself, it just implements a different storage strategy with compatible access, similar to memcached. <br><br>  Despite the simplest operations with data - writing, reading, updating and deleting, such functionality is often enough for most tasks, where we are accustomed to using regular databases.  But if you transfer part of the operations to specialized solutions, this will significantly relieve the main base for operations that already require serious means of working with data.  For example, an increment / decrement variable command is supported, which will allow implementing various counters and statistics without accessing the database, while the system will be able to serve thousands of clients in real time. <br><br><div style="text-align:center;"><img src="http://abrdev.com/wp-content/uploads/2008/10/img_1.png" width="500" height="401"></div><br><br>  MemcacheDB is easy to deploy - install and compile from source, install the database (it does not require administration) and that's it.  Simply configure client access parameters ‚Äî a port and several other parameters that affect performance, for example, the size of the data buffer, the directory for storing the database, the size of the cache in memory.  Do not think that all read operations come from the disk, since the system uses the database as a file on the disk, of course, caching is also used, which allows you to compare in speed with the original memcached, while also ensuring the reliability of storage. <br><br>  The most interesting feature of memcacheDB is the ability to work on multiple servers using replication to exchange data and synchronize databases.  At the same time, memcacheDB can use several replication strategies, depending on your needs, to guarantee data integrity or ensure speed.  The main model of a distributed infrastructure supported by the system is one master server and several slave slave servers that are used only for reading data. <br><br>  In the case of multiple servers, the system can use the following replication strategies: <br><ul><li>  <strong>DB_REPMGR_ACKS_ALL</strong> - the master server is waiting for confirmation of successful data recording from all other servers; </li><li>  <strong>DB_REPMGR_ACKS_ALL_PEERS</strong> - the master expects a response from all the slave servers, which are, in turn, master servers for their groups (multi-level system); </li><li>  <strong>DB_REPMGR_ACKS_NONE</strong> - do not expect any confirmation from other servers.  The highest speed, but there are no guarantees that there are copies of data on other servers besides the master. </li><li>  <strong>DB_REPMGR_ACKS_ONE</strong> - waiting for confirmation of at least one of the servers; </li><li>  <strong>DB_REPMGR_ACKS_ONE_PEER</strong> is the same as in the previous case, but confirmation is expected from the server, which in turn is the master server for its group. </li><li>  <strong>DB_REPMGR_ACKS_QUORUM</strong> - we expect confirmation from a certain minimum number of servers that guarantee data integrity and are also master servers for their groups.  This strategy is used by default. </li></ul><br><br><div style="text-align:center;"><img src="http://abrdev.com/wp-content/uploads/2008/10/replica.png" width="500" height="398"></div><br><br>  For now, it is necessary that all servers in a group use the same replication strategy, but I am not sure that this concerns complex systems, where there are many groups ‚Äî in the end, you can configure it so that the request will be distributed first to one server group with one strategy, and then the data is distributed according to another algorithm, while the root server is not even aware of this. <br><br>  Logging and backup of the database files themselves, including hot backup, are separately supported, but this is a separate conversation and the specifics of installation and use. <br><br>  And so, we have the opportunity to organize ... such a service Amazone S3, while somehow distributed, fast and reliable, with a simple and clear universal API.  There are many applications to such a system; in virtually every high-loaded project, you can transfer part of the logic from the database to such storage system and obtain high fault tolerance and ensure load relief for a lot of simple queries from the main database. <br><br>  The second project, also based on memcached code, is <a href="http://memcachedb.org/memcacheq/"><strong>memcacheQ</strong></a> .  This is a message queuing system that has an even simpler API and supports only two commands, read and write.  The message queue is a named stack where messages can be written, and the client, by specifying the name of the queue, can receive all messages from the queue at any other time.  The maximum message size is 64Kb, and the data itself is stored in the BerkeleyDB database itself, which means the same data integrity, replication and other features are provided.  Such a system can be used to build systems of communication between users within the project, mail systems, chat and other similar ones, where such functionality multiplied by greater speed and reliability is required. <br><br>  These two projects, <strong>MemcacheDB</strong> and <strong>MemcacheQ</strong> are quite simple in terms of the external interface and seemingly limited in capabilities, but at the same time they allow you to build very powerful and highly loaded projects on your basis if you take them into account at the design stage.  For many projects, this will allow abandoning or reducing the burden on expensive resources in the form of a database and ensuring high resiliency and flexibility. </div><p>Source: <a href="https://habr.com/ru/post/41464/">https://habr.com/ru/post/41464/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../41457/index.html">The beginning of a new era. bigmir) net came to Belarus.</a></li>
<li><a href="../41458/index.html">Bit Mask Resurrection</a></li>
<li><a href="../41460/index.html">Steampunk Mobile</a></li>
<li><a href="../41461/index.html">Rambler launches the most expensive advertising campaign in the history of Runet</a></li>
<li><a href="../41462/index.html">XSPF is the perfect format for playlists.</a></li>
<li><a href="../41467/index.html">World of Warcraft bots developer to pay a fine</a></li>
<li><a href="../41469/index.html">My education experience</a></li>
<li><a href="../41470/index.html">Another ten small programs that are comfortable</a></li>
<li><a href="../41472/index.html">iPhone ‚Äî like a full gprs / 3g modem using VPN over SSH.</a></li>
<li><a href="../41474/index.html">Goodbye sape!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>