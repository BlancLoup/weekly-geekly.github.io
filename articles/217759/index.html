<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The story of the three core vulnerabilities</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, Trustwave, an information security firm, published a report announcement criticizing how the Linux community handles vulnerabilities. It say...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The story of the three core vulnerabilities</h1><div class="post__text post__text-html js-mediator-article">  Recently, Trustwave, an information security firm, published a <a href="http://www2.trustwave.com/rs/trustwave/images/Trustwave_GSR_ExecutiveSummary_4page_Final_Digital.pdf">report</a> announcement criticizing how the Linux community handles vulnerabilities.  It says: ‚ÄúSoftware developers vary greatly in their ability to respond and address zero-day vulnerabilities.  This study shows that Linux developers have the worst response time: an average of almost three years from the moment of vulnerability detection to the release of the patch. ‚Äù  No matter how satisfied you are with the security updates in Linux, three years is much more than we usually expect.  Your obedient servant decided to investigate the situation, concentrating on two vulnerabilities that were included in the Trustwave report and one that was not there. <br><a name="habracut"></a><br><h2>  Three years? </h2><br>  At the time of this writing, the full Trustwave report was not yet available (it can now be downloaded <a href="http://www2.trustwave.com/rs/trustwave/images/2013-Global-Security-Report.pdf">here</a> . - <em>Note. Per.</em> ), So a detailed study of the statements submitted is not possible.  But, judging by this <a href="http://www.zdnet.com/linux-trailed-windows-in-patching-zero-days-in-2012-report-says-7000011326/">article on ZDNet</a> , the average response time was calculated for these two zero-day vulnerabilities: <br><br><ul><li>  <a href="http://cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2009-4307">CVE-2009-4307</a> : division by zero error in ext4 file system code.  To exploit this vulnerability, it is necessary for the user to mount a specially prepared ext4 file system image. </li><li>  <a href="http://cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2009-4020">CVE-2009-4020</a> : HFS + file system buffer overflow;  operated again by mounting a specially prepared image of the file system on the target system. </li></ul><br><br>  The problem with the ext4 file system was <a href="https://bugzilla.kernel.org/show_bug.cgi%3Fid%3D14287">reported by</a> RN Sastry on October 1, 2009, which conducted fuzz testing of the file system (a type of testing in which the search for errors is performed using random input data. - <em>Note</em> ).  The error message also included a file system image that triggers a bug, which is essentially an ‚Äúexploit‚Äù for this vulnerability, which allowed Trustwave to call it a zero-day vulnerability.  And, since the problem caused only kernel oops (a system error, after which the kernel panic often happened), and also required cooperation from the victim (mounting the file system prepared by the attacker), the ext4 developers did not consider it necessary to drop everything and immediately eliminate the vulnerability.  Ted Ts'o recorded a <a href="https://git.kernel.org/%3Fp%3Dlinux/kernel/git/torvalds/linux-2.6.git%3Ba%3Dcommit%3Bh%3D503358ae01b70ce6909d19dd01287093f6b6271c">correction</a> at the end of November.  SUSE was the first to publish an update fixing a vulnerability, it happened on January 17, 2010.  Red Hat did not release the update until the end of March, almost five months from the moment the information about the vulnerability appeared, and Mandriva waited until February 2011. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It can be argued that everything did not happen quickly, even for a bug with extremely low priority, but where did these ‚Äúthree years‚Äù come from?  They appeared because the fix did not work properly on the x86 architecture.  Xi Wang <a href="http://lwn.net/Articles/538899/">reported</a> that the problem still exists, on December 26, 2011, and <a href="http://lwn.net/Articles/538900/">sent an intelligent correction</a> on January 9, 2012. This issue was assigned a new CVE number ( <a href="http://lwn.net/Articles/496295/">CVE-2012-2100</a> ), and the fix was promptly infused into the mainline.  The maintainers were not particularly agile, however, Debian released an update in March, Ubuntu in May, and Red Hat waited until mid-November.  It took about eleven months after the discovery of the vulnerability to deliver the patch to the users.  Since the discovery of the problem until the release of the Red Hat update, which finally solved the problem, indeed, more than three years have passed. <br><br>  The story of HFS / HFS + is very similar.  The first <a href="http://marc.info/%3Fl%3Dlinux-mm-commits%26amp%3Bm%3D125987755823047%26amp%3Bw%3D2">patch</a> that resolves the HFS buffer overflow problem was published by Amerigo Wang in early December 2009.  The fix was committed by Linus on December 15, and the Red Hat maintainers began distributing the update on January 19, 2010.  Some maintainers were even slower, but this vulnerability was also recognized as difficult to exploit and was considered a low priority. <br><br>  The problem is that the kernel supports another (more recent) file system called HFS +.  This is a standalone implementation, containing a fair amount of code copied from the original HFS implementation, just like ext4 was started by copying ext3.  The danger of such duplication of code is well known: the developer corrects the problem in one copy, without even suspecting that the same problem may be in the other.  Naturally, this happened here.  The HFS + implementation had the same buffer overflow vulnerability, but no one thought about it until Timo Warns caught the attention of several kernel developers at the end of April 2012.  Greg Kroah-Hartman <a href="http://git.kernel.org/linus/6f24f892871acc47b40dd594c63606a17c714f77">published the changes</a> on May 4, and the issue went public several days after that.  And again, a new CVE number was assigned ( <a href="http://lwn.net/Articles/500139/">CVE-2012-2319</a> ), and again the maintainers missed with corrections.  OpenSUSE released an update in June, while Red Hat waited until October, five months after the problem became known.  From the time of discovery until the publication of the fix in Red Hat, a little less than three years have passed. <br><br>  But you can look at this problem from different angles.  On the one hand, it is obvious that Trustwave specifically chose these vulnerabilities and then interpreted them to show the maximum possible repair time.  But none of the stories describe the zero-day vulnerability that would remain open for three years;  most of the time it was assumed that the problem was solved.  This is doubly true for HFS +, a vulnerability in which was not even known until May 2012.  And, given the nature of these vulnerabilities, it is highly unlikely that black hats jealously concealed them all this time, and most likely no system was compromised with their use.  Trustwave‚Äôs claims, if based on these two vulnerabilities, are dubious and exaggerated at best. <br><br>  On the other hand, even low-priority vulnerabilities requiring actions by the victim must be corrected correctly and if possible quickly.  But, in fact, not everything is so simple with what happened with these vulnerabilities.  The response to the ext4 problem was quite fast, especially considering the nature of the problem, but the fact that the problem was still relevant on the x86 architecture shows that at least testing was at least unsatisfactory.  In the case of HFS / HFS +, who can even blame <em>someone</em> for not seeing, is there a duplicate bug in some other place?  On the background of the fact that the HFS and HFS + file systems are almost not used and, one might say, are not supported, the claims do not hold water.  However, attackers are not limited to well-supported code. And, in both cases, the maintainers did not bother to deliver fixes to their users.  It would be possible to work better. <br><br><h3>  Meanwhile in 2013 </h3><br>  Probably the slowness shown above is a natural response to vulnerabilities that nobody really cares about.  If they were a more serious reaction, undoubtedly, would be much better.  And as is usually the case, at the time of writing the article (article published February 19, 2013. - <em>Approx. Lane.</em> ), There is an open vulnerability, so that we can observe how well we can react.  And the answer is not encouraging. <br><br>  On January 20, the discussion from the private mailing list on kernel security became public in connection with the <a href="http://lwn.net/Articles/538902/">publication of a patch</a> written by Oleg Nesterov.  It was demonstrated that the implementation of the <code>ptrace()</code> system call in the Linux kernel contains race conditions: the registers of the process being traced can be modified so that the kernel restores the contents of the stack of this process to an arbitrary location.  Ultimately, this leads to the possibility of executing arbitrary code in kernel mode.  The attack is carried out locally, so the attacker must launch an exploit on the target system.  But having the opportunity to run such a program, it can use the full set of root privileges.  These kinds of vulnerabilities require immediate attention.  Any system with a similar vulnerability is actually handed over to the delight of any (including untrusted) user with an account, or any hacker who can compromise a network service and run an arbitrary program. <br><br>  February 15 vulnerability was <a href="http://lwn.net/Articles/538904/">discovered</a> and published, and with a very high-quality code for the exploit, for those who do not want to write their own.  Most victims are unlikely to apply a patch to the core to make it easier to realize the race condition, and the exploit also needs to work in real time in order to win the race more reliably.  But even without a patch and real-time work, a patient enough attacker can get a result.  Here‚Äôs how the Solar Designer <a href="http://lwn.net/Articles/538905/">vulnerability responded</a> : <br><br><blockquote>  I have not had time to carefully look at all this, but at first glance, this is the worst vulnerability in a few years.  For mainteners of distribution kernels (other than the main branch, which was patched almost a month ago), this is 0-day. <br></blockquote><br><br>  Actually, this should not be a zero-day vulnerability, since the public discussion of the correction has already been about a month, and the private one has been going on for some time before that.  But at the time of writing, no distribution has yet released updates for this problem.  Which leads us to some obvious questions.  Again we quote Solar Designer: <br><br><blockquote>  The commits of Oleg Nesterov from Red Hat hit the main branch in January.  Why in Red Hat the problem was not (?) Handled with all seriousness, well, or in the end, the information was not published, which of their cores are affected by this vulnerability at the moment. <br></blockquote><br><br>  This statement suggests that similar problems are possible in the future.  In the meantime, users and system administrators around the world need to worry about whether their systems are vulnerable and who can exploit these vulnerabilities. <br><br>  And again: we can work better.  From the very beginning it was known that this was a serious problem;  One of the developers who reported on it (Salman Qazi from Google) also attached an exploit to show how serious the situation is.  Maintainers knew about the problem and had enough time to respond to it, but still did not respond in a timely manner.  The problem with <code>ptrace()</code> solved in less than 3 years, but there is nothing to be proud of.  Users can not be left to fend for the whole month (if not more), since the mainteyner learned about this problem. <br><br>  Note from the translator: <br>  The fix in Debian was released on February 25, in Red Hat - February 26, in Ubuntu - February 21, in OpenSUSE - February 25. </div><p>Source: <a href="https://habr.com/ru/post/217759/">https://habr.com/ru/post/217759/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../217743/index.html">Mathematics for testers</a></li>
<li><a href="../217747/index.html">How to identify hacker activity on the site, eliminate its consequences and defend against intruders</a></li>
<li><a href="../217751/index.html">Yandex cleaned DNS view for AAAA records</a></li>
<li><a href="../217753/index.html">StackExchange API Basics</a></li>
<li><a href="../217757/index.html">Cape Town Science Center: Polytechnic Museum, where you have to press all the buttons</a></li>
<li><a href="../217765/index.html">Smart home control panel. iphone in the wall</a></li>
<li><a href="../217767/index.html">Who is better: compare 5 popular credit cards</a></li>
<li><a href="../217769/index.html">The history of the Eiffel Tower and ... "Descriptive Geometry"</a></li>
<li><a href="../217771/index.html">How to minimize setting for content site</a></li>
<li><a href="../217775/index.html">Cosmos Facts Hard to Believe</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>