<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Free network security audit with Fortinet. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Relatively recently, we published a short video course and several articles on how to conduct a free network security audit using Check Point solution...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Free network security audit with Fortinet. Part 1</h1><div class="post__text post__text-html js-mediator-article">  Relatively recently, we published a short <a href="https://habrahabr.ru/company/tssolution/blog/332390/">video course</a> and several articles on how to conduct a free network security audit using <a href="http://tssolution.ru/checkpoint/">Check Point</a> solutions.  This time we would like to describe a similar procedure, but only using <a href="http://tssolution.ru/fortinet/">Fortinet</a> solutions. <br><br><h2>  Fortinet </h2><br><img src="https://habrastorage.org/web/6d9/f06/791/6d9f06791513435f8ffdfba1207865ff.png"><br>  <b>Fortinet</b> is a prominent representative of the permanent leaders among UTM / NGFW solutions.  Earlier we published the <a href="https://habrahabr.ru/company/tssolution/blog/333338/">corresponding Gartner report for 2017</a> .  Perhaps the flagship product of this company is <b>FortiGate</b> - the security gateway (we will consider it later).  However, the company's product portfolio is much wider, as you can see from the image above.  Here is a short list: <br>  <b>FortiGate</b> - Next Generation Firewall (NGFW); <br>  <b>FortiManager</b> - Centralized management of Fortinet devices; <br>  <b>FortiAnalyzer</b> - Centralized collection of event data (logs) from all Fortinet devices; <br>  <b>FortiSandbox</b> - Protection against targeted attacks (sandbox); <br>  <b>FortiMail</b> - Protects against spam, malware in attachments and other email threats; <br>  <b>FortiWeb</b> - Firewall for your Web applications; <br>  <b>FortiSIEM</b> - System for collecting, analyzing and correlating events; <br>  <b>FortiSwitch</b> - Fortinet switches; <br>  <b>FortiClient</b> - Protection of users' computers; <br>  <b>FortiADC</b> - Application Delivery Controller; <br>  <b>FortiDB</b> - Database Protection; <br>  <b>FortiAuthenticator</b> - Two-factor authentication (2FA) and SSO access; <br>  <b>FortiToken</b> - Tokens for two-factor authentication (2FA); <br>  <b>FortiAP</b> - Wireless Access Point; <br>  <b>FortiExtender</b> - 3G / LTE signal booster; <br>  <b>FortiPresence</b> - Attendance Analysis; <br>  <b>FortiCloud</b> - Save logs in the cloud; <br>  <b>FortiDDoS</b> - Prevent DDoS attacks. <a name="habracut"></a><br><br>  You can <a href="http://tssolution.ru/fortinet/"><b>read</b></a> more about Fortinet solutions <a href="http://tssolution.ru/fortinet/"><b>here</b></a> , or see our previous webinar: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <iframe width="560" height="315" src="https://www.youtube.com/embed/o_HZZ9kC7dE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  It briefly discusses modern threats, company history, product line, FortiGate models, device interface, and so on (I highly recommend this video for an express acquaintance with Fortinet). <br><br><h2>  Cyber ‚Äã‚ÄãThreat Assessment Program (CTAP) </h2><br>  Fortinet provides a free opportunity to conduct a network security audit using FortiGate.  This program is called the <b>Cyber ‚Äã‚ÄãThreat Assessment Program (CTAP)</b> .  The principle of auditing is quite simple - FortiGate is installed on your network, which analyzes traffic (later we will look at what is being specifically analyzed).  At the same time, there are several variants of such a ‚Äúpilot‚Äù project, which usually lasts from two to four weeks.  Consider them. <br><br><h3>  1) Traffic copy (One-Arm Sniffer) </h3><br>  The easiest and at the same time the most popular way is to analyze traffic copies.  FortiGate connects to the switch's SPAN port, which mirrors the traffic of interest.  As a rule, traffic between the kernel switch and the Internet gateway is analyzed.  Since  FortiGate works only with a copy of the traffic, then there is no risk for your network.  We will consider this method in detail. <br><br><img src="https://habrastorage.org/web/2ab/0b3/2c9/2ab0b32c96ed4af8a2261bb03a6ef1fe.png"><br><br><h3>  2) In bridge mode (Transparent mode) </h3><br>  A less popular way.  In this case, FortiGate is installed in bridge mode and real traffic flows through it.  This method is rarely chosen, because  in this case, it is necessary to change the physical topology of the network and organize the process window at the time of switching. <br><br><img src="https://habrastorage.org/web/71d/4dd/8e0/71d4dd8e022948ab8ccbfe284af325e9.png"><br><br><h2>  FortiGate Appliance vs FortiGate VM </h2><br>  For auditing, you can choose two versions of FortiGate: Appliance (piece of hardware) and VM (virtual machine).  Each method has its advantages and disadvantages. <br><br><h3>  1) FortiGate Appliance </h3><br>  "Iron" device.  As a rule, several options are given to the test (depending on the volume of traffic being processed): <br><img src="https://habrastorage.org/web/561/e65/aea/561e65aea24842b49f638d4db98f275a.png"><br><br>  A device for a test can be obtained only upon <a href=""><b>request</b></a> to Fortinet partners. <br><br>  <b>Pros:</b> <br><br><ul><li>  No allocation of virtual resources (which is often lacking) is required; </li><li>  High performance; </li><li>  You are testing a real device and can evaluate its performance (if you look at FortiGate, then most often they buy the ‚Äúiron‚Äù solution). </li></ul>  <b>Minuses:</b> <br><br><ul><li>  Waiting for the Appliance (there is almost always a shortage of hardware, everything is on tests). </li></ul><br>  In addition, not every city has a partner who can provide you with equipment for a test.  With virtual machines everything is easier ... <br><br><h3>  2) FortiGate VM </h3><br>  FortiGate virtual machine.  Supported Hypervisors - <b>VMware ESXi, KVM, Hyper-V,</b> <b><br></b>  <b>XenServer</b> . <br><br><img src="https://habrastorage.org/web/1bc/312/912/1bc312912ac74ebeb24e7b2d2614f49a.PNG"><br><br>  Not only FortiGate is available as virtual machines, as can be seen from the figure above. <br><br>  <b>Advantages of using FortiGate VM:</b> <br><br><ul><li>  Ease of deployment (imported via ovf); </li><li>  Deployment speed (get a virtual machine from partners much faster than the ‚Äúiron‚Äù solution). </li></ul>  <b>Minuses:</b> <br><br><ul><li>  It is necessary to allocate virtual power. </li></ul><br>  In general, this is not such a big problem, because  for a medium-sized network (100-200 computers), a virtual machine with the parameters of 2-4 cores and 2-4 GB of RAM is sufficient.  Virtual machine features: <br><br><img src="https://habrastorage.org/web/788/52e/e94/78852ee94934435f97d248270f931bef.PNG"><br><br>  Next, we will consider this particular way of auditing - <b>using the FortiGate VM virtual machine.</b> <br><br><h2>  Report generation </h2><br>  FortiGate itself, when analyzing traffic, generates a huge number of logs.  Example: <br><br><img src="https://habrastorage.org/web/da9/654/771/da9654771abe4934be05d24f05f81e06.PNG"><br><br>  Logs, though interesting (show the applications used, traffic volumes, visited sites, malicious activity, etc.), but do not provide a complete picture of the network security.  Complex reports are much more interesting, which can be generated in different ways: <br><br><ol><li>  <b>Send logs to the Fortinet cloud for further analysis</b> .  This feature is only available for hardware.  Perhaps this is the easiest option.  At the end of the audit, the partner provides a detailed security report on your network.  There is one BUT - not everyone is ready to send their logs to the outside world (even to the Fortinet cloud).  In this case, there are tradeoffs. </li><li>  <b>Collect logs locally on the device, and then transfer them to the partner for analysis in one archive</b> .  There is a limit of 100 MB.  This option is used very rarely. </li><li>  <b>Send logs to the local FortiAnalyzer</b> .  In this case, all the logs are stored with you and you can generate reports at least every hour, and not just at the end of the pilot project.  The only thing - will have to additionally deploy FortiAnalyzer (it is not difficult). </li></ol><br>  We will consider the third option, where together with the virtual <b>FortiGate</b> we will deploy the virtual <b>FortiAnalyzer</b> .  In addition, for a virtual solution there is no possibility to send logs to the cloud for analysis. <br><br><h2>  The composition of the report </h2><br>  In the case of using <b>local FortiAnalyzer</b> , a large number of types of reports are available to us: <br><br><img src="https://habrastorage.org/web/939/025/2db/9390252dbad148199ee89fab7e11d11b.PNG"><br><br>  Since  we do a comprehensive analysis of network security, then we will be more interested in the <b>Cyber ‚Äã‚ÄãThreat Assessment</b> report.  This report contains a large amount of information on the network status: <br><br><div class="spoiler">  <b class="spoiler_title">The composition of the report</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/a82/528/8a5/a825288a51974a2f9a5618f6810837eb.PNG"><br></div></div><br>  On the first page you will see a general summary, something like: <br><br><img src="https://habrastorage.org/web/7e0/863/a7c/7e0863a7c5ea43d99390d2ae4217bf16.PNG"><br><br>  Then you can see the statistics on ‚Äúdangerous‚Äù applications: <br><img src="https://habrastorage.org/web/e08/08d/af1/e0808daf1d4e41609f2ccd6680721aaf.PNG"><br><br>  Vulnerabilities found: <br><br><img src="https://habrastorage.org/web/8a1/13c/8d4/8a113c8d460548849d72f68d60103a3a.PNG"><br><br>  Statistics on downloaded viruses: <br><br><img src="https://habrastorage.org/web/e27/6af/8e5/e276af8e53ed4eb69d72c7e18087525a.PNG"><br><br>  The volume of traffic for specific applications: <br><br><img src="https://habrastorage.org/web/d14/58a/2ab/d1458a2abfe044939f7d2f4e454679df.PNG"><br><br>  Categories used sites: <br><br><img src="https://habrastorage.org/web/dfc/7e1/196/dfc7e1196a5c482c823e0dad2395f82b.PNG"><br><br>  And much more.  Sample report can be <a href="https://drive.google.com/file/d/0B-5kZl7ixcSKN3JXdllOYktiMG8/view%3Fusp%3Dsharing">downloaded here</a> . <br><br><h2>  Conclusion </h2><br>  In general, this audit option provides fairly detailed statistics on your network, which will be useful for any company.  Based on the results of testing, it will be possible to draw conclusions about the effectiveness of existing remedies, threats that exist, or just about the quality of <a href="http://tssolution.ru/fortinet/">Fortinet</a> solutions.  If you are interested in a similar test, you can feel free <a href=""><b>to contact</b></a> . <br><br>  The first part ends here.  In the second part, we will look at the process of setting up and generating a report. </div><p>Source: <a href="https://habr.com/ru/post/335184/">https://habr.com/ru/post/335184/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335172/index.html">Attack of the clones. How to deal with code duplication?</a></li>
<li><a href="../335174/index.html">Smart stores, omni-channel analytics and endless loyalty: 6 retail trends in 2017</a></li>
<li><a href="../335176/index.html">Use PowerShell for IT security. Part I: Event Tracking</a></li>
<li><a href="../335178/index.html">Asynchronous decoder</a></li>
<li><a href="../335180/index.html">How the push notification service helped us make the technical support portal more visited</a></li>
<li><a href="../335186/index.html">Sites online stores and industrial companies are most vulnerable to hacker attacks</a></li>
<li><a href="../335188/index.html">ML Boot Camp V, solution history for 3rd place</a></li>
<li><a href="../335192/index.html">What are the bad nested classes and how to learn rails magic</a></li>
<li><a href="../335194/index.html">Why do you need SBC on the border</a></li>
<li><a href="../335196/index.html">Cryptocurrency Dash invites ... to crack your blockchain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>