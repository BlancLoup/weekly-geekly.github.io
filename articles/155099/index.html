<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>x-acl lightweight utility to organize Access Control List (ACL)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings, habra-community! 

 Each project (web project) has questions about the organization of access rights. In this area there are certain ready-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>x-acl lightweight utility to organize Access Control List (ACL)</h1><div class="post__text post__text-html js-mediator-article">  Greetings, habra-community! <br><br>  Each project (web project) has questions about the organization of access rights.  In this area there are certain ready-made tools for various frameworks Zend, Symfony, Yii, etc. Probably someone faced with something and generally imagines what it is.  For those who have not encountered - I advise you to open the documentation of any of these frameworks and get acquainted.  In particular, the author of the post worked very closely with Zend_Acl.  But relatively recently decided to explore the issue of ACL in C ++ <a name="habracut"></a><br><br><h4>  So, how it all began ... </h4><br>  It all started very simply, there is a samopisny project with a good load (for ethical reasons, its name is not called, it is self-written for historical reasons, 200K unique).  The project, as in most cases, "dictates the tradition" is written in php.  The organization of access lists in it, as such, is absent - there are banal conditional operators in case of what ‚Äúrole‚Äù, what to do.  These crutch solutions work in principle, but they are extremely unsatisfied.  Armed with search and common sense, it was decided to create a small, lightweight c ++ utility that I would like to share with the community. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Access configuration </h4><br>  After analyzing in detail the zend and the ideology of access lists, it was clear that the requirements for the utility are very simple - it must get a list of rights and, depending on the situation, whether access to one or another resource is allowed, in addition, since this configuration file can edit system administrators - they should be easy to navigate what's what.  From these considerations, the choice was made in the direction of the usual configuration ini file.  Example: <br><br> <code>[guest]</code> <br> <code>view:news</code> <br> <code>view:comments</code> <br> <br>  Where <b>[guest]</b> is the user role, and <b>view: news</b> and <b>view: comments</b> are the corresponding resources.  Many may wonder why, let's say a resource is called not comments: view, but vice versa view: comments - the answer is simple, if you conditionally divide the resources according to the CRUD database, you will understand that there are not so many options you can think of, and you can visually see the roles accordingly. to divide who is looking, who is updating, etc. Moreover, in such a format it becomes possible to do so: <br><br> <code>[guest]</code> <br> <code>view:*</code> <br> <br>  Which in turn means guests are allowed to watch everything. <br>  Simple, isn't it? <br><br>  The attentive reader, obviously, has already managed to notice that in the name of the resource there is a colon character.  This is a conditional mandatory separator with which you can do such things: <br><br> <code>[moderator]</code> <br> <code>edit:*:comments</code> <br> <br> <code># </code> <br> <code>edit:news:comments</code> <br> <code>edit:wall:comments</code> <br> <br>  The utility does not impose a grouping of resources and you can group as you see fit and as best suits your project.  But the presence of a colon between subgroups makes it more logical to separate the constituent parts of the resource. <br><br>  Simple resolution is not interesting, obviously we can and deny access to individual resources: <br><br> <code>[user]</code> <br> <code>view:news:28 = deny</code> <br> <br>  By this rule we prohibited the user to view the news with ID 28 <br>  To describe the rules for each individual role is very tedious, so there is a mechanism for inheritance: <br><br> <code>[user : guest]</code> <br> <br>  In this case, the role of <b>user</b> , besides its rules, will also contain rules from the role <b>guest</b> <br><br>  An additional feature in my opinion is the ability in the configuration to describe the case when the user can edit his comments.  That is, only those directly created by him.  To do this, use the symbol <b>^</b> <br><br>  For example: <br><br> <code>[user]</code> <br> <code>edit:comment:^</code> <br> <br>  I think it is now clearer to see why the colon is used forcibly divided into subgroups, because in this case, the comment ID will be substituted for <b>^</b> . <br><br><h4>  How it works </h4><br>  As mentioned above, this is a utility.  Accordingly, after its successful compilation can be performed in the console: <br><br> <code>./x-acl --config x-acl.conf --group guest --resource view:news</code> <br> <br>  We ask whether the guest user has access to the resource view: news <br><br> <code>./x-acl --config x-acl.conf --group user --resource edit:comment:28 \</code> <br> <code>--user-id 4 --owner-id 4</code> <br> <br>  We ask whether the user role has access to the edit: comment: 28 resource; if anyone has forgotten, we set the edit rule: comment: ^, - in this case, there is a ^ symbol, so the user-id and owner-id arguments are checked for equality and if they equal (and they are equal in this example) - access will be allowed. <br><br><h4>  Where can I download and play </h4><br>  <a href="https://github.com/AlexeyParhomenko/x-acl">github.com/AlexeyParhomenko/x-acl</a> <br><br><h4>  List of suspected questions :) </h4><br><h5>  - Why reinvent the wheel if there are ready-made tools? </h5><br>  The author is familiar with some.  Create a new tool prompted: <br>  1. Make acl more flexible for our needs; <br>  2. Raise the profit on memory consumption, since in this case, unlike php, there is no creation of bulky Zval structures; <br>  3. Raise profit in speed.  While we are testing, but if it turns out to be a parsing config file every time, we will be able to switch to a socket solution; <br><br><h5>  - Do you plan further support and fix bugs? </h5><br>  Naturally. <br><br><h5>  - For which OS does it work? </h5><br>  Debian is used on our servers, as the author does in the form of a working environment, so I‚Äôll say for sure that it works perfectly on debian.  On other * nix distributions should also work stably. <br><br>  Comments are very welcome, as I would like to understand how useful this tool can be in the future.  Or, if I was looking badly and the already described functionality is available - send it to Google! <br><br>  I will be glad to hear the errors / inaccuracies in the text or the source code in a personal, or, perhaps, any further wishes. </div><p>Source: <a href="https://habr.com/ru/post/155099/">https://habr.com/ru/post/155099/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../155083/index.html">Updated Windows Azure Mobile Services: iOS support and more</a></li>
<li><a href="../155085/index.html">Color theory</a></li>
<li><a href="../155087/index.html">October Ciklum .NET Saturday in Kiev</a></li>
<li><a href="../155089/index.html">EPAM Systems Becomes AWS Official Partner</a></li>
<li><a href="../155097/index.html">We select the video card for miniITX-system</a></li>
<li><a href="../155101/index.html">What do users think about paperless technology</a></li>
<li><a href="../155103/index.html">The new infrastructure of the Pirate Bay: still indestructible and elusive</a></li>
<li><a href="../155105/index.html">Restore base 1C using HEX editor</a></li>
<li><a href="../155107/index.html">JQuery tutorial for beginners</a></li>
<li><a href="../155109/index.html">Page Object Model + Webdriver. An example of implementation on a single test</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>