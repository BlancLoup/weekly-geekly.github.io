<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>It's time. Upgrade to Oracle Database 12</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Why is it time? 
 Time flies fast, and for Oracle Database 11.2 users, not to mention earlier versions, it is time to upgrade. January 31, 2015, the O...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>It's time. Upgrade to Oracle Database 12</h1><div class="post__text post__text-html js-mediator-article"><h1>  <font color="#ff0000">Why is it time?</font> </h1><br>  Time flies fast, and for Oracle Database 11.2 users, not to mention earlier versions, it is time to upgrade.  January 31, 2015, the Oracle Database 11.2 Premier Support period ended.  This means that if you, for example, schedule a hardware server update, then you will have to install a new version of the operating system on it, because  drivers for the previous version are no longer available, and the new operating system is no longer certified for version 11.2. <br><br> <a href="http://habrahabr.ru/company/oracle/blog/268089/"><img src="https://habrastorage.org/files/f52/662/b73/f52662b732644567be08a45458db7942.png"></a> <a name="habracut"></a><br><br>  Detailed information about support for various versions of the Oracle Database can be found in the official Oracle Lifetime Support Policy document.  For example, the extended support for version 11.1 has just ended (fig. 1).  As for the most popular today version 11.2 - for it the first year of extended support now ends, and from January of next year a gradual increase in the cost of technical support will begin, first by 10%, in subsequent years by 20%, and this is another economic incentive for enterprises to think about upgrading to version 12c. <br><img src="https://habrastorage.org/files/aeb/648/869/aeb6488698bd4d4b91acacc8172befbd.png"><br>  In preparing for the transition to the new version of the database, it is important to understand the difference between the terms ‚Äúupdate‚Äù and ‚Äúmigration‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Upgrading</b> a database is a transition to a new version within the framework of the previous operating environment ‚Äî the platform and the operating system do not change, the data does not ‚Äúmove‚Äù from one server to another, only the database version changes.  The actual update is in the procedure for updating the dictionary and the Oracle metadata, the data itself does not change or move.  In this case, the size of the database does not matter and does not affect the update rate, only the number of objects in the database matters.  That is, everything is clear with the update, only the database version changes, in this case, we upgrade to the database version 12, but the platform and the operating system do not change. <br><br>  It is important which version of Oracle Database is upgraded to version 12c from.  Starting from version 10, Data Pump technology is available.  For upgrading from old versions there is a process consisting of export and subsequent data import, which requires additional disk space.  This method is often used for small databases.  Oracle recommends using a special upgrade tool called the Oracle Database Upgrade Assistant, which comes free with the Oracle Database distribution kit, its applicability to different database versions is shown in the diagram in Figure.  2. Starting from version 12, the manual update option is also available, which is provided as a special Perl script. <br><br>  You can minimize downtime during the upgrade if you use the additional feature that appeared in the Recovery Manager utility ‚Äî transfer files to the database using transportable table spaces, and then apply incremental copies of the Recovery Manager.  This technology is called RMAN incremental backup recovery.  If idle time is unacceptable, you need to use a special tool that provides an on-the-fly update called Golden Gate - but this is the most expensive way in terms of software licensing, preparing and adapting replication mechanisms. <br><img src="https://habrastorage.org/files/af5/594/a83/af5594a83b434611965d1a67b283cf04.png"><br>  <b>Migration (migration)</b> is a transition to a new operating environment ‚Äî to a new server, to a new operating system.  And in this case, of course, the physical size of the database is of paramount importance.  Often, the update and migration tasks are performed jointly, that is, for example, they simultaneously switch to a new version of the Oracle Database and at the same time change the equipment. <br><br>  The most reliable way to migrate the database of the migration database is the good old export-import.  Since the export file does not depend on the platform, you can upload the old version from the database on one software and hardware platform, and import the new version into the database on another software and hardware platform.  Starting from version 10.2, tablespace transportation technology is available.  The RMAN technology incremental backup recovery is applicable, unfortunately, not for all software and hardware platforms.  If zero downtime is needed, you can use Golden Gate technology. <br><br>  You can learn more about the ways to upgrade and migrate from the documents listed at the end of the article. <br><br><h1>  <font color="#ff0000">Patches and certification</font> </h1><br>  If during the transition to the new version of the database, you change the hardware and operating system, you need to figure out whether this software and hardware platform is certified to the version of Oracle Database 12c.  Please read the information on the certification of software and hardware platforms listed on the technical support site support.oracle.com (‚ÄúCertification‚Äù tab).  On where to look for distributions, we will not stop here - it is important not to forget to get all the latest service packs.  Oracle releases quarterly large cumulative update packages that fix major bugs.  The recommended patches for version 12.1.0.2 are currently PSU Update 4 and OJVM PSU Update 4 (Oracle Java Virtual Machine update, Java embedded machine). <br><br>  If you are currently using version 11.2.0.3 or 11.2.0.4, and have already installed certain patches to eliminate certain errors, you should make sure that these errors are fixed in version 12. Most likely, this is true, but, nevertheless, it is recommended by the patch number For version 11, check whether the specific error in the cumulative update of version 12 has been fixed, and if not, get the appropriate patch to fix this error.  If such a patch has not yet been released, you need to make an appropriate request to the technical support service for your software and hardware platform. <br><br>  Starting with version 12.1.0.2, Oracle releases a special patch called the Oracle Database In-Memory patch of Exadata Engineering System.  It includes an update to the Oracle Database In-Memory technology and, despite its name, is suitable not only for Exadata, but also for regular distributions, and which is recommended to install if you use Oracle Database In-Memory technology. <br><br>  An important update concerns the features of time measurement in Russia - this is due to the fact that, as you remember, with us, the principle of calculating time in time zones was changed twice at intervals of several years.  Therefore, it is very important to install special Time Zone updates that take this situation into account for Russian time zones.  If you actively use stored procedures in Java and Java variables of type Date and Time with time zones, you will need a special patch to correct the time in time zones for the Java virtual machine. <br><br>  Do not forget to update the OPatch utility in order to install a new update.  In Oracle Database 12, a new package, DMBS_QOPatch, has been added. <br><br><h1>  <font color="#ff0000">Preparing the source database</font> </h1><br>  Before you begin the upgrade, you need to prepare the source database.  The ‚Äúchecklist‚Äù of such preparation is shown in fig.  3 <br><img src="https://habrastorage.org/files/39a/563/cf3/39a563cf3f0046f8be0d159821af9af0.png"><br>  <b>Empty trash can before upgrading.</b>  Starting with Oracle 12c, it is executed using the preupgrade_fixups.sql script.  It is recommended to clean the trash bin at least once a week using an automatic task in the period of minimum load on the database. <br><br>  <b>Check for erroneous objects.</b>  There should be no error objects in the SYS and SYSTEM schemes.  To perform such a check, you need to try to compile objects that are in the ‚ÄúInvalid‚Äù state before updating or migrating using the utlrp.sql script.  If this does not help, you can not proceed with the upgrade.  It is worth checking whether there are <b>objects with the same name</b> in the SYS and SYSTEM schemes, this can be done with the following query: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> OBJECT_NAME, OBJECT_TYPE <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> DBA_OBJECTS <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> (OBJECT_NAME,OBJECT_TYPE) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> OBJECT_NAME, OBJECT_TYPE <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> DBA_OBJECTS <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> OWNER=<span class="hljs-keyword"><span class="hljs-keyword">SYS</span></span><span class="hljs-string"><span class="hljs-string">') and OWNER='</span></span><span class="hljs-keyword"><span class="hljs-keyword">SYSTEM</span></span><span class="hljs-string"><span class="hljs-string">' and OBJECT_NAME not in ('</span></span>AQ$_SCHEDULES_PRIMARY<span class="hljs-string"><span class="hljs-string">', '</span></span>AQ$_SCHEDULES<span class="hljs-string"><span class="hljs-string">','</span></span>DBMS_REPCAT_AUTH<span class="hljs-string"><span class="hljs-string">');</span></span></code> </pre> <br>  Also remove <b>all outdated and undocumented parameters</b> , including events.  If you work with large, complex applications, such as ERP SAP or Oracle EBS, be sure to read the attached database update documentation for such applications.  There is an example of updating the database of the Oracle company itself - when all undocumented parameters were deleted, the update rate increased sevenfold. <br><br>  There is an excellent utility Health Check - this is a script that allows you to check the integrity of the dictionary.  This script checks known issues in Oracle8i, Oracle9i, Oracle 10g, and Oracle 11g.  For better performance, it can run in several parallel channels or only for individual data files or table spaces.  Health Check is performed on a database and displays information on all components in the SQL + console.  If a dictionary inconsistency is detected, the script will output this information, and you will have to solve this problem before updating, because the dictionary must be in a consistent state.  You can download the utility from the technical support site. <br><br>  Also in version 12, a new special Pre-Upgrade preupgrd.sql script appeared.  It performs checks before upgrading, runs in the old version database and performs checks on the old database environment for the transition to version 12. If any inconsistencies are found, two special scripts are formed: preupgrade_fixups.sql and postupgrade_fixups.sql. <br><br>  To increase the update rate, it is recommended to have up-to-date statistics ‚Äî first of all, statistics on Oracle DBMS metadata.  Dictionary statistics is collected by calling the package DBMS_STATS, GATHER_DICTIONARY_STATS.  Relevant statistics can be considered as collected no more than a day before the update. <br><br><h1>  <font color="#ff0000">Database update</font> </h1><br>  Now we can proceed to the update procedure itself.  The duration of the upgrade to Oracle Database 12c mainly depends on the number of components, options, and objects in the database ‚Äî since, in version 12, many new tables appeared and the structure of the base tables was reorganized.  To a lesser extent, the duration of the update depends on the system performance, i.e.  frequency and number of central processing units and speeds of input-output subsystems.  In version 12, the dictionary is updated in parallel mode - by default, in four threads.  Unfortunately, the maximum degree of parallelism is limited to 8 - i.e.  You can create a maximum of eight threads, since the dictionary has a maximum of eight independent components that can be updated in parallel.  Perhaps in future versions the degree of concurrency will be increased.  However, already now the documentation promises a 40% increase in the speed of updating the dictionary, and customer experience shows that a higher speed is possible. <br><br>  Simplifies upgrading to Oracle Database 12c Database Upgrade Assistant administration tool, which is included in the Oracle DBMS distribution kit and does not require additional licensing.  You can call it through the Enterprise Manager Cloud Control common console, which is convenient if you need to carry out a massive update of databases of the same type of configuration.  If you need to update a clustered database, you can use the Enterprise Manager Cloud Control console. <br><br><h1>  <font color="#ff0000">Completion of the update</font> </h1><br>  To perform a set of steps to complete the upgrade, you should use a special script called utlu121s.sql, or the Database Upgrade Assistant utility.  The script displays a list of database components - the status of each component status must be VALID, otherwise the update failed.  Separately, you should check the result of installing special Time Zone updates - binary patches for defining time zones and a special script that makes changes to the dictionary. <br><img src="https://habrastorage.org/files/87a/377/f99/87a377f99fa54512ac5cfaeb09565323.png"><br>  In fig.  4 is a checklist for checking the performance of an updated database.  You can use the technology Real Application Testing, which allows you to record the load on the database of the old version, play it on the database of the new version and compare performance. <br><br>  If you use the automatic degree of parallelism, then the required step is the input-output calibration, i.e.  speed and throughput.  For Exadata, the calibration and collection of system statistics is performed by a special call to DBMS_STATS.GATHER_SYSTEM_STATS, since there is a specific input-output system. <br><br><h1>  <font color="#ff0000">What to read?</font> </h1><br>  Before you begin the update process, you should at least familiarize yourself with the documentation that is available from the technical support site support.oracle.com.  The main document you need is called Upgrade Companion 12c - this is an addition to the Oracle Database version upgrade documentation, available from docs.oracle.com.  If you have not registered on the Oracle Technology Network portal at otn.oracle.com, do it - you will find a lot of useful information at otn.oracle.com/upgrade. <br><br>  Separately, we recommend the blogs.oracle.com/UPGRADE page - this is the blog of Mike Dietrich, a leading Oracle database updating specialist.  On the page there is a link to Michael's presentation on updating databases - this is a comprehensive document that currently contains more than 600 slides. </div><p>Source: <a href="https://habr.com/ru/post/268089/">https://habr.com/ru/post/268089/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268073/index.html">Recommended system on .Net or first steps with MyMediaLite</a></li>
<li><a href="../268077/index.html">Project Fi - what can its subscribers get?</a></li>
<li><a href="../268079/index.html">Playgrounds for browser games</a></li>
<li><a href="../268081/index.html">Diagnosing the behavior of "cumulative" (rollup) fields in Microsoft Dynamics CRM 2015</a></li>
<li><a href="../268087/index.html">Critical vulnerabilities discovered in TrueCrypt cryptograph</a></li>
<li><a href="../268091/index.html">We write Policy server on C ++ for Unity3d</a></li>
<li><a href="../268093/index.html">Unbearable server burden: to the issue of transition to the IaaS model</a></li>
<li><a href="../268095/index.html">Two types of applications for Bitrix24</a></li>
<li><a href="../268097/index.html">Meet HP IT Outsourcing</a></li>
<li><a href="../268101/index.html">New vulnerabilities discovered in Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>