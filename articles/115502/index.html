<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Copying objects using ByteArray</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Copying simple objects 
 Most often, ByteArray is used to copy objects. AMF serializer and deserializer (I don‚Äôt like these words, but didn‚Äôt find a s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Copying objects using ByteArray</h1><div class="post__text post__text-html js-mediator-article"><h4>  Copying simple objects </h4><br>  Most often, <b>ByteArray is</b> used to copy objects.  <b>AMF</b> serializer and deserializer (I don‚Äôt like these words, but didn‚Äôt find a suitable translation) is available via the <b>ByteArray API</b> .  To duplicate objects using <b>ByteArray,</b> we will use the <b>writeObject</b> and <b>readObject methods</b> : <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   ByteArray var stream:ByteArray = new ByteArray(); //   var parameters:Object = { age : 25, name : "Bob" }; // ¬´¬ª    AMF     ByteArray stream.writeObject( parameters ); //   stream.position = 0; //   var objectCopy:Object = stream.readObject();</span></span></code> </pre> <br><a name="habracut"></a><br>  Based on this code, you can create a function that we can use to copy objects: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copyObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">objectToCopy:*</span></span></span><span class="hljs-function">):* </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stream:ByteArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ByteArray(); stream.writeObject( objectToCopy ); stream.position = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stream.readObject(); }</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To make sure that we really created a separate copy of the object, we can modify the properties of the original object: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   var parameters:Object = { age : 25, name : "Bob" }; var parametersCopy:Object = copyObject ( parameters ); parameters.nom = "Stevie"; /* outputs : name : Bob age : 25 */ for ( var p:String in parametersCopy ) { trace( p, " : ", parametersCopy[p] ); } function copyObject ( objectToCopy:* ):* { var stream:ByteArray = new ByteArray(); stream.writeObject( objectToCopy ); stream.position = 0; return stream.readObject(); }</span></span></code> </pre> <br><br>  Below, we will learn how to save and restore more complex data types using <b>ByteArray</b> . <br><br><h4>  Copy custom classes </h4><br>  The code described earlier will not work for custom classes that you can use in your application.  Let's analyze a very simple example, let's say you need to use objects of the <b>User</b> class: <br><br><pre> <code class="javascript hljs">package { public <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ private <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _firstName:<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>; private <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _lastName:<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>; public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstName</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">firstName:String</span></span></span><span class="hljs-function">):</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ _firstName = firstName; } public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lastName</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">lastName:String</span></span></span><span class="hljs-function">):</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ _lastName = lastName; } public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">firstName</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>):</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">String</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _firstName; } public <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lastName</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>):</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">String</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _lastName; } } }</code> </pre> <br><br>  You may need to save a <b>User</b> object on the server as binary data or locally in <b>SharedObject</b> .  If you try to save a <b>User</b> object in <b>ByteArray</b> and retrieve it, then while reading <b>Flash Player</b> will check if <b>User has</b> been registered before, if not, this object will be ‚Äúparsed‚Äù as a normal object: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    User var myUser:User = new User (); //   myUser.firstName = "Stevie"; myUser.lastName = "Wonder"; // outputs :[object User] trace ( myUser ); //  ByteArray    var bytes:ByteArray = new ByteArray(); //   bytes.writeObject ( myUser ); //   bytes.position = 0; // outputs : false trace ( bytes.readObject() is User );</span></span></code> </pre> <br><br>  To register the <b>User</b> type in <b>Flash Player,</b> you can use the <b>registerClassAlias</b> method.  After this, objects of the <b>User</b> class can be ‚Äúparsed‚Äù using <b>ByteArray</b> . <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    User var myUser:User = new User (); //   myUser.firstName = "Stevie"; myUser.lastName = "Wonder"; // outputs :[object User] trace ( myUser ); //   User  ¬´¬ª registerClassAlias ( "userTypeAlias", User ); //  ByteArray    var bytes:ByteArray = new ByteArray(); //   bytes.writeObject ( myUser ); //   bytes.position = 0; //  ¬´¬ª  ,      var storedUser:User = bytes.readObject() as User; // outputs : true trace ( storedUser is User ); // outputs : Stevie Wonder trace ( storedUser.firstName, storedUser.lastName );</span></span></code> </pre> <br><br>  Using this technique, we can save and restore instances of any user-defined classes.  As you can see, we are now working with a copy of a custom class object: <br><br><pre> <code class="javascript hljs">storedUser.firstName = <span class="hljs-string"><span class="hljs-string">"Bobby"</span></span>; storedUser.lastName = <span class="hljs-string"><span class="hljs-string">"Womack"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// outputs : Stevie Wonder trace ( myUser.firstName, myUser.lastName ); // outputs : Bobby Womack trace ( storedUser.firstName, storedUser.lastName );</span></span></code> </pre> <br><br>  It must be remembered that some native data types cannot be serialized / deserialized using <b>AMF</b> .  This applies to such visual objects, such as <b>DisplayObject</b> .  For example, if you try to ‚Äúparse‚Äù a <b>MovieClip</b> instance (if it could be done, it would be very cool =), then you will fail: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  ByteArray var bytes:ByteArray = new ByteArray(); //    DisplayObject bytes.writeObject ( new MovieClip() ); //   bytes.position = 0; // outputs : undefined trace ( bytes.readObject() );</span></span></code> </pre> <br><br>  The support of visual objects in <b>AMF3</b> would be a very useful addition to the list of types supported in <b>AMF</b> . <br><br><h4>  From translator </h4><br>  I like to ‚Äúpack‚Äù all frequently used functions into separate classes with static functions and this case with copying objects was no exception =) For this, I created a small class and tried to save some of my class in the manner described, in a small experiment I came across a small nuance , which is not described in the original article: if the class constructor of the type you need requires the transfer of required parameters, then when you ‚Äúrestore‚Äù the object, an error will occur due to the fact that the constructor did not have  The required data has been transferred.  Fortunately, this problem does not occur if the designer requires the transfer of parameters, but they are not mandatory. <br><br>  By the way, in my example, I tried to copy Array and Vector., And I did it all).  I often need to save / read data in <b>SharedObject</b> , so I think that this method of parsing and copying complex classes will be very, very useful to me. <br><br>  <a href="">Sample Source</a> </div><p>Source: <a href="https://habr.com/ru/post/115502/">https://habr.com/ru/post/115502/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../115491/index.html">Startup Visa terms are simplified.</a></li>
<li><a href="../115492/index.html">Orange San Francisco - Not a budget android phone for ¬£ 99</a></li>
<li><a href="../115493/index.html">HowTo: Cacti 0.8.7g + Plugin Architecture 2.9 + Spine 0.8.7g on CentOS 5.5 i386</a></li>
<li><a href="../115494/index.html">Microsoft stops the development of the line of players Zune</a></li>
<li><a href="../115501/index.html">IRF - factory scaling technology</a></li>
<li><a href="../115505/index.html">Overview of Virtual Business Cards Service - IdentyMe</a></li>
<li><a href="../115507/index.html">The Internet in Japan turned out to be amazingly tenacious</a></li>
<li><a href="../115508/index.html">First KDE Indian Conference</a></li>
<li><a href="../115509/index.html">New build Opera - linear gradients, WebP, declarative UI</a></li>
<li><a href="../115510/index.html">What type of hosting for ASP.NET applications do you use?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>