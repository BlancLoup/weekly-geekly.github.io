<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Linux basics from the founder of Gentoo. Part 3 (3/4): Linux Account Management</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuation of the third part of a series of Linux tutorials for beginners. Fundamentals of user and group management. 
  
 Navigating Linux basics f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Linux basics from the founder of Gentoo. Part 3 (3/4): Linux Account Management</h1><div class="post__text post__text-html js-mediator-article">  Continuation of the third part of a series of Linux tutorials for beginners.  Fundamentals of user and group management. <br><blockquote> <a href="http://www.gnu.org/graphics/3dbabygnutux.html"><img src="https://habrastorage.org/storage/habraeffect/e0/d8/e0d82146fe87b40c693a8662cf7637ae.png" align="right"></a> <br><h5>  <b>Navigating Linux basics from the founder of Gentoo:</b> <br></h5><br><h6>  Part I: </h6><ol><li>  <a href="http://habrahabr.ru/blogs/linux/99041/" title="BASH: Basics of Navigation (Intro)">BASH, navigation basics</a> </li><li>  <a href="http://habrahabr.ru/blogs/linux/99291/" title="File and Directory Management">File and Directory Management</a> </li><li>  <a href="http://habrahabr.ru/blogs/linux/99653/" title="Links, and deleting files and directories">Links, and deleting files and directories</a> </li><li>  <a href="http://habrahabr.ru/blogs/linux/99827/" title="Glob-substitutions (totals and links)">Glob substitutions</a> </li></ol><a name="habracut"></a><h6>  Part II: </h6><ol><li>  <a href="http://habrahabr.ru/blogs/linux/102442/" title="Regular Expressions (Intro)">Regular expressions</a> </li><li>  <a href="http://habrahabr.ru/blogs/linux/105495/" title="Folder Assignments, File Search">Folder Assignments, File Search</a> </li><li>  <a href="http://habrahabr.ru/blogs/linux/105657/" title="Process management">Process management</a> </li><li>  <a href="http://habrahabr.ru/blogs/linux/105926/" title="Text processing and redirection">Text processing and redirection</a> </li><li>  <a href="http://habrahabr.ru/blogs/linux/107981/" title="Kernel modules (totals and links)">Kernel modules</a> </li></ol><h6>  Part III </h6><ol><li>  <a href="http://habrahabr.ru/blogs/linux/108764/" title="Documentation">Documentation</a> </li><li>  <a href="http://habrahabr.ru/blogs/linux/109392/">Access rights model</a> </li><li>  <b>Account Management</b> </li><li>  Setting up the environment </li></ol></blockquote><br><h2>  Linux Account Management </h2><br><h3>  Meet / etc / passwd </h3><br>  In this section, we will introduce the Linux account management mechanism and begin with the <i>/ etc / passwd file</i> , which identifies all users that exist in the system.  You can view your <i>/ etc / passwd file</i> by typing <i>less / etc / passwd</i> .  Each line in <i>/ etc / passwd</i> defines a user account.  Here is an example from my <i>/ etc / passwd</i> : <br><br> <code>drobbins:x:1000:1000:Daniel Robbins:/home/drobbins:/bin/bash <br></code> <br>  As you can see, there is not much information in one line.  Each of them contains several fields separated by ":".  The first field is responsible for the user name (drobbins), the second field contains ‚Äúx‚Äù.  On legacy Linux systems, the second field contained an encrypted password for authentication, but in fact, now all Linux systems store this information in a different file.  The third field is responsible for the numeric user identifier associated with a particular user, and the fourth field associates that user with a specific group;  soon we will see where the group 1000 is defined. The fifth field contains the text description of the account, in our case this is the username.  The sixth field specifies the user's home directory, the seventh sets the starting shell of the user, which will automatically start when the user logs on. <br><br><h3>  / etc / passwd tips and tricks </h3><br>  You probably noticed that the system has many more user accounts, which are defined in / etc / passwd, than those that actually log in to the system.  All this is because the various components of Linux use some accounts to increase security.  Typically, such system accounts have an identifier (uid) less than 100, and many of them have / bin / false as the starting shell.  Since this program does nothing except for exiting and returning an error code, this effectively prevents the use of these accounts as regular accounts for a login ‚Äî that is,  they are intended for internal use only. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  / etc / shadow </h3><br>  So, the user accounts themselves are defined in <i>/ etc / passwd</i> .  Linux systems, in addition to <i>/ etc / passwd,</i> contain its companion file <i>/ etc / shadow</i> .  It, unlike <i>/ etc / passwd</i> , is readable only to the superuser and contains encrypted password information.  Take a look at the sample line from <i>/ etc / shadow</i> : <br><br> <code>drobbins:$1$1234567890123456789012345678901:11664:0:-1:-1:-1:-1:0 <br></code> <br>  Each line defines information about the password for a particular account, the fields in it are separated by the ":" sign.  The first field identifies the specific user account to which this ‚Äúshadow‚Äù entry corresponds.  The second field contains the encrypted password.  The remaining fields are described in the table below: <br><br>  field 3 - the number of days from 01/01/1970 to the time when the password was changed <br>  field 4 - the number of days before it will be allowed to change the password ("0" - "change at any time") <br>  field 5 - the number of days before the system forces the user to change the password ("-1" - "never") <br>  field 6 - the number of days until the expiration of the password, when the user receives a warning about this ("-1" - "not to warn") <br>  field 7 - the number of days after the expiration of the password, after which the account will be automatically disabled by the system ("-1" - "do not disable") <br>  field 8 - the number of days elapsed since the disconnection of this account ("-1" - "this account is enabled") <br>  field 9 - reserved for future use <br><br><h3>  / etc / group </h3><br>  Now take a look at the <i>/ etc / group</i> file, which defines groups on a Linux system.  Here is an approximate line of it: <br><br> <code>drobbins:x:1000: <br></code> <br>  The format of the <i>/ etc / group</i> file fields is as follows: the first field defines the name of the group, the second field is the residual password field, which is now simply reserved x, and the third field defines the numeric identifier for a specific group.  The fourth field (which is empty in the example above) defines all members of the group. <br><br>  Recall that in our sample line from <i>/ etc / passwd</i> there is a ‚Äúlink‚Äù to the group with ID 1000. We can place the user drobbins into the group drobbins, even though there is no drobbins name in the fourth / etc / group field. <br><br><h3>  Group notes </h3><br>  Note about matching users with groups: on some systems, each new login account is associated with a group having the same name (and usually an identifier).  On other systems, all login accounts will belong to the same user group.  Which of these methods to choose depends on you.  Creating an appropriate group for each user has the advantage of allowing them to more easily control their own access by simply placing trusted friends in their personal group. <br><br><h3>  Manual creation of users and groups </h3><br>  Now, I will show you how to create accounts for a user and a group.  The best way to learn how to do this is to add a new user to the system manually.  First, make sure your favorite editor's EDITOR environment variable matches: <br><br> <code># <b>echo $EDITOR</b> <br> vim <br></code> <br>  If this is not the case, then you can set the EDITOR variable by typing something like: <br><br> <code># <b>export EDITOR=/usr/bin/emacs</b> <br> # <b>vipw</b> <br></code> <br>  Now your editor should be launched with the / etc / passwd screen already loaded.  When changing the system passwd and group files, be sure to use the vipw and vigr commands.  They have heightened precautions, protecting your files from being corrupted. <br><br><h3>  Editing / etc / passwd </h3><br>  So, you already have a ready / etc / passwd file, now add the following line: <br><br> <code>testuser:x:3000:3000:LPI tutorial test user:/home/testuser:/bin/false <br></code> <br>  We have just added the user ‚Äútestuser‚Äù with ID 3000. We have defined him in a group with the same ID that we have not yet created.  But we can add it to an existing user group, if needed.  This user has a comment that says "LPI tutorial test user", the home directory is set to "/ home / testuser", and the command shell is set to "/ bin / false", for security reasons.  If we didn‚Äôt create a test account, we‚Äôd set the shell to "/ bin / bash".  Great, now save the file and exit. <br><br><h3>  Editing / etc / shadow </h3><br>  Now we need to add an entry in <i>/ etc / shadow</i> for this user.  To do this, type <i>vipw -s</i> .  As always, your favorite editor will meet you in which the file <i>/ etc / shadow is</i> already open.  Now copy the line of the existing user account (the one that has the password and the entry is longer than the standard system account entries) <br><br> <code>drobbins:$1$1234567890123456789012345678901:11664:0:-1:-1:-1:-1:0 <br></code> <br>  Replace the username in the copied line with the name of your user and make sure that all the fields (especially the old password) are set as you need: <br><br> <code>testuser:$1$1234567890123456789012345678901:11664:0:-1:-1:-1:-1:0 <br></code> <br>  Now save and close. <br><br><h3>  Password setting </h3><br>  You will be returned to the command line.  Now, it's time to set a password for your new user. <br><br> <code># <b>passwd testuser</b> <br> Enter new UNIX password: (enter a password for testuser) <br> Retype new UNIX password: (enter testuser's new password again) <br></code> <br><h3>  Editing / etc / group </h3><br>  Now <i>/ etc / passwd</i> and <i>/ etc / shadow</i> are ready and it's time to configure <i>/ etc / group</i> .  To do this, type: <br><br> <code># <b>vigr</b> <br></code> <br>  You will see your <i>/ etc / group</i> file ready for editing.  So, if you previously decided to add the created user to an existing group, then you do not need to create a new group in <i>/ etc / groups</i> .  If this is not the case, you need to add a new group for this user, enter the following line: <br><br> <code>testuser:x:3000: <br></code> <br>  Now save and close. <br><br><h3>  Creating a home directory </h3><br>  We are almost done.  Run the following commands to create a testuser home directory: <br><br> <code># <b>cd /home</b> <br> # <b>mkdir testuser</b> <br> # <b>chown testuser:testuser testuser</b> <br> # <b>chmod o-rwx testuser</b> <br></code> <br>  Our user directory is in place and your account is ready to use.  Already almost done.  If you are going to use this account, you will need to use vipw to change the starting shell to <i>/ bin / bash</i> , so that the user can log in. <br><br><h3>  Account Administration Utilities </h3><br>  You already know how to manually add new accounts and groups, now let's consider various time-saving utilities for managing accounts under Linux.  Due to some limitations, we will not consider many details describing these commands.  Remember - you can always get more information about a team if you look at its man page.  If you are planning to take the LPIC 101 exam, you should spend more time getting to know each of these teams. <br><br>  newgrp - By default, any file that the user creates is immediately assigned to the group in which it is composed, as defined in <i>/ etc / passwd</i> .  If the user belongs to other groups, he or she can type newgrp thisgroup to become a member of thisgroup group.  Then, any new files created will inherit the membership of thisgroup. <br>  <i>chage</i> - The chage command is used to view and change the expiration settings for passwords stored in / etc / shadow. <br>  <i>gpasswd</i> - Main group management utility <br>  groupadd / groupdel / groupmod - Used to add / remove / modify groups in / etc / group <br>  <i>useradd / userdel / usermod</i> - Used to add / remove / change users in <i>/ etc / passwd</i> .  These commands can perform other useful functions.  See the man for more information. <br>  <i>pwconv / grpconv</i> - Used to convert old-style <i>passwd</i> and <i>group</i> files into new shadow passwords.  In fact, all Linux systems already use shadow passwords, so you never have to use these commands. <br><br>  The translation was performed by collective intelligence using <a href="http://notabenoid.com/">notabenoid.com</a> .  Thanks to the following benoid-users (in alphabetical order): <b>kindacute</b> , <b>nekjine</b> , <b>Rich</b> .  As well as the initiator of the entire translation series, <a href="https://habrahabr.ru/users/vbart/" class="user_link">VBart</a> . <br><br>  <b>To be continued...</b> <br><hr><br><h2>  About the authors </h2><br><h3>  Daniel Robbins <img src="http://www.funtoo.org/img/misc/faceshot.jpg" align="left"></h3><br>  Daniel Robbins is the founder of the Gentoo community and the creator of the Gentoo Linux operating system.  Daniel lives in New Mexico with his wife, Mary, and two energetic daughters.  He is also the founder and head of <a href="http://www.funtoo.org/">Funtoo</a> , has written many technical articles for <a href="http://www.ibm.com/developerworks/">IBM developerWorks</a> , Intel Developer Services and the C / C ++ Users Journal. <br><br><h3>  Chris Houser </h3><br>  Chris Hauser was a UNIX supporter since 1994 when he joined the team of administrators at Taylor University (Indiana, USA), where he received a bachelor's degree in computer science and mathematics.  After that, he worked in many areas, including web applications, video editing, drivers for UNIX, and cryptographic protection.  Currently working in Sentry Data Systems.  Chris also contributed to many free projects, such as Gentoo Linux and Clojure, co-authored <a href="http://joyofclojure.com/">The Joy of Clojure</a> . <br><br><h3>  Aron griffis </h3><br>  Airon Griffis lives in Boston, where he spent the last decade working with Hewlett-Packard on projects such as UNIX network drivers for Tru64, Linux security certification, Xen and KVM virtualization, and most recently, the <a href="http://hpeprint.com/">HP ePrint</a> platform.  In his spare time, Airon prefers to ponder over the problems of programming while riding his bike, juggling with bats, or cheering for the Boston professional Red Sox baseball team. </div><p>Source: <a href="https://habr.com/ru/post/110012/">https://habr.com/ru/post/110012/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../110004/index.html">Normal Markov algorithm for dividing numbers</a></li>
<li><a href="../110005/index.html">I2Competition - competition of ideas for web-projects and mobile applications</a></li>
<li><a href="../110006/index.html">Leonid Kaganov visiting Materialize</a></li>
<li><a href="../110008/index.html">Modify the MotoCMS template beyond recognition. 10 easy steps</a></li>
<li><a href="../110009/index.html">Beeline news on Android</a></li>
<li><a href="../110013/index.html">About Freemium Monetization Model</a></li>
<li><a href="../110014/index.html">Droider Chart. Release 31</a></li>
<li><a href="../110015/index.html">Anonymous launched an attack on fax machines</a></li>
<li><a href="../110016/index.html">Started Android 2.2 update for HTC Legend smartphones</a></li>
<li><a href="../110018/index.html">Choppers and cars from computer trash</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>