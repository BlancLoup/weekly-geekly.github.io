<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DOM MutationObserver - reacting to a change in DOM without killing browser performance</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="DOM Mutation Events at one time seemed like a great idea - web developers began to create more dynamic applications, and it seemed natural the joy wit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DOM MutationObserver - reacting to a change in DOM without killing browser performance</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://developer.mozilla.org/en/DOM/Mutation_events">DOM Mutation Events</a> at one time seemed like a great idea - web developers began to create more dynamic applications, and it seemed natural the joy with which new opportunities to listen to DOM changes and respond to them were met.  In practice, however, it turned out that DOM Mutation Events has serious performance and stability issues.  Not surprisingly, the specification got the status ‚Äúobsolete‚Äù a year later. <br><br>  But the very idea behind DOM Mutation Events seemed attractive and therefore, in September 2011, a group of Google and Mozilla engineers presented a <a href="http://lists.w3.org/Archives/Public/public-webapps/2011JulSep/1622.html">proposal</a> for DOM <a href="http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html">MutationObserver</a> , with similar functionality, but improved performance.  This new DOM-API is available starting from versions: Firefox 14, Chrome 18, IE 11, Safari 6 (other browsers are <a href="http://caniuse.com/mutationobserver">caniuse.com/mutationobserver</a> ) <br><a name="habracut"></a><br>  In the simplest case, MutationObserver is used like this: <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   var target = document.querySelector('#some-id'); //    var observer = new MutationObserver(function(mutations) { mutations.forEach(function(mutation) { console.log(mutation.type); }); }); //   var config = { attributes: true, childList: true, characterData: true } //       observer.observe(target, config); //     observer.disconnect();</span></span></code> </pre> <br>  A key advantage of the new specification over the outdated DOM Mutation Events is efficiency.  When you monitor a DOM node, your callback function will not work until the DOM changes are complete.  When the callback works, it will be passed to the final list of changes to the DOM, running through which you can somehow respond to the changes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It is also assumed that the code will need to somehow process the results transmitted by the observer in order to respond to the changes we need.  Here is a small example of an observer listening for changes to an edited on-site ordered list: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ol</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">contenteditable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">oninput</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>Press enter<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ol</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> MutationObserver = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.MutationObserver || </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.WebKitMutationObserver || </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.MozMutationObserver; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> list = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.querySelector(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'ol'</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> observer = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> MutationObserver(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">mutations</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ mutations.forEach(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">mutation</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (mutation.type === </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'childList'</span></span></span><span class="javascript">) { </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> list_values = [].slice.call(list.children) .map( </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">node</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">return</span></span></span><span class="javascript"> node.innerHTML; }) .filter( </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">s</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">if</span></span></span><span class="javascript"> (s === </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'&lt;br&gt;'</span></span></span><span class="javascript">) { </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">return</span></span></span><span class="javascript"> </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">false</span></span></span><span class="javascript">; } </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">else</span></span></span><span class="javascript"> { </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">return</span></span></span><span class="javascript"> </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">true</span></span></span><span class="javascript">; } }); </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">console</span></span></span><span class="javascript">.log(list_values); } }); }); observer.observe(list, { </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">attributes</span></span></span><span class="javascript">: </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">true</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">childList</span></span></span><span class="javascript">: </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">true</span></span></span><span class="javascript">, </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">characterData</span></span></span><span class="javascript">: </span><span class="hljs-literal"><span class="javascript"><span class="hljs-literal">true</span></span></span><span class="javascript"> }); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  So that you can see the code in the case, I posted it on jsbin: <br><br>  <a href="http://jsbin.com/ivamoh/53/edit">jsbin.com/ivamoh/53/edit</a> <br><br>  If you play around with the code in the sandbox, you probably noticed one feature: the callback function only works when you press ‚Äúenter‚Äù on any element of the list - essentially, this is because your actions lead to add or remove a DOM node.  This is the most important difference from other techniques, such as subscribing to keystrokes, or mouse clicks.  MutationObservers does not work in the same way as all these techniques - here the triggering occurs only when the DOM is changed, and not as a reaction to events initiated by JS, or user actions. <br><br>  So, where is it used? <br><br>  I do not think that all programmers immediately and for no reason at all, they abandon everything, and start embedding MutationObservers into their code.  Probably most of all, this API is suitable for developers of JS frameworks to implement something new, or something that was not previously implemented due to performance problems.  Also, this technique is useful if you use any framework that modifies the DOM, and you need to respond to these changes (without the use of crutches, such as setTimeout).  Well, the last thing is the development of browser extensions. <br><br>  Resources: <br><ul><li>  <a href="http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html">W3C specification</a> </li><li>  <a href="http://www.youtube.com/watch%3Fv%3DeRZ4pO0gVWw">Screencast</a> by Rafael Weinstein (eng) </li><li>  <a href="https://code.google.com/p/mutation-summary/">Mutation Summary</a> , JS library, simplifies the use of MutationObserver. </li><li>  <a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver">MutationObserver on the Mozilla website</a> </li></ul><br><br>  <b>From the translator: the</b> material is more than a year old, but something is too little in Russian about MutationObserver - can someone come in handy. </div><p>Source: <a href="https://habr.com/ru/post/202366/">https://habr.com/ru/post/202366/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202354/index.html">How to assess the quality of user experience in data transfer?</a></li>
<li><a href="../202358/index.html">Hardware accelerated rendering in Chrome browser</a></li>
<li><a href="../202360/index.html">Sony PlayStation 4 Full review</a></li>
<li><a href="../202362/index.html">Comet ISON broke out, time to get binoculars</a></li>
<li><a href="../202364/index.html">The classic post-apocalyptic RPG Wasteland is now on Steam and GOG</a></li>
<li><a href="../202368/index.html">Personal cryptography: a story about one useful vulnerability</a></li>
<li><a href="../202372/index.html">Cubit lasted 39 minutes at room temperature</a></li>
<li><a href="../202378/index.html">Extremely simple way to create a multiboot flash drive for Debian / Ubuntu</a></li>
<li><a href="../202380/index.html">Linux Mint 16 "Petra"</a></li>
<li><a href="../202382/index.html">The digest of interesting materials from the world of web development and IT for the last week No. 83 (November 10 - 16, 2013)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>