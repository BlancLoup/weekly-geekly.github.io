<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We work with Bitcoin on Elixir</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I was captured with the magic world of Bitcoin . There was no limit to the thirst for knowledge, and the wonderful book ‚ÄúMastering Bitcoin‚Äù ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We work with Bitcoin on Elixir</h1><div class="post__text post__text-html js-mediator-article"><p>  Recently, I was captured with the magic <a href="https://bitcoin.org/ru/">world of Bitcoin</a> .  There was no limit to the thirst for knowledge, and the wonderful book <a href="https://www.amazon.com/gp/product/1449374042/">‚ÄúMastering Bitcoin‚Äù by</a> Andreas Antonopoulos and complete immersion in <a href="https://www.amazon.com/gp/product/1449374042/">Bitcoin</a> development helped quench it.  The book covers in detail the technical fundamentals of Bitcoin, but nothing helps in studying a new business like practice. </p><br><p>  A simple application on the Elixir for managing a full Bitcoin node and communicating with it via <a href="https://en.bitcoin.it/wiki/API_reference_%2528JSON-RPC%2529">the JSON-RPC interface</a> , in my opinion, is an excellent ‚ÄúHello, World!‚Äù.  Go! </p><a name="habracut"></a><br><h2 id="gde-vzyat-polnuyu-nodu">  Where to get the full node </h2><br><p>  To establish a connection with a full Bitcoin Core node, you must first get somewhere somewhere.  It is enough just <a href="https://bitcoin.org/en/full-node">to run your node locally</a> , because public nodes with an open JSON-RPC interface can be counted on fingers. </p><br><p> <a href="https://bitcoin.org/en/full-node"><code>  bitcoind</code></a> and configure it in the <code>bitcoin.config</code> file: </p><br><pre> <code class="hljs xml">rpcuser=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span> rpcpassword=<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Defined values <code>&lt;username&gt;</code> and <code>&lt;password&gt;</code> will be used for authentication when sending requests to a bitcoin node. </p><br><p>  After the setup is complete, it's time to start the full node: </p><br><pre> <code class="hljs pgsql">bitcoind -conf=&lt;<span class="hljs-type"><span class="hljs-type">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> bitcoin.config&gt; -daemon</code> </pre> <br><p>  Once started, the full node daemon will start connecting to peers, download and verify transactions in blocks. </p><br><p>  Make sure that everything works as it should: </p><br><pre> <code class="hljs lua">bitcoin-cli <span class="hljs-built_in"><span class="hljs-built_in">getinfo</span></span></code> </pre> <br><p>  This command will return basic information about the node, including its version and the number of blocks received and verified.  Downloading and verifying the entire blockchain can take several days, but for now, we will continue to work on our project. </p><br><h2 id="interfeys-json-rpc">  JSON-RPC interface </h2><br><p>  Bitcoin node works through the JSON-RPC interface, which can be used to extract information about the blockchain and interact with the node. </p><br><p>  Curiously, the <code>bitcoin-cli</code> that we used earlier to get information about the node works on top of the JSON-RPC API.  A list of all possible RPC commands of the node can be seen by calling the <code>bitcoin-cli help</code> or by <code>bitcoin-cli help</code> <a href="https://en.bitcoin.it/wiki/Original_Bitcoin_client/API_calls_list">Bitcoin Wiki</a> . </p><br><p>  The JSON-RPC protocol receives incoming commands via an HTTP server, which means you can do without <code>bitcoin-cli</code> and register these RPC commands yourself. </p><br><p>  For example, <a href="https://bitcoin.stackexchange.com/a/19839"><code> getinfo   </code> curl`</a> : </p><br><pre> <code class="hljs swift">curl --data-binary '{<span class="hljs-string"><span class="hljs-string">"jsonrpc"</span></span>:<span class="hljs-string"><span class="hljs-string">"1.0"</span></span>,<span class="hljs-string"><span class="hljs-string">"method"</span></span>:<span class="hljs-string"><span class="hljs-string">"getinfo"</span></span>,<span class="hljs-string"><span class="hljs-string">"params"</span></span>:[]}' \ http:<span class="hljs-comment"><span class="hljs-comment">//&lt;user&gt;:&lt;pass&gt;@localhost:8332/</span></span></code> </pre> <br><p>  Similarly, you can execute such commands in any programming environment with an HTTP client, for example, in Elixir! </p><br><h2 id="razrabotka-eliksir-prilozheniya">  Elixir application development </h2><br><p>  Having thought out the strategy of interaction with a full Bitcoin node, let's do an Elixir application. </p><br><p>  Let's create a new project and update <code>mix.exs</code> to add the <a href="https://hex.pm/packages/poison"><code>poison</code></a> library to dependencies, which we will need to encrypt and decrypt JSON objects, and <a href="httpoison"><code>httpoison</code></a> is one of the best HTTP clients for Elixir. </p><br><pre> <code class="hljs ruby">defp deps <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> [ {<span class="hljs-symbol"><span class="hljs-symbol">:httpoison</span></span>, <span class="hljs-string"><span class="hljs-string">"~&gt; 0.13"</span></span>}, {<span class="hljs-symbol"><span class="hljs-symbol">:poison</span></span>, <span class="hljs-string"><span class="hljs-string">"~&gt; 3.1"</span></span>} ] <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Now that we‚Äôve finished with the part responsible for code generation, let's move on to the implementation of interaction with a bitcoin node. </p><br><p>  Let's start working with the <code>HelloBitcoin</code> module and first of all put the stub for the <code>getinfo</code> function: </p><br><pre> <code class="hljs sql">defmodule HelloBitcoin <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">def</span></span> getinfo <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> <span class="hljs-string"><span class="hljs-string">"TODO: Implement getinfo"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  For simplicity, we will interact with this module via <code>iex -S mix</code> .  Before proceeding to the next step, let's make sure that everything works correctly. </p><br><p>  Calling the <code>HelloBitcoin.getinfo</code> stub should result in a runtime exception: </p><br><pre> <code class="hljs lua">iex(<span class="hljs-number"><span class="hljs-number">1</span></span>)&gt; HelloBitcoin.<span class="hljs-built_in"><span class="hljs-built_in">getinfo</span></span> HelloBitcoin.<span class="hljs-built_in"><span class="hljs-built_in">getinfo</span></span> ** (RuntimeError) TODO: Implement <span class="hljs-built_in"><span class="hljs-built_in">getinfo</span></span> (hello_bitcoin) lib/hello_bitcoin.ex:<span class="hljs-number"><span class="hljs-number">4</span></span>: HelloBitcoin.<span class="hljs-built_in"><span class="hljs-built_in">getinfo</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><p>  Fine.  Mistake.  As it should be. </p><br><h2 id="postroenie-komandy-getinfo">  Building a <code>GetInfo</code> </h2><br><p>  Now fill the getinfo function <code>getinfo</code> content. </p><br><p>  I repeat: we need to send an HTTP request using the <code>POST</code> method to the HTTP server of a Bitcoin node (usually listening to <code>http://localhost:8332</code> ) and transmit a JSON object containing the <code>GetInfo</code> command and the necessary parameters. </p><br><p>  It turned out that <code>httpoison</code> copes with this task in two accounts: </p><br><pre> <code class="hljs sql">def getinfo <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">url</span></span> &lt;- Application.get_env(:hello_bitcoin, :bitcoin_url), command &lt;- %{jsonrpc: <span class="hljs-string"><span class="hljs-string">"1.0"</span></span>, method: <span class="hljs-string"><span class="hljs-string">"getinfo"</span></span>, params: []}, <span class="hljs-keyword"><span class="hljs-keyword">body</span></span> &lt;- Poison.encode!(command), headers &lt;- [{<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>, <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>}] <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> HTTPoison.post!(<span class="hljs-keyword"><span class="hljs-keyword">url</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">body</span></span>, headers) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  First we get the <code>url</code> from the <code>bitcoin_url</code> key in the application configuration.  The address must be in the <code>config/config.exs</code> and point to the local node: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">config</span></span> :hello_bitcoin, bitcoin_url: <span class="hljs-string"><span class="hljs-string">"http://&lt;user&gt;:&lt;password&gt;</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">@localhost</span></span></span><span class="hljs-string">:8332"</span></span></code> </pre> <br><p>  Next, create a dictionary representing our JSON-RPC command.  In this case, we write <code>"getinfo"</code> in the <code>method</code> field, and leave the <code>params</code> field empty.  And <code>Poison.encode!</code> request body by converting the command to JSON format using <code>Poison.encode!</code>  . </p><br><p>  The <code>HelloBitcoin.getinfo</code> call should return a successful response from a Bitcoin node with a status code of <code>200</code> , as well as the result of the <code>getinfo</code> in JSON format: </p><br><pre> <code class="hljs vbscript">%HTTPoison.<span class="hljs-built_in"><span class="hljs-built_in">Response</span></span>{ body: <span class="hljs-string"><span class="hljs-string">"{\"</span></span>result\<span class="hljs-string"><span class="hljs-string">":{\"</span></span>version\<span class="hljs-string"><span class="hljs-string">":140200,\"</span></span>protocolversion\<span class="hljs-string"><span class="hljs-string">":70015,\"</span></span>walletversion\<span class="hljs-string"><span class="hljs-string">":130000,\"</span></span>balance\<span class="hljs-string"><span class="hljs-string">":0.00000000,\"</span></span>blocks\<span class="hljs-string"><span class="hljs-string">":482864,\"</span></span>timeoffset\<span class="hljs-string"><span class="hljs-string">":-1,\"</span></span>connections\<span class="hljs-string"><span class="hljs-string">":8,\"</span></span>proxy\<span class="hljs-string"><span class="hljs-string">":\"</span></span>\<span class="hljs-string"><span class="hljs-string">",\"</span></span>difficulty\<span class="hljs-string"><span class="hljs-string">":888171856257.3206,\"</span></span>testnet\<span class="hljs-string"><span class="hljs-string">":false,\"</span></span>keypoololdest\<span class="hljs-string"><span class="hljs-string">":1503512537,\"</span></span>keypoolsize\<span class="hljs-string"><span class="hljs-string">":100,\"</span></span>paytxfee\<span class="hljs-string"><span class="hljs-string">":0.00000000,\"</span></span>relayfee\<span class="hljs-string"><span class="hljs-string">":0.00001000,\"</span></span>errors\<span class="hljs-string"><span class="hljs-string">":\"</span></span>\<span class="hljs-string"><span class="hljs-string">"},\"</span></span><span class="hljs-keyword"><span class="hljs-keyword">error</span></span>\<span class="hljs-string"><span class="hljs-string">":null,\"</span></span>id\<span class="hljs-string"><span class="hljs-string">":null}\n"</span></span>, headers: [{<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>, <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-string"><span class="hljs-string">"Thu, 31 Aug 2017 21:27:02 GMT"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Content-Length"</span></span>, <span class="hljs-string"><span class="hljs-string">"328"</span></span>}], request_url: <span class="hljs-string"><span class="hljs-string">"http://localhost:8332"</span></span>, status_code: <span class="hljs-number"><span class="hljs-number">200</span></span> }</code> </pre> <br><p>  Perfectly. </p><br><p>  Decipher the received JSON text in <code>body</code> and get the result: </p><br><pre> <code class="hljs vhdl">HTTPoison.post!(url, <span class="hljs-keyword"><span class="hljs-keyword">body</span></span>) |&gt; <span class="hljs-keyword"><span class="hljs-keyword">Map</span></span>.get(:<span class="hljs-keyword"><span class="hljs-keyword">body</span></span>) |&gt; Poison.decode!</code> </pre> <br><p>  Now the results of the <code>HelloBitcoin.getinfo</code> call, received from <code>bitcoind</code> , will be presented in a more convenient form: </p><br><pre> <code class="hljs php">%{<span class="hljs-string"><span class="hljs-string">"error"</span></span> =&gt; nil, <span class="hljs-string"><span class="hljs-string">"id"</span></span> =&gt; nil, <span class="hljs-string"><span class="hljs-string">"result"</span></span> =&gt; %{<span class="hljs-string"><span class="hljs-string">"balance"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-string"><span class="hljs-string">"blocks"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">483001</span></span>, <span class="hljs-string"><span class="hljs-string">"connections"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-string"><span class="hljs-string">"difficulty"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">888171856257.3206</span></span>, <span class="hljs-string"><span class="hljs-string">"errors"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"keypoololdest"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1503512537</span></span>, <span class="hljs-string"><span class="hljs-string">"keypoolsize"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-string"><span class="hljs-string">"paytxfee"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-string"><span class="hljs-string">"protocolversion"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">70015</span></span>, <span class="hljs-string"><span class="hljs-string">"proxy"</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"relayfee"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1.0e-5</span></span>, <span class="hljs-string"><span class="hljs-string">"testnet"</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">"timeoffset"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-string"><span class="hljs-string">"version"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">140200</span></span>, <span class="hljs-string"><span class="hljs-string">"walletversion"</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">130000</span></span>}}</code> </pre> <br><p>  Note that the data we need ( <code>"result"</code> ) is wrapped in a dictionary containing metadata about the query itself.  This metadata contains a string with a possible error and a request identifier. </p><br><p>  <code>getinfo</code> function so that it includes error handling and returns actual data in the case of an error-free query: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">url</span></span> &lt;- Application.get_env(:hello_bitcoin, :bitcoin_url), command &lt;- %{jsonrpc: <span class="hljs-string"><span class="hljs-string">"1.0"</span></span>, method: <span class="hljs-string"><span class="hljs-string">"getinfo"</span></span>, params: []}, {:ok, <span class="hljs-keyword"><span class="hljs-keyword">body</span></span>} &lt;- Poison.encode(command), {:ok, response} &lt;- HTTPoison.post(<span class="hljs-keyword"><span class="hljs-keyword">url</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">body</span></span>), {:ok, metadata} &lt;- Poison.decode(response.body), %{<span class="hljs-string"><span class="hljs-string">"error"</span></span> =&gt; nil, <span class="hljs-string"><span class="hljs-string">"result"</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">result</span></span>} &lt;- metadata <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">result</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> %{<span class="hljs-string"><span class="hljs-string">"error"</span></span> =&gt; reason} -&gt; {:<span class="hljs-keyword"><span class="hljs-keyword">error</span></span>, reason} <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Now, if there are no errors, the <code>getinfo</code> function will return a <code>{:ok, result}</code> tuple containing the result of the RPC call, and in the opposite case we will get the <code>{:error, reason}</code> tuple with a description of the error. </p><br><h2 id="obobschenie-komand">  Team Summary </h2><br><p>  In a similar manner, you can implement other blockchain RPC commands, for example, <code>getblockhash</code> : </p><br><pre> <code class="hljs sql">def getblockhash(index) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">url</span></span> &lt;- Application.get_env(:hello_bitcoin, :bitcoin_url), command &lt;- %{jsonrpc: <span class="hljs-string"><span class="hljs-string">"1.0"</span></span>, method: <span class="hljs-string"><span class="hljs-string">"getblockhash"</span></span>, params: [<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>]}, {:ok, <span class="hljs-keyword"><span class="hljs-keyword">body</span></span>} &lt;- Poison.encode(command), {:ok, response} &lt;- HTTPoison.post(<span class="hljs-keyword"><span class="hljs-keyword">url</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">body</span></span>), {:ok, metadata} &lt;- Poison.decode(response.body), %{<span class="hljs-string"><span class="hljs-string">"error"</span></span> =&gt; nil, <span class="hljs-string"><span class="hljs-string">"result"</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">result</span></span>} &lt;- metadata <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> {:ok, <span class="hljs-keyword"><span class="hljs-keyword">result</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> %{<span class="hljs-string"><span class="hljs-string">"error"</span></span> =&gt; reason} -&gt; {:<span class="hljs-keyword"><span class="hljs-keyword">error</span></span>, reason} <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  <code>getblockhash</code> calling <code>getblockhash</code> with a zero index, we get the <a href="https://en.bitcoin.it/wiki/Genesis_block">first block of the chain</a> . </p><br><pre> <code class="hljs erlang-repl">HelloBitcoin.getblockhash(<span class="hljs-number"><span class="hljs-number">0</span></span>) {:ok, <span class="hljs-string"><span class="hljs-string">"000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f"</span></span>}</code> </pre> <br><p>  The <code>getblockhash</code> function works correctly, and it is almost identical to the <code>getinfo</code> function. </p><br><p>  To avoid duplication of code, we will select the general functional part in the new auxiliary function <code>bitcoin_rpc</code> : </p><br><pre> <code class="hljs sql">defp bitcoin_rpc(method, params \\ []) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">url</span></span> &lt;- Application.get_env(:hello_bitcoin, :bitcoin_url), command &lt;- %{jsonrpc: <span class="hljs-string"><span class="hljs-string">"1.0"</span></span>, method: method, params: params}, {:ok, <span class="hljs-keyword"><span class="hljs-keyword">body</span></span>} &lt;- Poison.encode(command), {:ok, response} &lt;- HTTPoison.post(<span class="hljs-keyword"><span class="hljs-keyword">url</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">body</span></span>), {:ok, metadata} &lt;- Poison.decode(response.body), %{<span class="hljs-string"><span class="hljs-string">"error"</span></span> =&gt; nil, <span class="hljs-string"><span class="hljs-string">"result"</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">result</span></span>} &lt;- metadata <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> {:ok, <span class="hljs-keyword"><span class="hljs-keyword">result</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> %{<span class="hljs-string"><span class="hljs-string">"error"</span></span> =&gt; reason} -&gt; {:<span class="hljs-keyword"><span class="hljs-keyword">error</span></span>, reason} <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Now we will override the <code>getinfo</code> and <code>getblockhash</code> in accordance with the <code>bitcoin_rpc</code> function: </p><br><pre> <code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getinfo</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bitcoin_rpc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"getinfo"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getblockhash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(index)</span></span></span></span>, <span class="hljs-symbol"><span class="hljs-symbol">do:</span></span> bitcoin_rpc(<span class="hljs-string"><span class="hljs-string">"getblockhash"</span></span>, [index])</code> </pre> <br><p>  You can see that <code>bitcoin_rpc</code> is a full-fledged RPC-interface for Bitcoin, allowing you to easily execute any RPC commands. </p><br><p>  If you are interested in trying to implement all of the above on your machine, then the source of the project can be <a href="https://github.com/pcorey/hello_bitcoin">found on GitHub</a> . </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Well, the rather long article came to an end explaining a relatively simple idea.  A full Bitcoin node provides a JSON-RPC interface, which can be accessed using any language (for example, Elixir) or a stack.  Bitcoin development is a surprisingly entertaining thing, in which it is interesting to go even deeper. </p><br><p>  The next part of a series of articles on working with Bitcoin on Elixir <a href="https://wunsh.ru/articles/bitcoin-blockchain-with-elixir-and-phoenix-part-2.html">is available here</a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/341072/">https://habr.com/ru/post/341072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341060/index.html">UX design: 50 things you probably forgot to do</a></li>
<li><a href="../341064/index.html">We optimize PropertyDrawer under Unity3d</a></li>
<li><a href="../341066/index.html">Cocos2d-x - Event Manager</a></li>
<li><a href="../341068/index.html">Service alert a million users with RabbitMQ</a></li>
<li><a href="../341070/index.html">Nearly 2018, and we love callbacks</a></li>
<li><a href="../341074/index.html">Translation and dubbing of a movie at home - Indie Game: The Movie Special Edition</a></li>
<li><a href="../341076/index.html">Ember.js: a great framework for web applications</a></li>
<li><a href="../341080/index.html">How to render frame Unreal Engine</a></li>
<li><a href="../341084/index.html">Implementing HFT robots on CEPappliance devices</a></li>
<li><a href="../341086/index.html">Numbers and letters: how was SmartData conference</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>