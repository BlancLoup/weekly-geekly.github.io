<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Emsisoft experts found another JavaScript extortionist</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In early January, we wrote about the discovery of a security company, Emsisoft, which discovered an extortionist (ransomware), entirely written in Jav...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Emsisoft experts found another JavaScript extortionist</h1><div class="post__text post__text-html js-mediator-article">  In early January, we <a href="https://habrahabr.ru/company/eset/blog/274447/">wrote</a> about the discovery of a security company, Emsisoft, which discovered an extortionist (ransomware), entirely written in JavaScript.  The extortionist was called Ransom32.  In the new case, we are also talking about the extortionist for JavaScript, which was called the RAA.  The malicious program encrypts the user's files using the symmetric AES algorithm, and also installs another known malicious program in the user's system ‚Äî the Pony password thief (Fareit).  ESET antivirus products detect ransomware as <b>JS / TrojanDropper.Agent</b> . <br><br><img src="https://habrastorage.org/files/6b8/02e/06a/6b802e06a463466b9e3d46368e5641f2.jpg"><br><br>  Unlike Ransom32, RAA does not use the <a href="http://nwjs.io/">NW.js</a> framework for its work.  This framework allows you to develop JavaScript applications for Windows, OS X and Linux.  To work with encryption functions, RAA uses the <a href="https://code.google.com/archive/p/crypto-js/">CryptoJS</a> cryptographic library.  It is used to encrypt user files.  The Pony password thief installed into the user‚Äôs system is detected by ESET AV products as <b>Win32 / PSW.Fareit.A</b> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Malware is usually distributed using a malicious attachment in an email message.  This attachment is masked as a Word document (.doc).  To disguise its malicious functions, the malware drops a special file into the% userprofile% \ documents directory and tries to open it using WordPad. <br><br><img src="https://habrastorage.org/files/15e/40d/3f3/15e40d3f351841a487763d25b5d35519.png"><br>  Fig.  Fake damaged document being dumped to disk ( <i>Emsisoft data</i> ). <br><br>  To ensure its survival in the system after a reboot, the extortionist is registered in the well-known Run section of the registry.  The value of the parameter indicates the path to the original dropper. <br><br><img src="https://habrastorage.org/files/749/0d4/622/7490d46224944604be73d1897904a2bf.png"><br>  Fig.  The malicious program creates a parameter for its autoload ( <i>Emsisoft data</i> ). <br><br>  The Extortioner also removes the Volume Shadow Service (VSS) volume shadowing service.  Such an operation is performed in order to ensure that the user cannot restore the original copies of the files after they are encrypted (File History setting).  As a result of this, when trying to restore a file to its previous version, the operation fails, just like when trying to access System Restore. <br><br><img src="https://habrastorage.org/files/208/e79/4e7/208e794e767543d5a6b6c5da22a290f6.png"><br>  Fig.  Error message when trying to recover an encrypted file using VSS ( <i>Emsisoft data</i> ). <br><br><img src="https://habrastorage.org/files/094/473/a05/094473a055904e7db4a171365d0114f1.png"><br>  Fig.  VSS service removal function ( <i>Emsisoft data</i> ). <br><br>  The next step is to encrypt files using the CryptoJS library.  Encrypted files receive an additional extension .locked. <br><br><img src="https://habrastorage.org/files/d7b/64f/957/d7b64f9579894053839d140df1b98b48.png"><br>  Fig.  Encryption function ( <i>Emsisoft data</i> ). <br><br>  Extortionist encrypts files with the following extensions .doc, .xls, .rtf, .pdf, .dbf, .jpg, .dwg, .cdr, .psd, .cd, .mdb, .png, .lcd, .zip, .rar .csv.  Files that contain ".locked", "~" or "$" characters in the name are skipped. <br><br><img src="https://habrastorage.org/files/369/618/687/369618687b1c419bbc264f3881968b71.png"><br>  Fig.  A list of file extensions for encryption and excluded by the lines in the names ( <i>Emsisoft data</i> ). <br><br>  Files that are contained in the following directories are excluded from the encryption process Program Files, Program Files (x86), Windows, Recycle.Bin, Recycler, AppData, Temp, ProgramData, and Microsoft. <br><br><img src="https://habrastorage.org/files/c5e/d68/c68/c5ed68c6841b4c21a42bb7394cc4ac41.png"><br>  Fig.  List of directories to exclude ( <i>Emsisoft data</i> ). <br><br>  The redemption message is stored in a special file !!! README !!! [unique ID] .rtf, which is created on the desktop.  From the user require a ransom in the amount of 0.39 bitcoins or $ 250.  The contents of the file are shown below. <br><br><img src="https://habrastorage.org/files/543/10b/7e5/54310b7e598444d8ac79503008e06fc5.png"><br>  Fig.  Text with redemption payment instructions ( <i>Emsisoft data</i> ). <br><br>  At the beginning, we indicated that the extortionist executes a file of another malicious program on the user's system - Pony, which is a password hijacker.  The Pony executable file is stored at the following location% userprofile% \ documents \ st.exe.  It is included in the extortioner's JS-dropper and encoded using base64.  The malware specializes in stealing sensitive user data, such as passwords from various services. <br><br>  Malware samples have the following SHA1 identifiers: <br>  RAA: 2c0b5637701c83b7b2aeabdf3120a89db1dbaad7 <br>  Pony: 822bf6d0eb04df65c072b51100c5c852761e7c9e <br><br>  Unfortunately, decrypting user files that have been encrypted by the RAA is currently not possible, which, once again, speaks of the importance of using data backup in a timely manner. </div><p>Source: <a href="https://habr.com/ru/post/303752/">https://habr.com/ru/post/303752/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../303742/index.html">Experience in developing management software for the questroom</a></li>
<li><a href="../303744/index.html">Search Postgres using ZomboDb and elasticsearch</a></li>
<li><a href="../303746/index.html">CTO "Medusa" - Samat Galimov briefly about what it is to be the main development in the media</a></li>
<li><a href="../303748/index.html">What hides Array # sort: reverse engineering by improvised means</a></li>
<li><a href="../303750/index.html">Methodical notes on the selection of informative features (feature selection)</a></li>
<li><a href="../303754/index.html">Alan Kay, the creator of the PLO, about the development of Lisp and PLO</a></li>
<li><a href="../303756/index.html">How we tested the Russian speedtest</a></li>
<li><a href="../303760/index.html">7 rules for writing world-class technical documentation</a></li>
<li><a href="../303762/index.html">Ansible: testing playbooks (part 1)</a></li>
<li><a href="../303768/index.html">Database backup via SQL VDI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>