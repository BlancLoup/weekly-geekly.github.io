<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Configuring EMC VNX 5100 Storage</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to everyone reading these lines. Recently I had a chance to configure the EMC VNX 5100 disk shelf as a storage for a cluster. As it turned ou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Configuring EMC VNX 5100 Storage</h1><div class="post__text post__text-html js-mediator-article">  Good day to everyone reading these lines.  Recently I had a chance to configure the EMC VNX 5100 disk shelf as a storage for a cluster.  As it turned out, there is nothing particularly complicated about it, but in the process there are some features that distract time and attention.  If you want to use this storage system, but do not want to spend too much time walking the rake, I ask for cat. <br><a name="habracut"></a><br>  The VNX 5100 disk shelf is an entry-level storage system, structurally consisting of the actual disk array and the SPS (Stanby Power Supply) module.  The array occupies 3 units, and can contain 15 3.5-inch disks (my version), or 25 2.5-inch disks.  The first four disks are occupied by the operating system, and it is not recommended to use them in their work.  The SPS module occupies 1 unit, contains built-in batteries, can hold two disk arrays.  Its main task - when you turn off the shelf correctly complete all disk operations and write the contents of the cache to disk.  Nothing else.  In this lie not just a rake - but a rake for children.  With the corresponding consequences in the event of an attack.  Despite its own battery, the system does not make the slightest attempt to pretend to be a UPS, and when there is a power failure, it lies quietly.  So this battery must be included in the external bespereboynik, although the experience actively protests. <br><br>  The system is packed with a soul, the weight in the package is a little more than 90 kg, so that it is better to invite muscular friends to the "body skid".  And if on the way to the server there are steep stairs and narrow doors, then friends will be especially grateful for the pleasure delivered. <br>  The device can be sold with or without bundled software.  However, if you don‚Äôt find any installation CDs in the box, do not be discouraged.  This is normal. <br><br>  On the installation in the rack will not stop, everything is going without problems.  The only thing - pay attention to the power cords that come in the kit.  Maybe I was so lucky with the shelves, maybe with rack-top bespereboynikami, but the cords from the kit sit in the UPS connectors quite freely.  Of my three shelves, one set of cords had to be almost completely replaced with cords from the UPS, otherwise they just fell out. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Before setting up, we register on the manufacturer's website <a href="http://emc.com/">emc.com</a> and <a href="http://emc.com/">download the</a> necessary software.  The networks recommend downloading the installation package <i>VNX Installation Toolbox</i> , which contains almost everything you need, but I would advise you to take the necessary utilities in bulk.  Firstly, the toolbox does not include all the necessary utilities, and secondly, they are created by the <i>InstallAnywere</i> installer, which does not work correctly under Windows Server 2012. You will need the latest versions of the following utilities (they are already compressed by the <i>InstallAware</i> installer, which works fine): <br><br><ul><li>  EMC PowerPath </li><li>  EMC Unisphere Storage System Initialization </li><li>  EMC Unisphere Server Utility </li><li>  EMC Unisphere VNX Client </li><li>  EMC Unisphere Server </li><li>  EMC Unisphere Service Manager </li></ul><br><br>  Before installing on the hosts, we perform all the necessary actions - connecting the FC, setting up the network, plant to the domain, etc. Java needs some utilities to work, so we install it too.  At the time of setup, I advise you to extinguish the internal interfaces on all nodes of the future cluster, otherwise the regiment may pick them up when registering, and not external ones.  Not that it was critical, it will work this way and that, but suddenly, sometime in the future, the regiment will want to communicate on the network with its hosts.  Further I will describe each utility, specifying its version.  This is not necessarily the latest version at the moment, but this version is guaranteed to work for me. <br><br>  <i><b>EMC Unisphere Storage System Initialization</b></i> <i><b><br></b></i>  <i><b>(UnisphereInitTool-Win-32-x86-en_US-1.2.25.1.0163-1.exe)</b></i> <i><br></i>  This utility initializes your shelf.  Before installing it, connect the host interface and disk shelf control interfaces to the same subnet, on the same physical switch.  Turn on the shelf.  It starts slowly enough, so there is time for a cup of coffee.  Install, run the utility, it searches the subnet and shows all found storage systems with their serial number.  Please note that at the time the utility runs, you need to turn off the firewall, otherwise the search will fail.  By the number we define the necessary, initialize, and set the ip-addresses on the control interfaces.  Unfortunately, on this point, my knowledge is only theoretical, from manuals, since my pieces of iron came from the supplier already initialized, with addresses on interfaces of the form 1.1.1.1.  So I just made sure that the device is initialized, and determined its ip.  If anyone has practical experience of this operation, I will be grateful for clarification. <br><img src="https://habrastorage.org/storage2/8c1/5aa/99b/8c15aa99b69ad6d27429d96597037fc8.jpg"><br><br>  <i><b>EMC Unisphere Server Utility</b></i> <i><b><br></b></i>  <i><b>(UnisphereServerUtil-Win-32-x86-en_US-1.2.25.1.0163-1.exe)</b></i> <i><br></i>  The utility registers a host on a disk shelf, allowing you to assign logical disks to it in the future.  If the iSCSI initiator is not running, then it starts.  If necessary, registration can be done by hand, from the web interface it will work.  But it is more correct to do it automatically.  After launch, select the option Register this server with all connected storage system. <br><img src="https://habrastorage.org/storage2/ba6/20a/de4/ba620ade4858ffbc453ad12f58bdb5ea.jpg"><br><br>  <i><b>EMC Unisphere Server</b></i> <i><b><br></b></i>  <i><b>(UnisphereServer-Win-32-x86-en_US-1.2.25.1.0156-1.exe)</b></i> <i><b><br></b></i>  <i><b>EMC Unisphere VNX Client</b></i> <i><b><br></b></i>  <i><b>(UnisphereClient-Win-32-x86-en_US-1.2.25.1.0156-1.exe)</b></i> <i><br></i>  Provides access to the web-based shelf management interface.  The client part asks to enter the address of the shelf, and connects to it, the server provides the same on the host ip-address.  Powered by java.  For correct operation of the server part, configure the firewall permissions.  You can connect to the same shelf interface by simply entering the shelf ip-address in the browser.  Please note that the first time you connect, you need to create an administrator account. <br><img src="https://habrastorage.org/storage2/d52/106/332/d52106332e57feb14c6d7ba52570f967.jpg"><br><br>  <i><b>EMC Unisphere Service Manager</b></i> <i><b><br></b></i>  <i><b>(UnisphereServiceManager-Win-32-x86-en_US-1.2.26.1.0068-1.exe)</b></i> <br>  The service utility used to change the firmware, OS, hardware upgrades, diagnostics collection, etc. Not used in normal work. <br><img src="https://habrastorage.org/storage2/4c3/fad/8a1/4c3fad8a1dc6c46f20b7eb8f9c136315.jpg"><br><br>  <i><b>EMC PowerPath</b></i> <i><b><br></b></i>  <i><b>(EMCPower.X64.signed.5.5.b289.exe)</b></i> <i><br></i>  The PowerPath utility is a separate load balancing product between different FCs, can be used with storage systems from different manufacturers, and generally speaking - a thing licensed and paid.  However, for connections to EMC Clarion and EMC VNX systems, the manufacturer allows using it without a license.  To do this, when installing, we specify that ‚ÄúYes‚Äù, we have Only Clarion arrays connected to this host.  I used version 5.5 without a patch.  The site has a patch, and in the documentation there are references to version 5.7.  Structurally, the shelf contains two blocks, each of which sends information about the assigned logical drives to the host.  Thus, in Computer Manager you will see two sets of storage disks, one of which is connected, and the second one knocks out an error (and no wonder, because the disks are already taken).  PowerPath automatically processes all FCs and hides an extra set of disks.  Everything will work without it, but it is better to do it beautifully and correctly. <br><img src="https://habrastorage.org/storage2/6c9/682/08e/6c968208e555191a366be5ce88908c07.jpg"><br><br>  The utility supports three modes of operation: <br>  Active-active - FC work simultaneously with load balancing. <br>  Active-passive - one FC is active, and the rest are in reserve, and are connected when the active one fails.  Only one FC is running at a time. <br>  ALUA is <i>a protocol for choosing the preferred path to data placed on controllers with different priority, for example, one of the two is more preferable as an access path than the other.</i>  <i>So, using the ALUA protocol (if the OS can use it), the one that is more advantageous to access this piece of data (for example, LUN) is selected from several paths.</i>  <i>If the controller, the priority for this data, is unavailable, then access will go through the controller that has the ‚Äúsecond from the top‚Äù priority, and so on.</i>  <i>Nevertheless, both of them are active, although at this particular point in time, for a particular LUN, one is used predominantly (this is in contrast to the Active Passive).</i>  <i>(c) track</i> <br>  It is this mode that supports our device, in contrast to the previous two, which only older models can work with. <br><br>  So, all the software is installed, and now you can go directly to the shelf. <br>  Connect to the web interface and go to the <i>Hosts&gt; Host List</i> tab.  Since we have already registered, we see our servers in this tab.  The <i>Hosts&gt; Initiators</i> tab lists the initiators that connect servers to storage units.  You can unregister the initiator and manually create a new one instead of it by selecting the server name from the existing ones or specifying a new one.  Will work.  Now all initiators in the list are presented with yellow warning triangles - because they are not connected anywhere yet.  On the <i>Settings&gt; Network&gt; Edit network settings</i> tab, we reconfigure ip-addresses to our network. <br><br>  Since our system is being prepared for a cluster, we will create two LUNs - a quorum of 1 GB and a LUN of data for the rest of the space.  First we prepare the pool for the placement of these LUNs.  On the <i>Storage&gt; Storage Pools</i> tab, select the raid type and total pool size.  There is also a feature here - the system does not know how to create raids on an arbitrary number of hard drives.  Instead, you can choose one of the preset templates. <br><img src="https://habrastorage.org/storage2/238/6b4/cdf/2386b4cdfcc0e6e09555496312556fa5.jpg"><br><br>  So, 10 disks in raid5 do not mean a 9 + 1 scheme at all.  A means (4 + 1) + (4 + 1), with a corresponding drop in the total capacity.  And raid5 on 8 disks means a combination (4 + 1) + (2 + 1).  It‚Äôs good if the raid simply contains file data, and if it‚Äôs application data, we‚Äôll have unpredictable performance problems.  Given that initially I can count on 10 disks (15 minus 4 under OSes and minus 1 HotSpare), I have to choose between raid5 for 10 disks, and raid6 for 8 disks plus two in the mirror.  For reasons of disk capacity, it was decided to stop at raid5.  So - we specify the type of raid, indicate the number of disks allocated for it, the name of the new pool - and OK. <br><br>  Now <i>Storage&gt; Luns</i> .  Specify the name of the pool on which the newly created LUN will be placed, its name and size. <br><img src="https://habrastorage.org/storage2/c8d/655/09d/c8d65509d78dd6af5137679cefa54514.jpg"><br><br>  Finally, on the <i>Hosts&gt; Storage Groops</i> tab, we create a new storage group, linking the LUNs and the hosts: <br>  <i>Create</i> , then <i>Connect LUNs</i> , then <i>Connect Hosts</i> .  Storage groups, in fact, match one or more LUNs to one or more hosts.  Please note - you can connect several hosts to the same LUN only if they are future members of the cluster.  Otherwise, the hosts will damage each other's data due to inconsistent disk writes. <br><img src="https://habrastorage.org/storage2/67a/f9f/342/67af9f34209818a64f788784689253a5.jpg"><br><br>  Now you can go to the <i>Hosts&gt; Initiators</i> tab and admire the green checkmarks in front of all initiators, indicating the correct connection. <br><img src="https://habrastorage.org/storage2/cb5/3fc/cc3/cb53fccc396896722502b54c93d467c1.jpg"><br><br>  At this setting, the disk shelf can be considered over.  On each host we go to Disk Management and translate our new disks online without assigning a letter.  We formatted in NTFS, we raise a cluster, and we catch disks to it.  You can work.  I raised the cluster on Windows Server 2012, the differences in the process from Server 2008 are cosmetic.  But, if anyone is interested, I can describe. <br><br>  Phew  That seems to be "everything that I wanted to say about the Vietnam War" (c) <br><br>  PS Many thanks to habrayumer <a href="http://habrahabr.ru/users/litweg/">litweg</a> and <a href="http://habrahabr.ru/users/track/">track</a> for interesting and useful additions. </div><p>Source: <a href="https://habr.com/ru/post/173513/">https://habr.com/ru/post/173513/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../173495/index.html">MongoDB 2.4 release</a></li>
<li><a href="../173499/index.html">US Supreme Court ruled in favor of student selling textbooks on eBay</a></li>
<li><a href="../173501/index.html">Burn-in rutovy shell in Vesta IP cameras and not only</a></li>
<li><a href="../173503/index.html">The first attempt to state regulation of Bitcoin</a></li>
<li><a href="../173509/index.html">Grab - new interface for working with DOM-tree of HTML-document</a></li>
<li><a href="../173517/index.html">Death of proprietary software</a></li>
<li><a href="../173519/index.html">Humble Weekly Sale: Bastion</a></li>
<li><a href="../173521/index.html">New design Python.org</a></li>
<li><a href="../173525/index.html">A note on the registry of prohibited sites has been added to the registry of prohibited sites.</a></li>
<li><a href="../173533/index.html">Wind River - quick response software</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>