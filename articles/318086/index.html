<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Build your open source AWS S3 server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Amazon S3 (Simple Storage Service, simple storage service) is a very powerful online file storage service provided by Amazon Web Services. Think of it...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Build your open source AWS S3 server</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/07c/31a/d04/07c31ad042d243de830f1bf77e8c079e.jpg"><br><br>  Amazon S3 (Simple Storage Service, simple storage service) is a very powerful online file storage service provided by Amazon Web Services.  Think of it as a remote disk on which you can store files in directories, receive and delete them.  Companies like DropBox, Netflix, Pinterest, Slideshare, Tumblr and many others rely on it. <br><br>  Although the service is excellent, its code is not open, so you have to trust Amazon with your data, and although they provide access to a free instance for a year, you still need to enter credit card information to create an account.  Since  S3 should know every software engineer, I want my students to gain experience with it and use it in their web applications, and I also do not want them to pay for it.  Some students also work while traveling, which means slow Internet connection and expensive traffic, or a complete lack of Internet at all. <br><a name="habracut"></a><br>  That's why I started looking for open solutions that emulate the S3 API, and that could work on any machine.  As usual, the world of Open Source did not disappoint me and provided several solutions, here are my favorites: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  The first thing I came across was <a href="https://github.com/jubos/fake-s3">Fake S3</a> , written in Ruby and available as gems, it only takes a few seconds to install and the library is very well supported.  This is a great tool to get started, but it does not implement all the S3 commands and is not suitable for use in production. <br><br></li><li>  The second option is <a href="http://www8.hp.com/us/en/cloud/helion-eucalyptus.html">HPE Helion Eucalyptus</a> , which provides a wide range of AWS emulation services (CloudFormation, Cloudwatch, ELB ...), including <a href="https://eucalyptus.atlassian.net/wiki/display/STOR/S3%2BAPI%2BSupport%2Bin%2BEucalyptus%2BObject%2BStorage">S3</a> support.  This is a very complete solution (only running on CentOS), enterprise-oriented and, unfortunately, too heavy for personal use or for small business. <br><br></li><li>  The last and preferred option is the <a href="https://github.com/scality/s3">Scality S3 server</a> .  Available as a Docker image, which makes it very easy to deploy and start using it.  The software is suitable for personal use, anyone can start using it in a few seconds without any complicated installation.  But it is also suitable for the enterprise, because  it is scalable and ready for production.  The best of both worlds. </li></ul><br><h2>  Getting Started with Scality S3 Server </h2><br>  To demonstrate how easy it is to emulate AWS S3 using Scality S3 server, let's revive it! <br><br>  Requirements: <br><br><ul><li>  <a href="https://docs.docker.com/engine/installation/">Docker</a> installed </li><li>  Installed <a href="https://www.ruby-lang.org/ru/documentation/installation/">Ruby</a> </li></ul><br>  Launch the Scality S3 Docker server container: <br><br><pre><code class="bash hljs">$ docker run -d --name s3server -p 8000:8000 scality/s3server Unable to find image <span class="hljs-string"><span class="hljs-string">'scality/s3server:latest'</span></span> locally latest: Pulling from scality/s3server 357ea8c3d80b: Pull complete 52befadefd24: Pull complete 3c0732d5313c: Pull complete ceb711c7e301: Pull complete 868b1d0e2aad: Pull complete 3a438db159a5: Pull complete 38d1470647f9: Pull complete 4d005fb96ed5: Pull complete a385ffd009d5: Pull complete Digest: sha256:4fe4e10cdb88da8d3c57e2f674114423ce4fbc57755dc4490d72bc23fe27409e Status: Downloaded newer image <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> scality/s3server:latest 7c61434e5223d614a0739aaa61edf21763354592ba3cc5267946e9995902dc18 $</code> </pre> <br>  Make sure that the Docker container is working properly: <br><br><pre> <code class="bash hljs">$ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES ed54e677b1b3 scality/s3server <span class="hljs-string"><span class="hljs-string">"npm start"</span></span> 5 days ago Up 5 days 0.0.0.0:8000-&gt;8000/tcp s3server</code> </pre><br>  Install the AWS SDK v2 Ruby-gem (documentation <a href="http://docs.aws.amazon.com/sdkforruby/api/">here</a> ): <br><br><pre> <code class="bash hljs">$ gem install aws-sdk</code> </pre><br>  Now let's create a file that we upload to our basket: <br><br><pre> <code class="bash hljs">$ touch myfavoritefile</code> </pre><br>  Using your favorite text editor, create a file containing your Ruby script, let's call it 's3_script.rb': <br><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/ruby require 'aws-sdk' s3 = Aws::S3::Client.new( :access_key_id =&gt; 'accessKey1', :secret_access_key =&gt; 'verySecretKey1', :region =&gt; 'us-west-2', :endpoint =&gt; 'http://0.0.0.0:8000/', :force_path_style =&gt; true ) s3.create_bucket({bucket: "mybucket"}) File.open('myfavoritefile', 'rb') do |file| s3.put_object(bucket: 'mybucket', key: 'myfavoritefile', body: file) end resp = s3.list_objects_v2(bucket: 'mybucket') puts resp.contents.map(&amp;:key)</span></span></code> </pre><br>  Run the script: <br><br><pre> <code class="bash hljs">$ ruby s3_script.rb $ myfavoritefile</code> </pre><br>  Congratulations, you created your first S3-cart and uploaded a file into it! <br><br><h2>  Let's break down the code </h2><br>  Here we indicate that the script should be executed by Ruby and that we include <a href="https://github.com/aws/aws-sdk-ruby">the AWS SDK library</a> : <br><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/ruby require 'aws-sdk'</span></span></code> </pre><br>  We initiate a connection to our S3 server running in our Docker container.  Note that the 'accessKey1' and 'verySecretKey1' are the access key and the default secret access key defined by the Scality S3 server: <br><br><pre> <code class="ruby hljs">s3 = Aws::S3::Client.new( <span class="hljs-symbol"><span class="hljs-symbol">:access_key_id</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'accessKey1'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:secret_access_key</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'verySecretKey1'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:region</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'us-west-2'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:endpoint</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'http://127.0.0.1:8000/'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">:force_path_style</span></span> =&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span> )</code> </pre><br>  Create an S3 basket named 'mybucket': <br><br><pre> <code class="ruby hljs">s3.create_bucket({<span class="hljs-symbol"><span class="hljs-symbol">bucket:</span></span> <span class="hljs-string"><span class="hljs-string">"mybucket"</span></span>})</code> </pre><br>  Here we load the previously created file 'myfavoritefile' into our cart 'mybucket': <br><br><pre> <code class="ruby hljs">File.open(<span class="hljs-string"><span class="hljs-string">'myfavoritefile'</span></span>, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|file|</span></span> s3.put_object(<span class="hljs-symbol"><span class="hljs-symbol">bucket:</span></span> <span class="hljs-string"><span class="hljs-string">'mybucket'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">key:</span></span> <span class="hljs-string"><span class="hljs-string">'myfavoritefile'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">body:</span></span> file) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  And finally, collect the contents of the basket 'mybucket' and display it in the standard output: <br><br><pre> <code class="ruby hljs">resp = s3.list_objects_v2(<span class="hljs-symbol"><span class="hljs-symbol">bucket:</span></span> ‚Äúmybucket‚Äù) puts resp.contents.map(&amp;<span class="hljs-symbol"><span class="hljs-symbol">:key</span></span>)</code> </pre></div><p>Source: <a href="https://habr.com/ru/post/318086/">https://habr.com/ru/post/318086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318072/index.html">Publishing Desktop Applications in Windows Store using Desktop Application Converter</a></li>
<li><a href="../318074/index.html">The results of GeekWeek 2016 and the return of the terrible BAG: Winter with GeekBrains</a></li>
<li><a href="../318078/index.html">The best free applications for customization and design of Windows 10</a></li>
<li><a href="../318080/index.html">How do I use Facebook groups to expand my own business</a></li>
<li><a href="../318084/index.html">Visualization of integration applications</a></li>
<li><a href="../318088/index.html">What does the operator monitor hide from the client?</a></li>
<li><a href="../318096/index.html">Ember - Best Practices: Avoid Leaking Condition into the Factory</a></li>
<li><a href="../318098/index.html">Yandex mobile experience in three video courses: design, development, interfaces</a></li>
<li><a href="../318100/index.html">Christmas Easter eggs</a></li>
<li><a href="../318102/index.html">Yii2-advanced: Making internationalization with a source in Redis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>