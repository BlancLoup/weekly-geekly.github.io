<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 18: ShadowHammer attack in detail</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the end of March, Motherboard published an article about the potential hacking of Asus‚Äôs infrastructure. Having received partial access to the comp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 18: ShadowHammer attack in detail</h1><div class="post__text post__text-html js-mediator-article">  At the end of March, Motherboard <a href="https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers">published</a> an article about the potential hacking of Asus‚Äôs infrastructure.  Having received partial access to the company's resources, the attackers were able to distribute among customers who installed the Asus Live Update utility to download new drivers in a timely manner, the version of the program with malicious functionality signed by the official certificate.  We wrote about this attack, discovered by Kaspersky Lab experts, <a href="https://habr.com/ru/company/kaspersky/blog/446354/">in early April</a> . <br><br><img src="https://habrastorage.org/webt/57/ig/oh/57igoh6kswygqz8ulrt6egyrraq.png"><br>  Kaspersky Lab has published an <a href="https://securelist.com/operation-shadowhammer-a-high-profile-supply-chain-attack/90380/">extended report</a> on ShadowHammer on April 23.  This very fascinating, although completely technical document is recommended to be read in its entirety, and in this post there will be only a brief description of a part of the finds.  The most interesting thing is the potential connection of ShadowHammer with infected copies of a not the best computer game about zombies and a coordinated attack on software developers. <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pw/ni/ro/pwniron9btesdogauxvypa7hph4.png"></div><br>  In total, Kaspersky Lab experts found 230 samples of an infected utility to update drivers on Asus devices.  In all cases, its original version is dated 2015, but later during the attack, the injection method of its own executable code was changed ‚Äî most likely in order to more effectively avoid detection: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ya/8z/ua/ya8zua8ribf9uwtf9eaxijbydbq.png"></div><br>  The method of introducing malicious code changed in the period between July and December 2018.  The start date of the attack is not known for certain, but it was discovered in January 2019.  The most effective way to infect users' computers and go unnoticed was the use of Asus legitimate certificates, which were also used to sign the ‚Äúofficial‚Äù harmless utilities produced by this company. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/dm/4e/tq/dm4etqyhonkswafn1habxvuzwbq.png"></div><br>  The screenshot above is an example of a legitimate Asus utility, signed with the same certificate as the malicious version of Asus Live Update.  The signature date is March 2019, after the vendor received information about the attack and the certificates used.  The campaign operators had to change the digital signature for the modified executable files in the process, since the first stolen certificate expired in August 2018. <br><br>  Judging by the use of the old version of the legitimate program and the differences in the digital signature of the official and modified software, the attack organizers had limited access to the internal resources of the vendor.  For example, it was possible to hack the computer of one of the developers, to steal certificates, but not the actual source code of the utility.  In addition, attackers gained access to the infrastructure for the delivery of updated versions of the utility in order to distribute the malicious modification. <br><br>  A key feature of the ShadowHammer attack is a limited number of targets for the attack.  There were a lot of potential victims: the malicious version of Asus Live Update only by Kaspersky Lab tools was detected by 57 thousand users.  The actual number of victims could have been even higher, but on most computers the malware did not do anything clearly illegal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ak/ib/zg/akibzgzr4uep-uafngvrdg5pcxy.png"></div><br>  In all cases, the modified utility collected data on the MAC addresses of all available network adapters and compared their MD5 hashes with its own list.  Only in the case of the discovery of one of the MAC addresses from the list, a call was made to the command server from which another executable file was downloaded.  The number of addresses differs from sample to sample: the shortest list consists of eight MAC addresses, the longest of them is 307. In total, more than 600 identifiers of network devices were identified, by which the attackers found systems of interest.  You can check your MAC-addresses for the presence in this list <a href="https://shadowhammer.kaspersky.com/">here</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g7/ln/jl/g7lnjlsldqk8nttka3syzrh9kzs.png"></div><br>  It is logical that most of the MAC addresses in the list refer to devices manufactured by Asus itself.  But there are also addresses that cover a large number of users, for example, 00-50-56-C0-00-08 is the identifier of the virtual network adapter VMWare.  However, such a coincidence did not always lead to the development of an attack: it began only if the MAC address of the physical network adapter also coincided with the required one. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vb/b-/8p/vbb-8pbj0nb2ilsbjjk-t2j5w0u.png"></div><br>  How it looked in practice, shows a screenshot of the <a href="https://www.reddit.com/r/ASUS/comments/9jbioq/asus_live_update_343_vulnerability/">discussion</a> on Reddit.  A user with the Asus Live Update utility installed receives a notification of a ‚Äúcritical update,‚Äù while offering to download a program three years ago.  It‚Äôs not a fact that this discussion is about this particular attack (since there is no file identifier), but judging by the build date of the binary, it was it.  Given that the search for mentions gave only two reports of potential problems (the <a href="https://www.reddit.com/r/ASUS/comments/8qznaj/asusfourceupdaterexe_is_trying_to_do_some_mystery/">second one was</a> definitely not connected with ShadowHammer), we can say that the attack went unnoticed, despite the fairly large number of potential victims. <br><br>  What happened to those whose MAC address was on the list is unknown.  At the time of the discovery of the attack in January 2019, the command server was turned off, and so far the researchers failed to get the executable files downloaded to the computers of the real victims. <br><br>  <b>Contact with other attacks</b> <br>  And here in the post <i>zombies</i> rush in! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bb/yp/7a/bbyp7abweayvpbt9vwzxnknv6wk.jpeg"></div><br>  In March 2019, ESET specialists <a href="https://www.welivesecurity.com/2019/03/11/gaming-industry-scope-attackers-asia/">investigated the</a> infected versions of the Infestation: Survivor Stories game.  Given the theme of the game, this in itself sounds like an anecdote, but the situation for the developer (probably using the source code of the earlier game The War Z) is not the most fun.  Most likely, the malicious code appeared in official builds after the developers' computers were compromised.  In this, and in a couple of other incidents involving attacks on gaming studios, a similar method of ShadowHammer injection of malicious code was applied: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ta/lk/m4/talkm4605legkwattoemlahih3u.png"></div><br>  Okay, this is not reliable evidence of a link between the two incidents.  But there is also a coincidence in the hash algorithms used to collect the victims' data on computers, and a couple of other common technical features of the attacks.  Judging by the lines in the malicious code, it can be assumed that the source code of the earlier War Z game could be distributed as a kind of Trojan horse for game developers who wanted to use them.  Kaspersky Lab experts also found signs of a re-use of ShadowHammer's algorithms in the PlugX <a href="https://securelist.com/plugx-malware-a-good-hacker-is-an-apologetic-hacker/74150/">backdoor</a> , most likely developed in China. <br><br>  This potential connection between different attacks gives the ShadowHammer story a new dimension and is a warning to developers.  Programmers can become involuntary distributors of malicious code due to coordinated and consistent actions of intruders.  Moreover, different tools can be used: theft of certificates, the inclusion of malicious code in the source code, injection into executable files (for example, before sending to the customer).  Judging by the number of white spots in this and other investigations, the attackers managed to infiltrate into the infrastructure of software developers, spread the malicious code to a large number of victims, while precisely targeting targets so as to go unnoticed for at least several months (as is the case with ShadowHammer) . <br><br>  <i>Disclaimer: The opinions expressed in this digest may not always coincide with the official position of Kaspersky Lab.</i>  <i>Dear editors generally recommend to treat any opinions with healthy skepticism.</i> </div><p>Source: <a href="https://habr.com/ru/post/450150/">https://habr.com/ru/post/450150/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../450142/index.html">In May: ordered to survive</a></li>
<li><a href="../450144/index.html">How do new technologies bring the dream of immortality closer?</a></li>
<li><a href="../450146/index.html">My billion dollar error</a></li>
<li><a href="../450148/index.html">One. Veeam ONE. Intelligence, maps, agents and more - today on the monitors of the country</a></li>
<li><a href="../45015/index.html">Create an archive on the fly using the Create ZIP File class</a></li>
<li><a href="../450152/index.html">SEO optimization product card: step by step instructions + lifehacks</a></li>
<li><a href="../450154/index.html">Next-generation PlayStation: What's Inside?</a></li>
<li><a href="../450156/index.html">100GbE: luxury or urgent need?</a></li>
<li><a href="../450158/index.html">Has the ROM thief of the arcade machine gone too far in preserving the Atari heritage?</a></li>
<li><a href="../45016/index.html">PHP's echo function can run for more than 1 second.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>