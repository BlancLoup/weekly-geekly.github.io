<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The story of one repository</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This story began many, many revisions back - then the SVN repository was pristine clean, and not a single bug had yet defiled it with its presence. Th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The story of one repository</h1><div class="post__text post__text-html js-mediator-article">  This story began many, many revisions back - then the SVN repository was pristine clean, and not a single bug had yet defiled it with its presence.  The first commits, the first rollbacks, log views - it was all so exciting, so new.  And how could the repository then assume that these first, such pleasant steps would later lead him to the surgical table? <br><br>  The repository grew, crepe, material.  Over time, I got used to commits, the first tags appeared, and even the dreams of branches no longer seemed unrealizable.  The repository met other SVN repositories, and even began to exchange files with some.  At times, he spent a lot of time siphoning off changes from his new friends, enjoying the analysis of diffs as he went along. <br><a name="habracut"></a><br>  The first clouds over the horizon began to appear when the Repository began to hear more and more often the unfamiliar words ‚ÄúGit‚Äù and ‚ÄúDVCS‚Äù in the conversations of developers.  He tried to ask his repository friends about it, but they just averted their eyes ... <br><br>  Over time, these worries subsided, but life was no longer the same.  The repository plunged, began to think more about the meaning of life.  The old connections were no longer pleasurable, but rather turned into burdensome dependencies.  Increasingly, nightmares about intractable conflicts during the merzhs began to occur. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Life flowed measuredly when the commits stopped.  Anxious forebodings instantly resumed.  The repository, of course, reassured itself with the thought that the developers must be on vacation, and soon everything would return to its normal course, but the feeling of something bad did not leave. <br><br>  One night they knocked on the door.  ‚ÄúFinally, svn commit!‚Äù The Repository thought happily, and deftly jumped to the doors for years.  ‚ÄúWho is there?‚Äù He asked, but in response he heard only intense puffing outside the door.  Nasty sucked under the spoon.  After a moment, behind the door they struck: ‚ÄúOpen, svnadmin dump‚Äù.  With trembling hands, the Repository opened the door ... and fell unconscious. <br><br>  One by one, commits raced before their eyes, they appeared and disappeared, and this was repeated again and again.  ‚ÄúSvnadmin load, svnadmin dump, svnadmin load, svnadmin dump‚Äù - The repository could not understand what was happening, it regained consciousness, then again fell into oblivion.  And only a small, flickering light in the distance gave us hope ... <br><br>  Let's leave our hero for a while and try to figure out what happened. <br><br><h3>  In the eyes of developers </h3><br>  An astute reader can assume that the situation in which the repository finds itself is somehow related to <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0_%25D1%2583%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25B2%25D0%25B5%25D1%2580%25D1%2581%25D0%25B8%25D1%258F%25D0%25BC%25D0%25B8">distributed version control systems</a> .  That's exactly what happened - the developers imbued with all the advantages of <a href="http://habrahabr.ru/blogs/development_tools/108443/">Mercurial</a> and decided to migrate all their code there.  The transition from Subversion to Mercurial, however, can be done fairly painlessly, so why was it necessary to torment the repository? <br><br>  The fact is that earlier the developers made two mistakes, which now showed themselves in all their glory: <ol><li>  Initially, contrary to all best practices, they began to commit to the root of the repository, without bothering to create the traditional folders trunk, branches and tags.  Much later, these folders were created and the files were transferred, but, as you know, you cannot discard commits from the repository.  Now, if you leave everything unchanged, then when migrating to Mercurial, commits outside the trunk will disappear. </li><li>  As we remember, our hero Repository is mired in ‚Äúburdensome dependencies,‚Äù and this, of course, is about svn: externals.  Earlier, I <a href="http://habrahabr.ru/blogs/development_tools/109291/">talked</a> about the inconsistency of this technology.  When migrating to Mercurial, there is currently no easy way to migrate svn: externals. </li></ol>  For the correct transfer of the entire story from Subversion to Mercurial, the developers decided to modify the SVN repository so as to get rid of the above problems. <br><br><h3>  Repository under the scalpel </h3><br>  To modify the repository, we first need the svnadmin utility, which allows you to do a full dump of the SVN repository, a dump for specific revisions or a range of revisions, and also roll up dumps on an already existing repository.  A small digression for Windows users - this utility is not part of TortoiseSVN, but you can install an additional Subversion client, such as <a href="http://www.sliksvn.com/en/download">Slik SVN</a> , in which svnadmin is present. <br><br>  The general idea of ‚Äã‚Äãmodifying the repository is this: we must recreate the repository from scratch by copying the ‚Äúcorrect‚Äù commits without changes and replacing the ‚Äúwrong‚Äù ones with our hands.  In our case, correctness means a situation where a commit does not contain references to svn: externals and all files are located on the trunk.  After the re-creation, you need to correct the date and time for the original commits for the changed commits. <br><br>  In order to understand how the method works, consider the modification of the real repository.  I have prepared a small test repository, in which all the above problems are present.  You can download its dump (demo_repo.dmp) along with the other dumps mentioned in the article <a href="">here</a> . <br><br>  The repository contains 8 revisions; here is a description of each of them: <ol><li>  A text file has been added to the repository root. </li><li>  A small C # HelloWorld project has been added to the repository root. </li><li>  Added folders trunk, tags, branches.  All files from the root are transferred to trunk. </li><li>  The folder '3rd party' has been added, and the svn: externals property has been set for downloading files from an external repository to a subfolder. </li><li>  The svn: externals property has been removed for the '3rd party' folder and is set on the trunk folder. </li><li>  Removed text file from trunk. </li><li>  For the trunk folder, the svn: ignore property is set.  Some files in HelloWorld are modified. </li><li>  Added a text file to the trunk.  Removed subfolder in HelloWorld. </li></ol>  Obviously, the ‚Äúcorrect‚Äù here are only revisions 6 and 8. All the rest will need to be modified anyway. <br><br>  The problem with revisions 1, 2, 3 is that the files are outside of the trunk.  To fix this, we will insert one commit in front of them, in which we will create folders branches, tags, trunk;  commits 1 and 2 are modified so that the files are added to the trunk;  commit 3 is completely removed. <br><br>  Revisions 4 and 5 are related to svn: externals, we must replace external dependencies directly with files downloaded from the external repository.  Revision 7, seemingly harmless, is also indirectly related to svn: externals, more detailed below. <br><br>  So, let's begin.  I will modify the repository under Windows, but nothing prevents to do exactly the same steps, for example, under Linux. <br><br><h3>  Getting rid of svn: externals </h3><br>  Do not immediately try and move all commits to the trunk, and get rid of svn: externals.  It is better to perform these tasks consistently.  We will start with the second task. <br><br>  First, we must identify all problem revisions that need to be replaced manually.  Open the full dump of our repository in a text editor (I use <a href="http://notepad-plus-plus.org/download">Notepad ++</a> ) and consistently look for occurrences of the phrase ‚Äúsvn: externals‚Äù.  They can be much more than necessary, we are interested only in such occurrences: <br><br><pre>  K 13
 svn: externals </pre><br>  For each such place we need to find the string ‚ÄúRevision-number:‚Äù above.  It contains the number of the problem revision we need. <br><br><img src="https://habrastorage.org/storage/57afd6e2/edb0d3a7/f94e2224/39bbe8a0.png"><br><br>  When we reach the end of the dump for our test repository, we should get the following problem revision numbers: 4, 5, and 7. <br>  Now we need to prepare partial dumps for revisions that do not require changes.  For this: <ol><li>  We load our repository completely into some local folder, let's call it full_repo.  This is done using the following command line calls: <br><br><pre>  C: \ Subversion&gt; svnadmin create full_repo
 C: \ Subversion&gt; svnadmin load full_repo &lt;demo_repo.dmp </pre><br></li><li>  Next, prepare the dumps for those revisions of the repository that do not need to be changed (1-3, 6 and 8): <br><br><pre>  C: \ Subversion&gt; svnadmin dump full_repo -r 0: 3 --incremental&gt; demo0_3.dmp
 C: \ Subversion&gt; svnadmin dump full_repo -r 6 --incremental&gt; demo6.dmp
 C: \ Subversion&gt; svnadmin dump full_repo -r 8 --incremental&gt; demo8.dmp </pre><br></li><li>  We check that the received dumps do not contain occurrences of the string ‚Äúsvn: externals‚Äù.  It is important to carefully check it now, an accidental mistake at this stage can make life difficult in the future. </li></ol>  Next, we begin to create a modified repository.  First, we load into it (let's call it, for example, result_repo) the first 3 revisions: <br><br><pre>  C: \ Subversion&gt; svnadmin create result_repo
 C: \ Subversion&gt; svnadmin load result_repo &lt;demo0_3.dmp
</pre><br>  Now you need to fix the 4th commit.  For this we need to checkout our new repository.  To do this, you can use TortoiseSVN or continue working from the command line, for example: <br><br><pre>  C: \ Subversion&gt; svn co file: /// C: / Subversion / result_repo result_checkout </pre><br>  We check that everything goes according to our plan - go to the result_checkout folder and check that 3 revisions are loaded: <br><br><pre>  C: \ Subversion&gt; cd result_checkout
 C: \ Subversion \ result_checkout&gt; svn log -l 1
 -------------------------------------------------- ----------------------
 r3 |  shibaev |  2010-12-09 23:53:09 +0600 (Thu, 09 Dec 2010) |  1 line<font></font>
<font></font>
 Moved to trunk.
 -------------------------------------------------- ----------------------
</pre><br>  Now we have to execute the ‚Äúcorrect‚Äù 4th commit.  For this we need the state of the original repository on the 4th revision.  Therefore, we do a checkout for him, but right away for revision # 4: <br><br><pre> C: \ Subversion \ result_checkout&gt; cd .. C: \ Subversion&gt; svn co file: /// C: / Subversion / full_repo full_checkout -r 4 </pre><br>  The last command may take a bit longer, since files from the external repository will be downloaded. <br><br>  Check your watch.  Our working folder looks like this: <br><br><img src="https://habrastorage.org/storage/ec1ad3eb/d72b31b7/ec319818/c6a750de.png"><br><br>  And the log for full_checkout in TortoiseSVN is like this: <br><br><img src="https://habrastorage.org/storage/421e90d0/29cb10b8/79df9f20/d1bfeea9.png"><br><br>  In the log, we look at what has changed in the 4th revision.  And the following has changed - the folder ‚Äú3rd party‚Äù has been added to the trunk, but not simple, but with the svn: externals property set: <br><br><pre>  iTextSharp https://itextsharp.svn.sourceforge.net/svnroot/itextsharp/tags/iTextSharp_5_0_5/iTextSharp/text/xml/simpleparser/ </pre><br>  Therefore, in order to fix the 4th commit, we need to add the folder / trunk / 3rd party / iTextSharp to the repository to be fixed and commit: <ol><li>  Go to result_checkout / trunk </li><li>  Create a folder 3rd party </li><li>  Copy iTextSharp folder from full_checkout into it </li><li>  Remove the .svn subfolder from it </li><li>  Add (svn add) to the result_checkout repository folder 3rd party with all its contents </li><li>  Make a commit, keeping the original signature, for example: <br><pre>  C: \ Subversion \ result_checkout&gt; svn commit -m "Added external reference" </pre></li></ol>  Great, there is a first modified commit!  However, before we go further, let's think about what the error during such a process is fraught with (if, for example, we committed something wrong or rolled up the wrong dump).  Imagine that the repository is not 8 commits, but 2000, and the first time svn: externals are found in revision number 1200.  In this case, already loading the very first dump (revisions from 0 to 1199) and its checkout will take indecently a lot of time. <br><br>  The consequences of an error can be very unpleasant - we can easily spoil the recreated repository, and we have to start all over again.  Therefore, you must immediately attend to the problem of backup for intermediate results.  It is necessary to save at least the repository (result_repo), as well as checkout (result_checkout), if its recovery from scratch takes significant time. <br><br>  Let's organize a backup like this - we will compress the necessary folders into a zip-archive and copy to some folder.  To do this, use the archiver <a href="http://www.7-zip.org/">7-zip</a> .  Install it and add the path to 7z.exe in the PATH environment variable.  Now you can backup the intermediate states of the repository as follows: <br><br><pre>  C: \ Subversion&gt; 7z a backups \ result_repoX.zip result_repo, </pre>  where X is the revision number (for example, now in our case X == 4) <br><br>  After we have saved the intermediate result, it's time to move on - you need to manually commit commit # 5.  For this: <ol><li>  update full_checkout to revision number 5: <br><br><pre>  C: \ Subversion \ full_checkout&gt; svn up -r 5 </pre><br></li><li>  see what changes the fifth commit contains </li></ol>  In this case, the changes are minimal - the svn: externals property has been deleted for the ‚Äú3rd party‚Äù folder and created for the trunk folder.  The address of the external repository has not changed, as well as the folder into which you want to download files.  Therefore, for our new repository, no changes will be required, you just need to somehow commit.  To do this, you can create an empty Fictive file in the trunk, add it to SVN and make a commit.  It‚Äôs better not to change the caption signature (why it will be clear later) <br><br>  After the 5th commit is added, roll demo6.dmp: <br><br><pre>  C: \ Subversion&gt; svnadmin load result_repo &lt;demo6.dmp </pre><br>  We make a backup and proceed to the last serious point of our program - modification of commit number 7.  Update the full_checkout repository to the 7th revision and see the list of changes: <br><br><img src="https://habrastorage.org/storage/6fc2b4f3/2405c37b/f5ae07a2/f2fbca0c.png"><br><br>  The reason why this commit needs to be modified is not immediately clear, because no changes have been made to svn: externals.  The svn: ignore property was changed for the trunk folder, maybe this is the reason?  And there is.  The fact is that the SVN dump for revision 7 contains a full description of the properties of the trunk folder, along with svn: externals: <br><br><img src="https://habrastorage.org/storage/c395d369/2a5f2473/d9289f22/0229ba01.png"><br><br>  So, for the cause.  There are 2 ways to make the 7th commit: tricky and straightforward. <br><br>  The first is to take the dump for the 7th revision from the original repository, delete the mention of svn: externals from the properties of the trunk folder (open in a text editor, delete, subtract the number of bytes removed from the ‚ÄúProp-content-length‚Äù and ‚Äú Content-length. ‚ÄùOr use the command‚Äú svnadmin setrevprop ‚Äù) and roll this already correct one into the new repository.  In this case, this approach is the best solution. <br><br>  However, it is more interesting to consider the second method, since in most cases for real repositories you will have to use them.  This method is to try on the TortoiseSVN skin on yourself and make all changes to the 7th commit yourself. <br><br>  How accurately we will repeat the actions of the SVN client depends entirely on our patience and attentiveness.  It is not necessary to process each change individually, the main thing is to ensure that the sets of files in the source and the new repositories match.  The only thing is to move files / folders in SVN, it is desirable to repeat exactly in order not to lose the history of the object before moving.  By the way, at this stage you can also delete the Fictive file created earlier in the trunk. <br><br>  After all changes are made, it is worth checking that the affected projects are still compiled and the tests pass.  However, if you have complete confidence in your actions as a Subversion client, then you can not check. <br><br>  Next, commit our changes and exit the home straight.  Roll the last dump demo8.dmp.  We update both working copies of result_checkout and full_checkout to the latest revision and compare them.  If everything was done correctly, they should be completely identical in the file set. <br><br>  Get the dump for the modified repository: <br><br><pre>  C: \ Subversion&gt; svnadmin dump result_repo&gt; without_externals.dmp </pre><br>  This dump is completely free from external dependencies, but some changes are still required from us.  The fact is that for commits made manually, the fresh commit time is written in the dump, as well as the wrong user name (usually the same as the user name of the operating system in Windows).  It is necessary to correct. <br><br>  We open the original and new dumps in a text editor and consistently go through the modified revisions (4, 5, 7 in our example).  It will look something like this: <br><br><img src="https://habrastorage.org/storage/8ce6f9f6/b213b5da/e6bad920/b9b41f52.png"><br><br>  Now you need to carefully replace the corresponding dates in the new dump with the original ones.  To do this, you can again use the svnadmin utility and its ‚Äúsetrevprop‚Äù option, however, in my opinion, this can be done more quickly with your hands in a text editor. <br><br>  Replacing the date is a harmless operation, but replacing the author of a commit will require additional efforts.  As you can see, the values ‚Äã‚Äãof the ‚ÄúProp-content-length‚Äù and ‚ÄúContent-length‚Äù properties, as well as the number above the author of the commit for the original and updated dumps do not match.  This is due to the fact that the length of the author's name is different from the original.  Therefore, we first change the author of the commit, and then update the corresponding values.  Notepad ++ provides a convenient way to verify that everything was done correctly: <br><br><img src="https://habrastorage.org/storage/08a069be/6d637f16/b5a09494/d70c5c6a.png"><br><br>  After the properties of all modified commits are corrected, we can consider the stage of getting rid of svn: externals completed.  However, I recommend after this to check that the received dump is fully correctly loaded into the local repository: <br><br><pre>  C: \ Subversion&gt; svnadmin create test_repo
 C: \ Subversion&gt; svnadmin load test_repo &lt;without_externals.dmp </pre><br>  During this test, errors made during the modification of the repository can be automatically detected.  In this case, the loading of the dump will be interrupted at the location of the error, and we can find out the reasons.  This usually happens if we have corrupted the contents of a file or have not updated a file.  An error message will signal a checksum mismatch. <br><br><h3>  We transfer all commits to trunk </h3><br>  With the skills gained in the previous step, it is easy to transfer all commits to the trunk.  So, we have a repository without_externals.dmp, in which the first two commits are made to the repository root, and in the third commit, the folders trunk, tags, branches are created, and all files are transferred there. <br><br>  Action plan: <ol><li>  Create a clean repository, empty folders, tags, trunk folders in it. </li><li>  We split the dump without_externals.dmp into two - revisions from the 0th to the 2nd and revisions from the 4th to the 8th.  Kommit number 3 is thrown out! </li><li>  In the first dump (from 0 to 2 revisions) we add the prefix ‚Äútrunk /‚Äù to all paths in the file </li><li>  We consistently roll both dumps onto our new repository. </li><li>  We check that no errors were made, and make a full dump of the resulting repository. </li><li>  Modify the time and author for the first commit </li></ol>  Go.  Create a clean repository (final_repo folder), check it out (final_checkout).  Create 3 folders, add to the repository and commit: <br><br><pre>  C: \ Subversion&gt; svnadmin create final_repo
 C: \ Subversion&gt; svn co file: /// C: / Subversion / final_repo final_checkout
 C: \ Subversion&gt; mkdir branches tags trunk
 C: \ Subversion&gt; svn add branches tags trunk
 C: \ Subversion&gt; svn commit -m "Prepared repository structure" </pre><br>  We split the dump for the repository without external dependencies into two, to eliminate unnecessary commits. <br><br><pre>  C: \ Subversion&gt; svnadmin create without_externals_repo
 C: \ Subversion&gt; svnadmin load without_externals_repo &lt;without_externals.dmp
 C: \ Subversion&gt; svnadmin dump without_externals_repo -r 0: 2 --incremental&gt; final0_2.dmp
 C: \ Subversion&gt; svnadmin dump without_externals_repo -r 4: 8 --incremental&gt; final4_8.dmp </pre><br>  Open the final0_2.dmp dump and replace all the lines ‚Äú-path:‚Äù with ‚Äú-path: trunk /‚Äù.  It is important that we replace it exactly (not just the ‚ÄúNode-path:‚Äù), since the paths can be used in the ‚ÄúNode-path‚Äù and ‚ÄúNode-copyfrom-path‚Äù properties. <br><br><img src="https://habrastorage.org/storage/f6268a87/bd94fffd/aae1cce1/4b969ec4.png"><br><br>  We roll final0_2.dmp and final4_8.dmp to the new repository: <br><br><pre>  C: \ Subversion&gt; svnadmin load final_repo &lt;final0_2.dmp
 C: \ Subversion&gt; svnadmin load final_repo &lt;final4_8.dmp </pre><br>  To check the SVN log for final_checkout, all commits should operate on files only on the trunk.  Get the updated dump: <br><br><pre>  C: \ Subversion&gt; svnadmin dump final_repo&gt; final.dmp </pre><br>  We modify the time and the author for the 1st revision, as well as the time of the 0th revision.  We take as a basis the time of the 0th revision in without_externals.dmp, use it for the 0th revision in the new dump, then add a few seconds to it and set it for the 1st revision. <br>  We check that the dump received is in order by uploading it to the repository: <br><br><pre>  C: \ Subversion&gt; svnadmin create test_final_repo
 C: \ Subversion&gt; svnadmin load test_final_repo &lt;final.dmp </pre><br>  If during the download an error about checksum mismatch occurred, most likely the line ‚Äú-path:‚Äù was found somewhere inside the files and we accidentally replaced it (in real repositories we cannot see with our eyes all the places that need to be replaced, because lots of).  It happens that the line is found exactly in this form, as in the properties of the revision (for example, ‚ÄúNode-path: ...‚Äù), so tightening the replacement pattern does not help. <br><br>  In our example, the error does not occur, which means that we have obtained a repository that is fully usable for migration to Mercurial. <br><br><h3>  Let's sum up </h3><br>  We reviewed a number of techniques used to modify SVN repositories.  Highlights: <ol><li>  The svnadmin utility is the main tool.  Allows you to load a dump into the repository, get a dump for the desired revisions. </li><li>  We can alternate in the modified repository ‚Äúmanual‚Äù commits and loading of existing dumps.  A typical trick - we throw out unnecessary commits from the repository and replace (or just skip) them in the new repository. </li><li>  We make a backup for intermediate results as often as possible. </li><li>  For all typical operations (dump loading, dump creation, checkout, backup) it is convenient to use bat or bash scripts. </li><li>  When we modify the SVN dump in a text editor - do not forget to update the numeric values ‚Äã‚Äã- the size of the corresponding content in bytes. </li><li>  If our SVN dump is large (&gt; 700 MB), then there are problems with editing it, since most text editors for Windows cannot open it properly.  Notepad ++ is no exception.  I tried a lot of different options, only <a href="http://www.emeditor.com/">EmEditor</a> helped, which normally works even on a machine with a small amount of RAM. </li><li>  If, after modification, it is not possible to load the repository from the received dump - either they messed up with offsets, forgot to update a file, or corrupted the contents of the file. </li><li>  When you have to repeat changes in a commit yourself, it is useful to recursively delete all the .svn subfolders inside a folder.  To do this, you can use a script (for Windows) that recursively deletes all subfolders in the current directory: <br><br><pre>  FOR / F "tokens = *" %% G IN ('DIR / B / AD / S * .svn *') DO RMDIR / S / Q "%% G" </pre><br></li><li>  You should not modify the signatures for commits in any way, as this affects the number of bytes in the revision description in the dump.  Because of this, it will be slightly more difficult to update the name of the author of the commit, since you will have to take into account the difference in the length of the signature to the commit. </li></ol><br><h3>  Conclusion </h3><br>  The repository came to life.  Everything mixed up in his once light head - commits, logs, svnadmin.  The veil of anesthesia has not yet completely dissipated, but the Repository has already felt something inside it has changed. <br><br>  Opening the eyes, the repository first looked around - the room was spacious, but the interior was completely unfamiliar.  In place of the oak chiffonier with commits, a small shelf stood tall, and instead of boxes with tags on the wall a small sticker was attached with obscure lines like ‚Äú6fc1d7a7ae346b0a09be5647e94c1561764b8619‚Äù.  However, surprisingly, the general decoration of the repository room was pleasant, everything was decorated with feeling and according to Feng Shui. <br><br>  The repository did not even have time to get comfortable with how the doorbell rang.  "Hello!  Delivery of commits ‚Äù- the small man in a cap with an inscription‚Äú Mercurial ‚Äùrattled.  The repository did not have time to open his mouth, as the stranger quickly handed him two booklets with the words ‚Äúhg commit‚Äù on the cover and was like that. <br><br>  The repository remembered that he had already experienced this.  A long time ago, at the very beginning, a stranger dragged the very first ‚Äúsvn commit‚Äù into his apartment.  Is history now repeating itself?  The repository was captured with delight - very few people are lucky enough to return to childhood, along with all the accumulated experience and knowledge, and it seems that this is exactly what happened!  And in vain he stopped believing in Santa Claus - it is possible that this miracle is precisely his handiwork ... <br><br>  The repository did not know what lies ahead.  One thing he understood clearly - he began a new life - an interesting, unpredictable, with adventure.  Life on the planet Mercurial. </div><p>Source: <a href="https://habr.com/ru/post/109970/">https://habr.com/ru/post/109970/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../109962/index.html">Alt Linux may be installed in Russian schools</a></li>
<li><a href="../109963/index.html">DirectAccess in Windows 7. Part 2</a></li>
<li><a href="../109965/index.html">The opening of applications for the FOSS conference in Lviv (February 2011)</a></li>
<li><a href="../109968/index.html">Intellectual property infringement is rape</a></li>
<li><a href="../109969/index.html">Hi-Fi in the digital age. Part 2</a></li>
<li><a href="../109971/index.html">Java 7 for Mac OS X: The Future Behind OpenJDK</a></li>
<li><a href="../109972/index.html">‚ÄúThe Internet is an effective and economical channel for attracting customers‚Äù - a blow to the very liver</a></li>
<li><a href="../109974/index.html">Analysis of bot penetration through an exploit in older versions of phpmyadmin and recommendations for php hosting security settings</a></li>
<li><a href="../109975/index.html">HTML paragraphs in the texts of topics on the desktop and in the editor</a></li>
<li><a href="../109976/index.html">OpenWRT + Asus WL 520GU + Iptables. We separate LAN, DMZ and Internet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>