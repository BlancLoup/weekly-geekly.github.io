<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experiment: How to Disguise Using Tor to Bypass Locks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Internet censorship is becoming an increasingly important issue worldwide. This leads to an increase in the ‚Äúarms race‚Äù - government agencies and priv...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experiment: How to Disguise Using Tor to Bypass Locks</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habr.com/ru/company/infatica/blog/454002/"><img src="https://habrastorage.org/webt/1i/tc/ra/1itcraq3vz5jwwadxfrim-dhzt4.png"></a> <br><br>  Internet censorship is becoming an increasingly important issue worldwide.  This leads to an increase in the ‚Äúarms race‚Äù - government agencies and private corporations in different countries strive to block various content and struggle with the means of circumventing such restrictions, while developers and researchers strive to create effective tools to combat censorship. <br><br>  Scientists from Carnegie Mellon Universities, Stanford University and SRI International conducted an <a href="https://www.frankwang.org/files/papers/ccs2012.pdf">experiment</a> in which they developed a special service to mask the use of Tor, one of the most popular tools for bypassing locks.  We present you a story about the work done by researchers. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Tor against locks </h2><br>  Tor provides users anonymity by using special relays - that is, intermediate servers between the user and the site he needs.  Usually there are several relays between the user and the site, each of which can decipher only a small amount of data in the packet being sent - just enough to find out the next point in the chain and send it there.  As a result, even if the relay is added to the chain, controlled by hackers or censors, they will not be able to find out the destination and the destination of the traffic. <br><br>  As an anti-censorship tool, Tor works efficiently, but the censors can still block it completely.  Iran and China have carried out successful blocking campaigns.  They were able to identify Tor traffic by scanning TLS handshakes and other distinctive features of Tor. <br><br>  Subsequently, the developers managed to adapt the system to bypass the locks.  Censors responded by blocking HTTPS connections to multiple sites, including Tor.  Project developers have created a program obfsproxy, which additionally encrypts traffic.  This competition is ongoing. <br><br><h2>  The initial data of the experiment </h2><br>  The researchers decided to develop a tool that would disguise the use of Tor, to make its use possible even in regions where the system is completely blocked. <br><br><ul><li>  As initial assumptions, scientists have put forward the following: </li><li>  Censor controls the isolated internal network segment, which connects to the external uncensored Internet. </li><li>  The authorities involved in blocking control the entire network infrastructure within the censored network segment, but not software on end-user computers. </li><li>  The censor seeks to prevent users from accessing undesirable materials from its point of view; it is assumed that all such materials are located on servers outside the controlled network segment. </li><li>  Routers at the perimeter of this segment analyze the unencrypted data of all packets in order to block unwanted content and prevent the relevant packets from penetrating inside the perimeter. </li><li>  All Tor relays are located outside the perimeter. </li></ul><br><h2>  How it works </h2><br>  To mask the use of Tor, researchers have created a StegoTorus intrument.  Its main goal is to improve Tor‚Äôs ability to resist automated protocol analysis.  The tool is located between the client and the first relay in the chain, uses its own encryption protocol and steganography modules to make it difficult to identify Tor traffic. <br><br>  At the first step, a module called chopper comes into operation - it converts traffic into a sequence of blocks of different lengths, which are not sent in order. <br><br><img src="https://habrastorage.org/webt/0y/zz/gq/0yzzgqvtb9dn-tyqxap62thenpe.png"><br><br>  Data is encrypted using AES in GCM mode.  The block header contains a 32-bit sequence number, two length fields (d and p) ‚Äîthey indicate the amount of data, a special field F, and a 56-bit verification field, the value of which should be zero.  The minimum block length is 32 bytes, and the maximum is 217 + 32 bytes.  The length is controlled by steganography modules. <br><br>  When establishing a connection, the first few bytes of information are a handshake message, with its help the server understands whether it is dealing with an existing or a new connection.  If the connection belongs to a new link, the server responds with a handshake, and each of the exchange participants allocates session keys from it.  In addition, the system implements a mechanism for reking (rekeying) - it is similar to the allocation of the session key, but instead of handshake-messages are used blocks.  This mechanism changes the sequence number, but does not touch the link ID. <br><br>  After both data exchange participants have sent and received the fin block, the link is closed.  To protect against replay attacks or block delivery delays, both participants must remember the ID for how long after closing. <br><br>  Built-in steganography module hides Tor-traffic inside the p2p-protocol - by analogy with the work of Skype with secure VoIP-communications.  HTTP steganography module simulates unencrypted HTTP traffic.  The system mimics the real user with a regular browser. <br><br><h2>  Attack Resistance </h2><br>  In order to test how the proposed method increases the efficiency of Tor, the researchers developed two types of attacks. <br><br>  The first of these is to isolate Tor streams from TCP streams based on the fundamental characteristics of the Tor protocol ‚Äî this is the method used to block the Chinese power system.  The second attack is to study the already known Tor streams to extract information about which sites the user has visited. <br><br>  The researchers confirmed the effectiveness of the first type of attack against the "vanilla Tor" - for this they collected traces of visits to sites from the top 10 Alexa.com twenty times through the usual Tor, obfsproxy and StegoTorus with the HTTP-steganography module.  As a reference, CAIDA datasets with data on port 80 were used for comparison - almost certainly all of these are HTTP connections. <br><br>  The experiment showed that it is easy to calculate the usual Tor.  The Tor protocol is too specific and has a number of characteristics that are easy to calculate - for example, when using it, TCP connections last 20-30 seconds.  The Obfsproxy tool also almost does not hide these obvious moments.  StegoTorus, in turn, generates traffic that is much closer to the CAIDA reference. <br><br><img src="https://habrastorage.org/webt/j8/s3/xv/j8s3xv_6ucmnkojskxonpg1cnse.png"><br><br>  In the event of an attack, the researchers compared the likelihood of such disclosures in the case of ‚Äúvanilla Tor‚Äù and their StegoTorus solutions.  For evaluation, the <a href="http://fastml.com/what-you-wanted-to-know-about-auc/">AUC</a> (Area Under Curve) scale was used.  According to the results of the analysis, it turned out that in the case of normal Tor without additional protection, the probability of disclosing data on the visited sites is significantly higher. <br><br><img src="https://habrastorage.org/webt/lr/gm/vf/lrgmvflrsj5xhaunfcqgxv1tof0.png"><br><br><h2>  Conclusion </h2><br>  The story of the opposition of the authorities of countries introducing censorship on the Internet, and the developers of blocking bypass systems indicates that only comprehensive protection measures can be effective.  The use of only one tool cannot guarantee access to the necessary data and that information about the bypass of the lock will not be known to the censors. <br><br>  Therefore, when using any tools to ensure privacy and access to content, it is important not to forget that there are no ideal solutions and, if possible, to combine different methods to achieve the greatest efficiency. <br><br><h2>  Useful links and materials from <a href="https://infatica.io/">Infatica</a> : </h2><br><ul><li>  <a href="https://habr.com/ru/company/infatica/blog/453168/">Study: Creating a lock-resistant proxy service using game theory</a> </li><li>  <a href="https://habr.com/ru/company/infatica/blog/452438/">The story of the fight against censorship: how does the flash proxy method created by scientists from MIT and Stanford</a> </li><li>  <a href="https://habr.com/ru/company/infatica/blog/451832/">How to understand when a proxy is lying: verification of the physical locations of network proxies using an active geolocation algorithm</a> </li><li>  <a href="https://habr.com/ru/company/infatica/blog/452334/">How to disguise on the Internet: compare server and resident proxies</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/454002/">https://habr.com/ru/post/454002/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../453998/index.html">Aeroexpress: go to the depot</a></li>
<li><a href="../454/index.html">The cost of YouTube scientists figured out</a></li>
<li><a href="../4540/index.html">Mobile data center</a></li>
<li><a href="../45400/index.html">Cheap way to simulate getting a bullet in a person</a></li>
<li><a href="../454000/index.html">SMILE can not LASIK. About laser vision correction</a></li>
<li><a href="../454004/index.html">VMware NSX for the smallest. Part 6. Configuring VPN</a></li>
<li><a href="../454006/index.html">About IT without ties: Enhancement, retention and turnover in companies from the CIS and USA</a></li>
<li><a href="../45401/index.html">Mail.Ru agreed to pay for the video</a></li>
<li><a href="../454010/index.html">Higher and additional education in IT: the results of the research "My circle"</a></li>
<li><a href="../454012/index.html">The end of the era of repair devices. How Apple and Amazon Clean Up Old Electronics Dealers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>