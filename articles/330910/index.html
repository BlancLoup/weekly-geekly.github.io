<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Russian Minesweeper - multiplayer version of the game "Sapper"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear readers. I sincerely hope that among the readers of Habr there will be lovers of such a wonderful game as "Minesweeper" . 

 If I remember...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Russian Minesweeper - multiplayer version of the game "Sapper"</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/c48/21a/964/c4821a964cfa411cad0394eb1de48e1a.png" alt="image"><br><br>  Hello, dear readers.  I sincerely hope that among the readers of Habr there will be lovers of such a wonderful game as <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B0%25D0%25BF%25D1%2591%25D1%2580_(%25D0%25B8%25D0%25B3%25D1%2580%25D0%25B0)">"Minesweeper"</a> . <br><br>  If I remember correctly, for the first time this game appeared on the <a href="https://ru.wikipedia.org/wiki/Windows_3.x">Windows 3.1</a> operating system back in the 1994th year.  At that time, this game was positioned as a means for teaching how to use a computer mouse and, in general, the OS graphical interface.  She looked like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/web/3fa/11f/f57/3fa11ff57d424d91874e820d15a69db7.png" alt="image"></div><br><div class="spoiler">  <b class="spoiler_title">The principle of the game according to Wikipedia</b> <div class="spoiler_text">  A flat or volumetric playing field is divided into adjacent cells (squares, hexagons, cubes, etc.), some of which are ‚Äúmined‚Äù;  the number of ‚Äúmined‚Äù cells is known.  The goal of the game is to open all the cells that do not contain mines. <br>  The player opens the cells, trying not to open the cell with a mine.  Opening a cell with a mine, he loses.  Mines are placed after the first move, so it‚Äôs impossible to lose on the first move.  If there is no mine under the open cell, then a number appears in it, indicating how many cells adjacent to the just opened one are ‚Äúmined‚Äù (in each game variant the neighborhood is defined in its own way);  using these numbers, the player tries to calculate the location of the mines, but sometimes even in the middle and at the end of the game, some cells still have to be opened at random.  If there are no mines under the neighboring cells too, then a certain ‚Äúnon-mined‚Äù area opens up to cells that contain numbers.  The player can mark "mined" cells in order not to accidentally open them.  Having opened all the ‚Äúnon-mined‚Äù cells, the player wins. <br></div></div><br>  However, as time goes on, the popularity of the sapper falls, and I want to make a new life and colors in this game.  That is how the multiplayer version of the game, called ‚Äú <a href="https://rmsweeper.com/">Russian Minesweeper</a> ‚Äù, which is a browser-based online game, was born.  Interested please under the cat. <br><a name="habracut"></a><br><h2>  Game Characteristics </h2><br>  Of course, in order for a certain number of players to play this game together, the rules will have to be somehow modernized and generally modified.  However, the main rule is the essential principle to leave as in the original. <br><br>  Thus, in fact, a set of rules was developed to allow several players to play simultaneously on the same field. <br><br>  The basic rules of the game are as follows: <br><br><ol><li>  The goal of the game is to be the first to mark all mines with flags. </li><li>  Each player has their own (local) flags. </li><li>  Players have the same (global) mine field. </li><li>  Players take turns ( <i>however, the development of a "parallel" mode is underway</i> ). </li><li>  If a player clicks on a mine, he will lose, and his opponent will win accordingly. </li><li>  The time for the player's turn is limited (~ 25 sec.) - it is necessary to walk as quickly as possible. </li><li>  If a player misses a move three times in a row, he loses, and his opponent wins accordingly. </li><li>  If a player misses six turns for the entire game, he loses, and his opponent wins accordingly. </li><li>  Draw is impossible.  One of the players in any case will put the flags correctly faster than the other. </li><li>  The first move goes to a random player. </li><li>  The player can surrender at any point in the game. </li></ol><br>  A number of characteristics of the minefield for the game were also developed: <br><br><ol><li>  Undermining the opening of the first cell at the beginning of the game is impossible. </li><li>  Mines are evenly distributed over the playing field. </li><li>  Properties of the "void", opened with the first click: <br><ol><li>  Size A to B empty cells ( <b>0 min around</b> ). </li><li>  Emptiness should not be a line of open cells only on one side of the orientation. </li></ol></li><li>  The percentage of mine cells (the <i>type of regulator is real</i> ) and the size of the field are regulated in the application settings. </li></ol><br><br>  Thus, with the current configuration, with the first click, an ‚Äúemptiness‚Äù from <b>3</b> to <b>12</b> ‚Äúzero‚Äù cells opens, and a field of size <b>32x20</b> . <br><br>  I apologize for the huge number of lists, however, I can not fail to mention that the game apart from this has the following functionality: <br><br><ul><li>  Accord - the opening of more than one cell per turn.  This is possible in the case of a click (LMB) on a digit in a cell on the playing field, and the number of flags around adjacent cells is equal to the target digit. </li><li>  Helping the opponent - by the middle mouse button, or [clicking on the opponent's nickname from the top + click on the desired cell].  Displayed in green: <br><img src="https://habrastorage.org/web/933/76e/6e8/93376e6e86dc41cfb848ea55838f004b.png" alt="image"><br></li><li>  Chat - between players in real time. <br><img src="https://habrastorage.org/web/1ad/544/a43/1ad544a4305749bea515045681e3ef1a.png" alt="image"><br></li><li>  Nickname in the game. </li><li>  Sound in the game. </li></ul><br><h2>  Technology </h2><br>  A complete list of technologies used in product development is as follows: <br><br><ul><li>  <b>C # .NET + ASP .NET</b> - the foundation for a web server. </li><li>  <b>HTML5 / CSS3</b> - for the development of the client-side interface. </li><li>  <b>JavaScript</b> - for dynamic work of the client part. </li><li>  <b>JSON</b> - for serialization / deserialization of client-server packets. </li><li>  <b>WebSocket</b> - the protocol is used as a client-server communication method. </li><li>  <b>HTML Canvas</b> is a minefield drawing technology. </li><li>  <b>jQuery</b> - effective and fast interaction between HTML and JS. </li><li>  <b>JSON Newton</b> is a library for easy work with JSON. </li><li>  <b>Adobe Photoshop</b> - for drawing graphic interface elements. </li><li>  <b>GitHub</b> - as a convenient platform for monitoring project versions. </li><li>  <b>Microsoft Azure</b> - to host a web server on the Internet. </li><li>  <b>Yandex.Metrica</b> - statistics and analysis of player behavior. </li><li>  <b>CloudFlare</b> - as a CDN proxy / SSL / Anti DDoS. </li><li>  <b>Microsoft Visual Studio</b> - as the main development environment. </li><li>  <b>Sublime Text</b> - as a JavaScript development tool. </li><li>  <b>Microsoft IIS</b> - to deploy ASP.  NET </li></ul><br><img src="https://habrastorage.org/web/21b/7b2/6f8/21b7b26f8f0a41fa9b8b6110df73fff0.png" alt="image"><br><br>  The most problematic places in the project were the following: <br><br><ul><li>  Synchronize players with each other <br><br><ul><li>  <b>Problem</b> : how to quickly notify players about changes on the field? <br>  Options: long polling;  websockets;  cyclic polling;  etc </li><li>  <b>Solution</b> : use WebSocket </li></ul><br></li><li>  Drawing a minefield and other elements of the game <br><br><ul><li>  <b>Problem</b> : which tools will be optimal? <br>  Options: HTML table / div;  SVG;  HTML5 Canvas;  etc </li><li>  <b>Solution</b> : HTML5 Canvas + JavaScript </li></ul></li></ul><br><h2>  Interesting numbers </h2><br><ul><li>  <b>23</b> people <b>at</b> least participated in the testing. </li><li>  <b>183 298</b> clicks made across the field during testing. </li><li>  From the <b>119th</b> attempt, the minefield was completed. </li><li>  A <b>32x20 field</b> is optimal for the game ( <i>empirical observation</i> ). </li><li>  From <b>3</b> to <b>12</b> "zero" cells are best opened with the first click ( <i>empirical observation</i> ). </li></ul><br>  And also I attach a click-through map from Yandex. Metrics, using it you can make a number of interesting conclusions.  For example, it is obvious that the main area of ‚Äã‚Äã"battle" is the center of the field, and chat is popular. <br><br><img src="https://habrastorage.org/web/2e4/5a6/c50/2e45a6c502f742bd8df6bda4fcbf7062.png" alt="image"><br><br><h2>  Future plans </h2><br>  In the future, I want to finish the following functionality: <br><br><ul><li>  Implement a room on N players. </li><li>  The possibility of creating a "friendly room" (playing with a friend on the link) and a single mode. </li><li>  Registration of players and leaderboard. </li><li>  "Skill Balance" (so that players play with their peers by experience). </li><li>  Optimization of the application for mobile devices. </li><li>  Transition to more powerful servers to implement the application to the masses. </li><li>  Creating a bug tracker. </li><li>  The implementation of user-friendly feedback from the players. </li><li>  More detailed statistics on the use of the application. </li></ul><br><br><h2>  Conclusion </h2><br><img src="https://habrastorage.org/web/80a/488/2bc/80a4882bc0fb44aeaebe5d2bbcc3b9ea.png" alt="image"><br>  In conclusion I want to say the following - please be careful with the game server :) <br>  It is received free of charge by a subscription from Microsoft Azure and its capacity is extremely modest. <br>  I sincerely hope that after this article we will be able to enjoy this game together. <br>  I remind you that it is available at <a href="https://rmsweeper.com/">https://rmsweeper.com</a> , and there is also a <a href="https://vk.com/rmsweeper">community</a> on VKontakte. <br><br>  Thanks for attention, <br>  Peter was with you. </div><p>Source: <a href="https://habr.com/ru/post/330910/">https://habr.com/ru/post/330910/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330898/index.html">Service statistics collection with Flussonic</a></li>
<li><a href="../330900/index.html">Two years with Dart: how we write in a language that is ‚Äúburied‚Äù every year (part 2)</a></li>
<li><a href="../330902/index.html">Modern CMake: 10 tips for improving build scripts</a></li>
<li><a href="../330904/index.html">Speakers #ITsubbotnik - how technology will change the world in five years</a></li>
<li><a href="../330906/index.html">Daniel Story Comics</a></li>
<li><a href="../330914/index.html">Entertainment for intellectuals: playing ‚ÄúWhat? Where? It depends?</a></li>
<li><a href="../330916/index.html">Cloud Expo Asia Hong Kong - report from the largest IT exhibition in Asia</a></li>
<li><a href="../330918/index.html">Create faster and more optimized WordPress sites</a></li>
<li><a href="../330920/index.html">Spreadsheet over Google Maps</a></li>
<li><a href="../330922/index.html">Rich Notifications, utm-tags, webhook and other innovations PushAll</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>