<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bad advice from the creators of the Yandex.Maps API. How to make everything so bad</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If chasing you 
 Too many people 
 Question them in detail 
 What are they upset about? 
 Try to console everyone. 
 Give everyone advice, 
 But at th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bad advice from the creators of the Yandex.Maps API. How to make everything so bad</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  If chasing you <br>  Too many people <br>  Question them in detail <br>  What are they upset about? <br>  Try to console everyone. <br>  Give everyone advice, <br>  But at the same time reduce the speed <br>  Absolutely no good. <br>  G. Oster <br></blockquote><br><img src="https://habrastorage.org/getpro/habr/post_images/dc7/0a3/ed1/dc70a3ed137b57024315cc6328d7944d.png" width="414" height="500" align="left">  Today is a wonderful spring day.  And not only because it is spring and very soon someone will have to go to the country to dig potatoes.  And because today version 2.1 of the Yandex.Map API ceases to be a beta version and <a href="">becomes the main one</a> . <br><br>  We have completely updated the documentation for this event, added new examples to the sandbox and wrote this article.  This time we decided not to talk only about version 2.1, since we already <a href="http://habrahabr.ru/company/yandex/blog/196288/">talked</a> enough <a href="http://habrahabr.ru/company/yandex/blog/196288/">about it</a> during the beta launch.  Let's talk about using the Yandex.Maps API as a whole. <br><br>  API development is a very specific area of ‚Äã‚Äãprogramming.  API needs and skills are superimposed on any idea of ‚Äã‚Äãthe designer and developer.  The main feedback that we receive is messages from users <a href="http://clubs.ya.ru/mapsapi/">in our club</a> .  They send examples of sites with Yandex.Maps, bug reports and recommendations for improving our product.  We see how the API looks in combat conditions, and we shake on a mustache. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Some things often do wrong.  Today I want to talk about them.  All the tips you read are bad.  If you realize that you are following some of the recommendations in this article, it's okay - it's never too late to make your project a little better.  So, Irony mode ON. <br><a name="habracut"></a><br><h4>  Do not read the user agreement. </h4><br>  The centuries-old experience of using Windows has taught us something.  We are not even trying to read user agreements.  We boldly say: ‚ÄúI agree with everything‚Äù - and we think that karmic retribution will never overtake us, - ‚ÄúAre they fools, are you?  To go from my silicone valley to Gus Crystal, to forbid me to use my pirated Windows? ‚Äù <br>  If you use the Yandex.Map API, you should follow the same strategy. <br><br>  Because if you read the <a href="http://legal.yandex.ru/maps_api/">user agreement</a> , you can understand that it is illegal to implement your cool idea on the API.  For example, you will not be able to monitor the transport or use the API in the admin panel for 1C.  Or worse. <br><br>  Therefore, before starting work, give yourself an installation - if you have not read the agreement, you are not aware of the restrictions in principle and the world of cartography is limitless for you.  Of course, there is a minus in this - the API can be banned on your site, if a violation is detected.  But, as you know, problems need to be addressed as they are received, so we calmly move on. <br><br>  In general, the ideal option is to make a website, give it to the customer, get honestly earned wages and forget about it forever.  If the amount of the fee was large, it is recommended to change the place of residence.  Still, money spoils people. <br><br><h4>  Avoid reading any documentation. </h4><br>  As you know, good code does not need comments.  Similarly, a good API does not need documentation.  In general, any library or module should be intuitive, and the ideal API should not require programming skills.  Therefore, if you want to see examples in our sandbox, or read something about the capabilities of the API in the manual, or especially look into the directory (!) - Fight the rush.  The right strategy is to randomly choose one example (preferably the least detailed) and listen to the call of the heart ‚Äî it will tell you how to write. <br><br>  So, where it is not necessary to look before starting the development of the application: <br><ul><li>  <a href="">Developer's Guide</a> </li><li>  <a href="http://api.yandex.ru/maps/jsbox/2.1/">Sandbox examples</a> </li><li>  <a href="">Software Interface Reference</a> </li></ul><br><h4>  Don't think about knowing javascript </h4><br>  As you know, a JavaScript programmer is not a programmer, but a coder.  You should never be bewildered by this idea that the API you want to use is written in JavaScript.  Studying the constructions of this language (if it can be said at all), you risk forgetting something important from another language, get confused, and everything will go to ashes. <br><br>  The ideal option is to print JavaScript constructs using PHP.  I will give an example: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>($maps <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $map): <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> myPlacemark = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ymaps.Placemark([<span class="hljs-string"><span class="hljs-string">"&lt;?php echo $map['lantitude']; ?&gt;"</span></span> ,<span class="hljs-string"><span class="hljs-string">"&lt;?php echo $map['longitude']; ?&gt;"</span></span> ]); myMap.geoObjects.add(myPlacemark); <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">endforeach</span></span>;<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><br>  See how elegantly we managed without JavaScript! <br><br>  This approach will allow you to avoid many unpleasant consequences. <br><ul><li>  Your application will be slow enough to give the user time to think about the meaning of life. </li><li>  Your code will not require obfuscation, as it is rather confused from the very beginning. </li><li>  The page code will not be cached by the browser, but will be re-generated each time on the server. </li></ul><br>  Sadly, many programmers are still trying to go against the system.  They write code in clean, well-structured JavaScript.  Load data in batches at the same URL, clogging up the browser‚Äôs cache.  As a result, their applications run fast, users take it for granted and do not even look at other sites.  Think about the younger generation - stop making websites on which students spend their youth, free humanity from Internet addiction! <br><br>  <a href="http://javascript.ru/book/definitiveguide">A book</a> that is not worth reading if you decide to develop an application in JavaScript: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/902/ebd/d11/902ebdd11583caa05133a5770d87de62.jpg" alt="image"><br><br><h4>  Avoid code structuring </h4><br>  If you are planning to do something a little more complicated than a location map, you might think of the architecture of your site.  You might even want to select components in code, create classes, or break code into functions. <br><br>  This is not worth doing for several reasons: <br><ul><li>  Code broken into modules is difficult to read, because commands are not out of order. </li><li>  The development of architecture takes a lot of time. </li><li>  The application that uses the card, just unworthy of your time and attention.  Point. </li></ul><br>  Things to avoid when developing an application that uses maps: <br><ul><li>  No need to break the code into classes or functions. </li><li>  You should not use modular systems, you do not need any RequireJS. </li><li>  There is no need to separate the code and data into different files - if there are many files, they are easily confused. </li></ul><br>  Unfortunately, we have examples that, in spite of everything, use these approaches.  You can see and appreciate their absurdity in the <a href="http://api.yandex.ru/maps/jsbox/2.1/custom_module">sandbox</a> . <br><br><pre> <code class="hljs lua">//   . ymaps.modules.define(<span class="hljs-string"><span class="hljs-string">'CustomModule'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(provide)</span></span></span></span> { var CustomModule = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(defValue)</span></span></span></span> { this.field = defValue; }; provide(CustomModule); }); //  . ymaps.modules.<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>([<span class="hljs-string"><span class="hljs-string">'CustomModule'</span></span>]) .spread( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CustomModule)</span></span></span></span> { // ... }, this );</code> </pre><br><br>  In version 2.1, the API developers literally set traps by opening a modular system that is used in the API.  Now a weak-minded developer can not sustain and break his code into modules.  Take heart. <br><br>  Books that could prevent you from writing the perfect code were written by cunning people.  Their value system is turned upside down.  The enemy must be known in person, here are some of the potentially dangerous editions: <br><br> <a href="http://www.ozon.ru/context/detail/id/5508646/"><img src="https://habrastorage.org/getpro/habr/post_images/44c/e32/75f/44ce3275fb71f05471886104f4f7433d.jpg" alt="image" align="left" height="250"></a> <a href="http://www.ozon.ru/context/detail/id/20217137/"><img src="https://habrastorage.org/getpro/habr/post_images/1f2/9c1/145/1f29c11455e841fd4886e0ebf333b736.jpg" alt="image" align="left" height="250"></a> <a href="http://www.ozon.ru/context/detail/id/1308678/"><img src="https://habrastorage.org/getpro/habr/post_images/318/a55/35f/318a5535fa4ff8cebfaff0e61f13c397.jpg" alt="image" height="250"></a> <br><br><h4>  Prepare everything in advance </h4><br>  If you plan to show a large number of objects on the map, you need to decide at what point to download data from the server to the client.  The only correct way is to load the data immediately and preferably before loading the content of the page on which the map is shown.  Think yourself - if not now, when?  A person can turn off the Internet and then wept our marks.  Not all programmers understand this simple truth and are still trying to load data on demand. <br><br>  <a href="http://api.yandex.ru/maps/jsbox/2.1/balloon_ajax">Here is a sad example</a> showing how to load data into a balun tag on demand.  <a href="http://api.yandex.ru/maps/jsbox/2.1/request_map">Here is another sad example</a> showing how to create a map on demand.  And why only these developers do not uchudyat ... <br><br><h4>  Download with stock </h4><br>  The API is a lot of code, broken into modules and packages.  After developing your site, you need to solve another important question: what API code to connect to your site? <br><br>  There will not be superfluous to recall the cases when you sent a friend for a jar of cola, and he brought one.  Exactly the same rule works for loading code.  It is better to download the entire API code entirely - you never know what will come in handy for you.  In version 2.0, developers created packages that a user may accidentally start using if he copies the example from the sandbox without thinking. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/470/f78/3d0/470f783d044a37d3009e10f2eaf8838f.png" alt="image"><br><br>  How to avoid such errors?  When using version 2.0, any combination of loadable modules should be changed to package.full.  With this approach, the user will receive a lot more code, which is good. <br><br>  In version 2.1, developers, unfortunately, noticed that people do not lend themselves to provocations and load the API entirely.  Therefore, in version 2.1, all packages were canceled, and package.full is now broken into parts that are loaded asynchronously as needed. <br>  Instead of packages, you can now connect the single modules that you want to use.  Generally without any reserve. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca6/a78/362/ca6a783621a39c0700e214c039f4f25c.png" alt="image"><br><br>  Programming is becoming increasingly difficult. <br><br><h4>  Add controls </h4><br>  The user is always happy when there are buttons on the map.  Who doesn't like buttons?  Buttons love everything!  You can copy the example from the sandbox for version 2.0, which demonstrates the work of all available controls, and add the code to your site as is. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/285/a70/bee/285a70bee62abaeb4b42bb14b341a50c.png" width="350"><br><br>  An experienced user may notice that not all controls are represented on this map.  The careless programmers forgot to add a second scale control and search control to the map.  By the way, earlier this example contained two scale controls at once.  Therefore, we periodically find sites on which everything works as it should - on the map there is everything you need: a large control, and a small one.  Why it took to make the example worse remains a mystery to this day. <br><br>  Version 2.1 again tripped us.  It has fewer controls (the villains have cut a mini-map), they are installed on the map by default and on a small map they collapse to small sizes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4fc/71b/d4e/4fc71bd4e0a6c35f74b2448a35b60a94.png" width="350"><br><br>  See for yourself - the buttons are small, they are small.  The map is generally as naked!  In general, 2.1 is generally better not to use. <br><br><h4>  Show the user how weak his browser is. </h4><br>  If you need to show hundreds or even thousands of objects on the map, feel free to go into battle.  Create tags and bravely put them on the map in full.  With a sufficient number of tags, you will immediately show the user who is the boss in the world - a person or a browser.  Because with a large number of tags (100 for IE, 500 for all others), the browser will grumble and freeze for an indefinite period.  It serves him right. <br><br>  Developers trying to hide browser imperfections mask their flaws in very sophisticated ways: <br><ul><li>  Use clustering objects.  We have devoted a lot of <a href="http://api.yandex.ru/maps/jsbox/2.1/clusterer_create">examples</a> and even an entire <a href="http://habrahabr.ru/company/yandex/blog/207202">article to</a> this ingenious reception. </li><li>  Use active area technology.  Despite the complexity of development, it removes any restrictions on the number of displayed objects.  You can evaluate the cunning of the plan by reading <a href="">the developer</a> ‚Äôs <a href="">guide</a> or by looking at the sandboxed <a href="http://api.yandex.ru/maps/jsbox/2.1/hotspot_layer">example</a> . </li></ul><br><h4>  Do not try to save requests to the geocoder. </h4><br>  Very often, users are faced with what task.  They have a list of addresses of shops, pharmacies, attractions and more.  All these addresses need to be shown on the map.  The task is solved simply - you need to take all the addresses, send them to the client side, and simply geocode the addresses to the coordinates of the marks on the client. <br><br>  An unprepared reader may ask, ‚ÄúIs it correct that the set of tags is the same for us, and is it geocoded every time every time my application is called for each user again?‚Äù.  We answer this question directly: "Do not worry."  Yandex servers are sufficiently fault tolerant and will withstand everything.  The only catch is that with a large number of requests from your site you can exceed the limit of 25,000 requests for geocoding and your site will be banned.  But we have already covered this problem above, so we will not clutter our heads over trifles. <br><br>  Developers who have not read this article and do not believe in the power of Yandex servers have come up with geocoding data on the server.  And one of our employees even wrote a module for server geocoding on node.js.  This is a <a href="">section</a> in the developer‚Äôs manual. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9af/714/b71/9af714b71a6bfe552f205c84ac452611.png" alt="image"><br><br>  And it was not too lazy ... <br><br><h4>  Do not take the bread from the technical support service </h4><br>  At some point, you may feel a strange, overwhelming desire to communicate with the Yandex.Maps API technical support service.  This event should be approached seriously, and not anyhow. <br><br>  Try not to load technical support with unnecessary details.  An ideal bug report consists of five words - ‚Äúeverything is broken, nothing works.‚Äù  In general, our technical support service has already cut these five keywords into one long time ago - ‚Äúall-over-all are not working‚Äù.  And now we have a term in which both support and developers instantly understand the essence of things. <br><br>  Here is a good example of addressing a club: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/18b/838/69a/18b83869a228d37894993e0c3514fa38.png" width="350"><br><br>  The developer at the sight of this message instantly understands that all his work - ashes.  The universe emerged from the big bang, expands and is about to collapse.  Everything is lost.  Nothing works. <br><br>  Things to avoid when contacting tech support or club: <br><ul><li>  Detailed description of the problem. </li><li>  Bringing the code with which you can repeat the bug. </li><li>  Link to the page where the bug is played. </li></ul><br><br>  If you want to write about the problem to the developers club, you should not use the search, read the answer to the FAQ and try in some other way to find a solution to your problem.  Think - if everyone will find the answers to the questions themselves, what then will the technical support workers do? <br><br><h4>  Conclusion </h4><br>  That's all the bad advice we wanted to talk about.  In general, typical mistakes for you are tasks for us.  If developers step on the same rake while using the API, then this is to some extent our fault.  Perhaps we did not provide a case, wrote few examples, poorly done documentation, etc., etc.  In particular, in version 2.1 we tried to make it more difficult for a person to make a mistake than in version 2.0.  And work in this direction is even higher than the roof. <br><br>  Do not take our article to heart, improve your projects, send us good and angry wishes.  We will explain and tell you everything, even if everything is broken and nothing works =) </div><p>Source: <a href="https://habr.com/ru/post/221139/">https://habr.com/ru/post/221139/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221123/index.html">Why do we need reflection in C ++ 1y</a></li>
<li><a href="../221129/index.html">EMET, prevention of operation and non-obvious settings</a></li>
<li><a href="../221133/index.html">JSR 133 (Java Memory Model) FAQ (translation)</a></li>
<li><a href="../221135/index.html">Viewaide: now web service</a></li>
<li><a href="../221137/index.html">Genetic algorithms in faces</a></li>
<li><a href="../221141/index.html">Torrent Updater - OS X Open Source program for checking new versions of .torrent files on popular trackers</a></li>
<li><a href="../221143/index.html">New Dedicated Server: Acceptance and Verification</a></li>
<li><a href="../221145/index.html">PyCon Russia 2014 Program</a></li>
<li><a href="../221153/index.html">May 20-22, ICAgile Certified Professional training in St. Petersburg</a></li>
<li><a href="../221155/index.html">About participating in GamesJamGAMM: Project "Heartbeat"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>