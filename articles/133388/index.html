<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Poking around in the SIM-card: processor, memory, file system + I / O</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is difficult to find a person who does not know what a SIM card or Subscriber Identity Module is - a subscriber identification module. This piece o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Poking around in the SIM-card: processor, memory, file system + I / O</h1><div class="post__text post__text-html js-mediator-article">  It is difficult to find a person who does not know what a SIM card or Subscriber Identity Module is - a subscriber identification module.  This piece of plastic with gold contacts on one of the surfaces is the key to the services provided by the mobile operator.  And also inside the SIM card there is a specialized computer with a rather complex functionality. <br><br><h4>  SIM-card is the same processor card, but in profile </h4><br>  The SIM card is actually one of the varieties of a more general entity - the processor "smart card" (Smart Card). <br><br><img src="https://habrastorage.org/storage1/4a48ed32/8e640303/08a8bd77/be124647.jpg"><br>  <sup>The processor in the body of the SIM card</sup> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Such smart cards can be used for various purposes:</b> <br><ul><li>  Identification of mobile subscribers. </li><li>  Providing access to the encrypted content of various paid systems, such as television. </li><li>  Like bank cards </li><li>  For identification of the user who is granted access to corporate networks, etc. </li></ul><a name="habracut"></a>  In various mobile communication systems, subscriber identification modules are called differently.  The GSM used the name of the SIM - Subscriber Identity Module, which was fixed in everyday life.  The identification module used in UMTS (3G) networks is often called the USIM - Universal Subscriber Identity Module, which is actually not quite true!  The module itself is called the Universal Integrated Circuit Card (UICC) ‚Äîthe universal integrated circuit card (‚Äúsmart card‚Äù), and the USIM is an application (application) that runs inside the UICC and is used to identify and service a subscriber in the UMTS network (3GPP TR 21.905) . <br><br>  CDMA networks use the R-UIM - Removable User Identity Module to identify subscribers.  The word Removable (replaceable) underlines its new status, because earlier, in IS-95 networks (communication standard, on the basis of which CDMA networks worked in the USA, Russia and other countries, for example, SONET in Moscow), the subscriber identification elements were placed among electronic phone components.  It is obvious that the use of R-UIM greatly simplifies the replacement of the phone in case of its malfunction or the purchase of a new one, and allows you to use a phone of another standard in roaming. <br><br>  But then we will talk about the identification modules of subscribers used in GSM-UMTS networks, which by tradition we will call SIM or cards. <br><br><h4>  Pick your cards? </h4><br>  Currently, three formats of GSM-UMTS subscriber identification modules have been standardized. <br><br><img src="https://habrastorage.org/storage1/93e7405e/0ce21597/97b5ce6a/db5ce4c1.jpg"><br>  <sup>Three formats of subscriber identification modules GSM-UMTS</sup> <br><br>  ID-1 UICC - the very first option - has the size of a regular bank card.  Many people remember him in the models of the 90s - Motorola 8900, StarTAC and others.  Currently, the new models of mobile terminals are practically not used due to the large size. <br><br>  UICC plug-in is the most common format now.  Typically, such modules are broken out of ID-1 size cards by cuts made during manufacture. <br><br>  Mini-UICC is the format of cards that Apple began to use in iPhone 4, iPad, iPad 2. Now other mobile phone manufacturers and other device manufacturers intend to release models into which it will be necessary to insert modules of exactly this format.  Sometimes this format is called 3FF, or popularly "micro-SIM".  And these cards are usually broken out of an ID-1 card.  The reasons for the appearance of such a diversity are obvious - saving space inside the phone. <br><br>  A universal hole, which allows a user to break a module of both Plug-in and Mini-UICC from an ID-1 plastic card, for reliability reasons - when trying to break a Plug-in card, it is very easy to damage the remaining thin jumpers, after which the Plug-in card will not be held securely in the phone. <br><br><img src="https://habrastorage.org/storage1/3390ef36/092ddf3d/88c52fa7/85b0be41.jpg"><br>  <sup>ID-1 card with ‚Äúuniversal‚Äù slot for Plug-in and Mini-UICC</sup> <br><br>  And the shift of the SIM-card in the holder faces problems with the operation of the phone.  The minimum trouble - the phone simply does not feel the presence of the SIM and does not register on the network.  In the worst case, it can turn out as if the wires are entangled - voltage is not at the address and a short circuit with unpredictable consequences. <br><br>  Manufacturers of mobile terminals who are active, who are less determined, usually object to the use of adapters that are advertised for using Mini-UICC cards in phones designed for Plug-in cards.  The adapter is slightly thicker than the Plug-in module, and in addition, the slots at the junction of the card and the adapter can break contacts in the phone when installing the SIM, depriving the user of the chances of warranty repair. <br><br>  Some devices operating in the mobile network (navigators, devices for monitoring the location of vehicles, etc.) can identify subscribers' subscriber units simply in the form of microchips, but ordinary subscribers do not usually encounter such modules. <br><br><h4>  How many contacts should there be? </h4><br>  In everyday life there are modules with a different pattern of the contact pad and a different number of contacts.  Some manufacturers use the "corporate" drawing of the contact pad as their business card. <br><br>  The standards provided for 8 positions for sites through which modules are connected to mobile terminals, but not all of them are used.  Often there are cards with 6 contacts, and the rest of the metallized part is usually connected to the ‚Äúground‚Äù. <br><br><img src="https://habrastorage.org/storage1/558b2b87/0ddb1401/2c21e2db/a6edbc20.jpg"><br>  <sup>Cards with 6th and 8th contacts</sup> <br><br>  Used contacts: <br>  <b>C1</b> - Vcc - power; <br>  <b>C2</b> - Reset - contact control card; <br>  <b>C3</b> - CLK - Clock - clock frequency; <br>  <b>C5</b> - common ("land"); <br>  <b>C6</b> - Vpp - programming voltage that is used when recording service information <br>  <b>C7</b> - I / O - serial I / O line. <br><br>  The standards provide for the use of C4 and C8 contacts in the mode of information exchange with a mobile terminal in USB mode, which provides a higher speed of information transfer than through the usual I / O SIM interface. <br><br>  In practice, now the USB-interface mode is not actually used, since the equipment with this interface is practically not produced and is not ordered by consumers, so these contacts, even if they are on the card, are connected to ground.  Further work will be discussed through the line I / O interface. <br><br><h4>  Where did they put the computer? </h4><br>  By comparing the electronic contents of a SIM with a computer (especially with a pocket one), one can find many elements of the same function: <br><ul><li>  Processor (CPU); </li><li>  RAM (RAM, RAM); </li><li>  Permanent memory for storing the operating system ROM (ROM); </li><li>  Memory for storing user information; </li><li>  File system; </li><li>  I / O controller (I / O controller). </li></ul><br>  There are differences - something that is not in the module: <br><ul><li>  Interface elements with a person who are simply not needed by the module. </li><li>  Power supply (terminal power is used) </li><li>  Clock Generator (Likewise, terminal supply). </li></ul><br>  Additional information about the architecture and production of SIM can be found <a href="http://habrahabr.ru/blogs/telecom/93210/">here in this topic</a> . <br><br>  The amount of memory that can be used to store information in a SIM is different and gradually grows as technology develops.  A few years ago there was a flash of euphoria from the advent of technology that allows you to place gigabytes of information in a SIM.  It was then, after a heated discussion in the industry and two rounds of voting in the GSM Association, the USB standard was chosen for working with large amounts of information.  But then the euphoria subsided, and now there are not so many mobile terminals on the market that can work with such SIMs, and the SIMs themselves with a gigabyte memory do not enjoy much demand from operators. <br><br><h4>  Can I store HD movies on SIM cards? </h4><br>  Why do we need large amounts of memory SIM-cards and how much memory is really needed? <br>  SIM memory is used for several purposes: <br><ul><li> <b>Storing information that is vital for the phone to work</b> with this SIM in a mobile network.  For example, this is IMSI - International Mobile Subscriber Identity - a sequence of numbers that not only identifies a particular SIM and its owner, but also indicates which operator from which country it was released.  This information helps in roaming to quickly figure out where to find out what services you can provide with the phone with this card, because the first three digits of the IMSI are the country code, and the next two digits are the network code (in the Americas, the network code consists of three numbers).  This Ki is the secret key that makes it possible for the network to make sure that it really is its own SIM card, and not some fraudster uses someone else's IMSI to gain access to services.  Plus files to store other service information. </li><li>  <b>Storage of user information</b> .  Typically, the cards are located phone book received SMS-ki.  In maps for the UMTS network, the phone book may have substantially more functionality than just a list of names and their corresponding phone numbers.  You can attach several numbers to a name, add an email address and other information.  However, due to the development of the same functions in the phones themselves, these SIM capabilities are practically not used. </li><li>  <b>Placement of application files</b> that can be executed in a Java virtual machine embedded in a SIM and provide certain services.  If the operator actively uses services based on applications running in the SIM card, then this part may occupy the most significant part of the card's memory. </li></ul><br>  It is also obvious that the increase in the amount of memory increases the cost of the SIM, and therefore now the operators, most often, try to limit themselves to the volumes minimally necessary to accommodate the necessary information. <br><br><h4>  Who drives who? </h4><br>  Besides the fact that the phone or another mobile terminal provides the SIM card with power and a clock signal, it is fully responsible for the exchange of information between devices - the phone always acts as the master, and the card is always the slave. <br><br>  The phone sends commands / requests to the SIM, and the SIM only responds to them, accompanying the answers with information on the status of the answer. <br><br>  In the status information, the card can confirm that the command was completed successfully, ask for additional time to prepare an answer, report errors of various types, or report that it has special information for the phone that it can receive by sending a special request to the following command to select . <br><br>  This mechanism for transferring information from a card to a telephone is usually called a SIM (or Card) Application Toolkit, STK.  It is used to implement various services, which are based on application programs (usually written in JavaCE - Java Card Edition), executed within the SIM.  In the menu of phones, with installed SIM-cards of the main operators, you can find items and whole menu trees, formed on the basis of information provided by applications working in SIM-cards. <br><br>  Real-time services are based on the same technology, for example, constantly providing information about the current balance. <br><br>  It is possible to organize roaming for small companies using the switching of two IMSIs in one map - one that corresponds to its network, and the other - provided by ‚Äúborrowing‚Äù by another operator - the ‚Äúbig brother‚Äù.  For example, Beeline networks operating in the CIS countries use the Dual IMSI mechanism to provide roaming services to their subscribers.  One IMSI of its network and another IMSI corresponding to the Russian Beeline network are registered in their SIM-cards.  In the Russian Beeline network, these IMSIs are reserved in the HLR to provide roaming services to subsidiaries and channels of communication with them are organized.  A Beeline subscriber from a ‚Äúsubsidiary‚Äù company, being, for example, in a European country, with the help of the STK menu switches the SIM operation mode to roaming.  As a result, a phone with such a SIM card is presented to the roaming network as belonging to a subscriber of the Russian Beeline network.  Then everything happens, as usual, only the Russian Beeline network organizes the transfer of information on behalf of the "affiliated" network. <br><br>  Even a web server can be organized inside the SIM!  So, if someone is confused by the ‚Äúslave position‚Äù of the SIM, he may well consider it as a server. <br><br><h4>  How does it turn on and why does the book load slowly? </h4><br>  After switching on and starting the operating system, the phone powers on the Vcc power supply to the SIM.  The standards provide for three SIM supply voltage ratings - 5V, 3V and 1.8V. <br>  Previously issued cards that can work only at a voltage of 5V.  After the appearance of phones that applied no more than 3V to the card, these old SIMs were gradually replaced by new ones capable of operating from 3V, which also withstand work in phones providing 5V. <br><br>  Since the phones that provide SIM cards with a voltage of only 1.8V have not yet been encountered, modern SIM cards do not create compatibility problems due to supply voltages. <br><br>  After the power supply is applied to the phone, a clock signal is given, and after establishing a stable mode, the voltage on the Reset pin is raised.  This serves as a signal for the SIM card to start working with it, to which it responds with a sequence of bytes called ATR (Answer To Reset). <br><br>  The ATR bytes contain basic information about the card‚Äôs capabilities and supported communication protocols.  In particular, he can tell the phone possible options for accelerating the exchange of information through the interface by increasing the clock frequency and speed of information transfer. <br><br>  After reading the information from the ATR, the phone can run the PPS (Protocol and Parameter Selection) procedure to negotiate the mode of exchanging phone information with the card.  If the phone is not able to find an option that is acceptable both for it and for SIM, then communication with the card will continue in the default mode (at a speed of 9600 bps). <br><br>  In such cases, subscribers often complain that the phonebook is read from the SIM card to the phone for too long, for some reason, reproaching the operator who issued the SIM card. <br><br><h4>  "Hello, who are you?" </h4><br>  In the process of turning on the SIM card and the mobile terminal (telephone) exchange ‚Äúbusiness cards‚Äù.  The phone reads from the SIM file containing the SST - SIM Service Table - in a certain way encoded information about the STK functions that the SIM is able to perform.  In turn, the phone sends to the SIM-card TERMINAL PROFILE - in a certain way coded information about what functions of communication with the SIM it can support.  As a result, both parties receive information about the capabilities of the partner and can interact correctly when implementing services based on STK. <br><br><h4>  File system and security </h4><br>  SIM has a multi-level hierarchical file structure with access control. <br>  Access to files is governed by the need for the user to first present access codes of various types. <br><br>  Some of these access codes are well known - this is Personal Identification Numbers - PIN (aka PIN1) and PIN2.  Other codes are used for administrative access to service files. <br><br>  What makes such a distinction?  Activated PIN request allows you to protect money on the personal account associated with the SIM card from unauthorized use by unauthorized persons. <br><br>  Another important security technique is, for example, the inability to read information from some files, for example, reading the key Ki, which is used in various cryptographic algorithms for authenticating the subscriber and generating traffic encryption keys. <br><br><h4>  Why is it helpful to read the instructions? </h4><br>  Several years ago, at a round table on the prospects of smartphones, organized by one of the manufacturers, one of the participants complained to me that Beeline lacks a service that is very useful for parents.  He wanted parents to limit the possibility for their children to call only on a specific set of phone numbers - home, parents, grandparents, and the child should not call the other numbers. <br><br>  What was his surprise when I showed him the work of the FDN function - Fixed Dialing Numbers, which is implemented by the joint actions of the phone and the SIM card.  Allowed numbers using the phone are simply recorded in a specific SIM card file, and access to change this list is blocked using PIN2.  After that, a phone with such a SIM will refuse to call numbers that are not listed in the FDN list. <br><br>  However, it should be noted that not all phones support the operation of this service. <br><br><h4>  Wash your hands before eating </h4><br>  The skin of the fingers is coated with organic fatty acids, which on contact cause corrosion of metal parts.  Small details - this is exactly about the contacts of the SIM-card. <br>  The photo shows a laser pointer, the surface of which, after a rather rare use, has lost several layers of metallic coating - chrome plating and copper plating just because of these fatty acids!  As you know, ‚Äúradio engineering is the science of contacts,‚Äù and SIM has a lot of them! <br><br><img src="https://habrastorage.org/storage1/bad612e0/f32ab7e1/d5a28b76/6c113edc.jpg"><br>  <sup>Laser pointer affected by fatty acids on fingers</sup> <br><br>  Such a fate should not grasp the contacts of the SIM-card, and for this you need to protect the contacts of the SIM from contamination by all means, and try not to touch them with your fingers! <br><br>  If a problem with contacts between the phone and the SIM has arisen, then a neat cleaning of the contacts with a soft eraser can help.  Just do not need after the cleaning operation to remove the crumbs from the contacts with your fingers, otherwise all the problems will begin again!  It is better to simply blow them away or gently rinse with alcohol. <br><br><h4>  To change or not to change? </h4><br>  Once a subscriber came to the Beeline office, who was sent to change the SIM card from the phone repair service, because his completely new phone spontaneously turned off during a call, checking the balance, sending an SMS. <br><br>  I had to explain to him that turning off the phone has no connection with the health of the SIM.  Using an eraser, I carefully cleaned the contacts on the battery and in the phone, after which the phone began to work normally.  Along the way, I gave the subscriber a small lecture on hygiene. <br><br>  Of course, the situation is not so obvious in all cases, and it is not easy to determine who is to blame - the phone or the SIM that the services do not work, because their communication is almost intimate.  It is especially important to understand the causes of conflicts when developing new services using STK or when detecting problems of incompatibility of SIM with some models of phones or other mobile terminals. <br><br>  In such cases, the analyzer of information exchange protocols on the interface of the SIM terminal provides an invaluable service: <br><br><img src="https://habrastorage.org/storage1/b26570aa/8a18e738/2b92def5/0b6b8abd.jpg"><br>  <sup>Analyzer of communication protocols between the SIM and the mobile terminal.</sup> <br><br>  Instead of a SIM card, a special probe is inserted into the terminal, and the SIM is connected via a flexible loop.  During operation, all information about events occurring on the interface is recorded in the memory of the computer connected to the analyzer. <br><br>  Comparison of the collected information with the requirements of the standards allows unambiguously and convincingly to establish the side guilty of the conflict. <br><br>  Of course, the material touched upon only some of the features of SIM-cards and their work in phones, but if there is an interest in this topic, just ask questions, I will answer in detail. <br><br>  PS Today, Boomboorum wrote another review of <a href="http://habrahabr.ru/blogs/office/133358/">our office</a> . </div><p>Source: <a href="https://habr.com/ru/post/133388/">https://habr.com/ru/post/133388/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../133381/index.html">About the opera and its standard template for viewing FTP</a></li>
<li><a href="../133383/index.html">FPGA programming. Smoothly changing the brightness of the LEDs on the Spartan-3E Starter Kit using PWM</a></li>
<li><a href="../133384/index.html">Google added 4shared, The Pirate Bay and others to the list of pirated words</a></li>
<li><a href="../133385/index.html">Tester conferences in Europe or an excuse for poking?</a></li>
<li><a href="../133387/index.html">Do you know how much, or mass launch of servers with minimum labor costs</a></li>
<li><a href="../133389/index.html">Revealed the secret of the power elixir from "Druid Panoraomix" - Gars Telecom Marketing Director</a></li>
<li><a href="../133391/index.html">A zombie farm</a></li>
<li><a href="../133392/index.html">IE developers opposed Google Dart</a></li>
<li><a href="../133393/index.html">New Guide: Publishing Web Projects with Visual Studio 2010</a></li>
<li><a href="../133394/index.html">The idea of ‚Äã‚Äãthe iPad application ‚ÄúUkraine in photos‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>