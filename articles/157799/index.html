<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ping-flooding attack: what remains "off-screen" or about the benefits of meticulousness</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Actually, I open a topic based on habrahabr.ru/post/157207 
 The topic is interesting, but some simple but important points remained behind the scenes...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ping-flooding attack: what remains "off-screen" or about the benefits of meticulousness</h1><div class="post__text post__text-html js-mediator-article">  Actually, I open a topic based on <a href="http://habrahabr.ru/post/157207/">habrahabr.ru/post/157207</a> <br>  The topic is interesting, but some simple but important points remained behind the scenes.  It's a pity.  Who cares what - please. <br><br><a name="habracut"></a><br><br>  If we discard the trivial analysis of icmp, then the most interesting part of the material will be the statement (confirmed by screenshots) that some target (Windows, I suppose) systems respond to icmp-echo requests in which the destination ip corresponds to the ip of the pinged system, but the destination mac is broadcast.  True, there is a certain inconsistency between the screenshot and the text, but we will consider it a typo and focus on the picture. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The picture is really interesting, especially when you consider that this should not be.  Once, in times of pampering with such things through nemesis, I clearly learned that for Win this trick does not work.  It was all the more surprising - well, the screenshots author didn‚Äôt fake it. <br><br>  I decided to repeat the experiment.  The simplest method without using any utilities to generate arbitrary packages from the Nix console: <br>  arp -s ip ff: ff: ff: ff: ff: ff <br>  ping ip <br><br>  The ip sought is not responding.  We check by tcpdump that the packets of the desired type leave the interface. <br>  Immediately a question arose.  Or maybe it's the victim system?  In my case, it was Win XP SP3.  The author of the topic confirmed that he, too ... It became interesting.  Found the system available to me via RDP.  I made sure that icmp requests with broadcast dst mac reach it.  No answer. <br>  I repeated the experiment on Win 2008 - the result is positive.  Some theories began to move in my head (they were voiced in comments to the topic), but everything turned out to be much simpler. <br>  Well, of course it's OH! <br><br>  <i>Next Generation TCP / IP Stack.</i> <br>  <a href="http://technet.microsoft.com/en-us/network/bb545475.aspx">technet.microsoft.com/en-us/network/bb545475.aspx</a> <br><br>  Indeed, what was not true for XP became a reality for Vista 7,2008 <br><br>  Google helped find the experimenters who were surprised by the ‚Äúsurprise‚Äù. <br><br>  <a href="http://www.packetstan.com/2010/08/windows-lan-addressing-validation-and.html">www.packetstan.com/2010/08/windows-lan-addressing-validation-and.html</a> <br>  ... <br>  Response to the broadcasting of the Internet. <br><br>  <a href="http://blog.taddong.com/2010/09/more-wpa2-hole-196-reflections-and.html">blog.taddong.com/2010/09/more-wpa2-hole-196-reflections-and.html</a> <br><br>  Josh mentioned <i>Windows Vista and 7 accept LAN broadcast addresses sent to unicast IP addresses</i> .  I confirmed that Windows Vista SP2 under VMware Fusion 3.1.1 (LAN) in fact does not accept it.  <i>Windows Vista and 7 accept TCP broadcast traffic.</i>  New TCP / IP stack implements can always include hidden gifts! <br><br>  <i>Windows XP SP3 (WLAN) doesn‚Äôt need to be used, broadcast or multicast.</i>  So, does this mean XP is " <i>more secure</i> regarding Hole 196" than Vista &amp; 7?  ;) <br><br>  What-what is written here?  Will TCP with a broadcasted mac-ohm destination also work?  Check it out ... Again we manually set up the arp bundle, telnet to the open port 80 of the server under Win 2008 and yes.  Works. <br><br>  23: 53: 53.179517 00: 0c: 29: 22: 71: 6c&gt; <b>ff: ff: ff: ff: ff: ff</b> , ethertype IPv4 (0x0800), length 74: 10.xx.4.80.35261&gt; 10.xx. 4.20.80: Flags [S], seq 759040421, win 5840, options [mss 1460, sackOK, TS val 2823711033 ecr 0, nop, wscale 7], length 0 <br>  23: 53: 53.180123 00: 0c: 29: 81: 23: 05&gt; 00: 0c: 29: 22: 71: 6c, ethertype IPv4 (0x0800), length 74: 10.xx.4.20.80&gt; 10.xx. 4.80.35261: Flags [S.], seq 1483497967, ack 759040422, win 8192, options [mss 1460, nop, wscale 8, sackOK, TS val 64239843 ecr 2823711033], length 0 <br>  23: 53: 53.180405 00: 0c: 29: 22: 71: 6c&gt; <b>ff: ff: ff: ff: ff: ff,</b> ethertype IPv4 (0x0800), length 66: 10.xx.4.80.35261&gt; 10.xx. 4.20.80: Flags [.], Ack 1, win 46, options [nop, nop, TS val 2823711033 ecr 64239843], length 0 <br><br>  On the other hand ... Well, it works, so what?  The same experiment with the linux system had, by the way, the same result :) <br><br>  But the white spots became a little less.  To whom as, but for me it is not bad.  And yes, thanks to the author of the topic that motivated the experiment. </div><p>Source: <a href="https://habr.com/ru/post/157799/">https://habr.com/ru/post/157799/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../157783/index.html">Access to variables Thread local storage (TLS) of any thread</a></li>
<li><a href="../157785/index.html">We bypass protection management-plane</a></li>
<li><a href="../157787/index.html">Big Three M2M Solutions</a></li>
<li><a href="../157791/index.html">Adobe Edge Animation, Chrome 23 and Brain Promotions Post</a></li>
<li><a href="../157793/index.html">With a flick of the wrist, the tablet turns into ... an additional monitor</a></li>
<li><a href="../157801/index.html">Four African girls invented a urine generator</a></li>
<li><a href="../157803/index.html">Ogre3D graphics engine now supports Windows Phone 8!</a></li>
<li><a href="../157807/index.html">Connecting to a VPN using the Cisco VPN Client under Windows 8 x64 (almost solved)</a></li>
<li><a href="../157813/index.html">The court ordered Apple to pay $ 368.2 million company VirnetX</a></li>
<li><a href="../157817/index.html">Adaptive Background Images</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>