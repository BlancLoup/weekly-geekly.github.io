<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Live video for the site</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I and my colleagues are often asked the question "How to realize the broadcasting of live video from the camera on the web site?". Many who ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Live video for the site</h1><div class="post__text post__text-html js-mediator-article"> Recently, I and my colleagues are often asked the question "How to realize the broadcasting of live video from the camera on the web site?".  Many who ask this question are mistaken, believing that this can only be done with the help of IP cameras.  No, this is done on the basis of inexpensive USB-cameras.  Specialists who know ‚Äúhow‚Äù often have another misconception - why pay for an expensive IP camera when everything can be implemented on USB cameras for $ 20-30?  And let's say the camera needs to be installed on the street, at the other end of the building, 70m long.  Do you know a lot of USB cameras with an IP66 standard case and a working temperature of -20 ¬∞ C?  How long can a USB cable be?  According to the Wiki, the <a href="http://ru.wikipedia.org/wiki/USB">maximum length of the USB cable (in the screen) should not exceed 5m</a> .  And how to connect the camera at a distance of 70m (and this is straight, without taking into account the conduit bends)?  It is possible to install a usb-hub with power every 5m.  And how much money will the cost of usb extenders and active usb-hubs with catering for them draw?  You must admit that this will not even pay for one IP camera.  Someone will say "I will put, in the immediate vicinity of the camera, a computer in ITX performance and there are no problems."  Yes, this is an option, but in the end the cost of a ‚Äúcomp + USB camera‚Äù will, at best, be equal to the cost of an IP camera.  And the service, and uninterrupted power?  And if the cameras are separated by hundreds of meters, or even kilometers, such as the beaches of the Crimea?  The IP camera definitely wins! <br><a name="habracut"></a><br>  How better to "throw out" the image of the camera on the site?  You can of course give the image to the user directly from the IP camera.  But IP-cameras are not designed for a large number of simultaneous connections and most of them after the 5-6th connection will begin to "die", up to a complete freeze.  And if you want to look at the beach and the sea dozens or even hundreds?  The problem is solved with the help of an intermediary media server.  There are a lot of articles describing such a solution, for example, ‚Äú <a href="http://habrahabr.ru/post/78677/">Streaming video using ffserver &amp; ffmpeg</a> ‚Äù.  True, this article describes a solution for a USB camera, but the principle of operation is also suitable for IP cameras.  But such an approach requires good knowledge in Linux, and most importantly - a high-performance, respectively, quite expensive processor.  A simple Intel Atom with the task of transcoding real-time video from M-JPEG to FLV, MPEG4 or H.264 is unlikely to cope.  And giving an image to the site in the M-JPEG codec is a stream of <a href="http://dlink.ua/sites/default/files/calculator/index.html">~ 3-4 Mbit / s</a> with a 640x480 picture with 15 frames / s.  What is the outgoing bandwidth required if you watch dozens of users?  Yes, and "pump" these same <a href="http://dlink.ua/sites/default/files/calculator/index.html">~ 3-4 Mbit / s,</a> not every user is able to. <br>  There is a simple add-on solution for Add-On for D-Link DNS-325 &amp; DNS-345 network drives called Webcam.  All the ‚Äútools‚Äù in it are available, it will suffice to perform the simplest actions, which I will describe below.  I checked only on D-Link IP cameras, but in theory it should work with others. <br>  Start by installing Add-On.  Take here <a href="http://dlink.ua/dns">http://dlink.ua/dns</a> or here <a href="http://dlink.vtverdohleb.org.ua/Add-On/">http://dlink.vtverdohleb.org.ua/Add-On/</a> . <br>  Go to the ‚ÄúManagement / Application Management / Add Ons‚Äù section and install the Add-On corresponding to your drive model. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/413/cc1/47d/413cc147d06393efaaa009d2f75fbad3.jpg" alt="image"><br><br>  Messages "Third-party Add-On ..." do not worry, click Yes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/891/145/33b/89114533bbecc19d5c6077cad32128e8.jpg" alt="image"><br><br>  After the installation is complete, start the Add-On button with the Start button, go to the Applications section and open the Webcam web interface. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f4c/04d/ae0/f4c04dae0d83b7807e6d67ff8cadce00.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d89/55e/bde/d8955ebde346033eda11b0956dbcc8ab.jpg" alt="image"><br><br>  But first you need to configure the IP camera accordingly.  For example, let me give you the setting of the D-Link DCS-2310L IP camera.  Go to the ‚ÄúSetup / Audio and Video‚Äù section and add a new one or change an existing profile. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e53/510/47e/e5351047e777497dd2a22fd2107805b7.jpg" alt="image"><br><br>  The main requirement is only MPEG4 codec, it will not work with others.  The remaining settings are at your own discretion, but I would recommend the following: <br>  1. "Frame size &amp; View window area" no more than 800x600.  It will work, but the speed of the video stream will be too big for the site. <br>  2. "Maximum frame rate" not more than 15 frames / s, and preferably 4-7 frames / s.  The reason is the same as in paragraph 1. <br>  3. ‚ÄúVideo quality‚Äù, for this model of camera, it is better to choose ‚ÄúConstant bit rate‚Äù 1M, or less.  This indicator is better to pick up on the visual perception of the resulting image.  But the smaller the better. <br>  Next, go to the ‚ÄúSetup / Network Setup‚Äù section and remember the name ‚ÄúRTSP / Access name for stream‚Äù for the profile you have configured.  In my case, profile 2 corresponds to "live2.sdp". <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fb5/980/bff/fb5980bffacd2acc10d842d2f5db7408.jpg" alt="image"><br><br>  ‚ÄúAuthentication &amp; RTSP port‚Äù leave unchanged. <br>  Let's go back to setting up webcam.  In the "Cam IP" field, enter the IP address of your camera, in the "RTSP name" field, the corresponding "RTSP / Access name for stream".  Enable the ‚ÄúAudio‚Äù checkbox if you want to transfer video with sound.  But I would not recommend ‚ÄúAudio‚Äù, as it will put a significant load on the processor of the drive, and for the site the main picture, not the sound.  Click ‚ÄúSubmit‚Äù.  If, for some reason, the upload fails, a message is displayed to the right of ‚ÄúCamera 1‚Äù, for example, ‚ÄúError: Bad IP or RTSP URL‚Äù.  If everything went well, you will see the following: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/055/136/8e7/0551368e7dab018130c5f05b357393b7.jpg" alt="image"><br><br>  If you need to change the IP camera, RTSP name or image resolution, you will need to click "Delete" and enter the parameters again. <br>  If everything is OK, start the broadcast with the "Start" button. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e35/f81/239/e35f8123912a5419a841751d18cdfaf4.jpg" alt="image"><br><br>  Broadcast went, now you need to add html-code access to the video on the page of your site.  Click ‚ÄúSite code‚Äù. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/336/067/949/3360679496be1af23397fefad46b71b8.jpg" alt="image"><br><br>  It is assumed that your drive is inside the LAN and is not accessible from the outside.  Therefore, the html-code substitutes the external IP-address of your router.  Accordingly, in order to see the image from the Internet, you need to do a port forwarding (Virtual Server or Port Forwarding) on ‚Äã‚Äãthe router.  TCP protocol, port 8090. I will not tell you how to set up the forwarding, since there is no universal instruction, each manufacturer has its own configuration interface.  For example, so <a href="http://dlink.ru/ru/faq/246/1156.html">http://dlink.ru/ru/faq/246/1156.html</a> <br>  As a result, we get this picture <br><br><img src="https://habrastorage.org/getpro/habr/post_images/40b/686/04c/40b68604c85287e598af7875996ebef1.jpg" alt="image"><br><br>  How it really works can be seen on the demo page. <br>  <a href="http://dlink.vtverdohleb.org.ua/webcam.html">http://dlink.vtverdohleb.org.ua/webcam.html</a> <br>  The truth does not guarantee that the page will always work, for whatever circumstances beyond my control, the camera may have to be turned off.  But I will try not to turn it off within a month, after placing the article. <br>  Possible problems: <br>  1. Broadcasting works on the basis of the vlc-mozilla-plugin.  Therefore, the picture will not be if the computer is not worth VLC Player.  But searches in Google for some absolutely universal system yielded nothing.  For example, on my tablet, after installing VLC Player, the video went off, but the sites with SWF did not show flash. <br>  2. The outgoing bandwidth of your channel is lower than the total flow for everyone.  Well, the options here are to increase the outgoing speed of the channel or ‚Äúcrush‚Äù the speed of the video stream by reducing frames / s and decreasing ‚ÄúVideo quality / Constant bit rate‚Äù with a deterioration in picture quality. <br>  See who is watching and what the flow rate can be on the status page: <br>  <a href="http://xn--ip-_-73db0aic3avovqpjsz3w:8090/">http: // ip address of accumulator: 8090 /</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e2/f3e/8a7/1e2f3e8a7f25723e8527e88d55acfb72.jpg" alt="image"><br><br>  In the next version of Webcam, the ability to work with 5 cameras will be added.  If you have comments and suggestions for the current version, please write them in writing at <a href="http://dlink.ua/dns">http://dlink.ua/dns</a> or in the comments to the article. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/171/7f7/863/1717f786314d520aec02f0a43dd80020.jpg" alt="image"><br><br>  Anticipating comment ‚ÄúBut how can a weak NAS handle the distribution of 5 cameras for a couple of dozen users?‚Äù I give an example of top <br><br><img src="https://habrastorage.org/getpro/habr/post_images/16e/94c/c86/16e94cc8683fe83473b1a61f02b6ea82.jpg" alt="image"><br><br>  As you can see, ffserver &amp; ffmpeg broadcasting consumes only 3% of the process with the 1st camera and 4 users for viewing. <br>  In general, D-Link DNS-325 &amp; DNS-345 are very successful devices, able to do everything that competing devices offer and even more.  Some of their functionality I have already described in previous articles: <br>  <a href="http://habrahabr.ru/post/170763/">Is IPTV over Wi-Fi a problem?</a>  <a href="http://habrahabr.ru/post/170763/">Absolutely no problem!</a> <br>  <a href="http://habrahabr.ru/post/172927/">What we should build a PBX!</a> <br><br>  Happy viewing! </div><p>Source: <a href="https://habr.com/ru/post/177025/">https://habr.com/ru/post/177025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../177011/index.html">Cross-platform text drawn with a color gradient</a></li>
<li><a href="../177013/index.html">Uploadcare - file storage for sites and applications</a></li>
<li><a href="../177015/index.html">Master class "Software Architecture". Basic course to prepare for international certification iSAQB</a></li>
<li><a href="../177017/index.html">04 - HP T610 + Powerful Thin Client</a></li>
<li><a href="../177023/index.html">Hard ink printing</a></li>
<li><a href="../177027/index.html">Data mining helped earn the Pulitzer Prize</a></li>
<li><a href="../177031/index.html">Festival of IT Professional Development - BitByte</a></li>
<li><a href="../177033/index.html">We transfer bash functionality to cmd.exe</a></li>
<li><a href="../177037/index.html">Developed miniature supercapacity batteries</a></li>
<li><a href="../177039/index.html">Do I need customization for bootstrap?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>