<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Advanced Jekyll</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jekyll is a static site generator. This means that some information is given to the input, and the output is a set of HTML pages. Everything is great ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Advanced Jekyll</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/web/b61/e05/b26/b61e05b26b2441a4a20b61301859f348.png"><br><p>  <a href="https://jekyllrb.com/">Jekyll</a> is a static site generator.  This means that some information is given to the input, and the output is a set of HTML pages.  Everything is great when the site is simple or even one-page.  But what about more complex sites?  Will Jekyll cope?  Will it be convenient? </p><br><p>  This publication is an attempt to summarize the knowledge gained from the creation of several websites.  Therefore, I leave links to both working examples and their full source code on GitHub.  The level of material goes from simple to complex. </p><a name="habracut"></a><br><p>  On Habr√© there have already been several publications on Jekyll: <a href="https://habrahabr.ru/post/207650/">A practical guide to Jekyll</a> , a <a href="https://habrahabr.ru/post/133261/">blog on Jekyll and Github</a> , <a href="https://habrahabr.ru/post/228337/">Jekyll 2 is coming on Github!</a>  .  However, they all describe mostly the basic features of Jekyll.  In addition, Jekyll 3 is already being used on GitHub Pages, which has brought new buns.  So, let's begin! </p><br><h3 id="staticheskiy-html">  Static html </h3><br><p>  <a href="https://pages.github.com/">Github Pages</a> uses Jekyll as a website generator.  Can GitHub Pages be used on their own, without Jekyll?  Yes!  You can use GitHub Pages as a simple HTML hosting (for free!).  Especially if the site has already been generated somewhere. </p><br><p> <a href="https://winternovel.dexp.in/"><img src="https://habrastorage.org/web/240/712/2c4/2407122c4a13495198810b6258b249ad.png" alt="- Winter Novel" title="Winter Novel demo web"></a> </p><br><p>  For example, the <a href="https://winternovel.dexp.in/">Winter Novel Web demo</a> was generated in a C application.  This is just a bunch of simple HTML pages located on GitHub Pages.  Sources <a href="https://github.com/DeXP/WinterNovel-demo">here</a> . </p><br><h3 id="polzovatelskie-domeny">  Custom domains </h3><br><p>  As was seen above, it is possible to use your domain name instead of <em>* .github.io</em> .  And to do this is quite simple: you need to create a <a href="https://github.com/DeXP/WinterNovel-demo/blob/gh-pages/CNAME">CNAME</a> file with a single line ‚Äî the domain: </p><br><pre><code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">winternovel</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.dexp</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.in</span></span></code> </pre> <br><p>  After the commit, the set domain can also be seen in the repository settings: </p><br><p><img src="https://habrastorage.org/web/27a/626/90a/27a62690a367487ca947f0e9da896750.png" alt="GitHub Pages:  " title="GitHub Pages: Repository Settings"></p><br><p>  You can use domains of any level, not just the third.  For example, <a href="https://dexp.in/">dexp.in is</a> also hosted on GitHub. </p><br><h3 id="cloudflare">  Cloudflare </h3><br><p>  Another great free service is <a href="https://www.cloudflare.com/">CloudFlare</a> .  Indeed, in any case, you need a DNS manager for the domain.  And CloudFlare provides not only DNS management tools, but also a CDN service.  This means that CloudFlare can cache pages and display them even if GitHub Pages is unavailable. </p><br><p><img src="https://habrastorage.org/web/b40/289/d46/b40289d466224a11ab177d1c248e819a.png" alt="dexp.in  CloidFlare" title="dexp.in on CloidFlare"></p><br><p>  The main domain directly by IP is bound to GitHub.  Subdomains are implemented via cname-alias on <em>dexp.github.io</em> . </p><br><h3 id="markdown">  Markdown </h3><br><p>  Jekyll supports both HTML and Markdown.  HTML gives more features, but is not very convenient for writing by humans.  Markdown is a very cool text writer. </p><br><p>  An example of a piece of text <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/tutorials/_posts/2014-12-25-making-site-in-comipo.html">in HTML</a> : </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Creating a website in Manga Maker Comipo is almost like creating it in Photoshop. That means the program is only responsible for creating the image of the future design. Everything else must be done in other programs and requires skills and knowledge of HTML and CSS.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>Let's see an example shown below:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"centered"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ page.linkadd }}pic/tutorials/site/OneMangaDay-site-comipo.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Website in Comipo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"imgshad"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>You can see "Layer List" panel. It already has a stack of layers. You just need to implement this stack in HTML! The most convenient way is exporting each layer as a separate image. Export can be accessed from the menu "File - Export Image File". Also you can press F2. Export options:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"centered"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{{ page.linkadd }}pic/tutorials/site/OneMangaDay-branch-export.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Export parameters for website miking in Comipo"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  At a minimum, you need to add both <code>&lt;p&gt;</code> and <code>&lt;/p&gt;</code> ... And an example of a piece of text <a href="">on Markdown</a> : </p><br><pre> <code class="markdown hljs">Visual novels creating is not such a difficult thing, as it might seem. And RenPy engine will help us: [<span class="hljs-string"><span class="hljs-string">http://renpy.org</span></span>](<span class="hljs-link"><span class="hljs-link">http://renpy.org</span></span>){:target="_blank"}. On the one hand, the engine is simple and understandable even for beginners. On the other hand, the engine is quite powerful and allows you to create really cool games. You need to download engine and install it. Nothing complicated in this process is not present, the default settings are good. Here is the RenPy main window: ![<span class="hljs-string"><span class="hljs-string">RenPy main window</span></span>](<span class="hljs-link"><span class="hljs-link">{{ page.picdir }}RenPy-main-en.png</span></span>){:.imgshad} There is a list of projects on left. And active project options on the right (the active project is highlighted with blue in projects list ). To create your game you need to click "Add New Project" under the list of projects. Further, the engine will ask a few simple questions. Remember the name of the game should be in English (do not use international/unicode symbols).</code> </pre> <br><p>  Markdown code looks much better.  Just try, you will not regret. </p><br><h3 id="sass--scss">  SASS / SCSS </h3><br><p>  Sass is a language on top of CSS.  A lot of good functionality has been added: variables, code blocks, nested rules, include, etc.  Sample SCSS code with impurities and variables: </p><br><pre> <code class="hljs perl">@mixin border-radius($radius,$border,$color) { -webkit-border-radius: $radius; -moz-border-radius: $radius; -ms-border-radius: $radius; border-radius: $radius; border:$border solid $color } .box { @include border-radius(<span class="hljs-number"><span class="hljs-number">10</span></span>px,<span class="hljs-number"><span class="hljs-number">1</span></span>px,red); }</code> </pre> <br><p>  The code will be translated to: </p><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.box</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">-webkit-border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">-moz-border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">-ms-border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-radius</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border</span></span>: <span class="hljs-number"><span class="hljs-number">1px</span></span> solid red; }</code> </pre> <br><p>  Useful links: <a href="http://sass-lang.com/guide">Sass Basics</a> , <a href="https://www.tutorialspoint.com/sass/">Sass Tutorial</a> </p><br><h3 id="razmetka">  Markup </h3><br><p>  Ok, pure HTML is already good.  But maybe in Jekyll there is something like <em>include</em> ?  Then you can build your pages in the style: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">include</span></span> <span class="hljs-keyword"><span class="hljs-keyword">header</span></span>.html {   } <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> footer.html</code> </pre> <br><p>  Yes, in Jekyll there is <em>include</em> .  But it is better to use this directive for other purposes.  For the appearance it is better to use templates: <em>Layout</em> . </p><br><p>  Let the source code of the page look like this: </p><br><pre> <code class="hljs mel">--- <span class="hljs-keyword"><span class="hljs-keyword">layout</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> --- {   }</code> </pre> <br><p>  And the <em>_layouts / default.html</em> file: </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span>... {{ content }} ...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  The page generates some code and saves it to the <em>content</em> variable.  Jekyll sees from the header that the next file being processed will be <em>_layouts / default.html</em> .  Next, you just need to display the contents of this variable anywhere in the code. </p><br><p>  Of course, in reality, the code is more complex.  For example, the <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/index.html">main page</a> <em>One Manga Day</em> and <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/_layouts/default.html">layout for it</a> . </p><br><h3 id="peremennye">  Variables </h3><br><p>  We have already touched on the topic of variables.  Consider in more detail the title of the <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/index.html">main page of</a> <em>One Manga Day</em> : </p><br><pre> <code class="hljs mel">--- <span class="hljs-keyword"><span class="hljs-keyword">layout</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> curlang: en title: Home page addcss: badges ---</code> </pre> <br><p>  The variable <em>layout</em> tells Jekyll which next file will be processed.  The remaining variables are used in the <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/_layouts/default.html">layout</a> code and are created for convenience: </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>{{ site.name }} | {{ page.title }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  The variable <em>page.title is</em> set in the page header, <em>site.name</em> is in <a href="">_config.yml</a> .  The result of executing this line in my case is: <code>One Manga Day | Home page</code> <code>One Manga Day | Home page</code> </p><br><h3 id="kollekcii">  Collections </h3><br><p>  Jekyll‚Äôs previous capabilities were not very advanced, even more basic.  But collections allow you to do truly powerful things.  For example, galleries.  And as a particular example - a <a href="https://onemangaday.dexp.in/manga.html">page with manga</a> . </p><br><p><img src="https://habrastorage.org/web/92a/4dc/aaf/92a4dcaafd1a4de3b6325bfa77dddb85.jpg" alt="One Manga Day: Manga page" title="One Manga Day: Manga page"></p><br><p>  A small clipping of <a href="">_data / galleries.yml</a> : </p><br><pre> <code class="hljs pgsql">- id: screenshots description: One Manga Day screenshots imagefolder: pic/scr images: - <span class="hljs-type"><span class="hljs-type">name</span></span>: OMD-s0001.png thumb: thumb<span class="hljs-number"><span class="hljs-number">-1.</span></span>jpg <span class="hljs-type"><span class="hljs-type">text</span></span>: Main menu - <span class="hljs-type"><span class="hljs-type">name</span></span>: OMD-s0002.png thumb: thumb<span class="hljs-number"><span class="hljs-number">-2.</span></span>jpg <span class="hljs-type"><span class="hljs-type">text</span></span>: Instructor</code> </pre> <br><p>  This code creates a <em>site.data.galleries</em> collection.  The first minus sign indicates the creation of a collection item.  <em>images</em> is a subcollection, each element that has the <em>name</em> , <em>thumb</em> and <em>text</em> fields. </p><br><p>  And an example of how to work with this collection is <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/_includes/mangascript.html">_includes / mangascript.html</a> : </p><br><pre> <code class="hljs django"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="actionscript"><span class="xml"><span class="actionscript"> </span></span><span class="hljs-keyword"><span class="xml"><span class="actionscript"><span class="hljs-keyword">var</span></span></span></span><span class="xml"><span class="actionscript"> imageGallery = [ </span></span></span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> gallery = site.data.galleries | where:"id",page.gId | first %}</span></span><span class="xml"><span class="undefined"><span class="xml"><span class="undefined"> </span></span></span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">for</span></span></span></span></span><span class="hljs-template-tag"> image </span><span class="hljs-keyword"><span class="hljs-template-tag"><span class="hljs-keyword">in</span></span></span><span class="hljs-template-tag"> gallery.images %}</span></span><span class="xml"><span class="undefined"><span class="xml"><span class="undefined"> "</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ page.linkadd }}</span></span><span class="xml"><span class="undefined"></span></span><span class="hljs-template-variable"><span class="xml"><span class="undefined"></span></span><span class="hljs-template-variable">{{ gallery.imagefolder }}</span></span><span class="xml"><span class="undefined"><span class="xml"><span class="undefined">/</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ image.name }}</span></span><span class="xml"><span class="undefined"><span class="xml"><span class="undefined">", </span></span></span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endfor</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="undefined"><span class="xml"><span class="undefined"> ]; ... </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  Initially, the <em>site.data.galleries</em> collection <em>is</em> filtered by the <em>id</em> field (the value must be equal to <em>page.gId</em> ).  The result of the <em>where</em> filter can have multiple values, so only the first is taken (this is permissible, since the collection <em>id</em> is assumed to be unique in this case).  The result is saved in the variable <em>gallery</em> . </p><br><p>  Then just go through the entire gallery in the <code>for</code> loop. </p><br><p>  The result of the performance will be something like this: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> imageGallery = [ <span class="hljs-string"><span class="hljs-string">"pic/manga/OneMangaDay_000_001.png"</span></span>, <span class="hljs-string"><span class="hljs-string">"pic/manga/OneMangaDay_000_002.png"</span></span>, ... <span class="hljs-string"><span class="hljs-string">"pic/manga/OneMangaDay_999.png"</span></span> ];</code> </pre> <br><p>  Useful links: <a href="https://help.shopify.com/themes/liquid">Jekyll (Liquid) reference</a> , <a href="https://www.siteleaf.com/blog/advanced-liquid-where/">"Advanced Liquid: Where"</a> . </p><br><h3 id="galerei-vystroennye-v-stranicu">  Galleries built into the page </h3><br><p>  Another good opportunity for galleries is to embed their collections right into the page code.  For example, the <a href="">game page</a> : </p><br><pre> <code class="hljs scala">--- layout: page title: <span class="hljs-string"><span class="hljs-string">"One Manga Day"</span></span> gallery: - image_url: omd/<span class="hljs-type"><span class="hljs-type">OMD</span></span>-s0001.jpg - image_url: omd/<span class="hljs-type"><span class="hljs-type">OMD</span></span>-s0002.jpg - image_url: omd/<span class="hljs-type"><span class="hljs-type">OMD</span></span>-s0003.jpg ... buttons: - caption: <span class="hljs-string"><span class="hljs-string">"Website"</span></span> url: <span class="hljs-string"><span class="hljs-string">"http://onemangaday.dexp.in/"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>: <span class="hljs-string"><span class="hljs-string">"warning"</span></span> - caption: <span class="hljs-string"><span class="hljs-string">"Steam"</span></span> url: <span class="hljs-string"><span class="hljs-string">"http://store.steampowered.com/app/365070/"</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span></span>: <span class="hljs-string"><span class="hljs-string">"info"</span></span> ... --- <span class="hljs-type"><span class="hljs-type">Manga</span></span> are... {% include gallery %} ... {% include buttons %}</code> </pre> <br><p>  Two collections are built into this page: <em>gallery</em> and <em>buttons</em> .  Variables <em>page.gallery</em> and <em>page.buttons</em> are used in <a href="https://github.com/DeXP/dexp.github.io/blob/master/_includes/gallery">_includes / gallery</a> and <a href="https://github.com/DeXP/dexp.github.io/blob/master/_includes/buttons">_includes / buttons</a> respectively. </p><br><p> <a href="https://dexp.in/articles/advanced-jekyll/"><img src="https://habrastorage.org/web/21b/c6f/9e5/21bc6f9e5ec046ce9fcce22650560d84.png" alt="Gallery example"></a> </p><br><p>  This method is well suited if you want to display some information specific only to this page.  If collections are used throughout the site (contacts / menus, etc.), then it is better to use the previous method and store the collections in the <em>_data</em> directory. </p><br><h3 id="nabory-filtrov">  Filter sets </h3><br><p>  We have already covered the topic of filters.  Now you can take a more advanced task.  I want to see all my "Linux" posts, grouped by year, in only 3 years. </p><br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> cp = site.tags.linux | sort | reverse %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> byYear = cp | group_by_exp:"post", "post.date | date: '%Y'" %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">for</span></span></span></span></span><span class="hljs-template-tag"> yearItem </span><span class="hljs-keyword"><span class="hljs-template-tag"><span class="hljs-keyword">in</span></span></span><span class="hljs-template-tag"> byYear limit:3 %}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h4</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ yearItem.name }}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">h4</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">for</span></span></span></span></span><span class="hljs-template-tag"> post </span><span class="hljs-keyword"><span class="hljs-template-tag"><span class="hljs-keyword">in</span></span></span><span class="hljs-template-tag"> yearItem.items %}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ post.url }}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ post.title }}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endfor</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endfor</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"></span><span class="xml"></span></code> </pre> <br><p>  First you need to take all the posts on the tag "Linux": <em>site.tags.linux</em> .  The next line groups by date.  You can select any field or format to group.  Well, the last condition is satisfied through the <em>limit of the</em> for loop.  Conclusion: </p><br><p><img src="https://habrastorage.org/web/b7d/138/d9e/b7d138d9e66644a380c3480bb5cf415c.png" alt="Posts grouped by year"></p><br><p>  Actually it is used in my <a href="https://dexp.in/photo/">photo album</a> ( <a href="">source</a> ). </p><br><h3 id="zapis-peremennyh">  Variable record </h3><br><p>  Let it be necessary not to immediately output the <code>{{ content }}</code> variable, but to modify it somehow, and only then output it. </p><br><p>  Normal assignment: </p><br><pre> <code class="hljs objectivec">{% <span class="hljs-keyword"><span class="hljs-keyword">assign</span></span> someString = <span class="hljs-string"><span class="hljs-string">"value"</span></span> %}</code> </pre> <br><p>  It does not work, because  we need not raw (raw) lines, but preprocessed with Jekyll. </p><br><p>  The solution is the directive <em>capture</em> .  And for example, the <a href="https://github.com/penibelst/jekyll-compress-html/issues/71">hack for traversing the bug</a> in compress.html will be considered.  Let the original code look like this: </p><br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">highlight</span></span></span><span class="hljs-template-tag"> AnyLanguage linenos %}</span></span><span class="xml"><span class="xml"> Some code </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">endhighlight</span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"></span><span class="xml"></span></code> </pre> <br><p>  Change it to use <em>capture</em> : </p><br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">capture</span></span></span><span class="hljs-template-tag"> _code %}</span></span><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">highlight</span></span></span><span class="hljs-template-tag"> AnyLanguage linenos %}</span></span><span class="xml"><span class="xml"> Some code </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">endhighlight</span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">endcapture</span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">include</span></span></span></span></span><span class="hljs-template-tag"> fixlinenos.html %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ _code }}</span></span><span class="xml"></span><span class="xml"></span></code> </pre> <br><p>  Now all the highlighted code is in the <em>_code</em> variable.  Then it is processed in <em>_include / fixlinenos.html</em> : </p><br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">if</span></span></span></span></span><span class="hljs-template-tag"> _code contains '&lt;pre class="lineno"&gt;' %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> _code = _code | replace: "&lt;pre&gt;&lt;code", "&lt;code" %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> _code = _code | replace: "&lt;/code&gt;&lt;/pre&gt;", "&lt;/code&gt;" %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endif</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"></span><span class="xml"></span></code> </pre> <br><p>  The code checks for the occurrence of the <code>&lt;pre class="lineno"&gt;</code> substring.  If such is found, then we have in stock a bold HTML-code, the wrong pieces of which are simply replaced with the correct ones. </p><br><p>  Useful link: <a href="https://help.shopify.com/themes/liquid/filters/string-filters">Jekyll (Liquid) string filters</a> </p><br><h3 id="szhatie-koda">  Code compression </h3><br><p>  You can shrink the entire SASS code with just one line in <a href="">_config.yml</a> : </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">sass</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">style</span></span>: <span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:compressed</span></span></code> </pre> <br><p>  If you need to squeeze the SASS code on the fly, you can use the <em>scssify</em> filter (the compression style from the config will also be applied to the filter): </p><br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-variable"><span class="xml"></span><span class="hljs-template-variable">{{ some_scss | scssify }}</span></span><span class="xml"></span><span class="xml"></span></code> </pre> <br><p>  Jekyll does not provide standard methods for compressing HTML.  You can use a third-party solution - <a href="https://github.com/penibelst/jekyll-compress-html">compress.html</a> .  You need to add just one line to your <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/_layouts/default.html">top-level <em>layout</em></a> : </p><br><pre> <code class="hljs pgsql"><span class="hljs-comment"><span class="hljs-comment">--- layout: compress ---</span></span></code> </pre> <br><p>  Compression will occur after all the code generation.  Ultimately, the HTML code of the page will look something like this: </p><br><p><img src="https://habrastorage.org/web/5c2/e7a/8e7/5c2e7a8e7d4f4ce5b687d75ebd1374d9.png" alt="    HTML" title="HTML compressed into one line"></p><br><h3 id="svoya-podsvetka-sintaksisa">  Its syntax highlighting </h3><br><p>  Let it be necessary to highlight the syntax of some exotic programming language, which Jekyll does not know.  This can be done programmatically. </p><br><p>  I did <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/_includes/customhighlight.html">customhighlight.html</a> to highlight RenPy code (based on Python).  The idea is simple and is also based on the <em>replace</em> filter: </p><br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> _customtag = "image side hide play show scene" | split: " " %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">for</span></span></span></span></span><span class="hljs-template-tag"> _element </span><span class="hljs-keyword"><span class="hljs-template-tag"><span class="hljs-keyword">in</span></span></span><span class="hljs-template-tag"> _customtag %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">capture</span></span></span><span class="hljs-template-tag"> _from %}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"n"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ _element }}</span></span><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">endcapture</span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">capture</span></span></span><span class="hljs-template-tag"> _to %}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"k"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ _element }}</span></span><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">endcapture</span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> _code = _code | replace: _from, _to %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endfor</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"></span><span class="xml"></span></code> </pre> <br><p>  Here an array of tags is formed, then search-replace for each element in the line of code.  The only new thing is splitting a string into an array.  An example of highlighted code: </p><br><p><img src="https://habrastorage.org/web/367/d53/8e8/367d538e81e04d46a15cd82e6226afbc.png" alt="RenPy code"></p><br><p>  Use example <a href="">here</a> .  Also, the backlight is built into the code of the <a href="">original article in English</a> . </p><br><h3 id="oblako-tegov">  Tag cloud </h3><br><p>  Tag cloud is even more challenging.  First, for each tag manually a page must be created.  Secondly, you need to make an array of valid tags with their human-readable names.  Thirdly, the script should calculate the number of articles for each tag. </p><br><p> <a href="http://onemangaday.dexp.in/tutorials/"><img src="https://habrastorage.org/web/b6f/bf5/920/b6fbf592042841e9961af040b85c8ccf.png" alt=" " title="Tag cloud"></a> </p><br><p>  The main calculations take place in the <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/_includes/tagcloud.html">_includes / tagcloud.html file</a> : </p><br><pre> <code class="hljs django"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"cloud"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"font-size: 150%"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"index.html"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">All</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">for</span></span></span></span></span><span class="hljs-template-tag"> tag </span><span class="hljs-keyword"><span class="hljs-template-tag"><span class="hljs-keyword">in</span></span></span><span class="hljs-template-tag"> site.tags %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> curTag = tag | first | slugize %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> langtag = landat.tags | where:"slug",curTag | first %}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"font-size: </span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ tag | last | size | times: 100 | divided_by: site.tags.size | plus: 20 }}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">%"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ curTag }}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">.html"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{ langtag.name }}</span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endfor</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><p>  The <em>site.tags</em> variable stores all used tags from all articles.  The variable <em>langtag</em> is the current tag in the human format, described in <a href="">_data / lang.yml</a> . </p><br><p>  At each iteration there will be a <em>tag</em> variable taken from the <em>site.tags</em> collection.  The <em>tag</em> variable contains a list of all articles with this tag.  So you can just take the size, multiply, divide, etc. The smallest tag was too small for me, so I added another 20%. </p><br><p>  Useful link: <a href="https://help.shopify.com/themes/liquid/filters/array-filters">Jekyll (Liquid) array filters</a> </p><br><h3 id="multiyazychnye-sayty">  Multilingual sites </h3><br><p>  Jekyll itself does not support internationalization.  So you have to implement it yourself.  The easiest method is to simply isolate materials by category (for example, <a href="https://dexp.in/russian/">materials in Russian</a> ). </p><br><p>  You can also use a subdomain for each language.  But in this case for 2 languages ‚Äã‚Äãthere will be exactly 2 sites.  And 10 sites for 10 languages, which is not always convenient. </p><br><p><img src="https://habrastorage.org/web/456/71e/894/45671e89475e47c594dda75f25ca8eb3.png" alt="One Manga Day in Polish" title="One Manga Day in Polish"></p><br><p>  On the <a href="https://onemangaday.dexp.in/">One Manga Day</a> website, each language has its own folder.  The idea is simple.  For example, there is an English page <code>cat/page.html</code> .  If this page has a Russian version, then the URL will be <code>ru/cat/page.html</code> .  If there are few pages, you can create them all manually.  But if there are many pages, it is necessary to check the availability of the page in one or another language.  However, in Jekyll there are no file functions at all for the security of GitHub servers. </p><br><p>  To check the existence of files, you can use my <a href="https://github.com/DeXP/onemangaday/blob/gh-pages/_includes/CHECKEXISTS.html">_includes / CHECKEXISTS.html</a> .  There all sites and posts sites just go over: </p><br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> curUrlExists = false %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> curFUrl = curUrl | remove: ".html" %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">for</span></span></span></span></span><span class="hljs-template-tag"> curFile </span><span class="hljs-keyword"><span class="hljs-template-tag"><span class="hljs-keyword">in</span></span></span><span class="hljs-template-tag"> site.pages %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> cFile = curFile.url | remove: ".html" %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">if</span></span></span></span></span><span class="hljs-template-tag"> cFile == curFUrl %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> curUrlExists = true %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endif</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endfor</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">for</span></span></span></span></span><span class="hljs-template-tag"> curFile </span><span class="hljs-keyword"><span class="hljs-template-tag"><span class="hljs-keyword">in</span></span></span><span class="hljs-template-tag"> site.posts %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> cFile = curFile.url | remove: ".html" %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">if</span></span></span></span></span><span class="hljs-template-tag"> cFile == curFUrl %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> curUrlExists = true %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endif</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endfor</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"></span><span class="xml"></span></code> </pre> <br><p>  If the file exists in the language, you can add a link to it on your page. </p><br><h3 id="sistema-kommentariev">  Commenting system </h3><br><p>  The first solution that comes to mind is <a href="https://disqus.com/">Disqus</a> or a similar AJAX-based comment system.  A small JS code is simply embedded into the page and everything works well. </p><br><p> <a href="https://onemangaday.dexp.in/feedback.html"><img src="https://habrastorage.org/web/af3/f9c/ee4/af3f9cee41ad4fcab7c4b69500959159.png" alt="One Manga Day Disqus comments" title="One Manga Day Disqus comments"></a> </p><br><p>  But personally, I liked <a href="https://staticman.net/">Staticman</a> much more - a comment system based on pull-requests to the site repository.  So the comments are also a jekyll collection! </p><br><p>  Code to display <a href="https://github.com/DeXP/dexp.github.io/blob/master/_includes/_comments.html">comments on the page</a> : </p><br><pre> <code class="hljs django"><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">capture</span></span></span><span class="hljs-template-tag"> post_slug %}</span></span><span class="xml"></span><span class="hljs-template-variable"><span class="xml"></span><span class="hljs-template-variable">{{ page.url | slugify }}</span></span><span class="xml"></span><span class="hljs-template-tag"><span class="xml"></span><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">endcapture</span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">if</span></span></span></span></span><span class="hljs-template-tag"> site.data.comments[post_slug] %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> comments = site.data.comments[post_slug] | sort %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">for</span></span></span></span></span><span class="hljs-template-tag"> comment </span><span class="hljs-keyword"><span class="hljs-template-tag"><span class="hljs-keyword">in</span></span></span><span class="hljs-template-tag"> comments %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> email = comment[1].email %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> name = comment[1].name %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> url = comment[1].url %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> date = comment[1].date %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name">assign</span></span></span><span class="hljs-template-tag"> message = comment[1].message %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">include</span></span></span></span></span><span class="hljs-template-tag"> _post-comment.html index=forloop.index email=email name=name url=url date=date message=message %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endfor</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"><span class="xml"> </span></span><span class="hljs-template-tag"><span class="hljs-template-tag">{% </span><span class="hljs-name"><span class="hljs-name"><span class="hljs-template-tag"><span class="hljs-name"><span class="hljs-name">endif</span></span></span></span></span><span class="hljs-template-tag"> %}</span></span><span class="xml"></span><span class="xml"></span></code> </pre> <br><p>  <a href="https://github.com/DeXP/dexp.github.io/blob/master/_includes/_post-new-comment.html">The form for posting a comment is</a> also quite simple: </p><br><p><img src="https://habrastorage.org/web/a4d/f49/d5d/a4df49d5dd4a462eb3185938ebe2aa7c.png" alt="Comment Posting Form"></p><br><p>  Moderation of comments is implemented through confirmation of the pull request.  You can also simply ask Staticman to put comments directly, bypassing the confirmation of the request.  After accepting the request, the entire site will be regenerated and a comment will appear on the site. </p><br><h3 id="zaklyuchenie">  Conclusion </h3><br><p>  Jekyll is a very cool thing for small sites and blogs.  Just try it, you will love it! </p><br><p><img src="https://habrastorage.org/web/eb8/aa9/aa9/eb8aa9aa9eec4152b5875a41caf159cd.png" alt="Jekyll logo" title="Jekyll logo"></p><br><h3 id="poleznye-ssylki">  useful links </h3><br><ul><li>  <a href="https://pages.github.com/">Github pages</a> </li><li>  <a href="http://jekyllthemes.org/">Jekyll themes</a> </li><li>  <a href="https://help.shopify.com/themes/liquid">Liquid reference</a> </li><li>  <a href="https://dexp.in/articles/advanced-jekyll/">This publication is in English.</a> </li><li>  <a href="http://it-cast.nesterione.com/">A podcast that discussed this article.</a> </li></ul><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Kw5K0czvSm0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/336266/">https://habr.com/ru/post/336266/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../336256/index.html">Russian girls in Data Science. Part 1</a></li>
<li><a href="../336258/index.html">Reporting in 1C: Data Composition System (ACS), idea and architecture</a></li>
<li><a href="../336260/index.html">Swift Mutexes and Capture</a></li>
<li><a href="../336262/index.html">Configuring IDE Clion and Cmake to work with STM32 and C ++</a></li>
<li><a href="../336264/index.html">One step closer to C ++ 20. Results of the meeting in Toronto</a></li>
<li><a href="../336268/index.html">ReactiveX 2.0 with examples, or grokay reactive programming 2.0. Part 1: Observable vs Flowable, Backpressure</a></li>
<li><a href="../336270/index.html">Brief reaction to Xored material</a></li>
<li><a href="../336272/index.html">Types of models</a></li>
<li><a href="../336276/index.html">How I created a monitoring system for computers at work and moved the service to Amazon AWS</a></li>
<li><a href="../336278/index.html">Using the system API in Sailfish OS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>