<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Grid Tiling: Mixing Multiple Tiles</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I think many of the game programmers were thinking about how to implement a convenient map-tiling. Only by presenting all sorts of combinations of ble...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Grid Tiling: Mixing Multiple Tiles</h1><div class="post__text post__text-html js-mediator-article"> I think many of the game programmers were thinking about how to implement a convenient map-tiling.  Only by presenting all sorts of combinations of blends, you can pretty well break your brain - I tried several times to depict any easy-to-use algorithm that would allow you to display a variety of tile cards.  The fact that this turned out - and it turned out something quite simple to implement - can be found below. <a name="habracut"></a><br><br>  How many times do textures need to be mixed in order to draw various combinations of two tiles on a grid field?  And by adding additional tiles, this number increases to such numbers that it‚Äôs even scary to think about.  Let us forget about all these difficulties for the moment and dive into the consideration of combinations in order to identify any patterns that will help us overcome the difficulties of mixing. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ee9/c71/e2f/ee9c71e2f743acc1089dc285ac17c55f.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's start with mixing two tiles.  In Figure 1, I depicted the simplest tile markup "as is", and in Figure 2 - something that we want to have in the end. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ef0/fca/87d/ef0fca87de31d9183f9f77b3f30c760a.jpg"><br><br>  In Figure 3-4, you can see more complex markup.  The number of various combinations is quite large (and we remember the upcoming addition of new tiles), and we need to find a pattern that will help simplify the task. <br><br>  In the process, I managed to draw a hefty amount of these very combinations and eventually came to this decision - if you divide the tile into 4 parts, you can determine its appearance from just 3 adjacent tiles.  Let's look at 5 different blending patterns: <br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/edc/216/e4a/edc216e4acac4645fdd2f56ba79b4aad.jpg"><br><img src="https://habrastorage.org/getpro/habr/post_images/bd3/6a7/eb6/bd36a7eb621057aa1b1a0d59a1e7b4f6.jpg"><br><br>  A small square in a yellow frame is part of the tile that we are trying to describe.  How it will look is determined by adjacent <b>HVC</b> files. <br>  <b>H</b> - adjacent horizontal (Horizontal) <br>  <b>V</b> - vertically adjacent (Vertical) <br>  <b>C</b> - Corner Tile (Corner) <br>  Using these notations, you can notice a similar pattern for the remaining 3 parts of the tile, which means that by inventing an algorithm for one part, we can easily extend it to the entire tile. <br><br>  As a result, we have 3 adjacent tiles, which means only 8 different combinations of them.  Why did I depict only 5 templates?  Let's look at these combinations: <br>  <b>HCV</b> (all adjacent tiles of the same type as the one under consideration): <b>pattern 5</b> (draw part of the tile ‚Äúas is‚Äù) <br>  <b>HV</b> (H and V-tiles are the same, the tile in the corner is different): <b>pattern 4</b> <br>  <b>--V</b> or <b>-CV</b> : <b>pattern 3</b> (two combinations mutated into one pattern - this simplifies things; you can draw them and see what can really be done with just one picture) <br>  <b>H--</b> or <b>HC-</b> : <b>pattern 2</b> <br>  <b>---</b> or <b>-C-</b> : <b>pattern 1</b> <br><br>  The original heap of combinations has decreased to just 8 or even more ‚Äî we only need 5 different patterns for any tile layout.  Moreover, the pattern number 5 is very simple - we draw our part of the tile without any mixing.  It turns out that for each part you need to get <b>4 different</b> blending <b>masks</b> for templates 1-4.  Considering the fact that we have twice spread the tile, we will need a 4x4 mask, with which we can mix the layout of two tiles in any variants. <br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a5/8a2/6b0/5a58a26b068bbce42c8e61401036f515.jpg"><br>  Mask for one part of the tile <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dfe/ef7/e73/dfeef7e7381c1fb254adca64d5840bd5.jpg"><br>  4x4 mask <br><br>  Pretty boring, isn't it?  Naturally, you can come up with something more beautiful;  To demonstrate what is happening, I will use just such a mask. <br>  The first picture is the mask for that part of the tile that we examined a little earlier, and the second is the combination of masks for all four parts: <br>  - upper-left part (the order corresponds to the numbers of templates: 1-2-3-4) <br>  - upper-right part <br>  - bottom-right side <br>  - lower-left part <br>  The mask represents the alpha channel for rendering the blending tile.  That is, first we draw the base tile, and then use the mask to put the corresponding part of the second tile on top. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/33e/80f/9b7/33e80f9b7c57f7c1b18079da0f5588bd.jpg" width="160" height="160"><br><br>  And here is the result of the work of the described algorithm for abstract tile marking (using the presented mask).  Of course, instead of boring monotone-colored tiles, you can use textures, and if you work a little on the mask, you can get a fairly beautiful surface. <br><br>  Summarizing the above, the algorithm is as follows: <br>  - draw tile-1 <br>  - draw mask 2 on mask <br><br>  So, with the mixing of two tiles, we‚Äôll assume that we‚Äôve got it.  How about adding a couple more? <br><br>  First we decide on the sequence.  Want to know what happens if we replace the order of drawing tiles, that is, we start with tile 2, and put the mask on the first one?  Here is a picture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b6/83e/476/1b683e476f7ba574583c60220f7f2428.jpg" width="160" height="160"><br><br>  Very different, isn't it.  That is, order matters.  We draw the first tile, and on top we impose the second one.  Any ideas on the third?  Elementary - just add a new layer on top of the image that we received earlier.  True, there are a couple of points that need to be taken into account. <br><br>  First you need to decide which tile you need to draw first, which second and so on.  Imagine a kind of green field with burned spots of yellow grass and flowing over the river.  Obviously, we draw the green field first.  Now we put a layer of yellow grass on top and at the same time remember that it will be necessary to add a river on top. <br>  When calculating the mask for marking yellow grass, it is necessary to consider the river tile the same as yellow (remember the HCV templates? For example, if all these tiles are river, we think that pattern 5 is appropriate).  And to calculate the mask for the river, all previously drawn tiles are considered alien (in a similar HCV example, template number 1 will be needed). <br><br>  Let us follow the algorithm.  Suppose the green field is tile-1 (the first one in the stack), yellow grass is tile-2, and the river is tile-3. <br>  - draw the whole grid with tile-1 - generate a mask for each tile, while all tiles smaller than 2 represent the black color of the mask (fully transparent), and those that are larger or equal are white (drawn) <br>  - we draw tile-2 (at the same time all tiles are drawn, starting from the second, moreover, as tile-2!) <br>  - generate a second mask, now all tiles, less than 3 - transparent, 3 or more - are drawn <br>  - we draw tile-3 <br>  - ... (continue until the tiles run out) <br><br>  Sounds easy?  Especially in comparison with the complexity of combining each pair of tiles with each other.  If my explanation is not as smart as I expected - just look at the phased work of the algorithm on the screenshots, this should clarify the situation: <br><br><br><img src="https://habrastorage.org/getpro/habr/post_images/781/0c3/951/7810c395135c12ad61c601880cda7d47.jpg"><br><br>  (Sorry for the two intersecting rivers. All for the sake of tiling!) <br><br>  Here is such a basic idea.  You can use different masks when drawing different layers.  Mixing our yellow grass and green field can be done with one mask, and for the more pleasant river banks you can choose another.  You can also think about the additional texture - for the same pretty shores, only alpha will not be enough, so why not put on a mask like a marked-up special texture.  In general, there is room for thought when using this algorithm, so long as it all fits into the imagination and possibilities of iron.  I hope you find this method useful, or at least it suggests some interesting ideas! <br><br>  * Small postscript: historically, I first wrote this article in English.  Perhaps if I hadn‚Äôt been looking at the original when writing the Russian version, the language would have been more human;  at least I tried!  In any case, I apologize for the sudden hard-to-read speed. </div><p>Source: <a href="https://habr.com/ru/post/226787/">https://habr.com/ru/post/226787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../226773/index.html">Multicellular processor is what?</a></li>
<li><a href="../226775/index.html">Key parameters and certification of optical SFP modules</a></li>
<li><a href="../226777/index.html">The first development experience for Windows Phone: In-App Purchasing</a></li>
<li><a href="../226779/index.html">Quaternion Encryption Scheme (QES) on FPGA, XeonPhi, GPU</a></li>
<li><a href="../226783/index.html">The Ministry of Industry and Trade orders the development of a domestic processor</a></li>
<li><a href="../226789/index.html">Robot Hitchbot is hitchhiking</a></li>
<li><a href="../226791/index.html">Spring Security Hello World Java Config</a></li>
<li><a href="../226793/index.html">How do mailing services relate to rules</a></li>
<li><a href="../226799/index.html">Marketing for financial institutions. Part One: Campaigns</a></li>
<li><a href="../226801/index.html">Projects for competition from Intel + workshop on wearable electronics in hackspace</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>