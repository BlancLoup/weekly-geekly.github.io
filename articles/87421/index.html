<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HOW-TO pptpd + freeradius2 + mysql + abills 0.50b for a small office or small provider on Ubuntu 9.10 / 10.04</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the request of the respected Nesmit, I publish it HOW-TO, instead of my own, because I think that his instruction deserves more attention than mine...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HOW-TO pptpd + freeradius2 + mysql + abills 0.50b for a small office or small provider on Ubuntu 9.10 / 10.04</h1><div class="post__text post__text-html js-mediator-article"> At the request of the respected Nesmit, I publish it HOW-TO, instead of my own, because  I think that his instruction deserves more attention than mine, which was in this post, there were many flaws and mistakes in mine.  And in vain his article was not allowed into the tape.  Very good article.  Here she is <br><br>  ubuntu 9.10, in order to upgrade to 10.04, without touching anything. <br>  pptpd 1.3.4-2 <br>  freeradius2.1.0 <br>  abills 0.5 <br>  dictionary.microsoft <br><br>  The developer of billing is here: <a href="http://abills.net.ua/">abills.net.ua</a> <br>  I would like to express my great gratitude to the developers of this billing! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Goals: <br>  1. To provide the Internet with a local network. <br>  2. Traffic accounting <br>  3. Accounting finances <br>  4. Creation of tariff plans. <br>  5. Speed ‚Äã‚ÄãLimit <br>  6. 128bit encryption, a lot of reasons. <br>  7. Without encryption, but using mschapv2. <br>  8. Encryption of personal account (apache SSL) <br>  9. Upgradeability: mail server integration with billing, etc.  There are many modules paid and not. <br><br><a name="habracut"></a><br><br>  Bibliography: <br><br>  I found 2 useful articles on installing abills. <br>  <a href="http://habrahabr.ru/blogs/linux/23650/">habrahabr.ru/blogs/linux/23650</a> - our foundation <br>  <a href="http://silverghost.org.ua/2008/10/13/ustanovka-billinga-abills-na-ubuntu-804-lts-server-mikrotik-router-os-v-kachestve-servera-dostupa/">silverghost.org.ua/2008/10/13/ustanovka-billinga-abills-na-ubuntu-804-lts-server-mikrotik-router-os-v-kachestve-servera-dostupa</a> - our foundation number 2 <br>  still: <br>  <a href="http://www.opennet.ru/base/net/abills_server.txt.html">www.opennet.ru/base/net/abills_server.txt.html</a> is no less useful, but we don‚Äôt have a microtik. <br>  <a href="http://www.xakep.ru/magazine/xa/112/136/1.asp">www.xakep.ru/magazine/xa/112/136/1.asp</a> - pppoe <br>  Description of parameters in pptpd <br>  <a href="http://www.compress.ru/article.aspx%3Fid%3D18183%26iid%3D842">www.compress.ru/article.aspx?id=18183&amp;iid=842</a> <br>  In principle, this setup is no different from using PPPoE or microtik as a NAS.  The latter is more profitable if there are more than 100 customers and without a headache. <br><br>  We will take information from the first 2 articles, they are closest to our topic.  It turns out a revised 1st article with the addition of some of the details of the 2nd + my dorobotki. <br><br>  ATTENTION!  Before you start to put the system.  Decide which network cards you use.  I recommend using intel or 3com cards.  PPTP on realtech is buggy and tunnels fail for no apparent reason. <br><br>  1. Install the system: <br>  My choice fell on the Ubuntu 9.10 distribution, this is a proven system in which a set of packages has been worked out.  Upgrade to 10.04, which is 1.5 months left no problems.  A good admin is a lazy admin.  Why do we need a headache?  The first server on LTS 8.04 stood for 1.5 years until the hard drive was covered.  During this time nobody touched the billing. <br><br>  After installation, update, put all the latest: <br><br> <code>#apt-get update <br> #apt-get dist-upgrade</code> <br> <br>  And reboot. <br><br>  go under the root. <br><br> <code>$ sudo -s -H</code> <br> <br>  2. Install the necessary packages in one line: <br> <code>#apt-get install mysql-server mysql-client libmysqlclient15-dev apache2 apache2-doc apache2-mpm-prefork apache2-utils libexpat1 ssl-cert libapache2-mod-php5 php5 php5-common php5-curl php5-dev php5-gd php5-idn php-pear php5-imagick php5-imap php5-mcrypt libdbi-perl libdbd-mysql-perl libdigest-md4-perl libdigest-sha1-perl libcrypt-des-perl freeradius radiusclient1 radiusclient1 pptpd</code> <br> <br>  During the installation of the MySQL server 2 times asks for the root password for the mysql server, it will be needed soon! <br><br>  Run the installed modules for Apache: <br> <code>#a2enmod ssl <br> #a2enmod rewrite <br> #a2enmod suexec <br> #a2enmod include</code> <br> <br>  Restart apache: <br><br> <code>#/etc/init.d/apache2 restart</code> <br> <br>  # a2enmod rewrite - MANDATORY, otherwise you will get an error when entering the admin area! <br>  3. Download abills 0.50, from the site <a href="http://abills.net.ua/">abills.net.ua,</a> unpack it in / usr / abills or use cvs and download a stable release. <br>  Link to files: <a href="http://sourceforge.net/projects/abills/files/">sourceforge.net/projects/abills/files</a> <br><br>  4. Create the missing directories and change the rights: <br><br> <code># mkdir /usr/abills/backup <br> # chown -R www-data:www-data /usr/abills/backup <br> # mkdir /usr/abills/cgi-bin/admin/nets <br> # chown -R www-data:www-data /usr/abills/cgi-bin/ <br> # mkdir /usr/abills/var <br> # mkdir /usr/abills/var/log <br> # chown -R freerad:freerad /usr/abills/var</code> <br> <br>  Next, edit / etc / sudoers add the line.  This command kills vpn tunnels. <br><br> <code>www-data ALL=NOPASSWD: /usr/abills/misc/pppd_kill</code> <br> <br>  5. Set up freeradius, information from the developer‚Äôs server with corrections for our distribution: <br>  in /etc/freeradius/radiusd.conf in the modules section we describe the sections: <br><br> <code>#abills_preauth <br> exec abills_preauth { <br> program = "/usr/abills/libexec/rauth.pl pre_auth" <br> wait = yes <br> input_pairs = request <br> shell_escape = yes <br> #output = no <br> output_pairs = config <br> } <br> <br> #abills_postauth <br> exec abills_postauth { <br> program = "/usr/abills/libexec/rauth.pl post_auth" <br> wait = yes <br> input_pairs = request <br> shell_escape = yes <br> #output = no <br> output_pairs = config <br> } <br> <br> #abills_auth <br> exec abills_auth { <br> program = "/usr/abills/libexec/rauth.pl" <br> wait = yes <br> input_pairs = request <br> shell_escape = yes <br> output = no <br> output_pairs = reply <br> } <br> <br> #abills_acc <br> exec abills_acc { <br> program = "/usr/abills/libexec/racct.pl" <br> wait = yes <br> input_pairs = request <br> shell_escape = yes <br> output = no <br> output_pairs = reply <br> }</code> <br> <br>  in the exec section, the file / etc / freeradius / modules / exec will result in the following form: <br><br> <code>exec { <br> wait = yes <br> input_pairs = request <br> shell_escape = yes <br> output = none <br> output_pairs = reply <br> }</code> <br> <br>  File / etc / freeradius / sites-enabled / default - go to sections authorize, preacct, post-auth.  The rest of these sections are commented or deleted. <br> <code>authorize { <br> preprocess <br> abills_preauth <br> mschap <br> files <br> abills_auth <br> } <br> preacct { <br> preprocess <br> abills_acc <br> } <br> <br> post-auth { <br> Post-Auth-Type REJECT { <br> abills_postauth <br> } <br> } <br></code> <br><br>  in / etc / freeradius / users <br><br> <code>DEFAULT Auth-Type = Accept</code> <br> <br>  Editing /etc/freeradius/clients.conf, commenting everything, adding to the end (client / server on the local machine, if it‚Äôs better to change the code word) <br><br> <code>client localhost { <br> ipaddr = 127.0.0.1 <br> secret = radsecret <br> shortname = shortname <br> }</code> <br> <br>  Moving on to editing the / etc / freeradius / dictionary file, adding to the end <br><br> <code># Limit session traffic <br> ATTRIBUTE Session-Octets-Limit 227 integer <br> # What to assume as limit - 0 in+out, 1 in, 2 out, 3 max(in,out) <br> ATTRIBUTE Octets-Direction 228 integer <br> # Connection Speed Limit <br> ATTRIBUTE PPPD-Upstream-Speed-Limit 230 integer <br> ATTRIBUTE PPPD-Downstream-Speed-Limit 231 integer <br> ATTRIBUTE PPPD-Upstream-Speed-Limit-1 232 integer <br> ATTRIBUTE PPPD-Downstream-Speed-Limit-1 233 integer <br> ATTRIBUTE PPPD-Upstream-Speed-Limit-2 234 integer <br> ATTRIBUTE PPPD-Downstream-Speed-Limit-2 235 integer <br> ATTRIBUTE PPPD-Upstream-Speed-Limit-3 236 integer <br> ATTRIBUTE PPPD-Downstream-Speed-Limit-3 237 integer <br> ATTRIBUTE Acct-Interim-Interval 85 integer</code> <br> <br>  After this restart the radius: <br><br> <code>#/etc/init.d/freeradius restart</code> <br> <br>  If you write an error, then the freeradius -X command issues a log and serves to search for them. <br><br>  6. Configure the radiusclient. <br>  Editing / etc / radiusclient / servers <br><br> <code>127.0.0.1 radsecret</code> <br> <br>  dictionary.microsoft put in / etc / radiusclient / <br>  These files are responsible for the support of mschap v2 and mppe <br>  You can take the file with <a href="">cakebilling.googlecode.com/files/etc.tar.bz2</a> without it mschap2 and mppe refuses to work. <br>  add the following lines to the file: <br><br> <code>INCLUDE /etc/radiusclient/dictionary.microsoft <br> <br> # Limit session traffic <br> ATTRIBUTE Session-Octets-Limit 227 integer <br> # What to assume as limit - 0 in+out, 1 in, 2 out, 3 max(in,out) <br> ATTRIBUTE Octets-Direction 228 integer <br> # Connection Speed Limit <br> ATTRIBUTE PPPD-Upstream-Speed-Limit 230 integer <br> ATTRIBUTE PPPD-Downstream-Speed-Limit 231 integer <br> ATTRIBUTE PPPD-Upstream-Speed-Limit-1 232 integer <br> ATTRIBUTE PPPD-Downstream-Speed-Limit-1 233 integer <br> ATTRIBUTE PPPD-Upstream-Speed-Limit-2 234 integer <br> ATTRIBUTE PPPD-Downstream-Speed-Limit-2 235 integer <br> ATTRIBUTE PPPD-Upstream-Speed-Limit-3 236 integer <br> ATTRIBUTE PPPD-Downstream-Speed-Limit-3 237 integer <br> ATTRIBUTE Acct-Interim-Interval 85 integer</code> <br> <br>  rule file / etc / hosts <br><br> <code>127.0.0.1 localhost vpn-server <br> 127.0.1.1 localhost vpn-server</code> <br>  vpn-server is the name of YOUR server, change at your discretion.  Otherwise, the client will not be able to connect to the radius server. <br><br>  7. Next, you need to create a database for AbillS <br><br> <code>#mysql -u root -p</code> <br> <code>GRANT ALL ON abills.* TO abills@localhost IDENTIFIED BY "yourpassword"; <br> CREATE DATABASE abills;</code> <br>  Option 2: You can do it easier, install the phpmyadmin package and do everything in 1 minute, including generating a strong password. <br> <code>sudo apt-get install phpmyadmin</code> <br>  Further <br>  <a href="http://xn--ip----6vebbpcjindcb3m3ajcjh0n/phpmyadmin/">ip address of your server / phpmyadmin</a> <br>  enter the root username and password to manage the server and <br>  ‚ÄúPrivileges‚Äù tab -&gt; ‚ÄúAdd new user‚Äù <br>  Username: abills <br>  Host: localhost <br>  Password: press the button to generate, remember the password or write. <br>  Put a check: Create a database with the name of the user in the name and grant it full privileges. <br>  Click OK, the database is created. <br><br>  Now the dump of the database from the directory with abills must be entered into the database <br><br> <code>#mysql -u root -p abills &lt; abills.sql</code> <br> <br>  Configure the Abills configuration file <br>  In the folder / usr / abills / libexec execute <br><br> <code>#cd /usr/abills/libexec <br> #cp config.pl.default config.pl</code> <br>  then edit it. <br><br>  Specify the correct details of access to the database, also change some parameters: <br><br> <code>$conf{dbhost}='localhost'; <br> $conf{dbname}='abills'; <br> $conf{dbuser}='abills'; <br> $conf{dbpasswd}='SxTcBAx7dYfR7cG7'; <br> $conf{dbcharset}='utf-8'; <br> $conf{default_language}='russian'; <br> $conf{periodic_check}='yes'; <br> $conf{ERROR_ALIVE_COUNT} = 10; <br> $conf{RADIUS2}=1; <br></code> <br>  Disable extra modules: <br><br> <code>@MODULES = ('Dv', <br> # 'Voip', <br> # 'Docs', <br> # 'Mail', <br> 'Sqlcmd'); <br></code> <br><br>  8. Rules Conf /usr/abills/Abills/defs.conf <br>  we change only the lines below <br><br> <code>$SNMPWALK = '/usr/bin/snmpwalk'; <br> $SNMPSET = '/usr/bin/snmpset'; <br> $GZIP = '/bin/gzip'; <br> $TAR='/bin/tar'; <br> $MYSQLDUMP = '/usr/bin/mysqldump'; <br> $IFCONFIG='/sbin/ifconfig';</code> <br> <br>  Now the backup will work, initially the config is sharpened under freeBSD. <br><br>  8. Create a certificate for Apache <br><br> <code>#mkdir /etc/apache2/ssl</code> <br> <br>  answer the questions of the following command: <br><br> <code>#make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/ssl/apache.pem <br> #a2enmod ssl <br></code> <br><br>  Replace text from / etc / apache2 / sites-available / default-ssl to the one given. <br><br> <code>&lt;VirtualHost *:443&gt; <br> SSLEngine On <br> SSLCertificateFile /etc/apache2/ssl/apache.pem <br> DocumentRoot /usr/abills/cgi-bin/ <br> Alias /abills "/usr/abills/cgi-bin/" <br> &lt;Directory "/usr/abills/cgi-bin"&gt; <br> &lt;IfModule mod_rewrite.c&gt; <br> RewriteEngine on <br> RewriteCond %{HTTP:Authorization} ^(.*) <br> RewriteRule ^(.*) - [E=HTTP_CGI_AUTHORIZATION:%1] <br> Options Indexes ExecCGI SymLinksIfOwnerMatch <br> &lt;_/_IfModule&gt; <br> AddHandler cgi-script .cgi <br> Options Indexes ExecCGI FollowSymLinks <br> AllowOverride none <br> DirectoryIndex index.cgi <br> #Options ExecCGI <br> &lt;Files ~ ".(db|log)$"&gt; <br> Order allow,deny <br> Deny from all <br> &lt;_/_Files&gt; <br> &lt;_/_Directory&gt; <br> #Admin interface <br> &lt;Directory "/usr/abills/cgi-bin/admin"&gt; <br> AddHandler cgi-script .cgi <br> Options Indexes ExecCGI FollowSymLinks <br> AllowOverride none <br> DirectoryIndex index.cgi <br> order deny,allow <br> allow from all <br> &lt;_/_Directory&gt; <br> ErrorLog /var/log/apache2/error-abills.log <br> # Possible values include: debug, info, notice, warn, error, crit, <br> # alert, emerg. <br> LogLevel warn <br> CustomLog /var/log/apache2/access-abills.log combined <br> &lt;_/_virtualhost&gt; <br></code> <br><br>  <u><b>WHEN COPYING, REMOVE SIGNS UNDERLINE BEFORE AND AFTER SLASH !!!</b></u> <br><br>  Change coding to cp1251 here /etc/apache2/conf.d/charset <br> <code>AddDefaultCharset cp1251</code> <br> <br>  Create a symlink: <br><br> <code>#ln -s /etc/apache2/sites-available/default-ssl /etc/apache2/sites-enabled/default-ssl <br></code> <br><br>  Restart apache <br><br> <code>#/etc/init.d/apache2 restart</code> <br> <br>  Check the server, go to: <br>  <a href="https://xn--ip----6vebbpcjindcb3m3ajcjh0n/admin/">ip-address of your server / admin</a> <br>  If everything is completed successfully, gut.  If not, read the logs.  They have all the power! <br><br>  9. Configure pptpd: <br><br>  Editing /etc/pptpd.conf <br> <code>ppp /usr/sbin/pppd <br> option /etc/ppp/pptpd-options <br> connections 500 <br> localip 192.168.160.1 <br></code> <br><br>  Edit / etc / ppp / options, add the line <br> <code>+mschap-v2</code> <br> <br>  Edit / etc / ppp / pptpd-options, add the lines: <br><br> <code>ms-dns 192.168.160.1 #        <br> asyncmap 0 <br> lcp-echo-failure 30 <br> lcp-echo-interval 5 <br> ipcp-accept-local <br> ipcp-accept-remote <br> <br> plugin radius.so <br> plugin radattr.so <br></code> <br><br>  By default, config is configured for mschap-v2 + mppe. <br><br>  We write the shaper script and give the launch rights. <br><br> <code>#touch /etc/ppp/ip-up.d/shaper <br> #chmod 744 /etc/ppp/ip-up.d/shaper <br> #nano /etc/ppp/ip-up.d/shaper <br></code> <br><br> <code>#!/bin/sh <br> <br> if [ -f /var/run/radattr.$1 ] <br> then <br> DOWNSPEED=`/usr/bin/awk '/PPPD-Downstream-Speed-Limit/ {print $2}' /var/run/radattr.$1` <br> UPSPEED=`/usr/bin/awk '/PPPD-Upstream-Speed-Limit/ {print $2}' /var/run/radattr.$1` <br> # echo $DOWNSPEED <br> # echo $UPSPEED &gt; <br> /sbin/tc qdisc del dev $1 root &gt; /dev/null <br> /sbin/tc qdisc del dev $1 ingress &gt; /dev/null <br> <br> ##### speed server-&gt;client <br> if [ "$UPSPEED" != "0" ] ; <br> then <br> # /sbin/tc qdisc add dev $1 root handle 1: htb default 20 r2q 1 <br> /sbin/tc qdisc add dev $1 root handle 1: htb default 20 <br> /sbin/tc class add dev $1 parent 1: classid 1:1 htb rate ${UPSPEED}kbit burst 4k <br> /sbin/tc class add dev $1 parent 1:1 classid 1:10 htb rate ${UPSPEED}kbit burst 4k prio 1 <br> /sbin/tc class add dev $1 parent 1:1 classid 1:20 htb rate ${UPSPEED}kbit burst 4k prio 2 <br> /sbin/tc qdisc add dev $1 parent 1:10 handle 10: sfq perturb 10 quantum 1500 <br> /sbin/tc qdisc add dev $1 parent 1:20 handle 20: sfq perturb 10 quantum 1500 <br> /sbin/tc filter add dev $1 parent 1:0 protocol ip prio 10 u32 match ip tos 0x10 0xff flowid 1:10 <br> /sbin/tc filter add dev $1 parent 1:0 protocol ip prio 10 u32 match ip protocol 1 0xff flowid 1:10 <br> /sbin/tc filter add dev $1 parent 1: protocol ip prio 10 u32 match ip protocol 6 0xff match u8 0x05 0x0f at 0 match u160x0000 0xffc0 at 2 match u8 0x10 0xff at 33 flowid 1:10 <br> fi <br> ##### speed client-&gt;server <br> if [ "$DOWNSPEED" != "0" ] ; <br> then <br> /sbin/tc qdisc add dev $1 handle ffff: ingress <br> /sbin/tc filter add dev $1 parent ffff: protocol ip prio 50 u32 match ip src 0.0.0.0/0 police rate ${DOWNSPEED}kbit burst 12k drop flowid :1 <br> fi <br> fi</code> <br> <br>  There is another way to shape.  Through the IPN module.  This method can be read on the developer forum. <br><br>  10. Optionally, install squid, make it transparent. <br><br> <code>#apt-get install squid</code> <br> <br>  we change lines in the /etc/squid/squid.conf file <br><br> <code>http_port 3128 <br></code> <br>  on <br><br> <code>http_port 3128 transparent</code> <br> <br>  By default, all possible networks are registered in the config, we remove the comment: <br> <code>http_access allow localnet</code> <br> <br>  restart service <br><br> <code># /etc/init.d/squid restart</code> <br> <br>  11. Turn on the nat and prescribe the following lines in the file rc.local <br>  firewall rules: <br>  ip address 192.168.1.10, looks in the direction of adsl router. <br><br> <code>#     . <br> iptables -F <br> iptables -t nat -F <br> iptables -t mangle -F <br> iptables -X <br> iptables -t nat -X <br> iptables -t mangle -X <br> <br> #  NAT <br> iptables -t nat -A POSTROUTING -s 192.168.160.0/255.255.255.0 -j SNAT --to-source 192.168.1.10 <br> <br> #   ,   . <br> iptables -t nat -A PREROUTING -p tcp -s 192.168.160.0/24 --dport 80 -j REDIRECT --to-port 3128 <br> <br> #     <br> iptables -A INPUT -p TCP -i eth0 --dport 3128 -j DROP # proxy <br> iptables -A INPUT -p TCP -i eth1 --dport 3128 -j DROP <br> iptables -A INPUT -p TCP -i eth0 --dport 3306 -j DROP #mysql <br> iptables -A INPUT -p TCP -i eth1 --dport 3306 -j DROP <br> <br> #  <br> echo "1" &gt; /proc/sys/net/ipv4/ip_forward <br> <br> exit 0</code> <br> <br>  The script is primitive, but enough for a start. <br><br>  12. In / etc / crontab, enter the following. <br><br> <code>*/5 * * * * root /usr/abills/libexec/billd -all <br> 1 0 * * * root /usr/abills/libexec/periodic daily <br> 1 0 1 * * root /usr/abills/libexec/periodic monthly <br> #backup <br> 1 3 * * * root /usr/abills/libexec/periodic backup <br></code> <br><br>  13. Abills settings <br>  Open the admin web interface at <a href="https://xn--ip----6vebbpcjindcb3m3ajcjh0n/admin/">your server ip-address / admin</a> <br>  Username / password abills / abills can then be changed. <br><br>  Default.  NAS, user and tariff has already been created.  We will change under our conditions. <br>  Go System-&gt; Access Server <br>  Ip write 127.0.0.1 <br>  Select the type of pppd: pppd + Radius <br>  Alive (sec.): 120 <br>  RADIUS Parameters (,): Acct-Interim-Interval = 60 <br>  Now add IP POOLs: <br>  we set 192.168.160.2-192.168.160.254 <br><br>  We get groups of tariffs: <br>  / System / Internet / Tariff plans / Groups / <br>  added: unlimited, GID: 0 <br>  Go to / System / Internet / Tariff Plans / <br>  #: one <br>  Name: "unlimited" <br>  Group: "1: unlimited" <br>  Daily a / p: 10 <br>  add <br><br>  Determine the speed: <br>  / System / Internet / Tariff plans / <br>  click on the selected tariff "Intervals" <br>  click the add button, then Traffic <br>  enter the speed, add. <br><br>  Now we get the user: <br>  / Clients / Logins / Internet / Users Add / <br>  we create a client: password, login, name, credit.  And you can immediately put money into the account. <br><br>  The main thing here is first to create a group of tariffs, and then the tariffs themselves.  In addition, read on WiKi in detail about all the options.  Usually they start yelling before they realize what the options mean. <br><br>  <s>According to this instruction, I raised 4 servers and are working successfully.</s> <br>  No longer relevant, Abills pleases with its stability and flexibility, the rest is in your hands. <br><br>  If you need to remove encryption, do this: <br>  We remove the ‚Äúrequire-mppe-128‚Äù line in the / etc / ppp / pptpd-options file. This will give more stability to VPN tunnels and will offload the CPU. <br>  Screenshots of the result: <br><img src="http://img697.imageshack.us/img697/516/neti.png" alt="image"><br><img src="http://img79.imageshack.us/img79/118/90303907.png" alt="image"><br><img src="http://img78.imageshack.us/img78/2061/68063813.png" alt="image"><br><img src="http://img83.imageshack.us/img83/816/71838809.png" alt="image"><br>  All thanks to Nesmit'y with forum.ubuntu.ru =) I have nothing to do with it.  He did this article, I just told it to people, because  on his behalf, stubbornly prevented this article from being published!)) <br>  Good luck!  I am ready to listen to all questions, including malfunctions. </div><p>Source: <a href="https://habr.com/ru/post/87421/">https://habr.com/ru/post/87421/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../87413/index.html">A way to view HTML5 videos from Firefox</a></li>
<li><a href="../87414/index.html">E-government chimera</a></li>
<li><a href="../87417/index.html">PHP5. "Secure Templates"</a></li>
<li><a href="../87418/index.html">-What is the strength in, brother? Power - in the blog!</a></li>
<li><a href="../87419/index.html">Minor update for T-Mobile G1 - DMD64</a></li>
<li><a href="../87424/index.html">ANDNA - Netsukuku Host Naming Service</a></li>
<li><a href="../87425/index.html">Andrey Ternovsky travels across the States</a></li>
<li><a href="../87426/index.html">We program Reversi on Silverlight</a></li>
<li><a href="../87427/index.html">Torrents effect</a></li>
<li><a href="../87428/index.html">SPRN - Missile Assault Warning System</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>