<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>XELTEK Adapter Cloning Protection Mechanism</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 This story began with the fact that we somehow needed to read / write a FLASH memory chip of the SPANSION S29GL512 type in the TSOP56 packa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>XELTEK Adapter Cloning Protection Mechanism</h1><div class="post__text post__text-html js-mediator-article"><h4>  Foreword </h4><br>  This story began with the fact that we somehow needed to read / write a FLASH memory chip of the SPANSION S29GL512 type in the TSOP56 package.  Until that time, we had successfully exploited the XELTEK SuperPro 500P programmer.  But, unfortunately, the socket with 48 contacts installed in it did not allow this to be done even with the use of an adapter.  Of course, there was no support for such chips in the program on the PC for this programmer. <br><br>  It's time to upgrade, we decided, and purchased (do not consider advertising) a programmer from the same manufacturer of the model SuperPro 6100, which uses interchangeable adapters with different sockets.  Also separately purchased was the necessary, as it seemed to us then, adapter of the CX1011 model with a TSOP56 socket (an adapter with a ZIF48 socket was included with the programmer). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2f4/c83/08d/2f4c8308dda742d992b5894db27862bb.jpg"></div><br>  <i>Let us further agree to call the programmer program simply a software, because the ‚Äúprogrammer program‚Äù does not sound very aesthetic.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After receiving all this, we collected a constructor from the programmer with an adapter and tried to start working with it. <br><a name="habracut"></a><br><img src="https://habrastorage.org/files/1d4/582/49f/1d458249fa5647da96a0e1c8f5283669.jpg"><br><br>  But after the required chip was selected in the software, the programmer squeaked several times and the mysterious inscription ‚ÄúERROR CODE: 1D‚Äù was displayed on its display.  Software also cursed the message that this adapter is not suitable for programming this chip.  How so!?  The adapter with the programmer got married happily, the chip with the socket too, but the malicious manufacturer decided that this is not enough and the user, in addition to the new programmer, must also purchase the ‚Äúnew‚Äù adapter DX1011.  For which, by the way, on the manufacturer's website they want about three hundred evergreens.  Well, okay, in our case, we bought it by mistake, although there was still no desire to acquire a ‚Äúnew‚Äù one.  But after all, someone could save it from the old programmer, and someone might want to make it yourself.  So for this particular audience this article. <br><br>  In preparing this material, we did not set out to teach the reader to use various programs and hardware devices that had to be used along the way.  Therefore, we will not clutter the article with a description of the subtleties of working with all these tools, leaving it behind the scenes.  But if someone is interested in the details, we will be happy to comment on them. <br><br>  Here it‚Äôs just right to cite the text of the disclaimer about liability, the meaning of which is that the author is not responsible for any use you make of the materials in this article.  In other words, only you yourself will be responsible for your actions, to which you may be encouraged to become familiar with this material. <br><br><h3>  Exploratory survey </h3><br>  An overview of the adapter made it possible to detect on it an octopus microcircuit labeled AE801, of which there was, of course, no documentation on the Internet.  This microcircuit is clearly visible in the right corner in the photo of the CX1011 adapter above. <br><br>  Although some information about this chip is still found.  The XELTEK website in the <a href="http://xeltek.com/faq-en/faqwd/what-are-difference-between-superpro6000-to-superpro6100-programmer/">FAQ</a> section answers the question: ‚ÄúWhat is the difference between the SuperPro 6000 and 6100 programmers?‚Äù There is a curious phrase: ‚ÄúThe CX series adapters (for 6000 programmers) and DX (for 6100 programmers) are absolutely the same, except for the ID chip, which in adapters of the DX series uses advanced protection. ‚ÄùIt became clear that this chip is a kind of ID chip that the programmer uses to identify the adapter installed in it.  That's just what kind of protection is it: from whom or from what does the adapter need to be protected?  Well, of course from us with you! <br><br>  This protection is similar to the one that is now commonly used in printer cartridges so that they are not refilled and bought new ones.  But here the situation is somewhat different.  You get an expensive adapter for your money and hope that you will use it forever.  Not here it was!  The manufacturer of this prudently took care of and, having become like the Creator himself, decided to artificially limit the adapter to the period of his mortal life.  In confirmation of this, the following significant messages are found in the software: <br><br>  - ‚ÄúSocket adapter end-of-life is near.  Please prepare to replace with a new one. " <br>  ‚ÄúAdapter usage beyond its cycle life, please change.‚Äù <br><br>  How do you like this pearl: ‚ÄúAdapter life expires‚Äù?  And especially the phrase "replace with a new one", so caressing the ear of the sales department. <br><br>  For some reason, on the XELTEK website on the page with adapters about their perishability - not a word!  Paraphrasing one famous saying about a goat and a button accordion, I just want to say: ‚ÄúWhat about protection adapter?‚Äù <br><br>  But be that as it may, the need to still read / write a FLASH memory chip (which, I must say, we have forgotten, carried away by everything else) and an irresistible desire to by all means alleviate the plight of the unfortunate The adapter made us move on. <br><br><h3>  Preparation for treatment </h3><br>  <i>We will further agree to call the PC on which the software for the programmer is running as the host.</i> <br><br>  For data exchange between the host and the programmer uses a USB interface, and in it several USB channels (Pipes).  The host sends commands to the programmer via one of the USB channels, sends data to it via the other, and receives data from the programmer through the next. <br>  It was necessary to identify the interface for data exchange between the AE801 and the programmer itself.  Here the manufacturer did not philosophize, using the good old UART with a speed of about 10,500 baud.  The AE801 chip, which is essentially an eight-legged microcontroller, legs 1 and 4 are connected to ground, + 5V is powered to foot 8, foot 3 is used for bidirectional data transfer via UART, foot 7 is used as positive CS, and to foot 6, simultaneously with the appearance of the unit on the leg 7, the clock frequency is 4 MHz.  Of the eight legs that we know of microcontrollers, ATMEL of ATtiny25, 45, 85 series is best suited for this pinout. However, the SOIC8 package used for them is somewhat wider than necessary. <br><br>  When studying the data exchange between the AE801 on the adapter and the programmer, one interesting thing was discovered: when choosing a chip in the software, even before the AE801 chip is selected on the adapter, some data packets appear on its leg 3.  It turned out that there is even before the start of communication with the chip from the adapter, the programmer communicates with someone else.  Later it turned out that the programmer itself has the same AE801 chip, sitting on the same bi-directional data bus as the AE801 from the adapter.  And it serves the same purpose - protection from cloning, but now the programmer itself. <br><br>  Further, the software on the host was modified to save the data exchange procedure between it and the programmer to a log file.  From the received log it became absolutely clear that nothing is clear.  The data exchange was somehow encrypted and noisy with garbage.  Apparently that was precisely the ‚Äúimprovement of protection‚Äù.  But one thing became obvious - the adapter informs the programmer of the name of its model, directly in text form, and its age, so that it can be sent in a timely manner to a well-deserved, in the opinion of XELTEK, rest.  Everything else is rubbish. <br><br>  By further study, it turned out that the protection algorithm was written by a person very far from this topic.  The so-called "enhanced protection" does not hold water. <br>  However, it was not possible to figure out the log in the forehead and it became obvious that now it is necessary to move inside the programmer itself.  Its electronic filling looks like a layer cake, in the form of a set of individual boards, connected together with racks and connectors. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/342/e11/217/342e112171324ab9b20db63116ffc4c7.jpg"></div><br>  One of these boards (let's call it, by analogy with a PC, ‚Äúmotherboard‚Äù) contains an ARM microcontroller ATMEL AT91SAM9G20, SDRAM, SPI FLASH with firmware, the same AE801 ID chip with a programmer model and its serial number, a USB controller chip, and a number of other chips . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f40/ef6/fdd/f40ef6fddffd40e1ac9f23632acf8bcd.jpg"></div><br>  Another XILINX microcircuit is installed on one motherboard, which, together with the other motherboards with transistor assemblies, controls the legs of the microcircuit on the adapter connected to the programmer during read / write procedures, etc. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1bd/fff/72f/1bdfff72f5004c18b082c3ecaab12905.jpg"></div><br>  The entire ARM microcontroller firmware is contained in the external SPI FLASH chip, which, of course, also does not contribute to the increased protection.  Usually, the bootloader is hidden in the internal memory of the microcontroller, which is inaccessible for reading, and the firmware or updates placed outside are encrypted.  But the developers of XELTEK decided to go the other way, confusing themselves with proprietary AE801 chips, leaving the ARM firmware to be torn apart.  What we actually do next. <br><br>  The idea was to disassemble the ‚Äúusb‚Äù file of the programmer's algorithm and then assemble the project in one of the ARM IDE, so that later through JTAG, having source code in assembler, study the work of the programmer in terms of his communication with the AE801 chip. <br><br>  On the motherboard, a place for the JTAG connector was provided by the way.  For easy debugging, the JTAG connector was mounted on the side of the plastic housing of the programmer and connected to the motherboard with a flat cable. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/535/8af/fee/5358affeec454ed68b54fa93d19d061d.jpg"></div><br>  The result was a kind of Development Kit. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d1d/11d/469/d1d11d469fd74e409da14dd207fca03c.jpg"></div><br>  Since we had JTAG OLIMEX ARM-USB-OCD, preserved from some old project, the choice of ARM IDE fell on the IAR Embedded Workbench, because it supports debugging through the GDB server.  However, setting up this very GDB server turned out to be a very intricate task.  And it was necessary to spend some time to get the project assembled from the assembler source code into the SDRAM programmer and the opportunity to debug it. <br><br>  After everything finally worked out from under the debugger, some of the most "interesting" methods of the algorithm were rewritten to C to make them easier to understand.  Thus, gradually managed to accumulate information, which allowed to understand the mechanism of the programmer, which is described below in a somewhat simplified form. <br><br>  When the programmer is powered on, its built-in bootloader (conditionally zero) starts up in the ARM microcontroller, loads another bootloader from SPI FLASH (let's call it first) into its internal RAM, remaps this RAM to address 0 and transfers control to the first bootloader.  Having started work, the first loader sets up the controller in ARM-e SDRAM, thus connecting the external RAM at 0x20000000 and rewrites another bootloader (let's call it second) from the same SPI FLASH and transfers control to it.  The second loader configures the external USB controller chip to communicate with the host, displays the screen with the name of the programmer and the firmware version on the LCD, communicates with its own ID chip AE801 and eventually enters the command processing loop from the host. <br><br>  To work with each type of memory chips created its own firmware for ARM microcontroller, called the algorithm.  Algorithm files have the ‚Äúusb‚Äù extension and are stored on the host in the ‚ÄúalgoX‚Äù directory with the installed program.  The ‚Äúlib‚Äù directory contains firmware for the XILINX chip and files with the ‚Äúwls‚Äù extension, which contain information on the correspondence of the required algorithm to each chip supported by the programmer, the type of adapter required for this chip, as well as some additional parameters for each chip.  For example, its supply voltage, programming voltage, etc. <br><br>  After choosing a chip in the software, you need to make sure that the corresponding adapter is installed in the programmer.  For this, the host sends a command to the programmer ‚Äî a request of the type of adapter installed in it.  The programmer asks the AE801 chip from the adapter for its type and sends the generated response in a special way back to the host.  The software on the host compares the adapter type from the ‚Äúwls‚Äù file with the adapter type from the response and, if they match, sends the next bootloader (let's call it the third) to the programmer at 0x20020000 - the ‚Äúloader.bin‚Äù file located in the ‚Äúbin‚Äù directory.  After transferring control to the third loader, the host with its help loads the algorithm (usb file) corresponding to this type of chip to the address 0x20000000, the firmware for XILINX and eventually transfers control to the loaded algorithm.  After some adjustments of the hardware, the algorithm, in turn, again falls into the loop of processing commands from the host.  The intermediate third loader is needed only so that the working algorithm is loaded each time at the same address 0x20000000. <br><br>  When you select another chip in the software, the entire procedure described above is repeated, starting with a request from the host for the type of adapter installed in the programmer. <br><br>  After the algorithm loaded into the programmer enters the loop of processing commands from the host, all further actions are activated only by these commands.  In other words, the host becomes the master, and the programmer the slave.  The AE801 microcircuit from the adapter is slave with respect to the programmer and, after feeding on its leg 7 (CS), an active high level, and for the leg 6 clock frequency 4 MHz also goes into the command processing cycle from the programmer.  Leg 3 of the AE801 chip is initially configured to receive commands from the programmer.  After sending the next command, the programmer sets up the data line for reception, and the AE801, respectively, its leg 3 for transmission and sends the data to the programmer.  Thus, data is exchanged between the AE801 in the adapter and the programmer.  Data is exchanged between the internal AE801 on the motherboard and the programmer in exactly the same way. <br><br><h3>  Treatment </h3><br>  So, we came directly to the consideration of the mechanism of protection adapters DX series. <br><br>  As mentioned earlier, in order not to overload the article with unnecessary details, here we give only the quintessence of the path covered - a description of the process of data exchange between the programmer and the AE801 ID chip. <br><br>  <i>Terminology used in this description:</i> <i><br><br></i> <ul><li>  <i>The term ‚Äúleg‚Äù refers to the corresponding pins of the AE801 chip.</i> </li><li>  <i>Byte counting - starting from one.</i> </li><li>  <i>Each time, the programmer, sending a certain number of bytes to the microcircuit, transfers the data line to the reception, and the microcircuit, having received this data, switches leg 3 to the transmission, etc.</i>  <i>Therefore, the description of these switches and the mention of the legs 3 will not be given.</i> </li><li>  <i>The narration is on behalf of the chip AE801.</i> </li></ul><br>  <b>1.</b> If there is an inactive low level on leg 7, leg 3 is set to enter and we are either in a reset or in a state of sleep. <br><br>  <b>2.</b> When the programmer gives active high level to leg 7 (leg 6 of 4 MHz is supplied to leg 6), we have to transfer 6 random bytes to the programmer. <br><br>  <i>It is known that to use the algorithm for generating random, or rather, pseudo-random numbers from the standard library C, you must first call the srand () command, passing a certain number, a salt, as the input argument, using which each call to the rand () command will return the following value from defined by this number of pseudo-random sequence.</i>  <i>In PC, time () is usually used as a source of entropy for srand (), but in simple microcontrollers, as a rule, there is no real time clock and this task can be solved, for example, by saving a new value for srand () in the EEPROM each time after reset.</i>  <i>Most likely, this is how it was implemented in AE801.</i>  <i>By and large, we don‚Äôt need to generate random numbers at all, but the solution to this problem seemed interesting.</i> <i><br><br></i>  <i>We implemented the AE801 prototype on a Microchip microcontroller (at that moment it was just at hand), which operated from its own internal generator at a frequency of 8 Mhz and with respect to it an external frequency of 4 MHz, fed to leg 6, turned out to be acceptable (and perhaps the only) source of entropy.</i> <i><br><br></i>  <i>Leg 6 in the program was used as a digital input and 16 bits were read from it in the cycle, which are necessary for transmission to the srand () method.</i> <br><br>  <b>3.</b> We receive from the programmer 9 bytes and confirm their receipt by sending to the programmer the sixth byte received. <br><br>  <b>4.</b> We receive from the programmer 5 bytes.  The first of five received bytes is sent to the programmer as is, and the remaining 4th ones are encrypted using the RSA algorithm in 4th 16-bit words and sends the received 8 bytes to the programmer.  Moreover, for each of the words received after encryption, the high byte is sent first, and then the low byte.  Finally, we send the first five received bytes to the programmer again.  Total 10 bytes. <br><br>  RSA with very short keys 63, 847 and 2773 is used as an encryption algorithm. Anyone interested can find information about this, for example, <a href="http://intercontineo.com/article/1232361446/">HERE</a> . <br><br>  In the firmware of the algorithm, the cycle of 2773 iterations is used to calculate RSA.  But since the input number for encryption is a byte, and the output is a two-byte word, to simplify the calculation of RSA, a table of 256 words was formed, which took an extra 512 bytes of program memory. <br><br><div class="spoiler">  <b class="spoiler_title">RSA table</b> <div class="spoiler_text"><pre><code class="cpp hljs">{ <span class="hljs-number"><span class="hljs-number">0x0000</span></span>, <span class="hljs-number"><span class="hljs-number">0x0001</span></span>, <span class="hljs-number"><span class="hljs-number">0x03d0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0640</span></span>, <span class="hljs-number"><span class="hljs-number">0x059d</span></span>, <span class="hljs-number"><span class="hljs-number">0x045f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0191</span></span>, <span class="hljs-number"><span class="hljs-number">0x020b</span></span>, <span class="hljs-number"><span class="hljs-number">0x0863</span></span>, <span class="hljs-number"><span class="hljs-number">0x0209</span></span>, <span class="hljs-number"><span class="hljs-number">0x0933</span></span>, <span class="hljs-number"><span class="hljs-number">0x0489</span></span>, <span class="hljs-number"><span class="hljs-number">0x017f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0168</span></span>, <span class="hljs-number"><span class="hljs-number">0x00d8</span></span>, <span class="hljs-number"><span class="hljs-number">0x0717</span></span>, <span class="hljs-number"><span class="hljs-number">0x0741</span></span>, <span class="hljs-number"><span class="hljs-number">0x0315</span></span>, <span class="hljs-number"><span class="hljs-number">0x040d</span></span>, <span class="hljs-number"><span class="hljs-number">0x0368</span></span>, <span class="hljs-number"><span class="hljs-number">0x0984</span></span>, <span class="hljs-number"><span class="hljs-number">0x084f</span></span>, <span class="hljs-number"><span class="hljs-number">0x06d8</span></span>, <span class="hljs-number"><span class="hljs-number">0x0832</span></span>, <span class="hljs-number"><span class="hljs-number">0x08b2</span></span>, <span class="hljs-number"><span class="hljs-number">0x0602</span></span>, <span class="hljs-number"><span class="hljs-number">0x07aa</span></span>, <span class="hljs-number"><span class="hljs-number">0x06a4</span></span>, <span class="hljs-number"><span class="hljs-number">0x0044</span></span>, <span class="hljs-number"><span class="hljs-number">0x086f</span></span>, <span class="hljs-number"><span class="hljs-number">0x08da</span></span>, <span class="hljs-number"><span class="hljs-number">0x07cd</span></span>, <span class="hljs-number"><span class="hljs-number">0x067f</span></span>, <span class="hljs-number"><span class="hljs-number">0x099f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0797</span></span>, <span class="hljs-number"><span class="hljs-number">0x0086</span></span>, <span class="hljs-number"><span class="hljs-number">0x0ab4</span></span>, <span class="hljs-number"><span class="hljs-number">0x0088</span></span>, <span class="hljs-number"><span class="hljs-number">0x09e6</span></span>, <span class="hljs-number"><span class="hljs-number">0x07c5</span></span>, <span class="hljs-number"><span class="hljs-number">0x0433</span></span>, <span class="hljs-number"><span class="hljs-number">0x082a</span></span>, <span class="hljs-number"><span class="hljs-number">0x06d4</span></span>, <span class="hljs-number"><span class="hljs-number">0x00d0</span></span>, <span class="hljs-number"><span class="hljs-number">0x06f8</span></span>, <span class="hljs-number"><span class="hljs-number">0x029d</span></span>, <span class="hljs-number"><span class="hljs-number">0x0496</span></span>, <span class="hljs-number"><span class="hljs-number">0x04f5</span></span>, <span class="hljs-number"><span class="hljs-number">0x0525</span></span>, <span class="hljs-number"><span class="hljs-number">0x06ef</span></span>, <span class="hljs-number"><span class="hljs-number">0x037f</span></span>, <span class="hljs-number"><span class="hljs-number">0x02ad</span></span>, <span class="hljs-number"><span class="hljs-number">0x0606</span></span>, <span class="hljs-number"><span class="hljs-number">0x0133</span></span>, <span class="hljs-number"><span class="hljs-number">0x03b2</span></span>, <span class="hljs-number"><span class="hljs-number">0x0573</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a1d</span></span>, <span class="hljs-number"><span class="hljs-number">0x017d</span></span>, <span class="hljs-number"><span class="hljs-number">0x09ad</span></span>, <span class="hljs-number"><span class="hljs-number">0x0674</span></span>, <span class="hljs-number"><span class="hljs-number">0x05ff</span></span>, <span class="hljs-number"><span class="hljs-number">0x0745</span></span>, <span class="hljs-number"><span class="hljs-number">0x097a</span></span>, <span class="hljs-number"><span class="hljs-number">0x02d9</span></span>, <span class="hljs-number"><span class="hljs-number">0x0373</span></span>, <span class="hljs-number"><span class="hljs-number">0x02f3</span></span>, <span class="hljs-number"><span class="hljs-number">0x09a6</span></span>, <span class="hljs-number"><span class="hljs-number">0x0402</span></span>, <span class="hljs-number"><span class="hljs-number">0x0969</span></span>, <span class="hljs-number"><span class="hljs-number">0x05be</span></span>, <span class="hljs-number"><span class="hljs-number">0x01c5</span></span>, <span class="hljs-number"><span class="hljs-number">0x0ab7</span></span>, <span class="hljs-number"><span class="hljs-number">0x042c</span></span>, <span class="hljs-number"><span class="hljs-number">0x074c</span></span>, <span class="hljs-number"><span class="hljs-number">0x0965</span></span>, <span class="hljs-number"><span class="hljs-number">0x047d</span></span>, <span class="hljs-number"><span class="hljs-number">0x0989</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a81</span></span>, <span class="hljs-number"><span class="hljs-number">0x00a4</span></span>, <span class="hljs-number"><span class="hljs-number">0x00fd</span></span>, <span class="hljs-number"><span class="hljs-number">0x03ee</span></span>, <span class="hljs-number"><span class="hljs-number">0x099c</span></span>, <span class="hljs-number"><span class="hljs-number">0x0695</span></span>, <span class="hljs-number"><span class="hljs-number">0x05ee</span></span>, <span class="hljs-number"><span class="hljs-number">0x028d</span></span>, <span class="hljs-number"><span class="hljs-number">0x0435</span></span>, <span class="hljs-number"><span class="hljs-number">0x0243</span></span>, <span class="hljs-number"><span class="hljs-number">0x07df</span></span>, <span class="hljs-number"><span class="hljs-number">0x09d1</span></span>, <span class="hljs-number"><span class="hljs-number">0x07ee</span></span>, <span class="hljs-number"><span class="hljs-number">0x0509</span></span>, <span class="hljs-number"><span class="hljs-number">0x09b9</span></span>, <span class="hljs-number"><span class="hljs-number">0x023f</span></span>, <span class="hljs-number"><span class="hljs-number">0x02c0</span></span>, <span class="hljs-number"><span class="hljs-number">0x06fa</span></span>, <span class="hljs-number"><span class="hljs-number">0x098d</span></span>, <span class="hljs-number"><span class="hljs-number">0x05d5</span></span>, <span class="hljs-number"><span class="hljs-number">0x0499</span></span>, <span class="hljs-number"><span class="hljs-number">0x0800</span></span>, <span class="hljs-number"><span class="hljs-number">0x016f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0019</span></span>, <span class="hljs-number"><span class="hljs-number">0x0410</span></span>, <span class="hljs-number"><span class="hljs-number">0x010b</span></span>, <span class="hljs-number"><span class="hljs-number">0x01ab</span></span>, <span class="hljs-number"><span class="hljs-number">0x07ea</span></span>, <span class="hljs-number"><span class="hljs-number">0x036f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0094</span></span>, <span class="hljs-number"><span class="hljs-number">0x004e</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a64</span></span>, <span class="hljs-number"><span class="hljs-number">0x06b9</span></span>, <span class="hljs-number"><span class="hljs-number">0x0abe</span></span>, <span class="hljs-number"><span class="hljs-number">0x051a</span></span>, <span class="hljs-number"><span class="hljs-number">0x0295</span></span>, <span class="hljs-number"><span class="hljs-number">0x0078</span></span>, <span class="hljs-number"><span class="hljs-number">0x0112</span></span>, <span class="hljs-number"><span class="hljs-number">0x06a8</span></span>, <span class="hljs-number"><span class="hljs-number">0x08dd</span></span>, <span class="hljs-number"><span class="hljs-number">0x06e9</span></span>, <span class="hljs-number"><span class="hljs-number">0x04d7</span></span>, <span class="hljs-number"><span class="hljs-number">0x08c3</span></span>, <span class="hljs-number"><span class="hljs-number">0x02e4</span></span>, <span class="hljs-number"><span class="hljs-number">0x00f3</span></span>, <span class="hljs-number"><span class="hljs-number">0x0015</span></span>, <span class="hljs-number"><span class="hljs-number">0x09e7</span></span>, <span class="hljs-number"><span class="hljs-number">0x0967</span></span>, <span class="hljs-number"><span class="hljs-number">0x06e2</span></span>, <span class="hljs-number"><span class="hljs-number">0x0650</span></span>, <span class="hljs-number"><span class="hljs-number">0x0508</span></span>, <span class="hljs-number"><span class="hljs-number">0x0882</span></span>, <span class="hljs-number"><span class="hljs-number">0x0028</span></span>, <span class="hljs-number"><span class="hljs-number">0x07f3</span></span>, <span class="hljs-number"><span class="hljs-number">0x00b7</span></span>, <span class="hljs-number"><span class="hljs-number">0x03d7</span></span>, <span class="hljs-number"><span class="hljs-number">0x0504</span></span>, <span class="hljs-number"><span class="hljs-number">0x0143</span></span>, <span class="hljs-number"><span class="hljs-number">0x0016</span></span>, <span class="hljs-number"><span class="hljs-number">0x0995</span></span>, <span class="hljs-number"><span class="hljs-number">0x08b5</span></span>, <span class="hljs-number"><span class="hljs-number">0x0437</span></span>, <span class="hljs-number"><span class="hljs-number">0x0763</span></span>, <span class="hljs-number"><span class="hljs-number">0x04c5</span></span>, <span class="hljs-number"><span class="hljs-number">0x0234</span></span>, <span class="hljs-number"><span class="hljs-number">0x04c7</span></span>, <span class="hljs-number"><span class="hljs-number">0x07da</span></span>, <span class="hljs-number"><span class="hljs-number">0x09bd</span></span>, <span class="hljs-number"><span class="hljs-number">0x027e</span></span>, <span class="hljs-number"><span class="hljs-number">0x051b</span></span>, <span class="hljs-number"><span class="hljs-number">0x01c0</span></span>, <span class="hljs-number"><span class="hljs-number">0x052a</span></span>, <span class="hljs-number"><span class="hljs-number">0x0544</span></span>, <span class="hljs-number"><span class="hljs-number">0x046c</span></span>, <span class="hljs-number"><span class="hljs-number">0x078c</span></span>, <span class="hljs-number"><span class="hljs-number">0x0199</span></span>, <span class="hljs-number"><span class="hljs-number">0x0299</span></span>, <span class="hljs-number"><span class="hljs-number">0x04b6</span></span>, <span class="hljs-number"><span class="hljs-number">0x094a</span></span>, <span class="hljs-number"><span class="hljs-number">0x07d3</span></span>, <span class="hljs-number"><span class="hljs-number">0x053c</span></span>, <span class="hljs-number"><span class="hljs-number">0x0083</span></span>, <span class="hljs-number"><span class="hljs-number">0x017b</span></span>, <span class="hljs-number"><span class="hljs-number">0x00d6</span></span>, <span class="hljs-number"><span class="hljs-number">0x077f</span></span>, <span class="hljs-number"><span class="hljs-number">0x090b</span></span>, <span class="hljs-number"><span class="hljs-number">0x0475</span></span>, <span class="hljs-number"><span class="hljs-number">0x00ab</span></span>, <span class="hljs-number"><span class="hljs-number">0x09cc</span></span>, <span class="hljs-number"><span class="hljs-number">0x0312</span></span>, <span class="hljs-number"><span class="hljs-number">0x0603</span></span>, <span class="hljs-number"><span class="hljs-number">0x0907</span></span>, <span class="hljs-number"><span class="hljs-number">0x07fa</span></span>, <span class="hljs-number"><span class="hljs-number">0x00b9</span></span>, <span class="hljs-number"><span class="hljs-number">0x0909</span></span>, <span class="hljs-number"><span class="hljs-number">0x0889</span></span>, <span class="hljs-number"><span class="hljs-number">0x0360</span></span>, <span class="hljs-number"><span class="hljs-number">0x0247</span></span>, <span class="hljs-number"><span class="hljs-number">0x00cc</span></span>, <span class="hljs-number"><span class="hljs-number">0x054c</span></span>, <span class="hljs-number"><span class="hljs-number">0x0213</span></span>, <span class="hljs-number"><span class="hljs-number">0x054e</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a44</span></span>, <span class="hljs-number"><span class="hljs-number">0x0767</span></span>, <span class="hljs-number"><span class="hljs-number">0x07b0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0074</span></span>, <span class="hljs-number"><span class="hljs-number">0x087b</span></span>, <span class="hljs-number"><span class="hljs-number">0x041e</span></span>, <span class="hljs-number"><span class="hljs-number">0x098a</span></span>, <span class="hljs-number"><span class="hljs-number">0x087d</span></span>, <span class="hljs-number"><span class="hljs-number">0x03ab</span></span>, <span class="hljs-number"><span class="hljs-number">0x069c</span></span>, <span class="hljs-number"><span class="hljs-number">0x06cc</span></span>, <span class="hljs-number"><span class="hljs-number">0x0604</span></span>, <span class="hljs-number"><span class="hljs-number">0x095f</span></span>, <span class="hljs-number"><span class="hljs-number">0x053f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0954</span></span>, <span class="hljs-number"><span class="hljs-number">0x02da</span></span>, <span class="hljs-number"><span class="hljs-number">0x06d1</span></span>, <span class="hljs-number"><span class="hljs-number">0x08f0</span></span>, <span class="hljs-number"><span class="hljs-number">0x09bf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01db</span></span>, <span class="hljs-number"><span class="hljs-number">0x039e</span></span>, <span class="hljs-number"><span class="hljs-number">0x08a8</span></span>, <span class="hljs-number"><span class="hljs-number">0x0ac5</span></span>, <span class="hljs-number"><span class="hljs-number">0x007a</span></span>, <span class="hljs-number"><span class="hljs-number">0x0222</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a8f</span></span>, <span class="hljs-number"><span class="hljs-number">0x042f</span></span>, <span class="hljs-number"><span class="hljs-number">0x0322</span></span>, <span class="hljs-number"><span class="hljs-number">0x01f0</span></span>, <span class="hljs-number"><span class="hljs-number">0x00e3</span></span>, <span class="hljs-number"><span class="hljs-number">0x00f7</span></span>, <span class="hljs-number"><span class="hljs-number">0x0417</span></span>, <span class="hljs-number"><span class="hljs-number">0x09aa</span></span>, <span class="hljs-number"><span class="hljs-number">0x00fc</span></span>, <span class="hljs-number"><span class="hljs-number">0x077a</span></span>, <span class="hljs-number"><span class="hljs-number">0x04e9</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a21</span></span>, <span class="hljs-number"><span class="hljs-number">0x0278</span></span>, <span class="hljs-number"><span class="hljs-number">0x06f7</span></span>, <span class="hljs-number"><span class="hljs-number">0x07ef</span></span>, <span class="hljs-number"><span class="hljs-number">0x08e7</span></span>, <span class="hljs-number"><span class="hljs-number">0x09cd</span></span>, <span class="hljs-number"><span class="hljs-number">0x04aa</span></span>, <span class="hljs-number"><span class="hljs-number">0x0739</span></span>, <span class="hljs-number"><span class="hljs-number">0x09e3</span></span>, <span class="hljs-number"><span class="hljs-number">0x0708</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a72</span></span>, <span class="hljs-number"><span class="hljs-number">0x028e</span></span>, <span class="hljs-number"><span class="hljs-number">0x04a6</span></span>, <span class="hljs-number"><span class="hljs-number">0x04c0</span></span>, <span class="hljs-number"><span class="hljs-number">0x021b</span></span>, <span class="hljs-number"><span class="hljs-number">0x081d</span></span>, <span class="hljs-number"><span class="hljs-number">0x05c5</span></span>, <span class="hljs-number"><span class="hljs-number">0x069a</span></span>, <span class="hljs-number"><span class="hljs-number">0x05bc</span></span>, <span class="hljs-number"><span class="hljs-number">0x06ca</span></span>, <span class="hljs-number"><span class="hljs-number">0x00eb</span></span>, <span class="hljs-number"><span class="hljs-number">0x00ec</span></span>, <span class="hljs-number"><span class="hljs-number">0x0a9b</span></span>, <span class="hljs-number"><span class="hljs-number">0x04f7</span></span>, <span class="hljs-number"><span class="hljs-number">0x07a2</span></span>, <span class="hljs-number"><span class="hljs-number">0x04ec</span></span>, <span class="hljs-number"><span class="hljs-number">0x0338</span></span>, <span class="hljs-number"><span class="hljs-number">0x05b7</span></span>, <span class="hljs-number"><span class="hljs-number">0x0459</span></span>, <span class="hljs-number"><span class="hljs-number">0x043d</span></span>, <span class="hljs-number"><span class="hljs-number">0x02f5</span></span>, <span class="hljs-number"><span class="hljs-number">0x0284</span></span>, <span class="hljs-number"><span class="hljs-number">0x023b</span></span>, <span class="hljs-number"><span class="hljs-number">0x01f5</span></span>, <span class="hljs-number"><span class="hljs-number">0x0979</span></span>, <span class="hljs-number"><span class="hljs-number">0x01c4</span></span>, <span class="hljs-number"><span class="hljs-number">0x027b</span></span>, <span class="hljs-number"><span class="hljs-number">0x0868</span></span>, <span class="hljs-number"><span class="hljs-number">0x043c</span></span>, <span class="hljs-number"><span class="hljs-number">0x0397</span></span>, <span class="hljs-number"><span class="hljs-number">0x048f</span></span> };</code> </pre> <br></div></div><br>  <b>5.</b> We get from the programmer 1 byte and remember it as a marker.  After that we send random 4th bytes to the programmer.  The programmer, having received these 4 bytes, in the same way as we in paragraph 4 encrypts them using the same RSA algorithm and sends us the resulting 8 bytes in the same order (first the highest, then the low byte from each word).  Having received these 8 bytes, we have to check whether the programmer has coped with the task and, if the answer is positive, we send him the previously received marker. <br><br>  <b>6.</b> We receive from the programmer 1 byte and again we remember it as a marker.  Then we form in the array, say, buf11 - 11 random bytes and save it for subsequent actions.  Then, in a sly way, we send these 11 bytes to the programmer.  The trick is that we have to send 88 bytes to the programmer, into which the 11 formed by us will be packed, and the low bit of the marker is used to invert the transmitted 11 bytes.  After sending 88 bytes to the programmer, we send the received marker to it. <br><br><div class="spoiler">  <b class="spoiler_title">Litter Code in C.</b> <div class="spoiler_text"><pre> <code class="cpp hljs">byte _mark; <span class="hljs-comment"><span class="hljs-comment">//    . byte _buf11[11]; //   11-  . for( i=0; i&lt;11; i++ ) { byte bt = rand(); _buf11[i] = bt; if( _mark &amp; 1 ) bt = ~bt; //     8. // for( j=0; j&lt;8; j++ ) { byte rnd = rand(); byte msk = ( 1 &lt;&lt; j ); if( bt &amp; msk ) rnd |= msk; else rnd &amp;= ~msk; //   rnd        . // ( rnd ); } } //    . // ( _mark );</span></span></code> </pre></div></div><br>  <b>7.</b> We receive from the programmer 1 byte and send to it an array of 133 bytes, consisting of four parts. <br><br>  The first part - 48 bytes with information about the type of adapter and its "age" was taken from the native adapter "DX0001", in which the text "DX0001" was replaced by "DX1011". <br><br><div class="spoiler">  <b class="spoiler_title">Adapter id</b> <div class="spoiler_text"><pre> <code class="cpp hljs">{ <span class="hljs-string"><span class="hljs-string">'D'</span></span>, <span class="hljs-string"><span class="hljs-string">'X'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>, <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>, <span class="hljs-string"><span class="hljs-string">'2'</span></span>, <span class="hljs-string"><span class="hljs-string">'4'</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0x50</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x0c</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span> };</code> </pre></div></div><br>  The second part is 16 random bytes. <br><br>  The third part is 22 bytes, specially formed from the previously saved buf11 11 bytes. <br><br><div class="spoiler">  <b class="spoiler_title">The code for the formation of 22 bytes in C</b> <div class="spoiler_text"><pre> <code class="cpp hljs">byte _buf22[<span class="hljs-number"><span class="hljs-number">22</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> byte _hash[] = { <span class="hljs-number"><span class="hljs-number">0x58</span></span>,<span class="hljs-number"><span class="hljs-number">0x3E</span></span>,<span class="hljs-number"><span class="hljs-number">0x09</span></span>,<span class="hljs-number"><span class="hljs-number">0x2D</span></span>,<span class="hljs-number"><span class="hljs-number">0xFD</span></span>,<span class="hljs-number"><span class="hljs-number">0x45</span></span>,<span class="hljs-number"><span class="hljs-number">0x68</span></span>,<span class="hljs-number"><span class="hljs-number">0x10</span></span>,<span class="hljs-number"><span class="hljs-number">0xD5</span></span>,<span class="hljs-number"><span class="hljs-number">0x25</span></span>,<span class="hljs-number"><span class="hljs-number">0xC7</span></span>,<span class="hljs-number"><span class="hljs-number">0xB8</span></span>,<span class="hljs-number"><span class="hljs-number">0x28</span></span>,<span class="hljs-number"><span class="hljs-number">0x93</span></span>,<span class="hljs-number"><span class="hljs-number">0x75</span></span>,<span class="hljs-number"><span class="hljs-number">0xDE</span></span>, <span class="hljs-number"><span class="hljs-number">0x57</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0x1E</span></span>,<span class="hljs-number"><span class="hljs-number">0x24</span></span>,<span class="hljs-number"><span class="hljs-number">0x36</span></span>,<span class="hljs-number"><span class="hljs-number">0xB6</span></span>,<span class="hljs-number"><span class="hljs-number">0x3A</span></span>,<span class="hljs-number"><span class="hljs-number">0x59</span></span>,<span class="hljs-number"><span class="hljs-number">0x11</span></span>,<span class="hljs-number"><span class="hljs-number">0x6E</span></span>,<span class="hljs-number"><span class="hljs-number">0x58</span></span>,<span class="hljs-number"><span class="hljs-number">0x91</span></span>,<span class="hljs-number"><span class="hljs-number">0xAE</span></span>,<span class="hljs-number"><span class="hljs-number">0x53</span></span>,<span class="hljs-number"><span class="hljs-number">0x69</span></span>,<span class="hljs-number"><span class="hljs-number">0xDF</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>,<span class="hljs-number"><span class="hljs-number">0xA4</span></span>,<span class="hljs-number"><span class="hljs-number">0x8B</span></span>,<span class="hljs-number"><span class="hljs-number">0xFB</span></span>,<span class="hljs-number"><span class="hljs-number">0x76</span></span>,<span class="hljs-number"><span class="hljs-number">0x91</span></span>,<span class="hljs-number"><span class="hljs-number">0x59</span></span>,<span class="hljs-number"><span class="hljs-number">0x3C</span></span>,<span class="hljs-number"><span class="hljs-number">0x30</span></span>,<span class="hljs-number"><span class="hljs-number">0xB9</span></span>,<span class="hljs-number"><span class="hljs-number">0xDA</span></span>,<span class="hljs-number"><span class="hljs-number">0x21</span></span>,<span class="hljs-number"><span class="hljs-number">0xD8</span></span>,<span class="hljs-number"><span class="hljs-number">0x05</span></span>,<span class="hljs-number"><span class="hljs-number">0xB4</span></span>,<span class="hljs-number"><span class="hljs-number">0x16</span></span>, <span class="hljs-number"><span class="hljs-number">0x4C</span></span>,<span class="hljs-number"><span class="hljs-number">0x05</span></span>,<span class="hljs-number"><span class="hljs-number">0x78</span></span>,<span class="hljs-number"><span class="hljs-number">0x8D</span></span>,<span class="hljs-number"><span class="hljs-number">0xB5</span></span>,<span class="hljs-number"><span class="hljs-number">0x1C</span></span>,<span class="hljs-number"><span class="hljs-number">0x41</span></span>,<span class="hljs-number"><span class="hljs-number">0x63</span></span>,<span class="hljs-number"><span class="hljs-number">0x4C</span></span>,<span class="hljs-number"><span class="hljs-number">0xBE</span></span>,<span class="hljs-number"><span class="hljs-number">0xA6</span></span>,<span class="hljs-number"><span class="hljs-number">0xCC</span></span>,<span class="hljs-number"><span class="hljs-number">0x65</span></span>,<span class="hljs-number"><span class="hljs-number">0xB8</span></span>,<span class="hljs-number"><span class="hljs-number">0x38</span></span>,<span class="hljs-number"><span class="hljs-number">0x1D</span></span>, <span class="hljs-number"><span class="hljs-number">0xE7</span></span>,<span class="hljs-number"><span class="hljs-number">0xC6</span></span>,<span class="hljs-number"><span class="hljs-number">0xC9</span></span>,<span class="hljs-number"><span class="hljs-number">0x19</span></span>,<span class="hljs-number"><span class="hljs-number">0xB7</span></span>,<span class="hljs-number"><span class="hljs-number">0x73</span></span>,<span class="hljs-number"><span class="hljs-number">0xB2</span></span>,<span class="hljs-number"><span class="hljs-number">0x7D</span></span>,<span class="hljs-number"><span class="hljs-number">0xCD</span></span>,<span class="hljs-number"><span class="hljs-number">0x54</span></span>,<span class="hljs-number"><span class="hljs-number">0xDC</span></span>,<span class="hljs-number"><span class="hljs-number">0xFE</span></span>,<span class="hljs-number"><span class="hljs-number">0x67</span></span>,<span class="hljs-number"><span class="hljs-number">0x5E</span></span>,<span class="hljs-number"><span class="hljs-number">0x79</span></span>,<span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0xB8</span></span>,<span class="hljs-number"><span class="hljs-number">0x77</span></span>,<span class="hljs-number"><span class="hljs-number">0x73</span></span>,<span class="hljs-number"><span class="hljs-number">0x37</span></span>,<span class="hljs-number"><span class="hljs-number">0xC8</span></span>,<span class="hljs-number"><span class="hljs-number">0x56</span></span>,<span class="hljs-number"><span class="hljs-number">0xA2</span></span>,<span class="hljs-number"><span class="hljs-number">0x4D</span></span>,<span class="hljs-number"><span class="hljs-number">0x9B</span></span>,<span class="hljs-number"><span class="hljs-number">0x86</span></span>,<span class="hljs-number"><span class="hljs-number">0x56</span></span>,<span class="hljs-number"><span class="hljs-number">0x3F</span></span>,<span class="hljs-number"><span class="hljs-number">0x26</span></span>,<span class="hljs-number"><span class="hljs-number">0x39</span></span>,<span class="hljs-number"><span class="hljs-number">0xDE</span></span>,<span class="hljs-number"><span class="hljs-number">0xF6</span></span>, <span class="hljs-number"><span class="hljs-number">0xA8</span></span>,<span class="hljs-number"><span class="hljs-number">0x13</span></span>,<span class="hljs-number"><span class="hljs-number">0xB4</span></span>,<span class="hljs-number"><span class="hljs-number">0xBA</span></span>,<span class="hljs-number"><span class="hljs-number">0x19</span></span>,<span class="hljs-number"><span class="hljs-number">0xDE</span></span>,<span class="hljs-number"><span class="hljs-number">0xDF</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x64</span></span>,<span class="hljs-number"><span class="hljs-number">0x2A</span></span>,<span class="hljs-number"><span class="hljs-number">0x9F</span></span>,<span class="hljs-number"><span class="hljs-number">0xA4</span></span>,<span class="hljs-number"><span class="hljs-number">0x3E</span></span>,<span class="hljs-number"><span class="hljs-number">0xEE</span></span>,<span class="hljs-number"><span class="hljs-number">0x90</span></span>,<span class="hljs-number"><span class="hljs-number">0x5B</span></span>, <span class="hljs-number"><span class="hljs-number">0xF0</span></span>,<span class="hljs-number"><span class="hljs-number">0xF3</span></span>,<span class="hljs-number"><span class="hljs-number">0xC6</span></span>,<span class="hljs-number"><span class="hljs-number">0x5F</span></span>,<span class="hljs-number"><span class="hljs-number">0x1F</span></span>,<span class="hljs-number"><span class="hljs-number">0x84</span></span>,<span class="hljs-number"><span class="hljs-number">0x87</span></span>,<span class="hljs-number"><span class="hljs-number">0xA3</span></span>,<span class="hljs-number"><span class="hljs-number">0x94</span></span>,<span class="hljs-number"><span class="hljs-number">0x0D</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x92</span></span>,<span class="hljs-number"><span class="hljs-number">0xDC</span></span>,<span class="hljs-number"><span class="hljs-number">0x3C</span></span>,<span class="hljs-number"><span class="hljs-number">0xD0</span></span>,<span class="hljs-number"><span class="hljs-number">0x6A</span></span>, <span class="hljs-number"><span class="hljs-number">0xD6</span></span>,<span class="hljs-number"><span class="hljs-number">0x9B</span></span>,<span class="hljs-number"><span class="hljs-number">0xA9</span></span>,<span class="hljs-number"><span class="hljs-number">0xED</span></span>,<span class="hljs-number"><span class="hljs-number">0x02</span></span>,<span class="hljs-number"><span class="hljs-number">0xB0</span></span>,<span class="hljs-number"><span class="hljs-number">0xB3</span></span>,<span class="hljs-number"><span class="hljs-number">0xBB</span></span>,<span class="hljs-number"><span class="hljs-number">0xF3</span></span>,<span class="hljs-number"><span class="hljs-number">0x17</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0x93</span></span>,<span class="hljs-number"><span class="hljs-number">0x8F</span></span>,<span class="hljs-number"><span class="hljs-number">0x18</span></span>,<span class="hljs-number"><span class="hljs-number">0x22</span></span>,<span class="hljs-number"><span class="hljs-number">0x9B</span></span>, <span class="hljs-number"><span class="hljs-number">0x33</span></span>,<span class="hljs-number"><span class="hljs-number">0x0F</span></span>,<span class="hljs-number"><span class="hljs-number">0x2A</span></span>,<span class="hljs-number"><span class="hljs-number">0x4C</span></span>,<span class="hljs-number"><span class="hljs-number">0x72</span></span>,<span class="hljs-number"><span class="hljs-number">0x1A</span></span>,<span class="hljs-number"><span class="hljs-number">0x0F</span></span>,<span class="hljs-number"><span class="hljs-number">0xC2</span></span>,<span class="hljs-number"><span class="hljs-number">0x3E</span></span>,<span class="hljs-number"><span class="hljs-number">0x4C</span></span>,<span class="hljs-number"><span class="hljs-number">0x77</span></span>,<span class="hljs-number"><span class="hljs-number">0xAA</span></span>,<span class="hljs-number"><span class="hljs-number">0xF2</span></span>,<span class="hljs-number"><span class="hljs-number">0x04</span></span>,<span class="hljs-number"><span class="hljs-number">0xDC</span></span>,<span class="hljs-number"><span class="hljs-number">0x60</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>,<span class="hljs-number"><span class="hljs-number">0x81</span></span>,<span class="hljs-number"><span class="hljs-number">0x7B</span></span>,<span class="hljs-number"><span class="hljs-number">0x7C</span></span>,<span class="hljs-number"><span class="hljs-number">0x60</span></span>,<span class="hljs-number"><span class="hljs-number">0xE7</span></span>,<span class="hljs-number"><span class="hljs-number">0xD3</span></span>,<span class="hljs-number"><span class="hljs-number">0x61</span></span>,<span class="hljs-number"><span class="hljs-number">0x3A</span></span>,<span class="hljs-number"><span class="hljs-number">0xDA</span></span>,<span class="hljs-number"><span class="hljs-number">0x69</span></span>,<span class="hljs-number"><span class="hljs-number">0x4A</span></span>,<span class="hljs-number"><span class="hljs-number">0x14</span></span>,<span class="hljs-number"><span class="hljs-number">0x5A</span></span>,<span class="hljs-number"><span class="hljs-number">0xB7</span></span>,<span class="hljs-number"><span class="hljs-number">0x31</span></span>, <span class="hljs-number"><span class="hljs-number">0x9F</span></span>,<span class="hljs-number"><span class="hljs-number">0xB5</span></span>,<span class="hljs-number"><span class="hljs-number">0x60</span></span>,<span class="hljs-number"><span class="hljs-number">0x61</span></span>,<span class="hljs-number"><span class="hljs-number">0xB4</span></span>,<span class="hljs-number"><span class="hljs-number">0x2D</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x10</span></span>,<span class="hljs-number"><span class="hljs-number">0xCF</span></span>,<span class="hljs-number"><span class="hljs-number">0x16</span></span>,<span class="hljs-number"><span class="hljs-number">0x6B</span></span>,<span class="hljs-number"><span class="hljs-number">0xF1</span></span>,<span class="hljs-number"><span class="hljs-number">0x08</span></span>,<span class="hljs-number"><span class="hljs-number">0x81</span></span>,<span class="hljs-number"><span class="hljs-number">0xDA</span></span>,<span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0xA6</span></span>,<span class="hljs-number"><span class="hljs-number">0x46</span></span>,<span class="hljs-number"><span class="hljs-number">0xF2</span></span>,<span class="hljs-number"><span class="hljs-number">0xA2</span></span>,<span class="hljs-number"><span class="hljs-number">0x14</span></span>,<span class="hljs-number"><span class="hljs-number">0x68</span></span>,<span class="hljs-number"><span class="hljs-number">0xAA</span></span>,<span class="hljs-number"><span class="hljs-number">0x48</span></span>,<span class="hljs-number"><span class="hljs-number">0x94</span></span>,<span class="hljs-number"><span class="hljs-number">0x8B</span></span>,<span class="hljs-number"><span class="hljs-number">0x9D</span></span>,<span class="hljs-number"><span class="hljs-number">0xE3</span></span>,<span class="hljs-number"><span class="hljs-number">0xD0</span></span>,<span class="hljs-number"><span class="hljs-number">0xFB</span></span>,<span class="hljs-number"><span class="hljs-number">0x84</span></span>,<span class="hljs-number"><span class="hljs-number">0x74</span></span>, <span class="hljs-number"><span class="hljs-number">0x1C</span></span>,<span class="hljs-number"><span class="hljs-number">0x3C</span></span>,<span class="hljs-number"><span class="hljs-number">0x94</span></span>,<span class="hljs-number"><span class="hljs-number">0x5A</span></span>,<span class="hljs-number"><span class="hljs-number">0x3F</span></span>,<span class="hljs-number"><span class="hljs-number">0xF0</span></span>,<span class="hljs-number"><span class="hljs-number">0x37</span></span>,<span class="hljs-number"><span class="hljs-number">0x8C</span></span>,<span class="hljs-number"><span class="hljs-number">0xD9</span></span>,<span class="hljs-number"><span class="hljs-number">0x7E</span></span>,<span class="hljs-number"><span class="hljs-number">0xA7</span></span>,<span class="hljs-number"><span class="hljs-number">0x38</span></span>,<span class="hljs-number"><span class="hljs-number">0xA4</span></span>,<span class="hljs-number"><span class="hljs-number">0xB5</span></span>,<span class="hljs-number"><span class="hljs-number">0xA7</span></span>,<span class="hljs-number"><span class="hljs-number">0x25</span></span>, <span class="hljs-number"><span class="hljs-number">0x65</span></span>,<span class="hljs-number"><span class="hljs-number">0x15</span></span>,<span class="hljs-number"><span class="hljs-number">0x7F</span></span>,<span class="hljs-number"><span class="hljs-number">0xE5</span></span>,<span class="hljs-number"><span class="hljs-number">0x3B</span></span>,<span class="hljs-number"><span class="hljs-number">0xD1</span></span>,<span class="hljs-number"><span class="hljs-number">0x14</span></span>,<span class="hljs-number"><span class="hljs-number">0x1E</span></span>,<span class="hljs-number"><span class="hljs-number">0xD3</span></span>,<span class="hljs-number"><span class="hljs-number">0xA8</span></span>,<span class="hljs-number"><span class="hljs-number">0x47</span></span>,<span class="hljs-number"><span class="hljs-number">0x2E</span></span>,<span class="hljs-number"><span class="hljs-number">0xD8</span></span>,<span class="hljs-number"><span class="hljs-number">0xEB</span></span>,<span class="hljs-number"><span class="hljs-number">0xB0</span></span>,<span class="hljs-number"><span class="hljs-number">0xAE</span></span>, <span class="hljs-number"><span class="hljs-number">0x4F</span></span>,<span class="hljs-number"><span class="hljs-number">0x34</span></span>,<span class="hljs-number"><span class="hljs-number">0xF4</span></span>,<span class="hljs-number"><span class="hljs-number">0x52</span></span>,<span class="hljs-number"><span class="hljs-number">0xC7</span></span>,<span class="hljs-number"><span class="hljs-number">0x23</span></span>,<span class="hljs-number"><span class="hljs-number">0x9D</span></span>,<span class="hljs-number"><span class="hljs-number">0x60</span></span>,<span class="hljs-number"><span class="hljs-number">0x98</span></span>,<span class="hljs-number"><span class="hljs-number">0x1E</span></span>,<span class="hljs-number"><span class="hljs-number">0x2C</span></span>,<span class="hljs-number"><span class="hljs-number">0xFC</span></span>,<span class="hljs-number"><span class="hljs-number">0xF2</span></span>,<span class="hljs-number"><span class="hljs-number">0x96</span></span>,<span class="hljs-number"><span class="hljs-number">0xB7</span></span>,<span class="hljs-number"><span class="hljs-number">0x83</span></span> }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PrepareBuf22</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ byte i, j, bt, bt1, bt2, bt3; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>; i++ ) _buf22[i] = rand(); bt2 = (_buf22[<span class="hljs-number"><span class="hljs-number">1</span></span>] ^ _buf22[<span class="hljs-number"><span class="hljs-number">2</span></span>] ) &amp; <span class="hljs-number"><span class="hljs-number">0xEF</span></span>; bt3 = _buf22[<span class="hljs-number"><span class="hljs-number">1</span></span>] ^ _buf22[<span class="hljs-number"><span class="hljs-number">3</span></span>]; _buf22[<span class="hljs-number"><span class="hljs-number">4</span></span>] = (byte)((_buf22[<span class="hljs-number"><span class="hljs-number">0</span></span>] + _buf22[<span class="hljs-number"><span class="hljs-number">1</span></span>] + _buf22[<span class="hljs-number"><span class="hljs-number">2</span></span>]) ^ _buf22[<span class="hljs-number"><span class="hljs-number">3</span></span>]); _buf22[<span class="hljs-number"><span class="hljs-number">1</span></span>] ^= ( <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; (_buf22[<span class="hljs-number"><span class="hljs-number">2</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">7</span></span>) ); bt = _buf22[<span class="hljs-number"><span class="hljs-number">2</span></span>]; bt1 = _buf22[<span class="hljs-number"><span class="hljs-number">0</span></span>]; i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>( i &lt; <span class="hljs-number"><span class="hljs-number">10</span></span> ) { bt += _buf11[i++]; bt1 += _buf11[i++]; } _buf22[<span class="hljs-number"><span class="hljs-number">5</span></span>] = bt; _buf22[<span class="hljs-number"><span class="hljs-number">6</span></span>] = bt1; <span class="hljs-comment"><span class="hljs-comment">// ---------------------------------------------------------------- _buf22[7+11] = 0; _buf22[7+12] = 0; for( i=0; i&lt;10; i++ ) { _buf22[7+11] += _buf11[i]; _buf22[7+12] ^= _buf11[i]; } _buf22[7+11] ^= _buf11[9]; _buf22[7+12] ^= _buf11[10]; _buf22[7+13] = (_buf22[7+11] + _buf11[10]) ^ _buf22[7+12]; _buf22[7+14] = (_buf22[7+13] + _buf11[9]) ^ _buf22[7+12]; for( i=0; i&lt;15; i++ ) { bt = (_buf22[7+i] ^ _hash[bt2+i] ); bt = (bt &lt;&lt; 2) | (bt &gt;&gt; 6); bt ^= bt3; _buf22[7+i] = bt; } }</span></span></code> </pre></div></div><br>  The fourth part - 47 random bytes. <br><br>  <b>8.</b> After transmitting an array of 133 bytes, the microchip should either go to sleep until the next active high level appears on pin 7, or it automatically switches to the reset state, in case pin 7 is a reset signal.  And then everything repeats, starting with paragraph 2. <br><br><h3>  Extract recovered patient </h3><br>  In the end, the CX1011 adapter was safely put on its feet and got a second life in a new programmer. <br><br>  Hopefully, the material in this article will help readers safely revitalize other ‚Äúold‚Äù adapters, and perhaps make their own. </div><p>Source: <a href="https://habr.com/ru/post/320870/">https://habr.com/ru/post/320870/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320860/index.html">VR-Design: a look into the virtual world</a></li>
<li><a href="../320862/index.html">Recommendations for the use of Hero Images (UPD)</a></li>
<li><a href="../320864/index.html">The book "Programming without fools"</a></li>
<li><a href="../320866/index.html">The logic of consciousness. Part 10. The task of generalization</a></li>
<li><a href="../320868/index.html">PR for a startup: which sites must write about your company</a></li>
<li><a href="../320872/index.html">Docker implementation for a small project in Production, part 3</a></li>
<li><a href="../320874/index.html">Visualization of data in the browser using D3.js</a></li>
<li><a href="../320878/index.html">Master-master replication and scaling of applications between all IoT devices and the cloud</a></li>
<li><a href="../320880/index.html">VPS hosting and cloud hosting: what to choose and what is the difference?</a></li>
<li><a href="../320882/index.html">Off splinters from the brain. 15 stereotypes about CRM-systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>