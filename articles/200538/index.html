<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Device Server - interface converter or simple Tibbo PLC?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear Habrovchane. 
 This article can be divided into three parts. In the first, we will talk about converters of RS232 / Ethernet interfaces...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Device Server - interface converter or simple Tibbo PLC?</h1><div class="post__text post__text-html js-mediator-article">  Good day, dear Habrovchane. <br>  This article can be divided into three parts.  In the first, we will talk about converters of RS232 / Ethernet interfaces - what it is and how it is used. <br>  In the second, using the example of creating a ModBus ASCII_RTU / ModBus TCP gateway, I will demonstrate the possibility of programming Tibbo converters. <br>  And finally, in the third part we will try to create an automatic heating control system, from a slightly modified Tibbo interface converter, with the ability to send commands via SMS messages, web-based management interface and data upload to MySQL. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb4/4fd/a32/bb44fda321e6f14bcc80e5a53d01c8df.jpg"></div><br><a name="habracut"></a><br><h4>  1. Device Server. </h4><br><h5>  1.1.  What is a device server or a little banality. </h5><br>  The western concept of Serial Device Server means Serial Interface Converter (RS232 / 422/485) to Ethernet.  The need for such devices has arisen for a simple reason: almost any microcontroller, regardless of the manufacturer, uses the UART interface (this is due to the technological simplicity of the implementation of this interface) on TTL or CMOS logic to communicate with the ‚Äúoutside world‚Äù.  Thus, a developer simply needs to connect a transceiver chip to the controller in order to receive a data transmission channel via RS232 / 485 interface.  But serial interfaces do not provide sufficient characteristics for the creation of modern communication systems.  On the other hand, there is an advanced Ethernet technology that allows you to create local subnets, merge them and organize data transfer channels between geographically distributed points around the world.  It is logical that the manufacturers of communication equipment decided to "combine" serial interfaces and Ethernet technology.  Thus, there were hardware gateways called Serial Device Server. <br><br>  RS232 / Ethernet interface converters from Taiwan-based <a href="http://tibbo.com/">Tibbo Technology</a> have been used around the world for 10 years.  During this time, the engineers of the company have accumulated vast experience in implementing projects using this equipment, solved non-trivial tasks, and expanded the functionality of the devices to a new level, far beyond the scope of "conventional" converters.  This line of devices is called <a href="http://tibbo.com/products/controllers.html">Tibbo Device Server</a> - <b>programmable</b> interface converters.  The key word in this definition is the word "programmable", since the final functionality of the device depends entirely on the firmware that was created and loaded into it. <br>  But let's start with a simple one. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e6/fd5/30f/1e6fd530ff4039f45918f4783ac8fb46.jpg"></div><br><h5>  1.2.  Serial Over IP. </h5><br>  Structurally, Tibbo Device Server (DS) devices are a small box the size of a pack of cigarettes.  On the one hand there is a standard connector (or several connectors) for the serial interface, on the other - a socket for connecting a twisted pair using Ethernet technology.  By default, the Tibbo Device Server comes with the ‚ÄúSerial Over IP‚Äù firmware, which allows data transfer between RS232 / 485 interfaces to Ethernet. <br>  After physical switching, it is necessary to configure the device parameters.  To do this, use a set of utilities from the manufacturer: DS Manager - designed to configure device parameters, VSP Manager - to configure the parameters of a virtual COM port, a virtual COM port driver, and several diagnostic utilities.  I will not elaborate on the description of the settings, but I will draw your attention to some features of these utilities: <br><ul><li>  Setting device parameters is carried out directly through the local network; </li><li>  Software works under any Windows OS; </li><li>  The driver of the virtual COM port is written qualitatively and many problems, such as <a href="http://habrahabr.ru/qa/28121/">here</a> , can be avoided.  Also, the driver version for Linux is written; </li><li>  There is the possibility of customization of software. </li></ul><br>  Interface converter can be configured in one of three modes.  Client mode is when the serial device initiates an Ethernet connection.  This mode is used for passive monitoring.  For example, when a PBX with a certain interval throws statistics on the server.  Or a barcode scanner transmits data to 1C.  In this mode, you specify the ip-address to which you want to send data, and the virtual COM port of the server listens to the TCP / IP port for the presence of an incoming data stream. <br>  Server mode - a serial device responds to an incoming request.  This mode can be used to interrogate I / O modules, PLCs, meters, etc. <br><img src="https://habrastorage.org/getpro/habr/post_images/a25/80a/254/a2580a254a20dce0ac4639def77fe54e.png" align="right"><br>  Server / client mode - combines both of the above options.  In this case, the virtual COM port of the server can both listen to the incoming data stream and establish a connection with the device at the specified ip address.  Where can similar solutions be used?  This is a multitude of vertical markets and applied tasks.  For example: <br><ul><li>  Interrogation and monitoring of electricity meters in the AMR systems; </li><li>  Poll heat meters or water meters in utilities; </li><li>  Collect data from barcode scanners or RFID readers and transfer them to 1C via a virtual port; </li><li>  Polling I / O modules; </li><li>  Remote monitoring and control of PLC modules; </li><li>  Monitoring PBX or building engineering systems; </li><li>  Fire safety or access control systems; </li><li>  Remote control of your own microcontroller; </li><li>  In other words, interface converters can be used wherever remote operation with serial interfaces is required. </li></ul><br>  Many will ask the question, and how are Tibbo devices better than analogs (which are enough in this segment)?  I will not compare technical specifications in detail, which are identical for most similar devices.  I will mention only the important features of Tibbo converters: <img src="https://habrastorage.org/getpro/habr/post_images/78e/e37/629/78ee37629cd313d75f45803b2004a5e1.jpg" align="right"><br><ul><li>  Convenient, high-quality and reliable software that works not only under Windows, but also under Linux; </li><li>  Reliable virtual COM port driver; </li><li>  The possibility of creating autonomous systems (device - DS - DS - device), without the participation of the PC; </li><li>  Ability to configure the converter through the Web management interface; </li><li>  As an option, the ability to use the WiFi network 802.11b / g.  Thus, we can transfer data from the serial port by means of wireless data transmission; </li><li>  As an option, the use of technology Power over Ethernet; </li><li>  A secure line of <a href="http://tibbo.com/products/controllers/ds10xx.html">DS10xx</a> equipment with serial port optocoupling, IP68 protection certificate and GPRS data transfer capability; </li><li>  Supports UDP, TCP, ARP, ICMP (PING), DHCP, PPPoE, LCP and HTTP protocols; </li><li>  Ability to configure via Telnet; </li><li>  Direct control of ADSL modems; </li><li>  The possibility of multichannel operation of the serial interface has been implemented (up to 3 devices with RS232 interface can be connected via one DB9 connector); </li><li>  Easy connection of converters to the <a href="http://aggregate.tibbo.com/solutions/scada_hmi.html">AggreGate Scada / HMI system</a> ; </li><li>  Not to mention the pricing policy, which compares favorably with the analogues. </li></ul><br>  But the main difference from competitors - Tibbo converters are <b>programmable</b> !  What if this functionality is not enough and you need something special?  Let's see how this can be achieved and how to unleash the full functionality of the Device Server from Tibbo Technology. <br><br><h4>  2. Programming Device Server or create a ModBus gateway. </h4><br>  What if there is a Scada system installed on the site that polls devices using ModBus TCP protocol.  And we need to interrogate the device with the ModBus RTU protocol and the RS232 serial channel on board.  Having connected the usual RS232 interface converter, we will get access to the local network and even the Internet, but Scada will not see any data without implementing the ModBus protocol. <br>  This is where the main feature of Tibbo converters comes in - the possibility of programming. <br>  Programs are encoded in the event object-oriented language Tibbo Basic.  I briefly wrote about this in an article about the <a href="http://habrahabr.ru/company/scancode/blog/194862/">Tibbo Project System</a> .  At the moment, the compiler for the language "C" is ready and its release will take place soon.  Thus, you can choose a programming language - a functional and deep "C" or a simpler, easier to understand Basic. <br>  The Tibbo IDE programming environment is free.  For debugging programs and firmware, no programmers are required; everything is done directly via the local Ethernet network, including step-by-step mode of program passage and breakpoints. <br>  So, for the realization of our task (device polling with ModBus RTU), we need to implement the ModBus protocol for Tibbo equipment.  Fortunately, the protocol has already been written and is in the <a href="http://tibbo.com/basic/resources/network/modbus.html">public domain</a> .  We just need to download it from the site, connect to the project, compile, flash the device and we get the ModBus RTU gateway in ModBus TCP. <br>  Here's what the probros data looks like in the source code, after connecting the libraries. <br><div class="spoiler">  <b class="spoiler_title">Source:</b> <div class="spoiler_text"><pre><code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">sub</span></span> on_ser_data_arrival() <span class="hljs-comment"><span class="hljs-comment">' ,       . dim x as string #if modbus_serial_mode = 0 'ASCII  x = ascii_to_tcp(ser.getdata(255)) '   ASCII  tcp #else 'RTU  x = rtu_to_tcp(ser.getdata(255)) '   RTU  tcp #endif sock.num = 0 sock.setdata(x) '       sock.send ' . end sub '-------------------------------------------------------------------- sub on_sock_data_arrival() ' ,      . dim x as string #if modbus_serial_mode = 0 'ASCII  x = tcp_to_ascii(sock.getdata(255)) '     ASCII #else 'RTU  x = tcp_to_rtu(sock.getdata(255)) '     RTU #endif ser.num = 0 ser.setdata(x) '       ser.send '  end sub ' ip ,     sub on_sys_init() ' ,       net.ip = "192.168.1.222" net.netmask = "255.255.255.0" net.gatewayip = "192.168.1.1" 'setup the Ethernet socket sock.num = 0 sock.protocol = PL_SOCK_PROTOCOL_TCP sock.inconmode = PL_SOCK_INCONMODE_ANY_IP_ANY_PORT sock.reconmode = PL_SOCK_RECONMODE_1 sock.localportlist = "502" sock.connectiontout=50 sock.rxbuffrq(2) sock.txbuffrq(2) 'setup the serial port ser.num = 0 ser.parity = PL_SER_PR_NONE ser.bits = PL_SER_BB_8 ser.flowcontrol = DISABLED ser.baudrate = ser.div9600 ser.interface = PL_SER_SI_FULLDUPLEX ser.interchardelay = 5 ser.rxbuffrq(3) ser.txbuffrq(2) sys.buffalloc ser.enabled = YES end sub</span></span></code> </pre> <br></div></div><br>  Expand the task.  The serial device does not support the ModBus protocol at all, and I want to connect it to the Scada system.  Then we program the polling of the required device metrics over the usual RS232 interface, take the ModBus TCP code and get the hardware driver specifically for your device. <br>  It is possible to further expand the task - is it necessary to back up data in case of a disconnection?  We use the built-in flash memory for 1 MB and store the data offline, until the connection is restored.  Need configuration via web interface?  We program the embedded web server and get the specified functionality. <br>  Thus, you can implement any protocol by creating your own hardware device drivers and even more.  You can program logic by getting your own little PLC. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  3. A little practice or management of heating in the forehead. </h4><br>  One day I came across a rather interesting task.  The private house has a heating system - two electric water boilers.  Water temperature sensors are installed at the boiler outlet and in the return leg of the pipeline; there is also an overpressure sensor and an outdoor temperature sensor in the system.  All sensors were connected to the analog input module MVA8 (ARIES), which ‚Äúcommunicates with the world‚Äù via the RS485 interface.  Task - remote monitoring sensor readings.  Ideally, the system should write values ‚Äã‚Äãto the MySQL database for further display of information on the customer‚Äôs personal website.  I chose the <a href="http://tibbo.com/products/controllers/ds110x/ds1102.html">DS1102</a> device. <br>  The first thing to do was implement the data transfer protocol for the MVA8 module.  The protocol is quite simple and several hours were spent on coding. As a result, a couple of useful functions were obtained for working with the analog input module, including get_data_sensor ().  The next step was the implementation of the MySql protocol.  Then I spent a little more time.  As a result, this problem was solved in a few hours.  The finished <a href="http://tibbo.com/basic/resources/data_transfer/mysql.html">library MySql</a> published on the manufacturer's website. <br>  So, DS1102 is now able to access the MySql database, can interrogate MBA8, it's time to do the simplest logic - interrogate sensors and write values ‚Äã‚Äãto the database. <br><div class="spoiler">  <b class="spoiler_title">Source:</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">sub</span></span> on_sys_timer <span class="hljs-comment"><span class="hljs-comment">' ,    0.5 . if sys.timercount&gt;delay_get_data then ' .    ,   ,    8 ser.num=0 '     get_data_sensor() ',     8,     end if End sub sub on_ser_data_arrival() dim buff, temp as string dim value as packet select case ser.num Case 0: '-----     ----- mva8=incoming_data(ser.getdata(ser.rxlen)) '   8     Value ( enum)       . ‚Ä¶. End select mysql_connect(‚Äúlogin‚Äù,‚Äùpassword‚Äù,‚Äùdatabase_name‚Äù) '      SQL     sql_query("INSERT INTO tbl_Sensor VALUES ("+ chr(34)+mva8.temperature_in+chr(34)+", "+ chr(34)+mva8.temperature_out+chr(34)+", "+ chr(34)+mva8.temperature_air+chr(34)+", "+ chr(34)+mva8.pressure+chr(34)+", "+ chr(34)+device_name+chr(34)+", "+ "NOW(),"+ chr(34)+chr(34)+")",0) sql_disconnect() End sub</span></span></code> </pre><br></div></div><br>  Everything works, data is successfully transferred to the MySql table.  The customer is satisfied and was ready to celebrate the successful implementation, when he suddenly asked: ‚ÄúCan you control the room temperature remotely?‚Äù.  Well, if you want, then we will do it. <br><br><h5>  Control of boilers using relays. </h5><br>  The manufacturer has provided the boiler power supply circuit with the possibility of switching on the heaters using external low power relays.  This method is very simple to implement, since it does not imply load power control.  This means that temperature control is performed "in the forehead", without using the PID controller.  But at the same time a large regulation error accumulates (overheating, then cooling).  It suited the customer.  But there was another problem.  In the DS1102 module - there is no relay.  But the relay is in the "modified" Device Server device - <a href="http://tibbo.com/products/controllers/ds10xx/ds10x4">DS1014</a> .  This model has not only relays, but also analog inputs, built-in GPRS and WiFi. <br><img src="https://habrastorage.org/getpro/habr/post_images/6fb/013/99d/6fb01399d64e7729131ad433e505538d.jpg" align="right"><br>  <i>A little distracted.</i>  <i>In fact, the Device Server devices from Tibbo are based on the so-called embedded modules, which I will discuss in subsequent articles.</i>  <i>We can consider these modules as programmable microcontrollers.</i>  <i>Using embedded in constructions with COM ports, we get an interface converter.</i>  <i>But it is worth adding to the ADC board, DAC, as we have already received a simple I / O module.</i>  <i>That is how the model was created DS1014.</i>  <i>It is not difficult to conclude that having one hardware basis, programs written under the ‚Äúdifferent‚Äù Tibbo hardware are in fact easily ported between them.</i>  <i>Thus, replacing one Tibbo device with another is painless.</i> <br><br>  The customer also agreed to this change (everyone would have such customers, right?).  Well, the existing code does not need to be rewritten.  Getting to work.  We look at the mismatch of the outdoor temperature with a given value and if it is more than the accepted delta, we decide to turn the heaters on or off.  The water pressure in the circuit fell below the critical level - turn off the boilers. <br><div class="spoiler">  <b class="spoiler_title">Source:</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">sub</span></span> on_sys_timer ‚Ä¶... <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> control = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-comment"><span class="hljs-comment">'   ,   ,  ,    ( ) If mva8.temperature_air&gt;temperature_set+delta then boiler(on) If mva8.temperature_air&lt;temperature_set-delta then boiler_on(off) End if If mva8.pressure&lt;pressure_min then '     ,      . boiler(off) Control = false Else Control = true End if End sub public sub boiler (on_off as string[3]) '  ,    2 ,   . select case on_off case ‚Äúon‚Äù: io.num=PL_IO_NUM_13_TX2 io.state=LOW io.enabled=Yes io.num=PL_IO_NUM_3 io.state=LOW io.enabled=Yes case ‚Äúoff‚Äù: io.num=PL_IO_NUM_13_TX2 io.enabled=NO io.num=PL_IO_NUM_3 io.enabled=NO end select end sub</span></span></code> </pre><br></div></div><br>  The relay clicks, the room is warm and comfortable.  True, the real algorithm still provides a delay between turning on / off the boilers in order to avoid ‚Äúbounce‚Äù when the temperature is in the boundary state.  Data on critical events on the object is transmitted to MySQL.  But we have not yet enabled the user to promptly set the required values ‚Äã‚Äãof the temperature in the room.  I easily implemented this using a web interface, because all modern Tibbo modules have an embedded web server.  At the same time and provided online monitoring of meters. <br><div class="spoiler">  <b class="spoiler_title">Source:</b> <div class="spoiler_text"><pre> <code class="vbscript hljs">&lt;h3&gt;  &lt;/h3&gt; &lt;table width=<span class="hljs-number"><span class="hljs-number">80</span></span>% align=center&gt; &lt;tr&gt;&lt;td&gt; &lt;br&gt; &lt;table width=<span class="hljs-number"><span class="hljs-number">100</span></span>% align=center border=<span class="hljs-string"><span class="hljs-string">"1"</span></span> cellspacing=<span class="hljs-string"><span class="hljs-string">"1"</span></span> cellpadding=<span class="hljs-string"><span class="hljs-string">"2"</span></span> &gt; &lt;form action=<span class="hljs-string"><span class="hljs-string">"online.html?"</span></span> method=<span class="hljs-string"><span class="hljs-string">"get"</span></span>&gt; &lt;? html_print_session?&gt; &lt;tr&gt; &lt;td width=<span class="hljs-number"><span class="hljs-number">33</span></span>%&gt;&lt;font color = &lt;?sock.setdata(FONT_COLOR_1) sock.send?&gt;&gt;&lt;b&gt;&lt;/b&gt;&lt;/td&gt; &lt;td width=<span class="hljs-number"><span class="hljs-number">33</span></span>%&gt;&lt;font color = &lt;?sock.setdata(FONT_COLOR_1) sock.send?&gt;&gt;&lt;b&gt;&lt;/b&gt;&lt;/td&gt; &lt;/tr&gt; &lt;? <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> html_login_state = LOGIN <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> html_print_value() <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ?&gt; &lt;/form&gt; &lt;/table&gt; &lt;/td&gt;&lt;/tr&gt; &lt;/table&gt;</code> </pre><br></div></div><br>  The function html_print_value () - polls the ports of MVA8 according to the already known algorithm and displays the values ‚Äã‚Äãon the html page. <br><br><h5>  SMS management </h5><br>  Great, everything is configured via the browser.  Customer satisfied.  But I can not stop.  How convenient it would be to set the temperature via SMS!  For example, when returning home after a busy day, write an SMS to our system so that it raises the temperature in the house to 25 ¬∞ C.  But our DS1014 model has a built-in GPRS modem, which is connected to one of the 4 serial ports of the controller.  Let's work a bit with the AT &amp; T teams. <br><div class="spoiler">  <b class="spoiler_title">Source:</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">sub</span></span> on_ser_data_arrival() ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ser.num ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-comment"><span class="hljs-comment">'-----        gsm ----- gsm_extract(ser.getdata(ser.rxbuffsize)) ... end select End sub public sub gsm_extract(buff as string) ‚Ä¶ select case prefix ‚Ä¶ case "+CMGR": i=instr(1,buff,chr(44),1) j=instr(1,buff,chr(44),2) cmpphone=mid(buff,i+2,ji-3) if cmpphone=phone then j=instr(9,buff,chr(13)+chr(10),1) data=mid(buff,j+2,len_buf-j-2-3) gsm_get_command(data) '     . end if in ="AT+CMGD="+num+chr(13) if val(num)&gt;10 then in="AT+CMGDA="+chr(34)+"DEL ALL"+chr(34)+chr(13) '     10   ,    SIM . ser.num=ser_gsm ser.setdata(in) ser.send case "error": ‚Ä¶. end select End sub</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/bf5/5a7/050/bf55a7050510695710c8ba029d86078b.jpg" align="right">  As you can see, in the code we compare the phone number from which the command came with the specified one.  The gsm_get_command () function - at the entrance it receives SMS text and extracts our commands from it.  For example, a text message with the text ‚ÄúSET TEMP 25‚Äù will give a command to set the temperature maintenance in the region of 25 ¬∞ C. <br>  What if there was a pipeline breakthrough (pressure dropped sharply)?  In this case, our system is already able to turn off the heaters, but you also need to warn the owner. <br><div class="spoiler">  <b class="spoiler_title">Source:</b> <div class="spoiler_text"><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">sub</span></span> on_sys_timer ‚Ä¶... <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> mva8.pressure&lt;pressure_min <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> boiler(off) Control = <span class="hljs-literal"><span class="hljs-literal">false</span></span> gsm_send_sms(<span class="hljs-string"><span class="hljs-string">"AT+CMGS="</span></span>,<span class="hljs-string"><span class="hljs-string">"CRITICAL PRESSURE. BOILER OFF."</span></span>) ... <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sub</span></span> gsm_send_sms(command as <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>,data as <span class="hljs-built_in"><span class="hljs-built_in">string</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">dim</span></span> gprs_data as <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> gprs_data =command+<span class="hljs-built_in"><span class="hljs-built_in">chr</span></span>(<span class="hljs-number"><span class="hljs-number">34</span></span>)+phone+<span class="hljs-built_in"><span class="hljs-built_in">chr</span></span>(<span class="hljs-number"><span class="hljs-number">34</span></span>)+<span class="hljs-built_in"><span class="hljs-built_in">chr</span></span>(<span class="hljs-number"><span class="hljs-number">13</span></span>)+data+<span class="hljs-built_in"><span class="hljs-built_in">chr</span></span>(<span class="hljs-number"><span class="hljs-number">26</span></span>)+<span class="hljs-built_in"><span class="hljs-built_in">chr</span></span>(<span class="hljs-number"><span class="hljs-number">13</span></span>) <span class="hljs-comment"><span class="hljs-comment">'   ,      ser.num=1 ser.setdata(gprs_data) '   . ser.send end sub</span></span></code> </pre><br></div></div><br>  Now the person in charge has received an alert about what is happening at the facility.  As you can see, programming is not complicated at all, and it would seem that such exotic things as SMS management are implemented quite simply and quickly.  There are analog input lines in the Device Server DS1014 device, so the whole system could do without the MBA8 module at all, but it was already at the site and so wanted by the customer.  It is worth mentioning that by connecting the AggreGate Agent software library to the written application, it is possible to upload metrics to AggreGate Scada. <br>  And with the release of a more flexible hardware automation platform Tibbo Project System (about which I wrote in the previous <a href="http://habrahabr.ru/company/scancode/blog/194862/">article</a> ), the implementation of such systems turns into a commonplace and elementary designer. <br>  It turns out that the equipment from Tibbo Technology is, of course, full-featured classic Device Server devices, in no way inferior to competitors and even superior to them.  But with the possibility of free programming and the output of the TPS hardware platform, the developers were given the opportunity to go far beyond this functionality: create their own converters, hardware gateways for protocols, and even their own PLCs. <br>  In combination with affordable pricing, technical support, a service center and our assistance in advising on project implementation, customers receive a quality product as a whole.  Contact our specialists and we will show you how our equipment will help solve problems in your projects. </div><p>Source: <a href="https://habr.com/ru/post/200538/">https://habr.com/ru/post/200538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../200522/index.html">Look: Android vs iOS</a></li>
<li><a href="../200528/index.html">How to teach scanners to scan silently by buttons without windows and crutches?</a></li>
<li><a href="../200530/index.html">The best startups of the Runet or the composition of the semi-finalists Web Ready 2013</a></li>
<li><a href="../200532/index.html">Coursera Launches Learning Hubs ‚Äî Physical Premises for Online Courses</a></li>
<li><a href="../200534/index.html">Automatic exclusion from the distribution of non-working email addresses</a></li>
<li><a href="../200540/index.html">Spread of epidemics: Social media analysis VS. Google Flu Query Analysis</a></li>
<li><a href="../200542/index.html">Overview of the battery case for Nexus 4 by Mugen Power</a></li>
<li><a href="../200544/index.html">Diagnostics of incidents on the fly</a></li>
<li><a href="../200546/index.html">How social networks affect site promotion</a></li>
<li><a href="../200552/index.html">Laptop Asus BU400A - a candidate for objects of desire</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>