<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Details of the transition from paired (relative) exchange rates to absolute. Bug work</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 


 This article describes the results of an experiment conducted in the framework of the Absolute Exchange Rates project. The protocol o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Details of the transition from paired (relative) exchange rates to absolute. Bug work</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/8e/sp/-n/8esp-nrqt6o1alu1vmlr2im5w5i.png" alt="image"></p><br><h2 id="vvedenie">  Introduction </h2><br><p>  This article describes the results of an experiment conducted in the framework of the Absolute Exchange Rates project.  The protocol of the experiment can be seen by clicking on the <a href="">link</a> . </p><br><p>  The project ‚Äú <a href="https://www.abscur.ru/">Absolute exchange rate</a> ‚Äù is engaged in the analysis of paired exchange rates, the selection of absolute exchange rates from them and their analysis.  Within the framework of the project, a method of converting from pair rates to absolute exchange rates was obtained.  Absolute currency ABS is defined for this.  Rates of all available currencies are expressed in relation to ABS. </p><a name="habracut"></a><br><p>  A detailed description of the technology is given in the article ‚Äú <a href="https://drive.google.com/file/d/0B57trm8LmQPjbWQyMS1xOWZPeVJhaGp3Tk5sX2RRMW1yMW1J/view">From currency pairs to absolute exchange rates</a> ‚Äù. </p><br><p>  To date, several articles have already been published on the application of the absolute exchange rate method.  I give the last two. </p><br><p>  The article ‚Äú <a href="https://docs.google.com/document/d/1ri4kZ4Ysn7aMOdUmofzE820eis8AHF48ONDES2SnWcM/edit%3Fusp%3Dsharing">Study of connectedness of world currencies through the correlation of absolute exchange rates</a> ‚Äù describes one of the applications of the absolute exchange rate technology.  A formal method for calculating the relationship between different currencies is given. </p><br><p>  The article ‚Äú <a href="https://docs.google.com/document/d/1IAL9UhrwtnO25ms3EBuQ4pAWmjIb4vSK1Oo6tw4efIw/edit%3Fusp%3Dsharing">The Markovits portfolio method with reference to the foreign exchange market</a> ‚Äù describes the previously unavailable technology for optimizing the currency portfolio. <br>  The following describes the method of conversion from paired (relative) exchange rates to absolute.  The numerical parameters of the transformation and the method of their calculation are given. </p><br><p>  In <a href="https://docs.google.com/spreadsheets/d/1_-cdNCIC6NgyRDj0zLJBaohXo-K8qCfxfDLbYq2JLhs">the source file,</a> daily exchange rates are automatically loaded daily and absolute ones are calculated from them. </p><br><p>  The transformation matrix was obtained in 2017.  It was calculated on real pair exchange rates by minimizing the deviation error of the restored pair rates from the absolute ones.  Since then, no error analysis has been performed on current data. </p><br><p>  The unexpected test results described below forced us to develop a new method for obtaining a transformation matrix.  In addition, an error was detected processing imported quotes. </p><br><h2 id="teoreticheskie-osnovaniya">  Theoretical foundations </h2><br><p>  To obtain absolute exchange rates, you need to do the following conversion.  For starters, paired courses are logarithmic.  Next, multiply them by the inverse transform matrix.  At the end we return back from the logarithmic scale using the exponent. </p><br><p>  For the further transition to pair courses, absolute courses should be prologarithmic.  Then multiply by the direct transformation matrix.  We finish as before using the exhibitors. </p><br><p>  The technology is described in more detail in the article ‚Äú <a href="https://drive.google.com/drive/folders/1M1Vgr83wEFbbkqp24b6VCxrELnHGfvAy">From currency pairs to absolute rates of individual currencies</a> ‚Äù (only this article in 2018 gives a transposed representation of transformation matrices in contrast to the presentation of this article). </p><br><p>  The direct matrix is ‚Äã‚Äãeasily determined.  The lines in it correspond to currencies, and the columns to currency pairs.  The matrix is ‚Äã‚Äãhighly sparse and consists of zeros, ones, and minus ones. </p><br><p><img src="https://habrastorage.org/webt/2z/jb/im/2zjbimb_r2yfa5xzill2bwjsj2s.png" alt="image"></p><br><p>  Zeros indicate the absence of such a pair and currency.  The unit corresponds to the currency in the pair numerator.  Minus one denotes the currency in the denominator of the pair. </p><br><p>  The inverse transformation matrix from pairs to absolute courses is not defined.  It is necessary to calculate.  The most obvious method is to minimize the recovery error of paired courses.  What was done to calculate this matrix in 2017.  Here is a graphical representation of this matrix. </p><br><p><img src="https://habrastorage.org/webt/ds/7i/s6/ds7is6h2-yqw7xcco2th9i3fkzg.png" alt="image"></p><br><h2 id="proverka-tochnosti-suschestvuyuschey-modeli">  Check the accuracy of the existing model </h2><br><p>  For the current matrix were obtained absolute and restored paired exchange rates.  There were sharp differences between the original and reconstructed paired courses. </p><br><p><img src="https://habrastorage.org/webt/sk/dx/ns/skdxnsanhywg1wwoatwk2fmgwiy.png" alt="image"></p><br><p>  Further, the calculation of recovery errors for all pairs was made. </p><br><p><img src="https://habrastorage.org/webt/me/hb/xj/mehbxjwbszb8ondceydznkh_7_4.png" alt="image"></p><br><p>  The error was considered as the average of the relative deviations taken in absolute value.  As you can see in the diagram, the errors for many pairs are almost twice as many as the values ‚Äã‚Äãthemselves. </p><br><p>  Of course, this level of error does not allow us to consider the model consistent and requires recalculation. </p><br><h2 id="psevdoobratnaya-matrica-ot-pryamoy">  Pseudoinverse matrix from a straight line </h2><br><p>  The first thing we will try is to calculate just the <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D0%25B0">inverse matrix</a> for the direct transformation matrix.  In view of the fact that the matrix is ‚Äã‚Äãnon-square, we will have to use a <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2581%25D0%25B5%25D0%25B2%25D0%25B4%25D0%25BE%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B0%25D1%2582%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D0%25B0">pseudoinverse transformation</a> .  The result is as follows. </p><br><p><img src="https://habrastorage.org/webt/u6/6i/ra/u66iraa9vu53qjanvvwlng2omiw.png" alt="image"></p><br><p>  It is very similar to what we got earlier using real pair rates for optimization. </p><br><p>  Calculate absolute rates.  Then we restore pair courses from absolute ones.  The error chart was the following. </p><br><p><img src="https://habrastorage.org/webt/oo/4p/tu/oo4ptuytyuzzwiw64jz9cpjhwiu.png" alt="image"></p><br><p>  Errors also turned out big as in the assessment above.  This model also can not arrange us. </p><br><h2 id="raschet-obratnoy-matricy-cherez-lineyno-nezavisimye-komponenty">  Calculation of the inverse matrix through linearly independent components </h2><br><p>  If we analyze in detail the direct transformation matrix, we can find that it has a <a href="https://ru.wikipedia.org/wiki/%25D0%2592%25D1%258B%25D1%2580%25D0%25BE%25D0%25B6%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D0%25B0">degenerate appearance</a> (the <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D0%25BD%25D0%25B3_%25D0%25BC%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D1%258B">rank of the matrix is</a> less than the number of currency rows).  In other words, there are linearly dependent rows in the direct matrix.  And therefore we will not be able to get an acceptable inverse matrix. </p><br><p>  To resolve the current situation, the following solution was proposed.  When moving from absolute courses to paired, you must first move to linearly independent components.  And only then go to the pairs.  The transition matrices from absolute courses to components and from components to pair courses will be non-degenerate and it will be possible to obtain inverse matrices. </p><br><p>  To search for linearly independent components, it is necessary to attach a unit pair-pairing matrix to the direct transformation matrix.  Thus, we obtain two matrices of transition from absolute courses to paired ones and an attached matrix of transitions from paired to paired. </p><br><p><img src="https://habrastorage.org/webt/d3/pv/22/d3pv2232ctljppjdntwebk8gpro.png" alt="image"></p><br><p> Now we will produce standard transformations to a <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2582%25D1%2583%25D0%25BF%25D0%25B5%25D0%25BD%25D1%2587%25D0%25B0%25D1%2582%25D1%258B%25D0%25B9_%25D0%25B2%25D0%25B8%25D0%25B4_%25D0%25BF%25D0%25BE_%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25BA%25D0%25B0%25D0%25BC">stepwise view of the</a> upper part of this combined matrix (in fact, the standard tools of the <a href="https://en.wikipedia.org/wiki/Wolfram_Mathematica">Wolfram Mathematica</a> mathematical package lead further to the <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25B8%25D0%25B0%25D0%25B3%25D0%25BE%25D0%25BD%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D0%25B0">diagonal form</a> ).  As a result, it was possible to obtain the following transformed matrix. </p><br><p><img src="https://habrastorage.org/webt/r2/nh/iu/r2nhiu8-negslilzroog4y1fugg.png" alt="image"></p><br><p>  Now in the columns of this matrix we have linearly independent components.  And we can move to them from both absolute courses (the upper part of the matrix) and from paired courses (the lower part of the combined transformed matrix). </p><br><p>  We distinguish these transition matrices for linearly independent components.  Here is the transition matrix for components from absolute courses. </p><br><p><img src="https://habrastorage.org/webt/b6/gh/p6/b6ghp6dcaqbx95tp8d9nzqd3qlk.png" alt="image"></p><br><p>  Here is the transition matrix from paired courses to linearly independent components. </p><br><p><img src="https://habrastorage.org/webt/nn/uf/vj/nnufvjyomi_iicx3bguy1jot2se.png" alt="image"></p><br><p>  The transition from absolutes to components occurs through the matrix calculated above.  The inverse transformation from components to absolutes is done through the inverse matrix.  Since it will be nondegenerate, a good inverse matrix can be obtained.  We will receive as pseudo-inverse.  Here is her view. </p><br><p><img src="https://habrastorage.org/webt/bo/nv/4i/bonv4ip1d4jahshag_dj8if7oue.png" alt="image"></p><br><p>  Now you can get the complete inverse transform matrix from pairs to absolutes.  To do this, multiply the transformation matrix from pairs to components by the inverse transformation matrix from components to absolutes.  She looks like this. </p><br><p><img src="https://habrastorage.org/webt/it/6o/9o/it6o9ohxtro72dnnvptwuqekesw.png" alt="image"></p><br><p>  Although we have already seen the above, but the matrix is ‚Äã‚Äãdifferent.  We investigate the results that it gives.  We calculate the absolute rates, and of them we will restore the steam rooms.  The recovery error was the following. </p><br><p><img src="https://habrastorage.org/webt/ov/km/yj/ovkmyjpltisutfsuu6oss9vd0ls.png" alt="image"></p><br><p>  On all pairs except two, almost zero errors.  Find out what's with these couples. <br>  It turns out that in two currency pairs incorrect data is accepted.  For jpy / hkd and jpy / sek, the data is sent in lots of 10,000 and 100 pcs.  It is necessary to correct and re-check. </p><br><p>  After correcting the input pair courses (getting rid of lots) and recalculating the absolute and restored pair courses, we look at the recovery error. </p><br><p><img src="https://habrastorage.org/webt/ss/-l/fb/ss-lfbznjquu3j5njsd9ikyqqyw.png" alt="image"></p><br><p>  Received an error in the range of 0.3%.  It is an acceptable level of error. </p><br><p>  Here is an example of an absolute course graph. </p><br><p><img src="https://habrastorage.org/webt/tw/w-/am/tww-amhtlncinoayt20-tb8t8b0.png" alt="image"></p><br><p>  Here is an example of the original and restored paired exchange rates. </p><br><p><img src="https://habrastorage.org/webt/xy/_b/0q/xy_b0qsslrxgwqewl0nclueuf2u.png" alt="image"></p><br><p>  Once the new inverse transformation matrix has been recalculated, we again present the data on the latest absolute rates of all participating currencies. </p><br><p><img src="https://habrastorage.org/webt/so/rz/t-/sorzt-g-wq6rfrb2rvitknpe81m.png" alt="image"></p><br><p>  You can see the most expensive currency.  This is a Kuwaiti dinar worth almost 47 abs.  The smallest absolute value of the Vietnamese dong is 0.003 abs. </p><br><h2 id="vyvody">  findings </h2><br><p>  As a result of the research, it was found that the existing method of calculating absolute rates gives a significant error.  In addition, an error was detected in the source data. </p><br><p>  The inverse transformation matrix from pairs to absolutes was obtained only using the transformation method to a smaller number of linearly independent components with a non-degenerate transformation matrix. </p><br><p>  The method of obtaining the inverse transformation matrix did not use data from pairs of courses.  And therefore independent of them. </p><br><p>  Verification of conversion on real courses showed a low level of error.  From which the conclusion was drawn about the applicability of the found matrix of the inverse transformation from pair exchange rates to absolute ones. </p><br><p>  The method does not claim to be completed and mathematically verified, but as an acceptable solution it will be used for further research of its absolute exchange rates. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/448866/">https://habr.com/ru/post/448866/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448848/index.html">About removing a trend from experimental data</a></li>
<li><a href="../448854/index.html">Crew Dragon exploded</a></li>
<li><a href="../448856/index.html">Torfon - anonymous telephony mobile application</a></li>
<li><a href="../448858/index.html">Stop using Ngrx / effects for this</a></li>
<li><a href="../448860/index.html">Comments on the release of Android Studio 3.4 (April 2019)</a></li>
<li><a href="../448868/index.html">The digest of interesting materials for the mobile # 295 developer (April 15 - 21)</a></li>
<li><a href="../448870/index.html">Optlib. Implementing Rust Genetic Algorithm Optimization</a></li>
<li><a href="../448872/index.html">Translation of the Intercom book on product management</a></li>
<li><a href="../448874/index.html">What is black PR and how to resist</a></li>
<li><a href="../448876/index.html">Introduction of LoRaWAN in an agricultural enterprise. Part 2. Fuel accounting</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>