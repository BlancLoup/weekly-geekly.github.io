<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Brain monitoring</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Monitoring of equipment and key software is the basics of system administration. But we all comprehend them differently. Over 10 years of work in IT, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Brain monitoring</h1><div class="post__text post__text-html js-mediator-article"><p>  Monitoring of equipment and key software is the basics of system administration.  But we all comprehend them differently.  Over 10 years of work in IT, my attitude to monitoring went through three stages: </p><br><p>  <strong>Denial</strong>  Do not monitor anything, users will report when they have problems. <br>  <strong>Anger</strong>  Monitor everything you can and cannot, notify everyone, including those who are not very interested, that the load on the CPU on the web server was 95% for 30 seconds. <br>  <strong>Humility</strong>  Business do not care for the processor / memory / disks.  He is more interested in, better or worse after the changes in the infrastructure.  We must work on the advance. </p><br><p><img src="https://habrastorage.org/webt/59/d4/cb/59d4cbf8177a6647815091.jpeg"></p><br><p>  Under the cut - the details of the evolution of my relationship. </p><a name="habracut"></a><br><h2 id="otricanie">  Negation </h2><br><p>  It all started a long time ago, in a distant galaxy.  I studied at the university and worked in two places ‚Äúyou are a programmer‚Äù: </p><br><ul><li>  Trade production company: three servers, ten users.  In these photos you can see the server. </li><li>  Department of State University: four servers, forty jobs. </li></ul><br><p><img src="https://habrastorage.org/webt/59/d4/c9/59d4c9a2be677406414602.png"></p><br><p>  At that time I did not even suspect the existence of such a thing as monitoring.  I sincerely believed that if something breaks, then you can simply throw your breasts on the embrasure and heroically solve the problems. </p><br><p>  My attitude to monitoring at that time can be characterized as follows: </p><br><ul><li>  Users themselves will report when something breaks. We ourselves constantly work with the site, so we will see when it broke. Is the processor overloaded on the server?  I do not care, the programmers wrote something there. </li></ul><br><p>  Fortunately, this period did not last long - I began to suspect that something was wrong here, and it could be better. </p><br><h2 id="gnev">  Anger </h2><br><p>  Under the influence of the experience gained, my vision of monitoring began to change.  This process coincided with the change of work.  After leaving the university and the manufacturing company, I began working in small outstaffing firms: </p><br><ul><li>  The first company had three offices, 100 users, one desk in the data center and two system administrators.  The server park consisted of 100 machines located 5,000 km from me, and there were 1,200 clients on the hosting. </li><li>  In the second company there were 400 servers, to which only 12,000 km, two corporate sites and one system administrator. </li></ul><br><p><img src="https://habrastorage.org/webt/59/d4/ca/59d4caacb5416292915692.png"></p><br><p>  By that time, I already thought that: </p><br><ul><li>  You need to monitor everything.  Including the fact that no one needs.  All events are important, and information about them should be sent to the maximum number of people.  Including the bosses.  By SMS.  At night.  Has the processor on the server been loaded at 95% within 35 seconds?  No time to explain, you must urgently send SMS! </li></ul><br><p>  At the same time, the toolkit was actively developed and transformed.  Initially, there was a pack of scripts that control various metrics (free space, the number of available updates, the result of backups, and so on), as well as third-party services Red Alert, Lazy Farmer (in-house development - an attempt to replace the site verification service). </p><br><p>  In this configuration, the monitoring system existed for about a year, but during this time many shortcomings have emerged: </p><br><ul><li>  Numerous delays in the work of servers due to the work of scripts. </li><li>  Unknown resource utilization. </li><li>  Difficult to find sources of problems. </li></ul><br><p>  The question arose how to simplify your life.  Considered options with Dude / Nagios / Zabbix.  The main criterion for choosing was the speed of deployment, and the choice fell on Zabbix. </p><br><p>  In it, everything was put on monitoring, up to which the hands reached out: </p><br><ul><li>  Number of users connected to WiFi. </li><li>  The number of pages printed on the printer. </li><li>  Free memory on the router. </li><li>  The number of VPN tunnels on the router. </li><li>  The temperature on the servers. </li><li>  The openness of the server cover. </li><li>  The load on the network interfaces of the switches. </li><li>  ‚Ä¶ and much more. </li></ul><br><p>  Separately, I want to mention the features of implementation and work with Zabbix: </p><br><ol><li>  Servers are far, and there are a lot of metrics.  When gaps began to appear, they introduced Zabbix proxy. </li><li>  When the tunnel crashes, a lot of alerts are generated about server unavailability, I had to configure dependencies. </li><li>  We automated actions of the same type with alerts: first, the system tries to repair it on its own (for example, clean the disk), and only in case of failure sends an alert.  To reduce the response time to an alert, we set up an SMS messaging. </li><li>  To prevent alerts from falling all day and night as an SMS, you do not need to set up alerts that the CPU has been loaded 100% on the server for 5 seconds. </li><li>  When monitoring complex metrics, part of the values ‚Äã‚Äãwas lost due to the resource-intensiveness of the process.  Although the data was sent to the monitoring server, he did not have time to register everything. </li><li>  Sphinx has a bunch of services that may change.  New servers are automatically detected and put on monitoring.  There are situations when the web server is running, but the user sees a fig instead of a page.  In such cases, we ran user scripts on the web, and in case of problems, the system sent an alert. </li><li>  Usually, customers want all tasks / problems to be displayed in one place, so we created a task when an event critical to business processes occurred. </li><li>  Collecting unhandled exceptions is long and tedious, so when an event occurred, we processed it in the eventlog and created a task. </li><li>  Customers do not read letters, so we wrote them on Skype (zabbix2skype). <br><img src="https://habrastorage.org/webt/59/d4/cb/59d4cbe69559d546541068.png"></li><li>  Quis custodiet ipsos custodes?  Who will monitor the monitoring?  I never found an answer for myself. </li></ol><br><p>  Humility </p><br><p>  A few years later I came to humility.  Again, this period partly coincided with the change of place of work.  Three data centers, thousands of servers, thousands of employees, offices throughout the Russian Federation, and not only. </p><br><p>  I realized for myself that the business is not interested in the load on the CPU and other technical details.  Owners and managers think in other categories: downtime / information system / loss of profits ... </p><br><p><img src="https://habrastorage.org/webt/59/d4/ce/59d4ce1f30b05658361586.png"></p><br><p>  I liked Zabbix, but I saw that there are other systems (third-party solutions, heavily modified by the file, or self-written) that are tightly integrated with the customer's business. </p><br><p>  The main ideas I came to: It is necessary to combine servers into information systems so that everyone can see the same picture and understand the relationships. </p><br><ol><li>  You can't keep everything in your head, there should be a repository of knowledge about the infrastructure (who is responsible for the server, where it is, and so on). It is necessary to simplify and unify the monitoring setup (SNMP instead of agents). </li><li>  It is important that the monitoring system has a friendly interface that allows even non-IT professionals to understand the situation. </li><li>  If the information system does not work, this is not a reason to raise everyone in alarm at 3 at night.  It is necessary to negotiate with the customer the allowable duration of downtime and reaction. </li><li>  There is no silver bullet - you have to make compromises when choosing metrics to track, when creating notification rules, when automating standard actions, and so on. </li></ol><br><p>  So, in brief, the ideas about monitoring as such, its tasks and ways of implementation have evolved.  Of course, the conditions prevailing in the companies where I worked, and the people who worked with me, had a great influence on this process. </p><br><p>  <strong>UPD:</strong> <a href="http://www.goncharov.xyz/it/about-monitoring.html">Russian version</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/339330/">https://habr.com/ru/post/339330/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339314/index.html">INTERCOM'17. Business Communication Conference</a></li>
<li><a href="../339316/index.html">Why the hotel industry should reconsider its attitude to Wi-Fi</a></li>
<li><a href="../339318/index.html">Analysis v_2.0 of the article ‚ÄúChief, I want to work from home‚Äù</a></li>
<li><a href="../339322/index.html">Many, fast, distributed: how to choose an in-memory data grid solution</a></li>
<li><a href="../339324/index.html">Welcome Habrozhiteley</a></li>
<li><a href="../339332/index.html">Digitizing and approximating graphs of functions using Wolfram Mathematica and Graph Digitizer</a></li>
<li><a href="../339334/index.html">Online quest from MBLTdev. Prizes from JetBrains</a></li>
<li><a href="../339336/index.html">MySQL grammar on ANTLR 4</a></li>
<li><a href="../339338/index.html">Salesman bad luck and red october</a></li>
<li><a href="../339340/index.html">Fetish LaTeX (or Do not write in LaTeX! It is only for layout)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>