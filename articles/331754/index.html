<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we stalled and calibrated the coffee machine on the spectrophotometer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One day, in the middle of the working day, we suddenly realized that we could no longer live like this. Soul required to do something meaningless and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we stalled and calibrated the coffee machine on the spectrophotometer</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/356/250/b38/356250b384864105b86271f0720bdc24.jpg"><br><br>  One day, in the middle of the working day, we suddenly realized that we could no longer live like this.  Soul required to do something meaningless and merciless in the name of science.  And we decided to calibrate the coffee machine.  Normal people poke at the default button and drink everything that comes out of the coffee maker.  Slightly more advanced for this open instruction and carefully follow it.  Maybe they read the recommendations of the roaster, if of course these are not rancid noname grains that have been in a nameless warehouse for a couple of years.  We can be attributed to normal with a big stretch, so we decided to go our own way.  In short, under the light caffeine intoxication from the seventh cup of espresso, we decided to use the whole possible laboratory arsenal to get a reference drink. <br><br>  Welcome to the world of madness, ultracentrifuges, coffee spectrophotometry in special tablets and a small amount of python, pandas and seaborn to visualize all this disgrace. <br><a name="habracut"></a><br><h2>  <font color="#311609"><b>Correct extraction</b></font> </h2><br>  First, we need to understand what we want to get.  The main point of setting the coffee maker correctly is to get a balanced extraction profile.  In this case, no less than half of the success depends on the correct grain, which was roasted in compliance with all the details of the thermal profile.  Horseradish grain steamers may have irregular roasts or other defects.  But even the perfect coffee can be turned into a terrible swill, if you cook it wrong. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The optimum temperature for the classical method of making coffee is 90-95 ¬∞ C.  The number of grains should be about 10-20 g / 100 ml of water.  It should also be borne in mind that the extraction process is uneven, from lighter and volatile to less soluble components.  The trouble is that when we go beyond the optimal values ‚Äã‚Äãof water temperature, the degree of compression of the coffee pill (for espresso), the degree of grinding, the ratio of coffee to water or time, we may not have time to ‚Äúpull out‚Äù everything we need from the grain.  Or vice versa to capture an excessive amount of heavy fractions, spoiling the taste and balance of the drink.  In particular, during hyper-extraction, an excess amount of chlorogenic acids gets into the cup, which causes the coffee to overly bitter and shift the balance of taste to the acidic side.  With insufficient extraction will be something watery and sad to taste. <br><br><img src="https://habrastorage.org/web/592/91d/82a/59291d82a83d425cb386e9e6d9e1334a.png"><br>  <i>Quinic and hydroxycinnamic acids, the structural basis of chlorogenic acids</i> <br><br><h2>  <font color="#311609"><b>Preparing the experiment</b></font> </h2><br>  In an automatic coffee machine, only two parameters are available for us to adjust: grinding and compression.  The degree of grinding is determined by the mechanical rotation of the regulator, which sets the gap between the millstones.  The compression of the freshly ground coffee tablet is preset and has 5 conditional levels of compression.  Our task is to select the optimal parameters at which the concentration and balance of solutes will give an ideal taste. <br><br>  The coffee itself for testing was sent to us for inhuman experiments from Torrefacto, for which many thanks to them.  Two main categories: B and C (dark and light roast in their classification). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/895/556/0df/8955560df8f5cd5ddd6608bdc4d47eb3.jpg" alt="image"><br>  <i>Honduras San Marcos ( <a href="https://www.torrefacto.ru/catalog/roasted/honduras-san-marcos/">source</a> )</i> <br><br>  Dark Roast  We have somehow switched to the middle one, but for comparison this variety is a very worthy option.  Especially good with milk, but for our tasks we will prepare espresso from it.  The taste is quite simple, without subtle nuances, but very rich. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f8/85e/d09/8f885ed09cae788b8e694905139af322.jpg" alt="image"><br>  <i>Brazil Ipanema Dulce ( <a href="https://www.torrefacto.ru/catalog/roasted/brazil-ipanema-dulce/">source</a> )</i> <br><br>  Just awesome aromatic variety, with a very balanced taste and sweet fruit sourness.  The grain itself contains a large amount of carbohydrates, which gives a slight sweetness. <br><br>  For each grade and each of the five compression levels of the coffee pill, 8 sample cups are selected.  At the same time, laboratory staff spit or rejoice at the result.  Blindly, naturally.  Choose the best taste samples, then to compare with the objective indicators of hardware research. <br><br><h2>  <font color="#311609"><b>Deep freeze</b></font> </h2><br>  We felt sorry for ourselves and we did not drink 80 cups of coffee in one day.  Therefore, the samples were labeled and thrown into the freezer.  Honey such a freezer, with a temperature of about -90 degrees.  Eats 4 kilowatts, but as a result inside even carbon dioxide falls out in the form of a snowball on the walls.  Perfect option. <br><br><img src="https://habrastorage.org/web/3e8/733/e78/3e8733e78dfb476f8cd270c70c81376a.jpg"><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/LMRVHQWr77E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  When all the samples are ready, we take them out of the freezer and put them in the orbital shaker.  Yes, I also like how it sounds.  Almost like a planetary orbital laser, but it's just a shaker.  We are waiting for complete defrosting of samples and at the same time mix everything well. <br><br><h2>  <font color="#311609"><b>Spill in tubes and centrifuge</b></font> </h2><br><img src="https://habrastorage.org/web/fca/23a/502/fca23a502ef54c358dc0294780fed45a.jpg"><br><br>  First you need to very carefully examine the samples.  Without this miracle will not happen) <br><br><img src="https://habrastorage.org/web/f7f/1fc/dd3/f7f1fcdd38fd4ad3b3d0074c9601ec73.jpg"><br><br><img src="https://habrastorage.org/web/b87/ea2/9bf/b87ea29bfa8744978332b0f587b54b0a.jpg"><br><br>  From the big test tubes we take away a coffee with a micropipette and we pour out on small test tubes for centrifuging.  Label each tube with a number and enter it in a separate journal, so as not to confuse the samples. <br><br><img src="https://habrastorage.org/web/1e7/bea/071/1e7bea07183e44c1a4f627a3871deea0.jpg"><br><br><img src="https://habrastorage.org/web/267/186/ae3/267186ae39d34ec89e3355e54e7254ba.jpg"><br><br>  The tubes are placed in a centrifuge strictly symmetrical to maintain balance.  At high speeds of rotation it is critical.  After centrifugation, we get a clear aqueous solution of what was extracted from the coffee, and all the microparticles that have passed through the filter of the coffee machine will remain in the form of sediment. <br><br><h2>  <font color="#311609"><b>Spectrophotometry</b></font> </h2><br><img src="https://habrastorage.org/web/8d4/c0f/c8d/8d4c0fc8dece402290161e1b3dd402fa.jpg"><br><br>  Again, take a micropipette and dispense accurate doses of the samples into individual wells of a special 48-well plate. <br><br><img src="https://habrastorage.org/web/fdd/a76/22e/fdda7622e8ba4ea3b9ec6cd600d2dcdf.jpg"><br><br>  As a result, the patterns are beautifully distributed in shades.  From top to bottom, there is an increase in compression ratio and completeness of extraction. <br><br><img src="https://habrastorage.org/web/4b1/58a/0cb/4b158a0cbe1543658abe0b71da574b10.jpg"><br><div class="spoiler">  <b class="spoiler_title">I'm my mom operator</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/PaaDIvpyQVY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  The plates are loaded into a FilterMax spectrophotometer from Molecular Devices.  There are a whole bunch of sample study modes, various filter options, laser sources of radiation, and the like.  We thought for a long time that it would make sense to measure such a strange thing on coffee and decided that measuring the same fluorescence in the ultraviolet is pretty pointless.  It was decided to estimate the degree of absorption of laser radiation at a wavelength of 450 nm.  This wavelength is blue laser.  In principle, it is quite logical.  Saturated coffee solution has a reddish tint and should absorb well the blue part of the spectrum. <br><br>  As a result, we obtained absorption tables for all our samples.  However, it would be nice to visualize all this.  Since I most often use python and pandas with seaborn in my work, we will also save the data in the most convenient form for loading into pandas. <br><br><div class="spoiler"> <b class="spoiler_title">The degree of absorption in percent in csv format.</b> <div class="spoiler_text">  Roast Compression Absorbance <br>  medium, level 1.21.31 <br>  medium, level 1,20.57 <br>  medium, level 1,24.49 <br>  medium, level 1,26.95 <br>  medium, level 1,20.49 <br>  medium, level 1,20.06 <br>  medium, level 1,21.22 <br>  medium, level 1,23.32 <br>  medium, level 2,28.09 <br>  medium, level 2,28.27 <br>  medium, level 2,23.13 <br>  medium, level 2,25.72 <br>  medium, level 2,26.75 <br>  medium, level 2,26.05 <br>  medium, level 2,26.92 <br>  medium, level 2,25.92 <br>  medium, level 3,32.88 <br>  medium, level 3.32.23 <br>  medium, level 3,33.13 <br>  medium, level 3,28.72 <br>  medium, level 3,28.82 <br>  medium, level 3,31.49 <br>  medium, level 3.32.31 <br>  medium, level 3,33.81 <br>  medium, level 4,38.68 <br>  medium, level 4,40.54 <br>  medium, level 4,39.34 <br>  medium, level 4,43.3 <br>  medium, level 4.41.48 <br>  medium, level 4,42.26 <br>  medium, level 4.42.73 <br>  medium, level 4,42.35 <br>  medium, level 5,57.62 <br>  medium, level 5,70.62 <br>  medium, level 5,70.74 <br>  medium, level 5,57.94 <br>  medium, level 5,77.62 <br>  medium, level 5,76.64 <br>  medium, level 5.69.12 <br>  medium, level 5,66.39 <br>  dark, level 1,27.54 <br>  dark, level 1,26.8 <br>  dark, level 1,30.72 <br>  dark, level 1,33.18 <br>  dark, level 1,26.72 <br>  dark, level 1,26.29 <br>  dark, level 1,27.45 <br>  dark, level 1,29.55 <br>  dark, level 2,34.32 <br>  dark, level 2,34.5 <br>  dark, level 2,29.36 <br>  dark, level 2,31.95 <br>  dark, level 2,32.98 <br>  dark, level 2,32.28 <br>  dark, level 2,33.15 <br>  dark, level 2,32.15 <br>  dark, level 3,39.11 <br>  dark, level 3,38.46 <br>  dark, level 3,39.36 <br>  dark, level 3,34.95 <br>  dark, level 3,35.05 <br>  dark, level 3,37.72 <br>  dark, level 3,38.54 <br>  dark, level 3,40.04 <br>  dark, level 4,44.91 <br>  dark, level 4,46.77 <br>  dark, level 4,45.57 <br>  dark, level 4,49.53 <br>  dark, level 4,47.71 <br>  dark, level 4,48.49 <br>  dark, level 4,48.96 <br>  dark, level 4,48.58 <br>  dark, level 5,63.85 <br>  dark, level 5,76.85 <br>  dark, level 5,76.97 <br>  dark, level 5.64.17 <br>  dark, level 5,83.85 <br>  dark, level 5,82.87 <br>  dark, level 5,75.35 <br>  dark, level 5,72.62 <br></div></div><br><h2>  <font color="#311609"><b>Draw graphics with python, pandas and seaborn</b></font> </h2><br>  To plot, we first import our csv as a pandas dataframe.  After that, using the wonderful seaborn library and the barplot function, we will construct a graph grouped by degree of roasting.  For greater contrast, use the palette "Paired", it is very good when comparing different groups.  By the way, as you remember, we ranked samples by taste.  The coffee tasters of us are so-so, but surprisingly a consensus has been reached.  The optimal taste of the drink was in the case when the degree of absorption at a length of 450 nm was in the region of 32%.  Draw the corresponding line on the chart using plt.axhline. <br><br><img src="https://habrastorage.org/web/bee/d83/737/beed83737495432d86026d3be0981b85.png"><br><div class="spoiler">  <b class="spoiler_title">Python code</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns df = pd.read_csv(<span class="hljs-string"><span class="hljs-string">"data.csv"</span></span>) sns.set() sns.set_style(<span class="hljs-string"><span class="hljs-string">"whitegrid"</span></span>) sns.set_context(<span class="hljs-string"><span class="hljs-string">"talk"</span></span>) ax = sns.barplot(x=<span class="hljs-string"><span class="hljs-string">"Compression"</span></span>, y=<span class="hljs-string"><span class="hljs-string">"Absorbance"</span></span>, hue=<span class="hljs-string"><span class="hljs-string">"Roast"</span></span>, data=df, palette=<span class="hljs-string"><span class="hljs-string">"Paired"</span></span>) ax.set(ylim=(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>), xlabel=<span class="hljs-string"><span class="hljs-string">'Compression level'</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">'Absorbance at 450 nm, %'</span></span>) plt.axhline(<span class="hljs-number"><span class="hljs-number">32</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.4</span></span>, color=<span class="hljs-string"><span class="hljs-string">'black'</span></span>, linestyle=<span class="hljs-string"><span class="hljs-string">'dashed'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'Optimal concentration'</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper left'</span></span>) plt.savefig(<span class="hljs-string"><span class="hljs-string">"plot.png"</span></span>, dpi=<span class="hljs-number"><span class="hljs-number">300</span></span>) plt.show()</code> </pre> <br></div></div><br>  The graph clearly shows that the optimal compression ratio for dark roast coffee is second, and third for average.  In addition to this delightful conclusion from our experiment, we see that with maximum compression, the spread in the concentration of solutes between the individual espresso cups increases.  Whether the machine does not provide repeatability, or with such compression, factors such as the length of a randomly broken channel in a coffee tablet through which hot water flows begin to significantly influence. <br><br>  To make it finally beautiful, let's build a graph of the deviation of our parameter from the optimum.  To do this, from the Absorbance column in our dataframe we subtract 32 (our optimum). <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Subtract optimal value df['Absorbance'] = df['Absorbance'] - 32</span></span></code> </pre><br><img src="https://habrastorage.org/web/26f/bfe/a56/26fbfea56483490b83cf169e20deeb71.png"><br><div class="spoiler">  <b class="spoiler_title">Python code</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns df = pd.read_csv(<span class="hljs-string"><span class="hljs-string">"data.csv"</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Subtract optimal value df['Absorbance'] = df['Absorbance'] - 32 sns.set() sns.set_style("whitegrid") sns.set_context("talk") ax = sns.barplot(x="Compression", y="Absorbance", hue="Roast", data=df, palette="Paired") ax.set(xlabel='Compression level', ylabel='Deviation from optimal concentration') plt.legend(loc='upper left') plt.savefig("plot_diverging.png", dpi=300) plt.show()</span></span></code> </pre><br><br></div></div><br>  Somehow, meaningless and mercilessly, you can get a cup of perfect espresso). <br><br>  PS If I can find the time, there will be another post about high-speed ultrasonic extraction of ice coffee.  There are samples, we will create strange further. </div><p>Source: <a href="https://habr.com/ru/post/331754/">https://habr.com/ru/post/331754/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331744/index.html">Postquantum reincarnation of the Diffie-Hellman algorithm: past and present</a></li>
<li><a href="../331746/index.html">Using Python and Excel to process and analyze data. Part 1: Import Data and Set Up Environment</a></li>
<li><a href="../331748/index.html">How to comply with FZ-152 ‚ÄúOn personal data‚Äù with ‚ÄúBitrix24‚Äù and ‚Äú1C-Bitrix‚Äù</a></li>
<li><a href="../331750/index.html">Speed ‚Äã‚Äãreading: does it work or not? Part 3: simple tips</a></li>
<li><a href="../331752/index.html">Testing or parsing sites with a dynamic home and more. Nightmare.js - he doesn't care</a></li>
<li><a href="../331758/index.html">Mark, Jack and Alisher! The world needs a new facebook - educational</a></li>
<li><a href="../331760/index.html">ArrayBuffer and SharedArrayBuffer in JavaScript, Part 2: Introduction to New Language Objects</a></li>
<li><a href="../331762/index.html">Ukraine has undergone the largest virus in the history of cyber attack Petya</a></li>
<li><a href="../331766/index.html">Building application management systems in a distributed cluster infrastructure based on MESOS technology</a></li>
<li><a href="../331768/index.html">MIPT launches Russia's first online magistracy in technology entrepreneurship</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>