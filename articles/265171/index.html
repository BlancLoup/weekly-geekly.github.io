<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Customizing the manual sorting of UITableView on Xamarin</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will look at how to modify the UITableView to transfer table cells. Recall that Apple offers us cells for strictly allocated space: 



 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Customizing the manual sorting of UITableView on Xamarin</h1><div class="post__text post__text-html js-mediator-article">  This article will look at how to modify the UITableView to transfer table cells.  Recall that Apple offers us cells for strictly allocated space: <br><br><img src="https://habrastorage.org/files/035/126/b95/035126b9511a4c898e37653f5c33ad7e.png" alt="image"><br><br>  I don‚Äôt know what it‚Äôs all about, but I didn‚Äôt like it, so it was decided to spend some time on solving this problem, please under the cat. <br><a name="habracut"></a><br>  Let's start.  We have the usual such UITableView with property <pre><code class="cs hljs">tableView.Editing = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre> <br>  Also, in the UITableViewSource we have an overridden method <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CanMoveRow</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">UITableView tableView, NSIndexPath indexPath</span></span></span><span class="hljs-function">)</span></span> =&gt; <span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre><br>  If we run the application, we will see that with this property we can move the table cells within the frame of the table itself. <br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  By the way, the edit control on the left is removed like this: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> UITableViewCellEditingStyle </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EditingStyleForRow</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">UITableView tableView, NSIndexPath indexPath</span></span></span><span class="hljs-function">)</span></span> =&gt;UITableViewCellEditingStyle.None;</code> </pre><br></div></div><br>  Now let us ask ourselves how to make the lines move not only along the tap to that small area allotted to the deprived user, but across the entire cell. <br><div class="spoiler">  <b class="spoiler_title">inb4</b> <div class="spoiler_text">  You can‚Äôt just change the frame of this control itself, it works a little differently than you can imagine, if you are interested in someone, I‚Äôll tell you in the next post. <br></div></div><br>  The solution to the problem is as follows: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cell.Subviews) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.Description.Contains (<span class="hljs-string"><span class="hljs-string">"UITableViewCellReorderControl"</span></span>)) { UIView resizedGripView = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UIView(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CGRect(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,item.Frame.GetMaxX(),item.Frame.GetMaxY())); resizedGripView.AddSubview(item); cell.AddSubview(resizedGripView); CGSize sizeDifference = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CGSize(resizedGripView.Frame.Size.Width - item.Frame.Size.Width, resizedGripView.Frame.Size.Height - item.Frame.Size.Height); CGSize transformRatio = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CGSize(resizedGripView.Frame.Size.Width / item.Frame.Size.Width, item.Frame.Size.Height / item.Frame.Size.Height); CGAffineTransform transform = CGAffineTransform.MakeIdentity(); transform = CGAffineTransform.Scale(transform, transformRatio.Width, transformRatio.Height); nfloat two = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> nfloat (<span class="hljs-number"><span class="hljs-number">2.0</span></span>); nfloat df = -sizeDifference.Width / two; nfloat dff = -sizeDifference.Height / two; transform = CGAffineTransform.Translate(transform, df,dff); resizedGripView.Transform = transform; item.Subviews [<span class="hljs-number"><span class="hljs-number">0</span></span>].RemoveFromSuperview (); } }</code> </pre><br>  Next was the task to set the style of the cell during its transfer.  Here there was a question with a shadow cast by a portable cell, this shadow did not want to disappear.  After long attempts to find the most cherished subwoofer, still managed to find her somewhere in the bowels of the table, under the monotonous knocking of a tambourine. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This is done in the overridden methods of the UITableView itself. <br><pre> <code class="cs hljs">UIView wrapperview; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> UIView[] Subviews { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Subviews) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.Description.Contains(<span class="hljs-string"><span class="hljs-string">"UITableViewWrapperView"</span></span>)) { wrapperview = item; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.Description.Contains(<span class="hljs-string"><span class="hljs-string">"UIShadowView"</span></span>)) { item.Hidden = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.Subviews; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LayoutSubviews</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.LayoutSubviews (); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> wrapperview.Subviews) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (item.Description.Contains(<span class="hljs-string"><span class="hljs-string">"UIShadowView"</span></span>)) { item.Hidden = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; item.Layer.ShadowColor = UIColor.White.CGColor; } } }</code> </pre><br><br>  This code is suitable for any version of IOS, from 6 and up. <br><br>  Before: <br><img src="https://habrastorage.org/files/8bf/7af/dd5/8bf7afdd53204b11af5d36a0d82c595a.png" alt="image"><br><br>  After: <br><img src="https://habrastorage.org/files/7c6/1dc/6bc/7c61dc6bcd9145f39afeaa2482f80ad5.png" alt="image"><br><br>  When transferring the cell becomes transparent, so if you want to tint it or somehow stylize it, do it with the help of cell.BackgroundView. <br><br>  In my opinion, the code looks quite simple and understandable.  Most likely, I did not discover America‚Äôs experienced developers, but it will be useful for newbies to know, and there aren‚Äôt too many articles about Xamarin development.  So, if the topic is relevant, I can cut on interesting tricks with Xamarin.IOS / Android interfaces and not only. <br><br>  That's all, if possible I will answer in the comments. </div><p>Source: <a href="https://habr.com/ru/post/265171/">https://habr.com/ru/post/265171/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265161/index.html">Another serious Android vulnerability found</a></li>
<li><a href="../265163/index.html">Google does not forgive mistakes: confrontation with Google Play</a></li>
<li><a href="../265165/index.html">Writing a webpack plugin</a></li>
<li><a href="../265167/index.html">Deep Learning Hardware</a></li>
<li><a href="../265169/index.html">Hekslet: new courses + webinars about VIM, programming, English</a></li>
<li><a href="../265173/index.html">I invite you to meet with Vadim Makeev from Opera</a></li>
<li><a href="../265175/index.html">Property Attributes in Objective-C. Instructions for beginners</a></li>
<li><a href="../265177/index.html">SPLA fun to make money on the clouds</a></li>
<li><a href="../265179/index.html">How is the flash revolution going</a></li>
<li><a href="../265181/index.html">Connect to the Jump Start online event on September 2: "Windows 10 on the corporate network"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>