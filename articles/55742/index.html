<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>C # implementation, Javascript: formatting function for convenient localization of strings</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Habrayuzer afan in its topic Idea: the formatting function for the convenient localization of lines offered an interesting concept. What actually I de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>C # implementation, Javascript: formatting function for convenient localization of strings</h1><div class="post__text post__text-html js-mediator-article">  Habrayuzer <a href="https://habrahabr.ru/users/afan/" class="user_link">afan</a> in its topic <a href="http://habrahabr.ru/blogs/development/55286/">Idea: the formatting function for the convenient localization of lines</a> offered an interesting concept.  What actually I decided to use in my engine. <br><br>  So, <a name="habracut"></a><br><br>  Of course, as an honest person, I read all the comments of this topic and found <a href="http://translate.sourceforge.net/wiki/l10n/pluralforms">this list of formulas</a> .  To add support for the desired language, simply copy the formula from the list. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Then I decided to look for ready-made solutions.  Found a solution from PawnHunter <a href="http://www.rsdn.ru/forum/message/659538.flat.aspx" title="[C #] IFormatProvider for countable nouns">[C #] IFormatProvider for countable nouns</a> .  It is interesting plus there is a function of writing numbers in words.  But the lack of complexity of adding languages.  The author was originally attached to Russian and is looking for three forms of number according to the rule of Russian.  He was lucky with English, because the first 2 forms are the same, and the third is not needed.  Any other language with a great formula and number of forms will crash. <br><br>  I did not look further, because there was enough material for my decision: an idea, formulas and a ready-made example. <br><br>  The syntax of use. <br>  C #: <br><blockquote><code><font color="black">NumeralsFormatter formatter <font color="#008000">=</font> <font color="#008000">new</font> NumeralsFormatter <font>(</font> <font>)</font> <font color="#008000">;</font> <font color="#008080">//   </font> <br> formatter. <font color="#0000FF">CultureInfo</font> <font color="#008000">=</font> <font color="#008000">new</font> CultureInfo <font>(</font> <font color="#666666">"ru-RU"</font> <font>)</font> <font color="#008000">;</font> <font color="#008080">//   </font> <br> Int32 files <font color="#008000">=</font> <font>0</font> , folders <font color="#008000">=</font> <font>5</font> <font color="#008000">;</font> <br> <font color="#FF0000">String</font> exResult <font color="#008000">=</font> <font color="#FF0000">String</font> . <font color="#0000FF">Format</font> <font>(</font> formatter, <font color="#666666">"{0:W|  |1  |%  |%  }  {1:W|0 |1 |% |% }."</font> , files, folders <font>)</font> <font color="#008000">;</font> <font color="#008080">//  </font> <br> <font color="#FF0000">String</font> shortResult <font color="#008000">=</font> <font color="#FF0000">String</font> . <font color="#0000FF">Format</font> <font>(</font> formatter, <font color="#666666">"{0:W|% (,,) (,,)}  {1:W|% (,,}."</font> , files, folders <font>)</font> <font color="#008000">;</font> <font color="#008080">//  </font></font></code> <br> </blockquote><br><br>  Javascript <br><blockquote> <code><font color="black"><font color="#006600">//      CultureInfo.name</font> <br> <font color="#003366">var</font> files <font color="#339933">=</font> <font>0</font> <font color="#339933">,</font> folders <font color="#339933">=</font> <font>5</font> <font color="#339933">;</font> <br> <font color="#003366">var</font> exResult <font color="#339933">=</font> String. <font color="#660066">wformat</font> <font>(</font> <font color="#3366CC">"{0:W|  |1  |%  |%  }  {1:W|0 |1 |% |% }."</font> <font color="#339933">,</font> files <font color="#339933">,</font> folders <font>)</font> <font color="#339933">;</font> <font color="#006600">//  </font> <br> <font color="#003366">var</font> shortResult <font color="#339933">=</font> String. <font color="#660066">wformat</font> <font>(</font> <font color="#3366CC">"{0:W|% (,,) (,,)}  {1:W|% (,,}."</font> <font color="#339933">,</font> files <font color="#339933">,</font> folders <font>)</font> <font color="#339933">;</font> <font color="#006600">//  </font></font></code> <br> </blockquote><br><br>  As you can see, the syntax is taken from the original article, only the formatting is tailored to String.Format.  Plus an abbreviated version borrowed from PawnHunter. <br>  The% symbol is responsible for the substitution of a numeric value. <br><br>  <strong>Pay attention to the following.</strong>  In the extended version, word forms are passed one more for the zero value, which comes first.  In the abbreviated form, there is no zero form; for it, the form is calculated by the formula. <br><br>  To use special characters, such as |  % they need to be duplicated ||  %%.  For abbreviated form plus ((and)). <br><br>  And in the end I give source codes. <br><blockquote> <code><a href="http://translate.sourceforge.net/wiki/l10n/pluralforms"></a> <font color="black"><font color="#0600FF">using</font> <font color="#008080">System</font> <font color="#008000">;</font> <br> <font color="#0600FF">using</font> <font color="#008080">System.Text</font> <font color="#008000">;</font> <br> <font color="#0600FF">using</font> <font color="#008080">System.Globalization</font> <font color="#008000">;</font> <br> <br> <font color="#0600FF">public</font> <font color="#FF0000">class</font> NumeralsFormatter <font color="#008000">:</font> IFormatProvider, ICustomFormatter <br> <font>{</font> <br> <font color="#0600FF">public</font> CultureInfo CultureInfo <font color="#008000">;</font> <br> <br> <font color="#0600FF">public</font> NumeralsFormatter <font>(</font> <font>)</font> <font color="#008000">:</font> <font color="#0600FF">this</font> <font>(</font> <font color="#000000">System. <font color="#0000FF">Threading</font></font> . <font color="#0000FF">Thread</font> . <font color="#0000FF">CurrentThread</font> . <font color="#0000FF">CurrentCulture</font> <font>)</font> <font>{</font> <font>}</font> <br> <font color="#0600FF">public</font> NumeralsFormatter <font>(</font> CultureInfo cultureInfo <font>)</font> <br> <font>{</font> <br> <font color="#0600FF">this</font> . <font color="#0000FF">CultureInfo</font> <font color="#008000">=</font> cultureInfo <font color="#008000">;</font> <br> <font>}</font> <br> <font color="#0600FF">public</font> <font color="#FF0000">Object</font> GetFormat <font>(</font> Type formatType <font>)</font> <br> <font>{</font> <br> <font color="#0600FF">return</font> formatType <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> ICustomFormatter <font>)</font> <font color="#008000">?</font> <font color="#0600FF">this</font> <font color="#008000">:</font> CultureInfo. <font color="#0000FF">GetFormat</font> <font>(</font> formatType <font>)</font> <font color="#008000">;</font> <br> <font>}</font> <br> <br> <font color="#0600FF">private</font> <font color="#FF0000">String</font> FormatUnknown <font>(</font> <font color="#FF0000">String</font> format, <font color="#FF0000">Object</font> arg, IFormatProvider formatProvider <font>)</font> <br> <font>{</font> <br> IFormattable formattable <font color="#008000">=</font> arg <font color="#0600FF">as</font> IFormattable <font color="#008000">;</font> <br> <font color="#0600FF">if</font> <font>(</font> formattable <font color="#008000">==</font> <font color="#0600FF">null</font> <font>)</font> <font color="#0600FF">return</font> arg. <font color="#0000FF">ToString</font> <font>(</font> <font>)</font> <font color="#008000">;</font> <br> <font color="#0600FF">return</font> formattable. <font color="#0000FF">ToString</font> <font>(</font> format, formatProvider <font>)</font> <font color="#008000">;</font> <br> <font>}</font> <br> <br> <font color="#0600FF">public</font> Boolean IsNumeralType <font>(</font> Type type <font>)</font> <br> <font>{</font> <br> <font color="#0600FF">return</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> Int32 <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> UInt32 <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> <font color="#FF0000">Double</font> <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> Single <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> <font color="#FF0000">Decimal</font> <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> Int64 <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> UInt64 <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> Int16 <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> UInt16 <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> <font color="#FF0000">Byte</font> <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> <font color="#FF0000">SByte</font> <font>)</font> <br> <font color="#008000">||</font> type <font color="#008000">==</font> <font color="#008000">typeof</font> <font>(</font> <font color="#FF0000">Char</font> <font>)</font> <font color="#008000">;</font> <br> <font>}</font> <br> <br> <font color="#0600FF">public</font> <font color="#FF0000">String</font> Format <font>(</font> <font color="#FF0000">String</font> format, <font color="#FF0000">Object</font> arg, IFormatProvider formatProvider <font>)</font> <br> <font>{</font> <br> <font color="#0600FF">if</font> <font>(</font> format <font color="#008000">==</font> <font color="#0600FF">null</font> <font color="#008000">||</font> <font color="#008000">!</font> IsNumeralType <font>(</font> arg. <font color="#0000FF">GetType</font> <font>(</font> <font>)</font> <font>)</font> <font>)</font> <br> <font color="#0600FF">return</font> FormatUnknown <font>(</font> format, arg, formatProvider <font>)</font> <font color="#008000">;</font> <br> <br> <font color="#FF0000">String</font> <font>[</font> <font>]</font> forms <font color="#008000">=</font> format. <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">"||"</font> , <font color="#666666">" <font>\u</font> fffc"</font> <font>)</font> . <font color="#0000FF">Split</font> <font>(</font> <font color="#666666">'|'</font> <font>)</font> <font color="#008000">;</font> <br> <font color="#0600FF">if</font> <font>(</font> forms <font>[</font> <font>0</font> <font>]</font> . <font color="#0000FF">ToUpper</font> <font>(</font> <font>)</font> <font color="#008000">==</font> <font color="#666666">"W"</font> <font>)</font> <br> <font>{</font> <br> Int32 idxForm <font color="#008000">=</font> <font color="#008000">-</font> <font>1</font> <font color="#008000">;</font> <br> <font color="#FF0000">Double</font> n <font color="#008000">=</font> Math. <font color="#0000FF">Abs</font> <font>(</font> Convert. <font color="#0000FF">ToDouble</font> <font>(</font> arg <font>)</font> <font>)</font> <font color="#008000">;</font> <br> <br> <font color="#008080">// translate.sourceforge.net/wiki/l10n/pluralforms</font> <br> <font color="#0600FF">switch</font> <font>(</font> CultureInfo. <font color="#0000FF">Parent</font> . <font color="#0000FF">Name</font> <font>)</font> <br> <font>{</font> <br> <font color="#0600FF">case</font> <font color="#666666">"en"</font> <font color="#008000">:</font> idxForm <font color="#008000">=</font> <font>(</font> n <font color="#008000">!=</font> <font>1</font> <font color="#008000">?</font> <font>1</font> <font color="#008000">:</font> <font>0</font> <font>)</font> <font color="#008000">;</font> break <font color="#008000">;</font> <br> <font color="#0600FF">case</font> <font color="#666666">"ru"</font> <font color="#008000">:</font> idxForm <font color="#008000">=</font> <font>(</font> n <font color="#008000">%</font> <font>10</font> <font color="#008000">==</font> <font>1</font> <font color="#008000">&amp;&amp;</font> n <font color="#008000">%</font> <font>100</font> <font color="#008000">!=</font> <font>11</font> <font color="#008000">?</font> <font>0</font> <font color="#008000">:</font> n <font color="#008000">%</font> <font>10</font> <font color="#008000">&gt;=</font> <font>2</font> <font color="#008000">&amp;&amp;</font> n <font color="#008000">%</font> <font>10</font> <font color="#008000">&lt;=</font> <font>4</font> <font color="#008000">&amp;&amp;</font> <font>(</font> n <font color="#008000">%</font> <font>100</font> <font color="#008000">&lt;</font> <font>10</font> <font color="#008000">||</font> n <font color="#008000">%</font> <font>100</font> <font color="#008000">&gt;=</font> <font>20</font> <font>)</font> <font color="#008000">?</font> <font>1</font> <font color="#008000">:</font> <font>2</font> <font>)</font> <font color="#008000">;</font> break <font color="#008000">;</font> <br> <font>}</font> <br> <br> <font color="#FF0000">String</font> form <font color="#008000">=</font> null <font color="#008000">;</font> <br> <font color="#0600FF">if</font> <font>(</font> idxForm <font color="#008000">!=</font> <font color="#008000">-</font> <font>1</font> <font>)</font> <br> <font>{</font> <br> <font color="#0600FF">if</font> <font>(</font> forms. <font color="#0000FF">Length</font> <font color="#008000">&gt;</font> <font>2</font> <font>)</font> <font color="#008080">// extended form</font> <br> <font>{</font> <br> idxForm <font color="#008000">=</font> n <font color="#008000">==</font> <font>0</font> <font color="#008000">?</font> <font>1</font> <font color="#008000">:</font> idxForm <font color="#008000">+</font> <font>2</font> <font color="#008000">;</font> <br> form <font color="#008000">=</font> forms <font>[</font> idxForm <font>]</font> . <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">' <font>\u</font> fffc'</font> , <font color="#666666">'|'</font> <font>)</font> <font color="#008000">;</font> <br> <font>}</font> <br> <font color="#0600FF">else</font> <font color="#0600FF">if</font> <font>(</font> forms. <font color="#0000FF">Length</font> <font color="#008000">&gt;</font> <font>1</font> <font>)</font> <br> <font>{</font> <br> StringBuilder sb <font color="#008000">=</font> <font color="#008000">new</font> StringBuilder <font>(</font> <font>)</font> <font color="#008000">;</font> <br> forms <font color="#008000">=</font> forms <font>[</font> <font>1</font> <font>]</font> . <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">' <font>\u</font> fffc'</font> , <font color="#666666">'|'</font> <font>)</font> . <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">"(("</font> , <font color="#666666">" <font>\u</font> fd3e"</font> <font>)</font> . <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">"))"</font> , <font color="#666666">" <font>\u</font> fd3f"</font> <font>)</font> . <font color="#0000FF">Split</font> <font>(</font> <font color="#666666">'('</font> <font>)</font> <font color="#008000">;</font> <br> <font color="#FF0000">int</font> i <font color="#008000">=</font> <font>0</font> <font color="#008000">;</font> <br> <font color="#0600FF">for</font> <font>(</font> <font color="#008000">;</font> i <font color="#008000">&lt;</font> forms. <font color="#0000FF">Length</font> <font color="#008000">-</font> <font>1</font> <font color="#008000">;</font> <font color="#008000">++</font> i <font>)</font> <br> <font>{</font> <br> sb. <font color="#0000FF">Append</font> <font>(</font> forms <font>[</font> i <font>]</font> <font>)</font> <font color="#008000">;</font> <br> Int32 rp <font color="#008000">=</font> forms <font>[</font> i <font color="#008000">+</font> <font>1</font> <font>]</font> . <font color="#0000FF">IndexOf</font> <font>(</font> <font color="#666666">')'</font> <font>)</font> <font color="#008000">;</font> <br> <font color="#0600FF">if</font> <font>(</font> rp <font color="#008000">!=</font> <font color="#008000">-</font> <font>1</font> <font>)</font> <br> <font>{</font> <br> sb. <font color="#0000FF">Append</font> <font>(</font> forms <font>[</font> i <font color="#008000">+</font> <font>1</font> <font>]</font> . <font color="#0000FF">Substring</font> <font>(</font> <font>0</font> , rp <font>)</font> . <font color="#0000FF">Split</font> <font>(</font> <font color="#666666">','</font> <font>)</font> <font>[</font> idxForm <font>]</font> <font>)</font> <font color="#008000">;</font> <br> forms <font>[</font> i <font color="#008000">+</font> <font>1</font> <font>]</font> <font color="#008000">=</font> forms <font>[</font> i <font color="#008000">+</font> <font>1</font> <font>]</font> . <font color="#0000FF">Substring</font> <font>(</font> rp <font color="#008000">+</font> <font>1</font> <font>)</font> <font color="#008000">;</font> <br> <font>}</font> <br> <font>}</font> <br> sb. <font color="#0000FF">Append</font> <font>(</font> forms <font>[</font> i <font>]</font> <font>)</font> <font color="#008000">;</font> <br> form <font color="#008000">=</font> sb. <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">' <font>\u</font> fd3e'</font> , <font color="#666666">'('</font> <font>)</font> . <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">' <font>\u</font> fd3f'</font> , <font color="#666666">')'</font> <font>)</font> . <font color="#0000FF">ToString</font> <font>(</font> <font>)</font> <font color="#008000">;</font> <br> <font>}</font> <br> <font>}</font> <br> <font color="#0600FF">if</font> <font>(</font> form <font color="#008000">!=</font> <font color="#0600FF">null</font> <font>)</font> <br> <font color="#0600FF">return</font> form. <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">"%%"</font> , <font color="#666666">" <font>\u</font> fffc"</font> <font>)</font> . <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">"%"</font> , <font>(</font> <font>(</font> IFormattable <font>)</font> arg <font>)</font> . <font color="#0000FF">ToString</font> <font>(</font> <font color="#0600FF">null</font> , CultureInfo <font>)</font> <font>)</font> . <font color="#0000FF">Replace</font> <font>(</font> <font color="#666666">' <font>\u</font> fffc'</font> , <font color="#666666">'%'</font> <font>)</font> <font color="#008000">;</font> <br> <font>}</font> <br> <font color="#0600FF">return</font> FormatUnknown <font>(</font> format, arg, formatProvider <font>)</font> <font color="#008000">;</font> <br> <font>}</font> <br> <font>}</font></font></code> <br> </blockquote><br><br><blockquote> <code><font color="black">String. <font color="#660066">wformat</font> <font color="#339933">=</font> <font color="#003366">function</font> <font>(</font> f <font>)</font> <br> <font>{</font> <br> <font color="#003366">var</font> a <font color="#339933">=</font> arguments <font color="#339933">;</font> return f. <font color="#660066">replace</font> <font>(</font> <font color="#009966">/{(\d+)(.*?)}/ig</font> <font color="#339933">,</font> <font color="#003366">function</font> <font>(</font> $ <font>0</font> <font color="#339933">,</font> $ <font>1</font> <font color="#339933">,</font> $ <font>2</font> <font>)</font> <br> <font>{</font> <br> <font color="#003366">var</font> arg <font color="#339933">=</font> a <font>[</font> Number <font>(</font> $ <font>1</font> <font>)</font> <font color="#339933">+</font> <font>1</font> <font>]</font> <font color="#339933">;</font> <br> <font color="#003366">var</font> n <font color="#339933">=</font> Math. <font color="#660066">abs</font> <font>(</font> arg <font>)</font> <font color="#339933">;</font> <br> <font color="#000066">if</font> <font>(</font> $ <font>2</font> <font color="#339933">&amp;&amp;</font> <font color="#339933">!</font> isNaN <font>(</font> n <font>)</font> <font>)</font> <br> <font>{</font> <br> <font color="#003366">var</font> forms <font color="#339933">=</font> $2. <font color="#660066">replace</font> <font>(</font> <font color="#009966">/\|\|/gm</font> <font color="#339933">,</font> <font color="#3366CC">' <font>\u</font> fffc'</font> <font>)</font> . <font color="#660066">split</font> <font>(</font> <font color="#3366CC">'|'</font> <font>)</font> <font color="#339933">;</font> <br> <font color="#000066">if</font> <font>(</font> forms <font>[</font> <font>0</font> <font>]</font> . <font color="#660066">toUpperCase</font> <font>(</font> <font>)</font> <font color="#339933">==</font> <font color="#3366CC">":W"</font> <font>)</font> <br> <font>{</font> <br> <font color="#003366">var</font> idxForm <font color="#339933">=</font> <font color="#339933">-</font> <font>1</font> <font color="#339933">;</font> <br> <font color="#000066">switch</font> <font>(</font> CultureInfo. <font color="#000066">name</font> . <font color="#660066">split</font> <font>(</font> <font color="#3366CC">'-'</font> <font>)</font> <font>[</font> <font>0</font> <font>]</font> <font>)</font> <br> <font>{</font> <br> <font color="#000066">case</font> <font color="#3366CC">"en"</font> <font color="#339933">:</font> idxForm <font color="#339933">=</font> <font>(</font> n <font color="#339933">!=</font> <font>1</font> <font color="#339933">?</font> <font>1</font> <font color="#339933">:</font> <font>0</font> <font>)</font> <font color="#339933">;</font> <font color="#000066">break</font> <font color="#339933">;</font> <br> <font color="#000066">case</font> <font color="#3366CC">"ru"</font> <font color="#339933">:</font> idxForm <font color="#339933">=</font> <font>(</font> n <font color="#339933">%</font> <font>10</font> <font color="#339933">==</font> <font>1</font> <font color="#339933">&amp;&amp;</font> n <font color="#339933">%</font> <font>100</font> <font color="#339933">!=</font> <font>11</font> <font color="#339933">?</font> <font>0</font> <font color="#339933">:</font> n <font color="#339933">%</font> <font>10</font> <font color="#339933">&gt;=</font> <font>2</font> <font color="#339933">&amp;&amp;</font> n <font color="#339933">%</font> <font>10</font> <font color="#339933">&lt;=</font> <font>4</font> <font color="#339933">&amp;&amp;</font> <font>(</font> n <font color="#339933">%</font> <font>100</font> <font color="#339933">&lt;</font> <font>10</font> <font color="#339933">||</font> n <font color="#339933">%</font> <font>100</font> <font color="#339933">&gt;=</font> <font>20</font> <font>)</font> <font color="#339933">?</font> <font>1</font> <font color="#339933">:</font> <font>2</font> <font>)</font> <font color="#339933">;</font> <font color="#000066">break</font> <font color="#339933">;</font> <br> <font>}</font> <br> <br> <font color="#003366">var</font> form <font color="#339933">=</font> <font color="#003366">null</font> <font color="#339933">;</font> <br> <font color="#000066">if</font> <font>(</font> idxForm <font color="#339933">!=</font> <font color="#339933">-</font> <font>1</font> <font>)</font> <br> <font>{</font> <br> <font color="#000066">if</font> <font>(</font> forms. <font color="#660066">length</font> <font color="#339933">&gt;</font> <font>2</font> <font>)</font> <font color="#006600">// extended form</font> <br> <font>{</font> <br> idxForm <font color="#339933">=</font> n <font color="#339933">==</font> <font>0</font> <font color="#339933">?</font> <font>1</font> <font color="#339933">:</font> idxForm <font color="#339933">+</font> <font>2</font> <font color="#339933">;</font> <br> form <font color="#339933">=</font> forms <font>[</font> idxForm <font>]</font> . <font color="#660066">replace</font> <font>(</font> <font color="#009966">/\ufffc/gm</font> <font color="#339933">,</font> <font color="#3366CC">'|'</font> <font>)</font> <font color="#339933">;</font> <br> <font>}</font> <br> <font color="#000066">else</font> <font color="#000066">if</font> <font>(</font> forms. <font color="#660066">length</font> <font color="#339933">&gt;</font> <font>1</font> <font>)</font> <br> <font>{</font> <br> <font color="#003366">var</font> sb <font color="#339933">=</font> <font>[</font> <font>]</font> <font color="#339933">;</font> <br> forms <font color="#339933">=</font> forms <font>[</font> <font>1</font> <font>]</font> . <font color="#660066">replace</font> <font>(</font> <font color="#009966">/\ufffc/gm</font> <font color="#339933">,</font> <font color="#3366CC">'|'</font> <font>)</font> . <font color="#660066">replace</font> <font>(</font> <font color="#009966">/\(\(/gm</font> <font color="#339933">,</font> <font color="#3366CC">' <font>\u</font> fd3e'</font> <font>)</font> . <font color="#660066">replace</font> <font>(</font> <font color="#009966">/\)\)/gm</font> <font color="#339933">,</font> <font color="#3366CC">' <font>\u</font> fd3f'</font> <font>)</font> . <font color="#660066">split</font> <font>(</font> <font color="#3366CC">'('</font> <font>)</font> <font color="#339933">;</font> <br> <font color="#003366">var</font> i <font color="#339933">=</font> <font>0</font> <font color="#339933">;</font> <br> <font color="#000066">for</font> <font>(</font> <font color="#339933">;</font> i <font color="#339933">&lt;</font> forms. <font color="#660066">length</font> <font color="#339933">-</font> <font>1</font> <font color="#339933">;</font> <font color="#339933">++</font> i <font>)</font> <br> <font>{</font> <br> sb. <font color="#660066">push</font> <font>(</font> forms <font>[</font> i <font>]</font> <font>)</font> <font color="#339933">;</font> <br> <font color="#003366">var</font> rp <font color="#339933">=</font> forms <font>[</font> i <font color="#339933">+</font> <font>1</font> <font>]</font> . <font color="#660066">indexOf</font> <font>(</font> <font color="#3366CC">')'</font> <font>)</font> <font color="#339933">;</font> <br> <font color="#000066">if</font> <font>(</font> rp <font color="#339933">!=</font> <font color="#339933">-</font> <font>1</font> <font>)</font> <br> <font>{</font> <br> sb. <font color="#660066">push</font> <font>(</font> forms <font>[</font> i <font color="#339933">+</font> <font>1</font> <font>]</font> . <font color="#660066">substring</font> <font>(</font> <font>0</font> <font color="#339933">,</font> rp <font>)</font> . <font color="#660066">split</font> <font>(</font> <font color="#3366CC">','</font> <font>)</font> <font>[</font> idxForm <font>]</font> <font>)</font> <font color="#339933">;</font> <br> forms <font>[</font> i <font color="#339933">+</font> <font>1</font> <font>]</font> <font color="#339933">=</font> forms <font>[</font> i <font color="#339933">+</font> <font>1</font> <font>]</font> . <font color="#660066">substring</font> <font>(</font> rp <font color="#339933">+</font> <font>1</font> <font>)</font> <font color="#339933">;</font> <br> <font>}</font> <br> <font>}</font> <br> sb. <font color="#660066">push</font> <font>(</font> forms <font>[</font> i <font>]</font> <font>)</font> <font color="#339933">;</font> <br> form <font color="#339933">=</font> sb. <font color="#660066">join</font> <font>(</font> <font color="#3366CC">''</font> <font>)</font> . <font color="#660066">replace</font> <font>(</font> <font color="#009966">/\ufd3e/gm</font> <font color="#339933">,</font> <font color="#3366CC">'('</font> <font>)</font> . <font color="#660066">replace</font> <font>(</font> <font color="#009966">/\ufd3f/gm</font> <font color="#339933">,</font> <font color="#3366CC">')'</font> <font>)</font> <font color="#339933">;</font> <br> <font>}</font> <br> <font>}</font> <br> <font color="#000066">if</font> <font>(</font> form <font color="#339933">!=</font> <font color="#003366">null</font> <font>)</font> <br> <font color="#000066">return</font> form. <font color="#660066">replace</font> <font>(</font> <font color="#009966">/%%/gm</font> <font color="#339933">,</font> <font color="#3366CC">' <font>\u</font> fffc'</font> <font>)</font> . <font color="#660066">replace</font> <font>(</font> <font color="#009966">/%/gm</font> <font color="#339933">,</font> arg <font>)</font> . <font color="#660066">replace</font> <font>(</font> <font color="#009966">/\ufffc/gm</font> <font color="#339933">,</font> <font color="#3366CC">'%'</font> <font>)</font> <font color="#339933">;</font> <br> <font>}</font> <br> <font>}</font> <br> <font color="#000066">return</font> arg <font color="#339933">;</font> <br> <font>}</font> <font>)</font> <font color="#339933">;</font> <br> <font>}</font></font></code> <br> </blockquote><br><br>  ______________________ <br><h6>  The text was prepared in the <a href="http://www.softcoder.ru/blogeditor/">Habr Editor</a> from ¬© SoftCoder.ru </h6></div><p>Source: <a href="https://habr.com/ru/post/55742/">https://habr.com/ru/post/55742/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../55730/index.html">All Netbooks</a></li>
<li><a href="../55731/index.html">The history of the development of electrodynamics. Magnetism</a></li>
<li><a href="../55735/index.html">Fx 3.0.8</a></li>
<li><a href="../55736/index.html">QuotePad - an interesting notebook</a></li>
<li><a href="../55737/index.html">Dmitry Patratsky - Marketing in Crisis Russia (master class)</a></li>
<li><a href="../55743/index.html">Do we need a specific blog dedicated to the development of Gnome?</a></li>
<li><a href="../55744/index.html">LBook v3. Annual report</a></li>
<li><a href="../55745/index.html">What music do you think has a good effect on performance?</a></li>
<li><a href="../55748/index.html">Trailer game RUSE</a></li>
<li><a href="../55749/index.html">The share of Vista is growing, and XP users are switching to Mac OS X</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>