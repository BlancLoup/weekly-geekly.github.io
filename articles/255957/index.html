<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PHP and files. News without MySQL with flipping</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The cornerstone for all novice PHP programmers is the organization of the site without using a database. I will not write about expediency. There are ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PHP and files. News without MySQL with flipping</h1><div class="post__text post__text-html js-mediator-article">  The cornerstone for all novice PHP programmers is the organization of the site without using a database.  I will not write about expediency.  There are quite a few working systems, some very attractive.  It is believed that the problem of "PHP and files" has long been solved in favor of PHP + MySQL = standard.  But this problem is frozen in eternity, and still new adepts address this issue and those who already have experience in PHP programming come back. <br><a name="habracut"></a><br>  However, I was prompted to write this note by a two-year-old request from a friend who needed to display news on the site without using a database.  Moreover, the man did not even need an administration panel, since the site was located on his home computer.  The acquaintance was convinced that it could not be anything easier - open a notebook, write down the necessary text there and send it to the right folder.  I could not convince him that people invented a control panel for a reason. <br><br>  I do not remember how we solved the issue with the site.  But now this idea has surfaced in my head.  It is even interesting to count and compare the number of operations when adding news to the site through the admin area and through a notebook, taking into account the fact that the server is on the working computer. <br><br>  <b>Just for fun - honestly looking for the shortest list of operations for each.</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Classic way</b> <br>  1. Open the browser. <br>  2. Type the address or click on the tab. <br>  3. Optional.  enter the password or click confirm. <br>  4. Type the text. <br>  6. Click send. <br><br>  We get 5-6 operations.  Time spent opening a browser. <br><br>  <b>Way with files</b> <br>  1. Open the notebook. <br>  2. Type the text <br>  3. Save immediately to a folder on the server. <br><br>  But this is something there! <br><br>  3 operations, maybe 4. No time spent opening a browser, a notepad in Windows opens instantly. <br><br>  We will not write about Linux / BSD, vi editor is not for the content manager, although if the server is not on the working computer, it may still be faster to open ssh, create a file using vim or nano.  Moreover, in vim, saving and closing a file is beautifully reduced to one command.  =) <br><br>  Now a little practice.  This is just the beginning of an attempt to implement the idea of ‚Äã‚Äãnews on files.  The task is to write the most simple and understandable code. <br><br>  What would you like from the functional? <br><br><ul><li>  Show news on the main, </li><li>  Scroll </li><li>  Add via admin panel </li></ul><br><br>  What would <b>not</b> want? <br><ul><li>  Use the scandir or glob function. </li><li>  Use arrays in general. </li></ul><br>  So, the implementation: <br><br>  1. Create a folder in the <b>www</b> directory to store files, I have <b>bd /</b> . <br><br>  2. Create a file in bd with the name, for example, <b>all.dat</b> - we will be counting the news in it.  The presence of this file eliminates the use of the scandir or glob functions to count files.  We write in it the number 0. <br><br>  <b>Admin panel</b> <br>  Create an <b>ad</b> folder in the www directory and put the following script there.  I have index.php.  Taking into account that this directory will be under the password and is accessible only to one administrator, then some principles of good code can be neglected. <br><br>  <b>News entry form.</b> <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">align</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"center"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"index.php"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>New<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cols</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"80"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rows</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"25"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textarea</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ok"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"send"</span></span></span><span class="hljs-tag"> "/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"reset"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">reset</span></span></span><span class="hljs-tag"> /&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  It's simple.  We process the form.  I make a minimum of conditions.  If the text field is not empty, then we get an entry from the file in which we keep records - all.dat.  And in it we have 0. <br>  We create a file named 0.txt, check its presence just in case, and write data to it. <br><pre> <code class="php hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $text1 = $_POST[<span class="hljs-string"><span class="hljs-string">'text1'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($_POST[<span class="hljs-string"><span class="hljs-string">'ok'</span></span>]) &amp;&amp; (!<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($text1))) { $all = file_get_contents(<span class="hljs-string"><span class="hljs-string">'../bd/all.dat'</span></span>); $file = <span class="hljs-string"><span class="hljs-string">'../bd/'</span></span> . $all . <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!file_exists($file)) { $fp = fopen($file, <span class="hljs-string"><span class="hljs-string">"w"</span></span>); fclose($fp); $fp = fopen($file, <span class="hljs-string"><span class="hljs-string">"r+"</span></span>); fwrite($fp, $text1); } } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br><br>  Now check the existence of a new file and increase the counter by 1 in the file all.dat. <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $new = <span class="hljs-string"><span class="hljs-string">'../bd/'</span></span> . $all . <span class="hljs-string"><span class="hljs-string">'.txt'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file_exists($new)) { $all+= <span class="hljs-number"><span class="hljs-number">1</span></span>; $fp = fopen(<span class="hljs-string"><span class="hljs-string">'../bd/all.dat'</span></span>, <span class="hljs-string"><span class="hljs-string">"r+"</span></span>); fwrite($fp, $all); fclose($fp); } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br><br>  To display news on the main page, we will write such a script.  Get the number of records from all.dat. <br>  Then it is quite simple, if the variable for the page - p - is set and there is such a file, we get the contents. <br>  Otherwise, we get the last entry made. <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $p = $_GET[<span class="hljs-string"><span class="hljs-string">'p'</span></span>]; $allcount = file_get_contents(<span class="hljs-string"><span class="hljs-string">'bd/all.dat'</span></span>); $entry = <span class="hljs-string"><span class="hljs-string">"bd/{$p}.txt"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>($p) &amp;&amp; file_exists($entry)) { $news = file_get_contents($entry); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $p = $allcount - <span class="hljs-number"><span class="hljs-number">1</span></span>; $entry = <span class="hljs-string"><span class="hljs-string">"bd/{$p}.txt"</span></span>; $news = file_get_contents($entry); } <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bform</span></span></span><span class="hljs-class">"&gt;&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">headlines</span></span></span><span class="hljs-class">"&gt;&lt;?=$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">news</span></span></span><span class="hljs-class">?&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">footer</span></span></span><span class="hljs-class"> "&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">href</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">index</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class">"&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">First</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">&gt; | &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">href</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">index</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class">?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">=&lt;?=--$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">?&gt;"&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Next</span></span></span><span class="hljs-class">&lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class">&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre><br><br>  Please note that the records are upside down, that is, the file with a large number in the name is the latest news on the main one, and the decrement is used to rewind. <br><br>  Conclusion: it turned out to get rid of arrays, cycles and functions glob, scandir. <br>  You can also just add and edit to the script in the admin panel.  It remains only to organize the protection and you can test the script on a free hosting. <br><br>  Files can be stored not in .txt but .html, which will allow you to prescribe for each file, for example, its own meta tags. <br>  It will be easy to add this option to the admin panel. <br><br>  <b>Post Scriptum:</b> <br>  The purpose of this note is to draw attention to the overload of professional solutions for news organizations and to find inspiration for writing micro-engines. <br><br>  Link for inspiration: a <a href="http://micronewsphp.890m.com/micr/">case study and a link to an exact copy</a> <br><br>  <b>Addition:</b> based on this script, you can try to implement an <b>automatic text slider</b> .  You can use ajax, I use the pseudo-Ajax in the example below and some animation (CSS3). <br>  It is recommended to open in Opera or Chrome: <a href="http://gentoo.micronewsphp.890m.com/index.html">Link</a> <br><br>  <b>Fictions</b> <br>  In the slider, you can add an option to adjust the pause.  If you calculate the groove using a script and set the time value based on the number of characters (and taking into account the average reading speed of an adult), you can easily get a fully automatic system for speed reading. <br>  All that remains is to add voice recognition and you can move away from the screen. </div><p>Source: <a href="https://habr.com/ru/post/255957/">https://habr.com/ru/post/255957/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255945/index.html">Neural Interfaces: From Photo Paper to Neural Dust</a></li>
<li><a href="../255949/index.html">Retro style in photographic equipment: where does fashion end and need begin?</a></li>
<li><a href="../255951/index.html">New superblits on java hardcore</a></li>
<li><a href="../255953/index.html">Cross article publisher - what should it be?</a></li>
<li><a href="../255955/index.html">Tablet and domain: unity and struggle of opposites</a></li>
<li><a href="../255961/index.html">How to distinguish day from night if you are Android</a></li>
<li><a href="../255963/index.html">Krovi: Big Data - as dream. 6th series. BD (Bolt Data) - Fast Big Data Data</a></li>
<li><a href="../255967/index.html">How it all works: the node of financial trading from the inside</a></li>
<li><a href="../255969/index.html">We start the site on the cloud VPS from Infobox in 10 minutes</a></li>
<li><a href="../255971/index.html">IBM Lotus Domino / Notes Outsourcing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>