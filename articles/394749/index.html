<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A critical hole in the heart of cellular networks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As for the attacks on SS7, there have already been several detailed technical content articles on our resource: 
 

- Attacks on SS7: yesterday for sp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A critical hole in the heart of cellular networks</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/5de/535/4a9/5de5354a9328cad24dd842e7b6d3c6db.jpg" alt="image"><br>  <i>As for the attacks on SS7, there have already been several detailed technical content articles on our resource:</i> <i><br></i> <ul><li>  <a href="https://habrahabr.ru/company/pt/blog/237981/">Attacks on SS7: yesterday for special services, today for all</a> </li><li>  <a href="https://habrahabr.ru/company/pt/blog/226977/">Listening Ukrainian mobile phones: how it is done and how to protect</a> </li><li>  <a href="https://habrahabr.ru/company/pt/blog/283052/">How to hack Telegram and WhatsApp: special services are not needed</a> </li></ul><br>  But in this article, what is happening is explained in simpler words, and may interest people far from the internal structure of mobile networks. <br><br>  In February 2014, the US ambassador to Ukraine was the victim of a disgraceful diversion.  A secret conversation between him and Assistant Secretary of State for European and Eurasian Affairs Victoria Nuland, in which she spoke about the European Union in <a href="http://www.bbc.com/news/world-europe-26079957">rude expressions</a> , was posted on YouTube. <br><br>  The conversation was conducted through an <a href="http://www.reuters.com/article/ukraine-phonecall-idUSL2N0LC1E120140207">unprotected connection</a> , and representatives of the US government told reporters about their suspicions of intercepting a call in Ukraine, but not the methodology of this interception.  Some believe that this was due to the exploitation of vulnerabilities in the SS7 mobile data network, which is part of the basic infrastructure used by telephone providers around the world for inter-provider communication, call forwarding and text messaging. <br><a name="habracut"></a><br>  The report of the Ukrainian government, which remained almost unnoticed, was released a few months after the incident, lent credibility to this theory.  Although the ambassador was not mentioned in the report, it said that within three days in April, data on the location of a dozen unknown mobile phone users in Ukraine were sent to a Russian provider through the use of vulnerabilities in SS7.  Some text messages and phone calls were also forwarded to Russia, where someone could listen and record them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For many years now, providers have known that SS7 is vulnerable to wiretapping, but they did little about it, because it was believed that these risks were more theoretical.  Everything changed after the incident in Ukraine, says Cathal McDaid, head of threat intelligence at mobile security at AdaptiveMobile.  Some companies, including his company, have developed methods for detecting attacks on SS7, and since then they have already detected suspicious activity in the networks of various providers, which proves not only the reality of attacks on SS7, but also that they occur periodically.  AdaptiveMobile released a report in February, which described in detail some of the attacks. <br><br>  SS7 is only now appearing in public attention, for example, because of the plot in the 60 Minutes program last week, in which two researchers from Germany used SS7 to spy on US Congressman Ted Lew ‚Äî with his permission.  Lew organized a <a href="http://thehill.com/policy/cybersecurity/276665-dem-wants-congress-to-investigate-mobile-network-security">congressional hearing</a> to investigate SS7 vulnerabilities, and the FCC <a href="http://thehill.com/policy/technology/277063-fcc-to-take-look-at-mobile-networks-security">also has plans</a> to study them. <br><br>  So what is SS7 and why is it so vulnerable? <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/19d/601/04c/19d60104cc94ac6cd88bd381438794a0.jpg" alt="image"><br>  <i>The graph shows how one system in Eastern Europe used SS7 to track one subscriber for two minutes, sending requests to the location of the subscriber provider.</i>  <i>In a minute, the cascade of requests for the same subscriber came from many systems from different countries.</i> <br><br><h4>  SS7 Alphabet </h4><br>  SS7, or <a href="http://lteworld.org/wiki/signaling-system-number-7-ss7">Signaling System No.</a>  <a href="http://lteworld.org/wiki/signaling-system-number-7-ss7">7</a> (signal system No. 7) is a digital network and a set of technical protocols or rules governing the exchange of data over this network.  It was developed in the 1970s to track and connect telephone calls on landlines between different networks, and now it is used to calculate bills for mobile calls and SMS, in addition to roaming and calls between landlines and regional PBXs.  SS7 is part of the foundation of telecommunications, but this is not the network that your conversations go through - it is a separate administrative network that performs other tasks.  If you imagine a passenger train system, then the SS7 is the technical tunnels that workers use instead of the main tunnels, where passenger trains run. <br><br>  Now SS7 is often used for roaming, so when traveling you can receive and make calls and send SMS even where your home provider is not working.  The external provider, via SS7, sends your request to get your phone's unique ID to track it, and request that your communications be transferred to its network so that it can provide call and message translation. <br><br><h4>  Problem </h4><br>  The problem is that the SS7 network <a href="https://www.sans.org/reading-room/whitepapers/critical/fall-ss7--critical-security-controls-help-36225">works on trust</a> .  Any request received by the network is considered legitimate.  Therefore, any person with access to a server or gateway on an SS7 network can send a request for location or redirection for roaming purposes, and the provider will most likely respond to it, even if the request goes from St. Petersburg to Bombay, and you are on the phone with New York.  The attacker can thus spy on officials, company directors, military, activists and others.  It is worth noting that intercepting your messages and calls means that an attacker will also be able to intercept two-factor authentication codes, which are sent via SMS to Gmail and other services to access your accounts.  The attacker, knowing the username and password of the account, can intercept these codes before you receive them. <br><br>  Access to SS7 is from hundreds of providers around the world.  Various government intelligence agencies can also access networks, either with or without the provider‚Äôs permission.  Commercial companies also <a href="https://www.washingtonpost.com/business/technology/for-sale-systems-that-can-secretly-track-where-cellphone-users-go-around-the-globe/2014/08/24/f0700e8a-f003-11e3-bf76-447a5df6411f_story.html">sell SS7 hacking services to</a> governments and other customers.  Criminals can buy network access from dishonest providers, and hackers can <a href="http://labs.p1sec.com/2014/05/02/hackito-ergo-sum-2014-worldwide-attacks-on-ss7sigtran-network/">hack into unsafe equipment</a> that serves SS7. <br><br>  But providers began to use ways to prevent attacks no earlier than December 2014.  It was then that Carsten Nohl from the German company <a href="https://srlabs.de/">Security Research Labs</a> and independent security researcher Tobias Engel <a href="https://www.youtube.com/watch%3Fv%3DqpW9o4SP3K8">made a presentation</a> on SS7 at the <a href="https://www.youtube.com/watch%3Fv%3D-wu_pO5Z7Pk">Chaos Communication Congress</a> in Germany.  It took place a few months after the opening of the Ukrainian incidents.  Engel showed the <a href="http://events.ccc.de/congress/2008/Fahrplan/attachments/1262_25c3-locating-mobile-phones.pdf">method of tracking phones</a> via SS7 in 2008, but he was not as comfortable as the ones he and Nol described in 2014.  As a result, Nordic regulators demanded that providers enter measures to prevent SS7 attacks by the end of 2015. <br><br>  ‚ÄúMost SS7 attacks can be prevented with existing technology,‚Äù Nohl said.  ‚ÄúThere are several cases, the creation of protection against which will take a couple of years ... but at least the main form of protection is in most networks in Northern Europe and in other networks in the world.‚Äù <br><br>  But these corrections were obviously not made by two US providers - T-Mobile and AT &amp; T.  Nol and a colleague showed in the 60 Minutes program that both were vulnerable to attack.  Verizon and Sprint use other protocols to exchange data, and in theory they are less vulnerable.  But McDade said that all mobile networks will eventually move to another signaling system called Diameter.  This system ‚Äúrepeats many concepts and devices of previous SS7 networks,‚Äù he notes, including the assumption that all requests can be trusted - that which destroys SS7. <br><br><h4>  And how can you use SS7 to track you personally? </h4> <br>  To do this, you can send your Anytime Interrogation (AI) request to your provider to get your phone's unique ID and determine which mobile communication center (MSC) your phone uses. Usually one MSC covers the entire city. Providers use this information to determine your location, to send you calls and messages through the communication tower closest to you. By sending repeated AI requests to get information about you and your GPS coordinates, an attacker can track your phone and you up to a quarter. <br><br>  Providers could prevent this by blocking AI requests coming from outside their borders, says Nol.  But there are other ways to get information about the location, through other requests in SS7, and they are no longer so easily blocked. <br><br>  And this is not a hypothetical possibility.  We know that this method was used in practice.  A report from AdaptiveMobile describes one operation in which an attacker sent location requests from multiple systems.  Tracking requests for the same customers came from SS7 systems around the world, rather than from one ‚Äî perhaps not to arouse suspicion, since many requests from one system would be easier to notice.  These systems sent several hundred requests per day, tracking certain subscribers, while sending one or two requests per day to the numbers that the hackers tried to hack. <br><br>  ‚ÄúObviously, the more you use the system to send requests, the more likely you will issue yourself.  But these were valuable targets and their number was small, says McDade.  ‚ÄúAs long as you send some requests, there is a chance that they will not be noticed.‚Äù <br><br>  Another operation in one of the European countries was to track the phones in the Middle East and Europe from the systems installed in each of the four European providers, which suggests the idea of ‚Äã‚Äãtheir involvement.  "This is our assumption ... If this is a spying system or a state system, then providers have little choice." <br><br><h4>  Intercept </h4><br>  Nola describes three technologies for intercepting calls and texts via SS7.  One op showed ‚Äú60 minutes Australia‚Äù in the program, sending a request from Germany to an Australian provider, and changing the voice mail policy settings so that incoming calls would be redirected to Nol‚Äôs phone.  This could have been easily prevented by responding only to inquiries coming from the region where the telephone is located - but few people check it. <br><br>  Another method uses the ability to change the numbers to which you are calling.  If you went abroad and dialed a number from contacts, the function of changing numbers understands that the call is international and adds a country code. <br><br>  ‚ÄúThe country code is added by replacing the‚Äú wrong ‚Äùnumber with the‚Äú correct ‚Äùone, with the added code, and sending it back,‚Äù explains Nol.  - Convenient, right?  But an attacker can force a system to replace any number with another.  When the call comes, it is forwarded to the desired number, and the attacker remains in the middle, with the ability to listen to and record the call. <br><br>  The third method takes advantage of the fact that mobile phones are usually in sleep mode until they receive a call or text, and do not communicate with the network.  At this time, the attacker tells your provider that you are in Germany, and all communications must be redirected there.  Someday your phone in the US will wake up and tell where it is.  But an attacker can send another message to refute this. <br><br>  ‚ÄúIf you do this every five minutes, you will very rarely be able to receive calls and SMS exclusively - most of the time we will receive them,‚Äù says Nol.  You will then notice the roaming bill, but by that time your privacy will have suffered. <br><br>  ‚ÄúThis is not the most elegant method of interception, since you have to pay for roaming.  But it works well, ‚Äùhe says. <br><br><h4>  What to do? </h4><br>  Such an attack is easily prevented using an algorithm that understands that the user cannot quickly jump between the United States and Germany.  ‚ÄúBut no one simply introduces such checks,‚Äù says Nol. <br><br>  Personally, you can do little.  You can protect your communication with services such as Signal, WhatsApp or Skype, but McDaid says that an attacker can send your provider a request to disable data services.  ‚ÄúTherefore, you will only have SMS and calls if you do not have access to Wi-Fi,‚Äù he says.  And you will remain vulnerable to SS7 attacks. <br><br>  McDaid says that providers are working to prevent such attacks, but for now most of them are limited to the simplest methods.  "Now they have reached the stage at which they have to install much more sophisticated firewalls and algorithms that are trying to detect and prevent more complex attacks," he says.  ‚ÄúAttacking is more difficult for them, but it is also harder for the defense to stop them.  Believe me - work on these attacks is underway. ‚Äù </div><p>Source: <a href="https://habr.com/ru/post/394749/">https://habr.com/ru/post/394749/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../394739/index.html">The book "Skeletons in the closet. The dramatic evolution of man "</a></li>
<li><a href="../394741/index.html">Interview with LENR experimenter - me356</a></li>
<li><a href="../394743/index.html">Intel invites you to Moscow Maker Faire</a></li>
<li><a href="../394745/index.html">Found a vulnerability on a medical site? Get a visit from FBI gunmen</a></li>
<li><a href="../394747/index.html">AlphaGo to play go with Chinese champion Ke Jie</a></li>
<li><a href="../394751/index.html">Production of speaker cases: Overview of materials</a></li>
<li><a href="../394753/index.html">Games for programmers</a></li>
<li><a href="../394755/index.html">Knowledge of physics helps beat casino roulette</a></li>
<li><a href="../394757/index.html">Developing IoT devices using Bluetooth LE</a></li>
<li><a href="../394759/index.html">How the US Department of Defense protects the ears of soldiers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>