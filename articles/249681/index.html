<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Protection of games and mobile applications from hacking for dummies (Unity, C #, Mono)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone again! We reached out to write a cool article on a very important topic for game developers. So, let's talk about protecting your preci...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Protection of games and mobile applications from hacking for dummies (Unity, C #, Mono)</h1><div class="post__text post__text-html js-mediator-article">  Hello everyone again!  We reached out to write a cool article on a very important topic for game developers.  So, let's talk about protecting your precious games and applications that you cut on Unity in the hope of earning a loaf of bread from hacking by evil students.  Why schoolchildren?  Because reliable 100% protection a priori can not be.  And whoever wants to, will still hack.  The only question is how much time and energy he spends on it.  And as the security guards love to joke - nobody canceled thermorectal cryptanalysis. <br><br>  So, in the article I will try to tell as much as possible about 3 aspects (and of course, I will propose an implementation): <br><ul><li>  application data protection (saves) </li><li>  application memory protection </li><li>  protection of in-game purchases (Google Play) </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/9f9/dc3/9f3/9f9dc39f333a014c0d7119f780a67f8d.jpg" alt="image"><a name="habracut"></a><br><br><h4>  1. Preparation </h4><br>  First you need to learn how to convert game data (types, classes) into strings.  Worth learning JSON or XML serialization.  I do not recommend starting with XML, because  There will be problems with iOS.  It is better to learn JSON, here is the link <a href="http://wiki.unity3d.com/index.php/SimpleJSON">wiki.unity3d.com/index.php/SimpleJSON</a> .  Unfortunately, this is the topic of a separate article and I will not dwell on it.  If you are too lazy to figure it out, you can manually sculpt the string using separators.  For example: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profile = <span class="hljs-string"><span class="hljs-string">"name=player;money=999;level=80"</span></span>;</code> </pre> <br>  You also need to be able to convert strings to byte arrays and back.  Everything is simple: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bytes = Encoding.Default.GetBytes(profile); profile = Encoding.Default.GetString(bytes);</code> </pre><br>  Further, the line can be veiled by applying the base64 transformation to it.  I note in particular that base64 is not encryption, it does not have an encryption key and all that.  base64 converts your string to a new string, consisting only of ASCII characters.  Visually see how this happens, you can link <a href="http://base64.ru/">base64.ru</a> .  I'll just give the implementation code: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Assets.Scripts.Common</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Base64</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Encode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> plainText</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> plainTextBytes = Encoding.UTF8.GetBytes(plainText); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Convert.ToBase64String(plainTextBytes); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Decode</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> base64EncodedData</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> base64EncodedBytes = Convert.FromBase64String(base64EncodedData); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Encoding.UTF8.GetString(base64EncodedBytes); } } }</code> </pre><br>  Also note that base64 works quickly and is comparable in speed with the addition operation.  You can perform such conversions even in the Update loop. <br><br><h4>  2. Game data protection (saves) </h4><br>  So, now we can convert game data into a string.  Now you need to think where to save them.  First of all, it comes to mind to save saves to files in Application.persistentDataPath.  There are two disadvantages to this method: <br><ul><li>  Application.persistentDataPath may change when the application is updated (for example, the application will move to the SD card).  Accordingly, the save file will be not found, and the user will lose all progress. </li><li>  It will not work in web-player and windows phone </li></ul><br>  The second and most correct way is to save to PlayerPrefs.  Example below: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> key = <span class="hljs-string"><span class="hljs-string">"profile"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profile = <span class="hljs-string"><span class="hljs-string">"name=player;money=999;level=80"</span></span>; PlayerPrefs.SetString(key, profile); PlayerPrefs.Save(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PlayerPrefs.HasKey(key)) { profile = PlayerPrefs.GetString(key); }</code> </pre><br>  Oh yes, baby, super!  Now we need to encrypt our save.  Here you can quickly perform the base64 conversion, this will protect the save from editing through most hacking programs.  But in hardcore it's time to screw the normal encryption.  Go to work, take AES and encrypt.  Copy the AES.cs file and don‚Äôt wonder how it works: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Security.Cryptography; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Assets.Scripts.Common</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> AES (Advanced Encryption Standard) implementation with 128-bit key (default) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> - 128-bit AES is approved by NIST, but not the 256-bit AES </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> - 256-bit AES is slower than the 128-bit AES (by about 40%) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> - Use it for secure data protection </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> - Do NOT use it for data protection in RAM (in most common scenarios) </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public static class AES { public static int KeyLength = 128; private const string SaltKey = "ShMG8hLyZ7k~Ge5@"; private const string VIKey = "~6YUi0Sv5@|{aOZO"; // </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> Generate random VI each encryption and store it with encrypted value public static string Encrypt(byte[] value, string password) { var keyBytes = new Rfc2898DeriveBytes(password, Encoding.UTF8.GetBytes(SaltKey)).GetBytes(KeyLength / 8); var symmetricKey = new RijndaelManaged { Mode = CipherMode.CBC, Padding = PaddingMode.Zeros }; var encryptor = symmetricKey.CreateEncryptor(keyBytes, Encoding.UTF8.GetBytes(VIKey)); using (var memoryStream = new MemoryStream()) { using (var cryptoStream = new CryptoStream(memoryStream, encryptor, CryptoStreamMode.Write)) { cryptoStream.Write(value, 0, value.Length); cryptoStream.FlushFinalBlock(); cryptoStream.Close(); memoryStream.Close(); return Convert.ToBase64String(memoryStream.ToArray()); } } } public static string Encrypt(string value, string password) { return Encrypt(Encoding.UTF8.GetBytes(value), password); } public static string Decrypt(string value, string password) { var cipherTextBytes = Convert.FromBase64String(value); var keyBytes = new Rfc2898DeriveBytes(password, Encoding.UTF8.GetBytes(SaltKey)).GetBytes(KeyLength / 8); var symmetricKey = new RijndaelManaged { Mode = CipherMode.CBC, Padding = PaddingMode.None }; var decryptor = symmetricKey.CreateDecryptor(keyBytes, Encoding.UTF8.GetBytes(VIKey)); using (var memoryStream = new MemoryStream(cipherTextBytes)) { using (var cryptoStream = new CryptoStream(memoryStream, decryptor, CryptoStreamMode.Read)) { var plainTextBytes = new byte[cipherTextBytes.Length]; var decryptedByteCount = cryptoStream.Read(plainTextBytes, 0, plainTextBytes.Length); memoryStream.Close(); cryptoStream.Close(); return Encoding.UTF8.GetString(plainTextBytes, 0, decryptedByteCount).TrimEnd("\0".ToCharArray()); } } } } }</span></span></code> </pre><br><h4>  3. Protection of application memory </h4><br>  Everyone remembers such a PC program like ArtMoney?  She was able to look for values ‚Äã‚Äãin RAM and in several iterations of screening allowed to become a millionaire in the game.  Now there are a lot of similar programs for Android and iOS, for example the most popular one is GameKiller. <br><br>  Protection from such programs is quite simple - you need to encrypt the values ‚Äã‚Äãin the application's memory.  Encrypt EVERY TIME while writing and decrypt EVERY TIME while reading.  And since the operation is quite frequent, it makes no sense to use heavy AES and we need a super-fast algorithm.  I propose to slightly modify our base64 and implement our encryption - effective, fast, with blackjack and XOR: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Assets.Scripts.Common</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Simple and fast Base64 XOR encoding with dynamic key (generated on each app run). Use for data protection in RAM. Do NOT use for data storing outside RAM. Do NOT use for secure data encryption. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public class B64X { public static byte[] Key = Guid.NewGuid().ToByteArray(); public static string Encode(string value) { return Convert.ToBase64String(Encode(Encoding.UTF8.GetBytes(value), Key)); } public static string Decode(string value) { return Encoding.UTF8.GetString(Encode(Convert.FromBase64String(value), Key)); } public static string Encrypt(string value, string key) { return Convert.ToBase64String(Encode(Encoding.UTF8.GetBytes(value), Encoding.UTF8.GetBytes(key))); } public static string Decrypt(string value, string key) { return Encoding.UTF8.GetString(Encode(Convert.FromBase64String(value), Encoding.UTF8.GetBytes(key))); } private static byte[] Encode(byte[] bytes, byte[] key) { var j = 0; for (var i = 0; i </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt; bytes.Length; i++) { bytes[i] ^= key[j]; if (++j == key.Length) { j = 0; } } return bytes; } } }</span></span></span></span></code> </pre><br>  Now, as soon as we read and decrypted the AES profile from the save, we immediately encrypt all the values ‚Äã‚Äãwith this B64X (I came up with the name myself).  And decrypt each time you need to find out how much money a player has, what level he has, etc.  B64X can use a key (password) for encryption, or it can use a random session session key so that we do not steam, where and how to store it. <br><br><h4>  4. Protection of in-app purchases </h4><br>  For many developers, this topic is not relevant and very few people implement protection.  In principle, if you have a multiplayer game, then you need to think about protecting its economy.  There is such a program - Freedom.  It requires a root and, if in a nutshell, replaces the service of in-game purchases.  In short - the player can make purchases for free. <br><br>  Let us omit consideration of the mechanism for checking purchases on the developer's server, because not everyone has it.  I'll tell you what Google offers in such cases. <br><br>  UPD: Unity has implemented the purchase mechanism and its verification (http://docs.unity3d.com/Manual/UnityAnalyticsReceiptVerification.html), so the information below now only has a theoretical load. <br><br>  When creating an application in the developer console, Google generates a key pair for the RSA algorithm ‚Äî public and private key.  If you do not know what it is - google asymmetric encryption.  The public key can be obtained in the developer console: <br><br><img src="http://s015.radikal.ru/i331/1502/a5/a9e65c6c1ab2.png" alt="image"><br><br>  You still use it when you implement the game store in the application. <br><br>  The Google private key will never show you and will use it to digitally sign purchases.  Accordingly, the private key can only encrypt the signature, and the public key can only decrypt the signature. <br><br>  The protection mechanism is pretty simple - Google signs all the json-responses of the shopping server, and no one else can fake such a signature.  The developer, knowing the public key, can verify the digital signature of the server responses.  And if the server was fabricated using Freedom, the digital signature will be incorrect. <br><br>  Let's turn to implementation.  First you need to perform one unpleasant operation.  You need to convert the base64 public key from the developer console to an xml key that is suitable for decrypting the signature.  It seems to Swidz that it is enough just to decode it with base64.  But it is not.  I propose to use the online service and immediately prikopat xml-key in the application.  Especially not to bother about his protection is not worth it - it's the public key.  It can be fabricated, but that's another story.  So, here is the service, insert your base64 key there and get the xml-key: <a href="http://superdry.apphb.com/tools/online-rsa-key-converter">superdry.apphb.com/tools/online-rsa-key-converter</a> <br><br><img src="http://s04.radikal.ru/i177/1502/4c/ea55f93ff94e.png" alt="image"><br><br>  The bottom field is our xml key.  Save it in the game or application.  And then everything is simple.  Google returns the purchase to us.  If you use a free plugin in your application to make purchases from OpenIAB, then this is an object of the Purchase class, it has 2 fields we need: <br><br><pre> <code class="cs hljs">Purchase purchase; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> json = purchase.OriginalJson; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> signature = purchase.Signature;</code> </pre><br>  Now I will give the implementation of the signature verification mechanism: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Security.Cryptography; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">Assets.Scripts.Common</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GooglePlayPurchaseGuard</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Verify Google Play purchase. Protect you app against hack via Freedom. More info: http://mrtn.me/blog/2012/11/15/checking-google-play-signatures-on-net/ </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="purchaseJson"&gt;</span></span></span><span class="hljs-comment">Purchase JSON string</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="base64Signature"&gt;</span></span></span><span class="hljs-comment">Purchase signature string</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="xmlPublicKey"&gt;</span></span></span><span class="hljs-comment">XML public key. Use http://superdry.apphb.com/tools/online-rsa-key-converter to convert RSA public key from Developer Console</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;returns&gt;</span></span></span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/returns&gt;</span></span></span><span class="hljs-comment"> public static bool Verify(string purchaseJson, string base64Signature, string xmlPublicKey) { using (var provider = new RSACryptoServiceProvider()) { try { provider.FromXmlString(xmlPublicKey); var signature = Convert.FromBase64String(base64Signature); var sha = new SHA1Managed(); var data = System.Text.Encoding.UTF8.GetBytes(purchaseJson); return provider.VerifyData(data, sha, signature); } catch (Exception e) { UnityEngine.Debug.Log(e); } return false; } } } }</span></span></code> </pre><br><br>  Well, now, when Google received the answer that the purchase was made, check its signature and show the player a fig, if the signature does not match: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (GooglePlayPurchaseGuard.Verify(purchase.OriginalJson, purchase.Signature, publicKeyXml)) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { }</code> </pre><br>  I want to note that when making a purchase, it is better to add a random payload to the request, this will protect against man-in-the-middle attacks, when you can re-push the correct server response with the correct, but the same digital signature.  This is an optional argument in the OpenIAB implementation, on which most bolts put: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">purchaseProduct</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sku, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> developerPayload = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">)</span></span></code> </pre><br>  A more detailed description of the mechanism can be found in English at the link: <a href="http://mrtn.me/blog/2012/11/15/checking-google-play-signatures-on-net/">mrtn.me/blog/2012/11/15/checking-google-play-signatures-on-net</a> <br><br><h4>  5. Conclusion </h4><br>  I hope the article was not too boring.  In any case, thank you for your attention, make high-quality games and give players new experiences! <br>  PS Recently, in the gaming industry and I want to change the scope of activities) </div><p>Source: <a href="https://habr.com/ru/post/249681/">https://habr.com/ru/post/249681/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249665/index.html">Mobile app security, or ‚ÄúWho will check the reviewers?‚Äù</a></li>
<li><a href="../249673/index.html">27 new free courses virtual academy Microsoft Virtual Academy, February 2015</a></li>
<li><a href="../249675/index.html">Right now there is a live seminar on Extreme Networks</a></li>
<li><a href="../249677/index.html">Installing MeteorJS on Raspberry Pi B + running Arch Linux ARM</a></li>
<li><a href="../249679/index.html">Installation manual for the Couchbase 2.1.1 Community and the basics of working with it</a></li>
<li><a href="../249685/index.html">(Video) How to document the project at the start and the project scope</a></li>
<li><a href="../249687/index.html">VMware vSphere 5.5 Problem Solving Training Workshop</a></li>
<li><a href="../249693/index.html">Model of access control systems in an enterprise based on Arduino</a></li>
<li><a href="../249695/index.html">A simple solution for using EDS - development</a></li>
<li><a href="../249697/index.html">Using graphs to reveal insider plans</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>