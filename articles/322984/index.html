<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Again about floating point numbers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Despite the fact that a lot of publications are devoted to the issues of the accuracy of computer calculations, some of them, in our opinion, are stil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Again about floating point numbers</h1><div class="post__text post__text-html js-mediator-article"> Despite the fact that a lot of publications are devoted to the issues of the accuracy of computer calculations, some of them, in our opinion, are still not fully disclosed.  Namely: <br><br>  1. What number of valid digits n is guaranteed to have a decimal number represented by a binary m-digit code in the format of a floating-point number. <br>  2. How does the normalization of floating-point numbers affect the accuracy of the representation of a number when converting it from one number system to another and with arithmetic operations performed on a computer. <br>  3. How does the rounding of a number represented in binary form affect its decimal equivalent? <br>  4. How the position of a virtual point in a machine word affects the value of a number represented in exponential form. <br><br>  Below we will try to answer these questions. <br><a name="habracut"></a><br>  In our reasoning, we will proceed from the concepts of numbers from the standpoint of classical arithmetic.  We will consider numbers, the number of significant digits of which is limited by the bit grid of the machine word.  To simplify the presentation we will consider only positive numbers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a rule, before making any arithmetic operations on a computer on decimal numbers, they are presented in a fractional binary form in a natural form, and then write the resulting numbers in a normalized exponential form: <br><br>  F = M * 2 ^ -p, <br><br>  where M is the binary number mantissa, 2 ^ -p is the characteristic of a number, it is often called the exponent, p is the order of the characteristic. <br><br>  A binary number represented in decimal form will be called the binary equivalent of a decimal number.  A decimal number represented in binary will be called the binary equivalent of a decimal number. <br><br>  If the natural record of a number is taken as the mantissa M, then the order of the characteristic in the above formula will be zero, and the characteristic, respectively, will be one.  We will have a number represented as F = M * 2 ^ 0 = M.  For example, the binary number F = 0.011 has the order p = 0.  If the point in the number is conventionally put before the most significant digit, then the order of the characteristic is p = -1 and F = 0.11 * 10 ^ -1.  If the point in the number is conventionally put after the most significant digit, then the order is p = -2 and F = 1.1 * 10 ^ -2.  If you put a virtual point after the lower order of the mantissa M, then the mantissa will be an integer and for it p = -3, and F = 11 * 10 ^ -3.  As we see, in all cases the order of the characteristic is equal to the number of displacements of the virtual point in the number relative to its position in the natural record.  All types of records in our examples are equivalent and have the same meaning. <br><br>  Thus, the value of the indicator of the characteristic of a number represented in an exponential form, taking into account the position of the virtual point, determines the place of the point in the number recorded in its natural form. <br><br>  The width of the machine mantissa uniquely determines the number of decimal numbers that can be represented in this mantissa in binary form.  And the position of the virtual point in the mantissa determines the area on the number axis where these numbers are located.  Binary numbers, the number of significant digits of which does not exceed the number of bits of the machine mantissa, are exact, and the decimal numbers obtained by converting these binary numbers to decimal are called representable. <br><br>  Due to the fact that not all significant digits of a binary number can fit into the bit grid of the machine mantissa, this number is rounded to the required number of significant digits.  Such a number is sometimes called rounded to the nearest representable.  The rounded binary number becomes approximate. <br><br>  Despite the fact that all binary numbers are equivalent to representable decimal numbers, not all decimal numbers can be represented in a machine word.  This is due to the disparity of the decimal and binary number systems.  Therefore, decimal numbers, in general, can be represented in binary form approximately, while all binary numbers can be represented in decimal form exactly.  Or in other words.  The binary equivalent of a decimal number of finite duration can contain an infinite number of significant digits.  The decimal equivalent of a binary number of finite duration contains a finite number of significant digits. <br><br>  Approximate numbers consist of correct (in a broad sense) and incorrect numbers.  Incorrect numbers in arithmetic distort the final result.  To prevent this from happening, approximate numbers are rounded to the nearest valid digit. <br><br>  The rounding of binary numbers leads to a decrease in the correct numbers taken into account in a rounded number and to a change in incorrect numbers in its decimal equivalent.  Incorrect numbers form the absolute error of conversion. <br><br>  Rounding a binary number to the nearest representable leads to an increase in the error in representing the decimal equivalent of this number.  This is due to the fact that when rounding a binary number, the number of significant binary digits participating in the presentation of its decimal equivalent decreases. <br><br>  As a result of converting a decimal number to a binary, with a given number of significant digits, a binary number is obtained, the decimal equivalent of which will be an approximate number containing both valid and incorrect digits. <br><br>  Determine how many valid digits n is guaranteed to have a decimal number represented by a binary m bit code in the format of a floating point number. <br><br>  If m binary bits are allocated in the machine word for writing the number mantissa, then the maximum integer that can be written into such a mantissa will be equal to F <sub>max</sub> = (2 ^ m) -1.  All m digits in this number have the value 1. For m = 8, for example, F <sub>max</sub> = 2 ^ 8 - 1 = 255 = 11111111 <sub>2</sub> .  Let now we have an integer decimal number with n significant digits.  The maximum decimal number with n significant digits will consist of digits, each of which is 9. Thus, the maximum decimal number with n significant digits can be written as F <sub>max</sub> = (10 ^ n) -1.  For example, for n = 2, F <sub>max</sub> = 10 ^ 2 -1 = 99. <br><br>  In order for a decimal number with n significant digits to be guaranteed to be represented by a binary code with a mantissa with m digits, the following condition must be met: (10 ^ n) -1 ‚â§ (2 ^ m) -1 or 10 ^ n ‚â§ 2 ^ m.  From where log <sub>10</sub> ‚Å° <sub>10</sub> ^ n‚â§ log <sub>10</sub> ‚Å°2 ^ m or n‚â§ m log <sub>10</sub> 2. Since log <sub>10</sub> 2‚âà0.3, the inequality n‚â§0.3m will be true.  Since the numbers m and n are integers, the inequality <br>  n‚â§‚åä0.3m‚åã.  So, for m = 8, we will have n‚â§‚åä0.3 * 8‚åã = 2. <br><br>  So far we have talked about the integer machine mantissa.  In practice, it is considered to be considered a machine mantissa as a fractional number with a virtual point facing the high-order bit.  This virtual point converts the integer recorded in the machine mantissa into a fractional number.  Converting an integer binary number with m significant digits to a number that represents the correct fraction is equivalent to multiplying this number by a factor of 2 ^ -m.  Thus, if in each digit of m-bit machine mantissa only units are recorded and it is assumed that the virtual point is at the beginning of the mantissa, then the number represented in this mantissa will be maximum and equal to M <sub>maxd</sub> = 1-2 ^ -m.  Where M <sub>maxd</sub> is the maximum fractional number that can be represented in the m-bit machine mantissa with a virtual point at the beginning of the mantissa. <br><br>  On the other hand, if the machine mantissa is considered integer, i.e.  to assume that the virtual point is immediately after the low order of the machine mantissa, then the maximum integer M <sub>maxc</sub> that can be written into it will consist of one unit and equal to M <sub>maxc</sub> = (2 ^ m) -1.  If now the point is moved to the beginning of the mantissa, then it will be equivalent to the fact that M <sub>maxd</sub> = M <sub>maxc</sub> * 2 ^ -m. <br><br>  Thus, fractional numbers lying in the range from 0 to M <sub>maxc</sub> * 2 ^ -m can be written to the m bit machine mantissa.  Where M <sub>maxc</sub> is the maximum integer binary number that is placed in the machine mantissa. <br><br>  In the general case, only the value of the order of the characteristic of a number represented in an exponential form depends on the choice of a virtual point.  The value of the number itself remains unchanged. <br><br>  For example, the maximum integer 111 <sub>2</sub> = 7 can be written into a three-digit machine mantissa. This number with a virtual dot before the highest discharge of the machine mantissa will have the value 0.111 = 7 * 2 ^ -3 = 0.875.  The number 101 <sub>2</sub> = 5 recorded in the machine mantissa with a virtual point before the high-order digit will have the value 0.101 <sub>2</sub> = 5 * 2 ^ -3 = 0.625, etc. <br><br>  Different sources currently have different opinions on the accuracy of the representation of decimal numbers in binary code.  Without addressing here the question of the accuracy of binary arithmetic operations on decimal numbers represented in binary form, consider the accuracy of converting decimal numbers into binary ones. <br><br>  In the English-language Wikipedia [5], regarding the doabl format, it is said that in the 53-bit machine mantissa, 15-17-bit decimal numbers can be represented.  However, we have derived the formula above, according to which a 53-bit mantissa can be guaranteed to represent a decimal number having significant digits n‚â§‚åä0.3 * 53‚åã = 15. Indeed, the maximum integer binary number that can be written to a 53-bit mantissa will be out of 53 units.  Its decimal value will be equal to (2 ^ 53) -1 = 9007199254740991. This number has 16 significant decimal digits.  If one is added to it, the number of significant digits of the decimal number does not change, it will be 16, but the binary representation of this increased by one decimal number will already contain 1 significant digit more.  Therefore, not all 16-bit decimal numbers can be represented by a 53-bit machine mantissa.  At the same time, in such a binary mantissa you can guarantee all decimal numbers with the number of significant digits not more than 15. For a guaranteed representation of a decimal number with 17 significant digits, you need a machine mantissa with the number of digits of at least 57, since  ‚åä0.3 * 57‚åã = 17. <br><br>  In order for the integer mantissa considered in the examples above to be shifted to the area of ‚Äã‚Äãfractional numbers, it is necessary to multiply all the numbers by the scale factor 2 ^ -53.  Then the maximum binary fractional number in the 53-bit machine mantissa will be: <br>  88, 1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111 * 2 ^ -53 = 9007199254740991 * 2 ^ -53 = 0) <br><br>  In order for the decimal number to be converted to binary as precisely as possible, it is necessary that the binary representation of the decimal number takes into account as many significant digits as possible.  Ideally, the number of significant digits in the binary mantissa of the number should be equal to the number of machine mantissa digits.  For this purpose, the decimal number is decomposed in powers of two until the number of significant digits of the binary number equals the number of digits of the machine mantissa or is not decomposed exactly.  The number obtained in this way is normalized, shifting the most significant digit of the number to the most significant digit of the machine mantissa.  And the scale factor equal to the number of shifts of the most significant digit of a number is placed in the machine area of ‚Äã‚Äãthe order of the characteristic.  The normalization procedure does not change the value of the number, and hence the accuracy of its representation. <br><br>  For example, take a computer with an 8-bit mantissa.  The guaranteed number of significant decimal digits that can be represented in the 8-bit machine mantissa is n ‚â§ ‚åä0.3 * 8‚åã = 2.  Suppose we are given the number 0.0012.  This binary number will be ‚âà 0.00000000010011101010010.  Let us round this number up to 8 significant figures, the number of which corresponds to the size of the discharge grid of the machine mantissa.  We get the number 0.00000000010011101 = 0.00119781494140625‚âà0.0012.  We normalize this number by placing in the machine mantissa all the significant digits of the mantissa number.  We get 0.00000000010011101010010 = 0.10011101 * 2 ^ -9 = 0.61328125 * 2 ^ -9 = 0.00119781494140625.  As we can see, the value of the number did not change after normalization.  The accuracy of the number representation also has not changed, since  the number of significant digits after normalization remained unchanged.  We just got another form of recording the same number. <br>  If during the normalization of a binary number it turns out that the number of shifts of the highest significant digit of the number exceeds the number of digits of the machine area, which is intended to record the order of the characteristics of the number, then the number can not be written in normalized form.  In this case, there is a loss of accuracy due to the fact that part or all of the significant digits of the number are outside of the discharge grid of the machine mantissa. <br><br>  In the case when as a result of an arithmetic operation a binary number is obtained, all significant digits of which are located within the machine mantissa, the normalization of the result, from the point of view of arithmetic, does not make sense. <br><br>  For example, suppose we have a computer with an 8-bit machine mantissa in which the virtual point is located before the high order of the mantissa.  Find the difference of two binary numbers: 0.10110000-0.10010011 = 0.00011101.  The significant digits of the difference fit completely into the machine grid of the machine mantissa.  The decimal equivalent of this difference will be 0.6875-0.57421875 = 0.11328125.  Normalize the number 0.00011101.  We will have 0.00011101 = 0.11101 * 2 ^ -3 = 0.90625 * 2 ^ -3 = 0.11328125.  We see that the normalization did not change the value of the difference of numbers in any way and therefore, in further calculations, these two records of the result are equivalent from the point of view of mathematics. <br><br><h4>  DRY RESIDUE </h4><br>  Any number can be represented in exponential form with a virtual point located anywhere in the mantissa.  The offset of the point from its natural position is recorded in the area of ‚Äã‚Äãthe machine word allocated to record the orders of characteristics. <br><br>  The width of the machine mantissa determines the number of decimal numbers that can be represented in this mantissa.  And the position of the virtual point in the mantissa determines the area on the number axis where these numbers are located. <br><br>  The position of the virtual point does not affect the accuracy of the representation of the number. <br><br>  The accuracy of the representation of a binary number depends on the number of significant digits of the mantissa, which can be written into a machine word. <br><br>  All binary numbers are equivalent to representable decimal numbers.  Decimal numbers are not all representable in a machine word.  Decimal real numbers, in general, can be represented in binary form approximately, while all binary numbers can be represented in decimal form exactly. <br><br>  The rounding of binary numbers leads to a decrease in the number of valid digits taken into account in the rounded binary number, by discarding the numbers that are not contained in the machine grid of the discharge grid and, as a result, reduce the accuracy of the representation of the decimal equivalent. <br><br>  The rounding of binary real numbers leads to the change of incorrect digits in their decimal equivalent, but not to the elimination of incorrect decimal digits. <br><br>  Incorrect decimal digits in the decimal equivalent of a binary number derived from an exact decimal number form the absolute error of the conversion. <br><br>  In the machine mantissa with m digits, you can guarantee a decimal number, the number of valid digits in which n‚â§‚åä0.3m‚åã. <br><br>  Normalization of binary numbers does not change the value of the number, if it is carried out without rounding. <br><br>  Normalization does not affect the accuracy of a number, if it is carried out without rounding. <br><br><h4>  SOURCES </h4><br>  1. <a href="https://habrahabr.ru/post/112953/">"What you need to know about floating point arithmetic"</a> <br>  2. Everything, point, sailed!  <a href="https://habrahabr.ru/company/xakep/blog/257897/">We learn to work with floating-point numbers and develop an alternative with fixed precision decimals</a> . <br>  3. <a href="https://habrahabr.ru/post/266023/">"Compensation errors in operations with floating point numbers"</a> <br>  4. <a href="https://habrahabr.ru/post/305276/">"Floating point calculations: can you trust the results?"</a> <br>  5. <a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format">Wikipedia</a> <br>  6. <a href="http://www.softelectro.ru/ieee754.html">www.softelectro.ru/ieee754.html</a> <br>  7. <a href="https://habrahabr.ru/post/262377/">‚ÄúDo I need normalization in floating point numbers‚Äù</a> </div><p>Source: <a href="https://habr.com/ru/post/322984/">https://habr.com/ru/post/322984/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322972/index.html">Implementing Frameworx in the Telecom API</a></li>
<li><a href="../322976/index.html">The book "Linux in practice"</a></li>
<li><a href="../322978/index.html">The birth of a new algorithm called Broo and comparison with Brotli and the rest</a></li>
<li><a href="../322980/index.html">Why learning is a new procrastination</a></li>
<li><a href="../322982/index.html">11 steps to a good online store. Delivery</a></li>
<li><a href="../322988/index.html">Browser frontend optimization</a></li>
<li><a href="../322990/index.html">Writing mnemonic editor for SCADA-system on Fabric.js</a></li>
<li><a href="../322992/index.html">Diverse and motivating "English online"</a></li>
<li><a href="../322994/index.html">Stories of small business in Krasnodar: insane team of freelancers and a lot of courage</a></li>
<li><a href="../322996/index.html">Internet counterintelligence in action: create a personal information security management system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>