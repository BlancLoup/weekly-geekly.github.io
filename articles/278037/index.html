<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Handlersocket protocol in detail</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello everyone. I decided to publish the Russian version of my own article ‚ÄúHandlerSocket protocol explained‚Äù published at http://wk-photo.ru/en/event...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Handlersocket protocol in detail</h1><div class="post__text post__text-html js-mediator-article">  Hello everyone.  I decided to publish the Russian version of my own article ‚ÄúHandlerSocket protocol explained‚Äù published at <a href="http://wk-photo.ru/en/events/view/handlersocket-protocol-explained/">http://wk-photo.ru/en/events/view/handlersocket-protocol-explained/</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f0/a81/697/8f0a8169702a578bad6717d6214c0202.jpg" alt="image"><br><br>  So you walked and walked and came to the <a href="https://github.com/DeNA/HandlerSocket-Plugin-for-MySQL/">HandlerSocket</a> .  Pure honey.  This is a devilishly fast voodoo.  And the protocol used is really simple, like two kopecks.  Well, if we are honest, who cares about the details of the protocol, if any library will be used to take care of everything?  If, in spite of everything, you still want to know what kind of neon is there inside, you can google <a href="https://github.com/DeNA/HandlerSocket-Plugin-for-MySQL/blob/master/docs-en/protocol.en.txt">this page</a> .  A few hours - and you are an expert.  Well, or you want everything in 15 minutes.  Then welcome pzhalovat under the cat! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  It is assumed that you are already at least remotely familiar with Handlersocket, have a MySQL / MariaDB / Percona server with a plug-in enabled.  I used MariaDB, there Handlersocket is available by default, you just need to enable the plugin, seasoning my.cnf with a <a href="https://mariadb.com/kb/en/mariadb/handlersocket/">small number of lines to your taste</a> . <br><br>  For advertising: <a href="https://github.com/crocodile2u/zhandlersocket">https://github.com/crocodile2u/zhandlersocket</a> - my PHP extension for working with Handlersocket. <br><br>  Go.  Log in to the MariaDB console and create a table: <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> movie ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> auto_increment primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>, genre <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, title <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>, view_count <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>(genre) ) <span class="hljs-keyword"><span class="hljs-keyword">engine</span></span> <span class="hljs-keyword"><span class="hljs-keyword">innodb</span></span>;</code> </pre> <br><br>  Now connect to Handlersocket.  Port 9999, I mean the default port for writing: with this connection, I can both read and write.  Since usually you still need to read more often than to write, it will be more efficient to think in advance what actions will be needed in the application, and open a connection to the port for reading or reading / writing, respectively.  For reference: by default, Handlersocket starts 16 workers for handling read-only connections and one worker for reading / writing connections. <br><br><pre> <code class="bash hljs">~/ telnet localhost 9999 Trying 127.0.0.1... Connected to localhost. Escape character is <span class="hljs-string"><span class="hljs-string">'^]'</span></span>.</code> </pre> <br><br>  The class.  Now try to talk to this thing.  The first thing to do when using Handlersocket is to open the index.  For any queries that you send to HS to find or change data, you need an index identifier.  Let us see what the documentation says: <br><br>  The " <b>open_index</b> " <b>query</b> has the following syntax: <br><br><blockquote><pre> <code class="bash hljs">P /indexid/ /dbname/ /tablename/ /indexname/ /columns/ [/fcolumns/]</code> </pre> <br><br><ul><li>  / indexid / is a number in decimal. </li><li>  / dbname /, / tablename /, and / indexname / are strings.  To open the primary key, use PRIMARY as / indexname /. </li><li>  / columns / is a comma-list of column names. </li><li>  / fcolumns / is a list of column names.  This parameter is optional. </li></ul></blockquote><br><br>  Well, everything is clear ... Oh, and <s>whose this pants with a motor</s> what kind of / indexid /?  This is the index ID your application should provide.  It is not generated by Handlersocket.  In fact, an application can send a request consisting of a number of lines to HS at once: <br><br><pre> <code class="bash hljs">Open index 1 Find row(s) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> index 1 Find/Modify row(s) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> index 1 ...</code> </pre> <br><br>  This is possible only if the application ID is assigned by the application, otherwise you would have to first send to HS a request to open the index, get an identifier from the HS, and only then use this identifier in your queries. <br><br>  Let's continue our exercises in the HS console (telnet).  I forgot to say, parts of the request in HS are separated by TABs.  In our example, I use the optional / fcolumns / parameter for the first index.  We still need it. <br><br><pre> <code class="bash hljs">~/ telnet localhost 9999 ... P 1 <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> movie id,genre,title,view_count genre 2 1 idxnum</code> </pre> <br><br>  What is this?  Doca claims that in return we should get ‚Äú0 1‚Äù!  A. Well, yes, it's my own fault, I forgot the / indexname / parameter. <br><br><pre> <code class="bash hljs">P 1 <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> movie PRIMARY id,genre,title,view_count genre 0 1</code> </pre> <br><br>  Now order.  We are going to knock on the table on the primary key, so that / indexname / we will have PRIMARY.  Let's open another HS-index, for a MySQL-index named genre: <br><br><pre> <code class="bash hljs">P 2 <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> movie genre id,genre,title,view_count 0 1</code> </pre> <br><br>  Oh, you feed you.  And this one has opened.  Let's now add to the table row?  What is there in our documentation? <br><br><blockquote>  'Insert' request has the following syntax. <br><br><pre> <code class="bash hljs">/indexid/ + /vlen/ /v1/ ... /vn/</code> </pre> <br><br><ul><li>  / vlen / indicates the length of the trailing parameters / v1 / ... / vn /.  This is the number of columns / columns / specified by the corresponding open_index request. </li><li>  / v1 / ... / vn / specify the column values ‚Äã‚Äãto set.  For each column are not set. </li></ul></blockquote><br>  ... and we should get an answer like this: <br><br><blockquote>  If 'insert' is succeeded, HanderSocket returns a line of the following syntax. <br><br>  0 1 </blockquote><br><br>  Let's try ... <br><br><pre> <code class="bash hljs">1 + 3 0 Sci-Fi Star wars 0 1 1</code> </pre> <br><br>  Oops.  The answer is not quite as in the dock.  Additional one.  Let's see what happens with the table in the MariaDB console: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> movie; +<span class="hljs-comment"><span class="hljs-comment">----+--------+-----------+ | id | genre | title | +----+--------+-----------+ | 1 | Sci-Fi | Star wars | +----+--------+-----------+</span></span></code> </pre> <br><br>  It worked!  Come on, come on ... <br><br><pre> <code class="bash hljs">1 + 3 0 Comedy Dumb &amp; Dumber 0 1 2 1 + 3 0 Thriller The Silence of the Lambs 0 1 3</code> </pre> <br><br>  Look again at MariaDB: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> movie; +<span class="hljs-comment"><span class="hljs-comment">----+----------+--------------------------+ | id | genre | title | +----+----------+--------------------------+ | 1 | Sci-Fi | Star wars | | 2 | Comedy | Dumb &amp; Dumber | | 3 | Thriller | The Silence of the Lambs | +----+----------+--------------------------+</span></span></code> </pre> <br><br>  Oops!  The unknown third digit returned by HS exactly matches the AUTO_INCREMENT field id! <br>  And now we will try to specify the value for id manually ... <br><br><pre> <code class="bash hljs">1 + 3 1 Sci-Fi Star Trek 1 1 121</code> </pre> <br><br>  OK.  ‚Äú1‚Äù in the first position of the answer tells us that an error has occurred.  HS, however, is not too verbose.  From the additional information, we only have the magic number "121", which means ... God knows, actually, but I think that in such a simple way we are hinted at an error like "DUPLICATE KEY".  One more time‚Ä¶ <br><br><pre> <code class="bash hljs">1 + 3 4 Sci-Fi Star Trek 0 1 0</code> </pre> <br><br>  We look at MariaDB, our new entry was added with ID = 4: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> movie; +<span class="hljs-comment"><span class="hljs-comment">----+----------+--------------------------+ | id | genre | title | +----+----------+--------------------------+ | ... | | 4 | Sci-Fi | Star Trek | +----+----------+--------------------------+</span></span></code> </pre> <br><br>  Something like this we insert the records into the tables via HS and get the values ‚Äã‚Äãof the AUTO_INCREMENT field.  Documentation of this is silent.  Perhaps because, in the old days, HS did not support AUTO_INCREMENT. <br><br>  <b>Be careful of dynamic columns with default values</b> .  Such as "created_at DATETIME DEFAULT CURRENT_TIMESTAMP" or "updated_at DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP".  When inserts and updates, <b>you must set their values ‚Äã‚Äãmanually</b> !  Otherwise, instead of the current timestamp, when inserted into the <i>created_at</i> field, you will get "0000-00-00 00:00:00".  And if you do not specify a value for <i>updated_at</i> when updating, the previous value will be there. <br><br>  With INSERTs finished, uh ... Now let's try to choose something from HS.  We look in man ... <br><br><blockquote>  The 'find' request has the following syntax. <br><br>  / indexid / / op / / vlen / / v1 / ... / vn / [LIM] [IN] [FILTER ...] <br><br>  LIM is a sequence of the following parameters. <br><br>  / limit / / offset / <br><br>  IN is a sequence of the following parameters. <br><br><pre> <code class="bash hljs">@ /icol/ /ivlen/ /iv1/ ... /ivn/</code> </pre> <br><br>  FILETER is a sequence of the following parameters. <br><br><pre> <code class="bash hljs">/ftyp/ /fop/ /fcol/ /fval/</code> </pre> <br><br><ul><li>  / indexid / is a number.  This is the number that should be indicated. </li><li>  / op / specifies the comparison operation to use.  The current version of HandlerSocket supports '=', '/', '/ =', '/', and '/ ='. </li><li>  / vlen / indicates the length of the trailing parameters / v1 / ... / vn /.  This is the number of the corresponding 'open_index' request. </li><li>  / v1 / ... / vn / specify the column column values ‚Äã‚Äãto fetch. </li><li>  LIM is optional.  / limit / and / offset / are numbers.  When omitted, it works as if 1 and 0 are specified.  These parameter works like LIMIT of SQL.  Skipped by a filter. </li><li>  IN is optional.  It works like WHERE ... IN syntax of SQL.  / icol / must be the corresponding index of the corresponding open_index request.  If this is the request, the / icol / -th parameter value of / v1 / ... / vn / is ignored. </li><li>  FILTERs are optional.  A FILTER specifies a filter.  / ftyp / is either 'F' (filter) or 'W' (while).  / fop / specifies the comparison operation to use.  / fcol / must be smaller than the number of the corresponding 'open_index' request.  AND.  It is simply the skins of the record, and the 'F' </li></ul></blockquote><br><br>  Well, everything is clear, in full view.  Let's go further. <br>  Okay, okay, just kidding.  Let's try to find a record by ID.  First comes / indexid / - in our case it is 1 (the index that we opened for the primary key).  Then / op /: we want to get a record with id = 1, so this will be "=".  Then, / vlen /.  This is the number of columns in the index.  The index may consist of several columns.  In our case, however, it is 1. Then comes part / v1 / ... / vn /.  These are the values ‚Äã‚Äãof the columns, in our example one column and the value 1: <br><br><pre> <code class="bash hljs">1 = 1 1 0 3 1 Sci-Fi Star wars</code> </pre> <br><br>  Hooray, it worked!  The result can be interpreted as: <br><br><pre> <code class="bash hljs">0 - no errors; 3 - number of columns [1 Sci-Fi Star wars] - the row that we<span class="hljs-string"><span class="hljs-string">'ve got from InnoDB.</span></span></code> </pre> <br><br>  What if we try another operation (/ op /)?  For example, get entries with id&gt; 1: <br><br><pre> <code class="bash hljs">1 &gt; 1 1 0 3 2 Comedy Dumb &amp; Dumber</code> </pre> <br><br>  How so?  Only one entry?  We had more, I give a tooth!  Ook, this is in the documentation: ‚ÄúLIM is is optional.  / limit / and / offset / are numbers.  When omitted, it works as if 1 and 0 are specified. ‚Äù  Let's try to specify enough LIMIT to get all the rows that interest us. <br><br><pre> <code class="bash hljs">1 &gt; 1 1 10 0 0 3 2 Comedy Dumb &amp; Dumber 3 Thriller The Silence of the Lambs 6 Sci-Fi Star Trek</code> </pre> <br><br>  All results are returned in one line: <br><br><pre> <code class="bash hljs">0 - no errors; 3 - number of columns [2 Comedy Dumb &amp; Dumber] - row 1 [3 Thriller The Silence of the Lambs] - row 2 [6 Sci-Fi Star Trek] - row 3</code> </pre> <br><br>  All this will need to be disassembled in the client application (we know the number of columns, we know the order in which we listed them when opening the index, so there are no problems).  Maybe you are asking yourself the question: what will happen if there is a tab in our data?  Still sprinkle!  The protocol describes the transmission of characters from 0x00 to 0x0f.  Client libraries must encode these characters using a simple algorithm (the prefix 0x01 is added to them and shifted to 0x40).  The client library should take care of this.  For simplicity, we will not use symbols that require encoding in our examples. <br><br>  In addition, we still have an <b>IN</b> query - that is, you can immediately get heaps of records by their keys, in one query!  I conducted several experiments.  To begin with, I did not know what to do with / op /, / vlen / and / v1 / ... / vn /.  After all, we are going to specify all the id that we want to receive in the <b>IN</b> part.  Well, let's try the same way as we tried with a simple id search. <br><br>  The IN condition is "@ 0 1 2", that is, column number 0, one value, and this value is 2. <br><br><pre> <code class="bash hljs">1 = 1 1 @ 0 1 2 2 1 modop</code> </pre> <br><br>  "Modop".  Thanks, HandlerSocket!  Now everything is clear!  Let's try to change a little ... <br><br><pre> <code class="bash hljs">1 = 1 0 @ 0 1 2 2 1 modop</code> </pre> <br><br>  Again.  What do you want?  And what if I specify LIMIT? <br><br><pre> <code class="bash hljs">1 = 1 0 1 0 @ 0 1 2 0 3 2 Comedy Dumb &amp; Dumber</code> </pre> <br><br>  That's it!  It seems that for IN queries you need to specify LIMIT and OFFSET.  / op /, / vlen / and / v1 / ... / vn / also need to be specified, although this only confuses.  In the example below, I specify the value 1 instead of 0 in the / vn / - section and get exactly the same answer! <br><br><pre> <code class="bash hljs">1 = 1 1 1 0 @ 0 1 2 0 3 2 Comedy Dumb &amp; Dumber</code> </pre> <br><br>  I will try to change / op /: <br><br><pre> <code class="bash hljs">1 &gt; 1 1 1 0 @ 0 1 2 0 3 3 Thriller The Silence of the Lambs</code> </pre> <br><br>  Where is it from?  Well, let's try to get more than one id: <br><br><pre> <code class="bash hljs">1 &gt; 1 1 1 0 @ 0 2 2 3 0 3 3 Thriller The Silence of the Lambs</code> </pre> <br><br>  Damn, I forgot about LIMIT.  We indicate that we need 2 two entries: <br><br><pre> <code class="bash hljs">1 &gt; 1 1 2 0 @ 0 2 2 3 0 3 3 Thriller The Silence of the Lambs 6 Sci-Fi Star Trek</code> </pre> <br><br>  Obviously, our id were ignored, and HS returns records with id&gt; 1. In the end, I found out that in the IN query, we can safely specify ‚Äú=‚Äù as / op /, and 0 as the value / v1 /.  You can see that we got the results exactly in the order we indicated them in the IN condition.  However, I do not know if it is a coincidence or not.  I would not rely on it. <br><br>  Let's go to the filters?  What if we take our last query and ask HS to apply the filter by genre = 'Sci-Fi'?  Remember when we opened the index, we specified / fcolumns /?  Now they will come in handy to apply additional filters.  If we did not specify / fcolumns /, any query with filters would return ‚Äú2 1 filterfld‚Äù. <br><br><pre> <code class="bash hljs">1 = 1 0 3 0 @ 0 3 2 3 1 F = 0 Sci-Fi 0 3 1 Sci-Fi Star wars</code> </pre> <br><br>  It worked!  OK, this is probably all about getting records from HS.  Now we go to UPDATE'am.  What about the documentation? <br><br><blockquote>  The 'find_modify' request has the following syntax. <br><br><pre> <code class="bash hljs">/indexid/ /op/ /vlen/ /v1/ ... /vn/ [LIM] [IN] [FILTER ...] MOD</code> </pre> <br><br>  MOD is a sequence of the following parameters. <br><br><pre> <code class="bash hljs">/mop/ /m1/ ... /mk/</code> </pre> <br><br><ul><li>  / mop / is' U '(update),' + '(increment),' - '(decrement),' D '(delete),' U? ',' +? ',' -? ', or' D ? '.  If the '?'  If you want to find a record before the number of modified records. </li><li>  / m1 / ... / mk / specifies the column values ‚Äã‚Äãto set.  The length of / columns / specified by the corresponding 'open_index' request.  If / mop / is 'D', these parameters are ignored.  If / mop / is '+' or '-', values ‚Äã‚Äãmust be numeric.  If you want to make a difference, it‚Äôs not. </li></ul></blockquote><br><br>  The first part looks familiar.  We only saw all this when we looked at FIND queries, and it looks like these are WHERE conditions for our UDPATE.  Update the row with id = 1 and set view_count = 100: <br><br><pre> <code class="bash hljs">1 = 1 1 U 1 Sci-Fi Star Wars 100 2 1 modop</code> </pre> <br><br>  modop.  So glad.  How clear!  What if you specify LIMIT? <br><br><pre> <code class="bash hljs">1 = 1 1 1 0 U 1 Sci-Fi Star Wars 100 0 1 1</code> </pre> <br><br>  Taak.  Let's take a look at MariaDB: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> movie <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>; +<span class="hljs-comment"><span class="hljs-comment">----+--------+-----------+------------+ | id | genre | title | view_count | +----+--------+-----------+------------+ | 1 | Sci-Fi | Star Wars | 100 | +----+--------+-----------+------------+</span></span></code> </pre> <br><br>  Let's try something more complicated.  Increase the view_count counter for all comedies by 10. <br><br><pre> <code class="bash hljs">1 / 1 0 1000 0 F = 0 Comedy + 0 0 0 10 0 1 1</code> </pre> <br><br>  It looks like the rules!  Let's take a look at MariaDB: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> movie; +<span class="hljs-comment"><span class="hljs-comment">----+----------+--------------------------+------------+ | id | genre | title | view_count | +----+----------+--------------------------+------------+ | 1 | Sci-Fi | Star Wars | 100 | | 2 | 0 | 0 | 10 | | 3 | Thriller | The Silence of the Lambs | 0 | | 6 | Sci-Fi | Star Trek | 0 | +----+----------+--------------------------+------------+</span></span></code> </pre> <br><br>  No, it did not work.  At least it did not work well.  The counter has indeed increased by 10, but all other columns have also increased.  Since id is numeric and we said to increment it by 0, it remained untouched.  I will return everything back: <br><br><pre> <code class="bash hljs">1 = 1 2 1 0 U 2 Comedy Dumb &amp; Dumber 10</code> </pre> <br><br>  I can say right away that specifying a value for the ‚Äúgenre‚Äù and ‚Äútitle‚Äù columns in an increment request does not work.  They will get the value "0", just as happened at our first attempt.  In order for the increment to work as it should, you need to open a separate index, which will contain only the columns "id" and "view_count": <br><br><pre> <code class="bash hljs">P 3 <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> movie PRIMARY id,view_count genre 0 1 3 / 1 0 1000 0 F = 0 Comedy + 0 10 0 1 1</code> </pre> <br><br>  Well, another thing: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> movie; +<span class="hljs-comment"><span class="hljs-comment">----+----------+--------------------------+------------+ | id | genre | title | view_count | +----+----------+--------------------------+------------+ | 1 | Sci-Fi | Star Wars | 100 | | 2 | Comedy | Dumb &amp; Dumber | 30 | | 3 | Thriller | The Silence of the Lambs | 0 | | 6 | Sci-Fi | Star Trek | 0 | +----+----------+--------------------------+------------+</span></span></code> </pre> <br><br>  That's all.  Happy handlers! </div><p>Source: <a href="https://habr.com/ru/post/278037/">https://habr.com/ru/post/278037/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278021/index.html">DevTips: Web Developer Tips (49-64)</a></li>
<li><a href="../278023/index.html">Experiment: the creation of an algorithm for predicting the behavior of stock indices</a></li>
<li><a href="../278025/index.html">Security Week 08: Mice theft through a whistle, Blockbuster operation, Linux Mint with backdoor</a></li>
<li><a href="../278031/index.html">Problems of access control based on the access list in ECM systems (part 2)</a></li>
<li><a href="../278033/index.html">TOM.js is a special library for special cases.</a></li>
<li><a href="../278039/index.html">Again about STL</a></li>
<li><a href="../278041/index.html">Personalize IMGUI and Unity Editor. Part one</a></li>
<li><a href="../278043/index.html">The story of the endless city. On Three.js</a></li>
<li><a href="../278045/index.html">Configuring fault tolerance in 3CX Version 14</a></li>
<li><a href="../278047/index.html">jsPDF + canvas: export to PDF of a multipage table in Russian</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>