<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>FluentOpenXml - Foxby</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foxby is a library for working with Word documents in OpenXml format. Designed for generating documents from a template and making changes to existing...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>FluentOpenXml - Foxby</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://code.google.com/p/fluent-openxml">Foxby</a> is a library for working with Word documents in OpenXml format.  Designed for generating documents <strong>from a template</strong> and <strong>making changes</strong> to existing documents.  With it, you can stop working with COM + or editing an OpenXML tree through the <a href="http://www.microsoft.com/download/en/details.aspx%3Fdisplaylang%3Den%26amp%3Bid%3D5124">OpenXML SDK</a> and go to the mechanism for constructing a document structure from meta elements in a declarative form. <br><br>  In the class of tasks: creating paragraphs, creating and filling in tables, lists, working with images, formatting, etc.  In fact, the library is a wrapper over the OpenXML SDK with the API in the form of a <a href="http://martinfowler.com/bliki/FluentInterface.html">Fluent interface</a> . <br><a name="habracut"></a><br><h2>  Benefits of using </h2><br><br>  We ourselves use this library already in two projects.  The first version was written by <a href="https://habrahabr.ru/users/eskat0n/" class="user_link">Eskat0n</a> and was born as part of the project subsystem for working with Word documents, but later was put into an independent project. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The following advantages can be highlighted: <br><ol><li>  On the server where your application is running, no installation of Microsoft Office is required. </li><li>  No problem with <a href="http://blog.byndyu.ru/2009/05/excelexe-interopexcel.html">frozen Word processes.</a> </li><li>  Works much faster than COM + </li><li>  Creating and modifying documents does not require writing to the hard disk, everything happens in RAM </li><li>  Convenient Fluent API for working with Word objects </li><li>  Ability to build your own language markup document </li></ol><br><br><h2>  Installation </h2><br><br>  The latest version can be installed via <a href="http://nuget.org/List/Packages/Foxby">NuGet</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/897/e52/917/897e5291735d00352b4f68fc2ca2c33a.png"><br><br><h2>  Source Code and License </h2><br><br>  The source code is written in .NET 4.0 / C # and uploaded to <a href="http://code.google.com/p/fluent-openxml">Google Code: fluent-openxml</a> by <a href="http://www.indycode.ru/">IndyCode</a> under the <a href="http://www.gnu.org/copyleft/lesser.html">LGPL</a> license. <br><br><h2>  Examples of using </h2><br><br>  Below are examples with which you can start working with the library. <br><br><h3>  Example # 1 - Hello Word! </h3><br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Main() <br> { <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> docxDocument = <font color="#0000ff">new</font> DocxDocument(SimpleTemplate.EmptyWordFile)) <br> { <br> <font color="#0000ff">var</font> builder = <font color="#0000ff">new</font> DocxDocumentBuilder(docxDocument); <br> <br> builder <br> .Tag(SimpleTemplate.ContentTagName, <br> x =&gt; x.Center.Paragraph(z =&gt; z.Bold.Text( <font color="#A31515">"Hello Word!"</font> ))); <br> <br> <font color="#2B91AF">File</font> .WriteAllBytes( <font color="#0000ff">string</font> .Format( <font color="#A31515">@"D:\Word.docx"</font> ), docxDocument.ToArray()); <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/94f/319/79d/94f31979dd1f3b3aeac4fd1c134d4bba.png"><br><br>  SimpleTemplate.EmptyWordFile is a template that is embedded in the library itself.  There is nothing in the template except tags for the header, content, and footer.  This template is perfect for test purposes and the generation of simple documents. <br><br>  Instead of File.WriteAllBytes, which writes the file to disk, an array of bytes can be transferred as FileResult, so that the user immediately receives the generated document. <br><br>  The attachment hierarchy should help to understand the ideology of working with the library: <br><img src="http://2.bp.blogspot.com/-S1owo3f9D9o/Tj_Q2t5GlxI/AAAAAAAAAbk/Tv6iygwBcu4/s500/hierarchy.png&amp;quot;"><br><br><h3>  Example 2 Create a contract </h3><br><br>  It is often required to create a contract or invoice.  This example shows a typical script for creating a document.  For simplicity, variables are not taken from the database, but are determined by variables. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Main() <br> { <br> <font color="#0000ff">string</font> customerName = <font color="#A31515">" .."</font> ; <br> <font color="#0000ff">string</font> orderNumber = <font color="#A31515">"4"</font> ; <br> <font color="#0000ff">string</font> itemName1 = <font color="#A31515">""</font> ; <br> <font color="#0000ff">string</font> itemSumm1 = <font color="#A31515">"5 000"</font> ; <br> <font color="#0000ff">string</font> itemName2 = <font color="#A31515">" "</font> ; <br> <font color="#0000ff">string</font> itemSumm2 = <font color="#A31515">"6 342"</font> ; <br> <font color="#0000ff">string</font> summ = <font color="#A31515">"11 342"</font> ; <br> <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> docxDocument = <font color="#0000ff">new</font> DocxDocument(SimpleTemplate.EmptyWordFile)) <br> { <br> <font color="#0000ff">var</font> builder = <font color="#0000ff">new</font> DocxDocumentBuilder(docxDocument); <br> <br> builder <br> .Tag(SimpleTemplate.ContentTagName, <br> x =&gt; x <br> .Center.Paragraph(z =&gt; z.Bold.Text( <font color="#0000ff">string</font> .Format( <font color="#A31515">" ‚Ññ{0}"</font> , orderNumber))) <br> .Right.Paragraph( <font color="#0000ff">string</font> .Format( <font color="#A31515">" {0} ."</font> , <font color="#2B91AF">DateTime</font> .Now.ToString( <font color="#A31515">"dd MMMM yyyy"</font> ))) <br> .Left.Paragraph( <font color="#0000ff">string</font> .Format( <font color="#A31515">", {0}, :"</font> , customerName)) <br> .Table(t =&gt; t.Column( <font color="#A31515">""</font> , 70).Column( <font color="#A31515">", ."</font> , 30), <br> r =&gt; r.Row(itemName1, itemSumm1) <br> .Row(itemName2, itemSumm2) <br> .Row(w =&gt; w.Right.Bold.Text( <font color="#A31515">":"</font> ), w=&gt;w.Center.Bold.Underlined.Text(summ)) <br> )); <br> <br> <font color="#2B91AF">File</font> .WriteAllBytes( <font color="#0000ff">string</font> .Format( <font color="#A31515">@"D:\Word.docx"</font> ), docxDocument.ToArray()); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a75/175/2a9/a751752a9971cc8f9ea85e2ccacfa1a1.png"><br><br><h3>  Example # 3 - Modifying the created document </h3><br>  Scenario: <br><ol><li>  Create a document signed by Ivanov K.I. </li><li>  We send the document for approval </li><li>  The electronic document is returned and they say that Petrov A.I. should sign. </li><li>  Change the signer in the document </li></ol><br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Main() <br> { <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> docxDocument = <font color="#0000ff">new</font> DocxDocument(SimpleTemplate.EmptyWordFile)) <br> { <br> <font color="#0000ff">var</font> builder = <font color="#0000ff">new</font> DocxDocumentBuilder(docxDocument); <br> <br> builder <br> .Tag(SimpleTemplate.ContentTagName, <br> x =&gt; x.Left.Paragraph( <font color="#A31515">"   ..."</font> ) <br> .Right.Paragraph(z =&gt; z.Placeholder( <font color="#A31515">"SIGNER_NAME"</font> , <font color="#A31515">" .."</font> ))); <br> <br> <font color="#2B91AF">File</font> .WriteAllBytes( <font color="#0000ff">string</font> .Format( <font color="#A31515">@"D:\Word.docx"</font> ), docxDocument.ToArray()); <br> } <br> <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> docxDocument = <font color="#0000ff">new</font> DocxDocument( <font color="#2B91AF">File</font> .ReadAllBytes( <font color="#A31515">@"D:\Word.docx"</font> ))) <br> { <br> <font color="#0000ff">var</font> builder = <font color="#0000ff">new</font> DocxDocumentBuilder(docxDocument); <br> <br> builder <br> .Placeholder( <font color="#A31515">"SIGNER_NAME"</font> , x =&gt; x.Text( <font color="#A31515">" .."</font> )); <br> <br> <font color="#2B91AF">File</font> .WriteAllBytes( <font color="#0000ff">string</font> .Format( <font color="#A31515">@"D:\Word.docx"</font> ), docxDocument.ToArray()); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5d3/ab8/281/5d3ab82810bfc078e387c172c5c67326.png"><br><br><h3>  Example # 4 - Create a document from scratch </h3><br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Main() <br> { <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> docxDocument = <font color="#0000ff">new</font> DocxDocument()) <br> { <br> docxDocument.AddOpenCloseTag( <font color="#A31515">"CONTENT"</font> ); <br> <br> <font color="#0000ff">var</font> builder = <font color="#0000ff">new</font> DocxDocumentBuilder(docxDocument); <br> <br> builder <br> .Tag( <font color="#A31515">"CONTENT"</font> , x =&gt; x.Left.Paragraph( <font color="#A31515">"   ..."</font> )); <br> <br> <font color="#2B91AF">File</font> .WriteAllBytes( <font color="#0000ff">string</font> .Format( <font color="#A31515">@"D:\Word.docx"</font> ), docxDocument.ToArray()); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/543/714/400/5437144006d1c57441d173c2842bc1a9.png"><br><br><h3>  Example 5 - Unit Tests </h3><br>  Quite a lot of unit tests have been written to the library, with the help of which you can understand the work scenarios even better.  Download the source code with tests from <a href="http://code.google.com/p/fluent-openxml/source/checkout">Google Code: fluent-openxml</a> . <br><br><h3>  Buns </h3><br><br>  <a href="http://indycode.ru/People/AlexanderZaytsev">Alexander Zaitsev had</a> fun and made a rather interesting implementation for formatting text: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">builder.Tag( <font color="#A31515">"CONTENT"</font> , x =&gt; x.Paragraph( <font color="#A31515">" "</font> .Bold() + <font color="#A31515">" "</font> .Italic() + <font color="#A31515">" "</font> .Underlined() + <font color="#A31515">""</font> ));</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  This method can be used for text, as an alternative to the Bold property. <br><br><h2>  Feedback </h2><br><br>  This library can be better and work with a large number of different specific situations if you give us <a href="http://code.google.com/p/fluent-openxml/issues/list">feedback</a> . <br><br><hr><br><br>  <i>Links</i> <br><br>  Video and slides from the <a href="http://dotnetconf.ru/Materialy/Anons_opensource_bibliteki_dlya_openxml">DotNetConf</a> conference <a href="http://dotnetconf.ru/Materialy/Anons_opensource_bibliteki_dlya_openxml">: Announcement of the OpenSource library for creating and modifying documents in the OpenXml format via the Fluent interface</a> </div><p>Source: <a href="https://habr.com/ru/post/125903/">https://habr.com/ru/post/125903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../125893/index.html">Some tips for working with PLSQL</a></li>
<li><a href="../125896/index.html">August 6 in St. Petersburg was the first Geek Picnic</a></li>
<li><a href="../125898/index.html">NetworkX for convenient work with network structures</a></li>
<li><a href="../125899/index.html">Promotion on Facebook "Book for a photo", prize - ABC 516</a></li>
<li><a href="../125900/index.html">We publish Google+ Stream on your site</a></li>
<li><a href="../125904/index.html">Ruby Conference in Kiev</a></li>
<li><a href="../125905/index.html">Review of fresh materials, June 2011</a></li>
<li><a href="../125906/index.html">TOP 7 - for 7 days. Marketing iPad apps on the Apple Store</a></li>
<li><a href="../125907/index.html">Simple electronic recorder</a></li>
<li><a href="../125908/index.html">Appiny - not for "blondes"!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>