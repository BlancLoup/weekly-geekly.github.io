<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Spoofing extensions in winrar</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Topic in one sentence - there is a technical possibility to replace the displayed file name in Winrar. And some image.jpeg will successfully execute a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Spoofing extensions in winrar</h1><div class="post__text post__text-html js-mediator-article">  Topic in one sentence - there is a technical possibility to replace the displayed file name in Winrar.  And some image.jpeg will successfully execute as an .exe file :) I will not do a full translation of the original <a href="http://an7isec.blogspot.co.il/">topic</a> , but I will retell the essence under the cut. <br><a name="habracut"></a><br>  If we consider the structure of the zip file <br><img src="https://habrastorage.org/getpro/habr/post_images/bd7/f17/52a/bd7f1752a31114b58e8b82b29502aff7.png"><br><br>  You can see that the bytes after the offset to 30 bytes indicate the name of the file inside the archive. <br>  But!  If you pack via WinRar in a ZIP file, WinRaR also adds its bytes (the general structure is, of course, the same). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ecf/103/4c7/ecf1034c7e7c9dd9a6e7fd75ba48d596.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You can see that the file name (in the example above, the file TEST1.txt was packed) is contained twice.  And with the second name it will be unpacked, and with the first one it will be displayed in the Explorer Winrar. <br><br>  And the main point: we can set the second value to any other, there will be no error.  Accordingly, with a ‚Äútypical‚Äù action - double click on a file with a .txt extension, we can execute a binary file. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bb8/381/1f6/bb83811f65f72f5c459759872500ee66.png"><br><br>  Version 4.2 is vulnerable, and most likely lower.  The solution is to install another archiver / or version of winrar from the 5th branch. <br><br>  PoC: <a href="">sergeybelove.ru/downloads/ZIP_WINRAR_POC.zip</a> (a picture will open instead of the txt file). <br><br>  UPD: dMetrius <a href="http://habrahabr.ru/company/dsec/blog/216785/">reports</a> that 5.01 is not reproduced </div><p>Source: <a href="https://habr.com/ru/post/216785/">https://habr.com/ru/post/216785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../216767/index.html">Training / gaming program for calculating the payload of the rocket based on several stages and gravitational losses</a></li>
<li><a href="../216771/index.html">New York Times: NSA has had access to Huawei server hardware for several years</a></li>
<li><a href="../216773/index.html">How your tweets reveal your location</a></li>
<li><a href="../216775/index.html">Python-digest # 19. News, interesting projects, articles and interviews [March 16, 2014 - March 23, 2014]</a></li>
<li><a href="../216779/index.html">The registry of prohibited sites as a way to information isolation</a></li>
<li><a href="../216787/index.html">Details about the project LXBOX mini-computer</a></li>
<li><a href="../216789/index.html">KolibriOS Digest # 3: the beginning of spring</a></li>
<li><a href="../216791/index.html">Buy a quadcopter and say goodbye to it</a></li>
<li><a href="../216797/index.html">Github Education - Education and Github</a></li>
<li><a href="../216799/index.html">Making the world more interesting or what I try to remember when creating a new quest</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>