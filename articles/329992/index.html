<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Article translation: Best Practice for Creating Git Commit from OpenStack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I propose to the readers of "Habrakhabr" a translation of the article "Good practice in communicating commits from OpenStack" . 
 1 Git Commit Best Pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Article translation: Best Practice for Creating Git Commit from OpenStack</h1><div class="post__text post__text-html js-mediator-article"><p>  I propose to the readers of "Habrakhabr" a translation of the article <a href="https://wiki.openstack.org/wiki/GitCommitMessages">"Good practice in communicating commits from OpenStack"</a> . </p><br><h2 id="1-git-commit-luchshaya-praktika">  1 Git Commit Best Practice </h2><br><p>  The following document is based on the experience of developing code, fixing bugs and viewing code in a number of projects using Git, including libvirt, QEMU and OpenStack Nova.  Consideration of other open source projects, such as Kernel, CoreUtils, GNULIB and others, assumes that they all follow a fairly common practice.  This is motivated by the desire to improve the quality of the history of the Nova Git project.  Quality is an abstract term for definition in development;  when for one person a certain code ‚ÄúBeautiful‚Äù (Thing of Beauty) - then for another it is ‚ÄúCrutch‚Äù (Evil Hack).  Nevertheless, we can formulate some general recommendations on how and what to do, or, conversely, what not to do when sending Git commits to merge with projects in OpenStack. </p><br><p>  This topic can be divided into two areas: </p><br><ol><li>  The order of combining or splitting into multiple commits </li><li>  Information in commit messages </li></ol><a name="habracut"></a><br><h2 id="soderzhanie">  Content </h2><br><ul><li>  <a href="https://habr.com/ru/post/329992/">1 Git Commit Best Practice</a> <br><ul><li>  <a href="https://habr.com/ru/post/329992/">1.1 Overview</a> </li><li>  <a href="https://habr.com/ru/post/329992/">1.2 Structural separation of changes</a> <br><ul><li>  <a href="https://habr.com/ru/post/329992/">1.2.1 What to avoid when creating commits</a> </li><li>  <a href="https://habr.com/ru/post/329992/">1.2.2 Examples of bad practice</a> <br><ul><li>  <a href="https://habr.com/ru/post/329992/">1.2.2.1 Example 1</a> </li><li>  <a href="https://habr.com/ru/post/329992/">1.2.2.2 Example 2</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/329992/">1.2.3 Examples of good practice</a> <br><ul><li>  <a href="https://habr.com/ru/post/329992/">1.2.3.1 Example 1</a> </li><li>  <a href="https://habr.com/ru/post/329992/">1.2.3.2 Example 2</a> </li></ul></li></ul></li><li>  <a href="https://habr.com/ru/post/329992/">1.3 Information in commit messages</a> <br><ul><li>  <a href="https://habr.com/ru/post/329992/">1.3.1 Inclusion of external links</a> </li><li>  <a href="https://habr.com/ru/post/329992/">1.3.2 Overview of the commit message structure</a> </li><li>  <a href="https://habr.com/ru/post/329992/">1.3.3 Some examples of bad practice</a> <br><ul><li>  <a href="https://habr.com/ru/post/329992/">1.3.3.1 Example 1</a> </li><li>  <a href="https://habr.com/ru/post/329992/">1.3.3.2 Example 2</a> </li><li>  <a href="https://habr.com/ru/post/329992/">1.3.3.3 Example 3</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/329992/">1.3.4 Examples of good practice</a> <br><ul><li>  <a href="https://habr.com/ru/post/329992/">1.3.4.1 Example 1</a> </li><li>  <a href="https://habr.com/ru/post/329992/">1.3.4.2 Example 2</a> </li></ul></li></ul></li></ul></li></ul><br><h2 id="11-kratkiy-obzor">  1.1 Overview </h2><br><p>  The thoughts and examples described in this document should clearly demonstrate the importance of breaking changes into a group of consecutive commits, as well as the importance of writing good messages to them.  If these instructions are widely used, it will significantly improve the quality of the git OpenStack history.  Carrots and sticks are needed to effectively change the history of git.  This document should be a carrot, drawing people's attention to the benefits and benefits, while for others the use of the Gerrit code inspection system will act like a whip.  ;-P </p><br><p>  In other words, when inspecting in Gerrit, it‚Äôs not just necessary to look at the correctness of the code.  When inspecting, you first need to examine the commit message and point out improvements to the message itself.  Get accustomed to commits that combine many logical changes and require the sender to split them into separate commits.  Make sure that changes with formatting indents are not merged with functional changes.  Also make sure that the refactoring of the code is fixed separately from the functional changes, and so on. </p><br><p>  It is also worth mentioning that Gerrit's handling of a series of patches is not entirely perfect.  However, you should not consider this a valid reason to avoid creating a series of patches.  The tools used must comply with the needs of the developers, and since they are open source, they can be fixed or improved.  The source code is ‚Äúoften read, write from time to time,‚Äù and therefore the most important criterion is to improve the long-term support of the code with the help of a large number of developers in the community, and you shouldn‚Äôt sacrifice a lot because of one author who may never touch code again. </p><br><p>  And now the detailed principles, as well as examples of good and bad practice. </p><br><h2 id="12-strukturnoe-razdelenie-izmeneniy">  1.2 Structural separation of changes </h2><br><p>  The basic rule for creating good commits is to provide only one ‚Äúlogical change‚Äù for each commit.  There are many reasons why this is an important rule: </p><br><ul><li>  The less the code changes, the faster and easier it is to check it and identify potential flaws. </li><li>  If it is detected that the commit is incorrect or broken, a bad commit may need to be rolled back.  And it will be much easier to do if there are no other unrelated changes in the code that are mixed with the original commit. </li><li>  When troubleshooting issues, such as when using the git bisect command, small, well-formed commits will help determine exactly where and when a problem was introduced in the code. </li><li>  When viewing the git history with git annotate or git blame, small well-formed commits help to find and isolate the problematic part of the code, as well as to understand where the problem fragment came from. </li></ul><br><h2 id="121-chego-nuzhno-izbegat-pri-sozdanii-kommitov">  1.2.1 What to avoid when creating commits </h2><br><p>  You need to know and understand common examples of bad practice in order to avoid them: </p><br><ul><li>  <strong>Mixing indent and space formatting with functional code changes.</strong> </li></ul><br><p>  Formatting changes will hide important functional changes, making it difficult for a reviewer to accurately determine if a commit is correct.  <strong>Solution:</strong> Create 2 commit, one with formatting changes, the other with functional changes.  Usually, changing indents is done first, but this is not a strict rule. </p><br><ul><li>  <strong>Mixing two unrelated functional changes.</strong> </li></ul><br><p>  Again, it will be more difficult for a reviewer to identify flaws if you mix two unrelated changes.  If the need arises for a later rollback of a broken commit, it will be necessary to sort out and unravel two unrelated changes with the additional risk of creating new errors. </p><br><ul><li>  <strong>Sending large new features in one giant commit.</strong> </li></ul><br><p>  It is possible that the code for the new function is useful only when the entire implementation is present.  However, this does not mean that the entire function should be provided in one commit.  New features often entail refactoring existing code.  It is highly desirable that any refactoring be performed in separate commits, and not in those in which the new function is implemented.  This will help reviewers and test suites confirm that refactoring does not have unintended functional changes.  Even newly written code can often be divided into several parts that can be independently considered.  For example, changes that add new internal APIs or classes may be in separate commits.  Again, this simplifies the verification of the code.  It also allows other developers to get small chunks of work with git cherry-pick, if the new feature is not quite ready to merge.  Adding new public HTTP APIs or RPC interfaces should be done in commits separate from the actual internal implementation.  This will encourage the author and reviewers to think about the overall design of the API or RPC, and not just choose a design that is simpler for the currently selected internal implementation.  If the patch affects public HTTP, use the APIImpact flag (see <a href="https://habr.com/ru/post/329992/">Including External Links</a> ). </p><br><p>  The main thing is to follow the rule: </p><br><p><code>         ,     .  -  .   .</code> </p> <br><h2 id="122-primery-plohoy-praktiki">  1.2.2 Examples of bad practice </h2><br><p>  Now let's illustrate a bit of examples from the history of Git Nova.  Note: although the comm hashes are cited for reference, the names of the authors are removed, since we should not blame or insult a single person.  From time to time, each of us is guilty of violating the rules of good form.  In addition, people who have reviewed and approved these commits are as guilty as the one who wrote and sent them; </p><br><h3 id="1221-primer-1">  1.2.2.1 Example 1 </h3><br><pre> <code class="hljs sql">: ae878fc8b9761d099a4145617e4a48cbeb390623 : [] : . 1  01:44:02 2012 . +0000    <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> libvirt *       <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> *   wait_for_destroy    undefine *        *  <span class="hljs-keyword"><span class="hljs-keyword">reset</span></span>     <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> / destroy *  resume_host_state     hard_reboot *  rescue/unrescue        <span class="hljs-keyword"><span class="hljs-keyword">Change</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">Id</span></span>: I2072f93ad6c889d534b04009671147af653048e7</code> </pre> <br><p>  This commit has made at least two independent changes. </p><br><ol><li>  Switch to the use of the new reset API in the ‚Äúhard_reboot‚Äù method </li><li>  Correction of internal driver methods to not use "hard_reboot" </li></ol><br><p>  What is the problem here: </p><br><ul><li>  First, there are no compelling reasons why these changes needed to be made simultaneously (in one commit).  The first commit could include changes to stop the call in different places in the ‚Äúhard_reboot‚Äù method.  The second commit could rewrite the implementation of hard_reboot. </li><li>  Secondly, the transition to the use of the reset libvirt method was hidden in a large code refactoring, and the reviewers missed it, and this introduced dependence on the newer version of the API libvirt.  This commit was found as a problem fairly quickly, but a trivial rollback is impossible due to the large number of unrelated changes. </li></ul><br><h3 id="1222-primer-2">  1.2.2.2 Example 2 </h3><br><pre> <code class="hljs markdown">: e0540dfed1c1276106105aea8d5765356961ef3d : [] : C. 16  15:17:53 2012 +0400  lvm-disk-images     LVM   VM.   LVM    libvirt. VM-     LVM      <span class="hljs-code"><span class="hljs-code">`libvirt_images_volume_group`</span></span>.   <span class="hljs-code"><span class="hljs-code">`libvirt_local_images_type`</span></span> ,     .  : <span class="hljs-code"><span class="hljs-code">`raw`</span></span>, <span class="hljs-code"><span class="hljs-code">`lvm`</span></span>, <span class="hljs-code"><span class="hljs-code">`qcow2`</span></span>, <span class="hljs-code"><span class="hljs-code">`default`</span></span>.  <span class="hljs-code"><span class="hljs-code">`libvirt_local_images_type`</span></span> = <span class="hljs-code"><span class="hljs-code">`default`</span></span>,     <span class="hljs-code"><span class="hljs-code">`use_cow_images`</span></span>.   <span class="hljs-code"><span class="hljs-code">`libvirt_sparse_logical_volumes`</span></span>  ,       (   virtualsize        ).       <span class="hljs-code"><span class="hljs-code">`False`</span></span>.     : <span class="hljs-code"><span class="hljs-code">`Raw`</span></span>, <span class="hljs-code"><span class="hljs-code">`Qcow2`</span></span>  <span class="hljs-code"><span class="hljs-code">`Lvm`</span></span>.      ,      <span class="hljs-code"><span class="hljs-code">`LibvirtConnection._cache_image`</span></span> <span class="hljs-code"><span class="hljs-code">` libvirt_info`</span></span>      <span class="hljs-code"><span class="hljs-code">`LibvirtGuestConfigDisk`</span></span>  libvirt.  <span class="hljs-code"><span class="hljs-code">`Backend`</span></span> ,     . Change-id: I0d01cb7d2fd67de2565b8d45d34f7846ad4112c2</code> </pre> <br><p>  This change introduces one major new function, so at first glance it seems reasonable to use a single commit, but looking at the patch, it is clearly very confusing, since it contains a significant amount of code refactoring with the new LVM function.  This fact makes it difficult to determine probable regressions with the support of QCow2 / Raw images.  It should be divided into smaller ones, at least into four separate commits. </p><br><ul><li>  Replaced the use_cow_images configuration flag with the new libvirt_local_images_type flag with backward compatibility support for the obsolete use_cow_images flag. </li><li>  Creating an internal ‚ÄúImage‚Äù class and implementing the Raw &amp; QCow2 subclasses. </li><li>  Refactoring the libvirt driver to replace the raw / qcow2 image management code by calling the new class ‚ÄúImage‚Äù. </li><li>  Introduction of a new implementation of the ‚ÄúLVM‚Äù image class. </li></ul><br><h2 id="123-primery-horoshey-praktiki">  1.2.3 Examples of good practice </h2><br><h3 id="1231-primer-1">  1.2.3.1 Example 1 </h3><br><pre> <code class="hljs css">: 3114<span class="hljs-selector-tag"><span class="hljs-selector-tag">a97ba188895daff4a3d337b2c73855d4632d</span></span> : <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span> : . 11  17<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:16</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:10</span></span> 2012 +0100      <span class="hljs-selector-tag"><span class="hljs-selector-tag">KVM</span></span>  <span class="hljs-selector-tag"><span class="hljs-selector-tag">VM</span></span>  <span class="hljs-selector-tag"><span class="hljs-selector-tag">PIT</span></span>  <span class="hljs-selector-tag"><span class="hljs-selector-tag">RTC</span></span> : 573<span class="hljs-selector-tag"><span class="hljs-selector-tag">ada525b8a7384398a8d7d5f094f343555df56</span></span> : <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span> : . 1  17<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:09</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:32</span></span> 2012 + 0100       <span class="hljs-selector-tag"><span class="hljs-selector-tag">VM</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">libvirt</span></span></code> </pre> <br><p>  Together, these two changes provide support for configuring guest KVM timers.  The introduction of new APIs for creating the XML configuration libvirt was clearly separated from the change in the KVM guest creation policy, which uses new APIs. </p><br><h3 id="1232-primer-2">  1.2.3.2 Example 2 </h3><br><pre> <code class="hljs css">: 62<span class="hljs-selector-tag"><span class="hljs-selector-tag">bea64940cf629829e2945255cc34903f310115</span></span> : <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span> : . 1  14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:49</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:42</span></span> 2012 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0400</span></span>     <span class="hljs-selector-tag"><span class="hljs-selector-tag">rpc</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.queue_get_for</span></span>(). <span class="hljs-selector-tag"><span class="hljs-selector-tag">Change-Id</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">Ifa7d648e9b33ad2416236dc6966527c257baaf88</span></span> : <span class="hljs-selector-tag"><span class="hljs-selector-tag">cf2b87347cd801112f89552a78efabb92a63bac6</span></span> : <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span> : . 30  14<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:03</span></span> 2012 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0400</span></span>   <span class="hljs-selector-tag"><span class="hljs-selector-tag">shared_storage_test</span></span>   <span class="hljs-selector-tag"><span class="hljs-selector-tag">rpcapi</span></span>. ......  <span class="hljs-selector-tag"><span class="hljs-selector-tag">get_instance_disk_info</span></span>    <span class="hljs-selector-tag"><span class="hljs-selector-tag">rpcapi</span></span>. ......  <span class="hljs-selector-tag"><span class="hljs-selector-tag">remove_volume_connection</span></span>    <span class="hljs-selector-tag"><span class="hljs-selector-tag">rpcapi</span></span>. ......  <span class="hljs-selector-tag"><span class="hljs-selector-tag">compare_cpu</span></span>    <span class="hljs-selector-tag"><span class="hljs-selector-tag">rpcapi</span></span>. ......  <span class="hljs-selector-tag"><span class="hljs-selector-tag">get_console_topic</span></span>()    <span class="hljs-selector-tag"><span class="hljs-selector-tag">rpcapi</span></span>. ......  <span class="hljs-selector-tag"><span class="hljs-selector-tag">refresh_provider_fw_rules</span></span>()    <span class="hljs-selector-tag"><span class="hljs-selector-tag">rpcapi</span></span>. ...    ...</code> </pre> <br><p>  This commit sequence reorganized the entire RPC API layer inside OpenStack Compute (Nova) so that the implementation of the connected message systems can be used.  For such a significant change in the main part of the functionality, it was key to dividing the work into a larger sequence of commits, allowing you to make a meaningful check of the code, and also simplified tracking changes and finding possible regressions at each stage of the process. </p><br><h2 id="13-informaciya-v-soobscheniyah-kommitov">  1.3 Information in commit messages </h2><br><p>  The text of the commit message is as important as the code changes themselves.  When creating a message there are some important things to remember: </p><br><ul><li>  <strong>Do not assume that the reviewer understands what the problem was originally.</strong> </li></ul><br><p>  It is often not always clear what the problem was, even if a bug report was read, as well as a couple of comments.  The commit message must contain a clear statement of the original problem.  A specific bug is just an interesting historical background on how the problem was identified.  The reviewer should be clear what the proposed patch does for correct decision making without studying this defect in the error tracking system. </p><br><ul><li>  <strong>Do not assume that the reviewer has access to external web services or sites.</strong> </li></ul><br><p>  After 6 months, when someone on the train / plane / bus / beach / bar resolves the problem and views the history of git, there is no guarantee that he will have access to the online error report or to the server with the documentation.  Distributed source control systems (SCM) have taken a big step forward in that you no longer need to be ‚Äúonline‚Äù to have access to all the information in the repository.  The commit message must be completely self-contained in order to continue to benefit from git. </p><br><ul><li>  <strong>Do not assume that the code is self-evident / self-documented.</strong> </li></ul><br><p>  What is obvious to one person may be completely incomprehensible to another person.  Always document what the original problem was and how it was corrected for every change, of course, except for fixing obvious typos or formatting changes. </p><br><ul><li>  <strong>Describe <em>why the</em> changes were made.</strong> </li></ul><br><p>  A common mistake is to simply describe how the code was written, without describing <strong>why the</strong> developer decided to do it that way.  The most important thing is to explain the intention and motivation of the changes, but also do not forget to describe the general structure of the code. </p><br><ul><li>  <strong>Read the commit message to see if it indicates an improvement in the code structure.</strong> </li></ul><br><p>  Often when describing a large message it becomes obvious that the change had to be divided into two or more parts.  Do not be afraid to go back and split it into several commits. </p><br><ul><li>  <strong>Provide enough information to make the right decision about what to check.</strong> </li></ul><br><p>  When Gerrit sends email alerts about new patch fixes, the email contains minimal information, mainly a commit message and a list of changed files.  Given the large amount of patches, one should not expect all reviewers to study them in detail.  Thus, the commit message should contain sufficient information to warn potential reviewers that this is the patch they should be looking at. </p><br><ul><li>  <strong>The first line of a commit is the most important.</strong> </li></ul><br><p>  In Git, the first line of a commit message has a special meaning.  It is used as the subject of the email, in the git annotate command messages, in the gitk viewer program, when merging a branch and in many other places where there is not much room for text.  In addition to a brief description of the change itself, you should not forget which part of the code is affected.  For example, if this affects the libvirt driver, enter ‚Äúlibvirt‚Äù somewhere on the first line. </p><br><ul><li>  <strong>Describe any limitations of the current code.</strong> </li></ul><br><p>  If the code being modified has features for future enhancements or any limitations you know, be sure to mention them in the commit message.  This demonstrates to the reviewer that the author has considered a broader picture, as well as which compromises have been made in terms of short-term goals compared to long-term desires. </p><br><ul><li>  <strong>Do not include comments that relate exclusively to this patch.</strong> </li></ul><br><p>  In other words, if you redo your commit, please do not add ‚ÄúPatch number 2: redone‚Äù (Patch set 2: rebased) to your message.  This will not make any difference after merging the changes.  However, write a note in Gerrit as a comment on your change.  This will help reviewers find out what has changed between patchsets.  This also applies to comments such as "Added unit tests", "Fix localization problems" or any other patches that do not affect the overall goal of your commit. </p><br><p>  The main thing is to follow the rule: </p><br><p> <code>     ,          .  -  .   .</code> </p> <br><h2 id="131-vklyuchenie-vneshnih-ssylok">  1.3.1 Inclusion of external links </h2><br><p>  Although the message is mainly intended for human interpretation, it always contains the metadata provided for machine processing.  In OpenStack, they include a ‚ÄúChange Id‚Äù (Change ID), as well as optional links to bug identifiers, blueprint links (schemes / documents), DocImpact flag, APIImpact flag, and SecurityImpact flag. </p><br><ul><li>  The ‚ÄúChange-Id‚Äù string is a unique hash describing the change that is generated by the Git interceptor (hook).  It should not change after being inspected while editing a commit with the rebase command, it is also used by Gerrit to track patch versions. </li><li>  The string 'bug' can refer to an error in several ways.  Gerrit creates a link to the bug when viewing the patch on review.openstack.org, so that reviewers can quickly access the bug in Launchpad. <br><ul><li>  Closes-Bug: # 1234567 - use the ‚ÄúCloses-Bug‚Äù if the commit is intended to completely eliminate and close the error you are referring to. </li><li>  Partial-Bug: # 1234567 - use 'Partial-Bug' if a commit is only a partial fix and more work is required to eliminate this bug. </li><li>  Related-Bug: # 1234567 - use the 'Related-Bug' if the commit is simply associated with the specified error. </li></ul></li><li>  The name 'blueprint' should contain the name Launchpad blueprint (documentation on the Launchpad website), if the commit is intended to implement a certain function.  Gerrit links to the blueprint when viewing the patch on review.openstack.org so that reviewers can quickly access the document on the Launchpad. </li><li>  The <strong>DocImpact</strong> line contains the line DocImpact and a comment about why this change affects the documentation.  Put the DocImpact on a separate line.  Use this flag to indicate that the documentation is contained in a patch, or the change affects the documentation so that the reviewer can understand the reasons for the change.  Include as much information as possible.  When this flag is included in the commit message, Gerrit creates a bug-report for the openstack-manuals project (openstack instructions) for tracking and ordering, or moves, if necessary, to the openstack-api-site. </li><li>  The <strong>APIImpact</strong> line contains the <strong>APIImpact</strong> line and a comment about why this change affects the public HTTP API.  Place the APIImpact on a separate line.  Use this flag to indicate that the patch creates, updates, or deletes the public HTTP API or modifies the behavior of the public API.  Include as much information as possible.  When this flag is included in the commit message, all related reviews can be found using <a href="https://review.openstack.org/">this link</a> , and a page from the <a href="https://wiki.openstack.org/wiki/API_Working_Group">API_Working_Group</a> documentation can help in finding relevant reviews.  In addition, the API Working Group can be directly contacted via IRC on the Freenode channel <em># openstack-sdks</em> . </li><li>  The <strong>SecurityImpact</strong> string simply contains the SecurityImpact string.  It is used to indicate that the change has security implications and should be reviewed by the OpenStack Security Group. </li><li>  The <strong>UpgradeImpact</strong> line contains the <strong>UpgradeImpact</strong> line and a comment about why this change affects upgrades.  It is used to indicate that the change has the consequences of updates for those who make continuous deployment, or from N to N + 1 updates.  It may also indicate updates to the ‚ÄúUpgrade Notes‚Äù section in the release notes for the affected project. </li></ul><br><p>  All metadata is intended for machines and is of secondary importance for people, therefore, all of them should be grouped together at the end of the commit message. </p><br><p>  Note: Although in many open source projects using Git, it is a popular practice to include the "Signed-off-by" tag (generated by using the "git commit -s" command), this is not necessary for OpenStack.  Before being able to send code to Gerrit, OpenStack requires all participants to sign a CLA (Contributor License Agreement, License Agreement for Members), which serves an equivalent purpose. </p><br><p>  We encourage the use of Co-Authored-By: name <a href="">name@example.com</a> ( <a href="">Collaboration</a> ) in commit messages to identify people who worked on a specific patch.  This is an agreement on the recognition of several authors, and our projects call upon statistical collection tools to follow these fields as they are analyzed. </p><br><h2 id="132-kratkiy-obzor-struktury-soobscheniy-kommitov">  1.3.2 Overview of the commit message structure </h2><br><ul><li>  In the first line, provide a brief description of the changes. </li><li>  Insert an empty line after the first line. </li><li>  In the following lines write a detailed description of the changes, breaking up the paragraphs where necessary. </li><li>  The first line must be limited to 50 characters and must not end with a period. </li><li>  Subsequent lines must be enclosed in 72 characters. <br><ul><li>  vim (by default in the $ EDITOR environment variable on most distributions) can automatically wrap the lines for you.  In most cases, you just need to copy the vimrc sample file (which can be found somewhere, for example <code>/usr/share/vim/vim74/vimrc_example.vim</code> ) to <code>~/.vimrc</code> if you do not have it. </li><li>  After editing a paragraph, you can wrap it by pressing the escape key, placing the cursor inside the paragraph and entering the <code>gqip</code> combination. </li></ul></li><li>  Put the ‚ÄúChange-id‚Äù, ‚ÄúCloses-Bug #NNNNN‚Äù and ‚Äúblueprint NNNNNNNNNNNN‚Äù lines at the very end if necessary. </li></ul><br><p>  For example: </p><br><pre> <code class="hljs 1c">  libvirt get_cpu_info    API  get_cpu_info   libvirt      XPath <span class="hljs-keyword"><span class="hljs-keyword"></span></span>   <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  XML .       LibvirtConfigCaps.     <span class="hljs-keyword"><span class="hljs-keyword"></span></span>   . DocImpact Closes-Bug: <span class="hljs-meta"><span class="hljs-meta">#1003373 Implements: blueprint libvirt-xml-cpu-model Change-Id: I4946a16d27f712ae2adf8441ce78e6c0bb0bb657</span></span></code> </pre> <br><h2 id="133-nekotorye-primery-plohoy-praktiki">  1.3.3 Some examples of bad practice </h2><br><p>  Let's look at some examples from the history of Git Nova, again with the names of the authors removed, since we do not want to blame or insult anyone. </p><br><h3 id="1331-primer-1">  1.3.3.1 Example 1 </h3><br><pre> <code class="hljs 1c">: <span class="hljs-number"><span class="hljs-number">468</span></span>e64d019f51d364afb30b0eed2ad09483e0b98 : [] <span class="hljs-built_in"><span class="hljs-built_in"></span></span>: . <span class="hljs-number"><span class="hljs-number">18</span></span>  <span class="hljs-number"><span class="hljs-number">16</span></span>:<span class="hljs-number"><span class="hljs-number">07</span></span>:<span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-number"><span class="hljs-number">2012</span></span> -<span class="hljs-number"><span class="hljs-number">0400</span></span>     compute/utils.py Fixes bug <span class="hljs-meta"><span class="hljs-meta">#1014829</span></span></code> </pre> <br><p>  Problem: there is no mention of what should have been imported, where this import is not enough, and why it is so necessary.  This information was included in the error tracker and had to be copied to the commit message in order to provide a self-contained description.  For example: </p><br><pre> <code class="hljs 1c">   <span class="hljs-string"><span class="hljs-string">"exception"</span></span>  compute/utils.py nova/compute/utils.py      exception.NotFound,  <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  .</code> </pre> <br><h3 id="1332-primer-2">  1.3.3.2 Example 2 </h3><br><pre> <code class="hljs css">: 2020<span class="hljs-selector-tag"><span class="hljs-selector-tag">fba6731634319a0d541168fbf45138825357</span></span> : <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span> : . 15  11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:12</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:45</span></span> 2012 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0600</span></span>    <span class="hljs-selector-tag"><span class="hljs-selector-tag">ec2id</span></span>     <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fixes</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bug</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#1013765</span></span> *      <span class="hljs-selector-tag"><span class="hljs-selector-tag">ec2utils</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.id_to_ec2_id</span></span>() <span class="hljs-selector-tag"><span class="hljs-selector-tag">Change-Id</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">I5e574f8e60d091ef8862ad814e2c8ab993daa366</span></span></code> </pre> <br><p>  Problem: there is no mention of what is wrong with the current (wrong) format, or what the new corrected format is.  This information was also available in the error tracker and should be included in the commit message.  Moreover, this error corrected the regression caused by the earlier change, but there is no mention of what happened before.  For example: </p><br><pre> <code class="hljs 1c">  <span class="hljs-built_in"><span class="hljs-built_in"></span></span> ec2id <span class="hljs-keyword"><span class="hljs-keyword"></span></span>       uuid' ,    XXXXXXX,   ec2               (i-xxxxx).      vol-xxx  snap-xxxx.      ec2utils.id_to_ec2_id () Fixes bug #<span class="hljs-number"><span class="hljs-number">101376</span></span>5</code> </pre> <br><h3 id="1333-primer-3">  1.3.3.3 Example 3 </h3><br><pre> <code class="hljs css">: <span class="hljs-selector-tag"><span class="hljs-selector-tag">f28731c1941e57b776b519783b0337e52e1484ab</span></span> : <span class="hljs-selector-attr"><span class="hljs-selector-attr">[]</span></span> : . 13  10<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:11</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:04</span></span> 2012 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-0400</span></span>     <span class="hljs-selector-tag"><span class="hljs-selector-tag">libvirt</span></span>. <span class="hljs-selector-tag"><span class="hljs-selector-tag">Fixes</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">LP</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bug</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#1012689</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Change-Id</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">I91c0b7c41804b2b25026cbe672b9210c305dc29b</span></span></code> </pre> <br><p>  Problem: in this commit, the message simply documents what was done, and not why it was done.  It was necessary to mention that earlier the change set introduced a new minimal version of libvirt.  It was also necessary to report what the current behavior is, if the check fails. <br>  For example: </p><br><pre> <code class="hljs 1c">   libvirt,  <span class="hljs-number"><span class="hljs-number">0.9</span></span>.<span class="hljs-number"><span class="hljs-number">7</span></span>   XXXXXXXX   API  'reset'     libvirt <span class="hljs-number"><span class="hljs-number">0.9</span></span>.<span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span> .     libvirt  ,     . <span class="hljs-keyword"><span class="hljs-keyword"></span></span>    ,   . Fixes LP bug <span class="hljs-meta"><span class="hljs-meta">#1012689 Change-Id: I91c0b7c41804b2b25026cbe672b9210c305dc29b</span></span></code> </pre> <br><h2 id="134-primery-horoshey-praktiki">  1.3.4 Examples of good practice </h2><br><h3 id="1341-primer-1">  1.3.4.1 Example 1 </h3><br><pre> <code class="hljs 1c">: <span class="hljs-number"><span class="hljs-number">3114</span></span>a97ba188895daff4a3d337b2c73855d4632d : [] <span class="hljs-built_in"><span class="hljs-built_in"></span></span>: . <span class="hljs-number"><span class="hljs-number">17</span></span>  <span class="hljs-number"><span class="hljs-number">17</span></span>:<span class="hljs-number"><span class="hljs-number">16</span></span>:<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">2012</span></span> +<span class="hljs-number"><span class="hljs-number">0100</span></span>   <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  <span class="hljs-keyword"><span class="hljs-keyword"></span></span> KVM  VM  PIT  RTC  <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  PIT  RTC <span class="hljs-keyword"><span class="hljs-keyword"></span></span>   KVM     ()    .  ,  Windows <span class="hljs-number"><span class="hljs-number">7</span></span>       KVM <span class="hljs-keyword"><span class="hljs-keyword"></span></span> ,    Linux      .  PIT ,        , ..    RTC  ,        , <span class="hljs-keyword"><span class="hljs-keyword"></span></span>   ''    libvirt XML &lt;clock offset='utc'&gt; &lt;timer name='pit' tickpolicy='delay'/&gt; &lt;timer name='rtc' tickpolicy='catchup'/&gt; &lt;/clock&gt;   KVM   -no-kvm-pit-reinjection -rtc base=utc,driftfix=slew     ,    <span class="hljs-keyword"><span class="hljs-keyword"></span></span>   .         <span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-keyword"><span class="hljs-keyword"></span></span>    Closes-Bug: <span class="hljs-meta"><span class="hljs-meta">#1011848 Change-Id: Iafb0e2192b5f3c05b6395ffdfa14f86a98ce3d1f</span></span></code> </pre> <br><p>  ,      : </p><br><ul><li> ,       (  KVM  ) </li><li>    (  PIT / RTC) </li><li>    ( XML / QEMU args) </li><li>       (    ) </li><li>   Closes-Bug </li></ul><br><h2 id="1342-primer-2"> 1.3.4.2  2 </h2><br><pre> <code class="hljs 1c">: <span class="hljs-number"><span class="hljs-number">31336</span></span>b35b4604f70150d0073d77dbf63b9bf7598 : [] <span class="hljs-built_in"><span class="hljs-built_in"></span></span>: . <span class="hljs-number"><span class="hljs-number">06</span></span>  <span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">45</span></span>:<span class="hljs-number"><span class="hljs-number">25</span></span> <span class="hljs-number"><span class="hljs-number">2012</span></span> -<span class="hljs-number"><span class="hljs-number">0400</span></span>      CPU   ,      , <span class="hljs-keyword"><span class="hljs-keyword"></span></span>     ARM    X86_64  . <span class="hljs-keyword"><span class="hljs-keyword"></span></span>        , <span class="hljs-keyword"><span class="hljs-keyword"></span></span>   <span class="hljs-keyword"><span class="hljs-keyword"></span></span> .  libvirt            permitted_instances_types   cpu_info . <span class="hljs-keyword"><span class="hljs-keyword"></span></span> Xen     .         permitted_instances_types     .   ARM     . <span class="hljs-keyword"><span class="hljs-keyword"></span></span>  ArchFilter <span class="hljs-keyword"><span class="hljs-keyword"></span></span> . Change-Id: I17bd103f00c25d6006a421252c9c8dcfd2d2c49b</code> </pre> <br><p>  ,      : </p><br><ul><li>   ,   (  ) </li><li>    (    ) </li><li>      ( libvirt  ) </li><li>      (,   Xen) </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/329992/">https://habr.com/ru/post/329992/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../329982/index.html">Determining the number of a Telegram user using brute force in the address book</a></li>
<li><a href="../329984/index.html">Chronicles of Confrontation: how to hack the whole city in two days</a></li>
<li><a href="../329986/index.html">Unequal battle: CRM vs. Excel</a></li>
<li><a href="../329988/index.html">Yes, Python is slow, but I don't care</a></li>
<li><a href="../329990/index.html">New architecture of Android applications - we try in practice</a></li>
<li><a href="../329994/index.html">BI.ZONE Announces CTFzone Presidential Election</a></li>
<li><a href="../329996/index.html">Simple React Router v4 Tutorial</a></li>
<li><a href="../329998/index.html">Quest from EPAM: Five Tasks from .NET Interviews</a></li>
<li><a href="../330000/index.html">‚ÄúThe lifetime of a tab can be almost endless‚Äù: Timofey Chaptykov about JS development on VKontakte</a></li>
<li><a href="../330002/index.html">Analysis of tasks of the WAF Bypass contest on PHDays VII</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>