<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>TLS 1.2 and new GOST</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The readers are invited to a brief overview of the draft draft recommendations on standardization , defining the use of Russian cryptographic algorith...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>TLS 1.2 and new GOST</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/mm/g9/sz/mmg9szo3gnw-xtrfnhkdt4pacmw.png"></p><br><p>  The readers are invited to a brief overview of the draft <a href="https://www.tc26.ru/standard/draft/%25D0%25A2%25D0%259A26_TLS_2015.pdf">draft recommendations on standardization</a> , defining the use of Russian cryptographic algorithms in the TLS 1.2 protocol (hereinafter simply draft recommendations). </p><a name="habracut"></a><br><h1>  TLS protocol </h1><br><p>  The Transport Layer Security (TLS) protocol is one of the most popular protocols designed to establish a secure communication channel on the Internet.  It is based on the SSL (Secure Sockets Layer) version 3.0 protocol specification, but during its existence it has undergone quite a few changes.  The current protocol version is currently <a href="http://tools.ietf.org/html/rfc5246">TLS 1.2</a> , but in the near future, <a href="https://tools.ietf.org/html/draft-ietf-tls-tls13-21">TLS 1.3</a> is expected to be released. </p><br><p>  The TLS protocol consists of two levels.  At the bottom level is the TLS Records protocol, running on top of some transport protocol with guaranteed packet delivery (see <a href="https://ru.wikipedia.org/wiki/Transmission_Control_Protocol">TCP</a> ).  The Record Protocol ensures the confidentiality and integrity of the data transmitted over the communication channel.  In turn, the Alert protocol, the Change Status protocol, the Application Data protocol and the Handshake protocol work on top of the Records protocol.  The first three essentially do not solve any cryptographic tasks, and the main interest here is the Handshake Protocol, which is responsible for authenticating the parties and developing the security parameters necessary to protect data at the Record Protocol level. </p><br><h1>  New kryptonabors: who are they and why are they needed? </h1><br><p>  In 2015, new standards <a href="https://www.tc26.ru/standard/gost/GOST_R_3412-2015.pdf">GOST R 34.12‚Äì2015</a> and <a href="https://www.tc26.ru/standard/gost/GOST_R_3413-2015.pdf">GOST R 34.13‚Äì2015 were issued</a> , which describe two algorithms for block encryption Grasshopper and Magma, as well as their modes of operation.  As a result, it became necessary to integrate these algorithms into new krypton sets that would correspond to the version of the TLS 1.2 protocol.  Also one of the important tasks facing the authors of the document was the creation of a Russian-language complete and self-sufficient description of one of the largest and most complex for understanding modern network protocols.  And this task was solved. </p><br><p>  The draft recommendations that are being developed define two new krypton sets: </p><br><ul><li>  TLS_GOSTR341112_256_WITH_KUZNYECHIK_CTR_OMAC; </li><li>  TLS_GOSTR341112_256_WITH_MAGMA_CTR_OMAC. </li></ul><br><p>  The first is based on the use of the Grasshopper block cipher, the second is based on the use of <br>  block cipher magma. </p><br><p>  Let us examine in more detail what is new, in addition to new encryption algorithms, was added to the version of the TLS 1.2 protocol with Russian kryptonabors. </p><br><h1>  Basic principles and important features </h1><br><p>  The basic principles of the Handshake Protocol in new kryptonabors almost did not change compared with the previous version of domestic kryptonabors.  In short, the main secret parameter - the premaster secret (PMS) - is generated by the client and transmitted to the server encrypted using its public key.  Server authentication is carried out due to the fact that the server correctly extracted the PMS secret value using its private key.  The client, if required, is authenticated with a signature. </p><br><p>  The main cryptographic innovations in the Handshake protocol are as follows: </p><br><ul><li>  A new PMS encryption algorithm is used, the so-called key export algorithm, based on new ciphers and their modes of operation (determined within another <a href="https://www.tc26.ru/standard/draft/%25D0%25A2%25D0%259A26%25D0%2590%25D0%259B%25D0%2593_II.PDF">new document</a> ); </li><li>  Session secret - master secret (MS) - is now tied not only to random values ‚Äã‚Äãof the parties transmitted in the greeting messages, but also to all messages transmitted prior to its generation.  The main thing here is that the value of MS now depends on the server certificate, which allows you to counter the attack of <a href="https://www.mitls.org/pages/attacks/3SHAKE">Triple Handshake</a> .  This innovation complies with <a href="https://tools.ietf.org/html/rfc7627">RFC 7627</a> recommendations. </li></ul><br><p>  In contrast to the Handshake protocol, the Records protocol is not similar to its counterpart from the previous version of the national recommendations, nor to foreign versions.  It implements all the advanced achievements concerning the tasks of ensuring a secure communication channel and <a href="http://cryptopro.ru/blog/2017/05/17/o-nagruzke-na-klyuch-chast-1">minimizing the load on the key</a> (that is, the amount of data processed on one key).  Keys involved in data protection form a hierarchy (root key, intermediate level keys, message processing keys, and section keys), which allows you to increase the number of messages processed while staying within the framework of a safe key load.  The creation of such a hierarchy is achieved through the use of external and internal key conversion mechanisms (external and internal re-keying), the positive properties of which have been proven in a number of works both foreign (see the work of <a href="https://link.springer.com/chapter/10.1007/3-540-44448-3_42">Abdala and Bellar</a> ) and domestic cryptographers (see <a href="https://eprint.iacr.org/2017/697.pdf">here</a> and <a href="https://eprint.iacr.org/2016/628.pdf">here</a> ).  These mechanisms are implemented through the use of the CTR-ACPKM encryption mode and the TLSTREE key diversification function.  The mentioned approaches to reducing the load on the key are described in the draft <a href="https://tools.ietf.org/html/draft-irtf-cfrg-re-keying-08">RFC</a> , which is also being developed now under the guidance of domestic specialists. </p><br><h1>  Conclusion </h1><br><p>  The resulting document is a fully self-sufficient description and, despite its impressive scope, has become understandable and structured.  In addition to the description of the algorithmic part in the annex to the document, you can find a detailed log of the operation of the protocol, broken down by the fields of the structures used.  Such a description of control values ‚Äã‚Äãgreatly facilitates the understanding of the details of the operation of the protocol. </p><br><p>  Currently, the numbers of the developed krypton sets are assigned temporary values ‚Äã‚Äãfrom the private <a href="https://www.iana.org/">IANA</a> number area.  As soon as the draft recommendation is adopted, it is planned to immediately begin developing its RFC. </p><br><p>  It is also worth noting that the immediate plans of the experts of the working group of the technical committee 26 ( <a href="https://www.tc26.ru/">26</a> ) are the beginning of the development of the next draft recommendations on the <a href="https://www.tc26.ru/">crypto-sets</a> corresponding to the TLS 1.3 version.  Work on this document will begin immediately after approval of the current project for TLS 1.2 in TK26, as well as after the release of the new RFC for TLS 1.3. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/339978/">https://habr.com/ru/post/339978/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339968/index.html">Data Geometry 5. Base Conversion</a></li>
<li><a href="../339970/index.html">IoTmanager is a mobile MQTT client with an unusual concept</a></li>
<li><a href="../339972/index.html">Raiffeisenbank DevOps: Flight Phase</a></li>
<li><a href="../339974/index.html">How we did and do memed</a></li>
<li><a href="../339976/index.html">How IIS supports our BI analytics, and what are the features of settings under Highload</a></li>
<li><a href="../339980/index.html">Lenovo data center solutions</a></li>
<li><a href="../339982/index.html">A cohort analysis shows a picture that is completely different from our usual perception.</a></li>
<li><a href="../339984/index.html">Case: endless development of the ultimate flash drive or how not to start a startup. Part 1: from idea to product</a></li>
<li><a href="../339986/index.html">VoIP server for a small company (FreePBX 14, Asterisk 15, Ubuntu 16.04) part 1</a></li>
<li><a href="../339988/index.html">A little bit about VIM and IDE</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>