<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Information security in process control systems: attack vector interface converters</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Thinking 
 Some time ago I attended one conference dedicated to information security, there they discussed all the issues of different security in dif...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Information security in process control systems: attack vector interface converters</h1><div class="post__text post__text-html js-mediator-article"><h2>  Thinking </h2><br>  Some time ago I attended one conference dedicated to information security, there they discussed all the issues of different security in different systems.  In my main specialty I do not have a direct relationship to security and I have many questions and thoughts on this topic, which was the beginning of the study of information security issues in automated control systems. <br><a name="habracut"></a><br>  One guy gave a talk on information security in an automated process control system, told that for a long time the evolution of automation systems was a parallel course with the development of IT systems and that over time, systems built on modern IT technologies began to be used to control automation systems.  And that at the present time the interconnection of the technological network with the corporate network is necessary for production management as well as for the administration of the entire system.  The vector of attacks from IT systems has shifted to production and industrial networks.  He told about a factory somewhere in Germany, which was able to make an attack and disrupt the technological process, as a result of which the foundry production fell and suffered huge losses, and the foundry had to disassemble and still have many terrible stories.  Well, in general, the report did not make the necessary (frightening) impression.  Those present at the event began to ask questions and discuss, "they say to whom we need small companies with minimal turnover of money, saying that there are real confirmations of incidents with attacks on enterprises in Russia." <br><br>  The guy could not give examples: either he was not ready, or did not have the right to disclose the information he owned.  So why this story? <br><br>  After this event, I wondered why people responded so well to his speeches, because he was well-versed with terms and international statistics on attacks on objects, but people felt that these attacks are unlikely and do not pose a threat to them.  That is what prompted me to do research in the field of information security of ACS TP. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Some theory </h2><br>  Consider the atypical direction of attack on interface converters, since  There is a lot of information about attacks on PCs, PLCs and the system as a whole, but few people thought that almost every production has all the various systems of devices, sensors, devices and there is a problem of compatibility of various types of devices.  There is a huge variety of devices of various types and purposes, a large number of companies engaged in their production, different standards, mostly incompatible with each other.  The way out of this situation are interface converters.  All of them are used to connect devices with RS-232/422/485 interface, and these are data acquisition systems, recorders, controllers, sensors, terminals, and more.  But it is not enough just to connect the ports. It is necessary to establish communication at the program level, which is a more difficult task.  Different device standards can transfer data using different technologies.  To unify the protocols to bring the transmitted data to a single form with the help of converters is not possible, but it is possible to adapt the type of data transmitted between different parts of the system by different protocols so that they are successfully received and decrypted by an element using a different protocol. <br><br>  And those who operate real-world systems for automated process control systems know how diverse the equipment and parts of this system are sometimes, which in some cases have been working on the production for about 10-15 years and sometimes have to put another system on top of one system and achieve its coalescence so that everything interacts. between themselves.  This is where interface converters fit like never before.  Conversion of packets, transmitted data occurs at the software level.  In addition to directly changing the structure of the transmitted data, the software component of the converter is responsible for determining the types of protocols used in the system and choosing the algorithm for their coordination. <br><br>  Interface converter is a modern and effective means of expanding the functionality of an information system, indispensable in the absence of a single standard for building all the various data transmission systems. <br><br>  And now let's think about it. We use converters on all figurative objects, connect all the various devices (protection terminals, sensors, counters) and all other possible devices to them.  But after all, all the information from the object to the client passes through them and it is worth gaining access to them, as we can find out a lot of information that will give us the direction of the attack on the end devices or allow us to receive, replace or send information on behalf of these devices. <br><br><h2>  To practice </h2><br>  We will conduct an experiment with very popular converters of Taiwanese company MOXA Nport of different versions.  We will use free software and allowed resources at the levels of ordinary users. <br><br>  There is such a very interesting resource on the <a href="http://www.shodan.io/">Internet www.shodan.io</a> allows you to find devices on the global Internet, to which you have access and see where they are.  Perform a simple scan with input in the search box Moxa Nport.  We look and wonder what is happening in the world.  It should be <a href="http://www.shodan.io/">borne</a> in mind that some organizations send a written ban on scanning their subnet to the company <a href="http://www.shodan.io/">www.shodan.io</a> . <br><br>  In general, we found 7260 devices on request for Moxa Nport worldwide.  Then we study how to get access to devices.  We notice that for the most part 22, 23, 80, 443 ports are open and through them you can safely connect to devices. <br><br><img src="https://habrastorage.org/web/839/e88/c97/839e88c977624629af28363bc634db10.jpg"><br><br>  Taiwan <br><br><img src="https://habrastorage.org/web/751/cca/0aa/751cca0aa95541b18849969e61196acf.jpg"><br><br>  Poland <br><br><img src="https://habrastorage.org/web/065/01c/3a2/06501c3a2ee44eb3b93ca9393d211475.jpg"><br><br>  Lipetsk <br><br><img src="https://habrastorage.org/web/a81/52b/dd1/a8152bdd187640658770e3bc5e428e4e.jpg"><br><br>  China <br><br><img src="https://habrastorage.org/web/b40/eba/413/b40eba413dcd46d18fd9244f2d91eef5.jpg"><br><br>  Kazan <br><br><img src="https://habrastorage.org/web/90d/4f4/7cc/90d4f47ccce94ad898569fab3533b343.jpg"><br><br>  Taiwan <br><br><img src="https://habrastorage.org/web/383/ff9/da8/383ff9da894b47caa7d2ee9df3bf6480.jpg"><br><br>  In some cases, the devices are factory default accounts, to know the username and password is not difficult. <br><br><img src="https://habrastorage.org/web/0a3/dea/7c6/0a3dea7c683648d2b279e4fb517c9363.jpg"><br><br>  We fall on the device and look at all that is needed, we make sure that there are administrator rights. <br><br><img src="https://habrastorage.org/web/9e6/4c3/252/9e64c3252e714a1eb5114b289b6c8273.jpg"><br><br><img src="https://habrastorage.org/web/835/144/ab4/835144ab4ba7404ca9c715aeba05ab23.jpg"><br><br>  We can both view all the information and change it. <br><br><img src="https://habrastorage.org/web/54a/3ba/a96/54a3baa96d094e2e86d780ea84abe68a.jpg"><br><br>  Some users set a non-standard password and close port 80, but <a href="http://www.shodan.io/">www.shodan.io</a> still has the ability to view useful information on other ports that can be used to develop the attack vector.  The name of the device, its status, MAC address, SSL certificate, its version and much more. <br><br><img src="https://habrastorage.org/web/aad/939/42d/aad93942d1614e26a657c23b57d22c32.jpg"><br><br>  And all this can serve as a good help in planning and organizing attacks.  The more you know the information about the object, the greater the chance that you can use it to attack. <br><br><img src="https://habrastorage.org/web/90d/4f4/7cc/90d4f47ccce94ad898569fab3533b343.jpg"><br><br>  Nowadays, even those devices that were tampered with a brute force hack will not take it, and since most of these devices are not always configured by experts, there is no limit on the number of password entry attempts that could greatly help from brute force. <br><br><img src="https://habrastorage.org/web/027/985/b8e/027985b8ebca4d6986b4291a51a4784b.jpg"><br><br>  But this is only the beginning, we use standard pairs (and there were quite a few such devices in Russia, the Czech Republic, Poland, Italy, Australia, and in many other countries). <br><br><img src="https://habrastorage.org/web/3a9/0aa/3a3/3a90aa3a32eb4a39ab7c95717d51af1b.jpg"><br><br>  We get not limited access to the device and we can analyze both internal information (the internal network where the device is located, find out the address range and gateway address) and analyze what devices are connected to converters, analyze the amount of information transmitted, and much more. <br><br><img src="https://habrastorage.org/web/7f3/7c4/da6/7f37c4da6c8744959cba806a3cb9090e.jpg"><br><br><img src="https://habrastorage.org/web/494/585/bfc/494585bfc38848dbb77358213e07bf54.jpg"><br><br><img src="https://habrastorage.org/web/de1/8cf/072/de18cf072cef404d9ec1950d9459a0c0.jpg"><br><br><br><br>  And change passwords and reboot, in general, unlimited administrator rights. <br><br>  We all were able to do this simply without having professional knowledge and the necessary specialization.  And now let's drip a little deeper, let's say that we have experience with this equipment and devices, we are a little knowledgeable about information security and we know where to look for officially posted vulnerabilities. <br><br>  Yes, gentlemen, all known vulnerabilities are laid out on the network on professional, specialized sites.  You will not believe my surprise when I learned that everything is publicly available, and I am not an information security specialist. <br><br>  We pass on <a href="https://ics-cert.us-cert.gov/">ics-cert.us-cert.gov</a> and in the search engine simply indicate the equipment we are interested in and have an official list of recognized vulnerabilities from the MOXA company and this list is diverse. <br><br><img src="https://habrastorage.org/web/bd3/720/387/bd372038734a41819869c9c29d135ad2.jpg"><br><br>  Google further and learn that the exploitation of vulnerabilities allows attackers to perform various actions on the device unnoticed.  Taiwan MOXA‚Äôs equipment is vulnerable to vulnerabilities allowing a remote, unauthorized user to gain administrative access to devices and important information stored in unencrypted form.  Also, an attacker can perform a CSRF attack.  Successful exploitation of these vulnerabilities allows an attacker to quietly execute various commands, change the password, settings, and reboot the device. <br><br>  The emergence of problems is a consequence of insufficient protection systems for industrial control systems in general.  For example, converters are supplied without a password or with a standard factory password and account (CVE-2016-2286).  Like many devices for ACS systems, which allows any user to gain access to the device with administrator rights via TCP / 80 (HTTP) and TCP / 23 (Telnet).  Currently, according to the manufacturer, there is no information on cases of active exploitation of errors.  And the manufacturer recommended at one time to simply disable TCP / 80 (HTTP) and TCP / 23 (Telnet) ports. <br><br><img src="https://habrastorage.org/web/482/f6e/033/482f6e0335594fc99cf20ac93adba572.jpg"><br><br>  CVE-2016-0875 Allows a remote user to elevate their privileges and access configuration and log files using a specially formulated URL. <br><br>  CVE-2016-087 A remote attacker can cause a denial of service by sending a specially formulated request. <br><br>  CVE-2016-0877 is related to the PING function, and its operation can lead to data leaks. <br><br>  CVE-20164500 affects embedded computers uc7408 lx plus allows a remote authorized user to interrogate devices and cause a failure in the work. <br><br>  CVE-016-8717 experts found in the MOXA devices hard-coded credentials that allow you to log into an undocumented account. <br><br><img src="https://habrastorage.org/web/70a/d83/d53/70ad83d53cd243a98419053bbddec88f.jpg"><br><br>  Researchers and various specialists regularly find, in addition to vulnerabilities, bugs, and outdated software, backdoors.  On the security of the Internet of things in general, they are talking more and more, but from such large manufacturers of communication equipment, such as the MOXA company, no one expected anything like that.  After all, problems have been discovered in a number of cases, ranging from problems with authentication, which allows for dictionary attacks, a lot of XSS bugs in the web interface, DoS vulnerabilities, the ability to inject commands. <br><br>  For most problems, the manufacturer has released corrective firmware updates that eliminate a number of vulnerabilities, in other cases, MOXA has decided to stop the release of some devices due to the inability, and sometimes not the desire to eliminate the vulnerabilities. <br>  Having learned about such vulnerabilities from such a large manufacturer, everyone who uses the equipment of this company should think about updating the firmware, changing passwords, and device settings.  But in the practice of process control systems, everything is much more complicated.  On the production equipment that does not ever have been updated, or can not be updated in connection with the technology of continuous production.  And here there are even more questions, but this is another story and another attack vector. <br><br>  Let's talk about the results of the study: they are not comforting, without possessing specialized knowledge and software, we managed to penetrate an impressive number of converters without much difficulty and this is a reality, not a theory.  Further, if we assume that a person has experience in communicating with these devices and knows where to look for critical information about vulnerabilities, then in most cases it may simply be about exploiting vulnerabilities, because most of the equipment we went through had standard firmware from the factory without the necessary updates. and at almost 80% chance of penetration will be successful. <br><br>  And now the most interesting thing is to consider that we are dealing with a group of intruders who are professionals in their field and it‚Äôs not difficult for them to automate the process of searching for devices and selecting passwords and exploit vulnerabilities.  Having gained access to devices, they can use both the device itself and information from it for future attack vectors (upgrade the devices and use them in the bot network, intercept information, replace them, and send on behalf of this device). <br><br><h2>  findings </h2><br>  Development of automated systems for data collection, processing and process control requires the use of special solutions for building networks.  Data transmissions of the automated process control system are based on a hierarchical principle and have a multi-level structure: <br><br>  - Lower level - the level of sensors and actuators <br>  - Medium-level industrial controllers <br>  - Top level - level of industrial servers and network equipment <br>  - Operator level - the level of the operator and control stations <br><br>  Let's not forget that such non-standard vectors of attacks on converters can serve as a halt in production and technological process.  From the statistics of attacks on industrial computers, we see that every year attacks grow and their vector is the most diverse. <br><br><img src="https://habrastorage.org/web/604/d08/526/604d08526af84f6f81cac4d48895e875.png"><br>  <i>Percentage of industrial computers attacked by months in Russia in 2016</i> <br><br>  In this study, we and you have seen that such attacks are real and may concern both ordinary users who use converters to remotely connect, control, and configure devices on different interfaces.  So all the various organizations whose network is very diverse and has different equipment operating through interface converters.  In my experience, I dealt with both moxa converters for remote configuration of PBXs and for remote control of terminals of various protections that transmit and receive information from the industrial network through converters. <br><br>  The approach of manufacturers of industrial software and equipment to fix vulnerabilities and the situation with the elimination of known vulnerabilities in enterprises cannot be called encouraging.  The overwhelming majority of industrial enterprises, both small and large, remain vulnerable to attacks for years. So what conclusions can be made: attacks of non-standard direction are and will be. You need to defend against them and know vulnerabilities too, because information is power. As for the converters used on my an enterprise?  I checked all the MOXA equipment, updated everything to the latest version, changed and increased the complexity of passwords, studied the materials about the vulnerabilities of this company and followed the recommendations of experts to minimize the chances of the attackers, if all the same attack will take place. <br><br>  <i>PS As a result of this study, no device was affected.</i>  <i>And this experiment pursued research objectives (to show the reality of attacks and their simplicity).</i> </div><p>Source: <a href="https://habr.com/ru/post/339066/">https://habr.com/ru/post/339066/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339050/index.html">Habr advise: how to win the NTI olympiad for schoolchildren in the Big Data profile</a></li>
<li><a href="../339052/index.html">The history of the clock synchronizer DCF77</a></li>
<li><a href="../339054/index.html">How the MobX library helps to manage the state of web applications. Lecture in Yandex</a></li>
<li><a href="../339060/index.html">About interval indices</a></li>
<li><a href="../339064/index.html">MUK becomes an Oracle distributor</a></li>
<li><a href="../339070/index.html">Winning the nomination ‚ÄúThe best startup with the prospect of entering the American market‚Äù, Spb Startup Day 2017 and thoughts about pitches</a></li>
<li><a href="../339072/index.html">Affixing a project to a partner and new 3CX call center reports</a></li>
<li><a href="../339074/index.html">How to legalize the sale of game items</a></li>
<li><a href="../339078/index.html">Periods of sidereal days in radioactive decay</a></li>
<li><a href="../339080/index.html">Dive into Ethereum development. Part 3: user application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>