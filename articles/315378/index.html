<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability of old Ubuntu through an audio file played by 1975 processor emulation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vulnerability and logical separation error settled in the gstreamer player versions 0.10.x for the Nintendo Entertainment System music files , said Ch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability of old Ubuntu through an audio file played by 1975 processor emulation</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/ee9/118/7d4/ee91187d46924424b814478f0be84281.jpg"><br><br>  Vulnerability and logical separation error settled in the <a href="https://ru.wikipedia.org/wiki/GStreamer">gstreamer</a> player versions 0.10.x for the Nintendo Entertainment System <a href="https://ru.wikipedia.org/wiki/NES_Sound_Format">music files</a> , <a href="https://scarybeastsecurity.blogspot.ru/2016/11/0day-exploit-compromising-linux-desktop.html">said</a> Chris Evans on his cybersecurity blog.  The vulnerability of the system allows to obtain stable access to the use and circumvention of 64-bit <a href="https://ru.wikipedia.org/wiki/ASLR">ASLR</a> , <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B5%25D0%25B4%25D0%25BE%25D1%2582%25D0%25B2%25D1%2580%25D0%25B0%25D1%2589%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B2%25D1%258B%25D0%25BF%25D0%25BE%25D0%25BB%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25B4%25D0%25B0%25D0%25BD%25D0%25BD%25D1%258B%25D1%2585">DEP,</a> and so on.  This was made possible thanks to the support of turing-full scripting music files inside the player.  The vulnerability lies in the support of backward compatibility. <br><br>  The vulnerability is affected by Ubuntu of the old, still supported LTS version 12.04.5.  In subsequent versions, new glibc is used, and the exploit in the system no longer works. <br><a name="habracut"></a><br><h3>  What is a </h3><br>  The author of the analysis gives a screenshot of the exploit call. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/348/245/084/348245084eba460aaa39bb6bab947d58.png"><br><br>  The activation process takes place without initializing the infected file; to do this, just go to the folder with it. <br><br>  There is a bug in the sound decoder file <code>libgstnsf.so</code> from the <code>gstreamer-0.10</code> distribution, which is used in the system by default for all tasks related to sound.  Ubuntu 14.04 also has this decoder, but by default in most cases <code>gstreamer-1.0</code> . <br><br>  During the installation of Ubuntu, the system as if, by the way, asks if the user wants to work with mp3-files.  Many additional packages are installed after a positive response, including plugins from the Bad package - those that do not always please with quality: they do not have revisions of the code, maintainer, documentation, and so on. <br><br><h3>  How does the attack </h3><br>  An exploit abuses the vulnerability of the plugin to play NSF music files.  These audio tracks are not like the usual tracks played by a personal computer. <br><br>  NSF format files are played by the NES console processor emulator and real-time audio hardware.  In addition, inside the NSF file there may be a set of instructions.  To play it, the vulnerable audio player emulated a forty-year-old processor.  There are two players in the vulnerable version of Ubuntu, but there is no error in the second <code>libgme</code> . <br><br>  The <code>gstreamer</code> plugin creates a virtual 6502 processor hardware environment and plays music by running some of the code on the emulator.  It then reads the resulting values ‚Äã‚Äãfrom the virtual audio registers and renders audio samples based on them. <br><br>  The NES sound format is a music file standard that compresses NES game music for playback.  It contains the script language that is used to trigger the vulnerability.  When you open an NSF file on an infected Ubuntu system, it finds its way to the <code>libgstnsf.so</code> file through a music player and the gstreamer multimedia framework. <br><br>  <a href="">Those</a> interested in the example can download the audio file from Castlevania 2 <a href="">cv2.nsf</a> .  If your Linux supports this format, the sound is <code>totem cv2.nsf</code> by a command like <code>totem cv2.nsf</code> .  This tiny file of 17,264 bytes contains a small program - the samples will fit in this way.  If the system does not recognize this format, it will offer to download the missing plugin. <br><br>  The plugin works in the process of emulating a real 6502, as in NES for receiving output music and somewhere here there is a vulnerability.  So it's not just about multilayer backward compatibility for playing incomprehensible music file formats, but also emulating a program for eight-bit from the 1970s. <br><br>  What methods can use this vulnerability: <br><br><ul><li>  Forward exploit as an attachment to the letter.  If the victim downloads and opens files, his system is at risk.  Many Linux configurations do not know how to work with an NSF file - so you can rename it to mp3.  Most <code>gstreamer</code> based media players will ignore the file extension and apply automatic format detection to load the corresponding decoder to it. </li><li>  Partial <a href="https://en.wikipedia.org/wiki/Drive-by_download">drive-by download</a> .  Using, in some sense risky, downloading files through Google Chrome, it is possible to dump files into the downloads folder of the victim‚Äôs system when a user visits the ‚Äúwrong‚Äù web pages.  When the download directory is later opened by the file manager, the software tries to show icons to files with system-understandable extensions. </li><li>  Full drive-by download.  With a similar unsafe download through the Google Chrome browser, there is a way for a possible complete download-by-download.  Chris promised to tell about it in the next article of his <a href="https://scarybeastsecurity.blogspot.ru/">blog.</a> </li><li>  Attack based on USB drive.  If you open the USB flash drive in the file manager, it will again try to draw the file icons. </li></ul><br><h3>  Additional explanations </h3><br>  This exploit works equally well when launched in the following programs: <br><br><ul><li>  <a href="https://ru.wikipedia.org/wiki/Totem">Totem</a> </li><li>  <a href="https://ru.wikipedia.org/wiki/Rhythmbox">Rhythmbox</a> </li><li>  <a href="">gst-launch-0.10</a> </li><li>  <a href="https://ru.wikipedia.org/wiki/Nautilus_(%25D1%2584%25D0%25B0%25D0%25B9%25D0%25BB%25D0%25BE%25D0%25B2%25D1%258B%25D0%25B9_%25D0%25BC%25D0%25B5%25D0%25BD%25D0%25B5%25D0%25B4%25D0%25B6%25D0%25B5%25D1%2580)">Nautilus</a> (can run a subprocess) </li></ul><br>  Details are described in the relevant sections of <a href="https://scarybeastsecurity.blogspot.ru/2016/11/0day-exploit-compromising-linux-desktop.html">Chris's post</a> : an overview of the exploit itself, possible options for vulnerabilities, details of the exploit. <br><br>  He also writes that the error found is formally related to the 0-day vulnerabilities, but affects only the old Ubuntu 12.04, which was released in April 2012 and is a long-term support-version.  It <a href="https://en.wikipedia.org/wiki/Ubuntu_version_history">will be supported</a> until April 26, 2017.  The problem is rather minor than major.  The fact that it came through a 1975 processor remains funny. <br><br>  <b>PS The</b> vulnerability has already been <a href="http://changelogs.ubuntu.com/changelogs/pool/universe/g/gst-plugins-bad0.10/gst-plugins-bad0.10_0.10.23-7.2ubuntu1.2/changelog">fixed by</a> members of the Ubuntu team. </div><p>Source: <a href="https://habr.com/ru/post/315378/">https://habr.com/ru/post/315378/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315366/index.html">Replacing the help desk system. 8 universal tips on how to sabotage migration to a new solution</a></li>
<li><a href="../315368/index.html">Not ‚ÄúTanks‚Äù as one - we miss with benefit in DIY style</a></li>
<li><a href="../315370/index.html">Fast testing of 3CX for Linux on Oracle Virtualbox</a></li>
<li><a href="../315374/index.html">Where in Java problems with encodings and the possible reason of falling of a Martian probe emerge</a></li>
<li><a href="../315376/index.html">The vulnerability of Cryptsetup initialization scripts in Debian: just enough to hold Enter</a></li>
<li><a href="../315382/index.html">GraphQL CMS, the second version is already publicly available.</a></li>
<li><a href="../315384/index.html">Class for editing configuration files</a></li>
<li><a href="../315388/index.html">Hacker Record: Albert Gonzalez. 20 years in prison and 170 million stolen credit cards</a></li>
<li><a href="../315390/index.html">Dispel the myths that the founders do not respond with their property on debts LLC</a></li>
<li><a href="../315392/index.html">Development of dynamic REST services on document-oriented DB Bagri</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>