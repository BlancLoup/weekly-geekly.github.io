<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Emulation of a function call event</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About six months ago, I was asked a question like this: ‚ÄúI use a large framework that runs a certain function according to the user's action. I want, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Emulation of a function call event</h1><div class="post__text post__text-html js-mediator-article">  About six months ago, I was asked a question like this: ‚ÄúI use a large framework that runs a certain function according to the user's action.  I want, without changing the code of this function, to execute my code on the event of calling this function. ‚Äù.  The practice is far from the best, function call events do not exist, I just twisted my finger at my temple and said that this is a terrible govnokod, so it‚Äôs not worth doing, and this is simply not possible. <br><br>  A couple of days ago, heading home for a relatively warm winter evening, not typical for Odessa, I had an atypical thought: ‚ÄúWhat if I tried to do what Bogdan asked six months ago?‚Äù.  When I got home, I turned on the computer, and within a couple of minutes I did what I had in mind.  First of all, I was interested in how the built-in methods behave, if they are redefined, and whether it is possible after that to somehow call their previous state, which was before the redefinition.  I knew that if an object is redefined, then references to it will not be destroyed, keeping the same look.  As for the built-in functions, there were doubts.  It turns out you can. <br><br>  Most likely, I will never even have to use such a tool, but, purely hypothetically, it is possible that someone will have the task to trace the call of a function, having received a report on each call, consisting of: <br><ol><li>  The result of the execution </li><li>  Arguments passed </li><li>  Call context (what is this when called) </li><li>  The number of function calls after creating the handler </li></ol><br>  (This list fully corresponds to the arguments passed to the handler.) <br><a name="habracut"></a><br><pre><code class="javascript hljs">addCallListener = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">func, callback</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> callNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = [].slice.call(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { result = func.apply(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); callNumber++; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (e) { callback(e, args, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, callNumber); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> e; } callback(result, args, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, callNumber); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Very simple and short, right? <br><br>  Then, override any function as follows: <br><br><pre> <code class="javascript hljs">someFunct = addCallListener(someFunct, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result, args, self, callNumber</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Do Something }); //  Constructor.prototype.method = addCallListener(Constructor.prototype.method, function(result, args, self, callNumber){ //Do Something });</span></span></code> </pre><br><br>  Obviously, it should be ‚Äúvisible‚Äù in the part of the code where it occurs. <br><br><h5>  A few examples </h5>  To run the examples, you must have an open console (in chrome, it is called by Ctrl + Shift + i). <br><br>  Animation tracking: <br>  <a href="http://jsfiddle.net/finom/DnRD8/">jsfiddle.net/finom/DnRD8</a> <br>  Push method execution event in array: <br>  <a href="http://jsfiddle.net/finom/bbHhH/1/">jsfiddle.net/finom/bbHhH/1</a> <br>  Event of execution of some other function: <br>  <a href="http://jsfiddle.net/finom/ah5My/3/">jsfiddle.net/finom/ah5My/3</a> <br><br>  The End. <br><br>  Thanks comrades from the forum javascript.ru for criticism and additions. <br><br>  UPD <br>  Slightly expanded the function: now instead of one callback, the second argument is an object <br><ol><li>  before (called before the function starts) </li><li>  success (called if the function completed successfully) </li><li>  error (if an error occurred) </li><li>  after (called in any case, regardless of the success of the execution) </li></ol><br>  An object is passed to each handler. <br><ol><li>  args </li><li>  self (context) </li><li>  name (function name) </li><li>  status ("error" or "success") </li><li>  successNumber (number of successful calls) </li><li>  errorNumber (the number of calls with an error) </li><li>  result (result if any) </li><li>  error (error if any) </li></ol><br>  In addition, the addCallListener function is now part of the Function constructor object, to avoid getting into a window or process. <br><br>  Fork and potest can here: <a href="http://jsfiddle.net/finom/SGhzd/5/">jsfiddle.net/finom/SGhzd/5</a> </div><p>Source: <a href="https://habr.com/ru/post/135001/">https://habr.com/ru/post/135001/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../134996/index.html">Happy New Year!</a></li>
<li><a href="../134997/index.html">About CMS, competition and development</a></li>
<li><a href="../134998/index.html">What is artificial neural networks?</a></li>
<li><a href="../134999/index.html">Critical vulnerability Windows 7 x64: BSOD and system compromise</a></li>
<li><a href="../135000/index.html">Scalaxy problems</a></li>
<li><a href="../135004/index.html">Electronic multimedia reader for Lexand LT-115 and Lexand LT-117</a></li>
<li><a href="../135005/index.html">Pre-ordered PS Vita in Russia</a></li>
<li><a href="../135006/index.html">HTC Lost Apple Trial</a></li>
<li><a href="../135007/index.html">And after the top even the flood</a></li>
<li><a href="../135009/index.html">Business Intelligence (BI Part 2). The era of knowledge and business strategy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>