<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Moscow region under Probkoskom</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Based on the Yandex.Traffic service, we drew beautiful moving pictures on the map of the Moscow region. In our Probkoskop (tm) you can see what the tr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Moscow region under Probkoskom</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/files/a7b/c8f/561/a7bc8f5613f84bf5aedfc35ae5ff649e.gif"><br>  Based on the Yandex.Traffic service, we <a href="http://probkoscope.ru/">drew</a> beautiful moving pictures on the map of the Moscow region.  In our Probkoskop (tm) you can see what the traffic situation for the week looks like in the Moscow region as a whole and for each specific point in a square 200 x 200 km around Moscow. <br><br><a name="habracut"></a><br><br>  Wise Yandex taught us to learn about traffic jams when we hit the road. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But what if we want to find a place free from traffic jams on the map?  Or almost free.  Or to see how difficult it is to get to where it is offered to us to buy a summer cottage near Moscow.  Or choose the best day when you can go to visit your grandmother in the village of Durnyha or your aunt in the village of Chulkovo-Club.  Now on Yandex.Traffic the way there looks good, and what happens on Friday night?  On Sunday? <br><br>  To do this, look at the map of the Moscow region a little from a different angle.  And this will help us Probkoskop. <br><br>  We mapped the color of the distance in time from the center of Moscow.  Taking into account traffic jams, at different times of the day, on different days of the week.  And that's what happened with us: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ae2/979/e0c/ae2979e0c4a44ac5b9c5d78c54b65ada.jpeg"></div><br><br>  To get the initial data, we simply asked Yandex how long it would take on the road from the center of Moscow to each point on the map, and painted each point in the corresponding color.  Of course, if we asked 10,000 routes from Yandex (namely, we painted so many points on the map), we would have been banned long ago.  We acted somewhat more cautiously: on every highway going from Moscow, we dotted every 10 kilometers.  Then they politely asked the Yandex.Maps API to build a route 120 km from the center of Moscow through these points and carefully noted how long the road between these points would take. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a02/e77/576/a02e775765d7471fafbeaa54a807ef01.jpeg"></div><br><br>  But if we showed only the reference points (one for every 10 km of main highways from Moscow), the picture would be extremely boring.  So we still needed to find out how long it took to get to each of the 10 thousand points of the considered square. <br><br>  We take points, one after another.  For each, we look for three nearest reference points in the database (of those that were initially placed 10 km along each highway).  According to the graph of roads from OSM, we consider the distance from this point to each of the three reference points.  The OSM column shows the maximum speed on each edge-road.  We believe that from the reference point to the desired one can be reached without traffic jams (bold, but acceptable simplification).  Of the three options (the time on Yandex to the reference point + the time on OSM from it to the point in question) we find the best one and put it on the map.  And so 10 thousand times.  Now, of course, it is interesting to look at it in dynamics.  Well, the hypnotic picture of the "breathing" of the Moscow region traffic jams, resulting in: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a0d/12c/857/a0d12c857e3f436ebd8e65606553777f.gif"></div><br><br>  What we used to build such beautiful images: <br><br><ul><li>  Beloved Yandex.Maps API, </li><li>  Remarkable JavaScript-library for displaying data and maps - Leaflet, </li><li>  Wonderful map rendering server - Mapnik, </li><li>  PostgreSQL as storage, </li><li>  Backend - Django, </li><li>  Data - OSM. </li></ul><br><br>  We also made it possible to see the ‚ÄúCork profile‚Äù of each point of our suburban square. <br><br><h4>  Sergiev Posad </h4><h4><div style="text-align:center;"><img src="https://habrastorage.org/files/7a2/0b2/0b1/7a20b20b11754b0bae3d9ec7fd3b3b8f.jpeg"></div><br><br></h4><h4>  Dmitrov - an accident on Monday </h4><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/169/90f/b47/16990fb478a940109fc27226147c116d.jpeg"></div><br><br><h4>  Volokolamsk </h4><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9eb/a6f/bbf/9eba6fbbf1a44f26b3cf0303b35930e2.jpeg"></div><br><br>  What we want to do more.  Pictures showing the time to go to the center (now shows the time to go from the center of Moscow). <br>  Draw similar pictures and collect data for other cities (if users are interested). <br>  Show more extensive statistics for the point, and not just for the last few weeks. <br><br>  You can try it yourself on the <a href="http://probkoscope.ru/">site</a> created by us.  Your comments? </div><p>Source: <a href="https://habr.com/ru/post/241624/">https://habr.com/ru/post/241624/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../241614/index.html">Conference on AR Augmented Reality Technologies</a></li>
<li><a href="../241616/index.html">New features of Veeam Backup & Replication 8.0: improved replication</a></li>
<li><a href="../241618/index.html">25 ways to build a comprehensive snippet</a></li>
<li><a href="../241620/index.html">Thesis project or build Hexapod with your hands</a></li>
<li><a href="../241622/index.html">"Finishing" Asterisk CDR Viewer for yourself</a></li>
<li><a href="../241626/index.html">Our electronics: the top 10 developments of the company Promwad</a></li>
<li><a href="../241628/index.html">How much do you need to eat pizza to create a service for students</a></li>
<li><a href="../241630/index.html">Once again about the study and work of an IT person in Germany</a></li>
<li><a href="../241632/index.html">Inheritance of combinatorial parsers on Julia</a></li>
<li><a href="../241636/index.html">The history of virtualization: The rapid development at the turn of the millennia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>