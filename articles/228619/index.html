<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Live Windows Phone Tiles</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For the impatient, the discussion deals with the dynamic generation of background images for live tiles, the creation of transparent tiles for update ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Live Windows Phone Tiles</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/270/f84/dd3/270f84dd381066ca1e1b58872a050b83.png"><br>  For the impatient, the discussion deals with the dynamic generation of background images for live tiles, the creation of transparent tiles for update 8.1 and the localization of application names. <br><a name="habracut"></a><br><br clear="all"><h4>  More informative live tile </h4><br>  Developing the next application, it became necessary to display a sufficiently large amount of data directly on the living tile. <br>  Although there are already <a href="http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202948(v%3Dvs.105).aspx">three standard templates</a> , they were not enough to implement some ideas.  Asking Google about the flexibility of text formatting on tiles, it turned out that at the moment this is not possible. <br>  But, as a result of the search for a solution, the original approach of other developers was quite often met - if you cannot display formatted text on a tile, then this text can be shown with a picture.  With this approach it is possible to display anything on a tile, arbitrarily with any complexity of the markup. <br><br>  First of all, you need to know what image sizes we need.  Actually, the <a href="http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202948(v%3Dvs.105).aspx">dimensions in pixels</a> are listed on the website for developers.  It is this size that background images will need to be generated on the fly when updating data. <br><br>  The process of generating the background image itself is not very complicated. <br><div class="spoiler">  <b class="spoiler_title">Code example</b> <div class="spoiler_text"><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.IO.IsolatedStorage; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Controls; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Media; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Media.Imaging; namespace Example.Common { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> TileImage { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static Uri Render( String title, string row1, <span class="hljs-type"><span class="hljs-type">bool</span></span> row1Bold, <span class="hljs-type"><span class="hljs-type">bool</span></span> row1Italic, string row2, <span class="hljs-type"><span class="hljs-type">bool</span></span> row2Bold, <span class="hljs-type"><span class="hljs-type">bool</span></span> row2Italic) { var bitmap = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> WriteableBitmap(Constants.TileWidth, Constants.TileHeight); var canvas = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Grid { Width = bitmap.PixelWidth, Height = bitmap.PixelHeight }; var background = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Canvas { Height = bitmap.PixelHeight, Width = bitmap.PixelWidth, Background = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SolidColorBrush(Constants.TileBackgroundColor) }; #region title var titleBlock = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> TextBlock { <span class="hljs-type"><span class="hljs-type">Text</span></span> = title, FontWeight = FontWeights.Bold, TextAlignment = TextAlignment.Left, VerticalAlignment = VerticalAlignment.Stretch, Margin = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Thickness(Constants.TilePadding), TextWrapping = TextWrapping.NoWrap, Foreground = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SolidColorBrush(Constants.TileForegroundColor), FontSize = Constants.TileTitleFontSize, Width = bitmap.PixelWidth - Constants.TilePadding * <span class="hljs-number"><span class="hljs-number">2</span></span> }; #endregion #region first <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> var firstRowBlock = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> TextBlock { <span class="hljs-type"><span class="hljs-type">Text</span></span> = row1, TextAlignment = TextAlignment.Left, VerticalAlignment = VerticalAlignment.Stretch, Margin = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Thickness(Constants.TilePadding, Constants.TilePadding * <span class="hljs-number"><span class="hljs-number">2</span></span> + Constants.TileTitleFontSize, Constants.TilePadding, Constants.TilePadding), TextWrapping = TextWrapping.NoWrap, Foreground = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SolidColorBrush(Constants.TileForegroundColor), FontSize = Constants.TileTextFontSize, Width = bitmap.PixelWidth - Constants.TilePadding * <span class="hljs-number"><span class="hljs-number">2</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (row1Bold) { firstRowBlock.FontWeight = FontWeights.Bold; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (row1Italic) { firstRowBlock.FontStyle = FontStyles.Italic; } #endregion #region second <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> var secondRowBlock = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> TextBlock { <span class="hljs-type"><span class="hljs-type">Text</span></span> = row2, TextAlignment = TextAlignment.Left, VerticalAlignment = VerticalAlignment.Stretch, Margin = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Thickness(Constants.TilePadding, Constants.TilePadding * <span class="hljs-number"><span class="hljs-number">3</span></span> + Constants.TileTitleFontSize + Constants.TileTextFontSize, Constants.TilePadding, Constants.TilePadding), TextWrapping = TextWrapping.Wrap, Foreground = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> SolidColorBrush(Constants.TileForegroundColor), FontSize = Constants.TileTextFontSize, Width = bitmap.PixelWidth - Constants.TilePadding * <span class="hljs-number"><span class="hljs-number">2</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (row2Bold) { secondRowBlock.FontWeight = FontWeights.Bold; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (row2Italic) { secondRowBlock.FontStyle = FontStyles.Italic; } #endregion canvas.Children.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(titleBlock); canvas.Children.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(firstRowBlock); canvas.Children.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(secondRowBlock); bitmap.Render(background, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); bitmap.Render(canvas, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); bitmap.Invalidate(); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> (var imageStream = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> IsolatedStorageFileStream(Constants.TilePath, FileMode.<span class="hljs-keyword"><span class="hljs-keyword">Create</span></span>, Constants.AppStorage)) { bitmap.SaveJpeg(imageStream,bitmap.PixelWidth,bitmap.PixelHeight,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">90</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Uri("isostore:" + Constants.TilePath, UriKind.Absolute); } } }</code> </pre> <br></div></div><br>  Simply put, a canvas is created on which arbitrary elements are thrown at and saved as a JPG file in the local storage. <br>  Now, it‚Äôs easy to use a file from your local storage as a background for a tile. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      From the example it can be seen that the small tile looks unchanged, but the tile of medium size already uses the generated image: <br><img src="https://habrastorage.org/getpro/habr/post_images/d25/da4/43d/d25da443d99f64494a86223504984324.png"><br><br>  You can also generate images for other tile sizes.  For example, in small you can show the basic information in abbreviated form, in the middle a little more space and you can add more data, well, on the broad one can of course not save money, but you still need to have everything as convenient as possible. <br>  An example of this approach can be seen in the image in the title of the article. <br><br><h4>  And now transparent! </h4><br>  As many know, soon our Windows Phone will be updated to the new version 8.1.  We need to prepare for this. <br>  One of the innovations of the update is the ability to add a background image to the start screen.  In order for our tile to comply with new trends and not obscure the background of the desktop, you need to make the background image of the tile transparent. <br><br>  Here we have a small unpleasant surprise - the image can only be saved in JPG format.  Colleagues from Microsoft for some reason decided that this would be enough.  Well, you have to reinvent the wheel. <br><br>  In my work, I am always sure that someone faced such problems before me and, very often, I am right.  This case is no exception.  On the vast expanses of the Internet, or rather on ToolStack, there was a ready-made library <a href="http://toolstack.com/libraries/pngwriter">PNGWriter</a> , which allows you to generate PNG. <br><br>  The use of the library is extremely simple; it simply adds the WritePNG method to the WriteableBitmap class: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bitmap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WriteableBitmap(Constants.TileWidth, Constants.TileHeight); bitmap.WritePNG(imageStream);</code> </pre><br>  The principle of application remains the same - we save the image in the local storage and use it as a background for the live tile.  For WP8.0, the tile will have the theme color, but in the new WP8.1, the background of the start screen will be visible through the tile. <br><br>  The result will be very interesting.  The background will be viewed through the tile, and the parallax effect will appear when scrolling the start screen: <br><img src="https://habrastorage.org/getpro/habr/post_images/869/a1c/339/869a1c339a981c50f93f502e474c8d2a.png"><br><br><h4>  Localization of the application name </h4><br>  For applications that do not have a specific brand or easily recognizable name, localization of the name may be necessary.  It is logical that there is no need to translate ‚ÄúSkype‚Äù or ‚ÄúWhatsApp‚Äù, but functional names, for example, ‚Äúflashlight‚Äù, ‚Äúcamera‚Äù should be localized. <br><br>  The task of localizing the name of the application may seem to be not trivial for an ordinary developer.  But the instruction how to do this is written in great detail and, in fact, everything is much simpler. <br><br>  I do not want to repeat the <a href="http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff967550(v%3Dvs.105).aspx">entire text of the instructions from the Microsoft site</a> .  I want to dwell only on small changes that seem to simplify the localization process. <br><br>  Microsoft recommends creating one project to generate all localized DLLs.  It seemed to me a bit dreary to constantly rename, copy the created DLL file.  Therefore, I created several projects for each localization that my application will support.  And in each project I set up deployment at once to the root of the Windows Phone project. <br>  For this, the path to the folder of the collected DLL file was slightly modified. <br>  For the default locale: <br><img src="https://habrastorage.org/getpro/habr/post_images/02c/b11/bd8/02cb11bd8997788f9bc8cba54f13eb12.png"><br><br>  For all other locales (the number in the Target Name corresponds to the locale number): <br><img src="https://habrastorage.org/getpro/habr/post_images/b0f/dae/c89/b0fdaec891194e84bac2f81bcddc7a45.png"><br><br>  Now you can safely change the values ‚Äã‚Äãin the resource tables.  Each time you build a Windows Phone project, DLL files with localization will first be assembled and replace the outdated ones in the root of the main project.  Thus, we avoid manipulating the transfer of DLL files to manual. <br><br>  The text of the application name in the phone list will depend on the locale specified in the phone.  In my example, it will look like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/739/af9/792/739af9792108d059a30431a565a2f48b.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/244/f1c/d5b/244f1cd5b276ea6525396078787ffedf.png"><br><br>  It is also worth noting that when publishing an application to the Marketplace, it became possible to specify alternative names for the application.  It would be logical to add all localized names there. <br><br><h4>  Conclusion </h4><br>  Using such simple approaches, the application will become more convenient and interesting. <br>  Let's hope that Microsoft will continue to develop the development environment and capabilities of the Windows Phone API and in new versions we will not have to reinvent such bikes. <br><br>  Enjoyable development. <br><br>  Download the finished project and get acquainted with the code on GitHub: <br>  <a href="https://github.com/vbilenko/WPExample01">https://github.com/vbilenko/WPExample01</a> <br><br>  List of links: <br><ul><li>  <a href="https://github.com/vbilenko/WPExample01">The project for an example on GitHub</a> </li><li>  <a href="http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202948(v%3Dvs.105).aspx">Tiles for Windows Phone 8</a> </li><li>  <a href="http://msdn.microsoft.com/en-us/library/windowsphone/design/jj662924(v%3Dvs.105).aspx">Iconic Tile template design guidelines for Windows Phone</a> </li><li>  <a href="http://toolstack.com/libraries/pngwriter">ToolStack C # PNG Writer Library</a> </li><li>  <a href="http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff967550(v%3Dvs.105).aspx">How to localize an app title for Windows Phone 8</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/228619/">https://habr.com/ru/post/228619/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../228605/index.html">BOOTSTRA.386: The theme for the Bootstrap in the spirit of the 1980s</a></li>
<li><a href="../228607/index.html">Writing a bot for an online JavaScript game using AOP</a></li>
<li><a href="../228609/index.html">"The effect of empty space" or the luxury of nothing</a></li>
<li><a href="../228613/index.html">Russian Post plans to develop an application for iOS and Android</a></li>
<li><a href="../228617/index.html">Legal Clickjacking VKontakte</a></li>
<li><a href="../228623/index.html">Paid subscriptions and paid content services of mobile operators</a></li>
<li><a href="../228625/index.html">NASA Flying Jet Observatory</a></li>
<li><a href="../228627/index.html">Go Digest: June 2014</a></li>
<li><a href="../228629/index.html">Introduction to the PHP messaging services</a></li>
<li><a href="../228631/index.html">History of portable game consoles. Part 1.1 (1990s)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>