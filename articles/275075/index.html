<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attack on Linux users or how to build a botnet by admins</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For the purity of the experiment, I propose to follow the link and follow the specified instruction ‚Äúinstallation of useful packages‚Äù. Instructions fo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attack on Linux users or how to build a botnet by admins</h1><div class="post__text post__text-html js-mediator-article">  For the purity of the experiment, I propose to follow the <a href="http://sli.su/linux_copy/index.html">link</a> and follow the specified instruction ‚Äúinstallation of useful packages‚Äù.  Instructions for Ubuntu owners. <br><br>  The link is just a "demonstration" of this type of attack, but in any case, these actions are best done at the virtual <s>ground</s> . <br><br>  Below is a description of what happened in the event that you are not too lazy to perform the above actions. <br><a name="habracut"></a><br>  A small preface: it often happens that when working with manuals for setting up a server, it is too lazy to enter all the commands manually, especially long ones.  Also, most console applications ignore the insertion of a line feed and simply execute the code instantly. <br>  What if, when copying the code on the page, to substitute it in such a way that, when inserted into the console, the necessary commands are automatically executed, and the only nuance is how to hide the bad code from the user's eyes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result, the following thought came: <br>  1. We ask the user to increase the privileges to the root, which seems to be quite logical, given the further installation of packages. <br>  2. We write a long command, thereby forcing the user to copy (just copy and not enter the code by hand). <br>  3. When copying - the clipboard is replaced by a bunch of commands needed for the attack.  Namely: <br><pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> +o <span class="hljs-built_in"><span class="hljs-built_in">history</span></span> &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'echo you hacked!'</span></span> &gt; /tmp/test.sh &amp;&amp; chmod +x /tmp/test.sh &amp;&amp; /tmp/test.sh &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">"\033c"</span></span> &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> -o <span class="hljs-built_in"><span class="hljs-built_in">history</span></span> sudo su apt-get update &amp;&amp; apt-get install mc &amp;&amp; apt-get install vim &amp;&amp; apt-get install htop &amp;&amp; apt-get install man</code> </pre> <br><br>  Parsing the first line: <br>  1. Turn off the history of entered commands <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> +o <span class="hljs-built_in"><span class="hljs-built_in">history</span></span></code> </pre><br>  2. The actual creation and execution of malicious code <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'echo you hacked!'</span></span> &gt; /tmp/test.sh &amp;&amp; chmod +x /tmp/test.sh &amp;&amp; /tmp/test.sh</code> </pre><br>  3. Cleaning the console screen (you can and clear) <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span> <span class="hljs-string"><span class="hljs-string">"\033c"</span></span></code> </pre><br>  4. Turn back the story <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> -o <span class="hljs-built_in"><span class="hljs-built_in">history</span></span></code> </pre><br><br>  The second line is a record in the history of the command entered earlier. <br>  And the actual payload code. <br>  As a result (depending on the console used), if you paste the copied code directly into the console, unwanted commands will be executed that will not appear in the history and on the screen. <br><br>  <b>If everything went as it should - at the address /tmp/test.sh there will be a ‚Äúmalware‚Äù, which was successfully executed at the time of inserting the code into the console.</b> <br><br>  In general, use terminals that warn you about inserting code with line breaks and do not mindlessly insert code from unverified sources.  For Windows, there is ConEmu, which warns about the insertion of such code. <br><br>  <b>PS The above example is just my guess about a possible problem.</b>  <b>In practice, this is not encountered.</b> <b><br></b>  <b>The article was written only to warn users about this, quite possible vector of attack.</b> <br><br>  <b>UPD.</b>  <b>Thanks to <a href="http://habrahabr.ru/users/valdikss/" class="user_link">ValdikSS</a> for the tip <a href="https://thejh.net/misc/website-terminal-copy-paste">thejh.net/misc/website-terminal-copy-paste</a> .</b>  <b>Updated example.</b> <br><br>  I would also like to hear the opinions of users, how much is the real threat in practice.  And did you notice the execution of the code after inserting the copied command into the console. </div><p>Source: <a href="https://habr.com/ru/post/275075/">https://habr.com/ru/post/275075/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275063/index.html">Where the Pixie Unicorn lives. Indie storytelling</a></li>
<li><a href="../275065/index.html">Yii 1.1.17</a></li>
<li><a href="../275069/index.html">What is faster: 0 or NULL?</a></li>
<li><a href="../275071/index.html">How students become advanced programmers</a></li>
<li><a href="../275073/index.html">Problems with Sandbox when installing Vivaldi in a non-standard directory</a></li>
<li><a href="../275081/index.html">What's going on in the development of corporate mobile applications</a></li>
<li><a href="../275083/index.html">Building and using Mosquitto MQTT on Intel Edison</a></li>
<li><a href="../275085/index.html">What to choose: PaaS and IaaS</a></li>
<li><a href="../275087/index.html">DevCon Secrets # 2. How the conference grid is formed</a></li>
<li><a href="../275089/index.html">WhatsApp will allow users to check messages using a QR code</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>