<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>[Homebrew] web honeypot do it yourself</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the article ‚ÄúWhat and why are we looking for on the sites‚Äú bots of the dark side of power ‚Äù,‚Äù we reviewed typical examples from magazines of variou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>[Homebrew] web honeypot do it yourself</h1><div class="post__text post__text-html js-mediator-article">  In the article <a href="http://habrahabr.ru/post/250313/">‚ÄúWhat and why are we looking for on the sites‚Äú bots of the dark side of power ‚Äù,‚Äù</a> we reviewed typical examples from magazines of various sites.  However, a much more interesting variation on the subject of a <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D0%25B4%25D0%25B8%25D0%25BE%25D0%25B8%25D0%25B3%25D1%2580%25D0%25B0%2520(%25D1%2580%25D0%25B0%25D0%25B7%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25BA%25D0%25B0)">radio game in intelligence</a> .  What it is and how to cook it - I will tell further. <br><br><a name="habracut"></a><br>  We list the main provisions.  If you disagree with them, it is better not to waste your time and read on. <br><br>  So, the main provisions: <br><ul><li>  you are fond of information security, web administration or study on relevant specialties; </li><li>  you have a little desire, time and resources that you can spend to feel like an explorer; </li><li>  You do not expect to immediately become a super guru, but by developing the particular solutions suggested in the article, you can study some issues with interest. </li></ul><br>  Honeypot, in short, is a kind of trap with which the researcher collects material.  Information on varieties, existing solutions, incl.  OpenSource, easy to find on the network, so we will not dwell on them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's get to the bottom: <br><ul><li>  we take hosting; </li><li>  we take the domain; </li><li>  wrap up all incoming requests to your script; </li><li>  We analyze incoming requests and, in addition to accumulating statistics, join the game. </li></ul><br><h4>  We take hosting </h4><br>  You need to decide on the site where our honeypot will be located.  To reduce the threshold of entry, choose shared-hosting, because  this eliminates system administration issues (installation, optimal configuration, protection and updates) quickly and reasonably cheaply.  Servers (IP ranges of web servers) hosting companies are known and never complain about the lack of attention from the bots. <br><br>  Those interested can immediately take up the VPS / VDS, most importantly, do not get stuck at the server setup. <br><br><h4>  We take the domain </h4><br>  The new domain, as a rule, immediately attracts the attention of bots, although the ‚Äúold‚Äù domains are also excellent.  If you use a valid domain (site), then there may be side effects due to possible redirection errors or excessive load. <br><br>  According to rough estimates, at the beginning of 2015 a new domain and several months of hosting will cost 1000 rubles. <br><br><h4>  Wrap up all incoming requests to your script. </h4><br>  There are a lot of solutions for this task, depending on the web server used and the level of influence on the server settings.  The proposed simplest option is suitable for a new domain.  This does not interfere with the main business and allows us to move quickly to the most interesting, in our opinion. <br><br><div class="spoiler">  <b class="spoiler_title">the simplest option .htaccess</b> <div class="spoiler_text"><pre><code class="hljs apache"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteEngine</span></span></span></span> <span class="hljs-literal"><span class="hljs-literal">On</span></span> RewriteRule .* index.php<span class="hljs-meta"><span class="hljs-meta"> [L]</span></span></code> </pre> <br>  All requests are wrapped in index.php. <br><br>  To fine-tune the redirects, especially for the current site, you need not be lazy and refer to the documentation or articles, for example, <a href="http://habrahabr.ru/company/sprinthost/blog/129560/">‚ÄúHow mod_rewrite actually works.</a>  <a href="http://habrahabr.ru/company/sprinthost/blog/129560/">Allowance for continuing</a> . <br></div></div><br><h4>  We analyze incoming requests, accumulate statistics </h4><br>  In the script, which wraps requests, we implement the following functionality: <br><br><ul><li>  journaling some data from <a href="https://php.net/manual/ru/reserved.variables.server.php">$ _SERVER</a> to accumulate statistics; </li><li>  the ability to search patterns (patterns) in the incoming data from $ _SERVER; </li><li>  an effective mechanism for connecting handlers for some templates (for efficiency, see the <a href="http://habrahabr.ru/post/250985/">non-standard optimization of PHP projects</a> ); </li><li>  (for the future) a simplified and resource-intensive server-side session mechanism. </li></ul><br><h4>  Join the game </h4><br>  Finally, we came to the main point.  What will be the game? <br><br>  After analyzing the statistics, you choose the bot that you want to explore.  You can try to identify the bot by various signs (IP ranges, scan time, User-Agent, specific URL requests, etc.). <br><br>  After that, you disguise yourself as a bot and, giving him the information and files he expects, fully describe his behavior from scanning to attempts to use exploits, non-standard calls, downloading specific files, etc. <br><br>  For example, a bot expects some css file ‚Äî get it, after that it tries to access a specific file ‚Äî look for information about it on the network and output it, sends parameters ‚Äî we try to fake the answer, etc.  Here just lightweight implementation of sessions is useful. <br><br>  Of course, between the first call and the construction of the whole chain of answers, several iterations can be performed with elements of guessing and manual information retrieval.  But this is a mind battle (you are a &lt;-&gt; bot algorithm developer), real chess! <br><br><div class="spoiler">  <b class="spoiler_title">a little hint</b> <div class="spoiler_text">  To make it more difficult for bots to identify your analysis, it is advisable (within reasonable limits) to use the element of randomness when issuing results.  Namely, your algorithm does not yet know the ‚Äúcorrect answer‚Äù for the bot or the request has not been met before - issue a message simulating a server error or an empty file with a XX% probability, try SQL-injection ‚Äî issue a plausible error message from the DBMS or PHP, etc. . <br></div></div><br><h4>  Instead of conclusion </h4><br>  Dare!  And let your work be a blessing. <br><br>  Warning proposals immediately put the finished code (why it is not done): <br><ul><li>  so as not to hinder the flight of fantasy; </li><li>  so that students of specialized specialties / departments "do not copy and paste" (hello to the KSIMU at TSU); </li><li>  so as not to facilitate the task to bot-eaters, who will immediately cut off novice researchers in the process of testing the proposed (if it were) code article. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/250573/">https://habr.com/ru/post/250573/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../250557/index.html">Practical programming of artificial intelligence</a></li>
<li><a href="../250561/index.html">Change postal codes for three-word addresses using reverse geocoding</a></li>
<li><a href="../250565/index.html">VirusTotal will track false positive</a></li>
<li><a href="../250569/index.html">Nice build frontend project</a></li>
<li><a href="../250571/index.html">RIG exploit kit exploit source code leaked to network</a></li>
<li><a href="../250577/index.html">Rust 1.0: current state and final release schedule</a></li>
<li><a href="../250579/index.html">Got access to iPhone diagnostic console</a></li>
<li><a href="../250581/index.html">RefluxJS - an alternative look at Flux architecture from Facebook</a></li>
<li><a href="../250583/index.html">What version of java are you using?</a></li>
<li><a href="../250585/index.html">The challenge of 64 coins, two prisoners and one chessboard</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>