<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Musical programmable school bell "Schoolboy-3"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Since I changed the platform for the school bell, I post the source code of the previous project ‚ÄúSchoolboy-3‚Äù. Immediately I explain that I did not p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Musical programmable school bell "Schoolboy-3"</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/f7c/d73/86f/f7cd7386f7dfb154d2438dc25406a700.png"><br><br>  Since I <a href="http://habrahabr.ru/post/228479/">changed the platform</a> for the school bell, I post the source code of the previous project ‚ÄúSchoolboy-3‚Äù.  Immediately I explain that I did not plan to distribute the source code somewhere other than Russia, therefore almost all the code is written in Russian.  This may seem funny to someone, do not judge strictly, it was easier for me to write code like that. <br><a name="habracut"></a><br><h4>  A bit of history </h4><br>  ‚ÄúSchoolboy-3‚Äù is a programmable music call based on a cheap cell phone with Java support.  The idea came to me in general by chance, when I thought about replacing the previous version of the school bell ‚ÄúSchoolboy-2‚Äù.  He was quite primitive, because  was assembled on the AVR microcontroller of the Mega series with a small strapping and a two-line display. <br><br>  The problem was that it was homemade.  Since it commutes with the fire warning system, the iron must have a certificate of conformity, i.e.  pass the test, it takes time, money.  I wanted to get around this point, but for this you need a ready-made iron, which would be suitable for functionality and would be cheap.  So, returning home once, I paid attention to my mobile phone.  Why not?  It also contains everything you need just for this application.  I even felt uneasy at the thought that such an idea had never occurred to anyone before, and I did a review and knew what other school bell systems were built on. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There was really one problem, I had never come across Java so closely and even more so, I didn‚Äôt write midlets.  It was not clear how the concrete implementation of the java-machine will behave when operating in continuous mode.  I also did not solve the problem of signing the midlet.  In general, I am surprised by the situation that I have to pay something else (regularly) in order to exploit the mobile phone at my discretion. <br><br>  Putting aside the signing problem for the time being, I began to search for the cheapest and most convenient phone for experiments.  It was necessary to coincide so much that at this time there was a simple Fly MC150DS running.  Of all its useful properties, the main criterion for his choice was the absence of the need to sign the midlet.  It looked strange against the background of all other devices of other firms, where people on the forums did not think of anything in order to circumvent this requirement. <br><br>  The next step was to verify the fundamental possibility of using the phone as an automated system.  Here I was waiting for one "wonderful" surprise, which almost spoiled all the beauty and simplicity of the idea.  Having loaded my development environment, docks, etc., I managed to sketch a somehow working engine that formed the schedule for the tasks (playing the melody).  As soon as I managed to test the work of the engine during the day, I turned to the school with the request of experimental tests.  Unlike the previous version, now you could play mp3-files and potentially do so many other things, because  The phone is essentially a small PC. <br><br>  After several days of testing, a very strange behavior of time was found.  I could not believe in the results, rechecking them for days - the application braked for 20 seconds every day.  It looked unreal because  I figured the clock on the phone was accurate.  But the fact remained a fact - 20 seconds difference came from somewhere.  It was only half the trouble, the second part was that you cannot correct the time in the phone from the MIDlet.  You can read it, but adjust it - no.  It baffled me.  The most important feature of automated call submission is the exact time of their submission, and I have some kind of simply unknown creepy cant in this place. <br><br>  When I walked away from the shock (so much time was spent on an empty idea), I noticed that the time inside the MIDlet is different from the time on the phone, i.e.  in fact, a time ‚Äústream‚Äù of its own is created inside the midlet.  Perhaps it was not interested in game developers, because  For days on the phone, no one plays, but in my case this led to an accumulation of error in the countdown.  I didn‚Äôt understand what exactly was going on inside a particular java-machine implementation, but for myself I understood it that way.  When loading, the java-machine initializes an internal time counter from the system clock, the thread that is responsible for counting time in the process of operation slows down and therefore counts the time incorrectly, which affects the returned Date () values. <br><br>  What to do?  Only one thing occurred to me - to keep track of the time in my program and adjust the tasks for the timers, depending on the correction that has run over the entire period of operation.  Honestly, I myself after several years do not know exactly how it works for me, but it works.  Every day at midnight, a packet of calls is formed, and the time is adjusted, where the delta is calculated as the product of the days that have passed since the beginning of work and the discrepancy in one day.  This daily discrepancy is determined empirically by the test results.  The method, of course, is crooked, but such a phone call worked for a total of three years, until the power connector (micro-usb) <s>cable</s> fell off and the phone was not stolen. <br><br><h4>  about the project </h4><br>  A detailed description of working with the program can be found in the User Guide, which I attached below.  I collected the sources on github the last time it seems in NetBeans 8. You can fully test the work of the MIDlet on the emulator.  To do this, you need to collect the debug version by specifying the value in the main.java file: <br><br><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//      . static final public boolean _ = true;</span></span></code> </pre> <br>  In this case, you need to put the folder Melodies with github in the root of the file system.  There are both melodies themselves and configuration files.  Perhaps in the Settings.txt file you will need to change the paths to local ones for the emulator, I don‚Äôt remember exactly.  See how it works under the debugger. <br><br>  The program also uses the microlog module, which keeps very detailed statistics on what is being done in the midlet.  At the same time, the file microlog.txt is created in the same folder with the melodies, where you can look at the user's actions or errors that occur during the work.  It is very convenient. <br><br>  Maybe my project will push someone to any ideas on using a mobile phone.  It is a pity that so much computational good is thrown into the dustbin of history every year, and yet they could serve and serve people, grinding nil and odinichki. <br><br><h4>  Links </h4><br>  1. <a href="https://github.com/ViacheslavMezentsev/j2mebell">Sources on github</a> . <br>  2. <a href="https://yadi.sk/i/pruAv3qUW9LPE">Schoolboy-3.</a>  <a href="https://yadi.sk/i/pruAv3qUW9LPE">User Guide</a> (pdf). <br>  3. <a href="http://habrahabr.ru/post/228479/">Musical programmable school bell "Schoolboy-4</a> . <a href="http://habrahabr.ru/post/228479/">"</a> </div><p>Source: <a href="https://habr.com/ru/post/229623/">https://habr.com/ru/post/229623/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../229601/index.html">The distribution law of the divisors of a natural number in the NRC</a></li>
<li><a href="../229605/index.html">Simple remote control from a robot computer</a></li>
<li><a href="../229607/index.html">Some interesting and useful things for web developer # 22</a></li>
<li><a href="../229611/index.html">How to stop straining your willpower and start living?</a></li>
<li><a href="../229617/index.html">One day * Two Demopati</a></li>
<li><a href="../229625/index.html">A field plows a peaceful tractor, a reactor flies across the sky</a></li>
<li><a href="../229627/index.html">The third book "Simple Science"</a></li>
<li><a href="../229629/index.html">5 practical examples for studying the React framework</a></li>
<li><a href="../229631/index.html">Signerbox - authentication via DSTU 4145</a></li>
<li><a href="../229633/index.html">Windows "Threshold": Microsoft's plan to conquer users of Windows 7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>