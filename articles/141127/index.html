<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MySQLi puts everything on the shelves</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Who is the article for? The primary purpose of writing the article was to ‚Äúsort everything out‚Äù for those who had already worked with mysqli, but did ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MySQLi puts everything on the shelves</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/367/9ad/464/3679ad4642e2e56fa72820a7c3be82b2.png"><br>  Who is the article for?  The primary purpose of writing the article was to ‚Äúsort everything out‚Äù for those who had already worked with mysqli, but did not penetrate deeply, but quickly wrote their wrappers and forgot about the original syntax.  I tried to clarify the nuances I encountered myself when transferring data from a large and very old database, designed by a person who does not know about normalization, to a new one, with a greatly changed structure. <br><br>  Is it possible to read this article to people who are still using the old mysql extension and only thinking about switching to PDO or MySqli?  I think even necessary. <br><br><a name="habracut"></a><br><h3>  MySqli or PDO </h3><br>  In recent years, I have written websites exclusively on frameworks, which relieved me from working directly with the database.  Some time ago I started working on a site on pure php and wondered what to use instead of the outdated and unrecommended old PHP MySQL extension. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It was necessary to choose between MySqli and PDO.  After not very long study, I decided to stop at MySqli, since, as it seemed to me then, it is completely identical to PDO, except that it is not possible to abandon MySQL in favor of something else.  As I write below, this is not quite true, at least one noticeable difference is. <br><br>  MySqli is recommended for use by PHP developers themselves. [ <a href="http://docs.php.net/manual/ru/mysqli.overview.php">1</a> ] <br><br><h3>  OOP and procedural interface </h3><br>  MySqli allows you to write code in both OOP style and procedural.  The PLO is closer to me like most of the community, so this article will use it. <br><br><h3>  Three main classes </h3><br>  MySqli has 3 main classes, which will be discussed in detail in this article. <br><ol><li>  <a href="http://docs.php.net/manual/ru/class.mysqli.php">mysqli</a> - is required to establish a connection with the database and will be useful if we want to execute queries in the way we did in the old MySQL extension; </li><li>  <a href="http://docs.php.net/manual/ru/class.mysqli-stmt.php">mysqli_stmt</a> - is required to use the new MySqli feature: execute queries on prepared expressions; </li><li>  <a href="http://docs.php.net/manual/ru/class.mysqli-result.php">mysqli_result</a> - combines functions to get the results of queries made using mysqli or mysqli_stmt. </li></ol><br>  Consider each of them in more detail below. <br><br><h3>  DB connection </h3><br>  There are two ways. <br><br>  Method one.  If you just need to create a connection. <br><blockquote>  <font color="#000088">$ mysqli</font> <font color="#339933">=</font> <font color="#000000">new</font> mysqli <font color="#009900">(</font> <font color="#0000ff">'localhost'</font> <font color="#339933">,</font> <font color="#0000ff">'my_user'</font> <font color="#339933">,</font> <font color="#0000ff">'my_password'</font> <font color="#339933">,</font> <font color="#0000ff">'my_db'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">connect_error</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#990000">die</font> <font color="#009900">(</font> <font color="#0000ff">'Connect Error ('</font> <font color="#339933">.</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">connect_errno</font> <font color="#339933">.</font> <font color="#0000ff">')'</font> <font color="#339933">.</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">connect_error</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> </blockquote><br><br>  The second way.  If you need to use connection options. <br><blockquote>  <font color="#000088">$ mysqli</font> <font color="#339933">=</font> <font color="#990000">mysqli_init</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#339933">!</font> <font color="#000088">$ mysqli</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#990000">die</font> <font color="#009900">(</font> <font color="#0000ff">'mysqli_init failed'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#339933">!</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">options</font> <font color="#009900">(</font> MYSQLI_INIT_COMMAND <font color="#339933">,</font> <font color="#0000ff">'SET AUTOCOMMIT = 0'</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#990000">die</font> <font color="#009900">(</font> <font color="#0000ff">'Setting MYSQLI_INIT_COMMAND failed'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#339933">!</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">real_connect</font> <font color="#009900">(</font> <font color="#0000ff">'localhost'</font> <font color="#339933">,</font> <font color="#0000ff">'my_user'</font> <font color="#339933">,</font> <font color="#0000ff">'my_password'</font> <font color="#339933">,</font> <font color="#0000ff">'my_db'</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#990000">die</font> <font color="#009900">(</font> <font color="#0000ff">'Connect Error ('</font> <font color="#339933">.</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">connect_errno</font> <font color="#339933">.</font> <font color="#0000ff">')'</font> <font color="#339933">.</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">connect_error</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> </blockquote><br><br>  Using <strong>$ mysqli-&gt; connect_errno</strong> and <strong>$ mysqli-&gt; connect_error,</strong> we get the description and error code that occurred during the connection.  Both <strong>new mysqli ()</strong> and <strong>$ mysqli-&gt; real_connect ()</strong> with connection errors cause a PHP Warning error.  Therefore, displaying errors using the above-mentioned functions makes sense if you have turned off the display of PHP errors, for example, on the production server, or if you need to somehow handle this data.  I mentioned this here, because not all MySQLi functions call PHP Warning in case of an error, and in order to know that an error has occurred, it is necessary to refer to special functions, see below. <br><br>  Obtained by connecting the object we assigned to the variable <strong>$ mysqli</strong> , in order to use it in the future.  This is obvious for OOP style, but for the procedural style this object is also necessary, in contrast to the outdated MySQL extension, where the link to the connection was not necessary to be passed each time the mysql functions were used. <br><br><h3>  Buffered and Unbuffered Results </h3><br>  Before telling further, I would like to explain the difference between these two types of results. <br><br>  Consider an unbuffered result.  In this case, you can start reading the results without waiting for the mysql server to receive the result completely. <br><br>  Benefits: <br><ul><li>  The result can be started to read earlier, the waiting time is reduced; </li><li>  The result does not take place in the RAM. </li></ul><br>  Disadvantages: <br><ul><li>  It is impossible to know how many rows are received; </li><li>  It is impossible to move to a specific result, that is, you can only read data from the beginning and in order; </li><li>  No other queries can be performed until this result is closed. </li></ul><br><br>  Buffered result is devoid of these disadvantages and, accordingly, is deprived of the listed advantages. <br><br><h3>  "Classic" requests </h3><br>  MySqli left the possibility of "classic" queries: when the user is asked to independently engage in the security of transmitted queries as it was in the outdated MySQL extension.  For this purpose, it is proposed to use the <strong>$ mysqli-&gt; real_escape_string ()</strong> function, with which it is necessary to process all data before putting it into the request. <br><br>  As with a connection, there are two ways to make such a request short and long. <br><br>  Short. <br><blockquote>  <font color="#000088">$ result</font> <font color="#339933">=</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">query</font> <font color="#009900">(</font> 'query text' <font color="#339933">,</font> <font color="#990000">MYSQLI_USE_RESULT</font> <font color="#009900">)</font> <font color="#339933">;</font> </blockquote><br>  Possible constants: <br>  MYSQLI_STORE_RESULT - returns buffered result, default value <br>  MYSQLI_USE_RESULT - Unbuffered <br><br>  A long. <br><blockquote>  <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">real_query</font> <font color="#009900">(</font> <font color="#0000ff">'query text'</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#b1b100">echo</font> <font color="#009900">(</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">field_count</font> <font color="#009900">)</font> <font color="#339933">;</font>  <font color="#666666">// returns the number of columns, as a result</font> <br>  <font color="#666666">// can be obtained before the start of the result, which gives additional flexibility</font> <br>  <font color="#666666">// compared to the short way, of course, it is not necessary to call</font> <br>  <font color="#000088">$ result</font> <font color="#339933">=</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">use_result</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font>  <font color="#666666">// returns unbuffered result</font> <br>  <font color="#666666">// or</font> <br>  <font color="#000088">$ result</font> <font color="#339933">=</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">store_result</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font>  <font color="#666666">// returns the buffered result</font> </blockquote><br><br>  The functions <strong>$ mysqli-&gt; use_result ()</strong> or <strong>$ mysqli-&gt; store_result ()</strong> are also used for multi-requests (requests consisting of several requests).  Multi requests in this article will not be considered. <br><br>  Both syntaxes return the result as a <strong>mysqli_result</strong> object, which is a convenient interface for working with the result, both with buffered and not with unbuffered. <br><br>  As I wrote above, not all MySQLi functions throw PHP errors, the functions described above from among them.  If the request is incorrect and the server returns an error, PHP will not let you know about it.  To test use functions: <br><ul><li>  <strong>$ mysqli-&gt; error</strong> - <strong>error</strong> description </li><li>  <strong>$ mysqli-&gt; errno</strong> - error code </li></ul><br><blockquote>  <font color="#000088">$ city</font> <font color="#339933">=</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">real_escape_string</font> <font color="#009900">(</font> <font color="#000088">$ city</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">query</font> <font color="#009900">(</font> <font color="#0000ff">"SELECT * FROM` city` WHERE `id` = ' <font color="#006699">$ city</font> '"</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">errno</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#990000">die</font> <font color="#009900">(</font> <font color="#0000ff">'Select Error ('</font> <font color="#339933">.</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">errno</font> <font color="#339933">.</font> <font color="#0000ff">')'</font> <font color="#339933">.</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> </blockquote><br><br>  Advantages of the ‚Äúclassic‚Äù query syntax: <br><ol><li>  It is much more compact than prepared expressions (class <strong>mysqli_stmt</strong> ); </li><li>  It allows you to get an unbuffered result in the form of <strong>mysqli_result</strong> .  The prepared expressions allow you to get only the buffered result of <strong>mysqli_result</strong> , and you will have to work with unbuffered means using <strong>mysqli_stmt</strong> , which is much less flexible than <strong>mysqli_result</strong> . </li></ol><br><br>  Practical application of the ‚Äúclassical‚Äù query syntax I see: <br><ol><li>  In non-buffered queries, if you want to take advantage of working with <strong>mysqli_result</strong> ; </li><li>  In INSERT, UPDATE, REPLACE or DELETE queries, if you prefer their shorter syntax. </li></ol><br>  For such queries properties will be useful: <br><ul><li>  <strong>$ mysqli-&gt; affected_rows</strong> - the number of affected lines by the previous query is not per sample </li><li>  <strong>$ mysqli-&gt; insert_id</strong> - automatically generated ID for the last insert request. </li></ul><br><h3>  Prepared requests </h3><br>  The advantages of prepared requests over the "classical": <br><ul><li>  With a series of requests in which only the data is changed, the request is sent to the server only once, then only the changing data is sent; </li><li>  Protection against SQL injection. </li></ul><br>  The class <strong>mysqli_stmt</strong> is responsible for working with prepared queries in MySQLi. <br><br>  Two ways to create a prepared query. <br><blockquote>  <font color="#666666">// first way - using the mysqli object</font> <br>  <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">prepare</font> <font color="#009900">(</font> <font color="#0000ff">"SELECT * FROM` sk2_articles` WHERE `id` =?"</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">errno</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#990000">die</font> <font color="#009900">(</font> <font color="#0000ff">'Select Error ('</font> <font color="#339933">.</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">errno</font> <font color="#339933">.</font> <font color="#0000ff">')'</font> <font color="#339933">.</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br><br>  <font color="#666666">// second way - using the mysqli_stmt object</font> <br>  <font color="#000088">$ stmt</font> <font color="#339933">=</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">stmt_init</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">prepare</font> <font color="#009900">(</font> <font color="#0000ff">"SELECT * FROM` sk2_articles` WHERE `id` =?"</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">errno</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#990000">die</font> <font color="#009900">(</font> <font color="#0000ff">'Select Error ('</font> <font color="#339933">.</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">errno</font> <font color="#339933">.</font> <font color="#0000ff">')'</font> <font color="#339933">.</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> </blockquote><br><br>  Differences in which object functions are called to obtain information about the error.  I think the second way is more convenient, because error checking can be combined into one if block with other functions <strong>mysqli_stmt</strong> .  How to do this will be seen in the examples below. <br><br><blockquote>  <font color="#000088">$ id_min</font> <font color="#339933">=</font> <font color="#cc66cc">81</font> <font color="#339933">;</font> <br>  <font color="#000088">$ id_max</font> <font color="#339933">=</font> <font color="#cc66cc">88</font> <font color="#339933">;</font> <br>  <font color="#000088">$ stmt</font> <font color="#339933">=</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">stmt_init</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <br>  <font color="#666666">// prepare the request, where do we mark the data with the symbol?</font>  <font color="#666666">(placeholds)</font> <br>  <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">prepare</font> <font color="#009900">(</font> <font color="#0000ff">"SELECT title FROM sk2_articles WHERE id&gt;? and id &lt;?"</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  <font color="#666666">// bind variables to placeholders</font> <br>  or <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">bind_param</font> <font color="#009900">(</font> <font color="#0000ff">'ii'</font> <font color="#339933">,</font> <font color="#000088">$ id_min</font> <font color="#339933">,</font> <font color="#000088">$ id_max</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  <font color="#666666">// send data that is currently in bound variables</font> <br>  or <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">execute</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  <font color="#666666">// bind a variable to get the result in it</font> <br>  or <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">bind_result</font> <font color="#009900">(</font> <font color="#000088">$ title</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  <font color="#666666">// make the query buffered</font> <br>  <font color="#666666">// if this line were not, the request would be unbuffered</font> <br>  or <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">store_result</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  <font color="#666666">// get result in bound variable</font> <br>  or <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">fetch</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  <font color="#666666">// close the prepared request</font> <br>  or <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">close</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#990000">die</font> <font color="#009900">(</font> <font color="#0000ff">'Select Error ('</font> <font color="#339933">.</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">errno</font> <font color="#339933">.</font> <font color="#0000ff">')'</font> <font color="#339933">.</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#b1b100">echo</font> <font color="#000088">$ title</font> <font color="#339933">;</font> </blockquote><br><br>  A few explanations to the above code. <br><ol><li>  In <strong>$ stmt-&gt; bind_param (), the</strong> first parameter specifies the type of data to be bound (i - integer, d - double, s - string).  The second and subsequent variables are specified, which will be bound to the corresponding placeholders declared in <strong>$ stmt-&gt; prepare () by the</strong> characters "?"  in the order in which they are listed in <strong>$ stmt-&gt; prepare ()</strong> .  This is a noticeable difference from PDO, where the matchholdors can be named, and therefore do not depend on the order of the advertisement. </li><li> <strong>$ stmt-&gt; bind_result is</strong> in my opinion the weakest point of the <strong>mysqli_stmt</strong> class, since it requires you to know exactly which data will be obtained from the query and in what order they are declared in the query.  For the case of ‚ÄúSELECT * FROM ...‚Äù it is hardly applicable.  The <strong>mysqli_result</strong> class offers a much more flexible approach to working with the result.  To be completely objective, it is worth mentioning that you can use the <strong>$ stmt-&gt; result_metadata ()</strong> <strong>function</strong> to get <strong>mysqli_result</strong> containing only metadata without the data itself, and see what columns are obtained, but this approach seems to me unnecessarily complicated, and I mentioned only to avoid accusations of inaccurate information. </li><li>  <strong>$ stmt-&gt; store_result ()</strong> , as I wrote in the comment to the line, is optional and is needed so that you can use functions such as: <br><ul><li>  <strong>$ mysqli_stmt-&gt; num_rows</strong> - the number of rows received to the result, </li><li>  <strong>$ stmt-&gt; data_seek</strong> - move the internal pointer to the specified result string, </li><li>  <strong>$ stmt-&gt; free_result ()</strong> - and do not forget to call for freeing memory if you used <strong>$ stmt-&gt; store_result ()</strong> . </li></ul><br></li><li>  <strong>$ stmt-&gt; fetch ()</strong> returns TRUE / FALSE if the data was received successfully / unsuccessfully, and NULL if there is no more data. </li><li>  Not all functions that are combined in an if block place it in <strong>$ stmt-&gt; error</strong> in case of an <strong>error</strong> , some call PHP Warning, but all of them return FALSE in case of failure, so this construction seems to me to be a good one.  If you need to execute <strong>$ stmt-&gt; execute ()</strong> or <strong>$ stmt-&gt; fetch ()</strong> several times, then this will not work. </li><li>  Regardless of whether the request was buffered or not, the following properties are available: <br><ul><li>  <strong>$ stmt-&gt; field_count</strong> - the number of columns in the result, </li><li>  <strong>$ stmt-&gt; affected_rows</strong> - the number of affected lines by the previous query is not per sample, </li><li>  <strong>$ stmt-&gt; insert_id</strong> - automatically generated id of the previous insert. </li></ul><br></li></ol><br>  Modify the code to get the result as an instance of the <strong>mysqli_result</strong> object. <br><blockquote>  <font color="#000088">$ id_min</font> <font color="#339933">=</font> <font color="#cc66cc">81</font> <font color="#339933">;</font> <br>  <font color="#000088">$ id_max</font> <font color="#339933">=</font> <font color="#cc66cc">88</font> <font color="#339933">;</font> <br>  <font color="#000088">$ stmt</font> <font color="#339933">=</font> <font color="#000088">$ mysqli</font> <font color="#339933">-&gt;</font> <font color="#004000">stmt_init</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#b1b100">if</font> <font color="#009900">(</font> <br>  <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">prepare</font> <font color="#009900">(</font> <font color="#0000ff">"SELECT title FROM sx2_links WHERE id&gt;? and id &lt;?"</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  or <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">bind_param</font> <font color="#009900">(</font> <font color="#0000ff">'ii'</font> <font color="#339933">,</font> <font color="#000088">$ id_min</font> <font color="#339933">,</font> <font color="#000088">$ id_max</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  or <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">execute</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  <font color="#666666">// get the buffered result as mysqli_result,</font> <br>  <font color="#666666">// unbuffered result cannot be obtained, what I wrote about in flaws</font> <br>  or <font color="#009900">(</font> <font color="#009900">(</font> <font color="#000088">$ result</font> <font color="#339933">=</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">get_result</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  or <font color="#009900">(</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">close</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">===</font> <font color="#009900">FALSE</font> <font color="#009900">)</font> <br>  <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#990000">die</font> <font color="#009900">(</font> <font color="#0000ff">'Select Error ('</font> <font color="#339933">.</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">errno</font> <font color="#339933">.</font> <font color="#0000ff">')'</font> <font color="#339933">.</font> <font color="#000088">$ stmt</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#000088">$ row</font> <font color="#339933">=</font> <font color="#000088">$ result</font> <font color="#339933">-&gt;</font> <font color="#004000">fetch_row</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#b1b100">echo</font> <font color="#000088">$ row</font> <font color="#009900">[</font> <font color="#cc66cc">0</font> <font color="#009900">]</font> <font color="#339933">;</font> </blockquote><br><br><h3>  The class mysqli_result and work with the result using it </h3><br>  As shown above, you could get the <strong>mysqli_result</strong> object using a ‚Äúclassical‚Äù query using the <strong>mysqli</strong> class, then it can be buffered or unbuffered, or using the <strong>mysqli_stmt</strong> class, then it is buffered.  The result of the functions of this class depends on what result you get, so you need to be well aware that if your query is unbuffered you do not have the whole result and therefore you cannot know how many lines are in the result and you can only read it line-by-line in order. <br><br>  The set of functions in this class will seem familiar to the old extensions: <br><ul><li>  <strong>$ result-&gt; fetch_row ()</strong> - gets the current result row as a numbered array </li><li>  <strong>$ result-&gt; fetch_assoc ()</strong> - in the form of an associative array, </li><li>  <strong>$ result-&gt; fetch_array ()</strong> - the type of the array is given by a constant, <br><ol><li>  <em>MYSQLI_ASSOC</em> - associative, </li><li>  <em>MYSQLI_NUM</em> is numbered, </li><li>  <em>MYSQLI_BOTH</em> - both </li></ol><br></li><li>  <strong>$ result-&gt; fetch_object ()</strong> - the result string as an object. </li></ul><br>  About <strong>$ result-&gt; fetch_object ()</strong> I would like to talk separately.  This function has two parameters, both optional: <br><ul><li>  <em>class_name</em> is the name of the class on which the object will be created, </li><li>  <em>params</em> - an array of parameters that will be passed to the constructor when creating an object. </li></ul><br>  As you can see, passing the class constructor suppose an associative array of a single result string using this function does not work.  She herself for you assign properties of the class, coinciding with the names of the field results.  If a class property is not found, it is created dynamically, with a public scope. <br><blockquote>  <font color="#000000">class</font> Book <br>  <font color="#009900">{</font> <br>  <font color="#000000">private</font> <font color="#000088">$ some1</font> <font color="#339933">;</font> <br>  <font color="#000000">public</font> <font color="#000088">$ some2</font> <font color="#339933">;</font> <br>  protected <font color="#000088">$ id</font> <font color="#339933">;</font> <br><br>  <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#000088">$ param1</font> <font color="#339933">,</font> <font color="#000088">$ param2</font> <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000088">$ this</font> <font color="#339933">-&gt;</font> <font color="#004000">some1</font> <font color="#339933">=</font> <font color="#000088">$ param1</font> <font color="#339933">;</font> <br>  <font color="#000088">$ this</font> <font color="#339933">-&gt;</font> <font color="#004000">some2</font> <font color="#339933">=</font> <font color="#000088">$ param2</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> <br>  <font color="#000088">$ book</font> <font color="#339933">=</font> <font color="#000088">$ result</font> <font color="#339933">-&gt;</font> <font color="#004000">fetch_object</font> <font color="#009900">(</font> <font color="#0000ff">'Book'</font> <font color="#339933">,</font> <font color="#990000">array</font> <font color="#009900">(</font> <font color="#cc66cc">1</font> <font color="#339933">,</font> <font color="#cc66cc">2</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#990000">var_dump</font> <font color="#009900">(</font> <font color="#000088">$ book</font> <font color="#009900">)</font> <font color="#339933">;</font> </blockquote><br>  Displays if there was only one id field as a result <br><blockquote>  object <font color="#009900">(</font> Book <font color="#009900">)</font> <font color="#009900">[</font> <font color="#cc66cc">4</font> <font color="#009900">]</font> <br>  <font color="#000000">private</font> <font color="#0000ff">'some1'</font> <font color="#339933">=&gt;</font> int <font color="#cc66cc">1</font> <br>  <font color="#000000">public</font> <font color="#0000ff">'some2'</font> <font color="#339933">=&gt;</font> int <font color="#cc66cc">2</font> <br>  protected <font color="#0000ff">'id'</font> <font color="#339933">=&gt;</font> int <font color="#cc66cc">382</font> </blockquote><br>  Other useful functions and properties of the class in question: <br><ul><li>  <strong>$ result-&gt; fetch_all ()</strong> - getting all rows as an array of numbered / associative / both types, </li><li>  <strong>$ result-&gt; data_seek ()</strong> - setting the internal pointer to the specified result series, </li><li>  <strong>$ result-&gt; num_rows</strong> - the number of rows in the result. </li></ul><br>  References: <br>  <a href="http://docs.php.net/manual/ru/book.mysqli.php">MySQLi page in the official documentation on php.net</a> <br>  <a href="http://docs.php.net/manual/ru/mysqli.quickstart.php">More MySQLi examples</a> <br>  <a href="http://docs.php.net/manual/ru/mysqli.summary.php">List of MySQLi functions in Russian</a> </div><p>Source: <a href="https://habr.com/ru/post/141127/">https://habr.com/ru/post/141127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141120/index.html">WD MyBook Live - Standard Feature Extension</a></li>
<li><a href="../141122/index.html">What to do on international backup day?</a></li>
<li><a href="../141123/index.html">Good luck, Mr. Gorsky</a></li>
<li><a href="../141124/index.html">The order of callbacks for inheritance</a></li>
<li><a href="../141125/index.html">Service for more efficient replenishment of English words</a></li>
<li><a href="../141128/index.html">Instructions for using Yahoo! Answers (handwash, do not iron)</a></li>
<li><a href="../141129/index.html">KCAPTCHA for Yii</a></li>
<li><a href="../141132/index.html">Zombies, run! The original concept of the game: audio guide + GPS + zombies + fitness</a></li>
<li><a href="../141133/index.html">Report on the First Habravstrebe in Almaty</a></li>
<li><a href="../141135/index.html">Black Isle Studios may be reborn</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>