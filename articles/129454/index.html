<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Userscripts. Go deep</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As mentioned in the previous article , userscripts are supported by all modern browsers . And even somehow supported in IE7 and higher . 

 In this ar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Userscripts. Go deep</h1><div class="post__text post__text-html js-mediator-article">  As mentioned in the <a href="http://habrahabr.ru/blogs/javascript/129343">previous article</a> , userscripts are supported by <em>all modern browsers</em> .  And even somehow supported in <em>IE7 and higher</em> . <br><br>  In this article we will talk <b>about browsers</b> : <br><ul><li>  Restrictions </li><li>  Problems </li><li>  Extensions to run userscripts </li><li>  <b>Installing user scripts</b> </li></ul><br><br><a name="habracut"></a><br><h2>  Couple of words about engines </h2><br>  The quality of user scripts support is on a different level in different browsers.  Best of all, support for userscripts is done in <b>Firefox</b> and <b>Chrome</b> browsers. <br>  These browsers provide less user-friendly interfaces for managing userscripts. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The most severe restrictions on user scripts are imposed by <b>Chrome</b> .  But almost all of these limitations cost the <em>packaging of the script into a simple extension</em> .  Details of this process will be discussed in the <a href="http://habrahabr.ru/blogs/javascript/130436/">next article</a> . <br><br>  Now let's talk more about the support of userscripts in individual browsers. <br><br><h2>  Firefox Support </h2><br>  <b>Mozilla Firefox</b> supports userscripts after installing the <a title="GrizMank on the Mozilla Extensions page" href="https://addons.mozilla.org/ru/firefox/addon/greasemonkey/">GreaseMonkey</a> extension (in Russian slang - <em>monkey</em> ) or <a href="https://addons.mozilla.org/en-US/firefox/addon/scriptish/">Scriptish</a> . <br>  After installing the extensions, firefox gets a truly powerful support for user scripts. <br>  The information discussed below applies primarily to GreaseMonkey (this extension was the first). <br><br>  <b>Installation:</b> userscripts are installed by simply dragging the script file into the browser. <br>  <b>Extensions:</b> <a title="GrizMank on the Mozilla Extensions page" href="https://addons.mozilla.org/ru/firefox/addon/greasemonkey/">GreaseMonkey</a> , <a href="https://addons.mozilla.org/en-US/firefox/addon/scriptish/">Scriptish</a> . <br>  <b>Management:</b> userscripts can be disabled and deleted in the menu added by extensions. <br>  <b>Features:</b> <br><ul><li>  There is a powerful library GM API. <br></li><li>  The native global <b>window</b> object is replaced. <br></li><li>  Objects of a native window, for example <b>window.page_defined_var</b> , are accessible via an unsafe link <b>unsafeWindow</b> . <br></li><li>  Cross-domain requests are available through the XmlHttpRequest interface. <br></li><li>  Analogue of globalStorage is available. <br></li><li>  The ability to connect third-party libraries (for example, jQuery) is available. <br></li><li>  Because of the security of the GreaseMonkey plugin, some features require specific <em>hacks</em> . <br>  For example, running GM_setValue (...) in an ajax request handler can cause an error accessing the GM API methods.  To handle this situation, use the construction of the form <b>setTimeout (function () {GM_setValue (...)}, 0)</b> . <br></li><li>  <b>There is no</b> debugging of userscripts.  Even Firebug will not help here. <br></li></ul><br>  GreaseMonkey adds the so-called <b>GM API</b> - a set of javascript functions that add functionality to userscripts. <br>  Of the most requested features that the GM API provides, it is worth mentioning: <br><ol><li>  Object of the ‚Äúnative window‚Äù of the <b>unsafeWindow</b> page (allows <b>replacing</b> functions on the page, using the existing libraries on the page) <br></li><li>  Cross Domain HttpXmlRequest: <b>GM_xmlhttpRequest</b> <br></li><li>  Analog globalStorage (localStorage without binding to the domain): <b>GM_setValue</b> , <b>GM_getValue</b> and <b>GM_deleteValue</b> <br></li></ol><br>  Learn more about the GM API and GreaseMoneky functionality at <a href="http://wiki.greasespot.net/">http://wiki.greasespot.net</a> . <br><br>  Historically, all userscripts were written under the Firefox browser precisely because of the presence of a convenient plugin. <br>  This is due to the fact that all browsers that support user scripts additionally follow the <b>basic rules of the GreaseMonkey specification for parsing metadata</b> . <br>  This means that all scripts that were written under GreaseMonkey <em>will be installed and run</em> in browsers that support user scripts (with a minimum of modifications). <br><br>  Unfortunately, no browser other than Firefox provides the GM API.  This sad fact forces us to use GM API emulations through extensions or additional user scripts. <br><br>  In the case of developing a user script from scratch, I consider it preferable <b>to abandon</b> the GM API emulation and use the ‚Äúbikes‚Äù of our own production.  This allows you to reduce the number of user script dependencies, which, in turn, allows you to develop within the framework of the <b>concept of a single file</b> : you <em>will need to modify only one file;</em>  <em>the user only needs one file to run the user script.</em> <br><br>  <em>The concept of a single file</em> can significantly reduce the complexity of support and cross-browser development of user scripts! <br><br><h2>  Chrome support </h2><br>  <b>Google Chrome</b> supports native scripts natively, i.e.  does not require installation of plug-ins / extensions.  It is possible ( <em>sometimes necessary</em> ) to pack a user script into an extension. <br><br>  <b>Installation:</b> userscripts are installed by simply dragging the script file into the browser. <br>  <b>Extensions:</b> not needed.  There is an extension <a href="https://chrome.google.com/webstore/detail/dhdgffkkebhmkfjojejmpbldmpobfkfo%3Fhl%3Dru">Tampermonkey</a> , which simplifies working with scripts. <br>  <b>Management:</b> userscripts, as well as extensions, can be disabled and deleted ( <em>Settings -&gt; Tools -&gt; Extensions</em> ). <br>  <b>Features:</b> <br><ul><li>  <b>Document.frames [i] .parent</b> is not available ( <em>allowed in extension</em> ). <br></li><li>  Objects of the native window are not available, for example <b>window.page_defined_var</b> (it will not be possible to replace the functions of the page, JSONP in userscript is also eliminated) <br></li><li>  Cross domain queries are not available ( <em>allowed in extension</em> ) <br></li><li>  <b>unsafeWindow</b> is available, but does not carry the functionality of the GM API. <br></li><li>  <b>Convenient native debug</b> userscripts and extensions. <br></li></ul><br>  An extension is an archive packed by the browser itself ( <em>Settings -&gt; Tools -&gt; Extensions -&gt; Package Extension</em> ). <br>  In addition to the user script file, the extension should contain: <br><ul><li>  <b>manifest.json</b> - file description of the extension.  Analog of user metadata. </li><li>  <b>background.html</b> - file "background page" extensions.  Gives access to the extensions API via calling <b>chrome.extension. *</b> </li></ul><br>  Packing user scripts in an extension allows you to <em>bypass many of the restrictions</em> imposed by Google Chrome on user scripts. <br><br>  <em>Important:</em> in fact, the extension and user scripts are different concepts.  And if you approach the issue strictly, it is worth talking about the development of simple extensions for Chrome. <br>  In the case when the user script requires non-standard, "heavy" functionality, it requires packing in the extension. <br>  To pack a user script into an extension, you need to do additional steps <em>once</em> .  All subsequent development will be carried out within the framework of the <b>concept of a single file</b> . <br><br><h2>  Opera support </h2><br>  <b>Opera</b> supports native scripts natively, but does not provide any friendly user interface for managing scripts.  Such an interface is available in the UJS Manager extension. <br><br>  Extensions: <a href="http://unite.opera.com/application/401/">UJS Manager</a> , <a href="http://code.google.com/p/userjs-manager/downloads/list">UserJS Manager</a> . <br>  <b>Installation:</b> user scripts are installed in a user-defined folder of user scripts.  Its location can be set in the browser settings: <em>Settings -&gt; General Settings -&gt; Advanced -&gt; Content -&gt; Customize JavaScript</em> .  The folder with userscripts <b>should not contain spaces</b> . <br>  <b>Management:</b> user scripts can be disabled by deleting or moving the script file from the user scripts folder. <br>  <b>Features:</b> <br><ul><li>  Users scripts run "as is", without turning into a closure, thereby <em>littering the window's global scope</em> . <br></li><li>  Objects of the native window are available, for example <b>window.page_defined_var</b> . <br></li><li>  Available specific events of the Opera browser, for example <b>BeforeScript</b> . <br></li><li>  Cross-domain queries are not available (it is <em>managed using special events</em> ) <br></li><li>  <b>unsafeWindow is</b> unavailable. <br></li><li>  Scripts are run in alphabetical order. <br></li></ul><br><h2>  IE support </h2><br>  <b>IE7, IE8, IE9</b> support user scripts when using the <a href="http://www.bhelpuri.net/Trixie/Trixie/">Trixie</a> plugin. <br>  In addition, there is the more advanced <a href="http://www.ie7pro.com/%3Flanguage%3Dru">IE7Pro</a> plugin.  In addition to user scripts, IE7Pro has many other useful features. <br><br>  <b>Important:</b> If you do not disable additional ‚Äúpribluda‚Äù in IE7Pro, then the plugin can significantly slow down the browser, especially on heavy pages. <br><br>  <b>Extensions:</b> <a href="http://www.bhelpuri.net/Trixie/Trixie/">Trixie</a> , <a href="http://www.ie7pro.com/%3Flanguage%3Dru">IE7Pro</a> . <br>  <b>Installation:</b> userscripts are installed in the Trixie user scripts folder <em>(C: / Program Files / Bhelpuri / Trixie / Scripts)</em> or IE7Pro <em>(C: / Program Files / IEPro / userscripts)</em> . <br>  <b>Management:</b> each plug-in has a user interface for managing userscripts. <br>  <b>Features:</b> <br><ul><li>  Users scripts run "as is", without turning into a closure, thereby <em>littering the window's global scope</em> . <br></li><li>  Objects of the native window are available, for example <b>window.page_defined_var</b> . <br></li><li>  Cross domain queries are not available ( <em>you can</em> work around in <em>ways similar to those used in javascript development: JSONP, easyXDM xdr, etc.</em> ) <br></li><li>  <b>unsafeWindow is</b> unavailable. <br></li><li>  Both Trixie and IEPro have a different script loading model than the GreaseMonkey model.  Scripts are <b>not restarted when the page is updated via Ctrl + R or Ctrl + F5</b> .  In addition, the scripts are loaded by <b>window.onLoad</b> . <br></li><li>  In order for Trixie to see the script, the script <b>must have metadata and must have the <em>@namespace</em> directive (see <a href="http://habrahabr.ru/blogs/javascript/129343">previous article</a> )</b> . <br></li><li>  In order for IE7Pro to see the script, the script <b>must have the extension .ieuser.js</b> . <br></li><li>  Both plug-ins have problems running in IE9 under Windows 7x64. <br>  I have seen more frequently reported IE7Pro not running. <br></li></ul><br><br>  As you can see, with the launch of the scripts in IE, things are lousy.  It remains to be glad that such an opportunity exists at all. <br><br>  <b>Important:</b> Both plugins can exist in the system at the same time, without interfering with each other. <br><br>  <b>Important:</b> Considering the above, I always suggest my users to use <b>Trixie</b> . <br><br><h2>  Safari Support </h2><br>  <em>Unfortunately, I was not able to work with this browser.</em>  <em>I will be glad to any explanations in the comments!</em> <br>  Rumor has it that Safari needs <a href="http://www.culater.net/software/SIMBL/SIMBL.php">SIMBL</a> and <a href="http://8-p.info/greasekit/">GreaseKit</a> plugin. <br><br><h2>  Support in Mobile Safari and other browsers </h2><br>  Due to the lack of support for userscripts in less popular browsers and mobile browsers, userscripts will have to be provided in the form of a <a href="http://ru.wikipedia.org/wiki/%25D0%2591%25D1%2583%25D0%25BA%25D0%25BC%25D0%25B0%25D1%2580%25D0%25BA%25D0%25BB%25D0%25B5%25D1%2582">bookmarklet</a> . <br>  Correspondingly, in this case, metadata is not needed, and the bookmarklet <em>will have to be run by hand</em> after each refresh. <br><br><h2>  Lastly </h2><br><br>  If you stick to the <em>concept of a single file</em> , then the process of creation follows this path: <br><ol><li>  Take the template. </li><li>  Add <s>water</s> code and metadata. </li><li>  Create a folder and files for the Chrome extension. </li><li>  We pack the extension for Chrome, rename the file for IE7Pro. </li><li>  We distribute user scripts / extensions to users. </li><li>  ... </li><li>  We fix <s>hands</s> bugs. </li><li>  Goto 4 </li></ol><br><hr><br>  List of articles: <br><ol><li>  <a href="http://habrahabr.ru/blogs/javascript/129343">Learning to write userscript</a> </li><li>  ¬ª <b>Userscripts.</b>  <b>Deepen.</b> </li><li>  <a href="http://habrahabr.ru/blogs/javascript/130436/">Userscripts.</a>  <a href="http://habrahabr.ru/blogs/javascript/130436/">We pack user scripts for Chrome</a> </li><li>  <a href="http://habrahabr.ru/blogs/javascript/130673/">Usersctripts.</a>  <a href="http://habrahabr.ru/blogs/javascript/130673/">Cross Domain Queries</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/129454/">https://habr.com/ru/post/129454/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../129443/index.html">The secrets of numerology in the invitation of Apple</a></li>
<li><a href="../129445/index.html">FreeRTOS: mutexes and critical sections</a></li>
<li><a href="../129446/index.html">MultiWAN on the DIR-320</a></li>
<li><a href="../129451/index.html">ZRouter - we shove FreeBSD into a DLINK router</a></li>
<li><a href="../129452/index.html">Why can I stop writing on Habrahabr</a></li>
<li><a href="../129455/index.html">LGDC # 2 in November. We invite to participate</a></li>
<li><a href="../129456/index.html">Citizens! Give a chance to support</a></li>
<li><a href="../129458/index.html">Color cipher for recording information in genes</a></li>
<li><a href="../129459/index.html">Dear photography</a></li>
<li><a href="../129460/index.html">Online radio do it yourself</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>