<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Correct work with the database in Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings to all droids in these difficult times for us. 
 Honestly, this hype has hesitated about patents, wars, etc., but this article is not about ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Correct work with the database in Android</h1><div class="post__text post__text-html js-mediator-article">  Greetings to all droids in these difficult times for us. <br>  Honestly, this hype has hesitated about patents, wars, etc., but this article is not about this. <br>  <i>I was not going to write an article on this topic, because everywhere there is a whole lot about working with the database in Android and everything seems to be simple, but I am very tired of receiving reports about errors, errors specific and related to the database.</i> <br>  Therefore, I will look at a couple of points that I encountered in practice, to warn people who just have to deal with it, and then I wait for your comments on solving these problems and then make changes to the post and we will make an excellent tutorial that will work With SQLite in Android, not only for beginners, but also for those who are already familiar with the basics and have written simple applications. <br><a name="habracut"></a><br>  <b>Ways to work with the database</b> <br><br>  There are three ways to work with data in the database, which immediately rush to the mind: <br>  1) You create an empty database structure.  The user works with the application (creates notes, deletes them) and the database is full.  An example would be the NotePad application in demo examples developer.android.com or on your droid device. <br>  2) You already have a ready-made database filled with data that needs to be distributed with the application, or parse the data from the file into assets. <br>  3) Receive data from the network, as needed. <br>  If there is any other one or two ways, then I‚Äôm happy to add this list with your help. <br>  All the main tutorials are designed just for the first time.  You write a request to create a database structure and execute this query in the onCreate () method of the SQLiteOpenHelper class, for example: <br><pre><code class="hljs java"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyDBHelper</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SQLiteOpenHelper</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String CREATE_TABLE = <span class="hljs-string"><span class="hljs-string">"CREATE TABLE myTable(...)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String DB_NAME = <span class="hljs-string"><span class="hljs-string">"mySuperDB.db"</span></span>; Context mContext; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyDBHelper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dbVer)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(context, DB_NAME, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, dbVer); mContext = context; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SQLiteDatabase db)</span></span></span><span class="hljs-function"> </span></span>{ db.execSQL(CREATE_TABLE); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onUpgrade</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SQLiteDatabase db, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> oldVersion, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> newVersion)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//       db.execSQL("DROP TABLE IF EXISTS tableName"); onCreate(db); } ...-  }</span></span></code> </pre> <br>  Like that.  A more complete version of the class and other components can be viewed at the link at the bottom of the article. <br>  Additionally, you can override the methods onOpen (), getReadableDatabase () / getWritableDatbase (), but usually there is enough of the above and data retrieval methods. <br>  Further, we create an instance of this class in our application when it is launched and execute queries, that is, the problem part is passed.  Why is she a problem?  Because when a user downloads applications from the market, he does not think about your database and anything can happen.  Let's say the network has disappeared, or the process has started another one, or you have written a code that is vulnerable to errors. <br><br>  By the way, there is one more thing worth paying attention to.  An instance variable of our class can be created and stored in the Application object and accessed as necessary, but you need to remember to call the close () method, since a permanent connection to the database is a heavy resource.  In addition, there may be collisions when working with a database of several threads. <br>  But there is another way, for example, to create our object as needed to access the database.  I think this is a matter of preference, but which also needs to be discussed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And now the most important thing.  What if we needed to use an already existing database with data in the application? <br>  A little googling, you immediately stumble upon such a "wonderful article" - <a href="http://www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications/">www.reigndesign.com/blog/using-your-own-sqlite-database-in-android-applications</a> in which, as it seems, there is a necessary panacea.  But it was not there.  It also has several errors. <br><br>  Here they are: <br>  1) In the createDataBase () method, the line: <br>  <b>SQLiteDatabase dbRead = getReadableDatabase ();</b> <br>  and then the code ... contains the crash of the application on the NTS Desire, because we get the database to read (it is created), but does not close. <br>  Add the line below dbRead.close () and the fix is ‚Äã‚Äãready, but the point is controversial. <br>  Here is what the dock says on the getReadableDatabase () method: <br>  <i>Create and / or open a database.</i>  <i>This will be the same object that has received some information, such as a full disk read.</i>  <i>In that case, the database object will be returned.</i>  <i>If the problem is a problem, it will be possible to make it.</i> <i><br></i>  <i>Like this method, you can take it a long time to return, so that you can get it.</i> <br>  So.  This method should not be called in the main application thread.  Everything else is clear. <br>  2) <b>Error: No such table android_metadata.</b>  The author of the post got out by creating this table in advance in the database.  I do not know how much this is the right way, but this table is created in each sqlite-database by the system and contains the current locale. <br>  3) <b>Error: Unable to open database file.</b>  There are many opinions, different opinions, which you can read on the links below. <br><br>  <a href="http://stackoverflow.com/questions/3563728/random-exception-android-database-sqlite-sqliteexception-unable-to-open-database">stackoverflow.com/questions/3563728/random-exception-android-database-sqlite-sqliteexception-unable-to-open-database</a> <br>  <a href="http://groups.google.com/group/android-developers/browse_thread/thread/a0959c4059359d6f">groups.google.com/group/android-developers/browse_thread/thread/a0959c4059359d6f</a> <br>  <a href="http://code.google.com/p/android/issues/detail%3Fid%3D949">code.google.com/p/android/issues/detail?id=949</a> <br>  <a href="http://stackoverflow.com/questions/4937934/unable-to-open-database-file-on-device-htc-desire">stackoverflow.com/questions/4937934/unable-to-open-database-file-on-device-htc-desire</a> <br>  <a href="http://androidblogger.blogspot.com/2011/02/instable-android-and-unable-to-open.html">androidblogger.blogspot.com/2011/02/instable-android-and-unable-to-open.html</a> <br><br>  It is possible that the problems are related to the fact that one thread blocks the database and the second one cannot access it, perhaps the problem is access rights to the application (it was noted that the problems with the database often appear on the NTS phones on those models that can not be ruined , although not only on them, for example, on Acer tablets), however, these problems exist. <br>  I tend to the option that the problem is in the threads, not for nothing that we are not recommended to call the methods for creating the base in the main thread. <br><br>  Perhaps the way out of this is the next solution (option number 2 is being considered)  Using the first version of working with the database, fill it with data after creation, for example: <br><pre> <code class="hljs java"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SQLiteDatabase db)</span></span></span><span class="hljs-function"> </span></span>{ db.execSQL(CREATE_TABLE); fillData(db); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fillData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SQLiteDatabase db)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  data.xml    assets //     //     sql-        db.execSQL()   }</span></span></code> </pre><br>  This approach still needs to be tested in practice, but since this post is aimed at developing the right collective decision on this topic, comments and samples on this topic are welcome. <br>  The moral of the story is this: if you have found some good piece of code for your solution, then check it out, do not be lazy before copying and paste into your project. <br><br>  <b>Conclusion</b> <br><br>  In general, this post shows (regarding method number 2) how to do it is not necessary, but also contains a couple of curious thoughts. <br>  The getReadableDatabase () method can be overridden for example: <br><pre> <code class="hljs pgsql"> @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> synchronized SQLiteDatabase getReadableDatabase() { //<span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>.d(Constants.DEBUG_TAG, "getReadableDatabase() called"); SQLiteDatabase db; try { db = super.getReadableDatabase(); } catch (SQLiteException e) { <span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>.d(Constants.DEBUG_TAG, e.getMessage()); File dbFile = myContext.getDatabasePath(DB_NAME); <span class="hljs-keyword"><span class="hljs-keyword">Log</span></span>.d(Constants.DEBUG_TAG,"db path="+dbFile.getAbsolutePath()); //db = SQLiteDatabase.openDatabase(<span class="hljs-comment"><span class="hljs-comment">/*DB_PATH + DB_NAME*/</span></span> dbFile.getAbsolutePath(), <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, SQLiteDatabase.NO_LOCALIZED_COLLATORS); db = SQLiteDatabase.openOrCreateDatabase(dbFile.getAbsolutePath(), <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> db; }</code> </pre><br>  An excellent tutorial on this topic here is <a href="http://www.vogella.de/articles/AndroidSQLite/article.html">www.vogella.de/articles/AndroidSQLite/article.html</a> <br><br>  By the way: following the practice of the platform itself, the primary key field should be called "_id". <br><br>  Write in your comments used practices.  We will make this post better for everyone, and maybe the world will become a bit kinder. <br><br>  <b>UPD</b> Just checked your approach.  Everything works in the emulator, but be careful. <br><br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DBHelper</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SQLiteOpenHelper</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> DB_VER = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String DB_NAME = <span class="hljs-string"><span class="hljs-string">"todo.db"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TABLE_NAME = <span class="hljs-string"><span class="hljs-string">"todo"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String CREATE_TABLE = <span class="hljs-string"><span class="hljs-string">"CREATE TABLE "</span></span>+TABLE_NAME+ <span class="hljs-string"><span class="hljs-string">"( _id INTEGER PRIMARY KEY , "</span></span>+ <span class="hljs-string"><span class="hljs-string">" todo TEXT)"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String DROP_TABLE = <span class="hljs-string"><span class="hljs-string">"DROP TABLE IF EXISTS "</span></span>+TABLE_NAME; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String DATA_FILE_NAME = <span class="hljs-string"><span class="hljs-string">"data.txt"</span></span>; Context mContext; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DBHelper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(context, DB_NAME, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, DB_VER); Log.d(Constants.DEBUG_TAG,<span class="hljs-string"><span class="hljs-string">"constructor called"</span></span>); mContext = context; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SQLiteDatabase db)</span></span></span><span class="hljs-function"> </span></span>{ Log.d(Constants.DEBUG_TAG,<span class="hljs-string"><span class="hljs-string">"onCreate() called"</span></span>); db.execSQL(CREATE_TABLE); fillData(db); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onUpgrade</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SQLiteDatabase db, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> oldVersion, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> newVersion)</span></span></span><span class="hljs-function"> </span></span>{ db.execSQL(DROP_TABLE); onCreate(db); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> ArrayList&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ InputStream stream = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; ArrayList&lt;String&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;String&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { stream = mContext.getAssets().open(DATA_FILE_NAME); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { Log.d(Constants.DEBUG_TAG,e.getMessage()); } DataInputStream dataStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataInputStream(stream); String data = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>( (data=dataStream.readLine()) != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ) { list.add(data); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> list; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fillData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(SQLiteDatabase db)</span></span></span></span>{ ArrayList&lt;String&gt; data = getData(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(String dt:data) Log.d(Constants.DEBUG_TAG,<span class="hljs-string"><span class="hljs-string">"item="</span></span>+dt); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( db != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ){ ContentValues values; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(String dat:data){ values = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ContentValues(); values.put(<span class="hljs-string"><span class="hljs-string">"todo"</span></span>, dat); db.insert(TABLE_NAME, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, values); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Log.d(Constants.DEBUG_TAG,<span class="hljs-string"><span class="hljs-string">"db null"</span></span>); } } }</code> </pre><br><br>  File data.txt is in assets like this: <br>  Zametka # 1 <br>  Zametka # 2 <br>  Zametka # 3 <br>  Zametka # 4 <br><br>  And application class: <br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TODOApplication</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DBHelper mDbHelper; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(); mDbHelper = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DBHelper(getApplicationContext()); mDbHelper.getWritableDatabase(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onLowMemory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onLowMemory(); mDbHelper.close(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onTerminate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onTerminate(); mDbHelper.close(); } }</code> </pre><br>  I note that this class is used only to demonstrate and check what happens when you call the getReadableDatabase () / getWritableDatabase () methods and create the base.  In real projects, the code needs to be adapted. <br>  In addition, the android_metadata sign appeared in the database (without my participation), so the error indicated above has been resolved. <br>  I hope someone will come in handy. <br><br>  <b>Curious additions # 1</b> (from Kalobok <a href="https://habrahabr.ru/users/kalobok/" class="user_link">habrauser</a> ) <br><br>  So far I have completely abandoned SQLiteOpenHelper - it turned out that it is impossible to create a base on the SD card in it.  Theoretically, what it returns should be used as the path to the database.  In practice, SQLiteOpenHelper sometimes uses it, and sometimes bypasses it - it depends on whether we open the database for reading or writing, if it already exists, etc.  SQLiteOpenHelper.getWritableDatabase calls Context.openOrCreateDatabase, which in turn uses Context.validateFilePath to get the full path to the file.  It uses the private method Context.getDatabasesDir, which cannot be overridden - arrived.  The database will be created in the standard directory. <br><br>  But if we called SQLiteOpenHelper.getReadableDatabase, first it will try to call all the same getWritableDatabase.  But if it does not work out, then it will bypass the Context.openOrCreateDatabase - it will call Context.getDatabasePath (we can correct it) and open the necessary database itself.  This method would suit us if it was always used.  But alas.  :( <br>  In general, the idea with this helper was good, and the implementation - with the left foot with a hangover. </div><p>Source: <a href="https://habr.com/ru/post/125883/">https://habr.com/ru/post/125883/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../125877/index.html">Creating a simple financial model of your startup</a></li>
<li><a href="../125879/index.html">AppFabric Cache Pitfalls</a></li>
<li><a href="../125880/index.html">Class fields available by name with setter and getter in C ++</a></li>
<li><a href="../125881/index.html">Instructions for beginner musicians</a></li>
<li><a href="../125882/index.html">Ten of the most sought after specializations according to Indeed.com</a></li>
<li><a href="../125887/index.html">Indian company released Android $ 75 solar-powered tablet</a></li>
<li><a href="../125890/index.html">Funky project management model</a></li>
<li><a href="../125891/index.html">The Japanese have created a self-learning robot</a></li>
<li><a href="../125892/index.html">The first accident of an unmanned vehicle</a></li>
<li><a href="../125893/index.html">Some tips for working with PLSQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>