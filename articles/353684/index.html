<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>One small ventilation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is a small ventilation system that we were instructed to run sometime, and today I use it as an online thermometer . How did it happen? It was t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>One small ventilation</h1><div class="post__text post__text-html js-mediator-article">  There is a small ventilation system that we were instructed to run sometime, and today I use it as an <a href="http://satori.hahenty.ru/">online thermometer</a> .  How did it happen?  It was the first automation cabinet adopted immediately after the agreement to work. <br><a name="habracut"></a><br>  Then a ventilation unit with a plate heat exchanger and electric heaters, with several dampers on the duct branches, was delivered.  There was no clear technical task, the little company was just starting its way, we acted according to the sensations. <br><br><img src="https://habrastorage.org/webt/yo/w-/af/yow-afujfftbknayk7dclus7wk0.jpeg" alt="installation diagram"><br><br>  The cabinet was assembled from: Aries PLK160, touch panel SP270, PChV203, every kind of electrical junk.  To measure the temperature, Oven thermometers and a pair of analog input modules were used. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Heaters are controlled by a PD controller (as I imagine it) and a PWM switch with a one and a half minute period for switching starters (contactors) with brute force.  The heater before the recuperator is set at a fixed temperature of 3 ¬∞ C - this value is selected after the ‚Äúexperiments‚Äù with frostbite of the exhaust duct and floods, so a drainage and water drainage set up.  The heater after the heat exchanger reheat to the required temperature. <br><br>  <i>In general, imported specialized controllers have a lower limit for outdoor temperature when ventilation stops.</i>  <i>However, for us this luxury is unacceptable, even if we have ‚Äì35 ¬∞.</i> <i><br><br></i> <div class="spoiler">  <b class="spoiler_title">It is not good to consider other people's money, but it is interesting.</b> <div class="spoiler_text">  In winter, heaters operate at about 40 kW out of 120 possible, two 7.5 kW fans averaged to 5 kW due to switching speeds, the working day is 15 hours.  Approximately, 50 * 15 = 750 kWh per day.  At 2.75 rubles about 2000 rubles per day, 60,000 rubles in the winter month. <br></div></div><br>  Fans are set to the frequency of the voltage: 0, 35 or 50 Hz.  Initially, the fans were regulated by the number of open dampers on the branches, but after a while the drives stopped ‚Äúresponding‚Äù - the Chinese motors rusted without a casing - <i>it's funny to say, but during the transition period someone walks and inserts / pulls the plates across / from the duct</i> .  Then for the fans it was possible to enter any frequency value from the range, but this turned out to be ‚Äútoo difficult‚Äù - no one bothered, set the minimum or maximum value.  In addition, the power of the heaters depended on the speed of the fans, but it quickly came to the realization that the regulator performs well without adjustments. <br><br>  <i>Yes, there is someone who, according to the state of the air and the number of visitors, switches the speed with ‚Äúbuttons‚Äù on the touch panel.</i> <br><br>  The first version of the user interface on the touch panel (SP270) terrified me, but the buttons and indicators in the frames continued to form on the screen, and the ‚Äúsnail‚Äù thumbnails were rotated with their blades.  A quick inspection of examples of constructing mnemonic schemes showed that graphical imitation of real objects is a generally accepted practice.  Then came the preventive day, and a new interface. <br><br><img src="https://habrastorage.org/webt/ph/b8/_-/phb8_-n751ucl2ft-e1rkjpzpck.jpeg" alt="customized interface"><br><br>  Then the flat design with might and main trampled its sphere, and the picture on the cabinet slightly pulled to the trend. <br><br>  Years have passed (3 pcs.), From the experience of automation within the team, the thought of an SCADA-ventilation system came through, but I (not very professional, or not very professional) did it my own way.  It should be noted that no wishes were received from the building owner for remote control - this is how my samopal was justified. <br><br>  There was only one Raspberry-Pi left from some unrealized project (sound recorder).  Well, node-js got there, because at once one script managed to describe the exchange with the PLC and the web presentation.  Naturally, Internet access was an obvious and integral task. <br><br><img src="https://habrastorage.org/webt/p1/cn/a8/p1cna8qiqh4wdiwz-afieovneek.jpeg"><br><br>  Between the single-board and PLC exchange occurs on modbus-tcp.  Raising the connection was quite simple.  The first library from the search engine <a href="https://github.com/dresende/node-modbus-tcp">github.com/dresende/node-modbus-tcp</a> , and after a few hours the fans were controlled from the browser. <br><br>  The single-plate device is connected to the site as the client ‚Äî by a web socket ‚Äî I did not really understand how it happened.  The data itself is formed into json strings and converted directly on the page.  At first, the web page was filled with elements of standard forms, but it was very much like that horror on the touch panel, just from a different sphere.  For some time I fought for beauty, but very quickly tired. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/43b/512/b26/43b512b2626a57053126423dfcc5389e.png" alt="old web snout"><br><br>  Now you need to rotate the virtual "Krutilki" inside the disclosed items. <br><br>  Authorization of the client for the ability to control is now done very simply, by coincidence of one line, and the entire exchange between the client and the PLC goes through the site-router-router-single-board chain.  Although prior to this, the scripts on the page provided for switching the web socket to a single-board device, where gray dynamic addresses for two subnets were determined by the procedure from a single-sided device, and authorization was allowed only to clients from the internal network. <br><br>  There are still many details for improvement in this ventilation system, and in the near future we will have to add three more supply and exhaust systems with an indefinite number of micro extracts.  I suppose that we will also combine them within the network of the building via ethernet to a computer with some normal scada program. </div><p>Source: <a href="https://habr.com/ru/post/353684/">https://habr.com/ru/post/353684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353674/index.html">Divorce as it is (or "confirmation confirmation discord!")</a></li>
<li><a href="../353676/index.html">Attention! S in Ethereum stands for Security. Part 4. Tools</a></li>
<li><a href="../353678/index.html">Reverse engineering "Kazakov 3", part of the network: create a local server</a></li>
<li><a href="../353680/index.html">Distributed control system based on SoC FPGA</a></li>
<li><a href="../353682/index.html">DevConf: Uber transition from PostgreSQL to MySQL</a></li>
<li><a href="../353686/index.html">"Closer to 5G": VMware helps telecom operators deploy new generation networks</a></li>
<li><a href="../353692/index.html">What business and users face the struggle of RKN and Telegram? Expert opinions</a></li>
<li><a href="../353696/index.html">Challenges and challenges in Enterprise E-Commerce. How did the project Virto Commerce?</a></li>
<li><a href="../353698/index.html">Code architecture</a></li>
<li><a href="../353704/index.html">Fell with AWS? Call in without question, documents later, now not before</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>