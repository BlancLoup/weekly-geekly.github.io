<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to HTML5 History API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Before the advent of HTML5, the only thing we could not control and manage (without reloading content or hacks from location.hash) is the story of one...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to HTML5 History API</h1><div class="post__text post__text-html js-mediator-article">  Before the advent of HTML5, the only thing we could not control and manage (without reloading content or hacks from location.hash) is the story of one taba.  With the advent of the <a href="http://dev.w3.org/html5/spec/history.html">HTML5 history API,</a> everything has changed - now we can walk through history (previously we could also), add elements to history, respond to history transitions and other usefulness.  In this article we will look at the HTML5 History API and write a simple example illustrating its capabilities. <br><br><h4>  Basic Concepts and Syntax </h4><br>  The History API relies on one DOM interface, the History object.  Each tab has a unique History object, which is located in <code>window.history</code> .  History has several methods, events, and properties that we can control from JavaScript.  Each page of a tab (Document object) is an object of the History collection.  Each history element consists of a URL and / or a state object (a state object); it can have a title (title), a Document object, form data, a scroll position, and other information associated with the page. <br><br>  The main methods of the History object: <br><ol><li>  <code>window.history.length</code> : Number of records in the current history session </li><li>  <code>window.history.state</code> : Returns the current history object </li><li>  <code>window.history.go(n)</code> : A method that allows you to walk through history.  An argument is passed as an argument, relative to the current position.  If 0 is transmitted, the current page will be updated.  If the index goes beyond history, then nothing will happen. </li><li>  <code>window.history.back()</code> : Method identical to <code>go(-1)</code> </li><li>  <code>window.history.forward()</code> : Method identical to <code>go(1)</code> </li><li>  <code>window.history.pushState(data, title [, url])</code> : Adds a history item. </li><li>  <code>window.history.replaceState(data, title [, url])</code> : Updates the current history item </li></ol><a name="habracut"></a><br>  To go 2 steps back in history, you can use: <br><pre> <code class="javascript hljs">history.go(<span class="hljs-number"><span class="hljs-number">-2</span></span>)</code> </pre><br>  To add history elements we can use <code>history.pushState</code> : <br><pre> <code class="javascript hljs">history.pushState({<span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">'bar'</span></span>}, <span class="hljs-string"><span class="hljs-string">'Title'</span></span>, <span class="hljs-string"><span class="hljs-string">'/baz.html'</span></span>)</code> </pre><br>  To change the history record, we can use <code>history.replaceState</code> : <br><pre> <code class="javascript hljs">history.replaceState({<span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">'bat'</span></span>}, <span class="hljs-string"><span class="hljs-string">'New Title'</span></span>)</code> </pre><br><h4>  Living example </h4><br>  Now we know the basics, let's look at a living example.  We will make a web file manager that will allow you to find the URI of the selected image ( <a href="http://people.opera.com/miket/2011/6/viewer.html">see what happens at the end</a> ).  The file manager uses a simple javascript file structure.  When you select a file or folder, the picture is dynamically updated. <br><img src="http://devfiles.myopera.com/articles/5812/example.png" alt="image"><br>  We use <code>data-*</code> attributes to store the header of each image and use the dataset property to get this property: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"photo"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"crab2.png"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-note</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Grey crab!"</span></span></span><span class="hljs-tag">&gt;</span></span>crab2.png<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  For everything to work quickly, we load all the images and update the <code>src</code> attribute dynamically.  This acceleration creates one problem - it breaks the back button, so you cannot go forward or backward through the pictures. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      HTML5 history comes to the rescue!  Every time we select a file, a new history record is created and the <code>location</code> document is updated (it contains the unique URL of the image).  This means that we can use the back button to crawl our images, while in the address bar we will have a direct link to the picture, which we can bookmark or send to someone. <br><br><h4>  Code </h4><br>  We have 2 divas.  One contains the folder structure, the other contains the current image.  The entire application is managed using javascript.  Only the most important moments will be covered.  <a href="">The source code of the example is</a> very short (about 80 lines); look at <a href="">it</a> after reading the entire article. <br><br>  The <code>bindEvents</code> method hangs handlers for the <code>popstate</code> event, which is called when the user navigates through the history and allows the application to update its state. <br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'popstate'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">)</span></span>{ self.loadImage(e.state.path, e.state.note); }, <span class="hljs-literal"><span class="hljs-literal">false</span></span>);</code> </pre><br>  The <code>event</code> object that is passed to the <code>popstate</code> event <code>popstate</code> has a <code>state</code> property ‚Äî this is the data that we passed as the first argument to <code>pushState</code> or <code>replaceState</code> . <br><br>  We hang up a handler on a <code>click</code> event on a div, which represents our file structure.  Using the event delegation, we open or close a folder or load a picture (with adding an entry to the history).  We look at the parent's <code>className</code> in order to understand which element we clicked on: <br>  - If this is the folder we open or close it <br>  - If this is a picture, then we show it and add an element of history. <br><br><pre> <code class="javascript hljs">dir.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">)</span></span>{ e.preventDefault(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = e.target; <span class="hljs-comment"><span class="hljs-comment">//   if (f.parentNode.classList.contains('folder')) { //     self.toggleFolders(f); } //   else if (f.parentNode.classList.contains('photo')){ note = f.dataset ? f.dataset.note : f.getAttribute('data-note'); //   self.loadImage(f.textContent, note); //    history.pushState({note: note, path:f.textContent}, '', f.textContent); } }, false);</span></span></code> </pre><br>  The method that changes the content of the image and updates its caption is very simple: <br><pre> <code class="javascript hljs">loadImage: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">path, note</span></span></span><span class="hljs-function">)</span></span>{ img.src = path; h2.textContent = note; }</code> </pre><br>  We got a <a href="http://people.opera.com/miket/2011/6/viewer.html">simple application</a> that demonstrates the capabilities of the updated interface of the <code>History</code> object.  We use <code>pushState</code> to add a history item and a popstate event to update the page content.  In addition, when clicking on a picture, we get its address in the address bar, which we can save or send to someone. <br><br><h4>  When can I use it? </h4><br>  Firefox 4+ <br>  Safari 5+ <br>  Chrome 10+ <br>  Opera 11.5+ <br>  iOS Safari 4.2+ <br>  Android 2.2+ <br>  IE ??? <br>  <a href="http://caniuse.com/">List of browsers</a> supporting the history API <br><br><h4>  Where is it used? </h4><br>  1. <a href="http://www.facebook.com/note.php%3Fnote_id%3D438532093919">Facebook</a> <br>  2. <a href="https://github.com/blog/760-the-tree-slider">Github</a> - navigating the project tree <br>  3. ??? <br><br><h4>  Read </h4><br>  1. <a href="http://diveintohtml5.org/history.html">Manipulating History for Fun &amp; Profit</a> <br>  2. <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html">WHATWG HTML5 history API</a> <br>  3. <a href="http://dev.w3.org/html5/spec/history.html">W3C history API Spec</a> <br>  4. MDC <a href="https://developer.mozilla.org/en/DOM/Manipulating_the_browser_history">Manipulating the browser history</a> <br>  5. <a href="https://github.com/balupton/History.js/">History.js</a> - the script emulates the HTML5 history API (location.hash magic) in those browsers that do not support it </div><p>Source: <a href="https://habr.com/ru/post/123106/">https://habr.com/ru/post/123106/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123099/index.html">Craftsman assembled Sega Game Gear do-it-yourself</a></li>
<li><a href="../123100/index.html">Out of stock ReSharper 6.0</a></li>
<li><a href="../123102/index.html">10 theses on automation of science management</a></li>
<li><a href="../123103/index.html">Augmented Reality</a></li>
<li><a href="../123105/index.html">IBM develops "instant" memory, 100 times faster than flash</a></li>
<li><a href="../123107/index.html">Marketing is like seasoning. The basics</a></li>
<li><a href="../123108/index.html">On the Sony Ericsson phones the opportunity to make video calls via Skype</a></li>
<li><a href="../123109/index.html">Freedom is slavery</a></li>
<li><a href="../123111/index.html">The instruction crib for beginners</a></li>
<li><a href="../123112/index.html">The film will be able to make any LCD-screen suitable for three-dimensional image.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>