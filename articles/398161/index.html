<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mozilla and Apple ban certification centers WoSign and StartCom</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="An investigation by Mozilla showed that the Chinese certification center WoSign (of which free certificates were a number of articles on Habr√© ) over ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mozilla and Apple ban certification centers WoSign and StartCom</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/25f/295/dce/25f295dcee544f6da7a953f54890de65.jpeg"></div><br>  <a href="https://wiki.mozilla.org/CA:WoSign_Issues">An investigation by Mozilla</a> showed that the Chinese certification center WoSign (of which free certificates were <a href="https://habrahabr.ru/post/252529/">a</a> <a href="https://habrahabr.ru/post/279661/">number of</a> <a href="https://habrahabr.ru/post/257207/">articles</a> on <a href="https://habrahabr.ru/post/270681/">Habr√©</a> ) over the past couple of years has made a glaring number of violations. <br><a name="habracut"></a><br><h3>  2015 </h3><br>  It started with little things: Google, during the ongoing monitoring of certificates, noticed repeated issuance of certificates with identical serial numbers, which is formally a violation of standards.  There were other minor deviations from the rules. <br><br>  It would seem, nothing serious.  But this is already in itself - a signal to the certifying center to pay attention to what is happening and to set up verification mechanisms.  However, the certificate issuance policy applied by WoSign lags behind their own practice.  Policy changes were made after incidents in order to smooth back retroactively and justify the deviations. <br><br>  In addition, shortcomings were found when checking ‚Äúwhether the recipient of the certificate is the owner of the domain for which he is requesting the certificate‚Äù.  They are not critical in themselves, they could still simplify the issuance of a certificate to attackers.  For example, domain ownership verification could be performed using dynamic ports (above 50,000).  Mozilla is of the opinion that the issuance of certificates should be made using only privileged ports (1024 and below).  At the same time, WoSign did not log the port numbers used, therefore, the scale of the problem cannot be fully assessed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This was followed by serious vulnerabilities.  <a href="https://habrahabr.ru/company/pt/blog/308824/">The first</a> allowed an attacker who owned a subdomain to get a certificate for the entire domain.  The researcher who discovered this was able to obtain bogus GitHub certificates (for example, test.github.io), Microsoft, and Alibaba.  WoSign knew about the vulnerability for 14 months, but did not fix it, limiting itself to revoking certificates containing "github" in the domain name.  Issuance of erroneous certificates continued.  The remaining problem certificates the company agrees to revoke only in the case of requests from the owners of the affected domains. <br><br>  The second vulnerability was truly epic.  After successfully passing the domain ownership check, the attacker had the opportunity to add any third-party domain to the list of verified domains.  <i>Absolutely any.</i>  <i>Already without any verification.</i> <br><br>  As if this was not enough, WoSign secretly acquired the Israeli StartCom certification center.  Moreover, when the guys from Mozilla hinted that ‚Äúit‚Äôs not good to do this‚Äù (and this is putting it mildly, this concealment violates <a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/maintenance/">the</a> Mozilla <a href="https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/policy/maintenance/">policy</a> ), WoSign <a href="https://groups.google.com/forum/">began to deny everything and try to prevent this information from being made public</a> . <br><br>  When it became clear that you could not conceal the sewing in the bag, the company issued a <a href="https://www.wosign.com/english/News/WoSign_completed_equity_investment_to_StartCom_CA.htm">press release</a> , admitting ‚Äúmaking investments in StartCom‚Äù.  At the same time, the sole leader of StartCom and, at the same time, the CEO of WoSign is the same person.  There is also technical evidence that StartCom (at the moment) uses most of the WoSign infrastructure.  It turns out to be a bit of a coincidence for companies that, as the WoSign press release says, "operate and operate independently of each other." <br><br><h3>  2016 </h3><br>  The next year, WoSign began with the fact that in the middle of January, retroactively released certificates SHA-1.  Date ‚Äúrewind‚Äù a month ago.  This made it possible to avoid blocking certificates by popular browsers that agreed to accept only SHA-2 certificates in 2016, because of the increase in computing power, the SHA-1 algorithm is already losing ground and is <a href="https://habrahabr.ru/company/first/blog/241603/">considered insufficiently robust</a> .  The documentation of the <a href="https://en.wikipedia.org/wiki/CA/Browser_Forum">CAB Forum is</a> clearly regulated - since 2016, certification authorities should not issue certificates using SHA-1: <br><br><blockquote>  Effective January 1, 2016, CAs Must have CA rules using the SHA-1 hash algorithm. </blockquote><br>  Three certificates were unmasked due to the inattention of WoSign: the STC tags embedded in three of them (signed certificate timestamp) indicated mid-January 2016, which clearly indicates that certificates could not be created earlier than this period. <br><br>  Another 62 certificates revealed due to the fact that they were issued on Sunday.  This is completely uncharacteristic for WoSign - at the weekend, employees in China do not work and no certificates are issued.  There were other circumstantial evidence of forgery dates. <br><br>  In July, StartCom distinguished itself with its <a href="https://www.opennet.ru/opennews/art.shtml%3Fnum%3D44603">StartEncrypt</a> service, launched as a response to the <a href="https://habrahabr.ru/post/278865/">popular Let's Encrypt</a> .  Just by changing one parameter of the POST request at the end of the automatic verification, it was possible to ensure that the certificate was signed not from ‚ÄúStartCom Class 1 DV Server CA‚Äù, but ‚ÄúWoSign CA Free SSL Certificate G2‚Äù or even ‚ÄúCA Ê≤É ÈÄö Ê†π ËØÅ‰π¶‚Äù (another WoSign root certificate).  Some of these certificates, issued by StartCom and signed by ‚ÄúWoSign CA Free SSL Certificate G2‚Äù, are also dated retroactively. <br><br>  Formally, backdating is not prohibited, but this is a vicious practice.  WoSign strongly denied that it falsified the release date of these certificates.  Its representatives claimed that by that time the corresponding code had been removed from the ‚Äúcombat‚Äù servers, which had falsified the date.  But how then were the guys from StartCom able to use the code that even WoSign itself had already stopped using? <br><br>  In general, this episode demonstrates the carelessness of programmers - if in such an important process as issuing certificates, leaving a dangerous code, then sooner or later it will ‚Äúshoot‚Äù.  What happened. <br><br>  In addition, the question remains open, how can StartCom release a certificate on behalf of WoSign so freely?  After all, WoSign CEO assured everyone that companies operate completely independently. <br><br>  Further more: in StartEncrypt discovered <a href="https://www.opennet.ru/opennews/art.shtml%3Fnum%3D44708">critical vulnerabilities</a> .  One allowed as a confirmation of control over the domain to specify the path to any existing file.  For example, upload a file to Dropbox and specify the path to it.  The result would be a certificate release for dropbox.com.  With another vulnerability, an attacker could get a certificate for any site that supports OAuth 2.0 (google.com, facebook.com, paypal.com, linkedin.com, login.live.com). <br><br>  And finally, in September 2016, someone from the community noticed that in the screenshot attached to one of the WoSign reports, the output of the dig utility from the bind-utils package appeared.  The version of this utility is 9.7.3-8.P3.el6.  "El6" means "Red Hat Enterprise Linux 6".  Of course, support for RHEL6 ends only in 2016, but the current version of bind-utils in it is 9.8.2-0.47.rc1.el6.  And "9.7.3-8.P3.el6" corresponds to the non-updated package straight from 2011.  In these five years, 19 vulnerabilities have been closed in the upstream.  Let none of them be critical, you involuntarily ask yourself a question - maybe in WoSign for so many years have not bothered to update not only one server, but the entire infrastructure? <br><br><h3>  And what is the result? </h3><br>  <a href="https://ru.scribd.com/document/325417135/Wo-Sign-and-Start-Com">Moziila decided for a year to stop trusting the new WoSign and StartCom certificates.</a>  Issued earlier, good or bad, remain in force.  For the released year, the certification centers must correct all the shortcomings, and then undergo a series of checks.  Otherwise, their certificates will be blocked forever. <br><br>  Apple Inc., after reviewing the report, announced that <a href="https://support.apple.com/en-us/HT204132">iOS</a> and <a href="https://support.apple.com/en-us/HT202858">macOS</a> indefinitely cease to trust certificates issued after September 19, 2016.  Since Apple's WoSign root certificates are not pre-installed in Apple products, <a href="http://www.theregister.co.uk/2016/10/03/apple_wosign_certificates/">intermediate certificates from StartCom and Comodo</a> used by WoSign will be banned. <br><br>  The reaction of the other largest players in the browser market (Google and Microsoft) is still unknown. <br><br>  <i>Update as of October</i> 10, 2016 <i>: The</i> Chinese company Qihoo 360, which owns both certification centers, <a href="https://xakep.ru/2016/10/10/wosign-vs-mozilla/">agreed to</a> completely separate WoSign and StartCom, and then pass all the required checks.  In addition, the head of WoSign was removed from office. <br><br>  <i>Update as of October 26</i> <a href="https://blog.mozilla.org/security/2016/10/24/distrusting-new-wosign-and-startcom-certificates/">, 2016</a> <i>:</i> Beginning with Firefox 51, <a href="https://blog.mozilla.org/security/2016/10/24/distrusting-new-wosign-and-startcom-certificates/">certificates issued by WoSign and StartCom after October 21, 2016 will be considered invalid.</a>  Certificates using SHA-1 and backdated are revoked via <a href="https://en.wikipedia.org/wiki/Revocation_list">CRL</a> .  The root certificates WoSign and StartCom, with the help of which violations were implemented, will be deleted in the future.  Certifying centers will have to issue new root certificates.  If Mozilla agrees to accept these new root certificates, then their inclusion is just due to the removal of old ones.  And if you do not agree, the old certificates will still be deleted after March 2017.  As for the audit firm ‚ÄúErnst &amp; Young Hong Kong‚Äù, which missed the violations of WoSign, their audits are no longer credible. <br><br>  <i>Update as of November 1</i> <a href="https://security.googleblog.com/2016/10/distrusting-wosign-and-startcom.html">, 2016</a> <i>:</i> Chrome 56 <a href="https://security.googleblog.com/2016/10/distrusting-wosign-and-startcom.html">will mark certificates issued by WoSign and StartCom after October 21, 2016, as not trustworthy</a> . <br><br>  <i>Update as of July 8, 2017:</i> Starting from Chrome 61, the <a href="https://groups.google.com/a/chromium.org/forum/">trust to all WoSign and StartCom certificates</a> , even those issued before October 21, 2016, <a href="https://groups.google.com/a/chromium.org/forum/">completely ceases</a> . <br><br>  <i>Update as of August 9, 2017:</i> Microsoft also <a href="https://blogs.technet.microsoft.com/mmpc/2017/08/08/microsoft-to-remove-wosign-and-startcom-certificates-in-windows-10/">ceases to trust the certificates of these certification authorities</a> .  Windows will continue to trust only certificates issued earlier September 26, 2017. <br><br>  <i>Update as of August 9,</i> 2017 <i>:</i> StartCom management decided to close the company. <br><div class="spoiler">  <b class="spoiler_title">Text of the letter</b> <div class="spoiler_text">  Dear customer, <br><br>  Therefore, you can‚Äôt be able to know how to distribute your browser‚Äôs credentials. <br><br>  The browsers are re-accepted.  He believes that these conditions have been met.  Considering this situation, the owners of the StartCom have decided to make a decision on the company. <br><br>  CRL and OCSP services for two more years. <br><br>  StartCom during this difficult time. <br><br>  StartCom is contacting some other CAs to provide you with the certificates needed.  In case you don‚Äôt want to contact us at certmaster@startcomca.com <br><br>  With the transition process.  We deeply apologize for any inconventions. <br><br>  Best regards, <br><br>  StartCom Certification Authority <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/398161/">https://habr.com/ru/post/398161/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../398151/index.html">We invite you to DIY-mitap October 29</a></li>
<li><a href="../398153/index.html">The function of simultaneous translation in Skype now supports the Russian language.</a></li>
<li><a href="../398155/index.html">Presentation Made By Google at 19:00 Moscow Time [archive of text translation]</a></li>
<li><a href="../398157/index.html">Who is longer or a surprise from Xiaomi 2.5 mm</a></li>
<li><a href="../398159/index.html">Physical economics for kids, part 2</a></li>
<li><a href="../398165/index.html">Guide to creating mechanical tentacles at home: part 1</a></li>
<li><a href="../398167/index.html">3D printing as a tool for prototyping and modeling</a></li>
<li><a href="../398169/index.html">Physicists have created the world's first "crystal of time"</a></li>
<li><a href="../398171/index.html">Speedran Legend of Zelda by manipulating the memory of the game</a></li>
<li><a href="../398173/index.html">SHENZHEN I / O - a new microcontroller programming simulator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>