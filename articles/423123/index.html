<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to raise test project on windows 10 (Cucumber + capybara + selenium-webdriver)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article is intended for familiarity with auto-testing and scanning of the environment in Windows 10 and is intended for those who know Cucumber + ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to raise test project on windows 10 (Cucumber + capybara + selenium-webdriver)</h1><div class="post__text post__text-html js-mediator-article">  The article is intended for familiarity with auto-testing and scanning of the environment in Windows 10 and is intended for those who know <b>Cucumber + Capybara + Selenium-webdriver even a little</b> .  The idea for the article came about because of the differences in deploying the environment on Windows 10 and Linux. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ww/rj/s-/wwrjs-iwpbsztyvj1ocolretoz0.jpeg"></div><br>  A few words about gem-ah (libraries) Cucumber + Capybara + Selenium-webdriver, which are needed to run and fill UI tests with tests. <br><br><h4>  Cucumber </h4><br>  ucumber is a heme that allows writing tests in human language.  To do this, use the Gherkin notation, which defines the structure and rules for writing scripts.  You can read in detail <a href="https://wellbehaved.readthedocs.io/Gherkin.html">here.</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/b2/n_/ly/b2n_lym6xgyjm1tmbqlrj2ikhvs.jpeg"></div><br><h4>  Capybara </h4><br>  Capybara is a gem that allows you to search / click / ... by browser elements.  Those.  It is a link between the Cucumber steps (steps) of the test, and the webdriver (an instance of the browser being called).  <a href="https://www.rubydoc.info/github/jnicklas/capybara/Capybara/Node/Finders">Here</a> you can look at the methods of this heme. <br><br><h4>  Selenium-webdriver </h4><br>  Selenium-webdriver is a tool to automate web browser actions.  Essentially, this is an instance of the browser. <br><a name="habracut"></a><br><h4>  Preliminary actions </h4><br><div class="spoiler">  <b class="spoiler_title">Description of preliminary actions</b> <div class="spoiler_text">  For convenience of demonstration we will use RubyMine.  You can <a href="https://www.jetbrains.com/ruby">download a trial version</a> for 30 days. <br><br>  Download Firefox and Chrome to run tests. <br><br>  Download and install Git (version control system or similar VCS, <a href="https://gitforwindows.org/">official website</a> ).  But Git is needed when you already have a project or you want to store your code in the Git system. <br></div></div><br><h4>  So, let's begin </h4><br>  We already have RubyMine installed. <br><br><ol><li>  You need to install the Ruby language itself.  To do this, go <a href="https://www.ruby-lang.org/ru/documentation/installation/">here</a> and set RubyInstaller.  I chose the latest release (RubyInstaller 2.5.1-2) with the DevKit package.  Through this setup package, you can run tests from the console, as in Linux, as well as flexibly manage gems. </li><li>  The RubyInstaller package is installed and we proceed to the configuration. <br>  If we want to create a new project, then open RubyMine and create an empty project, specifying the installed Ruby. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h4/nm/tf/h4nmtfigi9avbshzxmctt1go0v4.jpeg"></div></li><li>  Next, we need to create just such a folder and file structure according to the annotation <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kg/mv/qp/kgmvqptts6xoxwmvblc-tu0q-ca.jpeg"></div><br>  Described in detail <a href="http://www.seleniumframework.com/frameworks/cucumber-project-structure">here.</a> </li><li>  Gemfile - contains a list of gems that are used in the project <br><br><div class="spoiler">  <b class="spoiler_title">Here are the contents of our gemfile, with the most basic gems for UI tests.</b> <div class="spoiler_text"><blockquote><pre><code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">source</span></span> <span class="hljs-string"><span class="hljs-string">'https://rubygems.org'</span></span> gem <span class="hljs-string"><span class="hljs-string">'cucumber'</span></span> gem <span class="hljs-string"><span class="hljs-string">'capybara'</span></span> gem <span class="hljs-string"><span class="hljs-string">'selenium-webdriver'</span></span> gem <span class="hljs-string"><span class="hljs-string">'chromedriver-helper'</span></span></code> </pre> </blockquote><br></div></div><br>  These 4 gems must be specified in the gemfile. <br>  gem 'chromedriver-helper' is a chrome driver allowing you to run testers on Chrome <br>  With this Gemfile, you need to install our favorite gems.  It is easiest to install on Windows from the RubyMine interface: <b>Tools -&gt; Bundler -&gt; Install menu</b> .  A bundler is also a gem, but serves to control gems.  But it can also be done from the command line, which is located in the program menu under the name Start Command Prompt ... <br>  By the way, using this command line, you can run tests bypassing RubyMine. <br></li><li>  The env.rb file is a key rb file for running UI tests.  When initializing variables and test files, env.rb will be the very first.  It registers the browser on which the testers will run.  Ready example env.rb, where the registration of Chrome, Firefox takes place or let us make it clear that we don‚Äôt need a browser at all to run tests. <br>  Cases when a browser is not needed - we check rest requests, integration testing, although it is considered that Cucumber tests are not quite suitable for this. <br><br><div class="spoiler">  <b class="spoiler_title">Writing env.rb</b> <div class="spoiler_text"><blockquote><pre> <code class="hljs ruby"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'capybara/cucumber'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'selenium-webdriver'</span></span> Capybara.register_driver <span class="hljs-symbol"><span class="hljs-symbol">:driver</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|app|</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ENV[<span class="hljs-string"><span class="hljs-string">'DRIVER'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'chrome'</span></span> Capybara::Selenium::Driver.new(app, <span class="hljs-symbol"><span class="hljs-symbol">:browser</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:chrome</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> <span class="hljs-string"><span class="hljs-string">'without_browser'</span></span> Capybara.default_driver = <span class="hljs-symbol"><span class="hljs-symbol">:mechanize</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> client = Selenium::WebDriver::Remote::Http::Default.new Capybara::Selenium::Driver.new(app, <span class="hljs-symbol"><span class="hljs-symbol">:browser</span></span> =&gt; <span class="hljs-symbol"><span class="hljs-symbol">:firefox</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">port:</span></span> <span class="hljs-number"><span class="hljs-number">10000</span></span> + Random.rand(<span class="hljs-number"><span class="hljs-number">1000</span></span>), <span class="hljs-symbol"><span class="hljs-symbol">http_client:</span></span> client) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Capybara.default_driver = <span class="hljs-symbol"><span class="hljs-symbol">:driver</span></span> Capybara.default_selector = <span class="hljs-symbol"><span class="hljs-symbol">:xpath</span></span></code> </pre> </blockquote><br></div></div><br>  Also, here you need to mention the issue of versioning Firefox. <br>  If you have Firefox version 46 or lower installed, then to run the tests correctly, you need gem 'capybara' version '2.53.4' or lower. <br><br>  If the Firefox version is higher than 46, then it works according to other principles on the basis of ‚Äúgeckodriver‚Äù and therefore you need to <a href="https://selenium-python.com/install-geckodriver">install a geckodriver in</a> order to correctly launch the <a href="https://selenium-python.com/install-geckodriver">test</a> . <br><br><div class="spoiler">  <b class="spoiler_title">A tour of the reasons for what you need geckodriver</b> <div class="spoiler_text">  Before version 47, the Firefox automation driver was just an extension that was included in every client.  But this extension was removed due to a policy change that now requires all extensions to be signed by Mozilla. <br><br>  Marionette is a new driver that comes with Firefox.  This driver has its own protocol, which is incompatible with the Selenium / WebDriver protocol. <br><br>  Geckodriver is an application server that implements the Selenium / WebDriver protocol.  He translates the Selenium commands and redirects them to the Marionette driver. <br></div></div><br>  <b>An important nuance</b> , after installing ‚Äúgeckodriver‚Äù, it is necessary to prescribe the system paths in order for our ‚Äúgeckodriver‚Äù to be found when executing env.rb. <br><br><div class="spoiler">  <b class="spoiler_title">system paths</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/na/qm/jd/naqmjdhlfa_o9xn8jqax-oqmkfk.jpeg"><br></div></div><br></li><li>  Then you just have to write a test test and run it on Chrome, Firefox and without a browser :).  For example, let's write a few steps to enter mail.ru mail <br><br><div class="spoiler">  <b class="spoiler_title">Description of steps</b> <div class="spoiler_text"><blockquote><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">encoding</span></span>: UTF<span class="hljs-number"><span class="hljs-number">-8</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">language</span></span>: ru Given(/^   "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |page| visit page <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^  "(.*?)"   c id "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |<span class="hljs-type"><span class="hljs-type">text</span></span>, field_id| find("//input[@id='#{field_id}']").<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(<span class="hljs-type"><span class="hljs-type">text</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^  "(.*?)"     id "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |<span class="hljs-type"><span class="hljs-type">text</span></span>, select_id| find("//select[@id='#{select_id}']/option[text()='#{text}']").click <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^    "(.*?)"$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |<span class="hljs-type"><span class="hljs-type">text</span></span>| find("//input[@value='#{text}']").click <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Given(/^ (\d+) (?:|)$/) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> |sec| sleep sec.to_i <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> </blockquote><br></div></div><br></li><li>  And also the cucumber test itself <br><br><div class="spoiler">  <b class="spoiler_title">test.feature</b> <div class="spoiler_text"><blockquote><pre> <code class="hljs swift"># encoding: <span class="hljs-type"><span class="hljs-type">UTF</span></span>-<span class="hljs-number"><span class="hljs-number">8</span></span> # language: ru :   :       <span class="hljs-string"><span class="hljs-string">"https://mail.ru/"</span></span>    <span class="hljs-string"><span class="hljs-string">"dorian.grey.2019"</span></span>   <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> id <span class="hljs-string"><span class="hljs-string">"mailbox:login"</span></span>    <span class="hljs-string"><span class="hljs-string">"********"</span></span>   <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> id <span class="hljs-string"><span class="hljs-string">"mailbox:password"</span></span>    <span class="hljs-string"><span class="hljs-string">"@inbox.ru"</span></span>     id <span class="hljs-string"><span class="hljs-string">"mailbox:domain"</span></span>      <span class="hljs-string"><span class="hljs-string">""</span></span>   <span class="hljs-number"><span class="hljs-number">5</span></span> </code> </pre> </blockquote><br></div></div><br></li><li>  It remains only to check all our efforts and enjoy the success of the UI tests (in example 1 test) :).  Remained the last setting - setting up the run tests.  Go to the menu RubyMine -&gt; Edit Configurations -&gt; Runner Options - Here we make the driver selection :) <br>  ENV ['DRIVER'] of env.rb is the launch setting.  And we just need to specify in the Runner Options ‚ÄúDRIVER = firefox‚Äù or ‚ÄúDRIVER = chrome‚Äù. <br></li></ol><br>  Run <br><br><img src="https://habrastorage.org/webt/fy/dg/7i/fydg7ieltbsbgugy2teio6e6btu.jpeg"><br><br>  That's all, successful Cucumber tests! </div><p>Source: <a href="https://habr.com/ru/post/423123/">https://habr.com/ru/post/423123/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423109/index.html">What did Apple introduce and what did iOS developers think about it</a></li>
<li><a href="../423115/index.html">Improved effects with background layer blending in CSS</a></li>
<li><a href="../423117/index.html">Live longer or slower to grow old: a technological approach to old age</a></li>
<li><a href="../423119/index.html">DIY TTL arcade machine ... in 2018</a></li>
<li><a href="../423121/index.html">Low level brainfuck</a></li>
<li><a href="../423125/index.html">Geosharing applications</a></li>
<li><a href="../423127/index.html">Pluto is considered a planet</a></li>
<li><a href="../423129/index.html">Myths and excuses that interfere with learning English</a></li>
<li><a href="../423131/index.html">TL; DR of the book ‚ÄúThe Art of Science and Engineering‚Äù by Richard Hamming</a></li>
<li><a href="../423133/index.html">Preventive interface: Google search results page redesign based on suicidal queries</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>