<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a face recognition model using deep learning in Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translator Elena Bornovolokova specifically for Netology adapted the article by Fayzan Shaykh on how to create a face recognition model and in what ar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a face recognition model using deep learning in Python</h1><div class="post__text post__text-html js-mediator-article">  <i>Translator Elena Bornovolokova specifically for <a href="https://netology.ru/%3Futm_source%3Dblog%26utm_medium%3D747%26utm_campaign%3Dhabr%26stop%3D1">Netology</a> adapted the <a href="https://www.analyticsvidhya.com/blog/2018/12/introduction-face-detection-video-deep-learning-python/">article by</a> Fayzan Shaykh on how to create a face recognition model and in what areas it can be applied.</i> <br><br><h2>  Introduction </h2><br>  In recent years, computer vision has gained popularity and stood out in a separate direction.  Developers create new applications that are used throughout the world. <a name="habracut"></a><br>  In this direction, I am attracted to the concept of open source.  Even technology giants are ready to share new discoveries and innovations with everyone, so that technology does not remain the privilege of the rich. <br><br>  One of these technologies is face recognition.  With proper and ethical use, this technology can be applied in many areas of life. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this article, I will show you how to create an effective face recognition algorithm using open source tools.  Before turning to this information, I want you to prepare and be inspired by watching this video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wr4rx0Spihs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Face recognition: potential applications </h2><br>  I will cite several potential applications of facial recognition technology. <br><br>  <b>Face recognition in social networks</b> .  Facebook has replaced manual tagging of images with automatically generated tag offers for each image uploaded to the platform.  Facebook uses a simple face recognition algorithm to analyze pixels in an image and compare it with relevant users. <br><br>  <b>Face recognition in security</b> .  A simple example of using face recognition technology to protect personal data is unlocking a smartphone "face by".  This technology can be implemented in the access system: a person looks into the camera, and she determines whether to allow him to enter or not. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/bYrRQQX2PvY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <b>Face recognition to count the number of people</b> .  Face recognition technology can be used when calculating the number of people attending an event (for example, a conference or a concert).  Instead of manually counting the participants, we install a camera that can capture images of the faces of the participants and give out the total number of visitors.  This will help automate the process and save time. <br><br><img src="https://habrastorage.org/webt/fn/bc/-k/fnbc-kgpcaeogtd4attryczyjfq.png"><br><br><h2>  System Setup: Hardware and Software Requirements </h2><br>  Consider how we can use facial recognition technology, referring to the open source tools available to us. <br><br>  I used the following tools that I recommend to you: <br><br><ul><li>  Webcam (Logitech C920) for building a face recognition model in real time on a Lenovo E470 ThinkPad laptop (Core i5 7th Gen).  You can also use your laptop‚Äôs built-in camera or camcorder with any suitable system for real-time video analysis instead of the ones I used. <br></li><li>  It is preferable to use a graphics processor for faster video processing. <br></li><li>  We used the Ubuntu 18.04 operating system with all the necessary software. <br></li></ul><br>  Before we start building our facial recognition model, let's look at these points in more detail. <br><br><h3>  Step 1: Hardware Setup </h3><br>  Check if the camera is configured correctly.  With Ubuntu, this is easy: see if the device is recognized by the operating system.  To do this, follow these steps: <br><br><ol><li> Before connecting a webcam to a laptop, check all connected video devices by typing <code>ls /dev/video*</code> on the command line.  As a result, a list of all video devices connected to the system will be displayed. <img src="https://habrastorage.org/webt/za/h8/9m/zah89mjqr1gezzo8xekib9fhmzw.png"></li><li>  Connect the webcam and set the command again.  If the webcam is connected correctly, the new device will be reflected in the result of the command. <img src="https://habrastorage.org/webt/bs/og/lc/bsoglcdg4tevubdfds6reijtogw.png"></li><li>  You can also use the webcam software to check its correct operation.  In Ubuntu, you can use the program "Cheese". <img src="https://habrastorage.org/webt/jl/9t/f3/jl9tf3b3qke5udd2fu3h1mzbcmo.png"></li></ol><br><h3>  Step 2: Software Setup </h3><br>  <b>Step 2.1: Install Python</b> <br><br>  The code in this article is written using Python (version 3.5).  To install Python, I recommend using <a href="https://www.anaconda.com/download">Anaconda</a> , a popular Python distribution for data processing and analysis. <br><br>  <b>Step 2.2: Install OpenCV</b> <br><br>  <a href="https://opencv.org/">OpenCV</a> is an open source library designed to create computer vision applications.  Installing OpenCV is done using <code>pip</code> : <br><br><pre> <code class="python hljs">pip3 install opencv-python</code> </pre> <br>  <b>Step 2.3: Install the face_recognition API</b> <br><br>  We will use the <code>face_recognition API</code> , which is considered the easiest API to recognize faces in Python around the world.  To install, use: <br><br><pre> <code class="python hljs">pip install dlib pip install face_recognition</code> </pre> <br><h2>  Implementation </h2><br>  After setting up the system, proceed to the implementation.  To begin with, we will create a program, and then we will explain what we have done. <br><br><h3>  Walkthrough </h3><br>  Create a <code>face_detector.py</code> file and then copy the code below: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># import libraries import cv2 import face_recognition # Get a reference to webcam video_capture = cv2.VideoCapture("/dev/video1") # Initialize variables face_locations = [] while True: # Grab a single frame of video ret, frame = video_capture.read() # Convert the image from BGR color (which OpenCV uses) to RGB color (which face_recognition uses) rgb_frame = frame[:, :, ::-1] # Find all the faces in the current frame of video face_locations = face_recognition.face_locations(rgb_frame) # Display the results for top, right, bottom, left in face_locations:  # Draw a box around the face  cv2.rectangle(frame, (left, top), (right, bottom), (0, 0, 255), 2) # Display the resulting image cv2.imshow('Video', frame) # Hit 'q' on the keyboard to quit! if cv2.waitKey(1) &amp; 0xFF == ord('q'):  break # Release handle to the webcam video_capture.release() cv2.destroyAllWindows()</span></span></code> </pre> <br>  Then run this Python file by typing: <br><br><pre> <code class="python hljs">python face_detector.py</code> </pre> <br>  If everything works correctly, a new window will open with running face recognition mode in real time. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/eh14NomINOs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Let's summarize and explain what our code did: <br><br><ol><li>  First, we <b>specified the hardware</b> on which the video analysis will be performed. <br></li><li>  Next, we made a <b>video capture</b> in real time frame by frame. <br></li><li>  Then they <b>processed each frame</b> and <b>extracted the location of all the faces</b> in the image. <br></li><li>  As a result, <b>these frames were reproduced in the form of a video,</b> along with an indication of where the faces are located. <br></li></ol><br><h3>  An example of the use of face recognition technology </h3><br>  At this all the fun does not end there.  We will do another cool thing: create a full-fledged application example based on the code above.  Let's make some small changes to the code, and everything will be ready. <br><br>  Suppose you want to create an automated system using a video camera to track where the speaker is at a given time.  Depending on its position, the system rotates the camera so that the speaker always remains in the center of the frame. <br>  The first step is to create a system that identifies the person or people in the video and focuses on the location of the speaker. <br><br><img src="https://habrastorage.org/webt/xg/q-/ub/xgq-ubchs7yktjujlxcoakih7d0.png"><br><br>  We will analyze how to do this.  As an example, I chose a video on YouTube with speakers from the DataHack Summit 2017 conference. <br><br>  First we import the necessary libraries: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cv2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> face_recognition</code> </pre> <br>  Then we read the video and set the length: <br><br><pre> <code class="python hljs">input_movie = cv2.VideoCapture(<span class="hljs-string"><span class="hljs-string">"sample_video.mp4"</span></span>) length = int(input_movie.get(cv2.CAP_PROP_FRAME_COUNT))</code> </pre> <br>  After that we create an output file with the required resolution and frame rate similar to the one in the input file. <br><br>  Download the image of the speaker as a sample to recognize it in the video: <br><br><pre> <code class="python hljs">image = face_recognition.load_image_file(<span class="hljs-string"><span class="hljs-string">"sample_image.jpeg"</span></span>) face_encoding = face_recognition.face_encodings(image)[<span class="hljs-number"><span class="hljs-number">0</span></span>] known_faces = [ face_encoding, ]</code> </pre> <br>  When finished, start the cycle, which will be: <br><br><ul><li>  Extract frame from video. <br></li><li>  Find all faces and identify them. <br></li><li>  Create a new video that will combine the original frame with the location of the speaker‚Äôs face with the signature. <br></li></ul><br>  Let's look at the code that will do this: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Initialize variables face_locations = [] face_encodings = [] face_names = [] frame_number = 0 while True: # Grab a single frame of video ret, frame = input_movie.read() frame_number += 1 # Quit when the input video file ends if not ret:  break # Convert the image from BGR color (which OpenCV uses) to RGB color (which face_recognition uses) rgb_frame = frame[:, :, ::-1] # Find all the faces and face encodings in the current frame of video face_locations = face_recognition.face_locations(rgb_frame, model="cnn") face_encodings = face_recognition.face_encodings(rgb_frame, face_locations) face_names = [] for face_encoding in face_encodings:  # See if the face is a match for the known face(s)  match = face_recognition.compare_faces(known_faces, face_encoding, tolerance=0.50)  name = None  if match[0]:      name = "Phani Srikant"  face_names.append(name) # Label the results for (top, right, bottom, left), name in zip(face_locations, face_names):  if not name:      continue      # Draw a box around the face  cv2.rectangle(frame, (left, top), (right, bottom), (0, 0, 255), 2)  # Draw a label with a name below the face  cv2.rectangle(frame, (left, bottom - 25), (right, bottom), (0, 0, 255), cv2.FILLED)       font = cv2.FONT_HERSHEY_DUPLEX  cv2.putText(frame, name, (left + 6, bottom - 6), font, 0.5, (255, 255, 255), 1) # Write the resulting image to the output video file print("Writing frame {} / {}".format(frame_number, length)) output_movie.write(frame) # All done! input_movie.release() cv2.destroyAllWindows()</span></span></code> </pre> <br>  The code will give you this result: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/uOcN6FhX6gY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  From the Editor </h2><br>  Courses "Netology" on the topic: <br><br><ul><li>  online profession " <a href="https://netology.ru/programs/python%3Futm_source%3Dblog%26utm_medium%3D747%26utm_campaign%3Dhabr">Python-developer</a> " </li><li>  online profession " <a href="https://netology.ru/programs/data-scientist%3Futm_source%3Dblog%26utm_medium%3D747%26utm_campaign%3Dhabr">Data Scientist</a> " </li></ul></div><p>Source: <a href="https://habr.com/ru/post/434354/">https://habr.com/ru/post/434354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../434340/index.html">How we audited Wi-Fi in the Delhi metro and what came of it</a></li>
<li><a href="../434342/index.html">MIT course "Computer Systems Security". Lecture 22: MIT Information Security, Part 1</a></li>
<li><a href="../434344/index.html">MIT course "Computer Systems Security". Lecture 22: MIT Information Security, Part 2</a></li>
<li><a href="../434346/index.html">MIT course "Computer Systems Security". Lecture 22: MIT Information Security, Part 3</a></li>
<li><a href="../434348/index.html">Do you remember your password on Habr√©?</a></li>
<li><a href="../434356/index.html">Python Stiller Mailing</a></li>
<li><a href="../434358/index.html">Import Substitution Operating Systems. How do I see domestic OS</a></li>
<li><a href="../434360/index.html">Explanatory conversation about asynchronous programming in Javascript</a></li>
<li><a href="../434362/index.html">Non-forecast for 2019</a></li>
<li><a href="../434364/index.html">Hangfire queue support</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>