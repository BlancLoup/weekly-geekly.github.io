<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>From February 13, Gmail will filter attachments in .js format</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=".Js attachments became the most popular way to distribute cryptographers in 2016. Statistics: Proofpoint 

 Gmail does not allow sending email attachm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>From February 13, Gmail will filter attachments in .js format</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/03a/1f6/f78/03a1f6f7821a7279e461e5b32dd62e8b.png"><br>  <i>.Js attachments became the most popular way to distribute cryptographers in 2016.</i>  <i><font color="gray">Statistics: <a href="https://www.proofpoint.com/us/threat-insight/post/beware-javascript-malicious-email-campaigns-with-js-attachments-explode">Proofpoint</a></font></i> <br><br>  Gmail does not allow sending email attachments in the <a href="https://support.google.com/mail/answer/6590">following formats</a> : ADE, ADP, BAT, CHM, CMD, COM, CPL, EXE, HTA, INS, ISP, JAR, JSE, LIB, LNK, MDE, MSC, MSP, MST, PIF, SCR, SCT, SHB, SYS, VB, VBE, VBS, VXD, WSC, WSF, WSH.  Yesterday, the official blog of the G Suite published a <a href="https://gsuiteupdates.googleblog.com/2017/01/gmail-will-restrict-js-file-attachments.html">message</a> that from February 13, 2017, the list of prohibited file formats for transfer via Gmail will be added to the .js format (JavaScript). <br><br>  The fact is that in the Windows operating system, such files are launched by default using the Windows Script Host system component, so you can <a href="https://nakedsecurity.sophos.com/2016/04/26/ransomware-in-your-inbox-the-rise-of-malicious-javascript-attachments/">embed a binary with a cryptographic security system in .js</a> and send it to users under Windows.  Outside of the browser, Windows Script Host allows you to save files and run them for execution, establish network connections with any server, request web content. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/geektimes/post_images/2ae/b53/484/2aeb53484c9bbd28969f6db55c5d84b3.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Built-in Gmail filters block messages with executable files to prevent the spread of viruses.  Compression in GZ / BZ2 or ZIP / TGZ does not help.  Gmail filters automatically unzip and decompress all attachments to all emails - and check their contents (probably, the server is protected against ZIP bombs, about them below). <br><br>  Protecting the archive with a password also does not save - Gmail does not allow the transfer of password-protected archives.  In addition, it is prohibited to send archives with attached archives that are password protected.  Thus, to transfer the executable file you have to look for other ways.  For example, archive and rename to JPG. <br><br>  In February, when you try to download a .js attachment, the message "Blocked for security reasons" appears in the Gmail web interface, explaining the reasons. <br><br><img src="https://habrastorage.org/files/2b9/81e/e2c/2b981ee2c02e4dbd872de899e13f3b07.png"><br><br>  Gmail has advanced filters, so the transfer of a JPG image with a built-in virus can also be blocked, as well as links to malicious pages.  Google itself recommends uploading files to Google Drive, Google Could Storage or other hosting to share files and share the link.  If no virus is found in the file, the letter with the link will pass through the filter. <br><br><h1>  Archival bomb protection </h1><br>  In order to verify the archives on the server to filter spam and viruses, Google probably had to implement protection against ZIP bombs, otherwise the company's servers would fall victim to a DoS attack. <br><br>  The most popular ZIP bomb format has been known since ancient times.  This is a recursive archive of type <i>42.zip</i> , which is unpacked into itself.  If you start unpacking it, the process will continue until the data set reaches the upper unpacking limit of 4.3 gigabytes.  In this case, the process will take more than 4.5 petabytes in RAM (4 503 599 626 321 920 bytes). <br><br>  A similar option is used in the DoS attack using PNG, which was first <a href="https://www.bamsoftware.com/hacks/deflate.html">described</a> in 2015 by programmer and hacker David Fifield.  As is known, the graphical format PNG uses the DEFLATE compression algorithm in the zlib library.  The programmer calculated what the maximum size of the image with the minimum file size can be.  The idea is that the file can be quickly transferred over the network, but at the same time it did not fit in the RAM on the server. <br><br>  As a result of various experiments, the author came to the most optimal ratio of file size and occupied memory.  Archive <a href="">spark.png.bz2</a> size of only 420 bytes in memory occupies 141.4 GB. <br><br>  It is implemented as follows.  First, the <a href="https://www.bamsoftware.com/hacks/deflate.html">DEFLATE</a> algorithm replaces duplicate strings with pointers (LZ77), with each pair of bits encodes 258 identical bytes with zeros.  The compression ratio is 1032 to 1. Then bzip2 is taken into account, which compresses a long set of identical values ‚Äã‚Äãinto the most compact form.  The 420 byte archive contains a PNG file with a size of 6,132,534 bytes (5.8 MB) and an image of 225,000 √ó 225,000 pixels (50,625 gigapixels).  In a pixel buffer with three bytes per pixel, the picture will take about 141.4 GB.  The picture consists almost entirely of zeros, with a secret message in the center.  For better compression, single-bit color space is used, although most graphics rendering software still reserves three bits per pixel and expands the image to 141.4 gigabytes. <br><br>  In Gmail, Habrastorage and other web applications, of course, protection against PNG archive bombs is implemented (for more details, see the article ‚Äú <a href="http://libpng.sourceforge.net/decompression_bombs.html">Protecting Libpng applications from archive bombs</a> ‚Äù).  Scanning files on the server is performed in an isolated sandbox, and if the attachment in your letter ‚Äúcrashes‚Äù the sandbox, then this will not affect the work of other Google servers. <br><br>  However, the use of compression in graphic formats allows you to show creativity and apply other tricks, for example, with <a href="http://probablyprogramming.com/2009/03/15/the-tiniest-gif-ever">GIF compression</a> . <br><br><h1>  Spreading malware through .js files </h1><br>  Recently, attackers have often spread malware, attaching JavaScript scripts to letters.  For example, <a href="https://www.trustwave.com/Resources/SpiderLabs-Blog/Massive-Volume-of-Ransomware-Downloaders-being-Spammed/">in this way, the</a> authors of the Locky cryptographer distributed the bootloader loader. <br><br><img src="https://habrastorage.org/files/d3b/ce7/f78/d3bce7f78ca54872bfab1d15e25b0d5e.png"><br>  <i>Attachment to the letter contains a script that downloads the Locky executable file.</i> <br><br><img src="https://habrastorage.org/files/c05/4fb/298/c054fb298576462c974be6a97574d32e.png"><br>  <i>Script code with reference to the executable file</i> <br><br>  Later, the authors of Locky became impudent and <a href="http://blog.cyren.com/articles/2016-Q3_locky-ransomware-now-embedded-in-javascript.html">immediately</a> began <a href="http://blog.cyren.com/articles/2016-Q3_locky-ransomware-now-embedded-in-javascript.html">to embed the binary in .js</a> . <br><br>  In addition to Locky, other cryptogers ( <a href="http://blog.emsisoft.com/2016/01/01/meet-ransom32-the-first-javascript-ransomware/">Ransom32</a> , <a href="https://www.bleepingcomputer.com/news/security/the-new-raa-ransomware-is-created-entirely-using-javascript/">RAA</a> ), as well as <a href="https://www.proofpoint.com/us/threat-insight/post/beware-javascript-malicious-email-campaigns-with-js-attachments-explode">other malicious software,</a> have long been distributed through .js attachments. <br><br>  After blocking .js in Gmail, attackers will have to use other methods to distribute links to malware via email, instant messengers, Twitter and social networks.  There are many such ways. </div><p>Source: <a href="https://habr.com/ru/post/357248/">https://habr.com/ru/post/357248/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357238/index.html">Fingerprinting of a specific PC with an accuracy of 99.24%: even changing a browser does not save</a></li>
<li><a href="../357240/index.html">Channel One investigates the leak of the last episode of the series "Sherlock"</a></li>
<li><a href="../357242/index.html">The Ministry of Communications did not support the petition for the cancellation of the Yarovaya-Ozerov package. The law will be amended</a></li>
<li><a href="../357244/index.html">Chinese government announces private VPN services - outlawed</a></li>
<li><a href="../357246/index.html">16 branches of the St. Louis library paralyzed cryptographer</a></li>
<li><a href="../357250/index.html">SSD was confiscated from the owner of LeakedSource, servers were arrested</a></li>
<li><a href="../357252/index.html">Be careful when registering domains</a></li>
<li><a href="../357254/index.html">"Yandex Browser" will be forced to install on the computers of Moscow officials</a></li>
<li><a href="../357256/index.html">Creation of malware. A responsibility</a></li>
<li><a href="../357258/index.html">In Cameroon, blocking the Internet. Causes of what is happening</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>