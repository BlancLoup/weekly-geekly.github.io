<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>So you decided to deploy OpenStack</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="You've probably heard about OpenStack. Damn, yes, they talk about him at every more or less related event. All and sundry advocate OpenStack. Fashiona...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>So you decided to deploy OpenStack</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/web/eff/d61/a4f/effd61a4f32e4f038c4eb9b5b0d0e78c.jpg"></div><br>  You've probably heard about OpenStack.  Damn, yes, they talk about him at every more or less related event.  All and sundry advocate OpenStack.  Fashionable, youth, everything is already there, Open Source, come on come.  And after listening to tons of marketing bulshit, you decide: We will install OpenStack! <br><br>  I did not conduct any special research on this subject, but there seems to be not so much negative reviews about him, at least in Russian.  At first glance, everything looks fantastic.  Well, if you please present my personal post hate OpenStack. <br><a name="habracut"></a><br><h3>  Prehistory </h3><br>  I learned about OpenStack at an OSS conference in about 2012.  At that time I worked in a company actively using large clusters (100+ machines), but without virtualization, orchestrating (kickstarter + IBM CSM for the score?) And mostly with batch execution of tasks: I started, worked, took the result.  A full understanding of what clouds are and why they are not needed yet, but interest has arisen.  Of course, immediately there was a desire to deploy a new cool thing, which right now will do everything well. <br><br>  A little later in the same year, such an opportunity presented itself, though within the framework of a startup.  It was necessary to deploy a project that uses clustering and scaling, but it was necessary to isolate the environments and share resources of one machine by several services - the budget is still not rubber. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In general, in 2012 we deployed OpenStack, at that time it was Essex, we launched the project, lived with such a cloud infrastructure until 2014, it seems until the Grizzly release inclusive.  Forces and desires to support it further were not, and OpenStack was drunk with shame. <br><br>  Once upon a time I even thought of writing an article on how to put it correctly, with comments on what to pay attention to.  But you know, I changed my mind.  Do not put it better at all.  Just do not mess.  Probably, some of the theses are already outdated, write in the comments about what I m ‚Äã‚Äã*** to and did not understand, but in general I do not think that the situation has changed dramatically. <br><br>  So let's get started, what I don‚Äôt like about Openstack and you‚Äôll probably not like it. <br><br><h3>  It is too complex </h3><br>  Not even that.  He, *****, <b>MONSTERIOUS</b> .  No, see for yourself. <br><br><img src="https://habrastorage.org/web/cae/a2b/044/caea2b0440bd433ab845ebbadf1275b5.png"><br><br>  Once upon a time, when we put Essex, everything was relatively simple and clear.  Keystone (authorization service), Glance (image storage service) and Nova (hypervisor management service).  In addition, there was still a Horizon (dashboard) and a bunch of small and not very dependencies.  Each node of the system is almost dozens of auxiliary demons.  After a while it becomes scary to look at the controller node. <br><br><img src="https://habrastorage.org/web/1a7/2b3/b7b/1a72b3b7b0b1438c9659a4f3c49e42ad.png"><br><br>  So, when our virtual cluster approached 20 servers, the controller node began to shamelessly slow down, for some strange reason.  Well, more precisely understandable, but I do not understand why the identity service loaded the processor 100%? <br><br>  From complexity comes the following disadvantage. <br><br><h3>  He is tangled </h3><br>  The OpenStack architecture is quite fragmented.  There are a very large number of "moving parts", the relationship between which is not always absolutely clear.  Did you break something?  Okay, try to figure out where it broke and why.  The OpenStack Foundation seems proud that the OpenStack has more than 20 million lines of code, even to the main page of its site.  So, <b>this nifiga not dignity</b> . <br><br>  The code is mostly written in Python.  Thanks, OpenStack, thanks to you, I hated Python and everything related to it.  Perhaps now with the documentation better, but before it almost was not.  The logic may well begin in one daemon, and then with the help of requests through RabbitMQ will be executed completely in another and even on another machine.  Needless to say that writing your own extensions for OpenStack is not at all easy.  It's one thing if it's just a small hack, another thing if it's a full-fledged plug-in with new functionality.  5 lines of code you definitely will not do. <br><br>  If you need to get under the hood to understand what is happening there ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce4/868/8e3/ce48688e3588b16d9690d4f63cfb1a2a.gif" alt="image"><br><br>  The fact is that being an OSS, OpenStack tries to be kind of unix-way.  Those.  under the hood, all these monstrous services actually pull tens and hundreds of unix-utilities according to your own logic, which you will have to learn and maybe even debazhit.  With the documentation, at least it used to be, everything is bad.  Why do you need to tell exactly which iptables rules we add to the host and for what?  We have a super cool application that does everything by itself and does not require your intervention.  Want to add your own rules?  Well, good luck, the source code is open. <br><br>  While you are more or less fit into the script, the authors supposed - all more or less ok.  If you need to take a step aside, wait for the difficulties.  Stock up on man's, patience, you may have to explore some more problems that are not directly related to the task, for example, how does RabbitMQ work and what else does he need? <br><br>  This causes the following problem. <br><br><h3>  He is unreliable </h3><br>  It would seem logical, the more complex the system, the less reliable it is.  But apparently this truth is not for everyone.  Get ready to search for the source of underground knocks, run demons in the <b>RIGHT</b> sequence, google a lot and read logs, dig into the source and that's it. <br><br>  Some decisions in my opinion are simply controversial.  Is the metadata service on a virtual IP address emulated via iptables?  Seriously?  Very "reliable" work dnsmasq on issuing IP virtualkam.  Thousands of them. <br><br>  And this is compounded by the fact that ... <br><br><h3>  It gets even bigger </h3><br>  As I already mentioned, when we were just starting to use it, there were not so many services, although some problems were already there.  But with each release of services becomes even more. <br><br>  For example, look at the current list of services, each of which adds a few more daemons to your machine: <br><br><ul><li>  Identity service (keystone) </li><li>  Image service (glance) </li><li>  Compute service (nova) </li><li>  Networking service (neutron) </li><li>  Dashboard (horizon) </li><li>  Block Storage service (cinder) </li><li>  Bare Metal service (ironic) </li><li>  Container Infrastructure Management service (magnum) </li><li>  Database service (trove) </li><li>  DNS service (designate) </li><li>  Key Manager service (barbican) </li><li>  Messaging service (zaqar) </li><li>  Object Storage services (swift) </li><li>  Orchestration service (heat) </li><li>  Shared File Systems service (manila) </li><li>  Telemetry Alarming services (aodh) </li><li>  Telemetry Data Collection service (ceilometer) </li></ul><br>  Yes, it is not formally necessary to install absolutely all services.  But do not think that some kind of nothing, which is not in the main service, can be easily and simply added to your infrastructure. <br><br>  For example, at the time of Essex there was no easy way to add an entry about your new virtual machine to your DNS service.  Hands - please.  Hooks?  No, not heard.  I did not wait for the birth of designate. <br><br>  And you know what? <br><br><h3>  It breaks </h3><br>  From release to release.  Those.  Well, you have finally washed down the infrastructure of your dreams, at the very least everything works as expected, but one piece of detail is missing.  And in the new release it is.  Well, at least on the release notes. <br><br>  Ok google, let's update our OpenStack.  And here it turns out that the functionality that you happily used was cut out.  Well, because.  Well, he was ugly and in general, we better do it, honestly, honestly.  In the next release.  May be.  In the meantime, here's easier for you, but it works the same!  Well, do not care what is not in your case, but it works! <br><br>  In our case, it was the network functionality.  The network is generally a sore point, delivering the most pain in OpenStack.  In general, our application consumes traffic from the Internet, sometimes very intensively.  Of course, this is not quite a standard requirement, but the best option for us was when virtuals use their own host as a router, and the host itself already sends traffic to the provider.  And this could be done in Essex.  And it somehow worked. <br><br>  And in the next release, the guys from OpenStack decided that that's that, we will cut the functionality of working with the network into a separate module (future neutron), we will implement something simple like one router per virtual network and play for now.  Those.  it would be necessary to send all the traffic of the whole cluster through a single node of our network, it would become a bottleneck. <br><br>  As a result, OpenStack is such a thing that really works - do not touch.  Do not even try to stick your ruchenki there, n ** p.  It is better not to reboot even just in case, and then suddenly it will not rise again?  Any update is a hindrance, nerves, hate. <br><br><h3>  He is raw (in places) </h3><br>  And you have a very wondrous feeling when you need a functional, say, a division into zones.  Well, here you have cars with large screws, you have SSD, you have with vidyuhi, I want to split the cluster into zones so that the virtual machine falls on the machine with the necessary resource.  Well, we read to dock, it seems like the availability zones are suitable.  Customize, enable.  And nothing.  The dock says that everything should, but in practice, nothing.  We climb into the code, and there. <br><br><img src="https://habrastorage.org/web/9a4/1ce/746/9a41ce746c624d139c8124c58df57f01.png"><br><br>  It will be implemented.  In the next release.  May be.  Well, you understand.  See previous item. <br><br><img src="https://habrastorage.org/web/4b7/a8b/c58/4b7a8bc580344f7e89a7e84247063095.jpg"><br><br><h3>  Are there any pros, what will be the conclusions? </h3><br>  For me personally, the conclusion is simple.  Vanilla version of OpenStack is better not to use.  I do not know how things are with vendor versions and for all offices selling turnkey installations, but as for me this somewhat contradicts the ideology of the free cloud.  We again get the vendor lock-in, only under a different sauce. <br><br>  Want to try your luck with vanilla OpenStack?  No, well, in general, please.  There are many plug-ins, a large community, a marketing bulshit is generally above the roof.  Good luck, in general.  But for small and medium installations I would rather not advise. <br><br>  In my opinion, one of the main problems of OpenStack stems from a not quite true architectural message.  In an effort to make it simple for the end user, they made the total too difficult.  Anyone drank to his needs turns into a nightmare, because even such a simple and banal thing as hooks on the events are not delivered.  How would it simplify the implementation of many things ... <br><br>  In general, after one and a half years of fighting OpenStack, we abandoned it and switched to another cloud.  Infrastructure management has become simple and enjoyable, and updating versions is as simple as apt dist-upgrade. <br><br>  What is this cloud and why it is more convenient OpenStack, I will try to tell in the next article.  (Spoiler: this is OpenNebula). </div><p>Source: <a href="https://habr.com/ru/post/335530/">https://habr.com/ru/post/335530/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335520/index.html">How to scan a castle (almost) for free</a></li>
<li><a href="../335522/index.html">Welford method and one-dimensional linear regression</a></li>
<li><a href="../335524/index.html">Optimization Unity3d UI by GPU (for example minimap) or create a minimap without additional cameras and sprites</a></li>
<li><a href="../335526/index.html">Building recommendations for a job site. Lecture in Yandex</a></li>
<li><a href="../335528/index.html">Receive phonebook entries from a mobile phone without a display</a></li>
<li><a href="../335532/index.html">Hidden features of Windows. How can BitLocker help protect data?</a></li>
<li><a href="../335534/index.html">The digest of interesting materials for the mobile developer # 216 (August 6 - August 13)</a></li>
<li><a href="../335536/index.html">5 popular myths about logo design</a></li>
<li><a href="../335538/index.html">Pygest # 15. Releases, articles, interesting projects from the world of Python [August 01, 2017 - August 14, 2017]</a></li>
<li><a href="../335540/index.html">The calculation of the priority of combinations in Texas Hold'em (poker) for PHP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>