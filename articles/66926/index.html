<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Data structures: binary trees. Part 2: an overview of balanced trees</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The first article of the cycle 

 Intro 
 In the second article I will give an overview of the characteristics of various balanced trees. By character...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Data structures: binary trees. Part 2: an overview of balanced trees</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/blogs/algorithm/65617/">The first article of the cycle</a> <br><br><h2>  Intro </h2><br>  In the second article I will give an overview of the characteristics of various balanced trees.  By characteristic, I mean the basic principle of operation (without describing the implementation of operations), the speed of work and the additional memory consumption compared to an unbalanced tree, various interesting facts, as well as links to additional materials. <br><a name="habracut"></a><br><h2>  Red black tree </h2><br>  Other names: Red-black tree, RB tree. <br>  In this structure, the balance is achieved by maintaining the coloring of the peaks in two colors (red and black, as the name implies :), subject to the following rules: <br><ol><li>  The red top cannot be the son of the red top </li><li>  The black depth of any leaf is the same (the black depth refers to the number of black peaks on the path from the root) </li><li>  Black tree root </li></ol><br>  Here we change the definition of the sheet somewhat, and we call it so special null-vertices that replace the missing sons.  We assume such vertices to be black. <br><br>  Example: <br><img src="https://habrastorage.org/getpro/habr/post_images/082/8e3/fc1/0828e3fc1e7b0554e322c8d6329ac6a8.png" alt="An example of red-black wood">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's see what the maximum depth of a correct red-ebony with n vertices can be. <br>  Take the deepest leaf.  Let it be at depth h.  Because of rule 1, at least half the vertices on the path from the root will be black, that is, the black height of the tree will be at least h / 2.  It can be shown that in such a tree there will be at least 2 ^ (h / 2) -1 black vertices (since each black vertex with black depth k, if it is not a leaf, must have at least two children with black depth k + 1 ).  Then 2 ^ (h / 2) -1 &lt;= n or h &lt;= 2 * log2 (n + 1). <br><br>  All basic operations with a red-ebony tree can be implemented in O (h), that is, O (log n) as proved above.  The classic implementation is based on parsing a large number of cases and is quite difficult to understand.  There are more simple and clear options, for example, in the <a href="">article by</a> Chris Okasaki.  Unfortunately, it only describes the insert operation in the tree.  The simplicity compared to the classical implementation is obtained by focusing on clarity, and not on optimizing the number of elementary tree modifications (rotations). <br><br>  To implement this type of trees, it is necessary to store an additional 1 bit of information at each vertex (color).  Sometimes it causes a big overhead due to alignment.  In such cases, it is preferable to use structures without additional memory requirements. <br><br>  Red-black trees are widely used - the implementation of set / map in standard libraries, various applications in the Linux kernel (for queuing requests, ext3 etc.), probably in many other systems for similar needs. <br><br>  Red-black trees are closely related to B-trees.  We can say that they are identical to B-trees of order 4 (or <a href="http://en.wikipedia.org/wiki/2-3-4_tree">2-3-4 trees</a> ).  You can read more about this in an article on Wikipedia or in the book <a href="http://www.williamspublishing.com/Books/5-8459-0857-4.html">‚ÄúAlgorithms: Construction and Analysis‚Äù</a> mentioned in the previous article. <br><br>  <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D1%2580%25D0%25B0%25D1%2581%25D0%25BD%25D0%25BE-%25D1%2587%25D1%2591%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">Wikipedia article</a> <br>  <a href="http://en.wikipedia.org/wiki/Red-black_tree">Article in the English Wikipedia (with a description of operations)</a> <br>  <a href="http://rain.ifmo.ru/cat/view.php/vis/trees/red-black-2002">red-black tree visualizer</a> <br><br><h2>  AA-tree </h2><br>  A modification of the red-black tree, in which an additional restriction is imposed: the red top can only be a right-handed son.  If a red-black derov is isomorphic to a 2-3-4 tree, then an AA-tree is isomorphic to a <a href="http://ru.wikipedia.org/wiki/2-3_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">2-3</a> tree. <br><br>  Due to the additional restrictions, operations are easier to implement than in the case of a red-black tree (by reducing the number of cases to be analyzed).  The estimate for the height of the trees remains the same, 2 * log2 (n).  Their time efficiency is about the same, but since in the implementation, instead of color, they usually store another characteristic (‚Äúlevel‚Äù of the vertex), memory overhead reaches a byte. <br><br>  <a href="http://en.wikipedia.org/wiki/AA_tree">Article in English Wikipedia</a> <br><br><h2>  AVL-tree </h2><br>  Named so by the names of the Soviet mathematicians who invented it: G..  Adelson-Velsky and E.M.  Landis. <br><br>  Imposes the following restriction on the tree: at any vertex, the heights of the left and right subtrees must differ by no more than 1. It is easy to prove by induction that a tree with height h must contain at least F_h vertices, where F_i is the i-th Fibonacci number.  Since F_i ~ phi ^ n (phi = (sqrt (5) +1) / 2 is the golden ratio), the height of a tree with n vertices cannot exceed log2 (n) / log2 (phi) ~ 1.44 * log2 (n) <br><br>  The implementation, like that of the red-and-black tree, is based on case analysis and is rather difficult to understand (although IMHO is simpler than red-black) and has O (log (n)) complexity for all basic operations.  For work, it is necessary to store at each vertex the difference between the heights of the left and right subtrees.  Since it does not exceed 1, it suffices to use 2 bits per vertex. <br><br>  A detailed description can be found in N. Wirth‚Äôs book ‚ÄúAlgorithms + Data Structures = Programs‚Äù or in A. Shen <a href="">‚Äôs</a> book <a href="">‚ÄúProgramming: Theorems and Problems‚Äù</a> <br><br>  <a href="http://ru.wikipedia.org/wiki/%25D0%2590%25D0%2592%25D0%259B-%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">Wikipedia article</a> <br><br><h2>  Cartesian tree </h2><br>  Other names: Cartesian tree, treap (tree + heap), ducha (tree + heap). <br><br>  If you draw a tree on a plane, the key will correspond to the x-coordinate of the vertex (due to order).  Then you can enter the y-coordinate (let's call it height), which will have the following property: the height of the vertex is greater than the height of the children (the same property has values ‚Äã‚Äãin another data structure based on binary trees - heap). Hence the second version of the name of that structure ) <br><br>  It turns out that if you choose heights randomly, the height of the tree satisfying the heap property will most likely be O (log (n)).  Numerical experiments show that the height is approximately 3 * log (n). <br><br>  The implementation of operations is simple and logical, due to this, the structure is very loved in sports programming).  According to the <a href="http://www.upgrade-cepis.org/issues/2004/5/up5-5Mosaic.pdf">test</a> results, it was recognized as the most efficient in time (among red-black, AA and AVL - trees, as well as skip-lists (a structure that is not a binary tree, but with a similar scope) and radix-trees).  Unfortunately, it has a sufficiently large overhead in memory (2-4 bytes per vertex, for storage of height) and is not suitable where guaranteed performance is required (for example, in the OS kernel). <br><br><h2>  Splay tree </h2><br>  This data structure is very different from all listed before.  The fact is that it does not impose any restrictions on the tree structure.  Moreover, in the process of work the tree can be completely unbalanced! <br><br>  The base of the splay tree is the splay operation.  It finds the desired vertex (or closest to it in the absence) and ‚Äúpulls‚Äù it to the root by a special sequence of elementary rotations (a local operation on the tree, which preserves the property of order, but changes the structure).  Through it, you can easily express all the tree operations.  The sequence of operations in splay is chosen so that the tree ‚Äúmagically‚Äù works quickly. <br><br>  Knowing the magic of splay operation, these trees are implemented not easily, but very easily, therefore they are also very popular in ACM ICPC, Topcoder etc. <br><br>  It is clear that in such a tree it is impossible to guarantee the complexity of O (log (n)) operations (what if we are asked to find a deep-lying vertex in the currently unbalanced tree?).  Instead, the <a href="http://en.wikipedia.org/wiki/Amortization_(computer_science)">amortized</a> complexity of the operation O (log (n)) is guaranteed, that is, any sequence of m operations with a tree of size n runs behind O ((n + m) * log (n)).  Moreover, a splay tree has some magical properties, due to which it can be much more effective in practice than other options.  For example, the peaks that have been accessed recently are closer to the root and access to them is accelerated.  Moreover, it is proved that if the access to the elements is fixed, then the splay-tree will work asymptotically no slower than any other implementation of binary trees.  Another advantage is that there is no overhead in memory, since there is no need to store any additional information. <br><br>  Unlike other options, the search operation in the tree modifies the tree itself, so if the elements are uniformly referenced, the splay tree will run slower.  However, in practice it often gives a tangible increase in productivity.  <a href="http://www.stanford.edu/~blp/papers/libavl.pdf">Tests</a> confirm this - in tests obtained on the basis of Firefox, VMWare and Squid, the splay tree shows a performance gain of 1.5-2 times compared to red-black and AVL-trees.  At the same time, splay-trees work 1.5 times slower on synthetic tests.  Unfortunately, due to the lack of guarantees for the performance of individual operations, splay-trees are not applicable in real-time systems (for example, in the OS kernel, garbage-collectors), as well as in general-purpose libraries. <br><br>  <a href="http://en.wikipedia.org/wiki/Splay_tree">Article in English Wikipedia</a> <br>  <a href="http://www.cs.cmu.edu/~sleator/papers/self-adjusting.pdf">Original article by R. Tarjan and D. Slate</a> <br><br><h2>  Scapegoat tree </h2><br>  This tree is similar to the previous one in that it has no overhead from memory.  However, this tree is fully balanced.  Moreover, the coefficient 0 &lt;alpha &lt;0.5 of the "hardness" of a tree can be set arbitrarily and the height of the tree will be bounded above by the value of k * log (n) +1, where k = log2 (1 / alpha).  Unfortunately, modification operations will be depreciated as in the past tree. <br><br>  The stiffness coefficient greatly influences the balance of performance: the ‚Äúharder‚Äù the tree is, the less height it will have and the faster the search will work, but the more difficult it will be to maintain order in modification operations.  For example, since the AVL-tree is ‚Äúharder‚Äù red-black, searching it is faster, and the modification is slower.  If you use a scapegoat tree, the balance between these operations can be chosen depending on the specific use of the tree. <br><br>  <a href="http://en.wikipedia.org/wiki/Scapegoat_tree">Article in English Wikipedia</a> <br><br><h2>  A couple more words </h2><br>  The last two trees are very different from their competitors.  For example, only they can be used to effectively implement the link / cut tree data structure used in the basis of the fastest known stream search algorithm in a graph.  On the other hand, due to their depreciation essence, they cannot be used in many algorithms, in particular, for constructing ropes.  The properties of these trees, especially splay-trees, are being actively studied by theorists. <br><br>  In addition to balanced trees, you can use the following trick: implement a regular binary tree and in the process of work periodically do rebalancing.  To do this, there are several algorithms, such as the <a href="http://en.wikipedia.org/wiki/DSW_algorithm">DSW algorithm</a> , working for O (n) <br><br><h2>  In the next series </h2><br>  I will tell in more detail about the Cartesian trees and their implementation. <br><br><h2>  General links </h2><br>  <a href="http://people.ksp.sk/~kuko/bak/index.html">tree visualizer</a> (can visualize all trees from the review) </div><p>Source: <a href="https://habr.com/ru/post/66926/">https://habr.com/ru/post/66926/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../66920/index.html">olap for a small company</a></li>
<li><a href="../66921/index.html">Full html-code to display a list of regions of Russia</a></li>
<li><a href="../66922/index.html">Asus + Snapdragon Platform + Android OS = ‚Äúlet two go to hell!‚Äù</a></li>
<li><a href="../66923/index.html">Web analytics: analyze it! Part 3. Basic metrics</a></li>
<li><a href="../66925/index.html">Microsoft enters into a strategic agreement with Nokia</a></li>
<li><a href="../66928/index.html">Mobile version, guglogetatyy and schedule</a></li>
<li><a href="../66930/index.html">Smart Relay [wget> fifo> ices0> icecast]</a></li>
<li><a href="../66931/index.html">8 useful regexpov with a visual analysis</a></li>
<li><a href="../66933/index.html">What kind of balanced trees would you like to read more about?</a></li>
<li><a href="../66937/index.html">Specific Delphi Virus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>