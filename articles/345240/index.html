<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Servlet 4.0: We do more faster. Server push</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="All good and gradually coming! 

 Before the end of this year, there is not so much time left, but we still seem to have time to launch two courses, o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Servlet 4.0: We do more faster. Server push</h1><div class="post__text post__text-html js-mediator-article">  All good and gradually coming! <br><br>  Before the end of this year, there is not so much time left, but we still seem to have time to launch two courses, one of which will be a <a href="http://otus.ru/lessons/JEE/%3Futm_source%3Dhabr%26utm_medium%3Daffilate%26utm_campaign%3Djavaee%26utm_term%3Dprofi21.12">Java EE</a> course <a href="http://otus.ru/lessons/JEE/%3Futm_source%3Dhabr%26utm_medium%3Daffilate%26utm_campaign%3Djavaee%26utm_term%3Dprofi21.12">.</a>  So keep the first part of the notes on Servlet 4.0 <br><br>  <i>The new major release of the Servlet API covers the HTTP / 2 protocol and predicts resource requirements.</i> <i><br></i> <br>  The long-awaited update for Java EE 8 includes updates to existing APIs: JAX-RS 2.1, Bean Validation 2.0, JavaServer Faces (JSF) 2.3, Contexts and Dependency Injection (CDI) 2.0, JSON with Padding (JSONP) 1.1 and Servlet 4.0, and also two new APIs: JSON-Binding (JSON-B) and Java EE Security.  Among these APIs, Servlet 4.0 is a fairly large update, the first since 2009. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The impulse that triggered this big release (and not a point update) is the global deployment of the <a href="http2-under-the-hood/index.html">HTTP / 2</a> protocol and the many new features it brings.  This update for HTTP is the first in nearly 20 years and fixes many of the shortcomings of HTTP 1.x.  New features are numerous (request / response multiplexing, header compression, stream prioritization, and push server), but the most noticeable feature for users of the Servlet API is Server Push, which I will cover in this article. <br><br>  Server Push is not the only remarkable addition to Servlet 4.0.  This release also introduces enhancements to the Servlet Mapping API, which supports URL mapping recognition at runtime, through improvements in the acquisition of reference paths.  This article discusses these features, and how Server Push was integrated into the JavaServer Faces 2.3 API. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dh/ok/qo/dhokqoiy72ohiwqpkliefl3t4au.jpeg"></div><a name="habracut"></a><br>  <b>Server push</b> <br><br>  Designed to predict the resources required by a web page, the Server Push function pushes images, CSS, JavaScript files and other resources for the client before the request is completed.  Therefore, by the time the browser receives an answer to its request for a web page, the resources it needs are already in the cache and ready to use. <br><br>  The need to split resources across domains to bypass the limitations of browser TCP connections has disappeared.  Simply specify the resources and allow the server to handle the delivery.  This is the way that was supposed to exist from the very beginning. <br><br>  With resources already in the browser's cache, the browser can render the page much faster.  With a typical web page that requires more <a href="httparchive.org/trends.php">than a hundred sources</a> , it is easy to see what prospects this presents for improving performance. <br><br>  <b>Server Push in action</b> <br><br>  Servlets are the underlying technology behind Java EE web applications.  They provide server capabilities that form the basis of many frameworks.  JavaServer Faces (JSF) relies on FacesServlet to manage the request processing lifecycle for web applications, and JSP pages are translated into servlets upon the first client request;  therefore, it is not surprising that servlets are a natural place to implement HTTP / 2 Server Push abstraction. <br><br>  This abstraction is represented as a <code>PushBuilder</code> object and is created by calling the <code>newPushBuilder()</code> method from the HttpServletRequest request instance, passed to all redefined query processing methods. <br><br>  With an instance of <code>PushBuilder</code> you can start pushing the resources required by the requested web page.  A resource is installed on an instance of <code>PushBuilder</code> , passing its location to the path () method.  The resource is delivered to the client by calling the push () method.  It can be reused to send the required amount of resources. <br><br>  Listing 1 and 2 show the simplest examples of using Server Push.  Listing 1 shows a servlet that responds to a GET request for a URI / simplestexample: <br><br>  <b>Listing 1</b> <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@WebServlet</span></span>(‚Äú/simplestexample‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimplestExample</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttpServlet</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doGet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> ServletException, IOException </span></span>{ request.newPushBuilder() .path(<span class="hljs-string"><span class="hljs-string">"images/coffee-cup.jpg"</span></span>) .push(); getServletContext() .getRequestDispatcher(<span class="hljs-string"><span class="hljs-string">"/coffee-cup.jsp"</span></span>) .forward(request, response); }}</code> </pre> <br><br>  Listing 2 shows the JSP web page: <br><br>  <b>Listing 2</b> <br><br><pre> <code class="java hljs">&lt;html&gt; &lt;head&gt; &lt;title&gt;Coffee-Cup&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;img src=<span class="hljs-string"><span class="hljs-string">'images/coffee-cup.jpg'</span></span>&gt; &lt;/body&gt; &lt;/html&gt;</code> </pre> <br><br>  Listing 1 has a servlet called <code>SimplestExample</code> and a JSP to which the servlet is redirected.  As you can see, on the JSP page only one resource is required - the image coffee-cup.jpg.  When the <code>doGet()</code> request processing method is called, it creates a new instance of PushBuilder, sets the location of the image, and calls the push () method to send the resource to the client. <br><br>  While the image is being sent to the client, the servlet sends a request to the JSP, for which the coffee-cup.jpg resource is required.  By the time the browser received the processed HTML, it already has an image in its cache and can display the page without having to make another request. <br><br>  To see the server‚Äôs action in action, you can use the developer‚Äôs tools provided by Google‚Äôs Chrome browser.  Choose Advanced Tools&gt; Developer Tools, then go to the Network tab and send a request to the <code>SimplestExample</code> servlet.  You should see a result similar to that shown in Figure 1. You can clearly see that the protocol used is h2 (short for ‚ÄúHTTP / 2‚Äù), and the image was initiated using Push.  This confirms that Server Push was used to satisfy a resource request. <br><br><img src="https://habrastorage.org/webt/1h/a7/z9/1ha7z9z56fzactk8qmdl2x9qz5e.png"><br>  <i>Figure 1: Resource request satisfied by Server Push</i> <br><br>  <b>TLS required for HTTP / 2</b> <br><br>  In Figure 1, you may have noticed that the request scheme is HTTPS.  This is due to the fact that all major browser providers have chosen to implement the HTTP / 2 protocol only via Transport Layer Security (TLS).  However, the specification does not guarantee that a successful HTTP / 2 connection requires a secure connection.  The browser vendors made this decision on our behalf. <br><br>  Care must be taken when using the new <code>PushBuilder</code> object.  The call to <code>newPushBuilder()</code> will return null if the connection is not secure, if the client does not support Server Push, or if the client has asked to disable Server Push using the SETTINGS_ENABLE_PUSH parameter of the SETTINGS section. <br><br>  If you want to try this example for yourself, you can copy the code from <a href="">the GitHub repository</a> . <br><br>  <b>Anatomy of PushBuilder</b> <br><br>  Each new <code>PushBuilder</code> instance created by calling <code>newPushBuilder()</code> is based on the current <code>HttpServletRequest</code> instance.  It is initiated using the HTTP GET method, and all headers are removed, except for the conditional, range, expect, authorization, and referrer headers. <br><br>  <code>PushBuilder</code> implements the <code>Builder</code> pattern, in which a chain of method calls is used to change the properties of an instance before calling the <code>push()</code> method.  The path to resources is the only configuration required before sending.  The <code>push</code> action initiates an asynchronous, non-blocking request, and when it returns, conditional headers and path headers are cleared in preparation for reusing the <code>Builder</code> instance. <br><br>  You may be wondering how useful it is to use <code>PushBuilder</code> in this way in a real application, and this is a risky question.  The example was a bit artificial and is intended only for demonstration.  A more likely scenario is that your application will use JSF or JSP.  So let's take a look at JSF integration and how you can use the Server Push feature with JSP. <br><br>  <i>Particularly welcome is the seamless integration of Server Push into the JSF API, which makes it possible to use HTTP / 2 performance features without any code changes.</i> <br><br>  THE END <br><br>  As always, questions, comments that you can ask here or to us at <a href="https://otus.pw/k47k/">the Open House Day are</a> welcome <a href="https://otus.pw/k47k/">.</a> </div><p>Source: <a href="https://habr.com/ru/post/345240/">https://habr.com/ru/post/345240/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345230/index.html">Who needs these CRM systems?</a></li>
<li><a href="../345232/index.html">The history of the Nigerian developer: from programming on the button phone to work in the startup MIT</a></li>
<li><a href="../345234/index.html">DIY. Spying on visitors</a></li>
<li><a href="../345236/index.html">React Component Testing</a></li>
<li><a href="../345238/index.html">10 of the most important English words of 2017 according to Merriam-Webster</a></li>
<li><a href="../345242/index.html">How a non-refundable cost error can ruin a game developer</a></li>
<li><a href="../345244/index.html">The backend of the World in Conflict game server is publicly available.</a></li>
<li><a href="../345246/index.html">Finding the 3rd item from the end of a linked list in Java</a></li>
<li><a href="../345250/index.html">We track Millenium Falcon with TensorFlow</a></li>
<li><a href="../345252/index.html">Lectures Tehnotreka. Android Development (Fall 2017)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>