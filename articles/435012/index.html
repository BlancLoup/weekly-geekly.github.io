<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The first video game for Alice, or voice assistant as a game controller</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At work, I create useful skills for Alice , and in my free time I tried to use a voice assistant to play with friends, at home. I have already describ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The first video game for Alice, or voice assistant as a game controller</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ct/qb/9r/ctqb9rcrgjam2yqq0xgcamfbst0.png"><br><br>  At work, I create <a href="https://rb.ru/opinion/podruzhit-s-alisoj/">useful skills for Alice</a> , and in my free time I tried to use a voice assistant to play with friends, at home.  I have already described my <a href="https://habr.com/post/414213/">development of a text game</a> for one or two players, and this time I share the experience of creating a video game for a whole company. <br><a name="habracut"></a><br><h2>  Rules of the game </h2><br>  I didn‚Äôt want to port an existing game under Alice, I wanted to come up with an original game that uses Alice‚Äôs ability to recognize speech. <br><br>  On the screen there are many images in circles and squares of different colors.  The player‚Äôs task is to find a pair of objects on the same background and make a phrase like: adjective + noun.  Moreover, the adjective must be formed from the object in the circle, and the noun - from the object in the square.  Hence the name of the game - ‚ÄúRound Square‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The player who calls the phrase gets points.  The winner is the one who scored 10 points or the most points during a round (2 minutes).  Gameplay is shown in a short video. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/TfDA2WrnyNI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Determined the rules - go to the technique. <br><br><h2>  Controllers </h2><br>  To display the playing field, I use a large TV on which I open the site of the game.  If the TV does not have an Internet connection, you can display an image on it from a computer or play on the monitor. <br><br>  The visual part of the game is written in JavaScript.  All objects: the playing field and HUD - are created using the Canvas 2D API methods for drawing rectangles, text and images.  Every 50 ms the screen is updated.  All code is concentrated in a single HTML file, including images encoded in Base64 format. <br><br>  Now you need to implement an interface that accepts phrases of players.  Fortunately, the problem of speech recognition is solved by voice assistants.  Yandex provides this service free of charge to Alice‚Äôs users and developers of voice applications (skills). <br><br>  Add the skill of the game to voice assistant.  Now each player can activate the voice application on his own phone or in the smart column and send cues to the site through the microphone. <br><br><table><tbody><tr><th><img src="https://habrastorage.org/webt/qc/os/q5/qcosq5zv0dd0iqapwwmeljipgfu.jpeg"></th><th><img src="https://habrastorage.org/webt/is/cv/rt/iscvrtu-gf2qrs6rxbmy1vluspe.jpeg"></th></tr></tbody></table><br><h2>  Backend </h2><br>  It remains to associate the replica of the user with a specific game party.  For this we need a server: for each batch, a number is generated, the HTML page registers it on the server and displays it to the user.  The user calls this number to the voice assistant, and he registers a new player with the corresponding game through the server‚Äôs web hook.  Subsequent cues of the user are transferred to his game via WebSocket. <br><br>  The client code for creating a web socket and reconnecting when disconnecting looks like this: <br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">websocketServerLocation</span></span></span><span class="hljs-function">)</span></span>{ ws = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebSocket(websocketServerLocation); ws.onopen = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ gameN = game.id; }; ws.onclose = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ gameN = <span class="hljs-string"><span class="hljs-string">"--"</span></span>; start(HOST); }; wsSend({<span class="hljs-string"><span class="hljs-string">"gameId"</span></span>: game.id}); } start(HOST);</code> </pre> <br>  When connected to the server, the client sends him the game number.  Below is the server code that establishes the connection and initiates control of the game with the received number: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> wss = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SocketServer({ server }); wss.on(<span class="hljs-string"><span class="hljs-string">'connection'</span></span>, (ws) =&gt; { ws.on(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, () =&gt; { remConn(ws.gameId); }); ws.on(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, msg =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(msg); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.gameId) { ws.gameId = data.gameId.toString(); addGame(ws); } }); });</code> </pre><br>  With this, the same server can render pages with a browser and respond to Alice's web hooks: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> server = express().use(bodyParser.json()).use(<span class="hljs-string"><span class="hljs-string">'*'</span></span>, (req, res) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.body &amp;&amp; req.body.request) { <span class="hljs-comment"><span class="hljs-comment">//   toAnswer  - res.json({ version: req.body.version, session: req.body.session, response: toAnswer, }); } else { // -   res.sendFile(INDEX); } }).listen(PORT);</span></span></code> </pre><br><h2>  Conclusion </h2><br>  The result was an original video game for the company.  It was <a href="https://dialogs.yandex.ru/store/skills/fad0696b-videoigra-kruglyj-kvadrat">published in Alice</a> on November 28, 2018 and was the first video game I knew of for this voice assistant. <br><br>  By the way, even before the appearance of Alice and Google Assistant, people felt a fan from <a href="https://life.ru/t/%25D0%25B8%25D0%25B3%25D1%2580%25D1%258B/981550/ighra_s_gholosovym_upravlieniiem_pokorila_aziiu">voice control in games</a> .  Thanks to the ubiquitous distribution of devices with microphones and speakers, thanks to the development of speech technologies, voice assistants are becoming available game controllers that provide a new user experience. </div><p>Source: <a href="https://habr.com/ru/post/435012/">https://habr.com/ru/post/435012/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435000/index.html">The concept of the interaction of advertising channels and its application in practice</a></li>
<li><a href="../435002/index.html">IDA Pro Upgrade. Debugger for Sega Mega Drive (part 2)</a></li>
<li><a href="../435006/index.html">Where and how do nuclear reactors do</a></li>
<li><a href="../435008/index.html">Preliminary data on the production and sale of Tesla electric vehicles for the 4th quarter and for the 2018th year</a></li>
<li><a href="../435010/index.html">Digital Lyrics: Mega-compilation of songs and clips about programming and programmers</a></li>
<li><a href="../435014/index.html">Dart vs Node.js: compare performance on HTTP server implementations</a></li>
<li><a href="../435016/index.html">What Larry Ellison will bring to Tesla</a></li>
<li><a href="../435018/index.html">In 2018, we finally began to take seriously the time spent at the smartphone</a></li>
<li><a href="../435020/index.html">Hall of Fame Consumer Electronics: Stories of the Best Gadgets of the Last 50 Years, Part 2</a></li>
<li><a href="../435026/index.html">Making an instant messenger * that even works in an elevator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>