<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Secure storage of secrets</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I'll tell you about one of the portable, cross-platform methods of storing secrets on drives, which is based on only open, free software. 

 I could n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Secure storage of secrets</h1><div class="post__text post__text-html js-mediator-article"><table><tbody><tr><td><img src="http://img264.imageshack.us/img264/3749/1207928116bc340365.jpg" alt="image"></td><td>  I'll tell you about one of the portable, cross-platform methods of storing secrets on drives, which is based on only open, free software. </td></tr></tbody></table><br><br>  I could never remember all the logins, passwords and other access codes to all my accounts.  Sometimes the registration name and the coveted code are needed at the most inappropriate moment, so I drag them on a flash drive.  In order not to tear my hair when I lost the coveted storage device, I wrote scripts, which will be discussed below. <br><br><a name="habracut"></a><br>  We formulate the problem. <br>  There is a folder with secrets (personal diaries, information about accounts, articles for Habr, etc.), which by no means can be stored in the clear.  The ability to read data from it you want to have on any computer, which will bring.  For ease of describing further manipulations, narrow down to all computers running Windows.  But no one bothers to expand this circle, since all the software used is cross-platform. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We will need the following tools: <br><ul><li>  console archiver </li><li>  software package implementing cryptography tools </li><li>  file shredder </li></ul><br>  I will use <a href="http://sourceforge.net/projects/sevenzip">7-Zip portable</a> , <a href="http://www.gnupg.org/">GnuPG</a> and <a href="http://sourceforge.net/projects/eraser">Eraser portable</a> . <br>  On * nix systems, this may be for example tar, GnuPG and wipe <br><br>  Create a working directory on the flash drive (for example, F: \ bin \ secure).  Copy into it the tools we need: <br><ul><li>  7z.exe, 7z.dll - of 7-Zip portable </li><li>  Eraserl.exe, Eraser.dll - from Eraser portable </li><li>  gpg.exe from GnuPG </li></ul><br>  Next we need to generate private and public keys for cryptography operations.  This is done very simply with the help of the same gpg: <br><br> <code>F:\bin\secure\gpg.exe --gen-key --home=C:\</code> <br> <br>  Having answered all the questions (if you don‚Äôt understand what is being asked in the first three questions, you can answer this way: 1, 1024, 0) we will get the public and private keys, as well as the database of trusted certificates.  These are files: <br><ul><li>  C: \ pubring.gpg </li><li>  C: \ secring.gpg </li><li>  C: \ random_seed </li><li>  C: \ trustdb.gpg </li></ul><br>  The most important are pubring (the public key with which you can encrypt) and secring (the private key with which you can decrypt).  In addition, I advise you to remember the name of the key holder and password.  <strike>We write down everything on the registered carrier and put it in the safe.</strike>  Portability is more important to me than security, so I will keep both files on the same flash drive.  Just put them in a place where they will be looking for vryatli.  Even if found, to decrypt the private key will need a password. <br><br>  Let the private key be F: \ CLOSED.KEY, and the open key - F: \ OPEN.KEY.  The base of trusted certificates (it is necessary that gpg does not swear when performing encryption / decryption operations) - we place the files random_seed and trust_db to gpg.exe, that is, in F: \ bin \ secure. <br><br>  Comment: <br>  If you work at home and in the office, carrying important information back and forth, keys can be stored on your work and office computer.  Thus, "on the road" information will be protected from theft, loss or meeting in a dark alley with a group of Gopnik ITshnikov. <br><br>  It remains only to implement an encryption script that implements the following operations: <br><ul><li>  Copying the necessary keys in F: \ bin \ secure </li><li>  Archiving a directory with sectors </li><li>  Archive encryption </li><li>  Complete removal of the directory, archive and keys in F: \ bin \ secure </li></ul><br>  And the decryption script is <br><ul><li>  Copy keys </li><li>  Decryption </li><li>  Unpacking </li><li>  Complete deletion of the archive and keys </li><li>  Delete encrypted archive </li></ul><br>  Here are the batch scripts: <br><br>  <b>enc.bat</b> <br>  <font>1 @ <font color="#0000ff">echo</font> <font color="#804040">off</font></font> <font><br></font>  <font>2 <font color="#0000ff">rem</font> <font color="#ff0000">Receiving keys</font></font> <font><br></font>  <font>3 <font color="#0000ff">copy</font> <font color="#0000ff">% 3</font> <font color="#ff00ff">"</font> <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/pubring.gpg"</font> <font color="#ff00ff">/ Y</font> <font color="#804040">&gt;&gt;</font> nul</font> <font><br></font>  <font>4 <font color="#0000ff">rem</font> <font color="#ff0000">Packaging</font></font> <font><br></font>  <font>5 <font color="#0000ff">% ~ dp0</font> / <font color="#ff00ff">7</font> z.exe a <font color="#0000ff">% 1</font> .7z <font color="#0000ff">% 1</font> <font color="#804040">&gt;&gt;</font> nul &amp;&amp; <font color="#0000ff">start</font> <font color="#ff00ff">/ wait</font> <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/ gpg</font> .exe ^</font> <font><br></font>  <font>6 --homedir <font color="#804040">=</font> <font color="#0000ff">% ~ dp0</font> -r <font color="#0000ff">% 2</font> --quiet -o <font color="#0000ff">% 1</font> .enc -e <font color="#0000ff">% 1</font> .7z</font> <font><br></font>  <font>7 <font color="#804040">IF</font> <font color="#804040">NOT</font> <font color="#0000ff">% ERRORLEVEL%</font> <font color="#804040">==</font> <font color="#ff00ff">0</font> <font color="#804040">goto</font> <font color="#804040">fail</font></font> <font><br></font>  <font>8 <font color="#0000ff">echo</font> <font color="#ff00ff">ENCRYPTED SUCCESSFULL</font></font> <font><br></font>  <font>9 <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/ eraserl</font> .exe -file <font color="#0000ff">% 1</font> .7z -silent &amp;&amp; <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/ eraserl</font> .exe -folder <font color="#0000ff">% 1</font> ^</font> <font><br></font>  <font>10 -subfolders -silent <font color="#804040">&gt;&gt;</font> nul</font> <font><br></font>  <font>11 <font color="#804040">goto</font> <font color="#804040">end</font></font> <font><br></font>  <font>12 <font color="#804040">: fail</font></font> <font><br></font>  <font>13 <font color="#0000ff">echo</font> <font color="#ff00ff">ENCRIPTION FAILED</font></font> <font><br></font>  <font>14 <font color="#804040">: end</font></font> <font><br></font>  <font>15 <font color="#0000ff">rem</font> <font color="#ff0000">We clean the keys</font></font> <font><br></font>  <font>16 <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/ eraserl</font> .exe -file <font color="#ff00ff">"</font> <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/pubring.gpg"</font> -silent</font> <font><br></font> <br><br>  <b>dec.bat</b> <br>  <font>1 @ <font color="#0000ff">echo</font> <font color="#804040">off</font></font> <font><br></font>  <font>2 <font color="#0000ff">rem</font> <font color="#ff0000">Receiving keys</font></font> <font><br></font>  <font>3 <font color="#0000ff">copy</font> <font color="#0000ff">% 3</font> <font color="#ff00ff">"</font> <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/pubring.gpg"</font> <font color="#ff00ff">/ Y</font> <font color="#804040">&gt;&gt;</font> nul</font> <font><br></font>  <font>4 <font color="#0000ff">copy</font> <font color="#0000ff">% 4</font> <font color="#ff00ff">"</font> <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/secring.gpg"</font> <font color="#ff00ff">/ Y</font> <font color="#804040">&gt;&gt;</font> nul</font> <font><br></font>  <font>5 <font color="#0000ff">rem</font> <font color="#ff0000">Decryption</font></font> <font><br></font>  <font>6 <font color="#0000ff">start</font> <font color="#ff00ff">/ wait</font> <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/ gpg</font> .exe --homedir <font color="#804040">=</font> <font color="#0000ff">% ~ dp0</font> -r <font color="#0000ff">% 2</font> --quiet -o <font color="#0000ff">% 1</font> .7z -d <font color="#0000ff">% 1</font></font> <font><br></font>  <font>7 <font color="#804040">IF</font> <font color="#804040">NOT</font> <font color="#0000ff">% ERRORLEVEL%</font> <font color="#804040">==</font> <font color="#ff00ff">0</font> <font color="#804040">goto</font> <font color="#804040">fail</font></font> <font><br></font>  <font>8 <font color="#0000ff">rem</font> <font color="#ff0000">Unpacking</font></font> <font><br></font>  <font>9 <font color="#0000ff">% ~ dp0</font> / <font color="#ff00ff">7</font> z.exe x <font color="#0000ff">% 1</font> .7z -o <font color="#0000ff">% ~ dp1</font> <font color="#804040">&gt;&gt;</font> nul &amp;&amp; <font color="#0000ff">del</font> <font color="#0000ff">% 1</font> <font color="#ff00ff">/ Q</font> &amp;&amp; <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/ eraserl</font> .exe ^</font> <font><br></font>  <font>10 -file <font color="#0000ff">% 1</font> .7z -resultsonerror</font> <font><br></font>  <font>11 <font color="#0000ff">echo</font> <font color="#ff00ff">DECRYPTED SUCCESSFULL</font></font> <font><br></font>  <font>12 <font color="#804040">goto</font> <font color="#804040">end</font></font> <font><br></font>  <font>13 <font color="#804040">: fail</font></font> <font><br></font>  <font>14 <font color="#0000ff">echo</font> <font color="#ff00ff">DECRYPTION FAILED</font></font> <font><br></font>  <font>15 <font color="#804040">: end</font></font> <font><br></font>  <font>16 <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/ eraserl</font> .exe -file <font color="#ff00ff">"</font> <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/secring.gpg"</font> -resultsonerror &amp;&amp; ^</font> <font><br></font>  <font>17 <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/ eraserl</font> .exe -file <font color="#ff00ff">"</font> <font color="#0000ff">% ~ dp0</font> <font color="#ff00ff">/pubring.gpg"</font> -resultsonerror</font> <font><br></font> <br><br>  Place them in the same folder F: \ bin \ secure.  If you pack Eraserl.exe, Eraser.dll and gpg.exe with upx, then the entire secure folder with keys can easily fit on a <strike>registered</strike> 3.5 "diskette. <br>  The encryption process itself looks like this: <br><br> <code>F:\bin\secure\enc.bat F:\_ __ F:\.</code> <br> <br>  and decrypt like this: <br><br> <code>F:\bin\secure\dec.bat F:\_.enc __ F:\. F:\.</code> <br> <br>  During the decryption process, you will be asked to enter a password for the private key. <br><br>  Comment: <br>  These scripts only encrypt folders, because eraserl distinguishes between folders and files, but if you have the necessary skills, this annoying misunderstanding can be easily fixed. </div><p>Source: <a href="https://habr.com/ru/post/73642/">https://habr.com/ru/post/73642/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../73634/index.html">Big Brother is watching you or project 404</a></li>
<li><a href="../73637/index.html">RAR: getting a list of files without PECL</a></li>
<li><a href="../73638/index.html">Application Optimization (Iphone armv6)</a></li>
<li><a href="../73639/index.html">Habraluchusheniya - Color all</a></li>
<li><a href="../73641/index.html">New "vampire" advertising Bing</a></li>
<li><a href="../73643/index.html">An example of developing a small python + PyQt4 application for the accounting system</a></li>
<li><a href="../73647/index.html">What measures the eye-tracker. Part two</a></li>
<li><a href="../73648/index.html">Stallman loves Windows 7 too</a></li>
<li><a href="../73649/index.html">WAS: 3 invites to Google Voice :)</a></li>
<li><a href="../73650/index.html">Microsoft helps Eclipse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>