<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What I hate for Eloquent ORM</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. I want to confess in front of you and tell a little about what I feel when I develop on Laravel. No, do not think, I adore this framework and a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What I hate for Eloquent ORM</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/aw/le/nh/awlenhgll_4ltklubkiqe1wvk8c.jpeg" alt="image"></p><br><p>  Hello.  I want to confess in front of you and tell a little about what I feel when I develop on Laravel.  No, do not think, I adore this framework and are incredibly grateful to the team that created it and supports it, they do an extremely cool job and, in my opinion, Laravel is the best continuation of Symfony, which is no less beloved by me. </p><br><p>  I love dumb code.  Dumb in the sense that even after 10 years, if the customer asks you to make changes to it, you can do it without going into all the logic, even after being in the company office on Friday, without breaking anything in the old code.  And stupid in the sense that no cognitive effort is needed to understand it.  But there is one architectural solution in Laravel Eloquent ORM that makes me cry.  Interesting?  Come under the cat. </p><a name="habracut"></a><br><p>  Smart people have long ago invented everything for us: OOP, Design Patterns, SOLID, DDD, and other scary words that scare them in the beginning, and then apply them. </p><br><p>  I like this Laravel and Symfony.  They allow you to write the most stupid and protected code right out of the box.  Yes.  Each of them has its drawbacks ... But in Laravel there is one that annoys me the most.  This is using Active Record Pattern (AR) to work with models. </p><br><p>  For a start - a little about this pattern.  What is it all about?  To understand, you should go to the parent of this application design opus, the Repository pattern.  This pattern is a collection.  A collection of entities (Entity) that can retrieve, modify, save, delete, in general, manage them in an abstract storage location.  In 90 out of 100 percent of cases, such databases are stored in different locations.  But there can be a file system, some kind of cache, and even an external API. </p><br><p>  This approach is fully consistent with the principle of common responsibility and the DDD approach.  In addition, due to this approach, weak coherence is implemented - it does not matter to us exactly how the application stores something, we work with Entity, when we want to work directly with the object data representation and work with the Repository, when we need to interact with the repository. </p><br><p>  But Laravel decided to follow the path of using AR, which is undeniably cool and incredibly convenient when you need to make a quick prototype, but it becomes an incredible headache when you need to interact with several data sources and operate with them within the system. </p><br><p>  AR is a pattern that maps Entity and Repository into one Model.  That is, the object becomes a representation of a specific record in the database.  So what?  What does this lead to and why is it so annoying? </p><br><p>  First, we are violating the very principle of common responsibility - the logic of working with a repository in one place, and the logic of working with an entity in another.  This is important, because within my system I don‚Äôt want to pass a line from the database in the object representation along the call chain.  I want to transfer the model.  I should not care how it turns out, changes and persists.  I need to have those methods that allow you to interact only with the model, and not with the rows in the database. </p><br><p>  Secondly, we cannot (as a consequence of the fact that the Persistent layer - the storage layer - is associated with the entity layer), in a simple way to change the storage location of the model.  Yes, we can do this in the configuration by changing it for all at once, within the supported databases.  Or change only for a specific model (with all this, we do not remove any methods of the query builder, because you cannot get rid of the methods of the base class) and run into a ton of possible errors in the code or, God forbid, if someone else is will support (and this happens all the time). </p><br><p>  Thirdly.  I want to test my entities.  I want to, damn it, be sure that the changes I make will not break my business logic.  And, as practice shows, in the case of AR, you cannot do this, because the devil's principle of common responsibility has been violated!  Although here I am a little cunning.  You can test the models, just ... It's not easy. </p><br><p>  Nevertheless, it is impossible not to say about the advantages of this pattern.  Although all its plus is that it is ‚Äúfast, simple, without thinking.‚Äù  By merging two close ones according to the logic of their action and patterns that are constantly used together, we got a handy tool that slightly reduces the amount of code (in the direction of complication, do we remember the "stupid code"?).  It also allows you to get rid of unnecessary problems at the stage of forming MVP, which is mandatory (practice shows that this happens rarely, but still) is planned to be rewritten.  This allows us to shift our thoughts from the question ‚Äúhow we do‚Äù to the question ‚Äúwhat we do‚Äù, that is, to get rid of unnecessary questions about technology and move on to business logic. </p><br><p>  What is the conclusion I came for a few years using Laravel Eloquent ORM?  Active Record evil in the flesh?  No, this is the coolest tool for some situations, especially for the stage when a simple application or a prototype of such an application is written.  But this is an impossible thing to work with, when your application grows and you have to work with a large number of data sources, write code with 100% coverage tests, big problems begin. </p><br><p>  Yes, new chips are invented ( <a href="https://github.com/indatus/trucker">Trucker</a> ?), But we are going to tricks.  But I still want a little more freedom from the framework, especially since it is so good to many! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/434984/">https://habr.com/ru/post/434984/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../434972/index.html">How to write unit tests if you don‚Äôt feel like</a></li>
<li><a href="../434974/index.html">Work with the 1C: Enterprise configuration format</a></li>
<li><a href="../434976/index.html">FabLab University ITMO: DIY-co-working for creative people - show what's inside</a></li>
<li><a href="../434980/index.html">It is finished! NASA's New Horizons spacecraft contacted from a distance of 4 billion miles</a></li>
<li><a href="../434982/index.html">Perspective: MultiClet S1</a></li>
<li><a href="../434986/index.html">Basic C ++ Standard Library Concepts</a></li>
<li><a href="../434990/index.html">Using the Cisco 800 Series (for example Cisco 857) as a home router</a></li>
<li><a href="../434992/index.html">IDA Pro Upgrade. Debugger for Sega Mega Drive (part 1)</a></li>
<li><a href="../434994/index.html">Android: Creating Dynamic Product Flavors and Signing Configs</a></li>
<li><a href="../434996/index.html">How I shared the location through the VC API</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>