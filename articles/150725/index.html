<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Building Distributed Data Center (DC Interconnect, DCI)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When a company grows to a certain size and one data center becomes small, a lot of questions immediately arise how to further develop the network infr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Building Distributed Data Center (DC Interconnect, DCI)</h1><div class="post__text post__text-html js-mediator-article">  When a company grows to a certain size and one data center becomes small, a lot of questions immediately arise how to further develop the network infrastructure.  Indeed, how to expand the boundaries of the existing data center so that it transparently provides existing services at remote sites?  To make a large L2 domain so that there are no problems with virtualization or to unite sites on the third level?  If we make the infrastructure hierarchical, then how to get around the limitations of existing standards (802.1q) and what will happen to security in this case?  And how, at the same time, to ensure reliable transmission of converged traffic (eg FCoE) between sites?  And all this still needs to be managed smoothly ... <br><br>  A steady ‚Äútrend‚Äù of recent times for virtualization and building cloud infrastructures clearly shows that the option of combining data center sites along the second (L2) level is preferable to others for many reasons.  However, the question immediately arises, what technology to use for this?  Obviously, to build a currently distributed L2 domain based on STP is at least not rational.  From the existing alternatives - TRILL, PBB / SPB, FabricPath (proprietary!), MPLS / VPLS, dark fiber - the variant using the VPLS technology for DCI is, on the one hand, the most mature and proven in practice, on the other - flexible and rich functionality.  About him further and talk in detail. <br><a name="habracut"></a><br>  In order not to complicate the example, let's take two geographically separated sites.  We will build networks on Hewlett-Packard equipment, which recently has been actively developing network directions in the data center.  So, the task is to transparently for the virtual environment (read VM) to merge two sites into the data center so that: <br><br><ul><li>  Transparent level 2 (L2) traffic across the entire data center network; </li><li>  avoid blocked channels and inefficient use of bandwidth; </li><li>  simplify network management as much as possible; </li><li>  provide the required fault tolerance and protection against all sorts of failures; </li><li>  to ensure the simplicity of increasing the port capacity and, in general, the scalability of the network; </li><li>  the possibility of a gradual increase in port capacity by adding switches to the stack as needed; </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To solve this problem, we install two HP 5800 series switches on each site and combine them into one virtual switch (for reliability, if not critical, you can skip this step).  This is done simply, the switches are connected via standard 10G ports, then the IRF stack is configured like this: <br><br><img src="https://habrastorage.org/storage2/9f9/2c7/a0e/9f92c7a0e803b1cec9b41fc9dc6b11ec.jpg"><br><br>  Then the sites are physically connected to 10G interfaces (we assume that there is optics between the data center sites) and the interfaces are assembled into an LACP unit, like this: <br><br><img src="https://habrastorage.org/storage2/325/0e7/bca/3250e7bca389e428da8d0acad0f405dc.jpg"><br><br>  On the second site, the virtual switch is configured in the same way.  At the same time, we note that the optics connecting the platforms ‚Äúland‚Äù on physically different switches.  This is done in case of the fall of one of the switches in the stack so that the traffic automatically switches to the second switch / channel.  Ie, we receive such picture: <br><br><img src="https://habrastorage.org/storage2/072/249/778/072249778575ec27b49bd55f01f6bcf7.jpg"><br><br>  Then, in order to transparently ‚Äúforward‚Äù VLANs (second-level traffic) between sites, we are raising a VPLS service on these switches.  To do this, we first configure MPLS and LDP services so that LSP (Label Switched Path) ‚Äúsignals‚Äù automatically, like this: <br><br><img src="https://habrastorage.org/storage2/d65/892/a35/d65892a353458b28cd6dec9bcd19b618.jpg"><br><br>  It raises OSPF in the MPLS core in order not to fool around with static routes and the switches at the sites see each other by IP (and put it in OSPF LoopBack), like this: <br><br><img src="https://habrastorage.org/storage2/185/b48/42d/185b4842d921838d7fa1dc1e9ad96602.jpg"><br><br>  After that, we set up VPLS signaling on both sites.  In this case, the question to use the variant of Compella or Martini is more a matter of religion.  On the equipment HP work options.  On LDP (Martini), an L2 MPLS VPN is configured, then a VPLS Instance (VSI) is created and attached to the interface, like this: <br><br><img src="https://habrastorage.org/storage2/d0e/953/06f/d0e95306ff4aecb857d6b5c6925979a2.jpg"><br><br>  With BGP, it's a little more complicated, plus everything else needs to raise BGP Peering between the platforms, configure the VPLS family in it and set the parameters for the VPLS VSI (vpn-target and route-distinguisher), like this: <br><br><img src="https://habrastorage.org/storage2/b3d/994/f30/b3d994f30a66db582d69c860db5e25b1.jpg"><br><br>  The result is something like this: <br><br><img src="https://habrastorage.org/storage2/87f/572/74d/87f57274d61941b90dbf383353d2f937.jpg"><br><br>  In such a scheme, second-level traffic is transparently forwarded in VLAN-s between sites, and virtual resources and applications can freely migrate from one site to another, as if they are located in one place. <br><br>  In this simplified example, it is not entirely obvious, why raise the VPLS between two sites?  It seems that you can just forward the trunk and VLANs will be available on both sites ... However, in addition to the traffic management, network security and quality of service tasks provided by MPLS / VPLS, as soon as another site appears in the L2 domain (or another redundant connection), it will be necessary to control access to the environment and to protect against loops.  And doing this with STP is now at least a bad tone. </div><p>Source: <a href="https://habr.com/ru/post/150725/">https://habr.com/ru/post/150725/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150716/index.html">A simple way to organize an e-mail queue with Zend_Mail</a></li>
<li><a href="../150719/index.html">Dell Technology Park at IFA 2012</a></li>
<li><a href="../150720/index.html">The selector of generalized related elements</a></li>
<li><a href="../150722/index.html">What killed Linux Desktop (version of Miguel de Icaza)</a></li>
<li><a href="../150724/index.html">Convenient classes for getting IM statuses in PHP</a></li>
<li><a href="../150726/index.html">CAD: all arbitration courts of Russia in one Android device</a></li>
<li><a href="../150727/index.html">Internet Explorer 7-9: Choosing Tools for Maximum CSS3, HTML5 Support</a></li>
<li><a href="../150728/index.html">Acceleration 3.7 times after removing Sleep () in WebKit</a></li>
<li><a href="../150729/index.html">Surface review of javascript-enabled BaaS platforms</a></li>
<li><a href="../150730/index.html">"It is difficult about the simple." JS data types. In search of the truth of primitives and objects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>