<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hetzner, save IPv4 addresses for XenServer virtual machines</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A small life hack that you can use if you want to save some IPv4 addresses on your virtual machines in XenServer (it doesn't matter). 

 After you hav...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hetzner, save IPv4 addresses for XenServer virtual machines</h1><div class="post__text post__text-html js-mediator-article">  A small life hack that you can use if you want to save some IPv4 addresses on your virtual machines in XenServer (it doesn't matter). <br><br>  After you have installed Hetzner'en XenServer or another OS on the server, you get 1 IP address, mask and gateway.  Since virtual machines require separate addresses, you have the opportunity to order them: <br><br><img src="https://habrastorage.org/files/8d4/b7e/2c0/8d4b7e2c04e74a3384d210a14106da5b.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/317/079/64b/31707964be3e42f4b3f6955d7b8a643c.jpg"><br><br>  For example, we were allocated 46.4.205.64/29.  How to use all 8 addresses?  About this below. <br><a name="habracut"></a><br>  On XenCenter we create an additional network: <br><br><img src="https://habrastorage.org/files/4bc/3c5/da7/4bc3c5da7abe4432a9b82b113631a211.jpg"><br><br><img src="https://habrastorage.org/files/9db/9b0/cb7/9db9b0cb74ca42dfb0db0049c197676f.jpg"><br><br><img src="https://habrastorage.org/files/312/4bd/132/3124bd1328b749c1ae8f9ec1fd08bcd6.jpg"><br><br>  Assign dom0 in this subnet to an address from a range of private addresses (in this case, 172.16.1.1/24): <br><br><img src="https://habrastorage.org/files/be3/f41/15c/be3f4115c41041529020794b0f4bb725.jpg"><br><br>  When creating a new VM in the configuration process, we indicate that the network will be the newly created Network 1: <br><br><img src="https://habrastorage.org/files/3fc/bba/c1c/3fcbbac1c01642559300364c9a285df2.jpg"><br><br>  Installing the OS in a virtual machine can cause some inconvenience if it needs the Internet.  Therefore, for Linux distributions, it is recommended to use full images, rather than netinstall.  However, it is always possible to order one additional IP for such needs, and use it at the time of installation (respectively via Network 0). <br><br>  In the process of installing the OS when setting up the network, specify the IP from the above range (in this case, 172.16.1.0/24), for example, 172.16.1.10/24 <b>without specifying a gateway</b> . <br><br>  After installation, let's assign the address 46.4.205.64 to our virtual machine: <br><br>  - in the network interface settings (for example in debian): <br><br><div class="spoiler">  <b class="spoiler_title">/ etc / network / interfaces</b> <div class="spoiler_text">  auto lo <br>  iface lo inet loopback <br><br>  auto eth0 <br>  iface eth0 inet static <br>  address 172.16.1.10 <br>  netmask 255.255.255.0 <br><br>  auto eth0: 0 <br>  iface eth0: 0 inet static <br>  <b>address 46.4.205.64</b> <br>  <b>netmask 255.255.255.255</b> <br></div></div><br>  - and write the route at startup: <br><br><div class="spoiler">  <b class="spoiler_title">#mcedit /etc/network/if-up.d/route</b> <div class="spoiler_text">  #! / bin / bash <br>  / sbin / ip route add default via 172.16.1.1 src 46.4.205.64 <br></div></div><br>  not forgetting <b>#chmod + x /etc/network/if-up.d/route</b> <br><br>  With this, the virtual machine network setup is complete.  It remains to correct the routing to dom0. <br><br>  Determine the uuid of our network (Network 1): <br><br>  <b>#xe network-list</b> <br><br>  Add a static route to our subnet: <br><br>  <b>#xe network-param-set uuid = <code>uuid</code> other-config: static-routes = 46.4.205.64 / 29 / 172.16.1.1</b> <br><br>  Check: <br><br><div class="spoiler">  <b class="spoiler_title">#ip ro</b> <div class="spoiler_text">  default via &lt;external address&gt; dev xenbr0 <br>  <b>46.4.173.64/29 via 172.16.1.1 dev xapi1</b> <br>  172.16.1.0/24 dev xapi1 proto kernel scope link src 172.16.1.1 <br>  &lt;external address&gt; / 29 dev xenbr0 proto kernel scope link src &lt;htcner gateway&gt; <br></div></div><br>  Well, in conclusion: <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler header</b> <div class="spoiler_text">  C: \ Users \ spacewalk&gt; ping 46.4.205.64 <br><br>  Packet exchange from 46.4.205.64 over with 32 data bytes: <br>  The answer from 46.4.205.64: the number of bytes = 32 time = 40ms TTL = 56 <br>  The answer from 46.4.205.64: the number of bytes = 32 time = 40ms TTL = 56 <br>  The answer from 46.4.205.64: the number of bytes = 32 time = 40ms TTL = 56 <br>  The answer from 46.4.205.64: the number of bytes = 32 time = 40ms TTL = 56 <br><br>  Ping statistics for 46.4.205.64: <br>  Packets: sent = 4, received = 4, lost = 0 <br>  (0% loss) <br>  Approximate time of reception and transmission in ms: <br>  Min = 40msec, Max = 40 ms, Medium = 40 ms <br><br>  C: \ Users \ spacewalk&gt; tracert 46.4.173.60 <br><br>  Tracing the route to static.60.173.4.46.clients.your-server.de [46.4.173.60] <br>  with a maximum number of hops 30: <br><br>  1 1 ms 2 ms &lt;1 ms 192.168.89.1 <br>  2 1 ms 1 ms 1 ms 213.231.0.200 <br>  3 2 ms 1 ms 1 ms odessa1-xe-0-0-0-931.ett.ua [80.93.126.69] <br>  4 53 ms 34 ms 61 ms fft-od.ett.ua [80.93.127.238] <br>  5 36 ms 45 ms 36 ms decix2-gw.hetzner.de [80.81.193.164] <br>  6 40 ms 42 ms 40 ms core22.hetzner.de [213.239.245.17] <br>  7 48 ms 42 ms 40 ms ex9k1.rz13.hetzner.de [213.239.229.150] <br>  <b>8 41 ms 40 ms 41 ms static. &lt;External address&gt; .clients.your-server.de [&lt;external address&gt;]</b> <b><br></b>  <b>9 40 ms 40 ms 41 ms static.64.205.4.46.clients.your-server.de [46.4.</b> <b><br></b>  <b>205.64]</b> <br><br>  Tracing completed. <br></div></div><br>  The solution is not tied to a specific routing platform and OS in virtual machines, just at hand was such a set of software.  The only question is how to implement it with a Windows virtual machine.  Perhaps in the comments prompt. <br><br>  Save addresses and thank you for your attention. </div><p>Source: <a href="https://habr.com/ru/post/317230/">https://habr.com/ru/post/317230/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317218/index.html">LoRaWAN specification. Endpoint Activation</a></li>
<li><a href="../317220/index.html">How to set up Wi-Fi correctly</a></li>
<li><a href="../317222/index.html">Garden on the cloud or review of IT supermarkets</a></li>
<li><a href="../317226/index.html">What a botnet begins with: a dangerous backdoor found in Sony IP cameras</a></li>
<li><a href="../317228/index.html">Paul Graham's Strategic Essay: Refraction (Part 2)</a></li>
<li><a href="../317232/index.html">Implementing NSTouchBar on Swift</a></li>
<li><a href="../317236/index.html">Developing a game for Android on Unity 5. From idea to monetization (Live)</a></li>
<li><a href="../317238/index.html">Minimal environment for JS development: ava, standard, chokidar-cli and precommit-hook</a></li>
<li><a href="../317240/index.html">Rostelecom has reported on the reflection of the attack of the Internet of Things on the largest Russian banks</a></li>
<li><a href="../317242/index.html">Taxi service plays a database of customer contacts and drivers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>