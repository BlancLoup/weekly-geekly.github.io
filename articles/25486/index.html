<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IP Geography</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I had to deal with a program for keeping statistics on clicks of a certain system of ad exchange. When you clicked, as usual, information ab...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IP Geography</h1><div class="post__text post__text-html js-mediator-article">  Recently, I had to deal with a program for keeping statistics on clicks of a certain system of ad exchange.  When you clicked, as usual, information about the click was collected (on which page, what time, browser, ID of the advertisement and IP occurred).  In the presentation of statistics was the task - to find out the city from which the transition occurred.  Previously, I was not particularly interested in this; therefore, only now I have begun a deeper acquaintance with GeoIP systems. <br><br>  Also, how was it possible <a name="habracut"></a><br><br>  First, I remembered all sorts of geoip tables there, which can now be found <s>without much difficulty</s> more difficult than before.  But abbreviated options lie on the sites-collectors of bases.  Below is one of them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://www.maxmind.com/download/geoip/database/">reduced base</a> <br>  <a href="http://www.maxmind.com/">maxmind.com</a> is the site itself.  there you can check the geoip base. <br><br>  The variant in my case was dropped - the whole list would have to, but it is not small and it is necessary to make selections from the tables.  and after some time it will be necessary to update the table.  In general, laziness made me look for other ways.  While searching, I found an interesting service <a href="http://geoiptool.com/">http://geoiptool.com/</a> which performs the standard operation of any geoip service, but also imposes on a <a href="http://maps.google.com/">google map</a> . <br><br><img src="http://www.picamatic.com/show/2008/05/16/01/276580_784x433.JPG" width="500"><br><br>  Very funny.  Habr - <a href="http://geoiptool.com/en/%3FIP%3D62.213.122.2">here</a> <br><br>  As a result, I found <a href="http://www.ip2city.ru/">http://www.ip2city.ru/</a> - an open base of IP addresses.  I stopped at it.  What distinguished it among other services is the ability to provide data of the form <br>  field1 = value1 <br>  field2 = value2 <br>  ... <br>  what is called by a simple get request <a href="http://www.ip2city.ru/ip2city.php%3Fip%3D%25D1%2585%25D1%2585%25D1%2585.%25D1%2585%25D1%2585%25D1%2585.%25D1%2585%25D1%2585%25D1%2585.%25D1%2585%25D1%2585%25D1%2585">www.ip2city.ru/ip2city.php?ip=xxx.xxx.xxx.xxx</a> <br><br>  and such data is fairly easily received from third-party servers and parted <br><br>  $ IP = "00.00.00.00";  // or ah-pi from anywhere (in my case from the database) <br><br>  $ lines = file ('http://www.ip2city.ru/ip2city.php?ip='.$$); <br><br>  $ city = trim (str_replace ('=', '', strstr ($ lines ['0'], '='))); <br><br>  $ country = trim (str_replace ('=', '', strstr ($ lines ['4'], '='))); <br><br>  Naturally, with such work, PHP will take a long time to draw a page until it receives all the data from the server (the parsing itself is fast), so I would recommend the IP -&gt; city operation to be performed after the page loads. <br><br>  This is my first topic, I apologize in advance for errors.  I hope someone will come in handy </div><p>Source: <a href="https://habr.com/ru/post/25486/">https://habr.com/ru/post/25486/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254849/index.html">As we say</a></li>
<li><a href="../254853/index.html">How we fulfilled the requirement of Roskomnadzor with benefit for business</a></li>
<li><a href="../254855/index.html">Static code analysis</a></li>
<li><a href="../254857/index.html">The story of the unofficial application what3words for BlackBerry</a></li>
<li><a href="../254859/index.html">Dell has released a secure data center for the military</a></li>
<li><a href="../254861/index.html">Writing a script for arranging elements in a circle for Eagle CAD</a></li>
<li><a href="../254863/index.html">Analysis of the shopping cart using MS Excel and MS SQL Server</a></li>
<li><a href="../254865/index.html">Talk to me, Windows Phone</a></li>
<li><a href="../254867/index.html">Alpha TypeScript 1.5 Announcement</a></li>
<li><a href="../254869/index.html">Trigger metastability and inter-cycle synchronization</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>