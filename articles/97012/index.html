<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Time for Coded UI Tests</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will try to tell you in detail about working with Coded UI Test, one of the many innovations of Visual Studio 2010, as well as menti...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Time for Coded UI Tests</h1><div class="post__text post__text-html js-mediator-article"> In this article I will try to tell you in detail about working with Coded UI Test, one of the many innovations of Visual Studio 2010, as well as mentioning the problems I encountered. <br><br>  We will not waste time and immediately begin testing. <br><a name="habracut"></a><br><br>  I already have a simple WPF application, the interface of which will be subjected to testing.  It is a form with a button, two textboxes for data entry and another for output. <br><img src="https://habrastorage.org/storage/habraeffect/5a/0b/5a0b956d32d2004c30d21e71dc6c6d89.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Create a new test project using Visual Studio 2010. <br><img src="https://habrastorage.org/storage/habraeffect/32/09/3209390c997de41c61d585281910e18b.png" alt="image"><br><br>  Add a new Coded UI test.  This can be done either through Solution Explorer, or through the Test item in the main menu. <br>  We are invited to enter the file name and choose which test project to add it to. <br><img src="https://habrastorage.org/storage/habraeffect/e3/a6/e3a616276e4ad94cd51312183bfc4a12.png" alt="image"><br><br>  After clicking OK, the following window will appear. <br><img src="https://habrastorage.org/storage/habraeffect/d0/90/d0905bc40dccfb140846b1aa25fdab9e.png" alt="image"><br><br>  We are offered to either write down the sequence of actions using the special tool Coded UI Test Builder, or use the ready-made sequence. <br>  We are interested in the first option.  OK.  In the lower right corner of the screen, Coded UI Test Builder has opened. <br><img src="https://habrastorage.org/storage/habraeffect/1e/28/1e28eb5d8013047c81427b3c95addfbb.png" alt="image"><br><br>  On it, except for closing and help, only 4 buttons.  About them in order. <br><br>  Start recording. <br><img src="https://habrastorage.org/storage/habraeffect/0d/f8/0df8d940deff84cdd6e47cfb2b195c58.png" alt="image"><br><br>  View recorded steps. <br><img src="https://habrastorage.org/storage/habraeffect/e3/da/e3da7c12744cfe25383ac276860a4ad5.png" alt="image"><br><br>  Using this button, we can change the user interface map (the map contains all user interface controls displayed in the application under test).  And add a statement (assert). <br><img src="https://habrastorage.org/storage/habraeffect/07/e9/07e932632631d8786d907689b404c6a8.png" alt="image"><br><br>  And finally generate the code. <br><img src="https://habrastorage.org/storage/habraeffect/ee/90/ee900b994f11db85657f856570de0b5d.png" alt="image"><br><br>  For now, close Test Builder and go back to the studio. <br><br>  Links to the following basic assemblies are automatically added to the project. <br><img src="https://habrastorage.org/storage/habraeffect/57/57/5757740ac720aa47b2abeb4bcbb03b4e.png" alt="image"><br><br>  As well as an empty file CodedUITest1.cs.  We will add test methods to it.  Open it and create a StartApp () method in which our application will run.  To start Test Builder again, click the right mouse button inside the method. <br><br>  <b>Note: the</b> code will be generated in the line in which the menu will be called.  However, if we launch Test Builder by right-clicking on the method name, the new code will be generated above the old code. <br><br><img src="https://habrastorage.org/storage/habraeffect/3b/48/3b4826885d98c30402a4bff1575cc5e9.png" alt="image"><br><br>  The attribute [TestInitialize] says that the code marked with it will be called each time the test method is run. <br><br>  Exe-file of my application is on the desktop.  Click Start Recording and run the application. <br>  Let's look at the recorded actions. <br><img src="https://habrastorage.org/storage/habraeffect/ee/bb/eebbba16825abecc8a5efe987c0224a5.png" alt="image"><br><br>  We see that we received exactly what we wanted and now we can generate the code (In this case, the recording will automatically be interrupted). <br><br>  Enter a name for the method. <br><img src="https://habrastorage.org/storage/habraeffect/b6/6d/b66d4baadcd7226e46588a9b502e0652.png" alt="image"><br><br>  That's what we did. <br><img src="https://habrastorage.org/storage/habraeffect/e5/45/e545f42d7c06cbb36e0265fbcbc63ad1.png" alt="image"><br><br>  Here, <code>UIMap</code> is a property through which we will access written methods, comparisons, and user interface controls. <br><br>  Before we look at the implementation of the <code>StartRecordedMethod()</code> method, we <code>StartRecordedMethod()</code> look again at Solution Explorer. <br><img src="https://habrastorage.org/storage/habraeffect/2e/42/2e42441c6604d39ba6452f8c0ebf7918.png" alt="image"><br><br>  We have 3 new files: <br><ul><li>  UIMap.uitest is an XML file containing all controls on the UI Map. </li><li>  UIMap.Designer.cs - description of the UIMap class (marked with the <code>partial</code> modifier), contains the code representation of the UIMap.uitest file.  Automatically generated file, which is very important. </li><li>  UIMap.cs - UIMap class file.  All user interface map settings must be made in this file. </li></ul><br><br>  Now let's look at the implementation of the method we recorded in the UIMap.Designer.cs file <br><img src="https://habrastorage.org/storage/habraeffect/27/6c/276c548ff451b5dc6decff9bb9282eee.png" alt="image"><br><br>  There is nothing complicated here, ApplicationUnderTest is a standard class inherited from UITestControl.  The parameters of the Launch method are simply string variables that are automatically generated, it is easy to verify this. <br><img src="https://habrastorage.org/storage/habraeffect/9a/f0/9af0a5aac665aee305c3bbeeb62bf807.png" alt="image"><br><br>  <b>But there is a nuance.</b> <br><br>  If I put my application in a folder and try to record its launch, we will get a slightly different effect. <br><img src="https://habrastorage.org/storage/habraeffect/ff/24/ff2461eb89749e6526d5193c1017beea.png" alt="image"><br><br>  If you think about it a little, then everything falls into place.  My application belongs to an open window (folder) and no longer the application starts to be recorded (as such, although it will also happen), and Double Click on the element belonging to the recordable window. <br><br>  In order not to bother with this, we can easily describe launching an application manually, either by creating the appropriate method in the UIMap.cs file, or directly in the test method in the CodedUITest1.cs file as shown below. <br><img src="https://habrastorage.org/storage/habraeffect/b6/db/b6db23ac9d631898c69dbcf34cda95d5.png" alt="image"><br><br>  Similarly, we write the closure of the application and mark the method with the attribute [TestCleanup], the attribute indicates that this method will be run every time after the end of each method in the test. <br><img src="https://habrastorage.org/storage/habraeffect/23/f5/23f526c48cffa0e4d5d6fe444cde43d5.png" alt="image"><br><br>  Let's look at the implementation of the <code>CloseAppRecordedMethod()</code> method. <br><img src="https://habrastorage.org/storage/habraeffect/b5/8b/b58b1440abaf77d1c73a688cca68d401.png" alt="image"><br><br>  The interaction takes place with the help of the static <code>Click</code> method of the class <code>Mouse</code> , as parameters to which the object (control) and click coordinates relative to the object are passed. <br><br>  It's time to record the interaction with the interface of our application. <br><br>  Create the <code>InterfaceTestMethod()</code> method in the CodedUITest1.cs file and mark it with the <code>[TestMethod]</code> attribute <br><br>  We act according to a proven scheme =) <br><img src="https://habrastorage.org/storage/habraeffect/f6/6c/f66c5103f6d7b234469dc4bae5527a4d.png" alt="image"><br><br>  Click on the code generation button and specify the name, I will call the <code>InterfaceTestRecordedMethod()</code> method <br><img src="https://habrastorage.org/storage/habraeffect/56/b2/56b24e517d74af1f15ed8593d43217b8.png" alt="image"><br><br>  Let's look at the implementation. <br><img src="https://habrastorage.org/storage/habraeffect/69/a7/69a7349a4d85ed369b251d65a0aea8c3.png" alt="image"><br><br>  Here we see another standard class for interacting with the <code>Keyboard</code> interface.  Through the static <code>SendKeys</code> method, we report about pressing the tab key. <br><br>  Our test is almost ready.  What is missing is some kind of verification =) <br><br>  We implement it.  Add a check for TextBox, in which the result is displayed, after clicking on the button.  Make it simple enough. <br><br>  Again, open the UI Test Builder from the <code>InterfaceTestMethod()</code> method and click on the third button to the left (adding an assertion).  I will say a few words about the interface of the opened window. <br><img src="https://habrastorage.org/storage/habraeffect/f4/64/f464fd01221b79f95b88bcdf4b6558fa.png" alt="image"><br><br>  All that is available to us at the moment is a button in the upper left corner.  By clicking it we will see the list of controls on our user interface map.  It will contain only those elements that participated in writing actions to the <code>InterfaceTestRecordedMethod()</code> method.  Selecting any item in the list, on the right we will see its properties.  The ‚ÄúAdd assertion‚Äù elements and the two elements to the right of it will also become active (using the first one, you can update the list of properties, and with the second, you can change the currently selected item). <br><br>  <b>Note:</b> To be able to view all the properties, you must run the application under test. <br><br>  We do not need the control element (TextBox3) on the map, of course.  To add it, we need to hold the left mouse button and drag the ‚Äúsight‚Äù to our TextBox.  The item will be marked with a blue frame and added to the list of items, then click Add control to UI Control Map (Alt + C) to add an item to the map. <br><img src="https://habrastorage.org/storage/habraeffect/9d/a1/9da17c22faff822a0f136c0b91a0571e.png" alt="image"><br><br>  <b>Note:</b> here we can rename and delete the selected item. <br><br>  To add an assertion, select the property of interest and click Add Assertion. <br><img src="https://habrastorage.org/storage/habraeffect/8a/d8/8ad8047222f6ad5d70275eede628c556.png" alt="image"><br><br>  A dialog will appear in which we will be asked to choose the type of statement and the expected value for comparison. <br><img src="https://habrastorage.org/storage/habraeffect/97/a0/97a06e43b416e936821a28001b2cdcd9.png" alt="image"><br><br>  Generate the code.  I will call the <code>ResultAssertEqualMethod()</code> method. <br><img src="https://habrastorage.org/storage/habraeffect/c5/c2/c5c2850504d6fa535e891ee1fcdbfdfb.png" alt="image"><br><img src="https://habrastorage.org/storage/habraeffect/3a/5a/3a5aa870bf0111f6d6d930d4a53a3136.png" alt="image"><br><br>  Implementation: <br><img src="https://habrastorage.org/storage/habraeffect/ed/b1/edb17b8e337d81cc25978669ff676b46.png" alt="image"><br><br>  Normal Assert, the first parameter (expected value) to which the variable with the value ‚ÄúVisual Studio 2010, Hey!‚Äù Is passed, and the second (actual value) property Text of our control. <br><br>  <b>Note:</b> this approach has a big minus.  When automatically generating methods that include statements, we are not able to pass additional parameters to static methods (for example, <code>AreEqual()</code> ).  But we can do everything on our own in the UIMap.cs file or in CodedUITest1.cs. <br><img src="https://habrastorage.org/storage/habraeffect/a0/05/a005226162cbd554e49bca581a497730.png" alt="image"><br><br>  All is ready.  You can run!  (Although no one forbade doing this before). <br><img src="https://habrastorage.org/storage/habraeffect/d8/c3/d8c3babfce07a7898aa8bd34bc8c6aae.png"><br><br>  The results are not long in coming. <br><img src="https://habrastorage.org/storage/habraeffect/b7/79/b779deaa87772a102083445655734c45.png" alt="image"><br><br>  Everything would be fine, but what if we want to use an external data source to be used in our test?  Everything is very simple.  To do this, follow these steps. <br><br>  Open the Test View and select our test method. <br><img src="https://habrastorage.org/storage/habraeffect/b1/fb/b1fb62b616a940c61fab2c298cb9b408.png" alt="image"><br><br>  We will show the properties of the method, among them we are interested in Data Connection String.  Click on the dot to the right of the property.  The Wizard opens and prompts you to select the type of data source. <br><img src="https://habrastorage.org/storage/habraeffect/cd/f8/cdf8f683b14b7819d2986e5acc5b7dd3.png" alt="image"><br><br>  I have a pre-prepared XML file, so I‚Äôll choose option 3.  And click Next&gt; <br><br>  Content of my xml file: <br><img src="https://habrastorage.org/storage/habraeffect/7b/1a/7b1a3d6712b599f52bc41e642fee5c65.png" alt="image"><br><br>  We specify the path to the file and we can immediately see the data set.  And again click Next&gt; <br><img src="https://habrastorage.org/storage/habraeffect/24/78/2478090e620679d4c9f2218c6254ee63.png" alt="image"><br><br>  Choose a table, Next&gt; <br><img src="https://habrastorage.org/storage/habraeffect/88/3b/883bb4b197765039219aa6f29c4568c5.png" alt="image"><br><br>  And we are kindly offered to add a file to the project.  We agree. <br><img src="https://habrastorage.org/storage/habraeffect/5e/12/5e12a4bbedf45f767438d59c12a91ee6.png" alt="image"><br><br>  Our test method is marked with the following attributes: <br><img src="https://habrastorage.org/storage/habraeffect/1c/6b/1c6b9d49ed1b3b4e4b711a1c4e8ba786.png" alt="image"><br><br>  Now the data from my XML file is available through <code>TextContext</code> .  But we still need to pass them in some way to the <code>InterfaceTestRecordedMethod()</code> and <code>ResultAssertEqualMethod()</code> methods.  These methods are implemented in the UIMap.Designer.cs file, so we cannot change them.  More precisely, we can, but not for long (until the next code generation). <br><br>  Let's go the other way. <br><br>  We use another innovation, the Navigate To function, and look for the methods generated by Builder. <br><br><img src="https://habrastorage.org/storage/habraeffect/ee/cf/eecfa92f2258425f9c1fa06f338c9840.png" alt="image"><br>  To pass parameters to methods that record a sequence of actions, the class <code>XXX <i>Params</i></code> generated, where <code>XXX</code> is the name of the method. <br><br><img src="https://habrastorage.org/storage/habraeffect/be/73/be735d9bf28931388c6860f0df3a1444.png" alt="image"><br>  And for passing parameters to the approval method - <code>XXX <i>EpectedValues</i> .</code> <br><br>  Let's go back to our <code>InterfaceTestMethod()</code> test method and change it as follows: <br><img src="https://habrastorage.org/storage/habraeffect/36/93/3693bdc04d9edbae651648522df422bd.png" alt="image"><br><br>  Run the test. <br><img src="https://habrastorage.org/storage/habraeffect/fe/26/fe26ac2ac9c049c78cecdab0e2269535.png" alt="image"><br><br>  <b>Note:</b> if you are attentive enough, you might have noticed that in spite of the two data sets for the test, the result is that 3 of 3 are done: <br><img src="https://habrastorage.org/storage/habraeffect/c9/54/c954c71d8240dd7a07138e77c2131ba4.png" alt="image"><br>  This is due to the fact that the test with all data sets is also considered a test. <br><br>  A couple of times by clicking on the test result, you can get a more detailed report. <br><img src="https://habrastorage.org/storage/habraeffect/5b/90/5b902612a126ecb8570e57249a1937b5.png" alt="image"><br><br>  Well that's all.  The test was successfully passed, but I promised to tell you about the problems I encountered. <br>  Here they are: <br><br>  It was originally supposed to make the output of the result not in the TextBox, but in the MessageBox. <br>  But what happened with the different contents of MessageBox: <br><img src="https://habrastorage.org/storage/habraeffect/58/39/58399909fea67de20574ba42245417e4.png" alt="image"><br><br>  Each time a new control was created on the UI Map.  Those.  if I took data from the same XML without adding an element with this data to the map, then the test would fail.  Agree, it is not very convenient =) <br><br>  You cannot write a sequence of actions and add assert to one method using the UI Test Builder, which is also not very convenient. <br><br>  And finally, I was unable to delete the method generated by the UI Test Builder with a recorded sequence of actions. <br><br>  UPD: Test project can be downloaded <a href="http://www.data-stock.com/148863/Time%2Bfor%2BCoded%2BUI%2BTests.rar.html">here</a> . </div><p>Source: <a href="https://habr.com/ru/post/97012/">https://habr.com/ru/post/97012/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../96999/index.html">Video and slides of reports from AgileDays in Yekaterinburg</a></li>
<li><a href="../97003/index.html">Hyper-V and storage devices</a></li>
<li><a href="../97007/index.html">Ampersands in string constants</a></li>
<li><a href="../97008/index.html">Star Iron Kit</a></li>
<li><a href="../97011/index.html">New features for vectorization and paralleling in Intel¬Æ Parallel Composer</a></li>
<li><a href="../97013/index.html">life :) Belarus started selling Android phone. $ 23 contract per month</a></li>
<li><a href="../97015/index.html">Panda Cloud Antivirus Update</a></li>
<li><a href="../97019/index.html">Pay taxes through WebMoney - and sleep well</a></li>
<li><a href="../97020/index.html">The first ever Russian-Iranian agreement in the field of IT has been concluded: the MMORTS Elements of War will be published in the Islamic Republic</a></li>
<li><a href="../97021/index.html">Eliminate noise on embedded sound cards</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>