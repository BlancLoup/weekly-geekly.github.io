<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Webserver nginx + fastcgi-wrapper + matlab</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I wondered not for the first time: what programming languages ‚Äã‚Äãare suitable for the web, and does it make sense to solve some narrow problem in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Webserver nginx + fastcgi-wrapper + matlab</h1><div class="post__text post__text-html js-mediator-article"><p>  Today I wondered not for the first time: what programming languages ‚Äã‚Äãare suitable for the web, and does it make sense to solve some narrow problem in a way that at first glance doesn‚Äôt fit?  I wanted to practice doing something ordinary in an unusual way. </p><br><a name="habracut"></a><br><h4>  For what? </h4><br>  I set out to write a web application entirely in matlab without using any wrappers.  Why did I start to do this?  There are several reasons.  I thought it was just funny.  In addition, I watched how many web programmers are inclined in their work to some kind of stereotypical solutions that could be called "PHP brain".  This is by no means a reproach to php programmers, there is just such a phenomenon and I think my note will be an example to someone. <br><br><h4>  How? </h4><br>  As the interpreter of this language, I chose GNU Octave because of its free and easy access on Linux.  I chose nginx as a web server for the reason that I work a lot with it and it‚Äôs just very convenient for me.  I needed to make the script work at the lab as a CGI application.  For Unixes, there is a simple possibility for this - at the beginning of a text file, you can specify the path and parameters of the interpreter, and if the file has an executable attribute, it can be run and will be executed by this interpreter.  Nginx by itself does not know how to perform simple CGI and the examples of wrappers <a href="http://wiki.nginx.org/SimpleCGI">from here</a> have NOT helped me.  In <a href="https://coolchevy.org.ua/2011/11/25/simple-cgi-support-for-nginx/">another source</a> , not so close to the creators of the web server, it was suggested to use fcgiwrapper for nginx, which is even included in my debian distribution. <br><br><h4>  What happened? </h4><br>  Fragment of the final nginx configuration: <br><pre><code class="hljs smalltalk">location ~ \.m<span class="hljs-string"><span class="hljs-string">$ </span></span>{ gzip off; <span class="hljs-symbol"><span class="hljs-symbol">#gzip</span></span> makes scripts feel slower since they have to complete before getting gzipped fastcgi_pass unix:/var/run/fcgiwrap.socket; fastcgi_index index.m; fastcgi_param <span class="hljs-type"><span class="hljs-type">SCRIPT_FILENAME</span></span> /var/www/m.leprodc<span class="hljs-string"><span class="hljs-string">$f</span></span>astcgi_script_name; fastcgi_param <span class="hljs-type"><span class="hljs-type">QUERY_STRING</span></span> <span class="hljs-string"><span class="hljs-string">$q</span></span>uery_string; fastcgi_param <span class="hljs-type"><span class="hljs-type">REQUEST_METHOD</span></span> <span class="hljs-string"><span class="hljs-string">$r</span></span>equest_method; fastcgi_param <span class="hljs-type"><span class="hljs-type">CONTENT_TYPE</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>ontent_type; fastcgi_param <span class="hljs-type"><span class="hljs-type">CONTENT_LENGTH</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>ontent_length; fastcgi_param <span class="hljs-type"><span class="hljs-type">GATEWAY_INTERFACE</span></span> <span class="hljs-type"><span class="hljs-type">CGI</span></span>/<span class="hljs-number"><span class="hljs-number">1.1</span></span>; fastcgi_param <span class="hljs-type"><span class="hljs-type">SERVER_SOFTWARE</span></span> nginx; fastcgi_param <span class="hljs-type"><span class="hljs-type">SCRIPT_NAME</span></span> <span class="hljs-string"><span class="hljs-string">$f</span></span>astcgi_script_name; fastcgi_param <span class="hljs-type"><span class="hljs-type">REQUEST_URI</span></span> <span class="hljs-string"><span class="hljs-string">$r</span></span>equest_uri; fastcgi_param <span class="hljs-type"><span class="hljs-type">DOCUMENT_URI</span></span> <span class="hljs-string"><span class="hljs-string">$d</span></span>ocument_uri; fastcgi_param <span class="hljs-type"><span class="hljs-type">DOCUMENT_ROOT</span></span> <span class="hljs-string"><span class="hljs-string">$d</span></span>ocument_root; fastcgi_param <span class="hljs-type"><span class="hljs-type">SERVER_PROTOCOL</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erver_protocol; fastcgi_param <span class="hljs-type"><span class="hljs-type">REMOTE_ADDR</span></span> <span class="hljs-string"><span class="hljs-string">$r</span></span>emote_addr; fastcgi_param <span class="hljs-type"><span class="hljs-type">REMOTE_PORT</span></span> <span class="hljs-string"><span class="hljs-string">$r</span></span>emote_port; fastcgi_param <span class="hljs-type"><span class="hljs-type">SERVER_ADDR</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erver_addr; fastcgi_param <span class="hljs-type"><span class="hljs-type">SERVER_PORT</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erver_port; fastcgi_param <span class="hljs-type"><span class="hljs-type">SERVER_NAME</span></span> <span class="hljs-string"><span class="hljs-string">$s</span></span>erver_name; }</code> </pre> <br>  Script code for plot1.m: <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/octave -q domain="m.leprodc.ru"; ARG=sscanf(getenv("QUERY_STRING"),"a=%g&amp;b=%g&amp;c=%g"); if (length(ARG)==3) a=ARG(1); b=ARG(2); c=ARG(3); handle=figure; X=-10:0.1:10; Y=a.*X.^2+b.*X+c; printf("Content-type: text/plain\n\n"); plot(X,Y); print(handle, sprintf('/tmp/plot-%s:%s.png',getenv("REMOTE_ADDR"),getenv("REMOTE_PORT")),'-dpng'); printf("Full image: http://%s/plot-%s:%s.png\n\n",domain,getenv("REMOTE_ADDR"),getenv("REMOTE_PORT")); else printf("Location: http://%s/\n\n",domain); endif</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What happened? </h4><br>  For example, here: <a href="http://m.leprodc.ru/">http://m.leprodc.ru/</a> <a href="http://m.leprodc.ru/"><br></a> <br><h5>  Read: </h5><br><ul><li>  <a href="http://wiki.nginx.org/SimpleCGI">http://wiki.nginx.org/SimpleCGI</a> </li><li>  <a href="https://coolchevy.org.ua/2011/11/25/simple-cgi-support-for-nginx">https://coolchevy.org.ua/2011/11/25/simple-cgi-support-for-nginx</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/138984/">https://habr.com/ru/post/138984/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../138979/index.html">How to write an article using UX and GTD</a></li>
<li><a href="../138980/index.html">How does it work in a Google office in Zurich?</a></li>
<li><a href="../138981/index.html">Prototyping Windows Phone Applications in SketchFlow</a></li>
<li><a href="../138982/index.html">Mozilla and Telefonica are working on a new mobile OS.</a></li>
<li><a href="../138983/index.html">Mozillovsky Boot to Gecko: The Web is a Platform</a></li>
<li><a href="../138986/index.html">Crypto Solitaire</a></li>
<li><a href="../138987/index.html">Asynchronous IndexedDB API wrapper</a></li>
<li><a href="../138989/index.html">Methods for monitoring websites and services</a></li>
<li><a href="../138990/index.html">Mobilization: Opera Mobile 12 and Opera Mini 7 Next</a></li>
<li><a href="../138991/index.html">The FBI ordered the court to shut off 3,000 GPS bugs, now it cannot find them</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>