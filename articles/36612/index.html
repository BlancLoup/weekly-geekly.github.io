<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Copy / paste functionality between Swing's JTables and Excel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the translator : this translation is just a sample of the pen. I would be very grateful for all the comments. I hope for your help in bringing th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Copy / paste functionality between Swing's JTables and Excel</h1><div class="post__text post__text-html js-mediator-article">  <i><b>From the translator</b> : this translation is just a sample of the pen.</i>  <i>I would be very grateful for all the comments.</i>  <i>I hope for your help in bringing this article to the literary form.</i>  <i>Here is a small list of what I want to fix in this article:</i> <i><br></i> <ul><li>  make the article more ‚ÄúRussian‚Äù, and not just a set of translated words. </li></ul><br><br>  Many business applications are developed using Java.  Most of them display data as tables using Swing JTable.  It would be very convenient to be able to copy and paste data from this application into Microsoft Excel and back.  This way, users can take advantage of all the power of this omnipresent program. <br><br>  This Java tip will help you understand the principle of the Excel-generated string, placed on the system clipboard, that will allow you to achieve copy / paste functionality when interacting JTable and Excel.  As you will see later, this advice is complete and allows you to achieve the desired result literally adding one line of code. <br><a name="habracut"></a><br>  All you need to achieve this goal is to copy the ExcelAdapter.java file described below, compile it and take care of the availability of the resulting class for your application.  Once you do this, your JTable is ready to "talk" with Excel.  We will show which line you need to add to provide copy / paste functionality with Excel.  Of course, an example of a simple application provided with this functionality will also be given. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Adapter class </h1><br>  Below is the code of the adapter class, called ExcelAdapter.java, which is designed to solve this problem: <br><br> <code><a href="http://source.virtser.net/"></a> <font color="black">import java.awt.*; <br> import java.awt. <font color="#0000ff">event</font> .*; <br> import javax.swing.*; <br> import java.awt.datatransfer.*; <br> import java.util.*; <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* ExcelAdapter enables Copy-Paste Clipboard functionality on JTables. The</font> <br> <font color="#008000">* clipboard data format used by the adapter is compatible with the clipboard</font> <br> <font color="#008000">* format used by Excel. This provides for clipboard interoperability between</font> <br> <font color="#008000">* enabled JTables and Excel.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> ExcelAdapter implements ActionListener { <br> <font color="#0000ff">private</font> <font color="#2B91AF">String</font> rowstring, <font color="#0000ff">value</font> ; <br> <font color="#0000ff">private</font> Clipboard system; <br> <font color="#0000ff">private</font> StringSelection stsel; <br> <font color="#0000ff">private</font> JTable jTable1; <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* The Excel Adapter is constructed with a JTable on which it enables</font> <br> <font color="#008000">* Copy-Paste and acts as a Clipboard listener.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> ExcelAdapter(JTable myJTable) { <br> jTable1 = myJTable; <br> KeyStroke copy = KeyStroke.getKeyStroke(KeyEvent.VK_C, <br> ActionEvent.CTRL_MASK, <font color="#0000ff">false</font> ); <br> <font color="#008000">// Identifying the copy KeyStroke user can modify this</font> <br> <font color="#008000">// to copy on some other Key combination.</font> <br> KeyStroke paste = KeyStroke.getKeyStroke(KeyEvent.VK_V, <br> ActionEvent.CTRL_MASK, <font color="#0000ff">false</font> ); <br> <font color="#008000">// Identifying the Paste KeyStroke user can modify this</font> <br> <font color="#008000">// to copy on some other Key combination.</font> <br> jTable1.registerKeyboardAction( <font color="#0000ff">this</font> , <font color="#A31515">"Copy"</font> , copy, <br> JComponent.WHEN_FOCUSED); <br> jTable1.registerKeyboardAction( <font color="#0000ff">this</font> , <font color="#A31515">"Paste"</font> , paste, <br> JComponent.WHEN_FOCUSED); <br> system = Toolkit.getDefaultToolkit().getSystemClipboard(); <br> } <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* Public Accessor methods for the Table on which this adapter acts.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> JTable getJTable() { <br> <font color="#0000ff">return</font> jTable1; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> setJTable(JTable jTable1) { <br> <font color="#0000ff">this</font> .jTable1 = jTable1; <br> } <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* This method is activated on the Keystrokes we are listening to in this</font> <br> <font color="#008000">* implementation. Here it listens for Copy and Paste ActionCommands.</font> <br> <font color="#008000">* Selections comprising non-adjacent cells result in invalid selection and</font> <br> <font color="#008000">* then copy action cannot be performed. Paste is done by aligning the upper</font> <br> <font color="#008000">* left corner of the selection with the 1st element in the current</font> <br> <font color="#008000">* selection of the JTable.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> actionPerformed(ActionEvent e) { <br> <font color="#0000ff">if</font> (e.getActionCommand().compareTo( <font color="#A31515">"Copy"</font> ) == 0) { <br> StringBuffer sbf = <font color="#0000ff">new</font> StringBuffer(); <br> <font color="#008000">// Check to ensure we have selected only a contiguous block of</font> <br> <font color="#008000">// cells</font> <br> <font color="#0000ff">int</font> numcols = jTable1.getSelectedColumnCount(); <br> <font color="#0000ff">int</font> numrows = jTable1.getSelectedRowCount(); <br> <font color="#0000ff">int</font> [] rowsselected = jTable1.getSelectedRows(); <br> <font color="#0000ff">int</font> [] colsselected = jTable1.getSelectedColumns(); <br> <font color="#0000ff">if</font> (!((numrows - 1 == rowsselected[rowsselected.length - 1] <br> - rowsselected[0] &amp;&amp; numrows == rowsselected.length) &amp;&amp; (numcols - 1 == colsselected[colsselected.length - 1] <br> - colsselected[0] &amp;&amp; numcols == colsselected.length))) { <br> JOptionPane.showMessageDialog( <font color="#0000ff">null</font> , <font color="#A31515">"Invalid Copy Selection"</font> , <br> <font color="#A31515">"Invalid Copy Selection"</font> , JOptionPane.ERROR_MESSAGE); <br> <font color="#0000ff">return</font> ; <br> } <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; numrows; i++) { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; j &lt; numcols; j++) { <br> sbf.append(jTable1.getValueAt(rowsselected[i], <br> colsselected[j])); <br> <font color="#0000ff">if</font> (j &lt; numcols - 1) <br> sbf.append( <font color="#A31515">"\t"</font> ); <br> } <br> sbf.append( <font color="#A31515">"\n"</font> ); <br> } <br> stsel = <font color="#0000ff">new</font> StringSelection(sbf.toString()); <br> system = Toolkit.getDefaultToolkit().getSystemClipboard(); <br> system.setContents(stsel, stsel); <br> } <br> <font color="#0000ff">if</font> (e.getActionCommand().compareTo( <font color="#A31515">"Paste"</font> ) == 0) { <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"Trying to Paste"</font> ); <br> <font color="#0000ff">int</font> startRow = (jTable1.getSelectedRows())[0]; <br> <font color="#0000ff">int</font> startCol = (jTable1.getSelectedColumns())[0]; <br> <font color="#0000ff">try</font> { <br> <font color="#2B91AF">String</font> trstring = ( <font color="#2B91AF">String</font> ) (system.getContents( <font color="#0000ff">this</font> ) <br> .getTransferData(DataFlavor.stringFlavor)); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"String is:"</font> + trstring); <br> StringTokenizer st1 = <font color="#0000ff">new</font> StringTokenizer(trstring, <font color="#A31515">"\n"</font> ); <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; st1.hasMoreTokens(); i++) { <br> rowstring = st1.nextToken(); <br> StringTokenizer st2 = <font color="#0000ff">new</font> StringTokenizer(rowstring, <font color="#A31515">"\t"</font> ); <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; st2.hasMoreTokens(); j++) { <br> <font color="#0000ff">value</font> = ( <font color="#2B91AF">String</font> ) st2.nextToken(); <br> <font color="#0000ff">if</font> (startRow + i &lt; jTable1.getRowCount() <br> &amp;&amp; startCol + j &lt; jTable1.getColumnCount()) <br> jTable1.setValueAt( <font color="#0000ff">value</font> , startRow + i, startCol <br> + j); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"Putting "</font> + <font color="#0000ff">value</font> + <font color="#A31515">"at row="</font> <br> + startRow + i + <font color="#A31515">"column="</font> + startCol + j); <br> } <br> } <br> } <font color="#0000ff">catch</font> (Exception ex) { <br> ex.printStackTrace(); <br> } <br> } <br> } <br> }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code> <blockquote> <code><a href="http://source.virtser.net/"></a> <font color="black">import java.awt.*; <br> import java.awt. <font color="#0000ff">event</font> .*; <br> import javax.swing.*; <br> import java.awt.datatransfer.*; <br> import java.util.*; <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* ExcelAdapter enables Copy-Paste Clipboard functionality on JTables. The</font> <br> <font color="#008000">* clipboard data format used by the adapter is compatible with the clipboard</font> <br> <font color="#008000">* format used by Excel. This provides for clipboard interoperability between</font> <br> <font color="#008000">* enabled JTables and Excel.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> ExcelAdapter implements ActionListener { <br> <font color="#0000ff">private</font> <font color="#2B91AF">String</font> rowstring, <font color="#0000ff">value</font> ; <br> <font color="#0000ff">private</font> Clipboard system; <br> <font color="#0000ff">private</font> StringSelection stsel; <br> <font color="#0000ff">private</font> JTable jTable1; <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* The Excel Adapter is constructed with a JTable on which it enables</font> <br> <font color="#008000">* Copy-Paste and acts as a Clipboard listener.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> ExcelAdapter(JTable myJTable) { <br> jTable1 = myJTable; <br> KeyStroke copy = KeyStroke.getKeyStroke(KeyEvent.VK_C, <br> ActionEvent.CTRL_MASK, <font color="#0000ff">false</font> ); <br> <font color="#008000">// Identifying the copy KeyStroke user can modify this</font> <br> <font color="#008000">// to copy on some other Key combination.</font> <br> KeyStroke paste = KeyStroke.getKeyStroke(KeyEvent.VK_V, <br> ActionEvent.CTRL_MASK, <font color="#0000ff">false</font> ); <br> <font color="#008000">// Identifying the Paste KeyStroke user can modify this</font> <br> <font color="#008000">// to copy on some other Key combination.</font> <br> jTable1.registerKeyboardAction( <font color="#0000ff">this</font> , <font color="#A31515">"Copy"</font> , copy, <br> JComponent.WHEN_FOCUSED); <br> jTable1.registerKeyboardAction( <font color="#0000ff">this</font> , <font color="#A31515">"Paste"</font> , paste, <br> JComponent.WHEN_FOCUSED); <br> system = Toolkit.getDefaultToolkit().getSystemClipboard(); <br> } <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* Public Accessor methods for the Table on which this adapter acts.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> JTable getJTable() { <br> <font color="#0000ff">return</font> jTable1; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> setJTable(JTable jTable1) { <br> <font color="#0000ff">this</font> .jTable1 = jTable1; <br> } <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* This method is activated on the Keystrokes we are listening to in this</font> <br> <font color="#008000">* implementation. Here it listens for Copy and Paste ActionCommands.</font> <br> <font color="#008000">* Selections comprising non-adjacent cells result in invalid selection and</font> <br> <font color="#008000">* then copy action cannot be performed. Paste is done by aligning the upper</font> <br> <font color="#008000">* left corner of the selection with the 1st element in the current</font> <br> <font color="#008000">* selection of the JTable.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> actionPerformed(ActionEvent e) { <br> <font color="#0000ff">if</font> (e.getActionCommand().compareTo( <font color="#A31515">"Copy"</font> ) == 0) { <br> StringBuffer sbf = <font color="#0000ff">new</font> StringBuffer(); <br> <font color="#008000">// Check to ensure we have selected only a contiguous block of</font> <br> <font color="#008000">// cells</font> <br> <font color="#0000ff">int</font> numcols = jTable1.getSelectedColumnCount(); <br> <font color="#0000ff">int</font> numrows = jTable1.getSelectedRowCount(); <br> <font color="#0000ff">int</font> [] rowsselected = jTable1.getSelectedRows(); <br> <font color="#0000ff">int</font> [] colsselected = jTable1.getSelectedColumns(); <br> <font color="#0000ff">if</font> (!((numrows - 1 == rowsselected[rowsselected.length - 1] <br> - rowsselected[0] &amp;&amp; numrows == rowsselected.length) &amp;&amp; (numcols - 1 == colsselected[colsselected.length - 1] <br> - colsselected[0] &amp;&amp; numcols == colsselected.length))) { <br> JOptionPane.showMessageDialog( <font color="#0000ff">null</font> , <font color="#A31515">"Invalid Copy Selection"</font> , <br> <font color="#A31515">"Invalid Copy Selection"</font> , JOptionPane.ERROR_MESSAGE); <br> <font color="#0000ff">return</font> ; <br> } <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; numrows; i++) { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; j &lt; numcols; j++) { <br> sbf.append(jTable1.getValueAt(rowsselected[i], <br> colsselected[j])); <br> <font color="#0000ff">if</font> (j &lt; numcols - 1) <br> sbf.append( <font color="#A31515">"\t"</font> ); <br> } <br> sbf.append( <font color="#A31515">"\n"</font> ); <br> } <br> stsel = <font color="#0000ff">new</font> StringSelection(sbf.toString()); <br> system = Toolkit.getDefaultToolkit().getSystemClipboard(); <br> system.setContents(stsel, stsel); <br> } <br> <font color="#0000ff">if</font> (e.getActionCommand().compareTo( <font color="#A31515">"Paste"</font> ) == 0) { <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"Trying to Paste"</font> ); <br> <font color="#0000ff">int</font> startRow = (jTable1.getSelectedRows())[0]; <br> <font color="#0000ff">int</font> startCol = (jTable1.getSelectedColumns())[0]; <br> <font color="#0000ff">try</font> { <br> <font color="#2B91AF">String</font> trstring = ( <font color="#2B91AF">String</font> ) (system.getContents( <font color="#0000ff">this</font> ) <br> .getTransferData(DataFlavor.stringFlavor)); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"String is:"</font> + trstring); <br> StringTokenizer st1 = <font color="#0000ff">new</font> StringTokenizer(trstring, <font color="#A31515">"\n"</font> ); <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; st1.hasMoreTokens(); i++) { <br> rowstring = st1.nextToken(); <br> StringTokenizer st2 = <font color="#0000ff">new</font> StringTokenizer(rowstring, <font color="#A31515">"\t"</font> ); <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; st2.hasMoreTokens(); j++) { <br> <font color="#0000ff">value</font> = ( <font color="#2B91AF">String</font> ) st2.nextToken(); <br> <font color="#0000ff">if</font> (startRow + i &lt; jTable1.getRowCount() <br> &amp;&amp; startCol + j &lt; jTable1.getColumnCount()) <br> jTable1.setValueAt( <font color="#0000ff">value</font> , startRow + i, startCol <br> + j); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"Putting "</font> + <font color="#0000ff">value</font> + <font color="#A31515">"at row="</font> <br> + startRow + i + <font color="#A31515">"column="</font> + startCol + j); <br> } <br> } <br> } <font color="#0000ff">catch</font> (Exception ex) { <br> ex.printStackTrace(); <br> } <br> } <br> } <br> }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code> </blockquote> <code><a href="http://source.virtser.net/"></a> <font color="black">import java.awt.*; <br> import java.awt. <font color="#0000ff">event</font> .*; <br> import javax.swing.*; <br> import java.awt.datatransfer.*; <br> import java.util.*; <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* ExcelAdapter enables Copy-Paste Clipboard functionality on JTables. The</font> <br> <font color="#008000">* clipboard data format used by the adapter is compatible with the clipboard</font> <br> <font color="#008000">* format used by Excel. This provides for clipboard interoperability between</font> <br> <font color="#008000">* enabled JTables and Excel.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> ExcelAdapter implements ActionListener { <br> <font color="#0000ff">private</font> <font color="#2B91AF">String</font> rowstring, <font color="#0000ff">value</font> ; <br> <font color="#0000ff">private</font> Clipboard system; <br> <font color="#0000ff">private</font> StringSelection stsel; <br> <font color="#0000ff">private</font> JTable jTable1; <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* The Excel Adapter is constructed with a JTable on which it enables</font> <br> <font color="#008000">* Copy-Paste and acts as a Clipboard listener.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> ExcelAdapter(JTable myJTable) { <br> jTable1 = myJTable; <br> KeyStroke copy = KeyStroke.getKeyStroke(KeyEvent.VK_C, <br> ActionEvent.CTRL_MASK, <font color="#0000ff">false</font> ); <br> <font color="#008000">// Identifying the copy KeyStroke user can modify this</font> <br> <font color="#008000">// to copy on some other Key combination.</font> <br> KeyStroke paste = KeyStroke.getKeyStroke(KeyEvent.VK_V, <br> ActionEvent.CTRL_MASK, <font color="#0000ff">false</font> ); <br> <font color="#008000">// Identifying the Paste KeyStroke user can modify this</font> <br> <font color="#008000">// to copy on some other Key combination.</font> <br> jTable1.registerKeyboardAction( <font color="#0000ff">this</font> , <font color="#A31515">"Copy"</font> , copy, <br> JComponent.WHEN_FOCUSED); <br> jTable1.registerKeyboardAction( <font color="#0000ff">this</font> , <font color="#A31515">"Paste"</font> , paste, <br> JComponent.WHEN_FOCUSED); <br> system = Toolkit.getDefaultToolkit().getSystemClipboard(); <br> } <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* Public Accessor methods for the Table on which this adapter acts.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> JTable getJTable() { <br> <font color="#0000ff">return</font> jTable1; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> setJTable(JTable jTable1) { <br> <font color="#0000ff">this</font> .jTable1 = jTable1; <br> } <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">* This method is activated on the Keystrokes we are listening to in this</font> <br> <font color="#008000">* implementation. Here it listens for Copy and Paste ActionCommands.</font> <br> <font color="#008000">* Selections comprising non-adjacent cells result in invalid selection and</font> <br> <font color="#008000">* then copy action cannot be performed. Paste is done by aligning the upper</font> <br> <font color="#008000">* left corner of the selection with the 1st element in the current</font> <br> <font color="#008000">* selection of the JTable.</font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> actionPerformed(ActionEvent e) { <br> <font color="#0000ff">if</font> (e.getActionCommand().compareTo( <font color="#A31515">"Copy"</font> ) == 0) { <br> StringBuffer sbf = <font color="#0000ff">new</font> StringBuffer(); <br> <font color="#008000">// Check to ensure we have selected only a contiguous block of</font> <br> <font color="#008000">// cells</font> <br> <font color="#0000ff">int</font> numcols = jTable1.getSelectedColumnCount(); <br> <font color="#0000ff">int</font> numrows = jTable1.getSelectedRowCount(); <br> <font color="#0000ff">int</font> [] rowsselected = jTable1.getSelectedRows(); <br> <font color="#0000ff">int</font> [] colsselected = jTable1.getSelectedColumns(); <br> <font color="#0000ff">if</font> (!((numrows - 1 == rowsselected[rowsselected.length - 1] <br> - rowsselected[0] &amp;&amp; numrows == rowsselected.length) &amp;&amp; (numcols - 1 == colsselected[colsselected.length - 1] <br> - colsselected[0] &amp;&amp; numcols == colsselected.length))) { <br> JOptionPane.showMessageDialog( <font color="#0000ff">null</font> , <font color="#A31515">"Invalid Copy Selection"</font> , <br> <font color="#A31515">"Invalid Copy Selection"</font> , JOptionPane.ERROR_MESSAGE); <br> <font color="#0000ff">return</font> ; <br> } <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; numrows; i++) { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; j &lt; numcols; j++) { <br> sbf.append(jTable1.getValueAt(rowsselected[i], <br> colsselected[j])); <br> <font color="#0000ff">if</font> (j &lt; numcols - 1) <br> sbf.append( <font color="#A31515">"\t"</font> ); <br> } <br> sbf.append( <font color="#A31515">"\n"</font> ); <br> } <br> stsel = <font color="#0000ff">new</font> StringSelection(sbf.toString()); <br> system = Toolkit.getDefaultToolkit().getSystemClipboard(); <br> system.setContents(stsel, stsel); <br> } <br> <font color="#0000ff">if</font> (e.getActionCommand().compareTo( <font color="#A31515">"Paste"</font> ) == 0) { <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"Trying to Paste"</font> ); <br> <font color="#0000ff">int</font> startRow = (jTable1.getSelectedRows())[0]; <br> <font color="#0000ff">int</font> startCol = (jTable1.getSelectedColumns())[0]; <br> <font color="#0000ff">try</font> { <br> <font color="#2B91AF">String</font> trstring = ( <font color="#2B91AF">String</font> ) (system.getContents( <font color="#0000ff">this</font> ) <br> .getTransferData(DataFlavor.stringFlavor)); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"String is:"</font> + trstring); <br> StringTokenizer st1 = <font color="#0000ff">new</font> StringTokenizer(trstring, <font color="#A31515">"\n"</font> ); <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; st1.hasMoreTokens(); i++) { <br> rowstring = st1.nextToken(); <br> StringTokenizer st2 = <font color="#0000ff">new</font> StringTokenizer(rowstring, <font color="#A31515">"\t"</font> ); <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; st2.hasMoreTokens(); j++) { <br> <font color="#0000ff">value</font> = ( <font color="#2B91AF">String</font> ) st2.nextToken(); <br> <font color="#0000ff">if</font> (startRow + i &lt; jTable1.getRowCount() <br> &amp;&amp; startCol + j &lt; jTable1.getColumnCount()) <br> jTable1.setValueAt( <font color="#0000ff">value</font> , startRow + i, startCol <br> + j); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"Putting "</font> + <font color="#0000ff">value</font> + <font color="#A31515">"at row="</font> <br> + startRow + i + <font color="#A31515">"column="</font> + startCol + j); <br> } <br> } <br> } <font color="#0000ff">catch</font> (Exception ex) { <br> ex.printStackTrace(); <br> } <br> } <br> } <br> }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code> <br><h1>  Simple application </h1><br>  Below is the code for a simple application Frame1.java, which, using ExcelAdapter, makes the JTable Excel-compatible. <br><br> <code><a href="http://source.virtser.net/"></a> <font color="black">import java.awt.*; <br> import javax.swing.*; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Frame1 extends Frame { <br> <br> BorderLayout borderLayout1 = <font color="#0000ff">new</font> BorderLayout(); <br> JTable jTable1; <br> Object[][] data = <font color="#0000ff">new</font> Object[4][4]; <br> Object header[] = { <font color="#A31515">"Jan"</font> , <font color="#A31515">"Feb"</font> , <font color="#A31515">"Mar"</font> , <font color="#A31515">"Apr"</font> }; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main( <font color="#2B91AF">String</font> args[]) { <br> Frame1 myframe = <font color="#0000ff">new</font> Frame1(); <br> myframe.setSize( <font color="#0000ff">new</font> Dimension(250, 250)); <br> myframe.setVisible( <font color="#0000ff">true</font> ); <br> } <br> <br> <font color="#0000ff">public</font> Frame1() { <br> super(); <br> <font color="#0000ff">try</font> { <br> jbInit(); <br> } <font color="#0000ff">catch</font> (Exception e) { <br> e.printStackTrace(); <br> } <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> jbInit() throws Exception { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; 4; i++) <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; j &lt; 4; j++) <br> data[i][j] = <font color="#0000ff">new</font> Integer(i * 10 + j); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"Header length="</font> + header[1]); <br> jTable1 = <font color="#0000ff">new</font> JTable(data, header); <br> jTable1.setCellSelectionEnabled( <font color="#0000ff">true</font> ); <br> <font color="#0000ff">this</font> .setTitle( <font color="#A31515">"Excel Lent JTABLE"</font> ); <br> jTable1.setBackground(Color.pink); <br> <font color="#0000ff">this</font> .setLayout(borderLayout1); <br> <font color="#0000ff">this</font> .setSize( <font color="#0000ff">new</font> Dimension(400, 300)); <br> <font color="#0000ff">this</font> .setBackground(Color.white); <br> <font color="#0000ff">this</font> .add(jTable1, BorderLayout.CENTER); <br> <font color="#008000">// This is the line that does all the magic!</font> <br> ExcelAdapter myAd = <font color="#0000ff">new</font> ExcelAdapter(jTable1); <br> } <br> }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code> <blockquote> <code><a href="http://source.virtser.net/"></a> <font color="black">import java.awt.*; <br> import javax.swing.*; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Frame1 extends Frame { <br> <br> BorderLayout borderLayout1 = <font color="#0000ff">new</font> BorderLayout(); <br> JTable jTable1; <br> Object[][] data = <font color="#0000ff">new</font> Object[4][4]; <br> Object header[] = { <font color="#A31515">"Jan"</font> , <font color="#A31515">"Feb"</font> , <font color="#A31515">"Mar"</font> , <font color="#A31515">"Apr"</font> }; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main( <font color="#2B91AF">String</font> args[]) { <br> Frame1 myframe = <font color="#0000ff">new</font> Frame1(); <br> myframe.setSize( <font color="#0000ff">new</font> Dimension(250, 250)); <br> myframe.setVisible( <font color="#0000ff">true</font> ); <br> } <br> <br> <font color="#0000ff">public</font> Frame1() { <br> super(); <br> <font color="#0000ff">try</font> { <br> jbInit(); <br> } <font color="#0000ff">catch</font> (Exception e) { <br> e.printStackTrace(); <br> } <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> jbInit() throws Exception { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; 4; i++) <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; j &lt; 4; j++) <br> data[i][j] = <font color="#0000ff">new</font> Integer(i * 10 + j); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"Header length="</font> + header[1]); <br> jTable1 = <font color="#0000ff">new</font> JTable(data, header); <br> jTable1.setCellSelectionEnabled( <font color="#0000ff">true</font> ); <br> <font color="#0000ff">this</font> .setTitle( <font color="#A31515">"Excel Lent JTABLE"</font> ); <br> jTable1.setBackground(Color.pink); <br> <font color="#0000ff">this</font> .setLayout(borderLayout1); <br> <font color="#0000ff">this</font> .setSize( <font color="#0000ff">new</font> Dimension(400, 300)); <br> <font color="#0000ff">this</font> .setBackground(Color.white); <br> <font color="#0000ff">this</font> .add(jTable1, BorderLayout.CENTER); <br> <font color="#008000">// This is the line that does all the magic!</font> <br> ExcelAdapter myAd = <font color="#0000ff">new</font> ExcelAdapter(jTable1); <br> } <br> }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code> </blockquote> <code><a href="http://source.virtser.net/"></a> <font color="black">import java.awt.*; <br> import javax.swing.*; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> Frame1 extends Frame { <br> <br> BorderLayout borderLayout1 = <font color="#0000ff">new</font> BorderLayout(); <br> JTable jTable1; <br> Object[][] data = <font color="#0000ff">new</font> Object[4][4]; <br> Object header[] = { <font color="#A31515">"Jan"</font> , <font color="#A31515">"Feb"</font> , <font color="#A31515">"Mar"</font> , <font color="#A31515">"Apr"</font> }; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> main( <font color="#2B91AF">String</font> args[]) { <br> Frame1 myframe = <font color="#0000ff">new</font> Frame1(); <br> myframe.setSize( <font color="#0000ff">new</font> Dimension(250, 250)); <br> myframe.setVisible( <font color="#0000ff">true</font> ); <br> } <br> <br> <font color="#0000ff">public</font> Frame1() { <br> super(); <br> <font color="#0000ff">try</font> { <br> jbInit(); <br> } <font color="#0000ff">catch</font> (Exception e) { <br> e.printStackTrace(); <br> } <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> jbInit() throws Exception { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; 4; i++) <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; j &lt; 4; j++) <br> data[i][j] = <font color="#0000ff">new</font> Integer(i * 10 + j); <br> System. <font color="#0000ff">out</font> .println( <font color="#A31515">"Header length="</font> + header[1]); <br> jTable1 = <font color="#0000ff">new</font> JTable(data, header); <br> jTable1.setCellSelectionEnabled( <font color="#0000ff">true</font> ); <br> <font color="#0000ff">this</font> .setTitle( <font color="#A31515">"Excel Lent JTABLE"</font> ); <br> jTable1.setBackground(Color.pink); <br> <font color="#0000ff">this</font> .setLayout(borderLayout1); <br> <font color="#0000ff">this</font> .setSize( <font color="#0000ff">new</font> Dimension(400, 300)); <br> <font color="#0000ff">this</font> .setBackground(Color.white); <br> <font color="#0000ff">this</font> .add(jTable1, BorderLayout.CENTER); <br> <font color="#008000">// This is the line that does all the magic!</font> <br> ExcelAdapter myAd = <font color="#0000ff">new</font> ExcelAdapter(jTable1); <br> } <br> }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code> <br><br><h1>  The format of the data placed in the Excel clipboard </h1><br>  The format of the data placed in the Excel clipboard is very simple.  Excel shares data that is on the same line using tabs, and data that is on different lines is divided into newline characters (usually the "\ n" character).  Thus, when you copy a set of cells, Excel puts a string formed according to the rules described above on the clipboard.  Using this information, you can implement Copy / Paste functionality in any application written in any language that allows you to work with the clipboard. <br><br><h1>  The authors </h1><br>  Ashok Banerjee and Jignesh Mehta work for Oracle Corporation. </div><p>Source: <a href="https://habr.com/ru/post/36612/">https://habr.com/ru/post/36612/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../36611/index.html">OpenProfile - in idea mode</a></li>
<li><a href="../366111/index.html">How not to miss the best sales</a></li>
<li><a href="../366113/index.html">Cognitive Technologies together with KAMAZ will develop an unmanned truck</a></li>
<li><a href="../366115/index.html">Samsung also wants to distribute the Internet through microsatellites</a></li>
<li><a href="../366119/index.html">Ross Ulbricht guilty of all counts</a></li>
<li><a href="../366123/index.html">Oracle is preparing to file a new claim to Google over Android</a></li>
<li><a href="../366125/index.html">Curiosity aerial view</a></li>
<li><a href="../366127/index.html">The court decided to charge a fee from the copyright owner for access to the personal data of the Internet service provider‚Äôs customers</a></li>
<li><a href="../366129/index.html">Gas giants can transform into potentially habitable planets</a></li>
<li><a href="../36613/index.html">gTest and</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>