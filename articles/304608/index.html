<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Making a cool single page application on basis.js - part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day to all. 
 I continue the fascinating series of articles about creating powerful Single Page Application on basis.js . 
 Last time, we philoso...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Making a cool single page application on basis.js - part 2</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/dbc/f72/e87/dbcf72e87382a87dbbb7afa53d4e291f.png" align="left">  Good day to all. <br>  I continue the fascinating series of articles about creating powerful Single Page Application on <a href="https://github.com/basisjs/basisjs">basis.js</a> . <br>  <a href="https://habrahabr.ru/post/304078/">Last time,</a> we philosophized a bit, as well as we got acquainted with the token - one of the most important things in basis.js. <br>  Today we will talk about working with data. <br><a name="habracut"></a><br>  Immediately make a small comment. <br>  This cycle is a set of <b>manuals</b> describing the solution of various tasks in the field of building SPA using the basis.js framework. <br>  Manuals do not set themselves the goal - to duplicate the <a href="">official documentation</a> , but show the practical application of what is described there. <br>  Yes, and the reader wants to see more specifics and practical examples, rather than a retelling of the documentation. <br>  Some places will still be described in more detail.  Basically, these are the moments that I consider necessary to describe in my own way. <br><br>  Let's imagine the situation: <br>  You make a page with an interactive list: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/f6a/0ec/4bc/f6a0ec4bc98e473cacccff149f1e416f.png"></div><br>  Opportunities: <br><ul><li>  add / delete entries </li><li>  saving records on the server </li><li>  After the page loads, the saved entries are automatically downloaded from the server and displayed. </li><li>  while loading and saving records, the <b>add</b> and <b>save</b> buttons must be locked </li><li>  while loading and saving records, the message "loading ..." is displayed </li><li>  if you delete all records, the message "no records" is displayed </li></ul><br>  Perhaps you have already begun to imagine how to solve this problem, write cycles, conditional statements, and add event handlers. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/303/16b/4d7/30316b4d70cf4203911722b0bdabd710.jpg"></div><br>  To prove this, you need to get acquainted with some conceptual things in basis.js. <br><br>  In basis.js there are several wrappers for different data types: <br>  <a href="">Value</a> - a wrapper for scalar values <br>  <a href="">DataObject</a> - object wrapper <br>  <a href="">Dataset</a> - a set of elements of type DataObject 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Value is</b> very similar to <b>Token</b> (which we talked about in the last article), but has richer functionality and a number of additional methods. <br>  <b>A DataObject</b> is an object where data changes can be monitored.  In addition, <b>DataObject</b> provides a <a href="">delegation</a> mechanism. <br>  <b>Dataset</b> provides convenient mechanisms for working with a collection of objects. <br><br>  Also, I suggest you <a href="">refer to the relevant section of the documentation</a> for a more detailed acquaintance with what data represents in basis.js.  And now we will examine another important thing from basis.js arsenal. <br><br><h4>  Value :: query </h4><br>  The static method <b>Value :: query</b> is one of the most powerful features of basis.js. <br>  This method allows you to get the actual value through the entire chain of specified properties, relative to the object to which <b>Value :: query</b> is applied. <br>  In order to understand how this works, let's write the following code: <br><div class="spoiler">  <b class="spoiler_title">index.js</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Value = basis.require(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).Value; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> DataObject = basis.require(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).Object; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Node = basis.require(<span class="hljs-string"><span class="hljs-string">'basis.ui'</span></span>).Node; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> group1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataObject({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">' 1'</span></span> } }); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> group2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataObject({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">' 2'</span></span> } }); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataObject({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">lastName</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">group</span></span>: group1 } }); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Node({ <span class="hljs-attr"><span class="hljs-attr">container</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelector(<span class="hljs-string"><span class="hljs-string">'.container'</span></span>), <span class="hljs-attr"><span class="hljs-attr">template</span></span>: resource(<span class="hljs-string"><span class="hljs-string">'./template.tmpl'</span></span>), <span class="hljs-attr"><span class="hljs-attr">binding</span></span>: { <span class="hljs-attr"><span class="hljs-attr">group</span></span>: Value.query(user, <span class="hljs-string"><span class="hljs-string">'data.group.data.name'</span></span>) }, <span class="hljs-attr"><span class="hljs-attr">action</span></span>: { setGroup1() { user.update({ <span class="hljs-attr"><span class="hljs-attr">group</span></span>: group1 }) }, setGroup2() { user.update({ <span class="hljs-attr"><span class="hljs-attr">group</span></span>: group2 }) } } });</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">template.tmpl</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>  : {group} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn-group"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-success"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">event-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"setGroup1"</span></span></span><span class="hljs-tag">&gt;</span></span> 1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-danger"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">event-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"setGroup2"</span></span></span><span class="hljs-tag">&gt;</span></span> 2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  There is a user.  The user has a group in which he is a member. <br>  Using the buttons on the page, we can change the user group. <br>  As a result of calling <b>Value :: query,</b> we will get a new <b>Value</b> , which will contain the current value in the specified sequence of properties relative to the specified object. <br>  In the example shown, we create a <b>group</b> binding, the value of which is the name of the group specified for the user. <br>  But we can switch the group.  How in this case to understand that the value is updated? <br>  In order to answer this question, you need to dig deeper into the basis.js bowels. <br>  In the prototype or instance of any basis.js class, you can specify the special propertyDescriptors <b>property</b> , with which you can ‚Äútell‚Äù the <b>Value :: query</b> method when it should update its value. <br>  Let's look at how the <b>DataObject</b> class is <b>described</b> in the source.js source code: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> DataObject = AbstractData.subclass({ <span class="hljs-attr"><span class="hljs-attr">propertyDescriptors</span></span>: { <span class="hljs-attr"><span class="hljs-attr">delegate</span></span>: <span class="hljs-string"><span class="hljs-string">'delegateChanged'</span></span>, <span class="hljs-attr"><span class="hljs-attr">target</span></span>: <span class="hljs-string"><span class="hljs-string">'targetChanged'</span></span>, <span class="hljs-attr"><span class="hljs-attr">root</span></span>: <span class="hljs-string"><span class="hljs-string">'rootChanged'</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: { <span class="hljs-attr"><span class="hljs-attr">nested</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">events</span></span>: <span class="hljs-string"><span class="hljs-string">'update'</span></span> } }, <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre><br>  From this it follows that, if you specify the <b>data</b> property in the query, then the <b>Value :: query</b> mechanism will update the value each time an <b>update</b> event from this object occurs (that is, when the object data is changed). <br><br>  And now let's take another look at the request we made: <br><pre> <code class="javascript hljs">Value.query(user, <span class="hljs-string"><span class="hljs-string">'data.group.data.name'</span></span>)</code> </pre><br>  The <b>Value :: query</b> mechanism will split the specified request into parts and try to go deep into the object by the specified properties, automatically subscribing to the events specified in the <b>propertyDescriptors of</b> each participant in the path. <br>  Thus, the result of calling <b>Value :: query</b> always "knows" about the current value for the specified path, relative to the specified object. <br><br><h4>  Data state </h4><br>  Let's return to our task. <br>  Items in our list are data that you can add, load, and save. <br>  Loading and saving are data synchronization operations. <br>  The basis.js contains the concept of states.  This means that each data type in basis.js has several states: <br><ul><li>  <b>UNDEFINED</b> - data status unknown (default state) </li><li>  <b>PROCESSING</b> - data in the process of loading / processing </li><li>  <b>READY</b> - data loaded / processed and ready to use. </li><li>  <b>ERROR</b> - an error occurred while loading / processing data </li><li>  <b>DEPRECATED</b> - data is out of date and must be synchronized again. </li></ul><br>  We can switch these states depending on what is happening now. <br>  Let's look at the sequence of actions on the example of downloading our list from the server: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/55d/e3f/87a/55de3f87aeb5451bbfe19989f3e9de21.png"></div><br><br>  You can come up with a lot of cases on the use of this mechanism.  Here are just some of them: <br><ul><li>  when the data set is in <b>PROCESSING</b> state - the <b>save</b> and <b>add</b> buttons must be locked </li><li>  when data set is in <b>ERROR</b> state - show error message </li></ul><br>  Loading and saving data are frequent operations in the SPA, so there is a separate <a href="">basis.net</a> module for them in <a href="">basis.js</a> . <br><br>  As mentioned earlier, it is necessary to switch data states depending on the synchronization step. <br>  There are two ways you can switch states: <br><ul><li>  manually using transport callbacks </li><li>  with <a href="">basis.net.action</a> </li></ul><br>  <b>basis.net.action is</b> designed precisely to create <b>stub</b> functions for data synchronization. <br>  The bottom line is that these procurement functions themselves know when and to what state they need to switch data. <br>  Let's create a component that will load data from the server and display them as a list of text fields, with the ability to edit and delete. <br>  Seems laborious?  By no means! <br><div class="spoiler">  <b class="spoiler_title">index.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Dataset = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).Dataset; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Node = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.ui'</span></span>).Node; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> action = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.net.action'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   let cities = new Dataset({ //   syncAction: action.create({ url: '/api/cities', success(response) { //    ,    JS-  DataObject      this.set(response.map(data =&gt; new DataObject({ data }))) } }) }); new Node({ container: document.querySelector('.container'), active: true, dataSource: cities, template: resource('./template/list.tmpl'), //    //          childClass: { template: resource('./template/item.tmpl'), binding: { name: 'data:' }, action: { input(e) { //       -     this.update({ name: e.sender.value }); }, onDelete() { //     "" -    //   ,       this.delegate.destroy(); } } } });</span></span></code> </pre><br></div></div><br>  That's all, now it remains only to sketch out the markup and to forward the necessary values ‚Äã‚Äãinto it: <br><div class="spoiler">  <b class="spoiler_title">list.tmpl</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b:style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./list.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my:list"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div{childNodesElement}</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">item.tmpl</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b:style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./item.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group my:item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form-control input-lg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{name}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">event-input</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group-btn"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-default btn-lg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">event-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"onDelete"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"glyphicon glyphicon-remove"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  CSS leave at your discretion.  But, as you probably already guessed, I use bootstrap. <br><br>  So, we created the <b>cities</b> dataset and configured it to synchronize with the server - we indicated that the elements of the set should be taken at <b>/ api / cities</b> . <br>  Data can be taken from any source, but I have already raised a server that gives a list of cities (it will be in the repository for the article). <br>  After receiving the data, they must be placed in a set. <br>  For this we use the <b>Dataset # set</b> method.  It takes an array of <b>DataObjects</b> to put in the set. <br>  But, as an answer from the server comes an array of ordinary JS-objects and before putting them into a set, you need to convert these objects into a <b>DataObject</b> . <br>  Record <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.set(response.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataObject({ data })))</code> </pre><br>  can be significantly reduced by using the auxiliary function ‚Äúbasis.data.wrap‚Äù: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> wrap = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).wrap; <span class="hljs-comment"><span class="hljs-comment">// ... this.set(wrap(response, true));</span></span></code> </pre><br>  <b>wrap</b> takes an array of ordinary objects as input, and outputs an array of the same objects, but wrapped in a <b>DataObject</b> . <br><br>  Also note that we added the <b>dataSource</b> property for our component and switched the <b>active</b> property to <b>true</b> . <br>  Based on what is <a href="">described in the documentation</a> , our set has <b>an active</b> subscriber, which means someone needs the contents of this set. <br>  Since the set is initially empty and its state is set to <b>UNDEFINED</b> , immediately after the registration of the active subscriber, the set begins synchronization according to the rules specified earlier.  The resulting set objects will be associated with the DOM nodes of the view. <br><br>  This behavior is already in <b>Node</b> .  As soon as a set appears in the <b>dataSource</b> property, <b>Node</b> starts tracking changes to the specified set. <br>  For each element of the set, it creates a child view (component) that is associated with the set by delegation. <br>  If the set changes the composition of elements, then the visual representation also changes. <br>  So basis.js saves us from cycles and other logic in the templates, while ensuring synchronization of data with their visual presentation. <br><br>  Data binding implies that the elements of a set and their visual presentation begin to share data using <a href="">delegation</a> . <br>  This simplifies the mechanism for updating set elements. <br><br>  Now we will display the words "loading ..." during the synchronization of the set. <br>  To do this, we will monitor the status of the set and display the inscription "loading ..." only when the set is in the <b>PROCESSING</b> state <br><div class="spoiler">  <b class="spoiler_title">index.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> STATE = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).STATE; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Value = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).Value; <span class="hljs-comment"><span class="hljs-comment">// .... new Node({ // ... binding: { loading: Value.query('childNodesState').as(state =&gt; state == STATE.PROCESSING) } // ... });</span></span></code> </pre><br></div></div><br>  Use the new binding in the template: <br><div class="spoiler">  <b class="spoiler_title">list.tmpl</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b:style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./list.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my:list"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alert alert-info"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">b:show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{loading}"</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div{childNodesElement}</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Now, during the synchronization of the set, the inscription "loading ..." will be displayed <br><br>  In the example shown, we create a <b>loading</b> link which should indicate whether the synchronization process is in progress or not.  Its value will depend on the state of the data set ‚Äî <b>true</b> if the set is in the <b>PROCESSING</b> state and <b>false</b> otherwise. <br>  If a <b>dataSource</b> is specified for the <b>Node</b> , then the <b>Node # childNodesState property</b> will duplicate the state of the specified data source. <br>  More details <a href="">can be read here</a> . <br>  By the way, as can be seen from the example, if you specify <b>Value :: query</b> as a binding, but do not specify the object relative to which the specified path is built, then this object becomes the <b>Node</b> , in which <b>Value :: query</b> is located. <br>  And even if <b>Node‚Äôs</b> data source changes, then the <b>loading loading</b> will still keep the current value based on the <b>currently</b> installed data source.  This fact once again shows the benefits of using <b>Value :: query</b> . <br><br>  For reference: <br><pre> <code class="javascript hljs">Value.query(<span class="hljs-string"><span class="hljs-string">'childNodesState'</span></span>)</code> </pre><br>  could be replaced by <br><pre> <code class="javascript hljs">Value.query(<span class="hljs-string"><span class="hljs-string">'dataSource.state'</span></span>)</code> </pre><br>  The result would be the same.  But in the case of <b>childNodesState,</b> we completely abstract away from the data source and rely on the basis.js mechanisms. <br><br>  Fine!  It remains to realize a few points. <br>  If there are no records in the set, then we will show the corresponding message. <br>  But first, let's think - in what case should this message be displayed? <br>  At a minimum, when the set has no elements (the <b>itemCount</b> property of the set is zero). <br>  Let's create the appropriate binding: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Node({ <span class="hljs-comment"><span class="hljs-comment">// ... binding: { // ... hasItems: Value.query('dataSource.itemCount'), // ... }, // ... };</span></span></code> </pre><br>  But we have a period of time when we still do not know whether there are elements in the list or not.  For example, when data is downloaded from the server.  While the data is being loaded, we cannot say for sure whether something will be there or not.  Therefore, we do not like the option in which we rely on only one value. <br>  A more competent condition for displaying a message is: <i>show a message if synchronization is complete <b>and the</b> number of elements is zero</i> . <br>  That is, the value of the binding will depend on two <b>Value</b> . <br>  In basis.js such tasks are usually solved with the help of <b>Expression</b> . <br>  <b>Expression</b> accepts <a href="">Token-like</a> objects as arguments and a function that will be executed when the value of any of the arguments passed has changed. <br>  It looks like this: <br><div class="spoiler">  <b class="spoiler_title">index.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Expression = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data.value'</span></span>).Expression; <span class="hljs-comment"><span class="hljs-comment">// ... new Node({ // ... binding: { // ... empty: node =&gt; new Expression( Value.query(node, 'childNodesState'), Value.query(node, 'dataSource.itemCount'), (state, itemCount) =&gt; !itemCount &amp;&amp; (state == STATE.READY || state == STATE.ERROR) ), // ... }, // ... };</span></span></code> </pre><br></div></div><br>  Thus, in <b>empty</b> binding will be <b>true</b> as long as there are no elements in the set and the set itself is not in synchronization state.  Otherwise, <b>empty</b> will be <b>false</b> . <br>  Now we add the created binding to the markup: <br><div class="spoiler">  <b class="spoiler_title">list.tmpl</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b:style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./list.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my:list"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alert alert-info"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">b:show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{loading}"</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alert alert-warning"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">b:show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{empty}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div{childNodesElement}</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Now, if you delete all items from the list or from the server comes an empty list, then the screen will display a message - "the list is empty." <br><br>  It remains for us to implement the last opportunity from our list - adding and saving list items. <br>  Here we will use the already familiar things. <br>  First, add a couple of buttons to the markup: <b>save</b> and <b>add</b> .  Thus, the final layout will take the following form: <br><div class="spoiler">  <b class="spoiler_title">list.tmpl</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b:style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./list.css"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"navbar navbar-default navbar-fixed-top"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my:buttons btn-group"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-success"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">event-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"add"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{disabled}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-danger"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">event-click</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"save"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{disabled}"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"my:list"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alert alert-info"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">b:show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{loading}"</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"alert alert-warning"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">b:show</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{empty}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div{childNodesElement}</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  As you can see from the example, the buttons should be disabled when the binding is set to <b>true</b> . <br>  Now we will process clicks on the buttons, we will implement the addition and saving of elements, and finally, we will look at the final version of the code: <br><div class="spoiler">  <b class="spoiler_title">index.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Value = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).Value; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Expression = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data.value'</span></span>).Expression; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Dataset = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).Dataset; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> DataObject = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).Object; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> STATE = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).STATE; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> wrap = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.data'</span></span>).wrap; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Node = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.ui'</span></span>).Node; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> action = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'basis.net.action'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cities = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dataset({ <span class="hljs-attr"><span class="hljs-attr">syncAction</span></span>: action.create({ <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'/api/cities'</span></span>, success(response) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.set(wrap(response, <span class="hljs-literal"><span class="hljs-literal">true</span></span>)) } }), <span class="hljs-comment"><span class="hljs-comment">//  action    save: action.create({ url: '/api/cities', method: 'post', contentType: 'application/json', encoding: 'utf8', //  ,   ""   body() { return { //       // this    ,       save items: this.getValues('data') }; } }) }); new Node({ container: document.querySelector('.container'), active: true, dataSource: cities, // Node#disabled -    ,      binding    ,   disabled: Value.query('childNodesState').as(state =&gt; state != STATE.READY), template: resource('./template/list.tmpl'), binding: { loading: Value.query('childNodesState').as(state =&gt; state == STATE.PROCESSING), empty: node =&gt; new Expression( Value.query(node, 'childNodesState'), Value.query(node, 'dataSource.itemCount'), (state, itemCount) =&gt; !itemCount &amp;&amp; (state == STATE.READY || state == STATE.ERROR) ) }, action: { //      add() { cities.add(new DataObject()) }, save() { cities.save() } }, childClass: { template: resource('./template/item.tmpl'), binding: { name: 'data:' }, action: { input(e) { this.update({ name: e.sender.value }) }, onDelete() { this.delegate.destroy() } } } });</span></span></code> </pre><br></div></div><br>  The <b>save</b> method is created by analogy with <b>syncAction</b> .  Called <b>save</b> when you click <b>save</b> . <br>  Adding elements to the list is made as simple as possible: when you click on <b>add, it is</b> enough just to add another object to the set, and the internal linking mechanisms will arrange everything so that the new element of the set will be displayed in the visual representation accordingly. <br><br>  As mentioned above, such problems are solved in basis.js without involving cycles and conditional operators.  Everything is implemented on the basis of mechanisms.js. <br>  Of course, inside basis.js there are both cycles and conditional operators, but it is important that basis.js allows us to reduce their use to a minimum.  In the client code and especially in the templates. <br><br>  That's all.  I hope it was interesting and informative. <br>  Until the next manual! <br><br>  Many thanks to <a href="https://habrahabr.ru/users/lahmatiy/" class="user_link">lahmatiy</a> for invaluable advice;) <br><br>  Some useful links: <br><ul><li>  <a href="https://github.com/smelukov/habrBasis2">Repository with code from the article</a> </li><li>  <a href="https://github.com/basisjs/articles">Documentation basis.js</a> </li><li>  <a href="https://github.com/basisjs/basisjs">Source code basis.js</a> </li></ul><br><br>  <b>UPD:</b> launched <a href="https://gitter.im/basisjs/basisjs">gitter chat</a> on basis.js.  Add, ask questions. </div><p>Source: <a href="https://habr.com/ru/post/304608/">https://habr.com/ru/post/304608/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304598/index.html">Design stages, mistakes and advantages</a></li>
<li><a href="../304600/index.html">We get a domain name, DNS and SSL certificate free then</a></li>
<li><a href="../304602/index.html">We are developing a real-time fulltext-search system for error-logs based on ClickHouse from Yandex</a></li>
<li><a href="../304604/index.html">Spryker performance and scalability concept</a></li>
<li><a href="../304606/index.html">ORM in cis magento</a></li>
<li><a href="../304612/index.html">Seminars on introducing everything: from verilog and digital logic to micro-architecture of embedded processors and RTOS</a></li>
<li><a href="../304616/index.html">A polynomial algorithm for a combinatorial problem (P = NP?)</a></li>
<li><a href="../304618/index.html">OctoberCMS Stable Release</a></li>
<li><a href="../304620/index.html">The digest of interesting materials for the mobile developer # 160 (June 27-July 3)</a></li>
<li><a href="../304622/index.html">Refactoring with Cleisley Composition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>