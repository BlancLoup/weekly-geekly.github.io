<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Memory and tasks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings. 
 Immediately I warn you that the post is full of personal considerations of the author, which may be erroneous, and this topic is extensiv...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Memory and tasks</h1><div class="post__text post__text-html js-mediator-article">  Greetings. <br>  Immediately I warn you that the post is full of personal considerations of the author, which may be erroneous, and this topic is extensive and interesting, so the discussion on the topic in the comments is welcome. <br>  Only now I realized that, firstly, I did not tell a lot that it would be useful to know before writing code.  In addition, there are much better ways to implement multitasking than I mentioned in the last issue. <br>  I will also try to follow numerous tips and systematize the content of the articles. <br><a name="habracut"></a><br>  In spite of the fact that this issue is fiction of purest water, let's make a plan. <br>  1) Different thoughts on the implementation of multitasking. <br>  2) Pros and cons for every way. <br>  3) Decide how to make your bike. <br><br>  Let's get started <br>  1) When I first began to think about how to implement the subject better, a sacred, straightforward thought crept in on me.  Here we think about the area where user processes are executed (with ring0, everything is easier).  Let's allocate them a place starting at 16 megabytes.  The rest is their area, until the very end of the RAM.  Now the question arises: how can we control and ensure the process with all necessary.  Sacred thought was as follows, you have already heard it: divide RAM into N pieces (not necessarily equal), then organize the queues of tasks and to them, we will take measurements on the 'weight' of programs, etc.  You probably already want to say: ‚ÄúThe author, perhaps, will issue a battle cry and you will rush to rob villages?  Barbarously it all. ‚Äù.  I agree.  Such a model is not viable, non-expandable and terribly ineffective.  A well-known comrade Tanenbaum wrote about this in his remarkable work.  With this implementation of multitasking, the following problems arise: small programs will be given less time, perhaps starvation.  Due to the fact that the sizes of all programs are different, and the framework is static, unequal competition will arise.  In principle, this can be solved by strict control, but this method with static sections brings a headache. <br><br>  2) Then, after some thought, another thought came to mind: virtual memory. <br>  Let's remember about the page organization of memory (bless Cthulhu). <br>  If we do not use static areas for tasks, then a number of other problems arise: <br>  1) How to follow the growing and processes? <br>  2) Do the processes cover each other? <br>  3) Does physical memory need a piece of contiguous space for the process? <br>  Let's deal with them. <br>  1) In order not to miss the processes, it is enough to implement a memory manager (manager), which will 'distribute rations' in the form of free pages.  In addition, we give each process its own descriptors, which will cut the long hands of the process. <br>  2) This is another dispatcher's duty to carefully monitor that memory is not shared by N processes. <br>  3) Honestly, at first I was mistaken myself, <b>WHERE the</b> code is executed in physical or virtual spaces (I know, it sounds strange).  The answer is in the virtual space.  Just imagine the worlds as in the Matrix: both are connected, and both are real.  So do not take the virtual space as meaningless and just expanding the maximum amount of addressable RAM. <br>  In order to better understand, consider an example.  Here, for example, there is a process whose particles are scattered throughout physical memory.  But we can assign physical addresses to pages with certain virtual addresses, is it true?  That is, the virtual address will again go on a journey through directories and pages, and in the end there will be quite a necessary and valid address in physical memory.  It turns out that for the process the virtual addresses will be sequential, but in fact its code can lie anywhere in physical memory anywhere. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The method described above is used now in many operating systems, so it is quite stable, flexible.  The difficulty will be only in the competent writing of high-quality code. <br><br>  Now they have quietly approached the topic of the memory manager.  In general, it is believed that this is the most difficult part in the project.  I even heard such a joke: <br>  ‚ÄúWhy are osdev projects stall? <br>  1) Very busy at work; <br>  2) Married; <br>  3) I tried to write a memory manager;  " <br><br>  But let's not be scared.  We will try to cope.  He will have to "rule fairly" in order for an idyll and a "golden age" to reign in the RAM: <br>  1) Follow the pages: free them in time, remap. <br>  2) Search for new free pages on request (#PF, most often). <br>  There are several algorithms for this, which are also described by Comrade Tanenbaum.  Consider them later. <br>  3) If there is not enough physical memory, then use a swap.  In this scenario, you will need to find less used pages, drive them into a swap.  Then back.  In short, the manager will have to sweat a lot in this case. <br><br>  Now let's describe in words how the creation of a new task will take place (we take into account that this is not yet an effective version): <br>  1) Check whether there is even room for another task. <br>  2) Download the program image into memory at a specific address. <br>  3) Describe code, stack, and data descriptors for a task. <br>  4) It would be nice if you created your own catalog of pages for the task with all the consequences. <br>  5) Transfer control program code. <br>  6) If #PF occurs, we look at what task was performed, when referring to what address it was painted, we appeal to the memory manager with pleas and, if we are lucky, we get another page of memory, and go back to the code. <br><br>  In the next issue we will look at how to write the notorious memory manager, because without it you cannot get anywhere. <br><br>  What to read: <br>  1) <b>Andrew Tanenbaum</b> : "Modern Operating Systems."  (A very useful book). <br>  2) <b>Intel System Programming Manuals</b> (without them nowhere). </div><p>Source: <a href="https://habr.com/ru/post/122171/">https://habr.com/ru/post/122171/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122162/index.html">The concept of simple Load-balancer'a / Failover'a IP services</a></li>
<li><a href="../122163/index.html">Cambridge University Effect</a></li>
<li><a href="../122167/index.html">Proprietary provider modems 3/3 (upd)</a></li>
<li><a href="../122168/index.html">Using Amazon Web Services with the wikipaintings.org example</a></li>
<li><a href="../122170/index.html">About taxi in Moscow</a></li>
<li><a href="../122172/index.html">Home, Catalog and Lists in the online store</a></li>
<li><a href="../122174/index.html">The main thing is the tail! or opt-out 2</a></li>
<li><a href="../122175/index.html">The first coin with a QR code</a></li>
<li><a href="../122176/index.html">100,000 NektoMe users</a></li>
<li><a href="../122178/index.html">AS3 Vector in AMF3: we lift the curtain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>