<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Malicious software is used for cyber espionage over users in Central and Eastern Europe.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last year, ESET specialists were able to detect and analyze several instances of malicious software that were used in cyber espionage operations for u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Malicious software is used for cyber espionage over users in Central and Eastern Europe.</h1><div class="post__text post__text-html js-mediator-article">  Last year, ESET specialists were able to detect and analyze several instances of malicious software that were used in cyber espionage operations for users.  This malware was named SBDH and uses in its work powerful data filters, various methods of interaction with its operators, as well as an interesting technique for ensuring its survival in the system.  The malicious program was aimed at obtaining government and government agencies that are interesting for the attacking data of computers, which are mainly focused on economic growth and cooperation in Central and Eastern Europe.  Information about the SBDH will also be presented by researchers ESET Tom√°≈° Gardo≈à and Robert Lipovsk√Ω at <a href="http://cccc-2016.com/">the</a> Copenhagen Cybercrime Conference 2016 in Copenhagen. <br><br><img src="https://habrastorage.org/files/497/690/b06/497690b06d4d474bb9c49651b9c87a18.jpeg"><br><br>  SBDH consists of a loader and other modules that are used by operators.  Compact loader distributed by attackers using phishing emails.  Such messages contained an attachment, which contained a file with a double extension in the name.  Since Windows hides the extension of known files, a fake extension was displayed to the user, which the attackers expected.  In order to further convince the potential victim of its legitimacy, the icons of the standard Microsoft applications or the Word document were selected for the executable files. <br><a name="habracut"></a><br><img src="https://habrastorage.org/files/e94/4f8/c02/e944f8c021e64a94b6e0ac4af53d5fea.png"><br>  Fig.  Malefactors mask the executable file of the loader under legitimate Microsoft applications. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/840/11b/dd8/84011bdd83ed4d7780da18d3eae3209c.png"><br>  Fig.  Malefactors mask the executable file of the loader under the Word document. <br><br>  After successful execution in the system, the malware accesses the remote server to load into the system its two main components: the backdoor and the data thief.  The combination of these modules allows an attacker not only to gain complete control over the compromised computer, but also provides him with advanced methods to steal data from him.  Thanks to the powerful filter system, the operator can indicate in detail what specific data should be stolen.  The filter includes information about the file extension, the date it was created, its size, and other characteristics.  The service data of the filters can be modified using the configuration files of the malicious program. <br><br><img src="https://habrastorage.org/files/240/bea/701/240bea701ec74eb8979649ec6bbef437.png"><br>  Fig.  Malware configuration file. <br><br>  Since all components of this cybercriminal tool require connection to the C &amp; C server manager, the performance of the SBDH depends to a great extent on the ability to work with the network connection.  For this, the authors implemented several methods of interaction in the C &amp; C server in the SBDH.  The first is to use a simple HTTP protocol.  If it is unavailable, the malware tries to use the SMTP protocol and a free external gateway to send emails.  The latter method consists in the possibility of using Microsoft Outlook Express and sending generated email messages through it in a special way.  Such emails are sent under the account of the current user, allowing the malicious program to bypass security restrictions (it is assumed that the current user has the right to send and receive emails).  Messages sent by the malware are then placed in the outgoing messages directory in order to exclude them from showing increased attention. <br><br>  In order to detect incoming connections, that is, the attempts of operators to contact the bot, the malicious program searches for emails in the user's mailbox.  Such malicious emails have a specific topic name.  In the case of SBDH detection of such letters, they are analyzed in order to extract from there the sent commands of operators.  After this operation, the bot modifies the subject field in the email so that it does not attract its attention in the future.  However, this latter feature was used by SBDH until 2006, when Outlook Express was replaced by another new application called Windows Mail.  After that, the authors focused more on improving the method of interacting with the C &amp; C server via HTTP and began to mask this process with the use of fake .JPG and .GIF image files for sending the necessary data. <br><br><img src="https://habrastorage.org/files/f5e/8d2/321/f5e8d2321185422aa894e7a8828d51e7.png"><br>  Fig.  Masking the process of interaction with the managing server. <br><br>  In the event that the C &amp; C server‚Äôs manager is unavailable, the backdoor component will resort to using a hard-coded URL contained in it that points to a fake image file (located on a free resource), which in turn contains the address of the alternative C &amp; C server. <br><br><img src="https://habrastorage.org/files/4c6/a08/db3/4c6a08db3fc744deb601f554241b2727.png"><br>  Fig.  Image with the URL of the alternative C &amp; C server. <br><br>  Some of the SBDH samples analyzed by us contained an interesting implementation of the method for ensuring their survival in the system.  The malicious program modified the Word document handler used by the system in such a way that when trying to open or edit a Word file in Explorer, the malware code was executed. <br><br><img src="https://habrastorage.org/files/9c5/05b/b63/9c505bb63bbe4d36af3370495dc8cac0.png"><br>  Fig.  The B64SBDH identifier in the body of the malware. <br><br>  It should be noted that the name SBDH itself is a sequence of characters that was part of the compilation path in the loader file.  Another interesting feature is the fact that the string ‚ÄúB64SBDH‚Äù is used to load the other two components of the malicious program from the C &amp; C server, which is triggered. <br><br>  <b>Conclusion</b> <br><br>  The cybercriminals behind the SBDH use the same methods as those behind the <a href="https://habrahabr.ru/company/eset/blog/255325/">Buhtrap operations</a> .  This spy tool proves the fact that even modern threats are spread using simple methods such as email attachments.  However, the risks of compromising such malware in organizations can be significantly reduced by instructing employees and using a reliable multi-level security solution. <br><br>  Identifiers of malicious samples SBDH (hashes): <br><br>  1345b6189441cd1ed9036ef098adf12746ecf7cb <br>  15b956feee0fa42f89c67ca568a182c348e20ead <br>  f2a1e4b58c9449776bd69f62a8f2ba7a72580da2 <br>  7f32cae8d6821fd50de571c40a8342acaf858541 <br>  5DDBDD3CF632F7325D6C261BCC516627D772381A <br>  4B94E8A10C5BCA43797283ECD24DF24421E411D2 <br>  D2E9EB26F3212D96E341E4CBA7483EF46DF8A1BE <br>  09C56B14DB3785033C8FDEC41F7EA9497350EDAE </div><p>Source: <a href="https://habr.com/ru/post/304786/">https://habr.com/ru/post/304786/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304776/index.html">The relevance of the PaaS model for electronic document management systems</a></li>
<li><a href="../304778/index.html">Platypus and Packages. Create and install programs on macOS</a></li>
<li><a href="../304780/index.html">Repost-modern: a selection of materials on how to generate high-quality content</a></li>
<li><a href="../304782/index.html">Work with Bluetooth LE from Java applications</a></li>
<li><a href="../304784/index.html">Typing the names of organizations</a></li>
<li><a href="../304788/index.html">A call from the browser: a tool for business?</a></li>
<li><a href="../304790/index.html">Error in PM error message is ineffective</a></li>
<li><a href="../304794/index.html">First look at the new Cisco Firepower Threat Defense software (UPD 02.09.16)</a></li>
<li><a href="../304798/index.html">Everything you wanted to know about RAID controllers, but it was too lazy to look</a></li>
<li><a href="../304800/index.html">Bloom filter for web developers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>