<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>WiFi Pineapple Mark V: black box for wireless interception</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The information security specialist, in particular the pentester, is faced with the task of effectively solving the puzzles to find and exploit the vu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>WiFi Pineapple Mark V: black box for wireless interception</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/c71/853/dad/c71853dad0c6412788e940146a86754e.jpg"><br><br>  The information security specialist, in particular the pentester, is faced with the task of effectively solving the puzzles to find and exploit the vulnerabilities of the studied systems.  An important element of any work on testing the security of the customer's infrastructure is the verification of wireless networks.  Specialized tools will help to significantly improve the effectiveness of such a check, I will tell you about the fifth iteration of one of which today. <br><br><h4>  Device description </h4><br>  <b>WiFi Pineapple</b> is a product of enterprising Americans who ordered a Wi-Fi router with two wireless interfaces and one wired from the Chinese, wrote OpenWRT-based firmware for it and stuffed it with utilities for hacking / intercepting and analyzing traffic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The device has 3 network interfaces (2 wireless with the ability to work in monitor mode and 1 wired), 1 USB port for a USB flash drive \ 3-4G modem \ GPS tracker and a slot for microSD cards. <br><br>  Also on the device case there is a set of toggle switches, the combination of which allows launching the device with a package of preassigned commands to the selected combination of commands, which reduces the presetting time if the task is typical and regular. <a name="habracut"></a><br><br><h4>  Opportunities </h4><br>  The range of capabilities of the device is impressive, it has almost everything necessary for auditing wireless networks and intercepting traffic. <br><br>  The main feature among other important tools is the forced connection to the router of wireless clients: a bunch of utilities <b>Karma</b> and <b>PineAP</b> .  It acts as follows: <br><br><img src="https://habrastorage.org/files/ea6/515/851/ea65158510614a0ea62560e53b2f3cb2.png"><br><br>  All wireless devices that are not currently connected to the WiFi network are actively trying to do this by sending inquiries in search of familiar access points to which they previously connected (open the list of networks on your smartphone - surely it is quite long).  Karma responds to these requests, pretending to be the access point the client is looking for.  This applies only to requests for open networks that are not protected by WEP / WPA / WPA2 encryption, but as a rule, almost everyone on the list has at least one public hotspot to which he has ever connected in a cafe or other public place.  At the moment, Karma's performance has decreased, as new devices and OS versions tend to protect users from this vulnerability and PineAP, which operates on the opposite principle, does not wait for the request, instead bombards the client with connection requests using the SSID list. which can be maintained both manually and collected by the utility Autoharvest.  The combination of these two methods gives a very high probability of hooking the wireless client to the access point. <br><br><img src="https://habrastorage.org/files/fb9/5c6/b38/fb95c6b382664b209a872e53cf144813.png"><br><br>  The second king of our ‚Äúpineapple‚Äù is <b>SSLStrip</b> , which despite the gradual loss of relevance is still the most important tool for data interception.  This MITM module detects the client's attempt to connect via an HTTPS protocol and imposes an HTTP connection on it, in turn establishing an HTTPS connection to the destination.  Inattentive client noticing nothing enters their credentials and they immediately go to the log. <br><br><img src="https://habrastorage.org/files/60a/f1a/7b9/60af1a7b9a214fc6adc5efc28d6b6905.png"><br><br>  <b>WiFi Pineapple is</b> built according to the modular principle - only the basic elements are initially installed in it, and the remaining components can be downloaded directly from the developers' site from the developers site.  Among them are such wonderful tools as ethercap, tcpdump, nmap, the deauth tool for silencing other access points (forcibly sending disconnect commands to clients of other people's access points), dnsspoof, urlsnarf, reaver \ bully hacking tools for choosing, and other useful tools .  I want to note that it will not be possible to start everything at once - the piece of iron is rather weak and many services cannot be maintained at the same time, leaving for reboot. <br><br><img src="https://habrastorage.org/files/c86/874/e75/c86874e756f34d5cb82f0f7b93ae2ec7.png"><br><br>  The device is controlled via the web interface, although it is also possible remotely via SSH (for remote access to the system installed at the target point, a reverse SSH tunnel is automatically set up when turned on).  The web interface is generally good, but it works imperfectly and sometimes too fast and active work with it leads to a device reboot, since all the necessary services can be set to autostart.  All components can be updated directly from the interface, new firmware is also installed on the fly. <br><br><h4>  Contents of delivery </h4><br>  I got into the hands of the Elite version, which, in addition to the router itself, includes a shockproof waterproof case and a 15000 mAh battery, which in total gives an all-weather outdoor system with an autonomy of 12 hours of continuous operation, also comes with a quick setup booklet, charger device, antenna extensions for carrying out the horns for the case body and patch cord. <br><br><img src="https://habrastorage.org/files/575/1d5/8ae/5751d58aee414c628df62b2e74d64567.jpg"><br><img src="https://habrastorage.org/files/0bc/454/4d3/0bc4544d328e40b0a959ae6b3e1c39c9.jpg"><br><br><h4>  Primary setup </h4><br>  No matter how simple the setting in the booklet and the numerous how-that looked, we cannot do without a file processing. <br><br><h5>  a) Mobile Internet </h5><br>  If we make a mobile complex, then we cannot do without autonomous Internet access, that is, we need USB-modem, but out of the box the device is very bad friends with them and as it is, I simply did not work with my Huawei E3372 (Megaphone M150-2) .  The modem had to be unlocked, flashed into a HILINK firmware and an extended web interface (it turns it into a standalone USB router, seen by the system as an Eth1 interface and not requiring any additional configuration on the host).  Detailed instructions can be found on w3bsit3-dns.com in the topic dedicated to this modem.  The funny thing is that after unlocking and flashing the speed of access to the Internet has grown an incredible 3 times, approaching 50 megabits per second.  Thus, after all the witchcraft with the modem, we get another Eth1 network interface in the depths of our ‚Äúpineapple‚Äù, through which we allow traffic by changing the / etc / config / network and / etc / config / dhcp parameters.  It is important not to forget to turn off the DHCP server on the web-interface of the modem itself (in my case it lived at 192.168.8.1), otherwise all clients will go directly to the Internet, bypassing all your traps. <br><br><h5>  b) AutoSSH remote access </h5><br>  We also need remote access to the device to control and read logs without waiting for the device to return.  To do this, you will have to raise OpenSSH server with Gateway Forwarding enabled, and then everything depends on luck.  For example, in my case, the SSH server did not work on the standard port, so connecting to it using the pineapple interface failed, I had to do everything manually. <br>  The order is as follows: <br><ul><li>  1. From the ‚Äúpineapple‚Äù web interface, generate the public key </li><li>  2. Go to ‚Äúpineapple‚Äù via ssh and go with it via ssh to our ssh server with a password, this action will add our server to known_hosts </li><li>  3. from ‚Äúpineapple‚Äù via scp send authorized_keys to our server. </li><li>  4. Through the web interface, run autossh on "pineapple" </li><li>  5. We try to connect from the server to localhost -p &lt;reverse port set on pineapple&gt; </li></ul><br>  If everything is done correctly, we will get a permanent console access to our device. <br><br><h5>  c) Logs </h5><br>  The modules can be installed both in the internal memory of the device and on the SD card, however, some modules may not behave properly when installed on a card, for example, the dearly loved SSLStrip.  The internal memory of the device is very small, and the modules with intercepted logs are stored in their folders.  Therefore, we need to make some folder (for example, banal, logs) in the root of the SD card (/ sd /) and link it to the module logs folder in / pineapple / components / infusions / sslstrip / include / logs <br><br><h4>  findings </h4><br>  WiFi Pineapple Mark V has proven to be a useful tool in the Pentester‚Äôs household to help find the entry point in situations where it seems that the client‚Äôs infrastructure is flawless and the staff are extremely responsible and technically savvy.  The device is not without flaws - a weak 400MHz processor can hardly cope with the tasks assigned to the device and often goes into reboot when trying to use several modules at once, on the other hand, by understanding its limits, you can distribute tasks in such a way as to optimally use the ‚Äúpineapple‚Äù without work. <br><br>  The technology of capturing Karma and PineAP wireless clients is not perfect, no one promises that your device will immediately connect to the ‚Äúpineapple‚Äù being within its range, but the likelihood of such an outcome for devices on all popular OS types is extremely high.  SSLStrip is gradually dying off, there‚Äôs little use to it when capturing mobile device traffic, because most applications are authorized using the OAuth 2.0 method and there‚Äôs not much use from intercepted tokens as from pure passwords.  However, popular social networking messengers still transmit data in clear text, and access to services via browsers is still done using a login / password combination, which makes the tool still effective in intercepting data. <br><br><img src="https://habrastorage.org/files/e01/a63/eed/e01a63eed3044f2382d15386e38b7549.png"><br><br>  And do not forget about other features of the "pineapple", such as hacking WPS, DNS substitution and withdrawal of clients on fake pages, the capture of cookies and much more.  The device is uniquely interesting and worth the money, and for those who fear hooligans with such devices, I advise you to clean your list of known wireless networks from open networks and not sit down on questionable access points. </div><p>Source: <a href="https://habr.com/ru/post/245717/">https://habr.com/ru/post/245717/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245697/index.html">Big update for smartwatch 3</a></li>
<li><a href="../245699/index.html">How do we get free software without using torrent trackers</a></li>
<li><a href="../245707/index.html">How will the marketing technologies change in 2015?</a></li>
<li><a href="../245709/index.html">From math to generalized programming</a></li>
<li><a href="../245713/index.html">Hell Visualization 1.1 - Book 1: Overview</a></li>
<li><a href="../245719/index.html">Obfuscation of lines at compile time</a></li>
<li><a href="../245721/index.html">If the customer is a revision</a></li>
<li><a href="../245727/index.html">Concurrency structure in .net. ConcurrentDictionary from the inside</a></li>
<li><a href="../245729/index.html">CPU vs GPU. Distance field</a></li>
<li><a href="../245731/index.html">Expressive JavaScript: Forms and Form Fields</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>