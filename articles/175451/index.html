<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>GPS monitoring auto or homework for the evening</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! Once, thinking about the safety of my car, I fumbled a lot of resources with information about car anti-theft systems, including GPS. But every...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>GPS monitoring auto or homework for the evening</h1><div class="post__text post__text-html js-mediator-article">  Hello!  Once, thinking about the safety of my car, I fumbled a lot of resources with information about car anti-theft systems, including GPS.  But everything was either not what was needed, or rather expensive, and I did not like the accompanying services, and there is a paranoia in me to admit.  In general, the main scaring reason for me was to share information with someone about their location.  As a result, ordinary alarm was bought with auto start and feedback, but now it is a little about something else. <br><br>  All the same thoughts about the preservation of information about the position of the car I spun in my head, and I just wanted to find something interesting to take at leisure.  On these thoughts, I decided to buy the so-called.  personal GPS tracker.  Especially I didn‚Äôt look at the models, everything was about the same, but not many of the candidates that had gone over had a very important feature such as setting up their own server.  As a result, my choice fell on the personal GPS tracker of the Chinese company Xexun - Xexun TK102-2.  After a few more hours of finding out how everything is set up and heaps of various manuals, I decided that I needed to buy and see what it was.  Who is interested in information about the tracker and about writing your own "server" for the tracker, please tackle. <br><a name="habracut"></a><br><br>  On the forms of different companies that provide GPS monitoring services, they wrote and warned that a lot of fakes were walking and that there was a chance to run into them, that they were supposedly not distinguishable, etc., if you did not prioritize the goods from them, but I went a proven way and I ordered Pribluda on ebay, I really had to wait 4 weeks, but oh well - I came. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Briefly about the tracker: <br>  Communication standard: GSM 850, GSM 900, GSM 1800, GSM 1900 <br>  GPS chipset: SiRF Star III <br>  Satellite navigation system: GPS <br>  Specifications: <br>  Tracking sensitivity: -159 dBm <br>  Hot start 2 seconds <br>  Cold start 35 seconds <br>  Accuracy 5 meters <br>  Operating temperature from -10 to +65 ¬∞ C <br><br>  Functions <br>  SMS remote control <br>  Speed ‚Äã‚Äãcontrol, start of movement <br>  Low Battery Signal <br><br>  Dimensions and weight <br>  64 mm length <br>  Width 46 mm <br>  17 mm thickness <br>  Weight 50 g <br><br>  Memory <br>  SD card support <br>  GPRS data transfer <br><br>  Hot keys and display <br>  Panic Button: sending current coordinates, sending SOS signal via SMS <br>  Indication: green LED <br><br>  Battery <br>  Li-ion battery type <br>  Battery capacity 860 mAh <br>  Normal operation time up to 12 hours <br>  Standby time up to 80 hours <br><br>  The device came in such a box, which, by the way, was not quite badly done. <br><img src="https://habrastorage.org/storage2/94b/e9c/2c2/94be9c2c2056848cfe880579603bf847.jpg"><br><img src="https://habrastorage.org/storage2/087/b22/65e/087b2265e3ec34323127dd063e577515.jpg"><br><br>  The device itself is made of soft-touch rubberized plastic. <br><img src="https://habrastorage.org/storage2/98d/464/2aa/98d4642aa0fba6777e65539c6344c95f.jpg"><br><img src="https://habrastorage.org/storage2/b74/791/f0c/b74791f0c718730f152af9153e066188.jpg"><br><br>  Inside view with already installed SIM. <br><img src="https://habrastorage.org/storage2/bd3/4a7/31e/bd34a731e9d3375ecf94b6a0a1b5d1e9.jpg"><br><br>  The kit also contained a charger for a replaceable battery and for the tracker itself. <br><img src="https://habrastorage.org/storage2/502/feb/e95/502febe9557fecef0770d011c5471d58.jpg"><br><br>  It‚Äôs a pity that there was no software in the box to track the tracker to work, but there is a benefit that it‚Äôs relatively simple for a simple (I apologize for the tautology) person to register both himself and the device and see how it all works, but it‚Äôs not for me wrote at the beginning of the topic. <br><br>  So, it's time to test.  Without hesitation, I went out to the balcony and launched the tracker, after reading the instructions I tried to set it up, but I was given this with variables because the instruction was not very well written, there were many typos, and typos in the commands themselves to be sent to the tracker, so I I found the Russian version and the setting went quickly and without errors. <br><br>  First of all, I tried to poll the tracker by SMS - I received the coordinates and instantly checked the maps - great, the next step is setting up my server, but since I don‚Äôt have my server, and I‚Äôve got a white IP, I quickly wrote a C # console application and decided to see what comes from the tracker, and the following line came from the tracker: <br>  "130402213013, + 79637 ** 3 ***, GPRMC, 173013.000, A, 6146.4979, N, 03421.2399, E, 1.92.21.48.020413 ,,, A * 5B, F ,, imei: ******* ******, 00, -16.4, F: 3.73V, 0.139.49646.250.99, 1478.68A7 \ n \ r " <br><br>  I wrote the asterisks in the fields with the phone number (2) and in the imei field specifically. <br>  Actually, the description of this line was in the instruction itself, but not completely in its entirety, something had to be dealt with, for example: find out what the GPRMC is, but this is also not difficult because  full of information. <br><br>  One of the main incomprehensible moments for me was that the coordinates do not come exactly a few tens of kilometers to the side, although SMS immediately comes with normal coordinates.  This was not a little annoying, because by that time I had already written a small program that parses everything and saves it in an xml file (more on that later).  The decision did not lie on the surface, because I simply did not understand how to formulate a request to Google to find the necessary information as a result of several days in a row I read various technical specifications about marine and not only navigation and articles on the operation of GPS receivers.  It turned out that all quite simple coordinates came in the WGS-84 format and they needed to be converted to ‚Äúnormal‚Äù, that is, those that fit, for example, Yandex Maps.  Actually, with the advent of ‚ÄúWGS-84‚Äù the circle narrowed and there were immediately formulas and everything counted. <br><br>  Separately, I want to write about the program, which I worked in the evenings, in order to receive data from the tracker.  I chose the c # language as the most convenient for me; at the university, I preferred to do labs on it due to its apparent simplicity, however.  However, all that was taught at the university and what I studied myself was not useful in this project.  For example, I have never heard about multithreading in the course of C #.  Yes Yes.  There was no work with the network either.  In general, I had to understand and read everything myself. <br><br>  First things first. <br>  To start, the ServerStart method starts, which makes you listen to the connection entry, starts the method that spawns a new stream that expects "clients" in one place.  When the client connects, another stream is generated that receives data from the tracker.  Everything is quite simple. <br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ServerStart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { isServerRunning = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; listener = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp); <span class="hljs-comment"><span class="hljs-comment">//   , IPAddress.Any            Point = new IPEndPoint(IPAddress.Any, port); //      listener.Bind(Point); //     listener.Listen(10); socketAccepter(); } public void socketAccepter() { //     ,     Thread th = new Thread(delegate() { while (isServerRunning) { //   ,       //   ,  -       Socket client = listener.Accept(); //client.ReceiveTimeout = 20000; // ,    client,          . //       ,      clients.Add(client); //     Thread thh = new Thread(delegate() { messageReciever(client); }); thh.Name = "Recieving bags " + DateTime.Now.ToString(); thh.Start(); threads.Add(thh); } }); th.Name = "Accepting Connecton " + threads.Count; th.Start(); threads.Add(th); }</span></span></code> </pre> <br><br>  A method that accepts messages.  I have heard many times ‚ÄúFor endless cycles you need to burn at the stake‚Äù, because of my lack of experience or more correctly to say no literacy in this matter, I decided to use it for now, then after reading the necessary literature I will try to write as it would be correct.  Although in fact I did not notice that I was beginning to devour the processor, there were moments when one core was fully loaded by the process due to this cycle, but after I debugged and began to use the Recieve method that stops the execution of the thread until the message from the tracker comes, in general, the same logic is used as with listener.Accept (). <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">messageReciever</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Socket client</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, av = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> t = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] data; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] messages; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[] spliter = { <span class="hljs-string"><span class="hljs-string">'\n'</span></span>, <span class="hljs-string"><span class="hljs-string">'\r'</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> message = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (isServerRunning &amp;&amp; client.Connected == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      byte[] bytes = new byte[2048]; //  av = client.Receive(bytes); if (av != 0) { message = Encoding.UTF8.GetString(bytes).Remove(av); messages = message.Split(spliter, System.StringSplitOptions.RemoveEmptyEntries); for (i = 0; i &lt; messages.Length; i++) { data = messages[i].Split(','); if (double.TryParse(data[0], out t)) saver.parseData(data); //else //MessageBox.Show(messages[i].ToString()); } } else { continue; } } catch //(Exception e) { //MessageBox.Show(e.Message + " " + e.StackTrace, " Message Reciever"); } } threads.Remove(Thread.CurrentThread); Thread.CurrentThread.Abort(); }</span></span></code> </pre><br><br>  I just want to finish this, in general, the only thing I want to add is that I decided to refuse to save the data in the xml file, because I didn‚Äôt understand how to synchronize the streams between themselves and often it turned out that the file was opened by one flow, but to him trying to get through is another thread.  The problem of locking laid on the database - MySQL.  Oh yeah, I think the parsing of data separated by a comma is also not needed in a special view, and connecting C # to MySQL is quite simple and friendly, especially since MySQL provides all the connectors. <br><br>  At the moment, I plan to expand the functionality of this application and distribute the web face in order to start all the same to visualize the movement.  There are also some difficulties with the web muzzle, namely: it was determined which cards to use, well, the actual learning of the maps API.  There is no experience with the API of any maps, but I think in an unhurried manner, everything will also be studied in the evenings. <br><br>  Thanks to those who read, and a special thank you UFO. <br><br>  <a href="">application</a> </div><p>Source: <a href="https://habr.com/ru/post/175451/">https://habr.com/ru/post/175451/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../175437/index.html">Mobile Timeline of corporate life for the iPhone. We invite you to speak!</a></li>
<li><a href="../175439/index.html">Mail.Ru rating: visits in reports</a></li>
<li><a href="../175445/index.html">Intel provides new opportunities for game developers</a></li>
<li><a href="../175447/index.html">The largest Bitcoin exchange Mt. Gox under DDoS attack - owners suspect that attackers want to provoke panic</a></li>
<li><a href="../175449/index.html">How to tie a BitTorrent tracker to a Python site: integration with XBT Tracker</a></li>
<li><a href="../175453/index.html">Using design patterns in javaScript: Spawning patterns</a></li>
<li><a href="../175457/index.html">Admin in 10 minutes</a></li>
<li><a href="../175459/index.html">Data migration from MySQL to PostgreSQL</a></li>
<li><a href="../175461/index.html">How it works: CAPTCHA</a></li>
<li><a href="../175465/index.html">M in MVC: why models are misunderstood and undervalued (translation)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>