<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We play the sapper in Photoshop</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="By the nature of my work, I occasionally have to automate my work in Photoshop. More precisely, I could not do this, but natural laziness leaves no ch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We play the sapper in Photoshop</h1><div class="post__text post__text-html js-mediator-article"><img src="//habrastorage.org/files/1a2/e97/3f2/1a2e973f28664e239c909177255053ad.png"><br><br>  By the nature of my work, I occasionally have to automate my work in Photoshop.  More precisely, I could not do this, but natural laziness leaves no chance in the fight against the routine, as they say "it is better to lose an hour, but then in 5 minutes to fly."  Everything probably would have remained at the level of separate disparate scripts if it were not for the <a href="http://habrahabr.ru/post/221863/">post</a> from <a href="http://habrahabr.ru/users/enotus/" class="user_link">enotus</a> .  Thanks to him, I learned that you can write extensions to HTML + JS for Photoshop (as well as other products from Adobe).  And went, gone. <br><br>  It so happened that I usually start learning everything new by writing a simple toy on this newest one.  For Photoshop, I chose Minesweeper.  In this example, I would like to talk about creating an extension interface, interacting with photoshop, and handling events.  So who is still interested, please roll. <br><a name="habracut"></a><br>  As already described in my predecessor‚Äôs <a href="http://habrahabr.ru/post/221863/">article</a> , we‚Äôll need <a href="http://brackets.io/">Brackets</a> with an installed <a href="http://davidderaedt.github.io/CC-Extension-Builder-for-Brackets/">extension</a> and, well, Photoshop itself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I also recommend immediately stocking up <a href="http://www.adobe.com/devnet/photoshop/scripting.html">documentation from the Adobe page</a> , most likely, you will need Photoshop CC JavaScript Reference and, possibly, Photoshop CC Scripting Guide.  They are not directly related to the writing of extensions, but will be required to interact with Photoshop. <br><br>  Getting started.  Create a project in Brackets using the extension: <br><br><img src="https://habrastorage.org/files/d90/aba/edf/d90abaedf65a4d28992113f88ec677a9.png"><br><br>  We will have a folder with a full set of files for the extension to work: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/34f/35a/0f2/34f35a0f2c104d4493f3aaad22e94800.png"></div><br><br>  In the CSS folder, I added an additional file for the topcoat light theme.  I prefer to work with the light interface, but this is not necessary.  By the way, about Topcoat: you can download and read the documentation <a href="http://topcoat.io/topcoat/">here</a> . <br><br>  Manifest can not touch, for the latest version of Photoshop everything is set up.  If you need to change the extension icon or allow work in Photoshop of an earlier version, check these points in the <a href="http://wwwimages.adobe.com/www.adobe.com/content/dam/Adobe/en/devnet/cs-extension-builder/pdfs/CC_Extension_SDK.pdf">documentation from the manufacturer</a> . <br><br>  In the js folder, we are interested in main.js, in fact, the main file of our project.  But before moving on to it, we need to create an interface for our extension.  This is done using HTML in the index.html file. <br><br>  There is one more important file that I didn‚Äôt mention: hostscript.jsx.  The JSX script is just what we‚Äôve been using for quite some time to automate various processes in Photoshop and other Adobe projects.  They even have a special utility ExtendScript Toolkit, it can also be useful, for example, for debugging jsx scripts. <br><br><h3>  index.html </h3><br>  In this file, too, everything is already prepared, a dark topcoat theme is connected, all the necessary scripts are added.  Actually, all that is required is to fill the div # content: <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"content"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> :<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"w"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"topcoat-text-input"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"6"</span></span></span><span class="hljs-tag">&gt;</span></span> x <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"h"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"topcoat-text-input"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"height"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"6"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span>  :<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"m"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"topcoat-text-input"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"8"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn_start"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"topcoat-button--large hostFontSize"</span></span></span><span class="hljs-tag">&gt;</span></span>New game<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"res"</span></span></span><span class="hljs-tag">&gt;</span></span>-<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"timer"</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> sec.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn_check"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"topcoat-button--large hostFontSize"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">&gt;</span></span>Check cell<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn_mark"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"topcoat-button--large hostFontSize"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">&gt;</span></span>Mark<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn_unmark"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"topcoat-button--large hostFontSize"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">&gt;</span></span>UnMark<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  As a result, we get the following picture: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d20/35b/df5/d2035bdf53684d0a8326552f87eca5c7.png"></div><br><br>  You can go to JS. <br><br><h3>  main.js </h3><br>  In fact, there is already an example of the simplest use: <br><br><pre> <code class="hljs lua">/*jslint vars: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, plusplus: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, devel: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, nomen: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, regexp: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, indent: <span class="hljs-number"><span class="hljs-number">4</span></span>, maxerr: <span class="hljs-number"><span class="hljs-number">50</span></span> */ /*global $, window, location, CSInterface, SystemPath, themeManager*/ (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; var csInterface = new CSInterface(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { themeManager.init(); $(<span class="hljs-string"><span class="hljs-string">"#btn_test"</span></span>).click(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { csInterface.evalScript(<span class="hljs-string"><span class="hljs-string">'sayHello()'</span></span>); }); } init(); }());</code> </pre><br>  The most important here is the line <i>csInterface.evalScript ('sayHello ()');</i>  It is in this way that the interaction with the application occurs.  The fact is that the extension mechanism is universal and does not depend on the application in which it is executed, but for the same reason he doesn‚Äôt know anything from the functionality ‚Äî he is still a photoshop who is an illustrator.  This is what JSX scripts are used for.  And <i>sayHello () is</i> only one of the methods implemented in hostscript.jsx. <br><br>  But, we also need not only to transfer data to jsx, but also to get results.  Therefore, you can use the callBack function, including an anonymous one: <br><br><pre> <code class="hljs javascript">csInterface.evalScript(<span class="hljs-string"><span class="hljs-string">'checkCell()'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(result&lt;=<span class="hljs-number"><span class="hljs-number">0</span></span>) { stopGame(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $(<span class="hljs-string"><span class="hljs-string">"#res"</span></span>).html(result); <span class="hljs-comment"><span class="hljs-comment">//      } });</span></span></code> </pre><br>  This is how I check cells for mines: result contains the number of cells that still need to be opened to win.  Mine corresponds to -1.  If you noticed, jQuery is immediately connected among the scripts.  So interacting with the interface is easy. <br><br>  The only time that requires separate mention in the framework of main.js is a reaction to events occurring in the application outside our extension.  On the one hand, everything is simple, on the other hand, worse than we would like.  First of all I tried to catch a mouse click in the document - it was not there, there is simply no such event.  As it turned out later, events relate, rather, to the entire application, and not to the document and have the character of ‚Äúfilter used‚Äù, ‚Äúcanceled last action‚Äù and the like.  In addition, all events have a 4-letter identifier and a long numeric one, and in our case it is the long numeric that is needed, and only short codes are indicated in the documentation.  Fortunately, each application has a method for converting one identifier into another, but it works within the framework of a jsx script. <br><br>  In general, I will not ship you the details now, let's use an example from the documentation: <br><br><pre> <code class="hljs cs"> <span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">registerPhotoshopEvent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">in_eventId</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CSEvent(<span class="hljs-string"><span class="hljs-string">"com.adobe.PhotoshopRegisterEvent"</span></span>, <span class="hljs-string"><span class="hljs-string">"APPLICATION"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.extensionId = csInterface.getExtensionID(); <span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.appId = csInterface.getApplicationID(); <span class="hljs-keyword"><span class="hljs-keyword">event</span></span>.data = in_eventId csInterface.dispatchEvent(<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>); } csInterface.addEventListener(<span class="hljs-string"><span class="hljs-string">"PhotoshopCallback"</span></span> , function(<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>) { csInterface.evalScript(<span class="hljs-string"><span class="hljs-string">"return (app.documents.length &gt; 0)"</span></span>, stopGame) }); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> closeEventid = <span class="hljs-string"><span class="hljs-string">"1131180832"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    registerPhotoshopEvent(closeEventid);</span></span></code> </pre><br><br><h3>  hostscript.jsx </h3><br>  As I wrote earlier, this is the main way to interact with the application, in this case with Photoshop CC.  This is where the downloaded at the very beginning of the Photoshop CC JavaScript is useful.  It contains a description of the properties and methods of various objects of Photoshop. <br><br>  I will give here just a couple of examples.  Start by creating a document: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startRulerUnits = app.preferences.rulerUnits; <span class="hljs-comment"><span class="hljs-comment">//     preferences.rulerUnits = Units.PIXELS; //     //  mainDoc = app.documents.add(width, height, dpi, "Game", NewDocumentMode.RGB);</span></span></code> </pre><br>  You know perfectly well that the sizes in Photoshop can be set in different measurement systems.  Accordingly, you will receive the measurement result in the same units.  Therefore, this should be closely monitored.  In order not to get an unpleasant surprise, it is better to err and convert the units of measurement to the desired value. <br><br>  Please note that there are exceptions.  For example, the selected area is always set and measured only in PIXELS.  And for example, all vector objects are measured exclusively in POINTS. <br><br>  To convert units of measurement, I used a small peep method somewhere on the Internet: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convertValue</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value, from, to</span></span></span><span class="hljs-function">) </span></span>{ output = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UnitValue(value, <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> output.as(to); }</code> </pre><br>  But here you will find a surprise.  Conversion from mm and inches to pixels always occurs at the rate of 72 dots per inch, and if you have a different image resolution, you should recalculate yourself. <br><br>  Well, perhaps the last example.  A lot of things that we are accustomed to do in Photoshop as a single action programmatically need to implement a variety of commands.  For example, for gluing layers in different ways (gluing everything, only visible, related) you need to implement yourself.  From the available there is only an option to glue with the previous layer, and then your business (to check visibility, connectedness, swap layers).  A similar situation with the selection of the area.  You cannot select a single pixel circle or column.  All that you offer to shove an array of coordinates of points, and what kind of a figure it will only depend on you: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DrawBomb</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">layer, x, y, colorHEX</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startRulerUnits = app.preferences.rulerUnits; <span class="hljs-comment"><span class="hljs-comment">//    preferences.rulerUnits = Units.PIXELS; //     mainDoc.activeLayer = layer; mainDoc.selection.select([ [(x+0.2)*cellSize+padding, (y+0.2)*cellSize+padding], [(x+0.8)*cellSize+padding, (y+0.2)*cellSize+padding], [(x+0.8)*cellSize+padding, (y+0.8)*cellSize+padding], [(x+0.2)*cellSize+padding, (y+0.8)*cellSize+padding], [(x+0.2)*cellSize+padding, (y+0.2)*cellSize+padding] ]); var color = new SolidColor; color.rgb.hexValue = colorHEX; mainDoc.selection.fill(color); mainDoc.selection.deselect(); preferences.rulerUnits = startRulerUnits; //   }</span></span></code> </pre><br><br><h3>  You can play </h3><br>  Well, the interface is drawn, the handlers are written in js, the logic in jsx is implemented, and you can play. <br>  Do not forget to enable Debug Mode so that we can see our unsigned extension in Photoshop. <br><br><img src="//habrastorage.org/files/aaf/0d3/da7/aaf0d3da7e754998b6195cdbd31fb476.png"><br><br>  Now you can run Photoshop and activate our extension: <br><br><img src="//habrastorage.org/files/d12/366/2aa/d123662aa1f948baa65a64e7ff473902.png"><br><br>  Well now you can play.  True, due to the fact that the clicks on the image are not caught, you need to move the red rectangle and press the action buttons on the expansion panel. <br><br><img src="//habrastorage.org/files/1a2/e97/3f2/1a2e973f28664e239c909177255053ad.png"><br><br>  Well, the process video: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/kekvhKzCOAw%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhhizssbzdpmYk5lU1oCWqkgw2X5Og" frameborder="0" allowfullscreen=""></iframe><br><br>  Finally, I will say a few words about signing your extensions. <br>  Do not forget to delete all hidden files before signing. <br>  In Windows, the path to the folder with the extension must start from a dot, like this: <br>  <i>ZXPSignCmd.exe -sign ./ru.mobak.habrasample ru.mobak.habrasample.zxp cert.p12 pass</i> <br><br>  And please do not judge strictly my code, after all, I am not a programmer. <br><br><h3>  Files </h3><br>  Expansion sources can be <a href="">downloaded here</a> . <br><br>  Ready extension that can be installed via Adobe Extension Manager <a href="">is here</a> .  Signed with a self-made certificate, so that it poured a little. <br><br>  PS I remembered that I forgot to write about one excellent resource, though in English, but with a bunch of examples: <a href="http://www.davidebarranca.com/">http://www.davidebarranca.com/</a> <br><br>  PPS Another point that I wanted to say.  Previously, to update the extension, you had to close and restart Photoshop.  But progress does not stand still, now it is enough to minimize and expand the expansion panel.  Thus, you can watch the result literally even after each change. </div><p>Source: <a href="https://habr.com/ru/post/253337/">https://habr.com/ru/post/253337/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../253327/index.html">Google will increase the security of its Android app store</a></li>
<li><a href="../253329/index.html">JetBrains at RubyConfBy in Minsk on March 22</a></li>
<li><a href="../253331/index.html">OpenWRT + OpenVPN for Asterisk. Budget way to organize a VPN network</a></li>
<li><a href="../253333/index.html">Corporate Laboratories PENTESTIT - practical training in the field of information security</a></li>
<li><a href="../253335/index.html">Your wi-fi will tell me where you live, where you work and where you travel</a></li>
<li><a href="../253341/index.html">Why is WPF alive?</a></li>
<li><a href="../253343/index.html">Most Elite IP Addresses</a></li>
<li><a href="../253345/index.html">Perl 6: Different names for different things</a></li>
<li><a href="../253347/index.html">Coroutine implementation in NodeJS</a></li>
<li><a href="../253349/index.html">Introduction to ASP.NET 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>