<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Improve your JavaScript knowledge by parsing source code.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When you start a programmer‚Äôs career, digging into the source code of open libraries and frameworks may seem like something scary. In this article, Ka...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Improve your JavaScript knowledge by parsing source code.</h1><div class="post__text post__text-html js-mediator-article">  <i>When you start a programmer‚Äôs career, digging into the source code of open libraries and frameworks may seem like something scary.</i>  <i>In this article, Karl Mungazi shares his experience on how he overcome his fear and began to use the source code to acquire knowledge and develop skills.</i>  <i>He also uses Redux to show how he "parses" the library.</i> <br><a name="habracut"></a><br>  Do you remember when you first plunged into the library or framework code that you often use?  In my life, this moment came at my first job as a front-end developer three years ago. <br><br>  We have just rewritten the outdated own framework that was used to create interactive learning courses.  At the very beginning of the rewriting, we studied some off-the-shelf solutions, including Mithril, Inferno, Angular, React, Aurelia, Vue, and Polymer.  Since I was still a young Padawan (who had just moved from journalism to web development), I was terribly frightened by the complexity of each framework and the lack of understanding of how they work. <br><br>  Understanding began to come when I began to carefully examine the Mithril framework.  Since then, my knowledge of JavaScript ‚Äî and programming in general ‚Äî has been greatly enhanced by the hours spent digging into the guts of libraries that I used daily at work and in my own projects.  In this article I will explain how you can use your favorite library as a training tool. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/bbe/3d3/fad/bbe3d3fadd117038a615108327f4c867.png" alt="image"><br>  <i>I started reading the source code with the hyperscript function from Mithril</i> <br><br><h3>  Pros of source code parsing </h3><br>  One of the main advantages of source code parsing is that you can learn a lot.  When I started to parse the Mithril code, I had little idea what the virtual DOM was.  When I finished, I already knew that the virtual DOM is a technique that includes creating a tree of objects describing the user interface.  Then this tree can be transformed into DOM elements using the DOM API like document.createElement.  To update, a new tree is created, describing the future state of the interface, and then compared with the previous version of this tree itself. <br><br>  I read about this in many articles and tutorials, but the most instructive one was to watch all this while working on our application.  I also learned to ask the right questions when comparing frameworks.  Instead of comparing ratings, for example, you can ask the question "How does the way a given framework works with changes affects the performance and convenience of the end user?" <br><br>  Another advantage is the development of an understanding of a good application architecture.  Despite the fact that most open-source projects are in general more or less similar in structure to their repositories, they still have differences.  The structure of Mithril is very flat and if you are well versed in its API, you can make quite realistic assumptions about the code in the render, router and request folders.  On the other hand, the React ªa structure reflects its new architecture.  The developers separated the module responsible for updating the UI (react-reconciler) from the module responsible for rendering the DOM elements (react-dom). <br><br>  One of the advantages of this separation for developers is that they can write their <a href="https://github.com/chentsulin/awesome-react-renderer">own renderers</a> using react-reconciler hooks.  Parcel, the module builder that I recently studied, also has a packages folder, like React.  The key module is called parcel-bundler, it contains the code that is responsible for creating the assemblies, the operation of the hot module server and the command line tool. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fdd/7ef/ac1/fdd7efac1030c6d2678f44dd39a223cc.png" alt="image"><br>  <i>Parsing the source code will soon lead you to reading the JavaScript specification.</i> <br><br>  Another plus, which was a big surprise for me, is that it becomes easier for you to read the official JavaScript specification.  I first turned to it when I tried to figure out what distinguishes throw Error and throw new Error (the spoiler is <a href="http://www.ecma-international.org/ecma-262/7.0/">nothing</a> ).  I asked this question because Mithril used throw Error in the implementation of the function m and it became interesting to me, and why is it better than throw new Error.  Then I also learned that the operators &amp;&amp; and ||  <a href="https://tc39.es/ecma262/">do not necessarily return boolean values</a> , found the <a href="http://www.ecma-international.org/ecma-262/">rules</a> by which the non-strict comparison operator == "resolves" the values ‚Äã‚Äãand the <a href="http://www.ecma-international.org/ecma-262/">reason</a> why Object.prototype.toString.call ({}) returns '[object Object]'. <br><br><h3>  How to parse the source code </h3><br>  You can parse the source code in different ways.  The easiest way seems to me the following: choose a method from your library and describe what happens when you call it.  It is not necessary to describe each step, you just need to try to understand its general principles and structure. <br><br>  Recently, I took apart ReactDOM.render in this way and thus learned a lot about React Fiber and some of the difficulties in its implementation.  Fortunately, React is very popular and the presence of a large number of articles on the same topic from other developers has accelerated the process. <br><br>  This dive into the code also introduced me to the concept of <a href="https://developer.mozilla.org/en-US/docs/Web/API/Background_Tasks_API">co-operative scheduling</a> , the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/requestIdleCallback">window.requestIdleCallback</a> method and a living <a href="">example of a linked list</a> (React processes updates by sending them to a queue, which is a linked list of updates with priorities).  In the process it would be nice to create a simple application using the library.  This makes debugging easier because you don‚Äôt have to deal with the stack trace of other libraries. <br><br>  If I don‚Äôt do a detailed review, I‚Äôll open the node_modules folder in the project I‚Äôm working on or look at GitHub.  I always do this, bumping into a bug or an interesting feature.  When reading the code on GitHub, make sure that this is the latest version.  The latest version code can be seen by clicking on the branch change button and selecting ‚Äútags‚Äù.  Changes in libraries and frameworks occur all the time, so it‚Äôs unlikely that you will want to parse something that may not be in the next version. <br><br>  A more superficial way to study source code is what I call a ‚Äúquick look‚Äù.  Somehow I installed express.js, opened the node_modules folder and walked through the dependencies.  If the README did not give me a satisfactory explanation, I read the source.  This led me to interesting discoveries: <br><br><ul><li>  Express uses two modules to merge objects, and the operation of these modules is very different.  merge-descriptors adds only the properties found in the source object, and also adds non-enumerated properties, while utils-merge goes over the enumerated properties of the object and its entire prototype chain.  merge-descriptors uses Object.getOwnPropertyNames () and Object.getOwnPropertyDescriptor (), and utils-merge uses for..in; </li><li>  The setprototypeof module provides a cross-platform version of defining the prototype of the object being created (instantiated); </li><li>  escape-html is a 78-line module for escaping lines, after processing which the content can be inserted into HTML; </li></ul><br>  Although these discoveries will most likely not be useful right away, a general understanding of the dependencies of your library or framework is very useful. <br><br>  Browser debugging tools are your best friends when debugging code on the front end.  In addition, they allow you to stop the program at any time and check its status, skip the execution of the function, or go inside or exit it.  In the minified code, this is impossible - so I unpack this code and put it in the appropriate file in the node_modules folder. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ad0/0b7/2b1/ad00b72b170fb59cbc2d87ba99892a1f.png" alt="image"><br>  <i>Use debugger as a useful application.</i>  <i>Make a guess and then check it out.</i> <br><br><h3>  A practical example: the connect function in Redux </h3><br>  React-Redux is a library for managing the state of applications on React.  When I work with popular libraries like this, I start by searching for articles about using them.  In preparing this example, I read this <a href="https://blog.isquaredsoftware.com/2018/11/react-redux-history-implementation">article</a> .  This is another plus of learning source code - it leads you to informative articles like this that improve your thinking and understanding. <br><br>  Connect is a react-redux function that binds the react component and the application's redux storage.  How?  According to the <a href="https://react-redux.js.org/api/connect">documentation,</a> she does the following: <br><blockquote> ‚Äú... returns a new, connected component class, which is a wrapper around the component passed into it.‚Äù </blockquote>  After reading this, I ask myself the following questions: <br><br><ul><li>  Do I know patterns or concepts where functions return incoming parameters wrapped with additional functionality? </li><li>  If so, how can I use it based on the description from the documentation? </li></ul><br>  Usually the next step is to create a primitive application using the connect function.  Nevertheless, in this situation, I used a new application on React, on which we were working, because I wanted to understand connect in the context of an application that would probably soon fall into production. <br><br>  The component on which I focused looks like this: <br><br><pre><code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MarketContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// code omitted for brevity } const mapDispatchToProps = dispatch =&gt; { return { updateSummary: (summary, start, today) =&gt; dispatch(updateSummary(summary, start, today)) } } export default connect(null, mapDispatchToProps)(MarketContainer);</span></span></code> </pre> <br>  This is a container component that serves as a wrapper for four smaller related components.  One of the first things you will find in the <a href="">file</a> that exports connect is the comment ‚Äúconnect is the facade for connectAdvanced‚Äù.  Already at this stage we can learn something: we have the opportunity to observe the pattern ‚Äúfacade‚Äù in action.  At the end of the file, we see that connect exports a call to the createConnect function.  Its parameters are a set of defaults, which are structured as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createConnect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ connectHOC = connectAdvanced, mapStateToPropsFactories = defaultMapStateToPropsFactories, mapDispatchToPropsFactories = defaultMapDispatchToPropsFactories, mergePropsFactories = defaultMergePropsFactories, selectorFactory = defaultSelectorFactory } = {}</span></span></span><span class="hljs-function">)</span></span></code> </pre><br>  And we have one more instructive moment: exporting the called function and destructuring the arguments of the function by default.  Destructuring is instructive for us because the code could be written like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createConnect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ connectHOC = connectAdvanced, mapStateToPropsFactories = defaultMapStateToPropsFactories, mapDispatchToPropsFactories = defaultMapDispatchToPropsFactories, mergePropsFactories = defaultMergePropsFactories, selectorFactory = defaultSelectorFactory }</span></span></span><span class="hljs-function">)</span></span></code> </pre><br>  As a result, we would get an error - Uncaught TypeError: Cannot destructure property 'connectHOC' of 'undefined' or 'null'.  This would happen because the function has no default argument values. <br><br>  <i>Note: to better understand the argument restructuring, you can read the <a href="https://davidwalsh.name/destructuring-function-arguments">article by David Walsh</a> .</i>  <i>Some moments may seem trivial, depending on your knowledge of the language - then you can focus on those moments with which you are not familiar.</i> <br><br>  The createConnect function alone does nothing.  It simply returns the connect function I used here: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> connect(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, mapDispatchToProps)(MarketContainer)</code> </pre><br>  It takes four optional arguments and the first three of them pass through the <a href="">match</a> function, which helps determine their behavior based on which arguments are passed, as well as their type.  It turns out that since the second argument passed in match is one of the three functions imported into connect, I need to choose where to go next. <br><br>  There is also something to learn from the <a href="">proxy function</a> used for wrapping the first argument in connect if these arguments are functions;  from the <a href="">isPlainObject</a> utility used to check plain objects or from the <a href="">warning</a> module, which shows how to make a debugger that will break on all errors.  After the match function, we move to connectHOC, the function that takes our react component and associates it with redux.  There is another function call that returns <a href="">wrapWithConnect</a> ‚Äî the function that actually handles the binding of the component to the repository. <br><br>  Looking at the connectHOC implementation, I can suggest why the details of the connect implementation should be hidden.  This is essentially the heart of react-redux and contains logic that should not be available through connect.  Even if we dwell on this, then later, if we need to dig deeper, we will already have the source material with a detailed explanation of the code. <br><br><h3>  We will summarize </h3><br>  Studying the source code is at first a very complicated thing.  But, like everything else, it becomes easier over time.  His task is not to understand everything, but to bring something useful for himself - a common understanding and new knowledge.  It is very important to be attentive during the whole process and to go into details. <br><br>  For example, I found the isPlainObject function interesting because it uses this if (typeof obj! == 'object' || obj === null) return false to make sure that the argument passed is a simple object.  When I first read this code, I thought, why not just use Object.prototype.toString.call (opts)! == '[object Object]', which would reduce the code and separate objects from their subtypes like Date.  But already in the next line you can see that even if suddenly (suddenly!) A developer using connect returns a Date object, for example, checking Object.getPrototypeOf (obj) === null will cope with this. <br><br>  Another unexpected point in isPlainObject in this place: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(baseProto) !== <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { baseProto = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(baseProto) }</code> </pre><br>  Finding the answer in Google led me to <a href="https://stackoverflow.com/questions/51722354/the-implementation-of-isplainobject-function-in-redux/51726564">this thread</a> on StackOverflow, and to <a href="https://github.com/reduxjs/redux/pull/2599">this comment</a> on GitHub `s Redux, which explains how this code handles situations when, for example, an object is transferred from iFrame. <br><br>  - <br><br>  <i>First decided to translate the article.</i>  <i>I would be grateful for clarifications, advice and recommendations.</i> </div><p>Source: <a href="https://habr.com/ru/post/460181/">https://habr.com/ru/post/460181/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460173/index.html">Development for Docker. Local environment. Part 2 - Nginx + PHP + MySql + phpMyAdmin</a></li>
<li><a href="../460175/index.html">Semiotics in marketing: what does it mean for your brand</a></li>
<li><a href="../460177/index.html">Wireless water leak sensor on nRF52832, DIY project</a></li>
<li><a href="../460179/index.html">LEAN + AGILE = AGILEAN or assemble the whole in parts</a></li>
<li><a href="../46018/index.html">Crisis vacancies</a></li>
<li><a href="../460187/index.html">Imagine your data before you collect it.</a></li>
<li><a href="../46019/index.html">How am I looking for a new job</a></li>
<li><a href="../460191/index.html">Stop the line or upgrade your pipeline, yo</a></li>
<li><a href="../460193/index.html">Monitoring certificate expiration in Windows on NetXMS</a></li>
<li><a href="../460195/index.html">Small, but remote: a miniature linear particle accelerator, which set a new record</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>