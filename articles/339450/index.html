<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parse BGP NOTIFICATION by RFC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Is it important to know the header formats of the transmitted data? In many training courses on networks, the analysis of protocol headers takes more ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parse BGP NOTIFICATION by RFC</h1><div class="post__text post__text-html js-mediator-article"><p>  Is it important to know the header formats of the transmitted data?  In many training courses on networks, the analysis of protocol headers takes more or less time, but usually this does not work without it.  Being descriptive in nature, their study often causes boredom, and the availability of automatic analysis tools does not improve the picture.  Sometimes the headline does contain an interesting approach, but in most cases it all fits into one principle and the next new format is usually not surprising.  The most interesting thing is, of course, all sorts of combinations of those options that affect the functionality, but is it worth remembering which options fit in the header in what order? </p><br><p>  I can not say that I remember it, I still can not say that it bothers me in my work.  I can't even say that I often have to see the headers in some kind of unprocessed form, because, as a rule, the messages in the syslog or on the console are already reformatted into coherent English sentences.  But, sometimes, you have to look deeper, for example, this year was fruitful for such messages: </p><br><p>  <em>Ericsson SmartEdge</em> </p><br><pre><code class="hljs lisp">notification msg sent (<span class="hljs-name"><span class="hljs-name">nbr</span></span> <span class="hljs-number"><span class="hljs-number">192.0</span></span>.<span class="hljs-number"><span class="hljs-number">2.1</span></span>, context <span class="hljs-number"><span class="hljs-number">0</span></span>x40030044 <span class="hljs-number"><span class="hljs-number">32</span></span> bytes, repeated <span class="hljs-number"><span class="hljs-number">89</span></span> times, code <span class="hljs-number"><span class="hljs-number">3/4</span></span> (<span class="hljs-name"><span class="hljs-name">update</span></span>: attribute flags error) - <span class="hljs-number"><span class="hljs-number">0000</span></span> <span class="hljs-number"><span class="hljs-number">0000</span></span> ffff ffff ffff ffff ffff ffff ffff ffff <span class="hljs-number"><span class="hljs-number">0020</span></span> <span class="hljs-number"><span class="hljs-number">0303</span></span> <span class="hljs-number"><span class="hljs-number">04e0</span></span> <span class="hljs-number"><span class="hljs-number">0708</span></span> <span class="hljs-number"><span class="hljs-number">0003</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span>ed <span class="hljs-number"><span class="hljs-number">5</span></span>bdc <span class="hljs-number"><span class="hljs-number">3f01</span></span></code> </pre> <br><p>  <em>Cisco, the same on the other hand</em> </p><br><pre> <code class="hljs pgsql">NOTIFICATION received <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">192.0</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">External</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-number"><span class="hljs-number">64496</span></span>): code <span class="hljs-number"><span class="hljs-number">3</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Update</span></span> Message Error) subcode <span class="hljs-number"><span class="hljs-number">4</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> flags error), Data: e0 <span class="hljs-number"><span class="hljs-number">07</span></span> <span class="hljs-number"><span class="hljs-number">08</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">03</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span> ed <span class="hljs-number"><span class="hljs-number">5</span></span>b dc <span class="hljs-number"><span class="hljs-number">3</span></span>f <span class="hljs-number"><span class="hljs-number">01</span></span></code> </pre> <br><p>  Let's try to sort it out with our hands as written in <a href="https://tools.ietf.org/html/rfc4271">RFC4271</a> .  We will not look for the cause - just a header analysis.  There will be many quotes and, most likely, nothing new for those who already know how to do it.  For the rest, read on. <a name="habracut"></a></p><br><p>  To make a variety, we will not limit ourselves to one message and analyze this <a href="https://github.com/FRRouting/frr/issues/1114">issue</a> from GitHub FRRouting: </p><br><pre> <code class="hljs sql">%NOTIFICATION: received from neighbor 192.168.0.1 3/5 (<span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> Message <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Length</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span>) <span class="hljs-number"><span class="hljs-number">3298</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bytes</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-number"><span class="hljs-number">02</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>c de <span class="hljs-number"><span class="hljs-number">02</span></span> ff <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>c b9 <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> ae <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>e <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>e <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span> ...    <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">04</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span></code> </pre> <br><p>  What can we read?  We see the message type, its value and sub-value, the IP address of the neighborhood (which is already known to us) and the hexadecimal string, which we do not understand. </p><br><p>  Let's start with the main one from the <a href="https://www.iana.org/assignments/bgp-parameters/bgp-parameters.xhtml">IANA</a> website, where there are all the necessary codes with reference to <a href="https://tools.ietf.org/html/rfc4271">RFC4271</a> .  If you gain strength and read the RFC from cover to cover, then everything should become clear, but we will try to understand only the format of our two messages without affecting the behavioral aspects. </p><br><h3 id="razbiraem-notification">  Parse NOTIFICATION </h3><br><p>  From the content, by name, we are satisfied with paragraph <a href="https://tools.ietf.org/html/rfc4271">4.5 of the NOTIFICATION Message Format</a> .  Having opened that, we really find the format of the header we need and a list of all codes with reference to the relevant sections (we‚Äôll hide all the quotes below under spoilers): </p><br><pre> <code class="hljs vhdl"> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | <span class="hljs-literal"><span class="hljs-literal">Error</span></span> code | <span class="hljs-literal"><span class="hljs-literal">Error</span></span> subcode | Data (<span class="hljs-keyword"><span class="hljs-keyword">variable</span></span>) | +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ <span class="hljs-literal"><span class="hljs-literal">Error</span></span> Code: This <span class="hljs-number"><span class="hljs-number">1</span></span>-octet <span class="hljs-built_in"><span class="hljs-built_in">unsigned</span></span> <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> indicates the <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> NOTIFICATION. The following <span class="hljs-literal"><span class="hljs-literal">Error</span></span> Codes have been defined: <span class="hljs-literal"><span class="hljs-literal">Error</span></span> Code Symbolic Name Reference <span class="hljs-number"><span class="hljs-number">1</span></span> Message Header <span class="hljs-literal"><span class="hljs-literal">Error</span></span> Section <span class="hljs-number"><span class="hljs-number">6.1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> Message <span class="hljs-literal"><span class="hljs-literal">Error</span></span> Section <span class="hljs-number"><span class="hljs-number">6.2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> UPDATE Message <span class="hljs-literal"><span class="hljs-literal">Error</span></span> Section <span class="hljs-number"><span class="hljs-number">6.3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> Hold Timer Expired Section <span class="hljs-number"><span class="hljs-number">6.5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> Finite State Machine <span class="hljs-literal"><span class="hljs-literal">Error</span></span> Section <span class="hljs-number"><span class="hljs-number">6.6</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> Cease Section <span class="hljs-number"><span class="hljs-number">6.7</span></span></code> </pre> <br><p>  Our section <a href="https://tools.ietf.org/html/rfc4271">6.3 UPDATE Message Error</a> with error code 3. We see it in all messages, along with the qualifying code: </p><br><p>  <strong><code>code 3/4 (update: attribute flags error)</code></strong> <code>- 0000 0000 ffff ffff ffff ffff ffff ffff ffff ffff 0020 0303 04e0 0708 0003 02ed 5bdc 3f01</code> </p><br><p>  <strong><code>code 3 (Update Message Error) subcode 4 (attribute flags error),</code></strong> <code>Data: e0 07 08 00 03 02 ed 5b dc 3f 01</code> </p><br><p>  <strong><code>3/5 (UPDATE Message Error/Attribute Length Error)</code></strong> <code>3298 bytes 50 02 0c de 02 ff 00 00 0c b9 00 00 00 ae 00 04 00 3e 00 04 00 3e 00 04 00 35 00 04 00 35 ...    00 04 00 35</code> </p><br><p>  There is no tablet here, so we read several pages of text.  Each paragraph describes the behavior in different situations, which is characterized by its error code. </p><br><p>  In our case, the flags used cannot be used with this attribute: </p><br><div class="spoiler">  <b class="spoiler_title">4 Attribute Flags Error</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> recognized <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> has <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> Flags that <span class="hljs-keyword"><span class="hljs-keyword">conflict</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> Code, <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> the Error Subcode MUST be <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> Flags Error. The Data field MUST contain the erroneous <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>, length, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).</code> </pre> </div></div><br><p>  and - the actual length of the attribute does not match the expected one: </p><br><div class="spoiler">  <b class="spoiler_title">5 Attribute Length Error</b> <div class="spoiler_text"><pre> <code class="hljs sql">If any recognized attribute has an Attribute Length that conflicts <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the expected <span class="hljs-keyword"><span class="hljs-keyword">length</span></span> (based <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> code), <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> Subcode MUST be <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Length</span></span> Error. The <span class="hljs-keyword"><span class="hljs-keyword">Data</span></span> <span class="hljs-keyword"><span class="hljs-keyword">field</span></span> MUST contain the erroneous <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">length</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>).</code> </pre> </div></div><br><p>  The most important thing that is written here and that will help us in the future is that besides the error codes, the message MUST contain an erroneous attribute from the UPDATE message in the <em>data</em> field in the TLV format (type, length, value).  That same hexadecimal string that we cannot yet interpret.  However, we still have a problem in identifying this field, now associated with various agreements adopted by manufacturers of devices for displaying the log of logs. </p><br><p>  In the example with Cisco, the beginning of the word "Data" is clearly indicated: <br>  <code>code 3 (Update Message Error) subcode 4 (attribute flags error),</code> <strong><code>Data</code></strong> <code>: e0 07 08 00 03 02 ed 5b dc 3f 01</code> </p><br><p>  In other cases, there is no such binding.  In this case, the line with Ericsson contains much more data than that of Cisco, although we know that these messages are identical.  Therefore, we go back a step to the <a href="https://tools.ietf.org/html/rfc4271">NOTIFICATION description</a> and see that we have completely disassembled it; the variable length <em>data</em> field is the last one in the message. </p><br><p>  Let's go higher in the hierarchy and start reading from the beginning of <a href="https://tools.ietf.org/html/rfc4271">section 4.1</a> : </p><br><div class="spoiler">  <b class="spoiler_title">Message Header Format</b> <div class="spoiler_text"><pre> <code class="hljs ruby"> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ <span class="hljs-params"><span class="hljs-params">| |</span></span> + + <span class="hljs-params"><span class="hljs-params">| |</span></span> + + <span class="hljs-params"><span class="hljs-params">| Marker |</span></span> + + <span class="hljs-params"><span class="hljs-params">| |</span></span> +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ <span class="hljs-params"><span class="hljs-params">| Length |</span></span> Type <span class="hljs-params"><span class="hljs-params">| +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span></span></code> </pre> </div></div><br><p>  Each message starts with a field: </p><br><div class="spoiler">  <b class="spoiler_title">Marker</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">This <span class="hljs-number"><span class="hljs-number">16</span></span>-octet field <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> included <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> compatibility; it MUST be <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> ones.</code> </pre> </div></div><br><p>  16 bytes long and consisting of all units <code>ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff ff</code> .  We see the same pattern in the Ericsson log: <br>  <code>code 3/4 (update: attribute flags error) - 0000 0000</code> <strong>( <code>ffff ffff ffff ffff ffff ffff ffff ffff</code> )</strong> <code>0020 0303 04e0 0708 0003 02ed 5bdc 3f01</code> </p><br><p>  Next, the length field is two bytes: <br>  <code>code 3/4 (update: attribute flags error) - 0000 0000 ffff ffff ffff ffff ffff ffff ffff ffff</code> <strong>( <code>0020</code> )</strong> <code>0303 04e0 0708 0003 02ed 5bdc 3f01</code> , with a value of 32 decimal, which is the same as decoding from the <code>notification msg sent (nbr 192.0.2.1, context 0x40030044</code> <strong><code>32 bytes</code></strong> , and even further: </p><br><div class="spoiler">  <b class="spoiler_title">Message type</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">This <span class="hljs-number"><span class="hljs-number">1</span></span>-octet unsigned <span class="hljs-type"><span class="hljs-type">integer</span></span> indicates the <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> code <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the message. This document defines the <span class="hljs-keyword"><span class="hljs-keyword">following</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> codes: <span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> - NOTIFICATION <span class="hljs-number"><span class="hljs-number">4</span></span> - KEEPALIVE</code> </pre> </div></div><br><p>  and we know that it is number 3 - NOTIFICATION: <code>code 3/4 (update: attribute flags error) - 0000 0000 ffff ffff ffff ffff ffff ffff ffff ffff 0020</code> <strong>( <code>03</code> )</strong> <code>03 04e0 0708 0003 02ed 5bdc 3f01</code> </p><br><p>  And then the message itself and what we recognized ( <a href="https://tools.ietf.org/html/rfc4271">section 4.5</a> ) 03 04 - the type and subtype of the error: <code>code 3/4 (update: attribute flags error) - 0000 0000 ffff ffff ffff ffff ffff ffff ffff ffff 0020 03</code> <strong>( <code>03 04</code> )</strong> <code>e0 0708 0003 02ed 5bdc 3f01</code> </p><br><p>  Ericsson repeated to us not only the <em>data</em> field that starts with <em>e0</em> , but the entire generated message.  In the Cisco log, the byte sequence begins with it.  The FRRouting log also contains the completely decrypted BGP header of the NOTIFICATION message followed by the <em>data</em> field, to which we return to decoding. </p><br><p>  We are directed to the description of the <a href="https://tools.ietf.org/html/rfc4271">UPDATE</a> format, since we expect there to find a description of attribute formats in order to understand what we are getting.  UPDATE contains many fields, the attributes are set in the Path Attributes variable length field: </p><br><div class="spoiler">  <b class="spoiler_title">each of which is presented in a TLV format</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">A variable-length <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-type"><span class="hljs-type">path</span></span> attributes <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> present <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> every <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> message, <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> an <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> message that carries <span class="hljs-keyword"><span class="hljs-keyword">only</span></span> the withdrawn routes. <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> <span class="hljs-type"><span class="hljs-type">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a triple &lt;<span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> length, <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> variable length.</code> </pre> </div></div><br><p>  Let's start with the Type field, which consists of two single-byte parts: </p><br><div class="spoiler">  <b class="spoiler_title">Flags and attribute values</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a two-octet field that consists <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> Flags octet, followed <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> Code octet. <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | Attr. Flags |Attr. <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> Code| +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</code> </pre> </div></div><br><p>  Here again, you need to read everything, because everything is decorated in solid text.  It follows that the flag field uses the first 4 bits from 0 to 3, and the second byte defines the attribute itself.  Let's put it all in the table: </p><br><table><tbody><tr><td>  Bit Attr.  Flags </td><td>  Value </td><td>  Related attribute </td></tr><tr><td rowspan="2">  0 </td><td>  0 - well-known </td><td>  1 - ORIGIN <br>  2 - AS_PATH <br>  3 - NEXT-HOP <br>  5 - LOCAL_PREF <br>  6 - ATOMIC_AGGREGATE </td></tr><tr><td>  1 - optional </td><td>  4 - MULTI_EXIT_DISC <br>  7 - AGGREGATOR </td></tr><tr><td rowspan="2">  one </td><td>  0 - optional non-transitive </td><td>  MULTI_EXIT_DISC </td></tr><tr><td>  1 - optional transitive or for all well-known </td><td>  ORIGIN <br>  AS-PATH <br>  NEXT-HOP <br>  ATOMIC_AGGREGATE <br>  AGGREGATOR </td></tr><tr><td rowspan="2">  2 </td><td>  0 - optional complete or for all well-known and non-transitive </td><td>  ORIGIN <br>  AS-PATH <br>  NEXT-HOP <br>  MULTI_EXIT_DISC <br>  LOCAL_PREF <br>  ATOMIC_AGGREGATE </td></tr><tr><td>  1 - optional partial </td><td></td></tr></tbody></table><br><p>  Bits 4-7 should be 0 when transmitting and ignored when receiving, we do not pay attention to them.  Bit 3 defines the size of the <em>length</em> field in the TLV: </p><br><div class="spoiler">  <b class="spoiler_title">0 - one byte, 1 - two bytes</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">The fourth high-<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-type"><span class="hljs-type">bit</span></span> (<span class="hljs-type"><span class="hljs-type">bit</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> Flags octet <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> the Extended Length <span class="hljs-type"><span class="hljs-type">bit</span></span>. It defines whether the <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> Length <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> one octet (<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> two octets (<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>).</code> </pre> </div></div><br><p>  Of particular interest is the <em>partial</em> flag, which can be set for transitive optional attributes.  The flag description is scattered in several places throughout the RFC.  There are the following situations of its use: </p><br><ol><li>  If the attribute is not recognized, this flag is set, and the attribute itself is passed on - <a href="https://tools.ietf.org/html/rfc4271">section 9</a> : <br><div class="spoiler">  <b class="spoiler_title">Update Message handling</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> an optional transitive <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> unrecognized, the Partial <span class="hljs-type"><span class="hljs-type">bit</span></span> (the third high-<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-type"><span class="hljs-type">bit</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> flags octet <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> retained <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> propagation <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> other BGP speakers.</code> </pre> </div></div></li><li>  If the attribute is recognized by the next speaker, the flag is still not reset - <a href="https://tools.ietf.org/html/rfc4271">section 5</a> : <br><div class="spoiler">  <b class="spoiler_title">Path Attributes</b> <div class="spoiler_text"><pre> <code class="hljs sql">Paths <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> unrecognized transitive optional <span class="hljs-keyword"><span class="hljs-keyword">attributes</span></span> SHOULD be accepted. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> an unrecognized transitive optional <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> accepted <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> passed <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> other BGP peers, <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> the unrecognized transitive optional <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> that <span class="hljs-keyword"><span class="hljs-keyword">path</span></span> MUST be passed, along <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">path</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> other BGP peers <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Partial</span></span> <span class="hljs-built_in"><span class="hljs-built_in">bit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> Flags octet <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">1.</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> a recognized, transitive optional <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> accepted <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> passed along <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> other BGP peers <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Partial</span></span> <span class="hljs-built_in"><span class="hljs-built_in">bit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> Flags octet <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">some</span></span> previous <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span>, it MUST <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> be <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> back <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> AS.</code> </pre> </div></div></li><li>  And if not the original speaker wants to add a transitive attribute, then the flag is also set: <br><div class="spoiler">  <b class="spoiler_title">(ibid)</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">New</span></span>, transitive optional attributes MAY be attached <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the <span class="hljs-type"><span class="hljs-type">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> the originator <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> other BGP speaker <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-type"><span class="hljs-type">path</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> they are <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> attached <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> the originator, the Partial <span class="hljs-type"><span class="hljs-type">bit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">Attribute</span></span> Flags octet <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">1.</span></span></code> </pre> </div></div></li></ol><br><h3 id="pristupim-k-razboru-update">  Let's start parsing UPDATE </h3><br><p>  The flags field in the first case e0: <code>code 3/4 (update: attribute flags error) - 0000 0000 ffff ffff ffff ffff ffff ffff ffff ffff 0020 0303 04</code> <strong>( <code>e0</code> )</strong> <code>0708 0003 02ed 5bdc 3f01</code> - in binary 1110 0000 - optional, transitive set by the <em>partial</em> flag, the length field is specified in one byte. </p><br><p>  <code>code 3/4 (update: attribute flags error) - 0000 0000 ffff ffff ffff ffff ffff ffff ffff ffff 0020 0303 04e0</code> <strong>( <code>07</code> )</strong> <code>08 0003 02ed 5bdc 3f01</code> - attribute code 7 - AGGREGATOR </p><br><p>  Data size is 8 bytes: <code>code 3/4 (update: attribute flags error) - 0000 0000 ffff ffff ffff ffff ffff ffff ffff ffff 0020 0303 04e0 07</code> <strong>( <code>08</code> )</strong> <code>0003 02ed 5bdc 3f01</code> </p><br><p>  In the second case, the well-known attribute (50 - 0101 0000), the size field is two bytes, AS_PATH (02), length 3294 bytes (0c de): <code>3/5 (UPDATE Message Error/Attribute Length Error) 3298 bytes</code> <strong>( <code>50 02 0c de</code> )</strong> <code>02 ff 00 00 0c b9 00 00 00 ae 00 04 00 3e 00 04 00 3e 00 04 00 35 00 04 00 35 ...    00 04 00 35</code> </p><br><p>  The rest of the string is the data field of the attribute itself.  To do this, move on in <a href="https://tools.ietf.org/html/rfc4271">section 4.3</a> : </p><br><div class="spoiler">  <b class="spoiler_title">AGGREGATOR</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">AGGREGATOR <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> an optional transitive <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> length <span class="hljs-number"><span class="hljs-number">6.</span></span> The <span class="hljs-keyword"><span class="hljs-keyword">attribute</span></span> contains the last <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> number that formed the <span class="hljs-keyword"><span class="hljs-keyword">aggregate</span></span> route (encoded <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> octets), followed <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> the IP address <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the BGP speaker that formed the <span class="hljs-keyword"><span class="hljs-keyword">aggregate</span></span> route (encoded <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> octets). This SHOULD be the same address <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> the one used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the BGP Identifier <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the speaker.</code> </pre> </div></div><br><p>  You should consider working with 32-bit ASn <a href="https://tools.ietf.org/html/rfc6793">RFC6793</a> to get the following result: </p><br><p>  4 bytes is AS197357: <code>code 3/4 (update: attribute flags error) - 0000 0000 ffff ffff ffff ffff ffff ffff ffff ffff 0020 0303 04e0 0708</code> <strong>( <code>0003 02ed</code> )</strong> <code>5bdc 3f01</code> , </p><br><p>  and 4 bytes IP address 91.220.63.1: <code>code 3/4 (update: attribute flags error) - 0000 0000 ffff ffff ffff ffff ffff ffff ffff ffff 0020 0303 04e0 0708 0003 02ed</code> <strong>( <code>5bdc 3f01</code> )</strong> - in the amount of 8 bytes, as indicated in the length field. </p><br><p>  In the second case, AS_PATH, TLV itself: </p><br><div class="spoiler">  <b class="spoiler_title">3rd inward, from the beginning NOTIFICATION</b> <div class="spoiler_text"><pre> <code class="hljs sql">The path segment type is a 1-octet length field <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">following</span></span> <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> defined: <span class="hljs-keyword"><span class="hljs-keyword">Value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Segment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Type</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> AS_SET: unordered <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ASes a route <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> message has traversed <span class="hljs-number"><span class="hljs-number">2</span></span> AS_SEQUENCE: ordered <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ASes a route <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> message has traversed The <span class="hljs-keyword"><span class="hljs-keyword">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">segment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">length</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a <span class="hljs-number"><span class="hljs-number">1</span></span>-octet <span class="hljs-keyword"><span class="hljs-keyword">length</span></span> <span class="hljs-keyword"><span class="hljs-keyword">field</span></span>, containing the <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ASes (<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> the <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> octets) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">path</span></span> <span class="hljs-keyword"><span class="hljs-keyword">segment</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> field.</code> </pre> </div></div><br><p>  Type and length fields are 1 byte long. </p><br><p>  Type 2, data size (ff - 255 ASn): <code>3/5 (UPDATE Message Error/Attribute Length Error) 3298 bytes 50 02 0c de</code> <strong>( <code>02 ff</code> )</strong> <code>00 00 0c b9 00 00 00 ae 00 04 00 3e 00 04 00 3e 00 04 00 35 00 04 00 35 ...    00 04 00 35</code> </p><br><p>  The data itself is AS numbers of 4 bytes each: <code>3/5 (UPDATE Message Error/Attribute Length Error) 3298 bytes 50 02 0c de 02 ff</code> <strong>( <code>00 00 0c b9</code> )</strong> <strong>( <code>00 00 00 ae</code> )</strong> <strong>( <code>00 04 00 3e</code> )</strong> <strong>( <code>00 04 00 3e</code> )</strong> <strong>( <code>00 04 00 35</code> )</strong> <strong>( <code>00 04 00 35</code> )</strong> <code>...    00 04 00 35</code> - AS3257, AS174, AS262206 AS262206, AS262197, AS262197, AS262197, AS262197 ... </p><br><p>  Got to the end.  It seemed not difficult? .. but boring.  Of course, this did not give us much in understanding the problem, since most of the document, which we didn‚Äôt even touch upon, describes not the formats, but the required behavior.  But at least we know the direction to the source. </p><br><p>  Unfortunately, or maybe not - the RFC is not an easy walk to read, in some places the data are tabulated, in others exactly in the same cases they are written directly in the text and you have to read a lot to understand the structure.  But I am glad that they are there and the manufacturers were able to read them and bring them to realization. </p><br><p>  PS In the case of FRRouting there is a <a href="https://github.com/donaldsharp/frr/commit/084002351fbfd6b4e2d9c4c218288b2324ad81cd">patch</a> , hinting that the problem is not in format. </p><br><p>  In the first case, apparently, a patch is also needed, since formally I didn‚Äôt see any problems in sharing flags for the AGGREGATOR attribute, maybe someone saw it. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/339450/">https://habr.com/ru/post/339450/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339440/index.html">Misconceptions about JavaScript Engine Switcher 2.X</a></li>
<li><a href="../339442/index.html">How the clipboard works in Windows</a></li>
<li><a href="../339444/index.html">‚ÄúColleagues, I like everything, but ...‚Äù or how to build work with the customer</a></li>
<li><a href="../339446/index.html">Trading robot for web designers</a></li>
<li><a href="../339448/index.html">Design for iPhone X</a></li>
<li><a href="../339454/index.html">How the brain hits a tree, or how we made a recommendation system using a neural network.</a></li>
<li><a href="../339456/index.html">ZFS and KVM. @home</a></li>
<li><a href="../339458/index.html">Uneducated youth: an attempt to summarize and some personal</a></li>
<li><a href="../339460/index.html">When did Phoenix kill Reils?</a></li>
<li><a href="../339464/index.html">Photogrammetry research</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>