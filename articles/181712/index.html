<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Model-View in QML. Part zero, introductory</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the most common and effective techniques for designing programs is to use the MVC programming pattern (Model-View-Controller) - Model-View-Cont...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Model-View in QML. Part zero, introductory</h1><div class="post__text post__text-html js-mediator-article">  One of the most common and effective techniques for designing programs is to use the MVC programming pattern (Model-View-Controller) - Model-View-Control.  MVC allows you to divide the parts of the program that are responsible for storing and accessing data, displaying data, and interacting with the user into separate weakly connected modules.  This division of responsibility simplifies the structure of the program and allows you to make changes to one of these parts without affecting the rest. <br><br>  This approach is actively used in Qt, and in QML it is generally the cornerstone.  So, for those who study QML, understanding MVC principles is not at all superfluous. <br><br>  Model-View in QML: <br><ol><li>  Model-View in QML.  Part zero, introductory </li><li>  <a href="http://habrahabr.ru/post/184416/">Model-View in QML.</a>  <a href="http://habrahabr.ru/post/184416/">Part One: Predefined Component Views</a> </li><li>  <a href="http://habrahabr.ru/post/190090/">Model-View in QML.</a>  <a href="http://habrahabr.ru/post/190090/">Part Two: Custom Submissions</a> </li><li>  <a href="http://habrahabr.ru/post/195706/">Model-View in QML.</a>  <a href="http://habrahabr.ru/post/195706/">Part Three: Models in QML and JavaScript</a> </li><li>  <a href="https://habrahabr.ru/post/302428/">Model-View in QML.</a>  <a href="https://habrahabr.ru/post/302428/">Part Four: C ++ Models</a> </li></ol><br><a name="habracut"></a><br><h5>  What is MVC </h5><br>  Sharing responsibility is one of the fundamental principles of programming.  Its essence is to divide the program into functional blocks, each of which is responsible for its part of the work.  These blocks can be functions, objects, modules, etc.  Blocks communicate with each other through certain interfaces.  This gives some blocks independence with respect to each other and reduces the complexity of the system. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The basic concepts of a graphical user interface (GUI) were developed in the Xerox lab in the 70s of the twentieth century.  This includes the MVC design pattern, which is designed to reduce the complexity and simplify the architecture of GUI programs using the very same division of responsibility. <br><br>  So, the essence of this template is to divide the program into three components. <br><br><ul><li>  Model.  Responsible for data and provides access to it. </li><li>  Representation.  Responsible for displaying data obtained from the model. </li><li>  Control.  Responsible for user interaction.  May change data in the model. </li></ul><br><br>  Schematically, the model can be represented as: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/17d/35c/3b4/17d35c3b4e81fe2e0956bd53c742198d.png"></div><br><br>  There are certain interfaces between these components that allow them to be untied.  Ideally, these modules should generally be independent of each other and allow making changes or even completely replacing any module without remaking the rest. <br>  With the development of graphical interfaces and the emergence of new types of programs, such as, for example, web applications, this separation option was not suitable everywhere.  Therefore, its varieties have appeared, such as MVVC, MVP, etc.  I will continue to call all varieties of this model MVC. <br><br>  Quite a few modern frameworks use MVC and contain the means to separate the program in accordance with this template.  Since one of the main purposes of Qt is the development of graphical user interfaces, it is also not without MVC, and Qt includes its own variation - the Model-View framework. <br><br><h5>  MVC in Qt and QML </h5><br>  The main idea of ‚Äã‚Äãusing this template in Qt is the separation of data and their display. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/871/8d0/070/8718d0070d568d515ca54048ab6dcb28.png"></div><br><br>  Here the model is responsible for the data and access to it.  Since, in the graphical interface, the same elements are often responsible for displaying elements and receiving input from the user, the idea of ‚Äã‚Äãcombining presentation and control is quite logical.  This is exactly what was done in Qt: the view not only displays data, but also performs control functions and is responsible for user interaction.  But in order for such an association not to lose flexibility, the concept of a delegate was introduced.  The delegate allows you to define how this data will be displayed and how the user can change it.  The view, in essence, is now a container for delegate instances. <br><br>  In QML, this principle also applies, even to a much greater degree.  As I said, Model-View is one of the fundamental concepts of QML.  One of the main purposes of QML is to separate the program interface into a separate part, which can be very flexible and easily adapted for different needs.  For example, for a desktop application there can be one interface variant, and for a mobile one another.  At the same time, the program core (model) can be written in C ++ and remain unchanged. <br><br>  It is also worth noting that for some models in QML, delegates can only display data, but not edit it. <br>  Despite the fact that the interface part is the main place for applying QML, a model on it can also be implemented, there are appropriate tools for this.  If desired, the program can be done almost entirely in QML / JavaScript and keep the amount of code in C ++ to a minimum.  It is with such a program that we will begin. <br><br><h5>  Simple MVC example in QML </h5><br>  Consider a program that displays a pair of colored rectangles with text in the middle. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> QtQuick <span class="hljs-number"><span class="hljs-number">2.0</span></span> Rectangle { <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">360</span></span> height: <span class="hljs-number"><span class="hljs-number">360</span></span> ListModel { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: dataModel ListElement { <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-string"><span class="hljs-string">"orange"</span></span> text: <span class="hljs-string"><span class="hljs-string">"first"</span></span> } ListElement { <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-string"><span class="hljs-string">"skyblue"</span></span> text: <span class="hljs-string"><span class="hljs-string">"second"</span></span> } } ListView { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: view anchors.margins: <span class="hljs-number"><span class="hljs-number">10</span></span> anchors.fill: parent spacing: <span class="hljs-number"><span class="hljs-number">10</span></span> model: dataModel delegate: Rectangle { <span class="hljs-attr"><span class="hljs-attr">width</span></span>: view.width height: <span class="hljs-number"><span class="hljs-number">100</span></span> color: model.color Text { anchors.centerIn: parent renderType: Text.NativeRendering text: model.text } } } }</code> </pre> <br>  The model here is an object of type ListModel.  As elements of the model, two child objects of a special type ListElement are used, in which we defined two properties: color and text. <br><br>  To display, we use an object of type ListView, to which we specify the id of our object of type ListModel as a model.  By itself, the view does not know which of our data to display, so you also need to give it a delegate.  The delegate in QML is the type of object, an instance of which is created for each element of the model.  A ListView, in turn, creates these objects, displays them in a list and provides navigation through them. <br><br>  The delegate is a rectangle with the text in the middle.  The color of the rectangle and the text are taken from the model.  Inside the delegate all the properties of the model elements are visible.  "Roles".  They are available through a special model object, as well as directly, i.e.  You can write just color.  I prefer to write completely, so clearly, where the data comes from and there will be no conflicts if the delegate has properties with the same names. <br><br>  The result of execution looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/117/570/9ac/1175709ac0754877b75edbc20af3d2b9.png"></div><br><br><h5>  Dynamics in Model-View </h5><br>  In MVC, a model can be both passive and active. <br><br>  Passive is a model that simply stores data and does not affect the controller and the presentation in any way.  Accordingly, when changing the data in the model, she can not tell the idea about it.  In this case, the controller keeps track of all changes to the model, it also tells the idea that it is necessary to update the information. <br><br>  The active model can notify ideas that the data has changed.  In turn, the view may display these changes.  This option is considered the classic implementation of MVC. <br><br>  Qt and QML use the active model.  This gives us the opportunity to change the data in the model and does not worry about the display of updated data - the presentation will do everything for us. <br><br>  Much refine the previous example: add a button that will add elements to the model when pressed. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> QtQuick <span class="hljs-number"><span class="hljs-number">2.0</span></span> Rectangle { <span class="hljs-attr"><span class="hljs-attr">width</span></span>: <span class="hljs-number"><span class="hljs-number">360</span></span> height: <span class="hljs-number"><span class="hljs-number">360</span></span> ListModel { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: dataModel } Column { anchors.margins: <span class="hljs-number"><span class="hljs-number">10</span></span> anchors.fill: parent spacing: <span class="hljs-number"><span class="hljs-number">10</span></span> ListView { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: view width: parent.width height: parent.height - button.height - parent.spacing spacing: <span class="hljs-number"><span class="hljs-number">10</span></span> model: dataModel clip: <span class="hljs-literal"><span class="hljs-literal">true</span></span> delegate: Rectangle { <span class="hljs-attr"><span class="hljs-attr">width</span></span>: view.width height: <span class="hljs-number"><span class="hljs-number">40</span></span> color: <span class="hljs-string"><span class="hljs-string">"skyblue"</span></span> Text { anchors.centerIn: parent renderType: Text.NativeRendering text: model.index } } } Rectangle { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: button width: <span class="hljs-number"><span class="hljs-number">100</span></span> height: <span class="hljs-number"><span class="hljs-number">40</span></span> anchors.horizontalCenter: parent.horizontalCenter border { <span class="hljs-attr"><span class="hljs-attr">color</span></span>: <span class="hljs-string"><span class="hljs-string">"black"</span></span> width: <span class="hljs-number"><span class="hljs-number">1</span></span> } Text { anchors.centerIn: parent renderType: Text.NativeRendering text: <span class="hljs-string"><span class="hljs-string">"Add"</span></span> } MouseArea { anchors.fill: parent onClicked: dataModel.append({}) } } } }</code> </pre><br>  Initially, the model does not contain any elements.  When you click a button, an empty element with no properties is added to the model.  The model informs you that a new item has been added.  For each new item, the view creates an object, the type of which we specified as a delegate.  In addition to the properties that we describe in the model elements, the delegate will have one more available - index (or model.index), containing the index of the element in the model and, accordingly, in the display.  So, despite the fact that we add an empty element to the model, one property is still there and we use the index as the text. <br><br>  Running the program and pressing the button we get something like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/23d/46e/471/23d46e471fa22425db95d5494b806e4f.png"></div><br><br>  I showed two simple examples that illustrate the separation of melons and their display and the use of delegates to control how data is displayed.  In the following text, I will refer to these two examples in order not to give their code in its entirety. <br><br><h5>  Small conclusion </h5><br>  Developed over 30 years ago, MVC technology has not lost its relevance.  To this day, it is the basis for designing programs with a graphical interface;  Now it is difficult to imagine such a program that does not use MVC. <br>  As a technology developed for creating graphical interfaces, Qt and, especially, QML have full MVC support.  The necessary tools are part of the libraries, moreover, in Qt itself, the ideology of this template is quite clearly visible. <br>  Accordingly, the use of MVC here is natural and that is how the developers intended it, and it was with this vision that the framework was designed. <br><br>  At this introductory part can be considered complete, and in the next article we will take a closer look at the presentation. </div><p>Source: <a href="https://habr.com/ru/post/181712/">https://habr.com/ru/post/181712/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../181694/index.html">Atomic operations</a></li>
<li><a href="../181700/index.html">How do we read books?</a></li>
<li><a href="../181704/index.html">COMPUTEX 2013 - an exhibition started in Taiwan</a></li>
<li><a href="../181708/index.html">Oil cooled housing (continued)</a></li>
<li><a href="../181710/index.html">Qt Creator 2.8.0 beta released</a></li>
<li><a href="../181714/index.html">Archive of interesting code</a></li>
<li><a href="../181718/index.html">Legendary JS-Livecoding example of Bret Victor (Bret Victor) done in Flash</a></li>
<li><a href="../181728/index.html">Distributed audio player on Odroid U2</a></li>
<li><a href="../181732/index.html">Google will have to disclose user data at the request of the FBI</a></li>
<li><a href="../181734/index.html">Five file managers for Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>