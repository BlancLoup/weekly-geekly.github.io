<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mobile site speed optimization</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Along with the growth of the mobile Internet, the need to optimize the speed of mobile sites is growing. Even the most modern smartphones on Android, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mobile site speed optimization</h1><div class="post__text post__text-html js-mediator-article">  Along with the growth of the mobile Internet, the need to optimize the speed of mobile sites is growing.  Even the most modern smartphones on Android, iOS, WebOS, BlackBerry OS and others have processors with a frequency of no more than 1Ghz, and 3G speeds can be considered quite slow (download speed is 3 times less than DSL). <br><br>  Mobile devices inherited the problems of ‚Äúbig‚Äù machines: from the number of http requests to the effectiveness of JavaScript. <br><br><h3>  Mobile Features </h3><br>  In addition to being often pocketed and easier to lose, there are several key differences between mobile devices and desktops: <br><ul><li>  small screen resolution; </li><li>  slow connections; </li><li>  limited cache size; </li><li>  many different devices and form factors; </li><li>  low power processors; </li><li>  extensive HTML5 support; </li><li>  relatively new browsers (in this world they don‚Äôt know about IE6). </li></ul><br><a name="habracut"></a><br><h3>  General recommendations </h3><br>  Mobile sites are inherent in most of the performance problems of ‚Äúbig sites,‚Äù so many of the listed techniques came from desktop optimization. <br><ul><li>  use gzip to compress text data; </li><li>  place the CSS in the header of the HTML document, and JavaScript at the bottom of the page; </li><li>  combine javascript and css files that are used throughout the site.  This will reduce the number of HTTP requests, which is extremely critical for mobile sites; </li><li>  use minimization and obfuscation of CSS and JavaScript code; </li><li>  JS and CSS which are used only once on the site, as well as small JS and CSS (up to 5 kB), it is better to include directly into the page, i.e.  do not make in separate files; </li><li>  Many mobile browsers (for example, Android or Opera Mobile) have a general limit on the number of connections no more than 4-6.  Using domain sharding for such browsers can only harm the speed of the site; </li><li>  At the same time, the Android browser supports HTTP pipelining, which allows you to send 3 requests to the server at once in one connection.  Remember to make sure the server also supports HTTP pipelining; </li><li>  it is very important to compress files (without visible loss in quality) - use, for example, Smush.it - <a href="http://webperformance.ru/2011/05/27/forget-about-the-images/">for more on this</a> ; </li><li>  avoid or at least make redirects cacheable; </li><li>  for iOS, use Quicktime Reference Movies, this allows you to ‚Äúgive‚Äù to the visitor different video files, based on the capabilities of its Internet connection. </li><li>  Take advantage of WebSockets wherever possible (full support is currently only in iOS Safari 4.2-4.3, partial in Opera Mobile 11.1). </li></ul><br><h3>  HTML and CSS optimization </h3><br>  Broad support for HTML5 and CSS3 in mobile browsers allows you to use the most modern techniques to optimize sites: <br><ul><li>  HTML code should be extremely simple.  Use HTML5 semantic elements, specify &lt;! DOCTYPE html&gt;, exclude optional xmlns attributes.  Also try to reduce the number of divs and classes; </li><li>  try to use input less often, and if you use, then in HTML5 formats; </li><li>  use <a href="http://www.colorzilla.com/gradient-editor/">CSS gradients</a> instead of background images - this will drastically reduce the number of calls to the server; </li><li>  CSS provides many other useful features, the use of which is more effective than images (shadows, rounded borders, multiple backgrounds embedded in the svg and canvas pages). </li></ul><br><h3>  Image Optimization </h3><br>  Along with the fight against unnecessary calls to the server, it is very important to minimize the size of the downloaded files.  In this perspective, image optimization is the most important element. <br><ul><li>  use CSS sprites to optimize logos and icons; </li><li>  in html and css encode images in base64 - a very effective way, because  supported by most mobile browsers, and the encoding takes place on the server side.  In addition to PHP - base64_encode (), you can use HTML5 technology from Canvas - toDataURL (); </li><li>  encode Unicode <a href="http://pukupi.com/post/1964">Emoji</a> icons instead of images (supported starting with iOS 2.2, as well as in many Japanese phones); </li></ul><br>  On mobile devices, screens have significantly lower resolutions than desktop screens.  CSS allows us to determine the current resolution of the user's screen and, depending on this, transfer to it the version of the image that has a more appropriate resolution. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="css hljs"><span class="hljs-comment"><span class="hljs-comment">/* Screens bigger than 480px */</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">media</span></span> only screen and (min-device-width: <span class="hljs-number"><span class="hljs-number">481px</span></span>) { <span class="hljs-selector-id"><span class="hljs-selector-id">#header</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(header-full.png); } }</code> </pre> <br>  The code above specifies that the user's screen width is greater than 480px and instructs the browser to download a header-full.png image with full resolution. <br>  But the following code fragment, determining that the screen width is less than 480px, offers the browser a picture adapted to small screens: <br><br><pre> <code class="css hljs"><span class="hljs-comment"><span class="hljs-comment">/* Screens smaller than 480px */</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">media</span></span> only screen and (max-device-width: <span class="hljs-number"><span class="hljs-number">480px</span></span>) { <span class="hljs-selector-id"><span class="hljs-selector-id">#header</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(header-small.png); } }</code> </pre> <br>  As a result of this mutual understanding between the site and the browser, the size of the data downloaded to the mobile device will be significantly reduced. <br><br>  However, above all, take care of the convenience of the user.  Using the same principle (separate content for mobile and desktop devices), you can make the site enjoyable for users with high-resolution screens, while not harming other visitors. <br>  For example, iPhone 4 users have become accustomed to the fact that on the screen of their phone must be high DPI images (eg 300).  And if you want your site not to look miserable on Retina screens, you will need to prepare another separate set of high-resolution images and upload them using <a href="http://www.w3.org/TR/css3-mediaqueries/)">CSS Media Queries</a> <br><br><pre> <code class="css hljs"><span class="hljs-comment"><span class="hljs-comment">/* High dpi */</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">media</span></span> only screen and (min-resolution: <span class="hljs-number"><span class="hljs-number">300dpi</span></span>), only screen and (-webkit-min-device-pixel-ratio: <span class="hljs-number"><span class="hljs-number">1.5</span></span>), only screen and (min--moz-device-pixel-ratio: <span class="hljs-number"><span class="hljs-number">1.5</span></span>) { <span class="hljs-selector-id"><span class="hljs-selector-id">#header</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(header-300dpi.png); } } <span class="hljs-comment"><span class="hljs-comment">/* Low dpi */</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">media</span></span> only screen and (max-resolution: <span class="hljs-number"><span class="hljs-number">299dpi</span></span>), only screen and (-webkit-max-device-pixel-ratio: <span class="hljs-number"><span class="hljs-number">1.5</span></span>), only screen and (max--moz-device-pixel-ratio: <span class="hljs-number"><span class="hljs-number">1.5</span></span>) { <span class="hljs-selector-id"><span class="hljs-selector-id">#header</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(header-72dpi.png); } }</code> </pre> <br>  This is exactly the case when you should sacrifice performance in favor of user convenience. <br><br><h3>  Optimization based on connection speed </h3><br>  Starting with the version of Android 2.2 Froyo, developers have the opportunity to receive data about the current type of Internet connection from the device.  This is implemented using the navigator.connection object. <br><br>  Here is an example of data received from a device that operates on a 3G network: <br><br> <code>navigator = { <br> connection: { <br> "type": "4", <br> "UNKNOWN": "0", <br> "ETHERNET": "1", <br> "WIFI": "2", <br> "CELL_2G": "3", <br> "CELL_3G": "4" <br> } <br> };</code> <br>  Connection type is ‚Äú4‚Äù, which corresponds to CELL_3G.  Using a simple script, you can determine the type of connection and pass this information as a CSS class in the HTML element. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Initialize variables var connection, connectionSpeed, htmlNode, htmlClass; // Create a custom object fallback if navigator.connection isn't available connection = navigator.connection || {'type':'0'}; // Set connectionSpeed switch(connection.type) { case connection.CELL_3G: // 3G connectionSpeed = 'mediumbandwidth'; break; case connection.CELL_2G: // 2G connectionSpeed = 'lowbandwidth'; break; default: // WIFI, ETHERNET, UNKNOWN connectionSpeed = 'highbandwidth'; } // set the connection speed on the html element, ie &lt;html class="lowbandwidth"&gt; htmlNode = document.body.parentNode; htmlClass = htmlNode.getAttribute('class') || ''; htmlNode.setAttribute('class', htmlClass + ' ' + connectionSpeed);</span></span></code> </pre> <br>  As a result, when defining a low-speed connection, we transmit optimized images to the visitor's browser using CSS: <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.highbandwidth</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.logo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'logo-high.jpg'</span></span>); } <span class="hljs-selector-class"><span class="hljs-selector-class">.mediumbandwidth</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.logo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'logo-medium.jpg'</span></span>); } <span class="hljs-selector-class"><span class="hljs-selector-class">.lowbandwidth</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.logo</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">url</span></span>(<span class="hljs-string"><span class="hljs-string">'logo-low.jpg'</span></span>); }</code> </pre> <br><br>  And yet you should not deprive users of choice (we will not be dictators).  Therefore, it will be good in addition to the common choice: <br><ul><li>  site version <code>desktop | mobile</code> <code>desktop | mobile</code> </li></ul><br>  Giving also a choice: <br><ul><li>  connection speed: <code>High | Medium | Low</code> <code>High | Medium | Low</code> </li></ul><br>  Use simple rules - ‚Äúif the pixels are not visible, they do not need to be loaded‚Äù, but at the same time ‚Äúyou should not decide for the user, we can recommend him‚Äù. <br><br><h3>  Caching </h3><br>  If in the case of desktops in most cases, the decision will be in favor of external files, then with mobile files it is most likely the opposite.  Due to the small size of the cache, there is no need to talk about large and long-term savings.  There are a number of tips to optimize the speed of reloading pages: <br><ul><li>  cache ajax; </li><li>  set the file headers for the distant future (far-future cache expiration headers); </li><li>  Avoid cookies, use localStorage instead (cookies are sent by http requests, significantly increasing the size of the transmitted data).  LocalStorage and SessionStorage are HTML5 technologies that are a more effective alternative to cookies.  You can also store external CSS and JavaScript; </li></ul><br>  An important limitation for LocalStorage and SessionStorage is that they can only store data of type String.  Therefore, the data should be pre-converted to a string format, and subsequently restored to the original using <code>JSON.stringify()</code> and <code>JSON.parse()</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = { <span class="hljs-attr"><span class="hljs-attr">firstName</span></span>: <span class="hljs-string"><span class="hljs-string">'Joe'</span></span>, <span class="hljs-attr"><span class="hljs-attr">lastName</span></span>: <span class="hljs-string"><span class="hljs-string">'Schmoe'</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">40</span></span> } <span class="hljs-comment"><span class="hljs-comment">// Store the object localStorage.userInfo = JSON.stringify(user); // Retrieve the object var user = JSON.parse(localStorage.userInfo);</span></span></code> </pre> <br>  The size of the data that can be stored in these objects vary from browser to browser, but 5 Mb should be enough for most. <br>  An interesting point is that devices on Android and BlackBerry OS can keep the cache even after turning the device on / off, while the iPhone cannot boast with it. <br><table><tbody><tr><th>  Smartphones </th><th>  iPhone 4 </th><th>  Galaxy s </th><th>  Nexus s </th><th>  Blackberry torch </th></tr><tr><td>  OS / Ver </td><td>  iOS / 4.3 </td><td>  Android 2.2 </td><td>  Android 2.3 </td><td>  Blackberry 6 </td></tr><tr><td>  Constant* </td><td>  0 </td><td>  four </td><td>  four </td><td>  25 </td></tr><tr><td>  In mind** </td><td>  100 </td><td>  four </td><td>  four </td><td>  25 </td></tr></tbody></table><table><tbody><tr><th>  Tablets </th><th>  iPad 1 </th><th>  iPad 2 </th><th>  XOOM </th></tr><tr><td>  OS / Ver </td><td>  iOS / 4.3 </td><td>  iOS / 4.3 </td><td>  Android 3.0 </td></tr><tr><td>  Constant* </td><td>  0 </td><td>  0 </td><td>  20 </td></tr><tr><td>  In mind** </td><td>  20 </td><td>  50 </td><td>  20 </td></tr></tbody></table>  * Permanent - this is the cache that remains, even after restarting the browser. <br>  ** In memory is a cache that is stored in RAM (for example, when switching between applications).  You can read more about cache in mobile devices <a href="http://www.blaze.io/mobile/understanding-mobile-cache-sizes/">in the Blaze company blog</a> . <br><br><h3>  Javascript optimization </h3><br>  The lack of power of processors in mobile devices, again makes the struggle to reduce the load.  So Google‚Äôs research shows that parsing every 1 KB of JavaScript code is approximately 1 ms. <br><ul><li>  avoid javascript timeout animations, use CSS3 transitions instead (but not all browsers fully support this technology, so you should have a ‚Äúspare‚Äù old school version for this case) </li><li>  on touch devices, click handlers lead to a delay of 300-500 ms, which is quite a lot, so for such devices it is better to use ‚Äúnative‚Äù handlers - ontouchend; </li><li>  use only the necessary parts of large frameworks (eg jQuery), and not their entirety.  It is even more optimal to use small frameworks (XUI, zepto.js, microjs); </li><li>  strive to minimize javascript in forms, it is better to use HTML5, where it is possible; </li><li>  Another useful HTML5 achievement is the use of databases that are stored on the client side.  Among existing solutions, indexedDB received the most popularity (we hope that this technology will soon be supported by mobile browsers); </li><li>  use ajax (onhashchange - to manage history) and ask only what needs to be changed; </li><li>  load JS asynchronously to the main content; </li><li>  reduce starting delays.  For example, the Gmail Mobile team offered an interesting way to <a href="http://googlecode.blogspot.com/2009/09/gmail-for-mobile-html5-series-reducing.html">‚Äúlazy‚Äù loading modules</a> ; </li></ul>  The essence of this method is that you first need to break up large software modules into smaller ones and distribute which of them should be loaded at the start of the page load, and which later.  It is also important that ‚Äúdeferred‚Äù modules will be loaded as they are invoked by user actions.  Such a load really looks lazy: until you kick it, it won't move. <br><br><h3>  Conclusion </h3><br>  The importance of optimizing the speed of mobile sites is becoming more important now, when users are increasingly using smartphones to solve everyday tasks on the Internet. <br><br>  Interestingly, most people are more intolerant of slow sites when using smartphones.  Often this is due to specific tasks that need to be solved within a few seconds (for example, specify the address of the restaurant). <br><br>  It is important to remember that our task is to minimize the download speed of the site with the least loss in functionality and usability. </div><p>Source: <a href="https://habr.com/ru/post/124203/">https://habr.com/ru/post/124203/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124195/index.html">Optimizing Facebook Graph API with Real-Time Updates</a></li>
<li><a href="../124196/index.html">Welcome to Debian Day!</a></li>
<li><a href="../124198/index.html">Robot "Inchworm" based on Arduino Nano</a></li>
<li><a href="../124199/index.html">Heroes ABBYY Cup</a></li>
<li><a href="../124202/index.html">Wine Basics for Beginners</a></li>
<li><a href="../124205/index.html">7 rules of effective mailings for startups</a></li>
<li><a href="../124206/index.html">Twitter automates the ad placement process to cater to major advertisers.</a></li>
<li><a href="../124208/index.html">How to check and analyze memory usage on a Solaris system</a></li>
<li><a href="../124210/index.html">Using GPGPU for data compression (Part I)</a></li>
<li><a href="../124211/index.html">We write primitive billing statistics for Asterisk</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>