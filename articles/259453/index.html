<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>STM32 training for the masses</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A little background 
 I am another graduate of a Moscow university (I will not specify which one, but mediocre). Six months ago, we were told that it ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>STM32 training for the masses</h1><div class="post__text post__text-html js-mediator-article"><h4>  A little background </h4><br>  I am another graduate of a Moscow university (I will not specify which one, but mediocre).  Six months ago, we were told that it was time to write a diploma.  At that time, I just started to master microcontrollers and it wasn‚Äôt that hard for me, but with the creaks that the refrigerator produces when you, alone, try to gently move it without damaging the precious laminate (in my case linoleum). <br><br>  My training began when I became interested in the topic of microcontrollers two years ago and an engineer who asked about them gave me a 300x200mm fee and said that it has a STM32F217ZGT6 controller and this board has everything you need for training.  ‚ÄúIn general, you will master it - everything else will seem like garbage‚Äù (he didn‚Äôt say that to blink the LED, you need to set up SPI, which I didn‚Äôt even hear about at that time).  After three not very tense months of futile attempts, awareness of the weakness of programming skills and the huge amount of articles read, it was necessary to fork out for STM32VLDISCOVERY and the way to copy programs and experiment with them finally went, but still slowly. <br><br>  For a year and a half, I managed to work as a developer, looked for vacancies where I work with STM32 (because I think that now they are the most promising microcontrollers of their class), picked up experience and when it came to the diploma, he remembered his painful calluses.  The idea with the theme came instantly: <b>"The debug board on the STM32 and (full) training course (for the smallest) to it."</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Yes, I know, I know, from many engineers I heard that with the theme ‚Äúdebugging board‚Äù, ‚Äúif I were a teacher, I would have filled you up with protection,‚Äù but I still think that any idea has a right to life, so everyone who is interested, Please read further. <br><a name="habracut"></a><br>  I am aware that there are many articles where it is written what, where and how.  And how to work with registers, how to understand what they do, etc.  etc.  For me (maybe from a great mind) many such articles were still not clear and I could not get out beyond the blinking limits of the LED without examples of working code for quite some time.  Plus, even in cycles (6-7 pieces each), the system was not always traced, many things were not chewed (which I missed very much), and most importantly - they ended without closing the topic until the end, leaving even more questions behind. <br><br>  That is why I wanted to write a complete and complete course, so that others did not suffer and figure it out for themselves.  So, having come to the institute and realizing that for quick mastering and understanding, an incentive is needed (or rather, such a good stitch), I began to beat myself with my heel in the chest (to dig my own grave), that I would not only write a training course (I had to call his methodological manual), but I will also provide a working model.  They accepted the topic, wrote the assignment (dug a grave, ordered a gravestone), it was up to you to write everything down and work out (lay down in the grave, dig in and put a gravestone). <br><br>  Life has shown that I didn‚Äôt have time for half a year, but all the same, the time allotted for the diploma was almost over, protection was very soon, but it‚Äôs not surprising that everything is not only ready, but almost 100% tested (on living people in including). <br><br>  The output is the following: <br><br><h4>  1. The course itself (methodical manual in a scientific way) </h4><br>  Briefly about him we can say that in my opinion and according to testers testers, it is full-fledged, but a bit harsh and not finished.  Since I decided that I would not write a textbook on programming on SI, therefore, there are no explanations of operators in the course, and therefore they said that the course is severe in places.  Regarding the shortcomings, I will honestly say that I did not have time to debug everything for delivery, in order to write about it not only here, but also in the methodological manual for delivery.  I also think that it is possible better, but more on that later. <br><br><h4>  2. Debug board on STM32F103RET6 controller </h4><br>  Everything here is slightly better than in the first paragraph, the board was developed, ordered (because of the circumstances it was necessary to order urgently) in Rezonite, components were ordered, soldered with handles (to be honest, no video will convey the sensation of the first LQFP64 soldering) and tested (most of it earned immediately).  But this is a layout and, of course, was not without overlays: wiring, adapters and other various ‚Äúcrutches‚Äù, but unfortunately I don‚Äôt have time to order a second revision, and I probably wouldn‚Äôt have done it to protect my diploma.  So below I will tell you more about this debug board. <br><br>  Having come to the first job as an electronics developer, I came across one interesting opinion and, as it turned out, it is very common.  This opinion sounded like this: ‚ÄúI‚Äôm a programmer and I program microcontrollers, I don‚Äôt know circuit engineering and I don‚Äôt want to know, by the way, I don‚Äôt know how to solder either.‚Äù  After talking with a group of programmers outside the company, I realized that the person from my work is far from alone in his opinion, and although I don‚Äôt support him, it‚Äôs worth understanding and respecting the opinions of others, all the more it fits perfectly into the concept of the all on board debug board. .  In this regard, the board turned out to be quite ‚Äúfat‚Äù, called STM32SB (SB-StudyBoard) V1.0b.  Below we analyze what it has entered. <br><br>  <b>1. Microcontroller</b> <br>  Based on the fact that I worked with the STM32F103RET6 microcontroller, it was chosen for the project. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2bc/b0a/8ca/2bcb0a8caec984d2a7898ca5444b02cf.jpg" alt="image"><br><br>  <b>2. Power scheme and hardware USB controller</b> <br>  This microcontroller has a built-in USB, which it was decided to bring to a separate connector. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/901/e6f/e6b/901e6fe6b3a627d9cc8585ed9285ba18.jpg" alt="image"><br><br>  <b>3. Speaker</b> <br>  It was decided to introduce for the development of PWM modulation and learning to write melodies. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3d/d21/8a5/d3dd218a54fe9d62523b395556b51774.jpg" alt="image"><br><br>  <b>4. Digital indicator and shift resistor</b> <br>  For the simultaneous mastering of the dynamic display and the shift register, it was decided to combine them. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fba/6c4/176/fba6c417627c3d34f334d5e460c24275.jpg" alt="image"><br><br>  <b>5. LEDs</b> <br>  LEDs, what could be better?  Only three-color LEDs, where you can master the smooth change of colors. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/135/ca5/535/135ca55353a96f29a08c81335f774694.jpg" alt="image"><br><br>  <b>6. LCD display</b> <br>  Standard LCD display with 2 lines of 16 characters for mastering the parallel interface. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3c1/7ad/1a7/3c17ad1a7859863da4de23990ce20d9c.jpg" alt="image"><br><br>  <b>7. Keyboard</b> <br>  Matrix keyboard, you need to know and be able to. <br><img src="https://habrastorage.org/getpro/habr/post_images/bf3/6f1/2d4/bf36f12d4395a0252ce8b47c239c88e2.jpg" alt="image"><br><br>  <b>8. I / O port extender</b> <br>  There are no many I / O ports, and I2C can also be mastered. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f06/d87/b54/f06d87b549b3dc4cc3d5f389dd673a8c.jpg" alt="image"><br><br>  <b>9. Electronic thermometer</b> <br>  A 1-Wire temperature sensor, a useful thing and valuable experience with it can be useful. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/330/da7/4b8/330da74b8caa386b628da63f51ca2ee2.jpg" alt="image"><br><br>  <b>10. Electronic potentiometer</b> <br>  On this thing you can master the full SPI and try to make measurements of voltage changes through the ADC. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a2/d25/2b8/5a2d252b80b56840635991e659b0648b.jpg" alt="image"><br><br>  <b>11. Relay</b> <br>  Although it is at the level to blink an LED, but it's still nice to hear a familiar click, right? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3dd/bdb/934/3ddbdb934474b69003b7131e29b191a8.jpg" alt="image"><br><br>  <b>12. Key transistors</b> <br>  Also at the level of blinking LED, but suddenly to whom the principle is not clear. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0d1/739/848/0d1739848649933cb4d23e049734675f.jpg" alt="image"><br><br>  <b>13. Duplication of free pins on external outputs</b> <br>  Well, this is a natural design for any debug board, all of a sudden everything that was in it was not useful to anyone, but you still need to connect something. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/960/50d/a6f/96050da6f7b08779c0114c86b02a61b1.jpg" alt="image"><br><br>  <b>14. Converter WIFI-UART (esp8266)</b> <br>  In the circuit, the converter participates as a connector; it is also indicated here.  Already quite sensational esp8266 module is used. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/318/7f3/905/3187f390545b74263886a60ce48a9127.jpg" alt="image"><br><br>  <b>15. USB-UART converter</b> <br>  USB is always cool, here we use CP2102 chip. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/811/e87/80e/811e8780e3c8819b792ef1a79befd9b5.jpg" alt="image"><br><br>  <b>16. JTAG and SWD</b> <br>  Well, where do without these things. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d67/e2c/967/d67e2c96716f57cb62bfee8f90ca3e4c.jpg" alt="image"><br><br>  Such a wide range of external devices will make it possible to master most of the techniques and try to work with most of the interfaces, without bothering to purchase items and without departing from the table, which is consistent with the concept of not only ‚Äúeverything on board‚Äù, but also ‚Äúfor the smallest‚Äù (who cannot solder ). <br><br>  Of course, it didn‚Äôt go without overlays, but, as one familiar engineer says, ‚Äúthe engineer‚Äôs skill is measured in the number of tracks cut on the first iteration of the board‚Äù. <br><br>  Here is a list of my "jambs", something that I did not notice, forgot, or did not even know when designing this board: <br><br>  1. I understood that the SWD pins are arranged in a strange order and at least this does not interfere with the work of the board.  I heard, in my opinion, the correct opinion that they should be placed as they are located on STM32VLDISCOVERY, in order to avoid misunderstandings with the new user. <br><br>  2. So you shouldn‚Äôt connect monochrome LEDs, as on this board, because JTAG needs to be remade for blinking, but the effect of indicating the firmware download process is unexpected for me. <br><br>  3. I designed my logo for this board, which I wanted to transfer to the PCB and place on the board, but I forgot. <br><br>  4. To save space in the second revision of the board, I would place some unused SMD components on the bottom side of the board. <br><br>  5. I understood that for more convenient wiring of circuits with quartz resonators, it would be convenient to replace them with SMD. <br><br>  6. I forgot to sign where JTAG and SWD are, they also don‚Äôt show how to connect them and if everything is not so difficult for JTAG and its BH-20 connector, then the situation with SWD is somewhat more dangerous. <br><br>  7. When designing a footprint of an LCD, an incident came out and the holes were too small for M3 bolts. <br><br>  8. At converter CP2102, pins RX and TX are confused.  Since I‚Äôm used to the fact that the documentation provides an example of the connection with respect to the microcontroller, and not the external device, I had to cut 2 tracks. <br><br>  9. On this board, the distance between the pins is not normalized by inches, and therefore there is a problem for connecting to a bezel-free development board by sticking it into it. <br><br>  10. An overlay came out with current limiting resistors in the indication circuit of the relay, the rating was too large for the relay to switch. <br><br>  11. Well and, as usual, ‚Äúgood thinking comes afterwards.‚Äù  So, after receiving the payment, I realized that it was worth making the size of it suitable even for some kind of body - I would probably have to finalize it in the second revision. <br><br>  12. Initially, a small digital indicator was laid, since it did not occupy a large area and was available in stores, but it turned out that in fact it was everywhere available when ordering from 520 pieces, so I had to sculpt the adapter to a standard digital indicator. <br><br>  Finally, I‚Äôll show you a 3D model of this board: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7c6/848/8e3/7c68488e3e47aa4e1c69df7fabdf405d.jpg" alt="image"><br><br>  And to compare the pictures of her, as she turned out "live", view from the top: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2f4/5dd/e98/2f45dde9867b247c031e56f80fca5fb4.jpg" alt="image"><br><br>  And the view from the side, so that you can see more "crutches": <br><br><img src="https://habrastorage.org/getpro/habr/post_images/769/500/cbe/769500cbe38a2007edf9c3f126695bc1.jpg" alt="image"><br><br>  Sorry, but I would not like to lay out the whole project before passing the diploma, but after this work I had a question, is it worth developing this project?  I was visited by the idea to write a series of articles devoted to learning, where such a complete course on this debug board would be presented, where everything is written in simple words and explained on fingers.  I would like to hear from you in the comments how useful and necessary this is for the present. <br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/259453/">https://habr.com/ru/post/259453/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259439/index.html">Technical Webinar Series: Kerio Connect Performance Optimization</a></li>
<li><a href="../259441/index.html">DevExpress 15.1: what's new and interesting?</a></li>
<li><a href="../259447/index.html">The onset of the era of hyperconvergence</a></li>
<li><a href="../259449/index.html">Windows SSH support by Microsoft</a></li>
<li><a href="../259451/index.html">Why buy monsters? - The practice of domestic import substitution software</a></li>
<li><a href="../259455/index.html">Attackers use Linux / Moose to compromise Linux-embedded systems, part 2</a></li>
<li><a href="../259457/index.html">How did jQuery start</a></li>
<li><a href="../259459/index.html">Understanding x64 support in WPE Pro</a></li>
<li><a href="../259463/index.html">We calculate gamemasters characters in World of Warcraft using Python</a></li>
<li><a href="../259465/index.html">Modeling objects for animation on Canvas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>