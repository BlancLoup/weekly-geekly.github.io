<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CMS architecture</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Having more than enough time, I was carried away by reflections on creating a flexible, multi-functional, but relatively simple CMS for programmers an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CMS architecture</h1><div class="post__text post__text-html js-mediator-article">  Having more than enough time, I was carried away by reflections on creating a flexible, multi-functional, but relatively simple CMS for programmers and its user configurators.  Some ideas were inspired by the potential of CMS Drupal.  And now, fascinated by the realization of ideas and having successful intermediate results, I decided to tell about the architecture of the CMS created.  In the course of reading the overall picture of the capabilities of the CMS should be drawn by itself, at least for programmers :) <br><br><h4>  <b>CMS architecture</b> </h4><br>  The architecture of the created system is based on a modular principle.  CMS is completely built from modules, like a children's house of cubes.  In order to achieve flexibility and ease of interaction between the modules, it was necessary to achieve minimal actions for the use of modules by any component of the system without the need to create rigid connections, as well as to make it possible to easily extend the actions of the modules using other modules. <br><img src="https://habrastorage.org/getpro/habr/post_images/a62/850/daa/a62850daaad8ec3cf8ad233c66339a88.gif" alt="CMS - a set of modules"><a name="habracut"></a><br>  <i>Figure 1. CMS - a set of modules</i> <br><br><h4>  Module </h4><br>  A module in terms of the system being created is a static class whose name is determined by the name of the module.  For the functioning of many modules, a single static class is not enough - additional software structures can be used, which are implemented in separate files.  All module files are located in one directory (folder), and module directories in modules. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/3a2/cdf/cb5/3a2cdfcb59692316c9db51e50fbcc912.gif" alt="CMS file structure"><br>  In the root of the web directory there is an index.php file and a basic configuration file config.php.  When any request to the site, the server executes the index.php file, it is from it that the system begins to function. <br><br><h4>  System System Module </h4><br>  The system module of the System and the configuration file config.php are connected to index.php.  After loading the configuration file, control is transferred to the system module. <br><img src="https://habrastorage.org/getpro/habr/post_images/2f5/416/d09/2f5416d09a9c74b3ee6ca52b82c33fcc.gif" alt="Run system module - cms kernel"><br>  <i>Figure 2. Running the system module - cms kernel</i> <br><br><pre><code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * index.php *   . */</span></span> <span class="hljs-comment"><span class="hljs-comment">//          //  require('modules/system/System.php'); //   require('config.php'); //    System::Process();</span></span></code> </pre> <br>  The system module provides automatic connection of all other modules and is the core of the system, bringing it into execution.  Automatic connection of modules is provided by the php-function __autoload ($ class_name).  This function is defined in the system module file, but outside its class.  When accessing an unloaded class, the PHP interpreter accesses this function; the function, in turn, accesses the system module.  The system module determines the presence of the requested class (module), the location of its php-files and connects them. <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** *    (). *      PHP * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $class_name   (). */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__autoload</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($class_name)</span></span></span></span>{ System::IncludeClass($class_name); }</code> </pre><br><br>  After connecting the class files, the system module automatically calls the static Activate () method of the connected class (if it exists), which allows static classes to be initialized.  Modules, as you remember, are static classes and many need initialization before working. <br><br>  Thus, to use modules, you do not need to pre-declare or connect anything, it is enough to simply refer to the methods or properties of the module class, and you do not need to create references (pointers) to the modules.  This is the principle of simple use of modules by any component of the system. <br><br><h4>  <b>Events</b> module </h4><br>  The Events event module provides the ability for modules to generate events.  Events are generated by calling the <code>Events::Send($module_name, $event_name)</code> method <code>Events::Send($module_name, $event_name)</code> .  Events are handled by static methods of classes of other modules, although nothing prevents the module from processing its own events. <br><br>  The System module of the system does not determine the further functioning of the system, it simply generates three events in turn: ‚Äúinitialization‚Äù (INIT), ‚Äúexecution‚Äù (START) and ‚Äúcompletion‚Äù (STOP). <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Process</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   : //  Events::Send('System', 'INIT'); //  Events::Send('System', 'START'); //   Events::Send('System', 'STOP'); }</span></span></code> </pre><br>  Any module can handle these events and thus participate in the functioning of the system.  But not only the system module generates events.  The figure shows the main system events (circles) and their connections (lines in a strip) with the modules that process events. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c3f/332/ef0/c3f332ef09a4f5bfce258e67bb2ce9c1.gif" alt="Main events"><br>  <i>Fig.</i>  <i>3 Highlights</i> <br><br>  The modules that generate events do not know who handles their events.  Any module can register to handle any event.  Registration for an event is sufficient to do once during the installation (installation) of the module.  The integrity of information about which module has registered for which event is provided by the Event event module.  Below is an example of registering and deleting it on the ‚Äúinitialization‚Äù event (INIT) of the System system module by the Errors error module. <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** *    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Install</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      // : // -,  , -,  - Events::AddHandler('System', 'INIT', 'Errors', 'Process'); } /** *     */ static function UnInstall(){ //       Events::RemoveHandler('System', 'INIT', 'Errors', 'Process'); }</span></span></code> </pre><br>  Application of events allows you to expand the actions of the modules that generate events, or simply respond to the actions of these modules. <br><br>  By the way, remember how modules are loaded - only the first time you access them.  This means that before the START event is generated by the system module, only the System system module and Events event modules, Errors errors and Session sessions will be loaded.  The Errors and Session modules are loaded because they processed the INIT event, and the Events module is loaded, because the system module used it. <br><br><h4>  Error module <b>Errors</b> </h4><br>  The ‚Äúinitialization‚Äù event (INIT) of the system module will first of all process the error module Errors, while it will also automatically load.  The error module overrides standard PHP error and exception handlers.  There is no need to talk about it in detail.  It can be mentioned only that the error module in turn generates events after error handling, which allows, regardless of the cause of the error, to form a clear answer to the user by the modules generating the output, for example, by the Page module. <br><br><h4>  <b>Session Session</b> Module </h4><br>  There is nothing special in the work of the Session sessions module, the module is launched at the system module initialization event, it identifies the user session identifier and then provides access to the session data as the Request request module. <br><br><h4>  <b>Request Request</b> Module </h4><br>  The event ‚Äúexecution‚Äù (START) of the system module is processed by the Request module.  The request module collects all incoming data from the user into a ‚Äúcontainer‚Äù, from which they will be available to any module of the system.  To get data from the "container", you need to specify the format - the type and the size limit of the expected value.  Thus, to some extent the penetration of data that does not meet the requirements of the modules is prevented.  After completion of the process of placing the incoming data in the "container", the query module generates an AFTER event about the completion of its main work. <br><br>  On the user's request, as a rule, it is necessary to form a conclusion - the answer, and send it to the client.  The answer is usually the html page, but it can be a document in a different format, such as XML, or a file, or something else.  Depending on the parameters of the user's request (url'a), one module is defined to form the output, more precisely, each output module itself determines whether it works or not in such a way that in the end only one module is responsible for generating the output.  Output modules begin their work by processing the AFTER event of the Request module, which makes it easy to add new modules to form output in other formats.  In principle, any module can be an output module, if it is at least something to pass to the user. <br><br>  Before forming the output, it is necessary to process the incoming data.  They can be form data that should be saved in the system.  This is done by the Data Data module, handling the AFTER event of the Request module. <br><br>  In the figure, the arrows show the data flow: the user makes a request to the server (transmits data), the received data is processed by the system modules, each module performs its actions with the data, and the result is formed, which is transmitted to the user.  The data is transmitted by direct access to the methods or properties of the module.  The module that receives the data first requests it.  For example, the Data data module, processing the event of the Request module, starts its work and first of all refers to it (to the Request module) for data. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/77b/128/9d4/77b1289d4d5bfcc4944c533d5db38162.gif" alt="Data stream"><br><br>  <i>Fig.</i>  <i>4 Data Flow</i> <br><br><h4>  <b>Data</b> Module </h4><br>  Data module Data - the most important module of the system, it depends on its capabilities flexibility and functional power of the system.  The data module provides data sharing.  Allows them to create, modify, delete, and search with powerful features.  Only the data module accesses the database through the Database module.  To work with data, other modules do not use SQL queries, they use a simple but flexible way of describing query conditions, as well as methods for manipulating data.  A data module based on conditions creates a SQL query to the database and returns data objects.  Having received the ‚ÄúNews‚Äù object, you can, without explicitly referring to the data module, find out everything related to the news ‚Äî even the author of the section to which the news belongs.  Thanks to the data module, the user-configurator (and the system itself) can create its own data classes ‚Äî its own data structures.  This and many other things will be discussed in the next article.  For clarity, I will only add that the data class does not have a direct connection with the class structure of a programming language. <br><br>  The data module also generates events, by processing which you can perform additional actions with data objects when they are saved, read and deleted. <br><br><h4>  <b>Page</b> Pages Module </h4><br>  The module of Page pages, using design templates, forms the html page, which is then sent to the user.  The page is formed from blocks in accordance with the input data - request parameters (url'a).  The page module makes extensive use of the data module, since a page is a representation of data, and many fragments ‚Äî blocks of pages ‚Äî are also data.  The principle of page generation and all the subtleties of the functioning of the module is the topic of one of the following articles. <br><br><h4>  <b>Files</b> and Photo <b>Files</b> Module <b>Image</b> </h4><br>  File and photo modules are one of those modules that complement the actions of the data module.  In addition, the modules of files and photos, when installed in the system, create data classes ‚ÄúFile‚Äù and ‚ÄúPhoto‚Äù, respectively.  After that, when the Data data module works with the objects of these classes, the file or photo modules perform additional actions.  In particular, when creating a data object "File", the file is downloaded to the server and stored in the server file system.  The file module is also the output module.  With appropriate requests, the module transfers files to the user for download, while access control, statistics and everything the system as a whole can do. <br><br>  The main function of the photo module is photo scaling.  Since the photo is a file, it must also be able to upload it to the server, for this the file module is used. <br><br><h4>  <b>Actions</b> Module <b>Actions</b> </h4><br>  The Actions module Actions allows you to classify and control the actions performed by the Data module on objects.  Theoretically, any logical expression can be a condition for performing an action: it can be a check of the current user (its properties), a check of the object on which the action is performed, and more. <br><br>  Example: The Data module of Data loads data from the database and generates a read event that is processed by the Actions module of actions.  The Actions module Actions checks the conditions of this action and calculates the possibility of its execution, the logical result of the calculations is accepted by the Data data module, which simply obeys the result, that is, it continues or finishes reading the data object.  The condition and the action are also data objects.  Understand the intricacies of the module Actions Actions and flexible control actions can be after studying the data module Data. <br><br><h4>  <b>Formats</b> Format Module </h4><br>  The task of the Formats formats module is to provide various formats for values.  For example, for strings, the formats will be representations of e-mail addresses, telephones, formats of formatting (markup).  A format is a data object that is associated with a value object, which determines the format for the value.  The format module does not just provide format objects, it also provides for checking values ‚Äã‚Äãfor compliance with the format.  The check itself occurs when the Data module of the data saves the data object.  Also, some value conversions (text formatting, for example) according to the format occur when reading data.  With the operation of this module, there are still many unresolved issues.  Work continues. <br><br><h4>  Conclusion </h4><br>  I talked about two ways of interaction between modules - using direct access to methods and through event handling.  Other topics covered concerning the functions and purpose of the main modules are considered superficially, only to show a general picture of the functioning of the system. <br><br>  Project site <a href="http://boolive.ru/">http://boolive.ru</a> <br>  Continued: <a href="http://habrahabr.ru/post/53388/">Data Model</a> </div><p>Source: <a href="https://habr.com/ru/post/51152/">https://habr.com/ru/post/51152/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../51143/index.html">Layers - great software</a></li>
<li><a href="../51146/index.html">Do startups need seminars?</a></li>
<li><a href="../51148/index.html">Nine-year schoolboy writes programs for the iPhone</a></li>
<li><a href="../51149/index.html">OmniFocus is a GTD system for your Mac and iPhone. Overview</a></li>
<li><a href="../51151/index.html">Interview with Ken Russel about the new Java plugin</a></li>
<li><a href="../51153/index.html">Installing 1C 7.7 network version on Linux</a></li>
<li><a href="../51154/index.html">New season of fppp. Now with software and gadgets.</a></li>
<li><a href="../51155/index.html">Trackerchecker.org - we follow the registrations on torrent trackers</a></li>
<li><a href="../51158/index.html">Chat with ICQ contacts directly from Gmail.Chat</a></li>
<li><a href="../51159/index.html">Ubuntu for netbooks: HP version</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>