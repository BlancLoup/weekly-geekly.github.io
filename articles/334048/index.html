<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Selenium: for apple lovers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! This is my new article on Selenium. Earlier, I already spoke in detail about the organization of a scalable Selenium cluster ( Part I , Part II...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Selenium: for apple lovers</h1><div class="post__text post__text-html js-mediator-article"><p>  Hello!  This is my new article on Selenium.  Earlier, I already spoke in detail about the organization of a scalable Selenium cluster ( <a href="https://hackernoon.com/selenium-testing-a-new-hope-7fa87a501ee9">Part I</a> , <a href="https://hackernoon.com/selenium-testing-a-new-hope-a00649cdb100">Part II</a> ).  Then we considered the issue of using Selenium as a tool for debugging autotests ( <a href="https://habrahabr.ru/post/327184/">one</a> , <a href="https://habrahabr.ru/post/333568/">two</a> ). Finally, we managed to create order out of chaos on Windows ( <a href="https://habrahabr.ru/post/329256/">link</a> ).  Today we will deal with apples, more precisely with one big Apple (i.e. with Apple). </p><br><img src="https://habrastorage.org/web/b4b/4f1/717/b4b4f17174b84b4fbaf4d7e2b3fbed5d.jpg"><a name="habracut"></a><br><p><br>  Although Selenium is a relatively simple tool, life becomes more complicated when we try to run automated tests in browsers from Cupertino: Safari under MacOS and mobile Safari under iOS.  To fully understand the browsers for desktop operating systems, let's talk today about Safari under MacOS.  Today, the latest versions of Safari are developed only for MacOS.  Historically, work with Safari was implemented in Selenium using a browser extension that translated Selenium commands into internal browser commands.  Initially, the extension was loaded into Safari automatically.  Later, due to a change in security rules in Safari, you had to install the extension once manually.  Finally, with the release of Safari X, everything has changed significantly.  Safari now uses a stand-alone web driver process - <code>safaridriver</code> , similar to <code>chromedriver</code> in Chrome and <code>geckodriver</code> in Firefox.  To run tests in Safari: </p><br><ol><li><p>  Run <code>safaridriver</code> (usually installed with Safari and located in <code>/usr/bin/safaridriver</code> ) on a free port, for example, 4444. The command to run will be this: <br></p><br><pre> <code class="hljs pgsql">$ /usr/bin/safaridriver <span class="hljs-comment"><span class="hljs-comment">--port 4444</span></span></code> </pre> <br></li><li><p>  Run tests using the following Selenium URL: <br></p><br><pre> <code class="hljs objectivec">http:<span class="hljs-comment"><span class="hljs-comment">//localhost:4444/</span></span></code> </pre> <br></li><li>  Stop the running driver process. </li></ol><br><p>  It sounds easy, is not it?  And so it is!  Nevertheless, there is a problem - <code>safaridriver</code> can work with only one copy of Safari in parallel.  How to overcome this limitation?  - Run the driver several times on different ports and run tests on different URLs with these ports.  Simple, but requires a lot of manual work.  Let's automate this process!  How could this work?  That's how: </p><br><img src="https://habrastorage.org/web/b69/26a/80f/b6926a80f56c4917bfa0400110b9dc42.png"><br><ol><li>  You start the server that provides the Selenium API and tell it at the start where the <code>safaridriver</code> is located. </li><li>  When a request comes in for a new session, the running server searches for a free port and occupies it.  Then it starts the <code>safaridriver</code> process on this port and proxies all subsequent requests to the same place. </li><li>  When a request comes in to close a session, the <code>safaridriver</code> process also stops. </li></ol><br><p>  The described algorithm is very simple, so it should not require the development of a complex server, is it?  If you take as a server the current standard - the Selenium server, then you will use an overly complex tool for such a simple task.  Why is this so: </p><br><ol><li>  Selenium server - huge as an elephant!  The size of the distribution starts from 20 MB. </li><li>  It requires installing Java - another giant creature in your zoo.  With all sorts of pop-up windows about the update and the graphical interface of the 90s. </li><li>  He is always hungry and eats memory for no reason. </li><li>  It is rather poorly documented and does not work out of the box.  You need to be a wizard to make it work. </li></ol><br><p>  In short, let me show you a more suitable tool - <a href="https://github.com/aerokube/selenoid">Selenoid</a> .  Selenoid is a lightweight daemon, created to completely replace the fat Selenium server.  Getting Selenoid with Safari is easy: </p><br><ol><li><p>  Copy the slice of JSON below to a file (for example, in <code>~/browsers.json</code> ): </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"safari"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"default"</span></span>: <span class="hljs-string"><span class="hljs-string">"latest"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"versions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"latest"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"image"</span></span>: [<span class="hljs-string"><span class="hljs-string">"/usr/bin/safaridriver"</span></span>] } } } }</code> </pre> <br></li><li><p>  Launch and download the Selenoid executable: <br></p><br><pre> <code class="hljs ruby">$ curl -Lo ~<span class="hljs-regexp"><span class="hljs-regexp">/selenoid \ https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/github.com/aerokube</span></span><span class="hljs-regexp"><span class="hljs-regexp">/selenoid/releases</span></span><span class="hljs-regexp"><span class="hljs-regexp">/download/</span></span><span class="hljs-number"><span class="hljs-number">1.3</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>/selenoid_darwin_amd64 $ chmod +x ~<span class="hljs-regexp"><span class="hljs-regexp">/selenoid $ ~/selenoid</span></span> -conf ~<span class="hljs-regexp"><span class="hljs-regexp">/browsers.json -disable-docker</span></span></code> </pre> <br></li><li>  Run tests using URL: <br><br><pre> <code class="hljs objectivec">http:<span class="hljs-comment"><span class="hljs-comment">//localhost:4444/wd/hub</span></span></code> </pre> </li></ol><br><p>  No longer need to install Java and company!  But if you, like me, do not want to do this with your hands, you can get a similar result using a single-line script: </p><br><pre> <code class="hljs ruby">$ curl -Lo ~<span class="hljs-regexp"><span class="hljs-regexp">/cm https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/github.com/aerokube</span></span><span class="hljs-regexp"><span class="hljs-regexp">/cm/releases</span></span><span class="hljs-regexp"><span class="hljs-regexp">/download/</span></span><span class="hljs-number"><span class="hljs-number">1.2</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>/cm_darwin_amd64 &amp;&amp; \ chmod +x ~<span class="hljs-regexp"><span class="hljs-regexp">/cm &amp;&amp; \ ~/cm</span></span> selenoid start --browsers safari</code> </pre> <br><p>  If you wish, you can also download and run the lightweight UI for Selenoid.  Read more about this in the <a href="http://aerokube.com/selenoid-ui/latest/">documentation</a> . </p><br><p>  Simple Selenium testing in Safari has never been this close.  Have a nice day! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/334048/">https://habr.com/ru/post/334048/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334034/index.html">Testing in Badoo ‚Äúfrom the height of bird flight‚Äù</a></li>
<li><a href="../334038/index.html">Configure push notifications for your service</a></li>
<li><a href="../334042/index.html">Gamecube - file system device</a></li>
<li><a href="../334044/index.html">Comparison of Russian cloud service operators</a></li>
<li><a href="../334046/index.html">How to teach your neural network to generate poems</a></li>
<li><a href="../334050/index.html">How do we in 1C: Enterprise work with data models (or ‚ÄúWhy do we not work with tables?‚Äù)</a></li>
<li><a href="../334052/index.html">1.Check Point to the maximum. The human factor in information security</a></li>
<li><a href="../334054/index.html">Evolution of web application attacks</a></li>
<li><a href="../334056/index.html">Dismissal is a little death. How to save a valuable specialist who decided to quit?</a></li>
<li><a href="../334058/index.html">The power of minimalism in UX design</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>