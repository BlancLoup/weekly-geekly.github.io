<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>complicate the iPhone app</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="let's complicate a little our application which displayed the habr logo. 

 I will use the iPhone SDK beta 4, the project from beta 2 came up and comp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>complicate the iPhone app</h1><div class="post__text post__text-html js-mediator-article">  let's complicate a little our application which displayed the habr logo. <br><br>  I will use the iPhone SDK beta 4, the project from beta 2 came up and compiled.  If there are problems with the compilation of the project - write in kamentah. <br><a name="habracut"></a><br><h1>  multitouch </h1><br>  Let's get started  Let's make it so that when you touch and hold a finger, the Habr logo moves after the finger, and when you touch it with two fingers and change their positions, the logo will scale. <br><br>  First, let's connect the header file math.h to the MyView.m file.  Next, in the constructor of the MyView class - - (id) initWithFrame: (CGRect) frame in the if block, we add two lines: <br><blockquote>  [self setMultipleTouchEnabled: YES]; <br>  [habrView setMultipleTouchEnabled: YES]; </blockquote><br>  as you can see, we explicitly indicate that we want our UIView and UIImageView, which contains the Habr logo, to support several touches. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now regarding touch processing.  The following touch handlers are defined in the UIView class: <br>  - (void) touchesBegan: (NSSet *) touches withEvent: (UIEvent *) event; <br>  - (void) touchesMoved: (NSSet *) touches withEvent: (UIEvent *) event; <br>  - (void) touchesEnded: (NSSet *) touches withEvent: (UIEvent *) event; <br>  - (void) touchesChangedWithEvent: (UIEvent *) event; <br>  - (void) touchesCancelled; <br>  proceeding from their names it is not difficult to guess in what case what to use <br><br>  We define two global variables (they do not need to be entered into the header file): CGPoint startLoc0, startLoc1.  We will store the points of initial touches in them if there are two touches. <br><br>  Now we define the touch start processing function: <br><blockquote>  - (void) touchesBegan: (NSSet *) touches withEvent: (UIEvent *) event { <br>  if ([touches count] == ‚Äã‚Äã2) { <br>  startLoc0 = [[[touches allObjects] objectAtIndex: 0] locationInView: self]; <br>  startLoc1 = [[[touches allObjects] objectAtIndex: 1] locationInView: self]; <br>  if (startLoc0.x == startLoc1.x) startLoc0.x + = 0.05; <br>  if (startLoc0.y == startLoc1.y) startLoc0.y + = 0.05; <br>  } <br>  } </blockquote><br>  Now we define the function of changing the position of the touches: <br><blockquote>  - (void) touchesMoved: (NSSet *) touches withEvent: (UIEvent *) event { <br>  if ([touches count] == ‚Äã‚Äã1) { <br>  UITouch * touch = [touches anyObject]; <br>  if ([touch view] == habrView) { <br>  CGPoint location = [touch locationInView: self]; <br>  [habrView setCenter: location]; <br>  } <br>  } <br>  else if ([touches count] == ‚Äã‚Äã2) { <br>  UITouch * touch0 = [[touches allObjects] objectAtIndex: 0]; <br>  UITouch * touch1 = [[touches allObjects] objectAtIndex: 1]; <br>  CGPoint loc0 = [touch0 locationInView: self]; <br>  CGPoint loc1 = [touch1 locationInView: self]; <br>  CGFloat scaleX = fabs ((loc0.x - loc1.x) / (startLoc0.x - startLoc1.x)); <br>  CGFloat scaleY = fabs ((loc0.y - loc1.y) / (startLoc0.y - startLoc1.y)); <br>  [habrView setTransform: CGAffineTransformMakeScale (scaleX, scaleY)]; <br>  } <br>  else <br>  NSLog (@ "too many touches :("); <br>  } </blockquote><br>  In the case of one touch, simply transfer the image to the touch point.  In the case of two touches, I calculate the stretch ratio.  I chose my method of calculating coefficients, if you have other ideas about the calculation, then write in kamentah. <br>  To scale the image, I used the setTransform: function, which as a parameter receives the affine transformation matrix.  It is worth noting that when using the CGAffineTransformMakeScale function, the final image will be stretched by coefficients based on its initial size, not the current one. <br><br>  But now the main question remains: how to simulate several simultaneous touches on the emulator?  As a result of zaguhlivaniya it turned out that it is enough to hold down the Option button. <br><br>  Run and enjoy the result: <br><img src="https://habrastorage.org/getpro/habr/olpictures/920/12a/7bc/92012a7bc6d7c16a27d68556c05357c2.png" width="385" height="735" hspace="10" vspace="10"><br><br><h1>  splash screen </h1><br>  Add another little thing called splash screen.  Splash screen is a picture that will be displayed immediately after clicking on the program icon and before the end of the function - (void) applicationDidFinishLaunching: (UIApplication *) application.  Useful if you want to display brief information about the program, manufacturer, version, etc. <br>  To add a splash screen to the program, just add a file called Default.png to the png project.  It is naturally better that the image was with the same resolution as the iPhone screen. <br><br><h1>  application suspend </h1><br>  As everyone knows, using the SDK you can not create applications that run in the background.  But this does not mean that when you click on the Home button, your application closes.  You can override certain functions in the UIApplication class and tell the program to use the overridden class. <br><br>  Create a new Objective-C class, let's call it ApplicationSuspend, this class will be the successor of the UIApplication class. <br><br>  The contents of the h file should be: <br><blockquote>  #import &lt;UIKit / UIKit.h&gt; <br>  <a href="http://habrahabr.ru/users/interface/" class="user_link">interface</a> ApplicationSuspend: UIApplication { <br>  } <br>  <a href="http://habrahabr.ru/users/end/" class="user_link">end</a> </blockquote><br><br>  The contents of the m file should be as follows: <br><blockquote>  #import "ApplicationSuspend.h" <br>  @implementation ApplicationSuspend <br>  - (void) applicationSuspend: (struct __GSEvent *) event { <br>  } <br>  <a href="http://habrahabr.ru/users/end/" class="user_link">end</a> </blockquote><br><br>  As you can see, just defined the function applicationSuspend.  This is enough so that when you click on the Home button, the program goes into suspend, and when you click on the icon, it returns. <br><br>  You can also override the applicationResume: functions, menuButtonUp :, menuButtonDown :, launchApplicationWithIdentifier: suspended :. <br>  I did not find the description of what can be done this way in the off documentation, but I found it <a href="http://www.cocoadev.com/index.pl%3FUIApplication">here</a> .  But while beta is in the iPhone SDK, it can be forgiven. <br><br>  And now the most important thing is how to tell the program to use the modified UIApplication? <br>  Open the main.m file and find the line: <br>  int retVal = UIApplicationMain (argc, argv, nil, @ "HelloHabrAppDelegate"); <br>  as you can see, the third parameter is set to nil, here‚Äôs the name of the class we changed: <br>  int retVal = UIApplicationMain (argc, argv, @ "ApplicationSuspend", @ "HelloHabrAppDelegate"); <br><br>  If everything was done correctly, then run the program, move the habr logo, click on Home and then log in again, the logo should remain in the same place. <br><br>  Project file <a href="http://narod.ru/disk/896156000/HelloHabr.zip.html">here</a> </div><p>Source: <a href="https://habr.com/ru/post/27343/">https://habr.com/ru/post/27343/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273421/index.html">We become professional PHP developers. Part 1: Missing Link</a></li>
<li><a href="../273423/index.html">Children and parents on the web: the story of hacking services VTech</a></li>
<li><a href="../273425/index.html">Quickly raised is not considered to be dropped. Increase resiliency of embedded systems</a></li>
<li><a href="../273427/index.html">Unit Tests in ABAP</a></li>
<li><a href="../273429/index.html">Development of plug-ins for Atlassian JIRA</a></li>
<li><a href="../273431/index.html">Learn English with Scala on Future and Actor</a></li>
<li><a href="../273433/index.html">Primary values ‚Äã‚Äãof the secondary market. Arguments and Facts</a></li>
<li><a href="../273435/index.html">Oracle Database 12c: Performance Tuning</a></li>
<li><a href="../273437/index.html">Security Week 51: Zero Day in Joomla, Twitter warns MacKeeper database leak</a></li>
<li><a href="../273439/index.html">On the open data of the Federal Treasury. Report to the next public council in February 2016</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>