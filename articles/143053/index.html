<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Monitoring Asterisk Status with MonAst</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The search for a convenient solution for monitoring multiple Asterisk servers led to a wonderful tool: 


 Opportunity inspection 
 MonAst is position...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Monitoring Asterisk Status with MonAst</h1><div class="post__text post__text-html js-mediator-article">  The search for a convenient solution for monitoring multiple Asterisk servers led to a wonderful tool: <br><img src="https://habrastorage.org/getpro/habr/post_images/e2d/6dd/7b5/e2d6dd7b55584e0dc83e052e6e468974.jpg" alt="Monast Logo"><br><br><h4>  Opportunity inspection </h4><br>  MonAst is positioned by developers as a monitoring tool that acts as an operator panel for Asterisk.  Distributed under BSD license.  The project is written using Python (daemon to communicate with Asterisk by AMI), PHP, JS (AJAX). <br><a name="habracut"></a><br>  From the viewing options (in real-time mode) - the following: <br><ul><li>  Work with multiple servers (by switching between them) </li><li>  Multi-user mode with access rights </li><li>  Mapping users and peers (SIP, IAX, DAHDI, Khomp, etc ...) </li><li>  Display active channels and calls (with channel name and CallerID) </li><li>  Conference channels (with the display of connected users) </li><li>  Parked Calls </li><li>  Queues (with statistics, attendees and pending customers) </li></ul><br>  Of the possibilities of operations: <br><ul><li>  Making (initiating) calls </li><li>  Call Transfer </li><li>  Reset calls </li><li>  Call parking </li><li>  Listening to calls (Spy Calls) </li><li>  Inviting participants to the conference </li><li>  Deleting conference participants </li><li>  Add users (or peers) as a member of any queue </li><li>  Remove participants from the queue </li><li>  Statement and removal from a pause of participants of queue </li><li>  CLI command execution </li></ul><br>  As you can see - the list of possibilities is quite extensive. <br><br><h4>  Installation </h4><br>  Experimental system, we will have a clean Ubuntu 10.10 with basic programs and updates.  MonAst does not have to be installed on a host with Asterisk.  I, for example, have MonAst locally on a laptop - and I perfectly monitor all our 6 servers with Asterisk. <br>  Before you start installing MonAst - let's go over the requirements. <br>  Since the daemon through which the exchange between Asterisk and MonAst (using the Asterisk Manager API AMI) is written in Python, we first check its presence in the system: <br><pre><code class="bash hljs">it@ubuntu-test ~ $ python --version Python 2.6.6</code> </pre> <br>  If we see something like this, then everything is in order.  If for some reason it is not - execute the command: <br><pre> <code class="bash hljs">it@ubuntu-test ~ $ sudo apt-get update &amp;&amp; sudo apt-get install python</code> </pre><br>  Moving on. <br>  Since all this will be displayed via the web-interface, you need to have an http server installed with php support, as well as php-pear.  If this kit did not previously exist - execute the command (in addition we put mc - for ease of navigation and editing): <br><pre> <code class="bash hljs">it@ubuntu-test ~ $ sudo apt-get install apache2 php5 php-pear mc</code> </pre><br>  And finally - installing dependencies for the product under discussion.  This list is small with us: <br><ol><li>  Twisted Python 10.1+ </li><li>  zope.interface 3.6+ </li><li>  Starpy SVN-Trunk </li><li>  PHP PEAR Packages: (HTTP_Client) </li></ol><br>  The zope.interface package was already in the system (was available out of the box). <br>  Put the HTTP_Client package: <br><pre> <code class="bash hljs">it@ubuntu-test:/usr/src$ sudo pear install HTTP_Client WARNING: <span class="hljs-string"><span class="hljs-string">"pear/HTTP_Client"</span></span> is deprecated <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> favor of <span class="hljs-string"><span class="hljs-string">"pear/HTTP_Request2"</span></span> WARNING: channel <span class="hljs-string"><span class="hljs-string">"pear.php.net"</span></span> has updated its protocols, use <span class="hljs-string"><span class="hljs-string">"pear channel-update pear.php.net"</span></span> to update WARNING: <span class="hljs-string"><span class="hljs-string">"pear/HTTP_Request"</span></span> is deprecated <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> favor of <span class="hljs-string"><span class="hljs-string">"pear/HTTP_Request2"</span></span> WARNING: <span class="hljs-string"><span class="hljs-string">"pear/Net_URL"</span></span> is deprecated <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> favor of <span class="hljs-string"><span class="hljs-string">"pear/Net_URL2"</span></span> downloading HTTP_Client-1.2.1.tgz ... Starting to download HTTP_Client-1.2.1.tgz (10,202 bytes) .....<span class="hljs-keyword"><span class="hljs-keyword">done</span></span>: 10,202 bytes downloading HTTP_Request-1.4.4.tgz ... Starting to download HTTP_Request-1.4.4.tgz (17,109 bytes) ...<span class="hljs-keyword"><span class="hljs-keyword">done</span></span>: 17,109 bytes downloading Net_URL-1.0.15.tgz ... Starting to download Net_URL-1.0.15.tgz (6,303 bytes) ...<span class="hljs-keyword"><span class="hljs-keyword">done</span></span>: 6,303 bytes downloading Net_Socket-1.0.10.tgz ... Starting to download Net_Socket-1.0.10.tgz (5,429 bytes) ...<span class="hljs-keyword"><span class="hljs-keyword">done</span></span>: 5,429 bytes install ok: channel://pear.php.net/Net_URL-1.0.15 install ok: channel://pear.php.net/Net_Socket-1.0.10 install ok: channel://pear.php.net/HTTP_Request-1.4.4 install ok: channel://pear.php.net/HTTP_Client-1.2.1</code> </pre><br>  As you can see, during the installation process it says that the package is outdated and offers to install a newer one: <br><pre> <code class="bash hljs">it@ubuntu-test:/usr/src$ sudo pear install HTTP_Request2</code> </pre><br>  Packages Twisted and StarPy will be installed from source.  But during the installation, dependencies also emerged, which we are fixing (in passing, we will switch to superuser mode): <br><pre> <code class="bash hljs">it@ubuntu-test:~$ sudo su root@ubuntu-test:~$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /usr/src/ root@ubuntu-test:/usr/src<span class="hljs-comment"><span class="hljs-comment"># wget http://pypi.python.org/packages/source/T/Twisted/Twisted-12.0.0.tar.bz2#md5=cf49a8676c21c50faf1b42b528049471 root@ubuntu-test:/usr/src# wget http://downloads.sourceforge.net/project/starpy/starpy/1.0.0a13/starpy-1.0.0a13.tar.gz root@ubuntu-test:/usr/src# tar -xvf Twisted-12.0.0.tar.bz2 root@ubuntu-test:/usr/src# tar -xvf starpy-1.0.0a13.tar.gz root@ubuntu-test:/usr/src# apt-get install build-essential gcc-4.5 libssl-dev python-dev root@ubuntu-test:/usr/src# cd Twisted-12.0.0 root@ubuntu-test:/usr/src/Twisted-12.0.0# python setup.py install</span></span></code> </pre><br>  If we see the inscription " <i>Finished processing dependencies for Twisted == 12.0.0</i> " - then the installation was successful and go on.  If an error pops up, then rather some component is missing.  Check the list - are all dependencies installed?  Go ahead: <br><pre> <code class="bash hljs">root@ubuntu-test:/usr/src/Twisted-12.0.0<span class="hljs-comment"><span class="hljs-comment"># cd .. root@ubuntu-test:/usr/src# cd starpy-1.0.0a13 root@ubuntu-test:/usr/src/starpy-1.0.0a13# python setup.py install root@ubuntu-test:/usr/src/starpy-1.0.0a13# cd ..</span></span></code> </pre><br>  Well, the main hero of the occasion.  At the time of writing, the current version is 3.0b4: <br><pre> <code class="bash hljs">root@ubuntu-test:/usr/src<span class="hljs-comment"><span class="hljs-comment"># wget http://downloads.sourceforge.net/project/monast/Monast%20for%20Asterisk%201.4%2C%201.6%20and%201.8/3.0b4/monast-3.0b4.tar.gz root@ubuntu-test:/usr/src# tar -xvf monast-3.0b4.tar.gz root@ubuntu-test:/usr/src# cd monast-3.0b4 root@ubuntu-test:/usr/src/monast-3.0b4# ./install.sh</span></span></code> </pre><br>  During the installation process, the script will ask a couple of questions regarding the paths.  If the options offered to them suit - we agree.  Otherwise we register our data.  I just changed the way where the .php files go <br> <code>MonAst HTML path [/var/www/html/monast]: /var/www/asterisk/monast/ <br></code> <br>  It may seem that the installation is complete.  But it was not there.  The startup script /etc/init.d/monast is set only for SuSE, RedHat, Debian, Gentoo, Slackware, FreeBSD systems.  But not Ubuntu and the like.  Therefore, copy the script from Debian and add it to the autoload: <br><pre> <code class="bash hljs">root@ubuntu-test:/usr/src/monast-3.0b4<span class="hljs-comment"><span class="hljs-comment"># cp contrib/init.d/rc.debian.monast /etc/init.d/monast root@ubuntu-test:/usr/src/monast-3.0b4# chmod 755 /etc/init.d/monast root@ubuntu-test:/usr/src/monast-3.0b4# update-rc.d monast defaults 91 60</span></span></code> </pre><br>  Now the installation is over.  You can proceed to the setting. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Customization </h4><br>  First of all, you need to configure Asterisk itself so that the sabzhevo software can successfully connect and exchange information.  On the server with Asterisk, click the path <i>/ etc / asterisk /</i> and edit the file <i>manager.conf</i> .  If there are several servers, we make such corrections for the necessary ones. <br><pre> <code class="bash hljs">root@asterisk ~ $ mcedit /etc/asterisk/manager.conf</code> </pre><br><pre> <code class="hljs pgsql">; ; AMI - The Asterisk Manager Interface ; [general] enabled = yes ;  AMI port = <span class="hljs-number"><span class="hljs-number">5038</span></span> ; ,        MonAst bindaddr = <span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> ;         displayconnects = yes ;    Asterisk    webenabled = <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> ;    Asterisk static_http allowmultiplelogin = yes ;            . timestampevents = yes ;      ; <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> ;       AMI [monast_user] secret=qwerty123 ;    deny=<span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">0.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> ;      permit=<span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>/<span class="hljs-number"><span class="hljs-number">255.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> ;     permit=<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.10</span></span>/<span class="hljs-number"><span class="hljs-number">255.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> ;     permit=<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">255.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> ;       writetimeout=<span class="hljs-number"><span class="hljs-number">100</span></span> ;     ;    .   <span class="hljs-keyword"><span class="hljs-keyword">all</span></span>,    <span class="hljs-keyword"><span class="hljs-keyword">read</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">call</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">verbose</span></span>,command,agent,<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>,config,originate,reporting <span class="hljs-keyword"><span class="hljs-keyword">write</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">call</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>,<span class="hljs-keyword"><span class="hljs-keyword">verbose</span></span>,command,agent,<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>,config,originate,reporting</code> </pre><br>  After that, we will reload the Asterisk configuration for the manager module: <br><pre> <code class="bash hljs">root@asterisk$ asterisk -rx <span class="hljs-string"><span class="hljs-string">"manager reload"</span></span></code> </pre><br>  This completes the Asterisk setup.  Go to the configuration of the MonAst'a. <br>  The file with the parameters is located on the path <i>/etc/monast.conf</i> .  Him and rule.  I will say in advance that there were no difficulties in setting up, the comments in the file clearly describe this or that parameter.  But for example, give my sample file <br><pre> <code class="bash hljs">root@ubuntu-test:/usr/src/monast-3.0b4<span class="hljs-comment"><span class="hljs-comment"># cd /etc/ root@ubuntu-test:/etc# mcedit monast.conf</span></span></code> </pre><br><pre> <code class="hljs pgsql"># Copyright (c) <span class="hljs-number"><span class="hljs-number">2008</span></span><span class="hljs-number"><span class="hljs-number">-2011</span></span>, Diego Aguirre # <span class="hljs-keyword"><span class="hljs-keyword">All</span></span> rights reserved. ## ## <span class="hljs-keyword"><span class="hljs-keyword">Global</span></span> Section ## [<span class="hljs-keyword"><span class="hljs-keyword">global</span></span>] # Bind client connetions <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> host:port bind_host = <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> ;      bind_port = <span class="hljs-number"><span class="hljs-number">5039</span></span> ;     . # Use client autentication <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> browser auth_required = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ;     ## =================================== ## ## Servers Definitions ## [<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>: Server1] ;     hostname = <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> hostport = <span class="hljs-number"><span class="hljs-number">5038</span></span> username = monast_user <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = qwerty123 # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> context default_context = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> # Context <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> use <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> transfer calls transfer_context = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> # Context <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> prefix <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> meetme meetme_context = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> meetme_prefix = [<span class="hljs-keyword"><span class="hljs-keyword">server</span></span>: Server2] ;     hostname = <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> hostport = <span class="hljs-number"><span class="hljs-number">5038</span></span> username = monast_user <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = qwerty123 # <span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> context default_context = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> # Context <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> use <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> transfer calls transfer_context = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> # Context <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> prefix <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> meetme meetme_context = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> meetme_prefix = ## =================================== ## ## Peers Definitions ## [peers] # sort peers (<span class="hljs-keyword"><span class="hljs-keyword">options</span></span>: channel, callerid) sortby = callerid # <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">show</span></span>/hide default = <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> # hide peer <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> default = <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/SIP/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span> = hide # <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> peer <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> default = hide ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/SIP/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">always</span></span> <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> peer. ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/SIP/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span><span class="hljs-number"><span class="hljs-number">-3</span></span> = force # force CallerID (<span class="hljs-keyword"><span class="hljs-keyword">only</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> forced mode) ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/SIP/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span><span class="hljs-number"><span class="hljs-number">-4</span></span> = force,Diego Aguirre &lt;<span class="hljs-number"><span class="hljs-number">5555</span></span>&gt; # <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> peer <span class="hljs-keyword"><span class="hljs-keyword">groups</span></span> ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/@<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">Group</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> = SIP/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>,SIP/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span><span class="hljs-number"><span class="hljs-number">-2</span></span> ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/@<span class="hljs-keyword"><span class="hljs-keyword">group</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">Group</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> = SIP/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span><span class="hljs-number"><span class="hljs-number">-3</span></span>,SIP/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span><span class="hljs-number"><span class="hljs-number">-4</span></span> ## =================================== ## ## Meetmes / Conferences Definitions ## [meetmes] # <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">show</span></span>/hide default = hide # hide meetme <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> default = <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/<span class="hljs-number"><span class="hljs-number">1234</span></span> = hide # <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> meetme <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> default = hide ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/<span class="hljs-number"><span class="hljs-number">1234</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">always</span></span> <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> meetme ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/<span class="hljs-number"><span class="hljs-number">1234</span></span> = force ## =================================== ## ## Queues Definitions ## [queues] # defualt <span class="hljs-keyword"><span class="hljs-keyword">show</span></span>/hide default = hide # <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> queue queue01 ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/queue01 = <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> queue queue02 <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> display <span class="hljs-type"><span class="hljs-type">name</span></span> Support ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/queue02 = <span class="hljs-keyword"><span class="hljs-keyword">show</span></span>,Support # hide queue queue03 ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/queue03 = hide # Map Member <span class="hljs-type"><span class="hljs-type">name</span></span> ;&lt;<span class="hljs-keyword"><span class="hljs-keyword">Server</span></span> <span class="hljs-type"><span class="hljs-type">Name</span></span>&gt;/@member/SIP/<span class="hljs-keyword"><span class="hljs-keyword">user</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span> = Diego Aguirre &lt;<span class="hljs-number"><span class="hljs-number">5555</span></span>&gt; ## =================================== ## Define users <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> roles <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> use <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> auth_required <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ## roles must be: ## originate : <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> can originate, transfer, park <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> calls ## agent : <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> cans <span class="hljs-keyword"><span class="hljs-keyword">add</span></span>, remove, pause <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> unpause members <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> queues ## command : <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> can <span class="hljs-keyword"><span class="hljs-keyword">execute</span></span> asterisk cli commands ## spy : <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> can <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> a spy [<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span>] ; - secret = SuperPuperDruper roles = originate,queue,command,spy servers = <span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: manager] ;      ()  secret = <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> roles = originate servers = <span class="hljs-keyword"><span class="hljs-keyword">ALL</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: server1] ;      ()  secret = <span class="hljs-number"><span class="hljs-number">12345</span></span> roles = originate servers = Server1 [<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: server2] ;          ()  secret = <span class="hljs-number"><span class="hljs-number">54321</span></span> roles = originate,command servers = Server2</code> </pre><br>  Save the changes and reboot the daemon: <br><pre> <code class="bash hljs">root@ubuntu-test:/etc<span class="hljs-comment"><span class="hljs-comment"># /etc/init.d/monast restart</span></span></code> </pre><br>  Everything.  You can connect and check.  Open the browser and type in the address bar: <a href="http://localhost/asterisk/monast/">http: // localhost / asterisk / monast /</a> <br>  If you put " <i>auth_required = true</i> " then enter the login, password - and enjoy the work tool :) <br><img src="https://habrastorage.org/getpro/habr/post_images/18a/113/048/18a113048d6b19e2fc86e1d6ce1294d3.jpg" alt="MonAst Mixed Pannels"><br>  Important note.  In the ‚Äúwithout authentication‚Äù mode, all those who work in the MonAst operator panel have full rights, i.e.  are "super users".  And as we know, ‚ÄúWeapons given in unskillful hands can harm‚Äù.  Be careful. <br>  Also in the <i>/var/www/asterisk/monast/lib/config.php</i> file there are the address and port parameters where the monast.py daemon is running, the settings for displaying <i>debug</i> and <i>cli tabs</i> , as well as some equally interesting parameters. <br>  Feature Overview <br>  Now let's go over the possibilities of this software. <br>  After logging in to the web-interface, we see several tabs.  And to be more precise: <br><ul><li>  Mixed Pannels - Tab with almost all sections at once.  Convenience lies in the fact that you can display only the necessary and, without switching, to see the necessary information in one place. </li><li>  Peers / Users - View and manage access points and users. </li><li>  Meetme Rooms - View and manage conferences </li><li>  Channels / Calls - View and manage active calls and raised channels. </li><li>  Parked Calls - View and manage parked calls </li><li>  Queues - View and manage your call queue </li><li>  Asterisk CLI - Asterisk Command Prompt.  If the user has the rights to execute commands in the console, then it is here that you can enter something similar to the ‚Äúcore show version‚Äù :) </li></ul><br>  Understanding the possibilities is not difficult and, perhaps, it will be even better if you yourself run and try out the available functions - so you will clearly understand what works.  But I still describe a couple of interesting ones :) <br>  <i>Origin call (call initiation)</i> .  It is clear from the function name - it is possible to connect an extension to any number (if it, the number, can be handled by your dial plan).  To perform the function, you need to right-click (hereinafter referred to as PCM) on the account you need and select the corresponding item.  In the window that appears, enter the desired number and, voila - the telephone is ringing at the selected person, he picks up the phone and Asterisk connects it with the number we have displayed.  You can also drag one account to another with the mouse, and by agreeing to initiate a connection between them. <br>  <i>Meetme Rooms (conference room)</i> .  Going to this section, you can manage already created conferences, or create a new one and invite certain participants there.  To create your conference, go to the appropriate section, click ‚Äú <i>Create Dynamic Meetme</i> ‚Äù and enter the requested information in the window.  Clicked "Ok" - and the process went, went :) <br>  <i>Spy (listen to the call)</i> .  What she does?  From the name you can understand - it allows you to connect to the selected conversation and listen to the speech stream.  The function can be useful when used in call-centers for monitoring and checking agents.  In the process of conversation, the interlocutors do not even suspect about the fact of listening.  At least I, testing this opportunity, did not hear any signal or notification.  In order for the user of the panel to have the right to listen - you need to have <i>spy</i> in the <i>roles</i> field of his access rights.  Therefore, in order to restrict the use of this function with bad intent - enable authentication to access the panel and grant the rights to use it only to trusted users.  Head of the department, for example :) <br><br><h4>  Conclusion </h4><br>  MonAst, as well as alternative projects with similar functionality (FOP, Links, etc.) clearly has a right to exist and, accordingly, use in the workflow. <br>  Ease of use, relative ease of installation and configuration, monitoring multiple servers from one location - all this, in most cases, will be more than enough. <br><h4>  Links </h4><br><ul><li>  Official site of the project: <a href="http://monast.sourceforge.net/">http://monast.sourceforge.net/</a> </li><li>  Twisted Python project page: <a href="http://twistedmatrix.com/">http://twistedmatrix.com</a> </li><li>  Starpy for Twisted project page: <a href="http://sourceforge.net/projects/starpy/">http://sourceforge.net/projects/starpy/</a> </li></ul><br><br>  UPD: Fixed a couple of annoying errors in the text. </div><p>Source: <a href="https://habr.com/ru/post/143053/">https://habr.com/ru/post/143053/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143048/index.html">A tweet about a XSS bug on Google+ led to XSS on the InformationWeek website</a></li>
<li><a href="../143049/index.html">Opera Mini - 169 million users</a></li>
<li><a href="../143050/index.html">Nokia sells Vertu</a></li>
<li><a href="../143051/index.html">Another cloud storage - LG Cloud</a></li>
<li><a href="../143052/index.html">IconBIT NetTAB MATRIX: review and test of an affordable IPS screen tablet</a></li>
<li><a href="../143055/index.html">Multithreaded QuickSort in C ++ 2011</a></li>
<li><a href="../143056/index.html">Cloud cannot be read</a></li>
<li><a href="../143057/index.html">Would you hire a programmer without IT education?</a></li>
<li><a href="../143058/index.html">Onion Browser for iOS 5.0 browser works with TOR</a></li>
<li><a href="../143059/index.html">Black-Scholes model: a formula that changed the stock market</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>