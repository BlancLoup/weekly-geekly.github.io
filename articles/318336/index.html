<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating custom go-profiles with pprof. Remember stacks</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Shot from the series "Colombo" 

 Go-shny pprof package is often used to profile a processor or memory, but not everyone knows about the ability to cr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating custom go-profiles with pprof. Remember stacks</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a1f/fbd/e49/a1ffbde493724bcd9b86687b10ac4440.jpg"><br>  <i>Shot from the series "Colombo"</i> <br><br>  Go-shny pprof package is often used to profile a processor or memory, but not everyone knows about the ability to create your own custom profiles.  They can be useful for searching for resource leaks or, for example, for tracking the abuse of some heavy challenges. <br><a name="habracut"></a><br><h2>  Profiles </h2><br>  From the <a href="https://golang.org/pkg/runtime/pprof/">pprof documentation</a> : <br><blockquote>  A profile is a set of stack traces, showing the order of calls that led to an event.  For example, memory allocation.  Packages can create and maintain their own profiles.  The most common reason is to monitor any resources that require explicit closure: files, network connections. </blockquote><br>  Another potential use of profiles can be tracking not something that needs to be explicitly closed, but a function or resource that can block execution when a call is made, and you need to understand where such calls are, how many there are, and so on.  Profiles are especially useful where stack traces are useful, and the main advantage is simple integration with the go tool pprof. <br><br><h2>  Cautions when using profiles </h2><br>  The profile package panics with almost any misuse.  For example: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Creating a profile that already exists </li><li>  Attaching a profile to the same object twice </li><li>  Deleting a stack that has not been added before </li><li>  Deleting a stack that has already been deleted </li></ul><br>  Try to avoid such situations. <br><br><h1>  Creating a profile </h1><br><pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> libProfile *pprof.Profile <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> {   profName := <span class="hljs-string"><span class="hljs-string">"my_experiment_thing"</span></span>   libProfile = pprof.Lookup(profName)   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> libProfile == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> {       libProfile = pprof.NewProfile(profName)   } }</code> </pre> <br>  Since we cannot create two different profiles with the same name, it makes sense to create them in init ().  You might want to create a profile in one line. <br><br><pre> <code class="hljs pgsql">// <span class="hljs-built_in"><span class="hljs-built_in">Warning</span></span>: /vendor panic possibilities var panicProfile = pprof.NewProfile("this_unique_name")</code> </pre> <br>  But such use is fraught with the fact that your chosen name can already be used.  Even if you are sure that it is unique, if your library is being <a href="https://blog.gopheracademy.com/advent-2015/vendor-folder/">redeployed</a> several times (which is quite possible), the application will panic on startup.  Since  profiles are thread safe, and the init () function is executed once, the check-and-create approach is the right approach. <br><br>  Godoc mentions that the generally accepted way to create unique names is to use the ' <i>import / path.'</i> Prefix <i>, but if you follow the advice, this will cause you to stumble upon a known bug in cmd / pprof</i> .  So use the path and name of your package, but only with the following characters [a-zA-Z0‚Äì9_]. <br><br><h2>  Profile use </h2><br><pre> <code class="hljs go"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> someResource <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> {     *os.File } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MustResource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">someResource</span></span></span></span> {     f, err := os.Create(...)     <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> {            <span class="hljs-built_in"><span class="hljs-built_in">panic</span></span>(err)     }     r := &amp;someResource{f}     libProfile.Add(r, <span class="hljs-number"><span class="hljs-number">1</span></span>)     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r *someResource)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> {     libProfile.Remove(r)     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r.File.Close() }</code> </pre> <br>  The main functions of the package are <a href="https://golang.org/pkg/runtime/pprof/">Add</a> and <a href="https://golang.org/pkg/runtime/pprof/">Remove</a> .  In this example, I will keep track of all the created resources that are not closed, so I will add the stack trace at the moment I create the resource, and delete it when I close it.  The ‚ÄúAdd‚Äù function requires a unique object for each call, so that I can use the resource itself as a key.  Sometimes there is no good key, in which case you can create a dummy byte and use its address. <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">func</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">usesAResource</span></span>() {     <span class="hljs-attribute"><span class="hljs-attribute">pprofKey </span></span>:= <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(byte)     libProfile.<span class="hljs-built_in"><span class="hljs-built_in">Add</span></span>(pprofKey, 1)     defer libProfile.<span class="hljs-built_in"><span class="hljs-built_in">Remove</span></span>(pprofKey)     // .... }</code> </pre> <br><h2>  Exporting a new profile to pprof </h2><br>  If you include <a href="http/pprof/">the http pprof library</a> , Go will register http handlers for the profile package.  This is usually done by adding an ‚Äúempty‚Äù import in the main.go file. <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> _ "net/http/pprof"</code> </pre> <br>  You can achieve the same by manually registering a pprof-processor. <br><br><pre> <code class="hljs pgsql">httpMux.Handle("/debug/pprof/", http.HandlerFunc(pprof.<span class="hljs-keyword"><span class="hljs-keyword">Index</span></span>))</code> </pre> <br><h2>  Pprof using </h2><br>  I created a test application to demonstrate everything I‚Äôm talking about. <br><br><pre> <code class="hljs go"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> _ <span class="hljs-string"><span class="hljs-string">"net/http/pprof"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> <span class="hljs-string"><span class="hljs-string">"runtime/pprof"</span></span> <span class="hljs-string"><span class="hljs-string">"sync/atomic"</span></span> <span class="hljs-string"><span class="hljs-string">"time"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> libProfile *pprof.Profile <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { profName := <span class="hljs-string"><span class="hljs-string">"my_experiment_thing"</span></span> libProfile = pprof.Lookup(profName) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> libProfile == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { libProfile = pprof.NewProfile(profName) } } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> someResource <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { *os.File } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fileIndex = <span class="hljs-keyword"><span class="hljs-keyword">int64</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MustResource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">someResource</span></span></span></span> { f, err := os.Create(fmt.Sprintf(<span class="hljs-string"><span class="hljs-string">"/tmp/%d.txt"</span></span>, atomic.AddInt64(&amp;fileIndex, <span class="hljs-number"><span class="hljs-number">1</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">panic</span></span>(err) } r := &amp;someResource{f} libProfile.Add(r, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(r *someResource)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Close</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { libProfile.Remove(r) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r.File.Close() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trackAFunction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { tracked := <span class="hljs-built_in"><span class="hljs-built_in">new</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) libProfile.Add(tracked, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> libProfile.Remove(tracked) time.Sleep(time.Second) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">usesAResource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { res := MustResource() <span class="hljs-keyword"><span class="hljs-keyword">defer</span></span> res.Close() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i := <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>; i++ { time.Sleep(time.Second) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/nonblock"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rw http.ResponseWriter, req *http.Request)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> usesAResource() }) http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/functiontrack"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rw http.ResponseWriter, req *http.Request)</span></span></span></span> { trackAFunction() }) http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/block"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rw http.ResponseWriter, req *http.Request)</span></span></span></span> { usesAResource() }) log.Println(<span class="hljs-string"><span class="hljs-string">"Running!"</span></span>) log.Println(http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">"localhost:6060"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)) }</code> </pre> <br>  By running this program, you can go to <a href="http://localhost:6060/debug/pprof/">http: // localhost: 6060 / debug / pprof /</a> and see all the available profiles. <br><br><img src="https://lh4.googleusercontent.com/BkltCkyQm5LGMYDwT4XXw4GZV9_kFO3N0CuPf_GneKTfMOhJfBgl5msFVvTKHJMM681YptO4yyKBov1CBbZmui0DSjhyp_uk4xBAX3eQq4q1CIR9SXuRzi8FMvog6_EZhp5EWedL"><br><br>  Submit some traffic to / nonblock and / block, then click on the my_example_thing link to see the profile. <br><br><pre> <code class="hljs go">my_experiment_thing profile: total <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> @ <span class="hljs-number"><span class="hljs-number">0x2245</span></span> <span class="hljs-number"><span class="hljs-number">0x5d</span></span>961 # <span class="hljs-number"><span class="hljs-number">0x2244</span></span> main.usesAResource+<span class="hljs-number"><span class="hljs-number">0x64</span></span> /Users/.../pproftest.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>:<span class="hljs-number"><span class="hljs-number">64</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> @ <span class="hljs-number"><span class="hljs-number">0x2245</span></span> <span class="hljs-number"><span class="hljs-number">0x2574</span></span> <span class="hljs-number"><span class="hljs-number">0x9c184</span></span> <span class="hljs-number"><span class="hljs-number">0x9d56f</span></span> <span class="hljs-number"><span class="hljs-number">0x9df7d</span></span> <span class="hljs-number"><span class="hljs-number">0x9aa07</span></span> <span class="hljs-number"><span class="hljs-number">0x5d</span></span>961 # <span class="hljs-number"><span class="hljs-number">0x2244</span></span> main.usesAResource+<span class="hljs-number"><span class="hljs-number">0x64</span></span> /Users/.../pproftest.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>:<span class="hljs-number"><span class="hljs-number">64</span></span> # <span class="hljs-number"><span class="hljs-number">0x2573</span></span> main.main.func3+<span class="hljs-number"><span class="hljs-number">0x13</span></span> /Users/.../pproftest.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>:<span class="hljs-number"><span class="hljs-number">79</span></span> # <span class="hljs-number"><span class="hljs-number">0x9c183</span></span> net/http.HandlerFunc.ServeHTTP+<span class="hljs-number"><span class="hljs-number">0x43</span></span> /usr/local/Cellar/<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>/<span class="hljs-number"><span class="hljs-number">1.7</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>/libexec/src/net/http/server.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>:<span class="hljs-number"><span class="hljs-number">1726</span></span> # <span class="hljs-number"><span class="hljs-number">0x9d</span></span>56e net/http.(*ServeMux).ServeHTTP+<span class="hljs-number"><span class="hljs-number">0x7e</span></span> /usr/local/Cellar/<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>/<span class="hljs-number"><span class="hljs-number">1.7</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>/libexec/src/net/http/server.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>:<span class="hljs-number"><span class="hljs-number">2022</span></span> # <span class="hljs-number"><span class="hljs-number">0x9df</span></span>7c net/http.serverHandler.ServeHTTP+<span class="hljs-number"><span class="hljs-number">0x7c</span></span> /usr/local/Cellar/<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>/<span class="hljs-number"><span class="hljs-number">1.7</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>/libexec/src/net/http/server.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>:<span class="hljs-number"><span class="hljs-number">2202</span></span> # <span class="hljs-number"><span class="hljs-number">0x9aa06</span></span> net/http.(*conn).serve+<span class="hljs-number"><span class="hljs-number">0x4b6</span></span> /usr/local/Cellar/<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>/<span class="hljs-number"><span class="hljs-number">1.7</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>/libexec/src/net/http/server.<span class="hljs-keyword"><span class="hljs-keyword">go</span></span>:<span class="hljs-number"><span class="hljs-number">1579</span></span></code> </pre> <br><h2>  Call graph </h2><br>  I used <a href="http://brew.sh/">brew</a> to install <a href="http://www.graphviz.org/">Graphviz</a> on my Mac: it is needed so that pprof can create png-pictures. <br><br><pre> <code class="hljs sql">brew <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> Graphviz</code> </pre> <br>  After installing graphviz, I can use pprof to generate a png-image with a call graph. <br><br><pre> <code class="hljs 1c">go tool pprof -png /tmp/mybinary 'localhost:<span class="hljs-number"><span class="hljs-number">6060</span></span>/debug/pprof/my_experiment_thing?debug=1' &gt; /tmp/<span class="hljs-built_in"><span class="hljs-built_in">exp</span></span>.png</code> </pre> <br>  I used PNG for convenience of insertion in this article, but usually SVG is more convenient for viewing in the browser.  Generate svg instead of png by adding -svg instead of -png when invoking the pprof command. <br>  The finished picture is below. <br><br><img src="https://lh4.googleusercontent.com/bc0L9-zdHlb4A0-o3O712dEw_tDorOYGYzuq-ohhsrcvVenYZgZiIykMbpqvQGWpQX26log2nZ9x5ocd716MRlHzf1LV1W5M6DWT_JtbJbaik2ae9K5Eq3KIpkI1RQt8s2seEljD"><br><br>  This picture shows me a stack of creating those resources that have not been closed.  When I generated this picture, I sent twice as many non-blocking requests, and this can be seen from the trace.  All stack traces end in MustResource.  If you don‚Äôt like it, you can pass an integer by calling <a href="https://golang.org/pkg/runtime/pprof/">Profile.Add</a> . <br><br>  You can also use the interactive console, which is available when you start pprof from a terminal.  Below, I run pprof and use the top command to see which calls are more common among all my stack traces. <br><br><pre> <code class="hljs dos">&gt; go tool pprof 'localhost:<span class="hljs-number"><span class="hljs-number">6060</span></span>/debug/pprof/my_experiment_thing?debug=<span class="hljs-number"><span class="hljs-number">1</span></span>' Fetching profile from http://localhost:<span class="hljs-number"><span class="hljs-number">6060</span></span>/debug/pprof/my_experiment_thing?debug=<span class="hljs-number"><span class="hljs-number">1</span></span> Saved profile <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> /Users/.../pprof/pprof.localhost:<span class="hljs-number"><span class="hljs-number">6060</span></span>.my_experiment_thing.<span class="hljs-number"><span class="hljs-number">007</span></span>.pb.gz Entering interactive <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">type</span></span> "<span class="hljs-built_in"><span class="hljs-built_in">help</span></span>" <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> commands) (pprof) top30 <span class="hljs-number"><span class="hljs-number">6</span></span> of <span class="hljs-number"><span class="hljs-number">6</span></span> total (  <span class="hljs-number"><span class="hljs-number">100</span></span>%)    flat  flat%   sum%        cum   cum%       <span class="hljs-number"><span class="hljs-number">6</span></span>   <span class="hljs-number"><span class="hljs-number">100</span></span>%   <span class="hljs-number"><span class="hljs-number">100</span></span>%          <span class="hljs-number"><span class="hljs-number">6</span></span>   <span class="hljs-number"><span class="hljs-number">100</span></span>%  main.usesAResource       <span class="hljs-number"><span class="hljs-number">0</span></span>     <span class="hljs-number"><span class="hljs-number">0</span></span>%   <span class="hljs-number"><span class="hljs-number">100</span></span>%          <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span>.<span class="hljs-number"><span class="hljs-number">33</span></span>%  main.main.func3       <span class="hljs-number"><span class="hljs-number">0</span></span>     <span class="hljs-number"><span class="hljs-number">0</span></span>%   <span class="hljs-number"><span class="hljs-number">100</span></span>%          <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span>.<span class="hljs-number"><span class="hljs-number">33</span></span>%  <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>/http.(*ServeMux).ServeHTTP       <span class="hljs-number"><span class="hljs-number">0</span></span>     <span class="hljs-number"><span class="hljs-number">0</span></span>%   <span class="hljs-number"><span class="hljs-number">100</span></span>%          <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span>.<span class="hljs-number"><span class="hljs-number">33</span></span>%  <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>/http.(*conn).serve       <span class="hljs-number"><span class="hljs-number">0</span></span>     <span class="hljs-number"><span class="hljs-number">0</span></span>%   <span class="hljs-number"><span class="hljs-number">100</span></span>%          <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span>.<span class="hljs-number"><span class="hljs-number">33</span></span>%  <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>/http.HandlerFunc.ServeHTTP       <span class="hljs-number"><span class="hljs-number">0</span></span>     <span class="hljs-number"><span class="hljs-number">0</span></span>%   <span class="hljs-number"><span class="hljs-number">100</span></span>%          <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span>.<span class="hljs-number"><span class="hljs-number">33</span></span>%  <span class="hljs-built_in"><span class="hljs-built_in">net</span></span>/http.serverHandler.ServeHTTP       <span class="hljs-number"><span class="hljs-number">0</span></span>     <span class="hljs-number"><span class="hljs-number">0</span></span>%   <span class="hljs-number"><span class="hljs-number">100</span></span>%          <span class="hljs-number"><span class="hljs-number">6</span></span>   <span class="hljs-number"><span class="hljs-number">100</span></span>%  runtime.goexit (pprof)</code> </pre> <br><h2>  Conclusion </h2><br>  Not all features used in CPU or memory profiling are available through the pprof API, but still we get very cool visuals, considering how little code is needed.  The next time you write a library, look, perhaps, stack-traces will help you to specifically address your problem. </div><p>Source: <a href="https://habr.com/ru/post/318336/">https://habr.com/ru/post/318336/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318326/index.html">Boring about decoding</a></li>
<li><a href="../318328/index.html">ABBYY Cloud OCR SDK subscriptions: ‚Äúshut up and take my money!‚Äù</a></li>
<li><a href="../318330/index.html">Dataset study with IMDB</a></li>
<li><a href="../318332/index.html">Admin Generator</a></li>
<li><a href="../318334/index.html">NancyFX framework and REST-style services</a></li>
<li><a href="../318338/index.html">Can a company with tens of thousands of employees be Agile: MTS experience</a></li>
<li><a href="../318340/index.html">Burnout freelancer on Upwork. Causes, tools, solutions</a></li>
<li><a href="../318342/index.html">The release of the alpha version of the Internet of Things protocol stack</a></li>
<li><a href="../318350/index.html">How to teach salespeople to speak with developers</a></li>
<li><a href="../318352/index.html">First steps with STM32 and mikroC compiler for ARM architecture - Part 2, start ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>