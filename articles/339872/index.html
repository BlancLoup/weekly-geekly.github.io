<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In search of reason: is it possible to make a ‚Äúuniversal‚Äù chat bot using neural networks?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Interactive systems, they are chat bots, today multiplied to the obscene. But their level of "intelligence" is often depressing. Popular chat bots wor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In search of reason: is it possible to make a ‚Äúuniversal‚Äù chat bot using neural networks?</h1><div class="post__text post__text-html js-mediator-article">  Interactive systems, they are chat bots, today multiplied to the obscene.  But their level of "intelligence" is often depressing.  Popular chat bots work either with the help of templates, or using the ‚Äúintent + entities‚Äù model.  They do an excellent job with simple tasks (set an alarm clock, a reminder, find the answer to a frequently asked question), but the narrowness and limitations of their ‚Äúthinking‚Äù are easily revealed even with a superficial survey.  Can neural networks help create something more perfect, perhaps approaching the really intelligent one? <br><a name="habracut"></a><br>  I remember very well my feelings from reading the classic work nowadays [1] where Google researchers taught the seq2seq neural network to generate responses using a huge base of movie subtitles.  The possibilities seemed unlimited: <br><br>  <i>D: My name is John, what is my name?</i> <i><br></i>  <i>H: John</i> <i><br></i>  <i>Q: How many legs does a dog have?</i> <i><br></i>  <i>N: Four</i> <i><br></i>  <i>Q: What color is the sky?</i> <i><br></i>  <i>H: Blue</i> <i><br></i>  <i>Q: Does the cat have a tail?</i> <i><br></i>  <i>H: Yes</i> <i><br></i>  <i>Q: Does the cat have wings?</i> <i><br></i>  <i>N: No</i> <br>  Conversations are translated by me into Russian.  H - man, N- neural network <br><br>  Is it not surprising that the network, without any rules, based on very noisy data, can correctly answer such questions (which are not found in the data itself in such formulations)?  But soon, this approach revealed a number of problems: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  The inability to update long-term memory.  For example, ‚ÄúMy name is John,‚Äù will soon be forgotten as soon as it is out of context.  It follows from this that it is impossible to memorize new facts and somehow operate with them. </li><li>  Inability to obtain information from external sources </li><li>  The inability to transfer knowledge to other topics.  It takes a lot of data to train a new model. </li><li>  Inability to take any action </li><li>  The tendency to give short / frequent answers (for example, to answer any question with the word ‚Äúyes‚Äù) </li></ul><br>  As a result, most practical systems are still based on pre-prepared answers and ranking options (using rules and machine learning), and the idea of ‚Äã‚Äãsynthesizing answers from scratch has, by the way, faded into the background.  Even Google Smart Reply is now ranking [2], albeit using neural networks.  Ranking can be effective without understanding the meaning - only due to syntactic transformations and simple rules [7].  In our experiments with ranking, even if it is carried out by a neural network, surface analysis dominates, and only very large neural networks demonstrate only some of the rudiments of general mathematical knowledge [8]. <br><br>  Also, all popular chat bots, virtual assistants and similar programs work pragmatically.  Siri and Cortana seem to be highly intelligent systems only due to the fact that each subject they understand is carefully tuned by hand [6], which makes it possible to achieve high quality answers.  But, on the other hand, according to some studies, with all the enormous efforts invested by companies in the development of these assistants, only 13% of phone users actually use them (46% have ever tried it, but 46% have refused to use it [11]).  In addition, this technology is known, put on stream, and bored with them.  I would like something potentially more intellectual, but at the same time, not completely divorced from practice. <br><br>  Many years ago, while reading various fiction novels, I liked the idea of ‚Äã‚Äãthe ‚ÄúPlanning Machine‚Äù <br><br><div class="spoiler">  <b class="spoiler_title">Excerpt from the text</b> <div class="spoiler_text">  ‚ÄúInformation,‚Äù Steve tapped on his keys.  - ‚ÄúStephen Ryland, op.  ABC ‚Äì 38440, OBOporto, op.  HUZ ‚Äì 99942, arrived at ... - a quick glance at the plate with the code attached to the teletype housing, - station 3, radius 4‚Äì261, Reykjavik, Iceland.  Request.  What instructions follow? ‚Äù <br>  A moment later, the answer from the Planning Machine came ‚Äî just one letter: ‚ÄúP‚Äù.  This meant that the machine accepted the message, understood it and entered it into the memory bank.  Orders will follow. <br><br>  The teletype signal jingled.  Ryland read the message: <br>  "Actions.  Proceed to train 667, track 6, coupe 93 ". <br><br>  <i>Reefs of space.</i>  <i>Frederick Paul and Jack Williamson, 1964</i> <br></div></div><br>  Yes, in novels, such a machine is often a negative character.  But how convenient it would be to have a similar planning machine in the company, so that she would tell whom and what to do.  She also solved various issues on her own. <br><br>  You can, of course, program each such function separately.  This way, the developers of intellectual functions in existing CRM / BPM systems.  But by doing so, we will deprive the system of flexibility and will make the staff of programmers continually writing and rewriting these functions.  Can I go another way? <br><br>  The main direction to overcome the above disadvantages is to provide the neural network with external memory.  This memory is mainly of two types - differentiable, for example in [3] and non-differentiable.  Differentiable memory assumes that the mechanisms for writing and reading from memory are themselves neural networks and are trained together.  To simulate a dialogue, a variant is mainly used where only the reading mechanism is trained, and the writing mechanism contains hard-coded elements (for example, n memory slots, and the recording goes like a stack) [4].  Such a mechanism is difficult to scale, because  To find an element in memory for each element, it is necessary to perform calculations using a neural network.  In addition, the contents of such memory cannot be interpreted, edited by hand, it may not be accurate, which significantly complicates the use of the system in practice. <br><br>  Ideally, we want the neural network to work with something resembling a traditional database.  Therefore, we drew attention to the work related to question-answer systems that interface with large knowledge bases.  In particular, the article [6] seemed interesting to me, where the neural network generates queries to the graph database in the LISP language based on the questions asked by users.  Those.  the neural network does not directly access the data, but creates a small program, the execution of which results in obtaining the necessary answer. <br><br>  A graph representation of knowledge as an external memory for neural networks is generally quite a popular solution, since on the one hand it is easier to put diverse knowledge about the world on the one hand, and on the other hand, this scheme is reminiscent of a method of storing information in the human brain. <br><br>  With reference to our task, the following scheme is obtained: <br><br><img src="https://habrastorage.org/webt/59/de/29/59de298d6d284152675580.png"><br><br>  Of course, we are dealing with a more complex problem.  First, for the system to work, the neural network must be able not only to extract information, but also to record new information.  Obviously, one and that information can be recorded in completely different ways and, if we want the system to be flexible, we cannot fix all kinds of relationships in advance.  This means that the program will have to choose the correct way to record information, and then be able to get what it has written. <br><br>  In addition, in practice other questions will arise: <br><br><ul><li>  Work speed  Is this mechanism effective enough?  Programmers spend a lot of effort to design an efficient database structure.  What happens if the data is organized by a neural network? </li><li>  What happens after a few months / years of work?  There is a risk of accumulation of incorrect, meaningless and poorly organized information that will litter the system and make work impossible. </li><li>  Security.  Not everyone can be told everything, and not everyone is allowed to change the data.  Not all information reported to the system can be reliable. </li><li>  Lack of a training sample - where to get data for training a neural network? </li><li>  Other pitfalls </li></ul><br>  It is clear that answering all the questions at once will not work out, therefore the most correct approach is gradual implementation. <br><br>  At the first stage, you need a graph database and some language for querying it.  There are quite a few implementations of graph databases and several popular languages, such as SPARQL, Cypher, and others.  It is clear that the structure of the language will strongly influence the ability of the neural network to generate requests for it, so we decided to make our own add-on above the existing graph database engines, including a special language that can be further optimized.  To simplify development, the language was originally implemented using Python classes and was in fact a subset of Python. <br><br>  Example (very simple): <br><table><tbody><tr><td>  Text </td><td>  Request </td></tr><tr><td>  Three pillows arrived at the warehouse. </td><td>  <i>MatchOne ({"type": "warehouse")). Add ("name": "pillows", "quantity": "3")</i> </td></tr><tr><td>  Are there cushions in stock? </td><td>  <i>MatchOne ({"type": "warehouse")). Child ({"name": "pillows"}). NotEmpty ()</i> </td></tr></tbody></table><br>  Please note that the language describes how to navigate the graph.  There is another way to look at the same thing: imagine that each node in the graph is a separate neuron.  Some information comes to the input: the activation vector of the input neurons and the vector of the history of previous activations.  The neuron works as a classifier - it chooses which path (from the available connections) the process will go on.  This is much more like a process that can actually occur in the human brain [9,10], at least in some of the existing theories of the work of memory. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/59/de/2a/59de2a592f151209038654.png"></div><br>  In the examples of requests used model subjects of goods in stock.  To begin with, we made a sample of the dialogs manually, and assigned corresponding requests for them.  The goal was to make sure that the query language and the scheme as a whole cover a sufficient variety of cases.  But, very quickly, it became clear that the limited model world does not allow to check all aspects of the approach.  In fact, there are a lot of works in which systems that work on model situations are proposed, but it is not clear how to translate all this into practice.  Yes, and compose requests manually is not very productive. <br><br>  Therefore, we decided to implement the entire scheme in the model system, replacing, temporarily, the neural network with the rule system.  This approach is quite reasonable, because it allows you to debug the work of important components, without immediately drowning in the complexities of the problem as a whole, and at the same time avoid ‚Äútoy‚Äù model problems. <br><br>  As a subject of the application, we chose a project management system (with an eye on getting sometime a ‚Äúplanning machine‚Äù).  How the implementation process looked from the point of view of using the system can be found in the <a href="https://habrahabr.ru/company/meanotek/blog/338906/">previous article</a> (empirically, we learned something interesting about how useful the voice interface is and how to organize work on projects correctly, but this is not the main theme of the story now). <br><br>  As for the main scheme of things, the experience gained was very important.  The main changes concerned the organization of the search and the introduction of short-term memory. <br><br>  For the process of dialogue (which has been known for a long time), the context of the conversation is very important.  In the use of our system, the context was absolutely necessary.  A circuit with one large data repository entrusts tracking completely to the ‚Äúanalyzer‚Äù.  For the rules, this task was overwhelming, and, for neural networks, as is known from other studies, it is also difficult.  Explicit presentation of short-term external memory is now a common approach in conversational systems based on neural networks [4], and also allows you to show the contents of the working context to the user, which is very important.  Therefore, an additional block appeared in the scheme, storing the nodes of the graph, to which the recent access occurred (or recently created). <br><br>  Further, in practice, most nodes received long names (for example, task names).  Comparison of tasks on exact matching ceased to be effective, therefore each node of the graph was supplied with a vector representation (for a start, we tried a bag of words and a sum of word2vec name vectors).  This made it possible, on the one hand, to integrate search commands into the language by a fuzzy coincidence, and on the other hand, it brought us closer to the data structures used in differentiated external memory.  This is a kind of key-value structure, where the key is a vector and the value is an arbitrary data type.  Value vectors can be learners, and can also be part of the addressing mechanism in the neural attention model. <br><br>  In general, the resulting set of components turned out to be viable and suitable for use in other projects.  So, then we started working on replacing the analyzer on the rules (which is very limited in capabilities) with a neural network, especially since a certain set of dialogues was accumulated during the implementation of the version on the rules.  However, this topic does not seem to fit into the framework of one article, since the text has already turned out to be quite long, but you will have to write about the neural network as much as at least.  Therefore, the continuation will be in our blog one of the following articles, if the topic raised will cause interest among readers. <br><br><div class="spoiler">  <b class="spoiler_title">Literature</b> <div class="spoiler_text"><ol><li>  Vinyals, Oriol, and Quoc Le.  ‚ÄúA neural conversational model.‚Äù ArXiv preprint arXiv: 1506.05869 (2015). </li><li>  Henderson, Matthew, et al.  "Efficient Natural Language Response Suggestion for Smart Reply." ArXiv preprint arXiv: 1705.00652 (2017). </li><li>  Kumar, Ankit, et al.  "Ask me anything: Dynamic memory networks for natural language processing." International Conference on Machine Learning.  2016 </li><li>  Chen, Yun-Nung, et al.  "End-to-End Memory Networks for Multi-Turn Spoken Language Understanding." INTERSPEECH.  2016 </li><li>  Liang, C., Berant, J., Le, Q., Forbus, KD, &amp; Lao, N. (2016).  Neural symbolic machines: Learning semantic parsers on freebase with weak supervision.  arXiv preprintarX iv: 1611.0 0 020. </li><li>  Sarikaya, Ruhi, et al.  ‚ÄúSpoken Language Technology Workshop (SLT), 2016 IEEE.  IEEE 2016 </li><li>  Ameixa, David, et al.  "Luke, I am your father: dealing with out-of-the-domain requests by using movies subtitles." International Conference on Intelligent Virtual Agents.  Springer, Cham, 2014. </li><li>  Tarasov, DS, and ED Izotova.  "Common Sense Knowledge in Large Scale Neural Conversational Models." International Conference on Neuroinformatics.  Springer, Cham, 2017. </li><li>  Fuster, Joaqu√≠n M ... "Network memory." Trends in neurosciences 20.10 (1997): 451-459. </li><li>  Fuster, Joaqu√≠n M. ‚ÄúCortex and memory: the emergence of a new paradigm.‚Äù Cortex 21.11 (2009). </li><li>  Liao, S.-H.  (2015).  Awareness and Usage of Speech Technology.  Masters thesis, Dept.  Computer Science, University of Sheffield </li></ol></div></div></div><p>Source: <a href="https://habr.com/ru/post/339872/">https://habr.com/ru/post/339872/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../339862/index.html">Who are you - a talented strategist or effective tactician? Check on Budget Sprint 2.0 hackathon</a></li>
<li><a href="../339864/index.html">MvvmCross for a simple iOS application in C #</a></li>
<li><a href="../339866/index.html">Use Apache Ignite at home</a></li>
<li><a href="../339868/index.html">Arduino to poll the counters "Mercury-230"</a></li>
<li><a href="../339870/index.html">Search for solutions to quickly create interfaces DBMS</a></li>
<li><a href="../339874/index.html">About the Strata AI conference: the future of artificial intelligence</a></li>
<li><a href="../339878/index.html">Uneducated youth. What's left overs</a></li>
<li><a href="../339882/index.html">How do we at Tutu.ru achieve the effectiveness of each of the 9000+ UI tests?</a></li>
<li><a href="../339892/index.html">Vraytap autumn crackme from Kaspersky Lab</a></li>
<li><a href="../339894/index.html">What every developer should know about the search</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>