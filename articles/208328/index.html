<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Create a behavior for Yii2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Often, but in fact almost always, when creating a site, it is necessary that the pages of the site are opened not by id entities in the database, but ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Create a behavior for Yii2</h1><div class="post__text post__text-html js-mediator-article">  Often, but in fact almost always, when creating a site, it is necessary that the pages of the site are opened not by id entities in the database, but by text identifier, let's call it slug. <br><br><pre><code class="php hljs">post/view/<span class="hljs-number"><span class="hljs-number">1</span></span> =&gt; post/view/testovaya-novost</code> </pre> <br><br>  (it would be worth removing the view from the url, but the lesson is not about that) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the most primitive way, you can create a slug field in the post table, a new attribute appears in the Post model, add a new input to the view, and punch the slug with pens. <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">helpers</span></span>\<span class="hljs-title"><span class="hljs-title">Html</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">widgets</span></span>\<span class="hljs-title"><span class="hljs-title">ActiveForm</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> yii\web\View $this * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> common\models\Post $model * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> yii\widgets\ActiveForm $form */</span></span> <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">post</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">"&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActiveForm</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">begin</span></span></span><span class="hljs-class">(); ?&gt; &lt;?= $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">field</span></span></span><span class="hljs-class">( $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">name</span></span></span><span class="hljs-class">' )-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">textInput</span></span></span><span class="hljs-class">( [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">maxlength</span></span></span><span class="hljs-class">' =&gt; 255 ] ) ?&gt; &lt;?= $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">field</span></span></span><span class="hljs-class">( $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">slug</span></span></span><span class="hljs-class">' )-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">textInput</span></span></span><span class="hljs-class">( [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">maxlength</span></span></span><span class="hljs-class">' =&gt; 255 ] ) ?&gt; &lt;?= $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">field</span></span></span><span class="hljs-class">( $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">content</span></span></span><span class="hljs-class">' )-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">textarea</span></span></span><span class="hljs-class">( [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rows</span></span></span><span class="hljs-class">' =&gt; 6 ] ) ?&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">group</span></span></span><span class="hljs-class">"&gt; &lt;?= </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Html</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">submitButton</span></span></span><span class="hljs-class">( $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNewRecord</span></span></span><span class="hljs-class"> ? </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Yii</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">( '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">app</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Create</span></span></span><span class="hljs-class">' ) : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Yii</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">t</span></span></span><span class="hljs-class">( '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">app</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Update</span></span></span><span class="hljs-class">' ), [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class">' =&gt; $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">isNewRecord</span></span></span><span class="hljs-class"> ? '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">success</span></span></span><span class="hljs-class">' : '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">btn</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">primary</span></span></span><span class="hljs-class">' ] ) ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;?</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">php</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActiveForm</span></span></span><span class="hljs-class">::</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class">(); ?&gt; &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre> <br><br><a name="habracut"></a><br><br>  But it‚Äôs not always interesting to use pens (yes, I‚Äôm cheating whom, it‚Äôs not interesting at all), so we add methods to the model that, when the model is saved, generate a slug automatically from the name, check its uniqueness in the table (after all, we‚Äôll retrieve the post from base, and, therefore, slug can not be not unique), and, perhaps, we transliterate it (test-news =&gt; testovaya-novost) - this can also be useful. <br>  Well, we write, we become attached to the event, we test - everything works.  And here in the development of the site we are faced with the fact that slug'i still needed in the model Page.  And also in the product catalog - let it be the Item model.  You can take the path of least resistance - copy-paste.  But‚Ä¶ <br><br>  In Yii, there is such a thing as behaviors (functional) that allows you to use the same functions in different models.  So, we write the behavior for slug'ification. <br><br>  In our Post model (it is \ commoin \ models \ Post just in case) we connect the behavior that has not yet been created: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">behaviors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-string"><span class="hljs-string">'slug'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'common\behaviors\Slug'</span></span>, <span class="hljs-string"><span class="hljs-string">'in_attribute'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'out_attribute'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'slug'</span></span>, <span class="hljs-string"><span class="hljs-string">'translit'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ] ]; }</code> </pre> <br><br>  We created the behaviors function necessary for the connection, assigned a class in which we will have the behavior, and transferred three attributes to this class: <br>  1. in_attribute - an attribute of the model from which slug will be generated (it may differ in different models, for example name or title) <br>  2. out_attribute is an attribute of slug respectively (slug or alias) <br>  3. translit - everything is clear <br><br>  When creating the behavior, there was another fourth attribute - unique, but then I excluded this functional, since  It is very rarely necessary that the slug is not unique. <br><br>  I will mention that I use the yii2-app-advanced application structure, that is, I have backend and frontend folders, in which there are controllers and views, and a common folder, in which there are common models and behaviors. <br><br>  Create common / behaviors / Slug.php: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">common</span></span>\<span class="hljs-title"><span class="hljs-title">behaviors</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">base</span></span>\<span class="hljs-title"><span class="hljs-title">Behavior</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">db</span></span>\<span class="hljs-title"><span class="hljs-title">ActiveRecord</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Slug</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Behavior</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $in_attribute = <span class="hljs-string"><span class="hljs-string">'name'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $out_attribute = <span class="hljs-string"><span class="hljs-string">'slug'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $translit = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">events</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ ActiveRecord::EVENT_BEFORE_VALIDATE =&gt; <span class="hljs-string"><span class="hljs-string">'getSlug'</span></span> ]; } }</code> </pre> <br><br>  We inherit the class from yii \ base \ Behavior, prescribe three attributes with initial settings, create the events method, which will bind the behavior to some event when the model is saved.  Since slug is usually necessary and can be registered in rules as required, we will tie the slug generation to validation. <br><br><pre> <code class="php hljs">ActiveRecord::EVENT_BEFORE_VALIDATE =&gt; <span class="hljs-string"><span class="hljs-string">'getSlug'</span></span></code> </pre> <br><br>  Now create the getSlug method: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSlug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $event )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute} ) ) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute} = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;generateSlug( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;in_attribute} ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute} = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;generateSlug( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute} ); } }</code> </pre> <br><br>  The model object itself is passed to the behavior as $ this-&gt; owner.  Thus, the slug will be available to us through a call to $ this-&gt; owner-&gt; slug or in our case $ this-&gt; owner -&gt; {$ this-&gt; out_attribute}, since the name of the slug attribute is passed to the $ this-&gt; variable out_attribute. <br>  Whether we check whether the slug is empty when saved and, if empty, then generate it from the name (record header).  If it is not empty, then we process the incoming slug. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateSlug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $slug )</span></span></span><span class="hljs-function"> </span></span>{ $slug = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;slugify( $slug ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;checkUniqueSlug( $slug ) ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $slug; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( $suffix = <span class="hljs-number"><span class="hljs-number">2</span></span>; !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;checkUniqueSlug( $new_slug = $slug . <span class="hljs-string"><span class="hljs-string">'-'</span></span> . $suffix ); $suffix++ ) {} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $new_slug; } }</code> </pre> <br><br>  In the first line of the method, we use the slugify function to remove unnecessary characters and translate them into translit if necessary.  Let's take it at once and consider: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">slugify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $slug )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;translit ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Inflector::slug( TransliteratorHelper::process( $slug ), <span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;slug( $slug, <span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); } }</code> </pre> <br><br>  What is translit?  This is the transfer of national symbols to their counterparts in standard Latin.  Most snippets found on the foreign Internet only clear text from umlauts, caps and other symbols ('√Ä' =&gt; 'A', '√Å' =&gt; 'A', '√Ç' =&gt; 'A', '√É' = &gt; 'A',), that is, from the "dirty" Latin do "clean."  This makes the standard helper yii2 yii \ helpers \ Inflector :: slug (by the way, during the creation of the behavior, this method was incompatibly changed - development over yii2 is still ongoing).  In RuNet, respectively, they add another replacement of the Cyrillic alphabet in the Latin alphabet.  But I would like to create the most flexible transliteration.  The latest version of yii \ helpers \ Inflector :: slug uses the intl php extension, including transliterating even Chinese characters, but, as I understand it, it is not enabled by default (php 5.5.6).  But a great developer 2amigos, familiar to everyone interested in yii, had the addition of transliterator-helper (it in turn uses the ideas from drupal, as I recall).  It represents a number of php-files, which describe most of the characters and their replacement in the Latin alphabet. <br>  Add the <code>"2amigos/transliterator-helper": "2.0.*"</code> dependency to composer.json <code>"2amigos/transliterator-helper": "2.0.*"</code> , Update, and now dosamigos \ helpers \ TransliteratorHelper is available: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Inflector::slug( TransliteratorHelper::process( $slug ), <span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> );</code> </pre> <br><br>  We are transliterating, clearing non-alphabetic characters, replacing spaces with a dash "-". <br><br>  If we do not need translit, then: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;slug( $slug, <span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> );</code> </pre> <br><br>  The slug method (a trimmed version of yii \ helpers \ Inflector :: slug without transliteration): <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">slug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $string, $replacement = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'-'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, $lowercase = true )</span></span></span><span class="hljs-function"> </span></span>{ $string = preg_replace( <span class="hljs-string"><span class="hljs-string">'/[^\p{L}\p{Nd}]+/u'</span></span>, $replacement, $string ); $string = trim( $string, $replacement ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $lowercase ? strtolower( $string ) : $string; }</code> </pre> <br><br>  Let's go back to generateSlug: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateSlug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $slug )</span></span></span><span class="hljs-function"> </span></span>{ $slug = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;slugify( $slug ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;checkUniqueSlug( $slug ) ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $slug; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( $suffix = <span class="hljs-number"><span class="hljs-number">2</span></span>; !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;checkUniqueSlug( $new_slug = $slug . <span class="hljs-string"><span class="hljs-string">'-'</span></span> . $suffix ); $suffix++ ) {} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $new_slug; } }</code> </pre> <br><br>  The second line, we check the slug for uniqueness in the database.  Let me remind you that we do not need a non-unique slug, since we will extract data from the table using it. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkUniqueSlug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $slug )</span></span></span><span class="hljs-function"> </span></span>{ $pk = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;primaryKey(); $pk = $pk[<span class="hljs-number"><span class="hljs-number">0</span></span>]; $condition = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute . <span class="hljs-string"><span class="hljs-string">' = :out_attribute'</span></span>; $params = [ <span class="hljs-string"><span class="hljs-string">':out_attribute'</span></span> =&gt; $slug ]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;isNewRecord ) { $condition .= <span class="hljs-string"><span class="hljs-string">' and '</span></span> . $pk . <span class="hljs-string"><span class="hljs-string">' != :pk'</span></span>; $params[<span class="hljs-string"><span class="hljs-string">':pk'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{$pk}; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;find() -&gt;where( $condition, $params ) -&gt;one(); }</code> </pre> <br><br>  Our primary key may theoretically have no id, so we find it with the function primaryKey ().  Then we make a request to the table for the existence of such a slug.  If the entry is not new, and we update (! $ This-&gt; owner-&gt; isNewRecord), then slug may already exist and make an exception to this id: <br><br><pre> <code class="php hljs">$condition .= <span class="hljs-string"><span class="hljs-string">' and '</span></span> . $pk . <span class="hljs-string"><span class="hljs-string">' != :pk'</span></span>;</code> </pre> <br><br>  The function returns true if the slug is unique, and false if not.  Farther: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;checkUniqueSlug( $slug ) ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $slug; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( $suffix = <span class="hljs-number"><span class="hljs-number">2</span></span>; !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;checkUniqueSlug( $new_slug = $slug . <span class="hljs-string"><span class="hljs-string">'-'</span></span> . $suffix ); $suffix++ ) {} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $new_slug; }</code> </pre> <br><br>  If slug is unique, we return it, assign it to the model attribute, and save the model to the database.  If not unique, then add a digital suffix testovaya-novost-2 <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( $suffix = <span class="hljs-number"><span class="hljs-number">2</span></span>; !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;checkUniqueSlug( $new_slug = $slug . <span class="hljs-string"><span class="hljs-string">'-'</span></span> . $suffix ); $suffix++ ) {}</code> </pre> <br><br>  Using the search method, we find the first free suffix and add it to the slug.  The solution was overlooked in WordPress, but I don‚Äôt like what we do for each suffix on request, respectively, with testovaya-novost, testovaya-novost-2, testovaya-novost-3, testovaya-novost-4, testovaya-novost-5, us You will need to make 6 requests to verify uniqueness.  If anyone can offer a better solution, I will be grateful. <br><br>  So, the slug is gendered, transferred to the model, saved to the base, and we use the resulting behavior in other models. <br><br><div class="spoiler">  <b class="spoiler_title">Full text of behavior:</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">common</span></span>\<span class="hljs-title"><span class="hljs-title">behaviors</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">dosamigos</span></span>\<span class="hljs-title"><span class="hljs-title">helpers</span></span>\<span class="hljs-title"><span class="hljs-title">TransliteratorHelper</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">base</span></span>\<span class="hljs-title"><span class="hljs-title">Behavior</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">db</span></span>\<span class="hljs-title"><span class="hljs-title">ActiveRecord</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">helpers</span></span>\<span class="hljs-title"><span class="hljs-title">Inflector</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Slug</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Behavior</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $in_attribute = <span class="hljs-string"><span class="hljs-string">'name'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $out_attribute = <span class="hljs-string"><span class="hljs-string">'slug'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $translit = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">events</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ ActiveRecord::EVENT_BEFORE_VALIDATE =&gt; <span class="hljs-string"><span class="hljs-string">'getSlug'</span></span> ]; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSlug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $event )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute} ) ) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute} = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;generateSlug( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;in_attribute} ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute} = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;generateSlug( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute} ); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generateSlug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $slug )</span></span></span><span class="hljs-function"> </span></span>{ $slug = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;slugify( $slug ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;checkUniqueSlug( $slug ) ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $slug; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( $suffix = <span class="hljs-number"><span class="hljs-number">2</span></span>; !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;checkUniqueSlug( $new_slug = $slug . <span class="hljs-string"><span class="hljs-string">'-'</span></span> . $suffix ); $suffix++ ) {} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $new_slug; } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">slugify</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $slug )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;translit ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Inflector::slug( TransliteratorHelper::process( $slug ), <span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;slug( $slug, <span class="hljs-string"><span class="hljs-string">'-'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">slug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $string, $replacement = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'-'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, $lowercase = true )</span></span></span><span class="hljs-function"> </span></span>{ $string = preg_replace( <span class="hljs-string"><span class="hljs-string">'/[^\p{L}\p{Nd}]+/u'</span></span>, $replacement, $string ); $string = trim( $string, $replacement ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $lowercase ? strtolower( $string ) : $string; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkUniqueSlug</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $slug )</span></span></span><span class="hljs-function"> </span></span>{ $pk = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;primaryKey(); $pk = $pk[<span class="hljs-number"><span class="hljs-number">0</span></span>]; $condition = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;out_attribute . <span class="hljs-string"><span class="hljs-string">' = :out_attribute'</span></span>; $params = [ <span class="hljs-string"><span class="hljs-string">':out_attribute'</span></span> =&gt; $slug ]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;isNewRecord ) { $condition .= <span class="hljs-string"><span class="hljs-string">' and '</span></span> . $pk . <span class="hljs-string"><span class="hljs-string">' != :pk'</span></span>; $params[<span class="hljs-string"><span class="hljs-string">':pk'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;{$pk}; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;owner-&gt;find() -&gt;where( $condition, $params ) -&gt;one(); } }</code> </pre> <br></div></div><br><br>  The connection code is given above.  And an example of transliteration: <br><br><pre> <code class="php hljs">   test ÊàëÁà± ‰∏≠Êñá Œ® ·æâ «º √ü  =&gt; test-test-y-test-wo-ai-zhong-wen-ps-a-ae-ss-c</code> </pre> <br><br>  References: <br><ul><li>  <a href="http://yiiframework.com/">The official site of the framework Yii</a> </li><li>  <a href="http://yiiframework.ru/">Russian-speaking community</a> </li><li>  <a href="https://github.com/yiisoft/yii2">Repository on github yii2</a> </li><li>  <a href="https://github.com/yiisoft/yii2/tree/master/docs/guide">Currently written documentation for version 2</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/208328/">https://habr.com/ru/post/208328/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208314/index.html">We write virtual clipboard on C #</a></li>
<li><a href="../208318/index.html">Home CNC router as an alternative to 3D printer, part one - the choice of machine</a></li>
<li><a href="../208320/index.html">To work with a clear conscience</a></li>
<li><a href="../208322/index.html">Will SAFE replace convertible notes?</a></li>
<li><a href="../208326/index.html">MVVM: a new look</a></li>
<li><a href="../208330/index.html">Google engineers told about the success in recognizing house numbers from StreetView photos</a></li>
<li><a href="../208332/index.html">Meet the Intel Edison - SD-sized computer</a></li>
<li><a href="../208334/index.html">Winners of the 22nd IOCCC competition</a></li>
<li><a href="../208336/index.html">Toyota will sell fuel cell vehicles in 2015</a></li>
<li><a href="../208338/index.html">Jabber moves to full encryption</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>