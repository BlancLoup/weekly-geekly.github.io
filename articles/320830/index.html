<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Single line calculator, art or vice?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introductory 
 As is often the case when you are looking for a job, you pass one interview after another. Somewhere you choose, somewhere you. And pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Single line calculator, art or vice?</h1><div class="post__text post__text-html js-mediator-article"><h2>  Introductory </h2><br>  As is often the case when you are looking for a job, you pass one interview after another.  Somewhere you choose, somewhere you.  And probably, in the life of each of us there were interesting interviews, which you can gladly tell the public.  I want to tell about one such story, where there is a place for emotions, panic, stream of thinking and inspiration.  The article will focus on the internal experiences of the applicant, his confrontation with the interviewer, an interesting and brainwashing code in java, as well as the answer to the question: <i>"Is the unusual code an art or a vice?"</i>  .  You can plunge into your past and stretch your brains.  If intrigued, then let's go. <br><a name="habracut"></a><br><h2>  The story of one person X </h2><br>  Back in 2008, a guy named X was looking for a job as a programmer.  He had development experience, but not the same when he was torn off with his hands and feet.  Therefore, he was distracted by all vacancies and answered all calls.  And so it happened, X'a was invited to a serious company, where he had to pass only 2 interviews.  One, as usual, with the girls from the personnel department, which, incidentally, did not become a hindrance, and the second - technical, exciting, anxious, unknown heart.  The time has come X - interview.  After the accepted handshake, a young man, named Y, an interviewer, a true programmer - a haircut to the side, a jerk put up, said that he was very busy right now.  Well, once you have come, so be it, I will give you a pretty laptop and a puzzle - <i>'Write me a calculator.</i>  <i>A simple calculator, when the program receives an expression consisting of 2 numbers, separated by the sign '+', '-', '*', '/', which must be calculated.</i>  <i>You have an hour and a half. ‚Äù</i>  .  And at that moment, something important happened - <i>"Surprise me!"</i>  he added haughtily and left.  At this second, man X covered a barrage of negative emotions - <i>‚ÄúAha, schA.</i>  <i>I will reach AKS 74, 5.45 and make you dance lezginka and hum Nadezhda Babkina - 'Is it my fault?'</i>  <i>It will be amazing, dance as much as you like ... '</i> . <br><br>  But emotions and emotions to give way to common sense.  Rudeness is not an argument.  The process has begun, thoughts have begun to seethe: but calc.exe may cause, and OOP may be screwed, or an awesome expression parser may be done.  But no.  Just an hour and a half.  Can just do the task?  How to proceed?  The path was chosen - <i>I will do as I can and a semicolon.</i>  <i>Oh, and staging, oh, and interview.</i>  After about 20 minutes, a smile appeared on X'a's face.  It dawned on him!  And what if to write a calculator, the code of which would contain only 1 line, i.e.  only 1 semicolon, not counting packages and imports?  No sooner said than done.  By the end of the second hour the decision was ready.  2 hours.  Tired and a little confused Y came. <i>"Well, how?"</i>  He asked X'a.  <i>'Done!'</i>  - answered that. <br><br><h2>  Interesting and brainwave java code </h2><br>  So, dear reader, the time has come and you and I will try to solve the set, human X, problem.  Here is a more precise statement of the assignment: You need to write a calculator for a simple expression, which would contain exactly 1 line of code and know how to add, subtract, multiply and divide 2 numbers.  1 line - means exactly 1 semicolon, excluding the package and import declaration.  Only classes from jdk can be used for the solution.  Examples of the expression "7 + 4", "-12.0 * 14.12" without brackets and any tricks.  The solution must be issued in 1 static method, which displays the result in the console.  Do not touch the <b>main</b> function - it will call functions to check the results.  With restrictions, perhaps all.  Any tricks are welcome.  Originality too. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Options </h2><br>  In java 7, this is done quite simply and there is no need to be a genius.  We sacrifice a little accuracy and security.  Class will lead completely.  If you want to think to press the spoiler is not necessary. <br><br><div class="spoiler">  <b class="spoiler_title">Option number one</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.calculator; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.script.ScriptEngineManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.PrintStream; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Calculator1</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** *  ,    .   ? * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> expression    */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String expression)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { System.out.println(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ScriptEngineManager().getEngineByName(<span class="hljs-string"><span class="hljs-string">"JavaScript"</span></span>).eval(expression)); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception ex) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (PrintStream stream = (System.out.append(<span class="hljs-string"><span class="hljs-string">"Nan"</span></span>))) {} } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ calc(<span class="hljs-string"><span class="hljs-string">"+5 + -12"</span></span>); calc(<span class="hljs-string"><span class="hljs-string">"+5 * -12"</span></span>); calc(<span class="hljs-string"><span class="hljs-string">"+5 - -12"</span></span>); calc(<span class="hljs-string"><span class="hljs-string">"+5 / -12"</span></span>); } }</code> </pre> <br></div></div><br>  In 2008, such a trick would not have passed, so person X solved this problem in his own way.  Note: the code is still adapted for java 7, forgive. <br><br><div class="spoiler">  <b class="spoiler_title">Option number two</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.calculator; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.PrintStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.math.BigDecimal; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.math.MathContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.math.RoundingMode; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.regex.Matcher; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.regex.Pattern; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Calculator2</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * ,          * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> expression    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> args ,     */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String expression, Object ... args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">// 1.   System.out.println( // 2.      BigDecimal.class.getMethod( Arrays.asList("multiply", "add", "subtract", "divide").get( ((args = new Matcher[] { Pattern.compile( // 3.    . ,     &lt;b&gt;  &lt;/b&gt;,      . "[+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:[eE][+-]?\\d+)?\\s*([+-\\\\*/])\\s*[+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:[eE][+-]?\\d+)?$") .matcher(expression)})) != null &amp;&amp; ((Matcher) args[0]).find() ? // 4.     42: '*', 43: '+', 45: '-', 47: '/' -     0, 1, 2, 3 ((int) ((Matcher) args[0]).group(1).charAt(0) - 41) / 2 : -1), // 5.   BigDecimal.class, MathContext.class).invoke( // 6.    new BigDecimal(((args = new Matcher[] { Pattern.compile("([+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:[eE][+-]?\\d+)?)").matcher(expression)})) != null &amp;&amp; ((Matcher) args[0]).find() ? ((Matcher) args[0]).group(0) : ""), // 7.    new BigDecimal(((args = new Matcher[] { Pattern.compile("[+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:[eE][+-]?\\d+)?\\s*[+-\\\\*/]\\s*([+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:[eE][+-]?\\d+)?)$") .matcher(expression)})) != null &amp;&amp; ((Matcher) args[0]) .find() ? ((Matcher) args[0]).group(1) : ""), new MathContext(10, RoundingMode.HALF_EVEN))); } catch (Exception ex) { /**        */ try (PrintStream stream = (System.out.append("Nan"))) {} } } public static void main(String[] args) { calc("+5 + -12"); calc("+5 * -12"); calc("+5 - -12"); calc("+5 / -12"); } }</span></span></code> </pre> <br></div></div><br>  As in the well-known song: Well, what to say, what to say, is arranged so java, they want to know, they want to know, they want to know what will happen ... <br><br>  But we admit to ourselves that this code is too bulky and has repetitions.  And what if we strengthen the <b>restriction</b> and demand not to use the ternary operator at all?  Not immediately, but the solution was found. <br><br><div class="spoiler">  <b class="spoiler_title">Option number three</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.calculator; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.PrintStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.math.BigDecimal; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.math.MathContext; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.math.RoundingMode; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.regex.Matcher; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.regex.Pattern; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Calculator3</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * ,   ,    . * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> expression    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> args ,     */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String expression, Object ... args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">// 1.   System.out.println( // 2.      BigDecimal.class.getMethod( Arrays.asList("multiply", "add", "subtract", "divide").get( // 3.      args     (Integer) (args = new Object[] {args = new Object[] { Pattern.compile("([+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:[eE][+-]?\\d+)?)\\s*([+-\\\\*/])\\s*([+-]?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:[eE][+-]?\\d+)?)$"). matcher(expression)}, args[0], ((Matcher) args[0]).find(), ((Matcher) args[0]).group(1), ((int) ((Matcher) args[0]).group(2).charAt(0) -41) / 2, ((Matcher) args[0]).group(3)})[4]), // 4.   BigDecimal.class, MathContext.class).invoke( // 5.    new BigDecimal(args[3].toString()), // 6.    new BigDecimal(args[5].toString()), new MathContext(10, RoundingMode.HALF_EVEN))); } catch (Exception ex) { /**        */ try (PrintStream stream = (System.out.append("Nan"))) {} } } public static void main(String[] args) { calc("+5 + -12"); calc("+5 * -12"); calc("+5 - -12"); calc("+5 / -12"); } }</span></span></code> </pre> <br></div></div><br>  So much shorter and without repetitions, but the brain will explode.  I think there are a couple more solutions. <br><br>  Interestingly, <b>how</b> do the guys think that they put their thoughts on scala or kotlin or c # or ... if these restrictions, albeit with assumptions, are appropriate? <br><br><h2>  Conclusion </h2><br>  Thank you, dear reader, for your attention and patience.  As promised, I give my answer to the question: <i>"Is an unusual code an art or a vice?"</i>  .  I would say this: <i>"Through the eyes of the experimenter - art, through the eyes of production - a vice</i> ."  But no matter how this code is called, remember, you can try.  Separately, I want to apologize to the residents of habrahabr for the chosen presentation style, if something goes wrong.  This is an experimental approach on my part, thanks for understanding. </div><p>Source: <a href="https://habr.com/ru/post/320830/">https://habr.com/ru/post/320830/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320814/index.html">Features of the development of mobile MMO RTS. Part 3</a></li>
<li><a href="../320818/index.html">Shooting article: marketing and PR in IT</a></li>
<li><a href="../320824/index.html">Free SSL for CP Vesta - easy. And SSL for Laravel</a></li>
<li><a href="../320826/index.html">Salaries of "top" IT companies again hit the top</a></li>
<li><a href="../320828/index.html">Making your Skype with real-time speech translation, only better</a></li>
<li><a href="../320832/index.html">Larman's laws on organizational behavior</a></li>
<li><a href="../320834/index.html">Read tar in 26 lines of ANSI C code</a></li>
<li><a href="../320836/index.html">Video conferencing for one state organization: why we need hardware solutions</a></li>
<li><a href="../320840/index.html">"Baikal-T1": familiarity with the board on the first 28-nm processor in Russia</a></li>
<li><a href="../320842/index.html">Materials of journals of ITMO University: research in the field of image processing and computer modeling</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>