<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LIDAR from Mazda. We test, we put on Lada</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. 
 This time I got a real LIDAR from the Mazda CX5, approximately 2012, in my hands. release. In this article I intend to disassemble the module...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LIDAR from Mazda. We test, we put on Lada</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a87/c82/941/a87c82941e0147d1a83f314129b92761.jpg"><br><br>  Hello. <br>  This time I got a real LIDAR from the Mazda CX5, approximately 2012, in my hands.  release.  In this article I intend to disassemble the module and turn it on the table.  And the funny thing is, I will install this LIDAR in Datsun Mido (Lada Kalina nee). <br><a name="habracut"></a><br><img src="https://habrastorage.org/files/dd7/9f3/f59/dd79f3f598fc4d6b87a3ea34e982e226.JPG" alt="image"><br><br><img src="https://habrastorage.org/files/f35/111/9a3/f351119a347046cf9e02f31f57e25e3f.JPG" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Although LIDAR is written on the device, in fact, it is such a laser car tape measure, which is capable of measuring the distance to the object in front of it.  Main function ‚Äî Providing automatic braking in the event of a dangerous approach to another car, or, for example, a wall.  The device is one of the main Mazda cars in the ADAS complex and is manufactured by Continental (they are not only tires made from rubber).  The ADAS option is called CitySafety.  The automatic braking system is called Mazda ‚ÄìSCBS.  The obstacle detection range is 6 m, the system works at a speed of up to 40 km / h.  According to the manufacturer, the system will help prevent an accident at speeds up to 15 km / h and reduce the severity of the accident at speeds up to 30 km / h. <br><br>  Example of the system: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/T_xS0qNDDaY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  I note that the manufacturer‚Äôs website <a href="http://www.conti-online.com/www/industrial_sensors_de_en/">(link) was</a> able to find quite detailed documentation for the module.  From the documentation it follows that the device was not designed for a specific brand of cars, it has a sufficiently developed internal software that allows to measure the distance to the object, as well as the speed of this object. <br>  Here is an excerpt from the documentation on the main performance characteristics: <br><br>  Device purpose: <br><br><ul><li>  Collision Avoidance Sensor </li><li>  Measuring the distance to objects and measuring the speed of these objects in three independent channels.  At a distance of 13.5 m </li></ul><br>  The device has an internal health monitoring system for IR laser and IR radiation receivers. <br><br>  Characteristics declared by the manufacturer of the sensor: <br><br><ul><li>  Range: 1.0-10m.  Extended range up to 13.5 m </li><li>  Directional pattern 27 horizontally and 11 vertically </li><li>  Range resolution 1 mm </li><li>  The range of measured speeds 2-160 km \ h </li><li>  Accuracy of speed measurement + -2 km / h </li><li>  Measurement frequency 100 Hz </li><li>  Laser power 45 mW class 1 laser, 33 ns flash duration </li><li>  Wavelength 905 nm </li><li>  Work time 12000 hours or 15 years </li></ul><br>  The sensor has three measurement channels, one central and two lateral. <br><img src="https://habrastorage.org/files/a2d/203/a22/a2d203a221324fb3a1a772fde8a28dd1.png" alt="image"><br><br><img src="https://habrastorage.org/files/1dc/659/417/1dc6594179924103a625f39928b90170.png" alt="image"><br><br><h3>  We proceed to the inspection and preparation. </h3><br>  The device is quite compact, has three glass "eyes".  Two lenses for receiving the reflected radiation and one Fresnel lens for the formation of the necessary projection of the laser beam.  Assembled in a plastic case without the use of screws.  All on the clips. <br><br><img src="https://habrastorage.org/files/37e/6c5/d36/37e6c5d3645e428f844255e0e38b7a21.JPG" alt="image"><br><br><h3>  Interiors from the bottom </h3><br><img src="https://habrastorage.org/files/c1e/a7c/efe/c1ea7cefe0be43659d4209f8d7501fde.JPG" alt="image"><br><br>  Here is the radiating IR element - very unlike the laser.  Under the emitter is an IR photodiode that controls the presence of radiation.  The system is controlled by a 16-bit microcontroller MC9S12XEG128, specialized for automotive applications.  Also on this side are the elements of a pulsed power source. <br><br><h3>  Interiors from the top side </h3><br><br><img src="https://habrastorage.org/files/ca7/75f/0af/ca775f0affe64e4aa74b190e9c54f54e.JPG" alt="image"><br><br>  Here we see the mysterious microcircuit from ST, which, apparently, implements the functions of a laser rangefinder.  CAN transceiver, empty space for another CAN transceiver, two receiver lenses and an IR photocell board.  Directly under the lenses are two IR LEDs that serve to verify the performance of the receiver.  These elements are seen in the photo with the lenses removed.  The documentation for the device states that measurements are carried out on three independent channels; we can be sure of this by seeing three receiving elements. <br><br><img src="https://habrastorage.org/files/403/ab9/ac6/403ab9ac60034faca6fe4d491b018240.JPG" alt="image"><br><br><h3>  Connection on the table </h3><br>  Before connecting the device according to the datasheet, I determined the purpose of the connector pins on my own.  The device turned out to be easy to connect, it took only a 12V power supply and a CAN bus.  The CAN bus documentation was located on other pins, in my case they were not used and the empty space of the transceiver was intended for them.  The transfer rate in my CAN channel is 500 kbit \ s, unused, judging by the documents ‚Äî 1Mbit \ s. <br><br><img src="https://habrastorage.org/files/edb/02f/7b9/edb02f7b9ee141ef8f0b0726fa79f02b.png" alt="image"><br><br>  I connected the device to a typical standard laboratory source CAN bus to a Tektronix oscilloscope with a CAN decoder.  Immediately after switching on, the current consumption was 90 mA, with bursts of up to 130 mA approximately once per second.  Concluded that the lidar began to turn on the laser.  CAN bus also came to life immediately, a single packet appeared, which the oscilloscope easily recognized. <br><br><blockquote>  ID: 0x21D <br>  DLC 8 byte <br>  DATA: 0x7F 0x3F 0xFF 0x00 0x00 0x00 0xD2 0x94 </blockquote><br><img src="https://habrastorage.org/files/673/cc8/b95/673cc8b95b1542e2a7c9c88367381f00.JPG"><br><br><img src="https://habrastorage.org/files/7d3/21a/810/7d321a810d2d4eea9e3d768603485b51.JPG"><br><br><h3>  Car installation and testing. </h3><br>  I started installing the ‚Äúlidar‚Äù in my car by analogy with Mazda.  Just stuck it on the double-sided tape on the windshield in the area of ‚Äã‚Äãthe rear-view mirror.  Power supplied from the cigarette lighter socket. <br><br>  I connected to CAN using an adapter made 10 years ago that was compatible with the well-known CAN-Hacker program.  Unlike the first inclusion on the table, the first byte of the packet began to change immediately, until the lidar was fixed on Lobovyk.  Based on what I concluded that this byte is responsible for the measured distance. <br><br><img src="https://habrastorage.org/files/925/f3c/543/925f3c5430cb49e1ba4b2dbbd52508aa.jpg"><br><br><img src="https://habrastorage.org/files/073/81e/620/07381e620c8b457f926f57c0948e2a1e.jpg"><br><br>  In the guide to the protocol of lidar communication with the outside world, quite a lot of transmitted parameters are described.  In our case, it was possible to achieve only a measurement of the distance to the object in front. <br><br><h3>  Testing </h3><br>  For testing, a friend's car was chosen as a target.  The test was as follows: <br><br><ul><li>  Approaching as close as possible to the target, fixing the first byte of the packet </li><li>  We measure the distance to the target using a laser tape measure </li><li>  We compare these roulettes with the data transmitted by the lidar. </li></ul><br>  The correspondence between the value of the first byte of the LIDAR packet and the value measured by a laser tape measure: <br><br><blockquote>  0x41 = 2,054 m <br>  0x46 = 3.166 m <br>  0x49 = 3.8 m <br><br>  0x7F - target lost </blockquote><br>  It turned out that the lidar confidently measures the distance to the target of no more than 4 meters.  In my opinion, this is not the best result for the emergency brake system sensor.  It is possible that the device worked in some kind of simplified or test mode and on the vehicle the device measures the distance in a wider range.  We also conducted an experiment with a large glossy white board, in this case the distance was measured to 5 meters. <br><br><h3>  Summary </h3><br>  Continental's Mazda Short range LIDAR is an interesting device.  It would be desirable that the range of measuring the distance went beyond the 4-meter chapel.  If possible, I will try to configure it in the mode described in the documentation and allows me to measure long distances and velocities of objects.  Perhaps it will revive the second channel CAN.  If suddenly there is someone who wants to pick up the device in Novosibirsk, I will be glad to work together. <br><br>  I will add that the device is easy enough to find on the analysis at a price of 3,000 to 6,000 rubles. <br>  Catalog number: GHP9-67XD0 <br><br>  And finally, a movie about a device shot to the best of its own capabilities. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/c02iE7ldNsE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  References: <br><br>  ‚Üí <a href="http://www.conti-online.com/www/industrial_sensors_de_en/themes/srl_1_en.html">Continental, documentation</a> <br>  ‚Üí <a href="http://www.mazda.com/en/innovation/technology/safety/precrash_safety/sbs/">MAZDA</a> <br>  ‚Üí <a href="https://www.drive2.ru/l/1335061/">User story</a> </div><p>Source: <a href="https://habr.com/ru/post/399621/">https://habr.com/ru/post/399621/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../399609/index.html">Titan may be the best place for a colony in the solar system.</a></li>
<li><a href="../399613/index.html">NASA and the history of the agency‚Äôs variability</a></li>
<li><a href="../399615/index.html">How drones will change the industry</a></li>
<li><a href="../399617/index.html">Earnings on Forex. True or myth? Is it possible to make money on the forex market?</a></li>
<li><a href="../399619/index.html">Prowling the IRS, Hidden by the Federal Tax Service: how do the Russian and US tax services deal with crypto currency traders</a></li>
<li><a href="../399623/index.html">How a cryptographer made a free ride on the San Francisco Railway</a></li>
<li><a href="../399625/index.html">Ask Ethan # 111: Do galaxies die?</a></li>
<li><a href="../399627/index.html">Pseudoscience and speculators. Fake science journals</a></li>
<li><a href="../399629/index.html">Artificial Intelligence on the Xeon Platform. Intel buys Nervana</a></li>
<li><a href="../399631/index.html">What should we build a spacesuit? Interview with spacesuit developer Nikolai Moiseev, part 4</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>