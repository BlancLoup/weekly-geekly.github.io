<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Horse my black</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wow, geniuses. I used to be a genius too, and now I‚Äôm writing toys for the iPhone. Last week Apple and Google excited me a lot, trying to deprive appl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Horse my black</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/c57/a0c/fbd/c57a0cfbd2824729b5478caca2f3c949.png"></div><br>  Wow, geniuses.  I used to be a genius too, and now I‚Äôm writing toys for the iPhone.  Last week Apple and Google excited me a lot, trying to deprive applications and revenues.  I had to sweat and make 7 games in 7 days on Swift 3.0.  At the same time, I did not look into the old Obj-C code of the old games - it is so much easier to make applications in a new language. <br><br>  Before, when I was a genius, every time I had to re-write the sort function (as an element of the game) and then be proud of it.  God, what an idiot I was.  However, not much I have changed.  But the tool has changed.  See what sorting now looks like in Swift 3.0. <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> vtxSorted = vtx.sorted(<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>:{ $<span class="hljs-number"><span class="hljs-number">0.</span></span>yPosition &gt; $<span class="hljs-number"><span class="hljs-number">1.</span></span>yPosition })</code> </pre> <br>  And that's it!  VTX vertex array sorted by Y coordinate ... <br>  Yes, why is this necessary?  But why ... <br><a name="habracut"></a><br>  Sorting by coordinate is needed to build a Voronoi diagram, about which there were quite a few articles on Habr√©. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Voronoi diagram </h3><br>  You all know about convex-hull and how to build it.  In Russian, this is called the Voronoi diagram.  Let me remind you for pkhpeshnikov that this is a grid equidistant from all points scattered on the plane in disarray.  Replace the plane with the iPhone screen, dots with bold white pixels and get this picture. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ca6/a37/b0a/ca6a37b0a42548e3b723bc404032a566.png"></div><br>  Nice and immediately want to write some game.  So I did back in 2009, when you, the reader, did not even know about Ruby, who instead of Anna Karenina now lies on the tracks. <br><br>  Yes, and let him lie, and we fly away into the distance - that's when I made the game on OpenGL and did not earn anything on it.  Maybe I received $ 50 in 5 years, but this is unlikely. <br><br>  But the game is cool.  You poke your finger at the screen and you are nervous that you do not have time to remove all the cells from the board.  What else is needed for happiness?  Well, maybe a little candy and jam.  Moreover, in the prime of life. <br><br>  And so I decided to remake the game in a new way.  Just a bright picture with a hot topic about elections in the US came across the Internet, which I made as an application icon.  He replaced the points with Clintonicha and Trump-pam-pam, the grid with the States - and rushed to program in pure Swift. <br><br><h3>  Ambush with opengl </h3><br>  Why OpenGL?  To draw textured triangles.  Pouring pure color is in the garden.  Kindergarten. We will have only hardcore! <br><br>  Aaaa!  Nope  I'm not talking about the defender of Zenith.  There is no Swift API for calling OpenGL functions!  Estimate, peppers!  Okay, let's play with cheeks and try metal.  This is a fashionable library, which Apple made instead of OpenGL, with similar functionality and interface, but supposedly working faster on native hardware. <br><br><h3>  Ambush with Metal </h3><br>  This library does not work on the simulator!  Atas!  When Jobs was not like this.  Hold me 100 people!  Three thousand devils.  Life seems to have been wasted.  And so sad, with a shattered dream, I wandered under the sudden Balkan rain and listened to the rye of the local guys.  However, the girl laughed even louder.  Suddenly, as a green-eyed taxi checkered, a thought struck me - no need for libraries, kind man!  I will be able to draw a triangle with a texture myself, on a clean UIKit, on the Strigier, dear to my heart.  And not even a triangle, but a whole polygon, which is even steeper. <br><br>  How?  But look at the code, the Russian language is powerless here. <br><br><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mask = CAShapeLayer() mask.frame = groundTrump.layer.bounds <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> path = CGMutablePath() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> app.trumpTriangles { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> t.flag == <span class="hljs-number"><span class="hljs-number">0</span></span> { path.closeSubpath() <span class="hljs-comment"><span class="hljs-comment">//   path.move(to: tp) //   } else { path.addLine(to: tp) //     } } mask.path = path groundTrump.layer.mask = mask1</span></span></code> </pre><br>  Yes, the mask steers and I know it.  And now you know too.  Go ahead, you need to write a grid generation algorithm.  I love grids, my dissertation was about gridless methods (SPH).  Here P - particles. <br><br>  By the way, on github lie overseas algorithms for building the Voronoi diagram grid on Swift 3.0.  Two whole.  Unfortunately, the first of them does not take into account the rectangular border, the other works with error errors.  I had to write the program myself, which was wonderful, the brains curled up to the side, clockwise.  It is clockwise that I go around each vertex separately and the entire array of points in general.  The Fletcher method did not use, sorted the points by the corner and fried stupidly O (N ^ 2).  At 50 points, this does not matter, although on the iPhone 4S it noticeably slows down.  But who has the iPhone 4S now?  Even the editors of Habr√© do not use them. <br><br>  What else?  The game is not posted to the store, maybe I'll do it tomorrow, but I suggest you take a look at the video of the <i>gameplay</i> and admire my amazing work in the comments. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/axb5DqQNEH0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Chao, see each other. </div><p>Source: <a href="https://habr.com/ru/post/312840/">https://habr.com/ru/post/312840/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312828/index.html">Cisco and Apple partnership for business mobility transformation</a></li>
<li><a href="../312830/index.html">Problem on std :: multiset or search by structure fields</a></li>
<li><a href="../312832/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ232 (October 10 - 16, 2016)</a></li>
<li><a href="../312834/index.html">Excel, SQL and the legendary barometer - we solve a simple problem in different ways</a></li>
<li><a href="../312838/index.html">MariaDB at Google Summer of Code: GSoC16 Results</a></li>
<li><a href="../312842/index.html">As a programmer, I bought a car. Part II</a></li>
<li><a href="../312844/index.html">Own BaaS c subject area modeling, scripts and more for half an hour</a></li>
<li><a href="../312848/index.html">26 ways to increase the delivery of your letters</a></li>
<li><a href="../312850/index.html">Increase employee productivity: how to optimize workflow using checklists</a></li>
<li><a href="../312852/index.html">The loud history of the Opera browser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>