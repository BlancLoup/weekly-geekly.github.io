<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dual authentication Vkontakte - sex or imitation?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! Recently I decided to test a hardware OTP token with the possibility of flashing over NFC by connecting it to my account in vk.com. At the same...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dual authentication Vkontakte - sex or imitation?</h1><div class="post__text post__text-html js-mediator-article"><p>  Hello!  Recently I decided to test a hardware OTP token with the possibility of flashing over NFC by connecting it to my account in vk.com.  At the same time I came across flaws in the two-factor authentication system of Vkontakte, which seemed to me quite significant.  I want to share my observations with you, because I didn‚Äôt recognize errors in VK itself.  Maybe I'm a little paranoid?  I wonder what you say, habrovchane. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/files/53e/cdf/c1e/53ecdfc1ee2e4d049a9e01067a400dd6.jpg"></div><a name="habracut"></a><br><p>  <em>I will make a reservation that before starting to work on an article, I made all my observations on HackerOne.</em>  <em>None of the described bugs Vkontakte not recognized.</em>  <em>But when, before publishing the article, I decided to make confirming screenshots, it turned out that one of the bugs was fixed.</em>  <em>That listened to my words, can not but rejoice.</em>  <em>The only pity is that the guys didn't even say ‚Äúthank you‚Äù.</em> </p><br><h2>  So, the error number 1.  Static secret key. </h2><br><img src="https://habrastorage.org/files/9d1/a65/6b5/9d1a656b5cdc449ea3743eb6e560f38b.png"><br><br><p>  In order to connect an application for generating OTP to your account, the user enters a password, before which a page opens with a secret key needed to issue a software token.  So far, everything is correct. </p><br><img src="https://habrastorage.org/files/a6b/4e7/adb/a6b4e7adbe3946758605c77831ff30a6.jpg"><br><br><p>  But if for any reason the user did not activate the software token right away (for example, he was distracted by an important call, or simply changed his mind and returned to the main page), then after a while he would decide to get the token, he would again be offered the same secret key. </p><br><p>  The situation is aggravated by the fact that within half an hour after entering the password, even if you went to the main page or logged out of your account, and then logged in again, before displaying the QR code with a secret, no password is requested again. </p><br><img src="https://habrastorage.org/files/e6b/fb1/8dc/e6bfb18dc1ed4f1bb5190340b7471a6a.jpg"><br><img src="https://habrastorage.org/files/51d/10d/e43/51d10de43ed04020a8aa02befca227b1.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Why is this dangerous? </h3><br><p>  The Vkontakte Token, like any other TOTP token, works according to a fairly simple principle: it generates one-time passwords using an algorithm based on two parameters ‚Äî time and secret key.  As you understand, the only thing that is needed to compromise the second factor of authentication is to know the SECRET KEY. </p><br><p>  Such a vulnerability leaves the attacker two loopholes: </p><br><ol><li>  If the user moves away from the computer, the attacker will have enough time to compromise his secret key. </li><li>  Having seized the user's password, the attacker can easily peep his secret key in advance. </li></ol><br><img src="https://habrastorage.org/files/b93/493/447/b934934478ff4a4bb8bf08bf1c12eeec.jpg"><br><br><p>  Solving the problem is simple.  The secret key should change every time after refreshing the page, as it happens, for example, in Facebook. </p><br><h2>  Error number 2.  A new token after reissue uses the same secret key. </h2><br><img src="https://habrastorage.org/files/177/b03/5ff/177b035ff03641628cb9974229f45797.png"><br><br><p>  <em>At the time of publication of the article, this flaw was eliminated.</em> </p><br><p>  The situation described above is aggravated by the fact that when you re-issue a token, Vkontakte will not offer you a new secret key.  In fact, one secret key is tied to your page and you can no longer change it. </p><br><h3>  Why is this dangerous? </h3><br><p>  If you find out that your secret key is compromised (for example, when you first issued a token, as described in the first paragraph), you no longer need double authentication of Vkontakte.  Feel free to turn off the second factor and pick up a better password.  Re-issue a token with a new secret is not possible. </p><br><p>  If you lost the phone on which the token was installed, you can do the same.  The one who got your smartphone in his hands will be able to safely use it to log into your account.  It remains to find out only the password.  In this case, the whole essence of two-factor authentication is lost.  It is clear that if the user notices the discredit of his account, he can contact the caliper, but this will spend valuable time, which he may not have. </p><br><h2>  Mistake number 3. Disabling the second factor without asking for a one-time password. </h2><br><img src="https://habrastorage.org/files/e8e/5b0/cec/e8e5b0cec71440c19cf5008162256c37.png"><br><br><p>  Here everything is clear from the name.  When you disable the second factor, just enter the password, OTP is not requested. </p><br><img src="https://habrastorage.org/files/4b6/e29/2bb/4b6e292bb90c41d9beb760bf08f978b1.jpg"><br><img src="https://habrastorage.org/files/286/8c0/074/2868c0074d654a49955290e660e37fb6.jpg"><br><br><h3>  Why is this dangerous? </h3><br><p>  If only a password entry is enough to disable double authentication of Vkontakte, the essence of two-factor authentication is lost.  And the essence of two-factor authentication is that the disadvantages of one factor overlap with the advantages of another.  In vk.com, this is the knowledge factor (password) and the ownership factor (phone).  This was invented so that the compromise of one of the factors was not enough to gain access to the account.  If an intruder has your password, he will not have a one-time password to break into his account, and vice versa, if he takes possession of your phone, he will need to know the password additionally. </p><br><p>  It also turns out that it is enough to know the user's password in order to simply disable the second authentication factor.  In fact, this turns Vkontakte two-factor authentication into one-factor authentication. </p><br><p>  Vkontakte offers its users a very convenient feature ‚ÄúRemove confirmation from the current browser‚Äù.  I am sure that the feature is popular and users turn off the confirmation at least at home and at work.  Moreover, most users have their passwords stored in browsers, where they can be easily viewed and copied. </p><br><p>  Imagine this situation, your colleague decided to make fun of you.  While you were not at work, he went to your computer, looked at the saved passwords in the browser, logged into VK and disconnected 2FA.  Now he will be able to log into your account until you notice a change, which may not happen soon.  You have never entered a one-time password on the devices you use most often, so nothing will change for you.  A joker colleague will have full access to your account, and no one knows what this may lead to. </p><br><p>  If the bug with the token re-issue had not been fixed, when the secret key did not change when the token was re-released, the situation could have become even more interesting!  Your colleague, already knowing the password, could have disabled 2FA, after which he connected the two-factor authentication again, he would have seen the secret key, issued himself a token identical to yours, and could read your messages as long as your account is alive. </p><br><h2>  findings </h2><br><p>  When you connect two-step authentication to your Vkontakte account, a reminder appears that says, ‚ÄúEven if an attacker finds out your login, password, and verification code used, he will not be able to get to your page from his computer." </p><br><img src="https://habrastorage.org/files/2f4/472/fec/2f4472fec26d4e4eb7b7b039105347b3.jpg"><br><br><p>  Unfortunately, it turned out that this is not entirely true.  Under certain circumstances, an outsider will be able to recognize someone else's token on Vkontakte, or even completely disable the second factor, knowing your password.  Waiting for your opinions. </p></div><p>Source: <a href="https://habr.com/ru/post/315862/">https://habr.com/ru/post/315862/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315850/index.html">Antidote - TOX client for iOS has finally become available</a></li>
<li><a href="../315852/index.html">Skills experienced programmer: The most popular tips for beginners</a></li>
<li><a href="../315854/index.html">International competition for young researchers and information security professionals</a></li>
<li><a href="../315856/index.html">Where to live well in the world, or 5 reasons to go Viking trail</a></li>
<li><a href="../315860/index.html">Monitoring Elasticsearch through pain and suffering</a></li>
<li><a href="../315864/index.html">Analysis of the report of Sergey Kuksenko with JPoint 2016</a></li>
<li><a href="../315868/index.html">Non-game VR: Perspectives and Opportunities on the Web - Interview with VR enthusiast Martin Splitt, Archilogic</a></li>
<li><a href="../315870/index.html">More examples of using R to solve practical business problems</a></li>
<li><a href="../315872/index.html">How companies attract the best IT professionals to work - expert answers</a></li>
<li><a href="../315874/index.html">How to get new settings for the game? Try the meta games</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>