<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Standard PHP Library (SPL) - Part 1: Data Structures</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! This article discusses the Standard PHP Library (SPL). On Habr√© there is still no intelligent manual about this library, which has already b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Standard PHP Library (SPL) - Part 1: Data Structures</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  This article discusses the Standard PHP Library (SPL).  On Habr√© there is still no intelligent manual about this library, which has already become part of the PHP core (since version 5.3).  This library contains a set of interfaces, classes of data structures, iterators, and functions with which you can greatly simplify your life and improve the quality of the code.  In this article I consider such a part of the library as data structures.  I will also show alternative solutions to the tasks and compare the speed of implementation in both cases. <br><br><a name="habracut"></a><br>  So.  First of all I want to give a link to the official documentation: <a href="http://php.net/manual/en/book.spl.php">php.net/manual/en/book.spl.php</a> <br>  The SPL library contains the following data structures: <br><br><ul><li>  SplDoublyLinkedList - Twofold Lists </li><li>  SplStack - Stack </li><li>  SplQueue - Queue </li><li>  SplHeap - Heap </li><li>  SplMaxHeap - Sort Heap Descending </li><li>  SplMinHeap - Sort Heap Ascending </li><li>  SplPriorityQueue - Priority Queues </li><li>  SplFixedArray - Limited Length Array </li><li>  SplObjectStorage - Object Storage </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Consider in order each of the structures. <br><br><h3>  SplDoublyLinkedList </h3><br>  A doubly linked list (DLL) is a list of nodes connected in both directions between each other.  As you know, there are two principles for extracting values ‚Äã‚Äãfrom the list - FIFO (First In First Out - first went, first left) and LIFO (Last In First Out - last went, first left).  With SplDoublyLinkedList, values ‚Äã‚Äãcan be retrieved according to any of these principles.  Therefore, it can be used to easily organize a stack or a queue. <br><br><h3>  Splstack </h3><br>  This class is the successor of SplDoublyLinkedList and implements the stack, for example: <br><br><pre><code class="php hljs">$stack = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SplStack(); <span class="hljs-comment"><span class="hljs-comment">//     $stack-&gt;push('1'); $stack-&gt;push('2'); $stack-&gt;push('3'); echo $stack-&gt;count(); // 3 echo $stack-&gt;top(); // 3 echo $stack-&gt;bottom(); // 1 echo $stack-&gt;serialize(); // i:6;:s:1:"1";:s:1:"2";:s:1:"3"; //     echo $stack-&gt;pop(); // 3 echo $stack-&gt;pop(); // 2 echo $stack-&gt;pop(); // 1</span></span></code> </pre> <br><br>  Previously, we used the procedural method to create, namely, we used the functions of array_push - adding elements to the end of the array and array_pop - extracting the last element.  Now we work with objects. <br><br>  Compare the speed of the two ways.  Test conditions: PHP 5.3.18, Core 2 Duo P7350, Windows.  Add a number from 1 to n to the stack and retrieve everything from the stack. <br><br><table><tbody><tr><th>  Number of push and pop </th><th>  Use of functions </th><th>  Using SplStack </th><th>  Attitude </th></tr><tr><td>  1000 </td><td>  0.007686 </td><td>  0.008559 </td><td>  0.898002 </td></tr><tr><td>  100,000 </td><td>  0.793184 </td><td>  0.884979 </td><td>  0.896274375 </td></tr></tbody></table><br>  In this test, the method using functions worked faster by about 10-15%. <br><br>  For the sake of interest, I conducted another test in PHP 5.4.8 <br><table><tbody><tr><th>  Number of push and pop </th><th>  Use of functions </th><th>  Using SplStack </th><th>  Attitude </th></tr><tr><td>  1000 </td><td>  0.008186 </td><td>  0.008735 </td><td>  0,937149399 </td></tr><tr><td>  100,000 </td><td>  0.732347 </td><td>  0.771456 </td><td>  0,949304951 </td></tr></tbody></table><br>  By this test, you can see that PHP 5.4.8 is faster than PHP 5.3.18 when working with a stack by about 10% and work with objects is also improved.  Therefore, I will conduct all subsequent tests on this version of PHP. <br><br>  However, if you add more complex objects to the stack, the difference between the results is already at the level of error. <br><br>  In this test, we added and removed from the stack the following object: <br><br><pre> <code class="php hljs">$obj = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"10"</span></span>, <span class="hljs-string"><span class="hljs-string">"20"</span></span>, <span class="hljs-string"><span class="hljs-string">"qwerty"</span></span>, <span class="hljs-string"><span class="hljs-string">"100"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"one"</span></span>, <span class="hljs-string"><span class="hljs-string">"two"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">"100"</span></span>) ) );</code> </pre><br><table><tbody><tr><th>  Number of push and pop </th><th>  Use of functions </th><th>  Using SplStack </th><th>  Attitude </th></tr><tr><td>  1000 </td><td>  0.007974 </td><td>  0.008301 </td><td>  0,960607156 </td></tr><tr><td>  100,000 </td><td>  0.818596 </td><td>  0.826363 </td><td>  0.990600983 </td></tr></tbody></table><br>  In real-world applications, objects will be much more complicated, so I dare to suggest that a significant advantage will be on the side of the method from SPL. <br><br><h3>  Splquueue </h3><br>  This structure is used to create queues.  Everything is similar to the stack, consider only a small example: <br><br><pre> <code class="php hljs">$queue = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SplQueue(); $queue-&gt;setIteratorMode(SplQueue::IT_MODE_DELETE); $queue-&gt;enqueue(<span class="hljs-string"><span class="hljs-string">'one'</span></span>); $queue-&gt;enqueue(<span class="hljs-string"><span class="hljs-string">'two'</span></span>); $queue-&gt;enqueue(<span class="hljs-string"><span class="hljs-string">'qwerty'</span></span>); $queue-&gt;dequeue(); $queue-&gt;dequeue(); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $queue-&gt;top(); <span class="hljs-comment"><span class="hljs-comment">// qwerty</span></span></code> </pre><br><br><h3>  Splheap </h3><br>  Heaps are tree structures: each node is greater than or equal to its descendants, and an embedded comparison method is used for comparison, which is common to the entire heap.  SplHeap implements the core functionality of the heap and is an abstract class. <br><br><h3>  SplMaxHeap and SplMinHeap </h3><br>  Two classes are inherited from SplHeap: SplMaxHeap - to sort an array in descending order of its values, SplMinHeap - to sort an array in ascending order. <br><br><pre> <code class="php hljs"> $heap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SplMaxHeap(); $heap-&gt;insert(<span class="hljs-string"><span class="hljs-string">'111'</span></span>); $heap-&gt;insert(<span class="hljs-string"><span class="hljs-string">'666'</span></span>); $heap-&gt;insert(<span class="hljs-string"><span class="hljs-string">'777'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $heap-&gt;extract(); <span class="hljs-comment"><span class="hljs-comment">// 777 echo $heap-&gt;extract(); // 666 echo $heap-&gt;extract(); // 111 $heap = new SplMinHeap(); $heap-&gt;insert('111'); $heap-&gt;insert('666'); $heap-&gt;insert('777'); echo $heap-&gt;extract(); // 111 echo $heap-&gt;extract(); // 666 echo $heap-&gt;extract(); // 777</span></span></code> </pre><br><br><h3>  SplPriorityQueue </h3><br>  This structure is a priority queue.  For each element, you can set its priority.  Sorting is performed depending on the priority. <br><br><pre> <code class="php hljs"> $queue = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SplPriorityQueue(); $queue-&gt;setExtractFlags(SplPriorityQueue::EXTR_DATA); <span class="hljs-comment"><span class="hljs-comment">//     $queue-&gt;insert('Q', 1); $queue-&gt;insert('W', 2); $queue-&gt;insert('E', 3); $queue-&gt;insert('R', 4); $queue-&gt;insert('T', 5); $queue-&gt;insert('Y', 6); $queue-&gt;top(); while($queue-&gt;valid()) { echo $queue-&gt;current(); $queue-&gt;next(); } //YTREWQ</span></span></code> </pre><br><br><h3>  SplFixedArray </h3><br>  The structure is an array with a fixed number of elements.  SplFixedArray stores data in a continuous form, accessible through indexes, and regular arrays are implemented as ordered hash tables.  This type of array works faster than regular arrays, but there are some constraints: <br><br><ul><li>  only integers&gt; 0 can be used as keys </li><li>  length can be changed, but it is a costly operation </li></ul><br><br>  This structure is well suited for numbered lists.  Let's take an example and run tests: <br><br><pre> <code class="php hljs"> $a = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SplFixedArray(<span class="hljs-number"><span class="hljs-number">10000</span></span>); $count = <span class="hljs-number"><span class="hljs-number">100000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($i =<span class="hljs-number"><span class="hljs-number">0</span></span>; $i&lt;$count; $i++) { $a[$i] = $i; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($i==<span class="hljs-number"><span class="hljs-number">9999</span></span>) $a-&gt;setSize(<span class="hljs-number"><span class="hljs-number">100000</span></span>); }</code> </pre><br><br><table><tbody><tr><th>  Number of push and pop </th><th>  Ordinary array </th><th>  Using SplFixedArray </th><th>  Attitude </th></tr><tr><td>  100 </td><td>  8.2 x 10E-5 </td><td>  6.3 x 10E-5 </td><td>  1,301587301 </td></tr><tr><td>  10,000 </td><td>  0.004953 </td><td>  0.003983 </td><td>  1.243535024 </td></tr><tr><td>  100,000 </td><td>  0.053586 </td><td>  0.0385701 </td><td>  1,389314521 </td></tr><tr><td>  1,000,000 </td><td>  0.533003 </td><td>  0.384391 </td><td>  1.386616752 </td></tr></tbody></table><br>  Tests have confirmed that SplFixedArray is leading with any previously known number of array elements.  However, if the size of the array changes during the process, the advantage becomes less significant: (initially the size was set to 10,000, then expanded to 100,000): <br><table><tbody><tr><th>  Number of push and pop </th><th>  Ordinary array </th><th>  Using SplFixedArray </th><th>  Attitude </th></tr><tr><td>  1,000,000 </td><td>  0.051937 </td><td>  0.049462 </td><td>  1,050038413 </td></tr></tbody></table><br><br><h3>  SplObjectStorage </h3><br>  This structure is a repository of objects.  Objects can be attached to the repository, delete, get the current object.  Consider a few examples from the official manual: <br><pre> <code class="php hljs">$s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SplObjectStorage(); <span class="hljs-comment"><span class="hljs-comment">//   $o1 = new StdClass; $o2 = new StdClass; $o3 = new StdClass; $s-&gt;attach($o1); //     $s-&gt;attach($o2); var_dump($s-&gt;contains($o1)); // bool(true) var_dump($s-&gt;contains($o2)); // bool(true) var_dump($s-&gt;contains($o3)); // bool(false) $s-&gt;detach($o2); //     var_dump($s-&gt;contains($o1)); // bool(true) var_dump($s-&gt;contains($o2)); // bool(false) var_dump($s-&gt;contains($o3)); // bool(false)</span></span></code> </pre><br>  One more example: <br><pre> <code class="php hljs">$s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SplObjectStorage(); $o1 = (object)<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'a'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>); $o2 = (object)<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'b'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">2</span></span>); $o3 = (object)<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'c'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">3</span></span>); $s[$o1] = <span class="hljs-string"><span class="hljs-string">"data for object 1"</span></span>; $s[$o2] = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>($s <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $i =&gt; $key) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Entry $i:\n"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// You get a numeric index var_dump($key, $s[$key]); echo "\n"; }</span></span></code> </pre><br>  Result: <br><pre> <code class="php hljs">Entry <span class="hljs-number"><span class="hljs-number">0</span></span>: object(stdClass)<span class="hljs-comment"><span class="hljs-comment">#2 (1) { ["a"]=&gt; int(1) } string(17) "data for object 1" Entry 1: object(stdClass)#3 (1) { ["b"]=&gt; int(2) } array(3) { [0]=&gt; int(1) [1]=&gt; int(2) [2]=&gt; int(3) }</span></span></code> </pre><br>  This concludes our study of SPL data structures.  We learned how to quickly create stacks, queues, and lists.  We now know about SplFixedArray, which is faster than a regular array.  However, this is a very small part of the use of this library.  In the following articles, iterators, interfaces, functions, and exception handling will be considered. </div><p>Source: <a href="https://habr.com/ru/post/161987/">https://habr.com/ru/post/161987/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161973/index.html">The long-awaited revolutionary release of QEMU 1.3 has been released.</a></li>
<li><a href="../161975/index.html">How to draw Zelenograd</a></li>
<li><a href="../161977/index.html">Box2d and libgdx</a></li>
<li><a href="../161979/index.html">One Div: icons on CSS</a></li>
<li><a href="../161981/index.html">Promotion of mobile applications</a></li>
<li><a href="../161989/index.html">Perl6 - I / O Modules</a></li>
<li><a href="../161991/index.html">Weather Station Thunder-2M (Anemometer)</a></li>
<li><a href="../161993/index.html">Programmable microcontroller STM32 - right off the bat</a></li>
<li><a href="../161997/index.html">Comfortable lighting for work and leisure</a></li>
<li><a href="../161999/index.html">256 colors in the terminal ‚áí nightmare level</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>