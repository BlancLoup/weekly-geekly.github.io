<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The first program for OS X do-it-yourself - the clipboard manager</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="More than a year has passed since I became interested in programming for the iOS platform. Finally, I found some free time to try my hand on the OS X ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The first program for OS X do-it-yourself - the clipboard manager</h1><div class="post__text post__text-html js-mediator-article">  More than a year has passed since I became interested in programming for the iOS platform.  Finally, I found some free time to try my hand on the OS X platform. If you have long been interested in the OS X platform but are not going to start, this article is for you!  Under the cat a detailed description of the process of creating an application - the clipboard manager.  All sources can be found at <a href="https://github.com/k06a/Clipshare">github.com/k06a/Clipshare</a> <br><br><img src="http://habrastorage.org/storage3/ae6/241/176/ae62411765e5f5e9a4b712a37cbdd3d7.png"><br><a name="habracut"></a><br><h4>  We prepare the project for work </h4><br>  Without hesitation, I created in Coccode 5 a project like <i>Cocoa Application</i> named "Clipshare".  In the newly created project, we can observe the following files: <br><br><img src="https://habrastorage.org/storage3/654/5a5/1d1/6545a51d163a83e3d479fdc38051ee00.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The <i>ABAppDelegate.h</i> and <i>ABAppDelegate.m files</i> belong to the application delegate class, and in them we will just write all of our code.  In the <i>MainMenu.xib</i> file <i>,</i> we will draw and customize the graphical interface of the application. <br><br>  Having thought carefully, we decide that our application should be windowless and should hang in the status bar (near the watch).  The first thing we need is to remove the standard menu bar and the window object from the <i>MainMenu.xib</i> file ‚Äî we will not need them.  Next, create a menu object with 2 items: a separator and an exit point from the application.  This is done by simply dragging objects from the library onto the canvas.  To use the <i>Quit</i> menu item, just hold down the Ctrl key and drag a blue thread from the menu item to the <i>Application</i> object: <br><br><img src="https://habrastorage.org/storage3/cd8/97a/403/cd897a4036a24a0217c4a06ecb09104a.png"><br><br>  After we release the mouse button, a window will appear with a list of selectors (methods) available for the connection.  Among the presented methods, we are suitable- <code>-terminate</code> : <br><br><img src="https://habrastorage.org/storage3/e19/1e0/5c6/e191e05c666c64e33eb4d0824b57718b.png"><br><br>  Now you need to be able to access our menu from the code.  In order to customize its display in the status line of OS X and a lot more for what.  Open the assistant mode, when you see 2 documents in the Xcode window at once, leave the GUI in the first one, and select the application source code in the second: <i>ABAppDelegate.h</i> .  And just like last time with the Ctrl key held down, we‚Äôll stretch the blue thread from the menu, but now to the source code.  You need to <code>@interface</code> into the <code>@interface</code> code section in the <code>@interface</code> file (the <i>window</i> property I have already deleted from this file as unnecessary): <br><br><img src="https://habrastorage.org/storage3/a61/15e/1af/a6115e1af394c26a2a2c900973426df3.png"><br><br>  As soon as we let go of the pressed mouse button, a dialog box pops up with the settings of the <i>Outlet</i> being created (a property in the code that refers to the GUI object).  It remains only to specify the name of the property, for example, "menu": <br><br><img src="https://habrastorage.org/storage3/f44/949/214/f44949214178ae05e77944840538fbf1.png"><br><br>  Now we are switching to the source code of the application.  In <i>ABAppDelegate.m</i> , we have only 1 method and that one is empty: <br><br><pre> <code class="hljs objectivec">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)applicationDidFinishLaunching:(<span class="hljs-built_in"><span class="hljs-built_in">NSNotification</span></span> *)aNotification { <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre> <br>  Inside this method, it will enter the code, first of all binding our menu to the OS X status bar: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.statusBar = [[<span class="hljs-built_in"><span class="hljs-built_in">NSStatusBar</span></span> systemStatusBar] statusItemWithLength:<span class="hljs-built_in"><span class="hljs-built_in">NSVariableStatusItemLength</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.statusBar.title = <span class="hljs-string"><span class="hljs-string">@"CS"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.statusBar.menu = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.menu; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.statusBar.highlightMode = <span class="hljs-literal"><span class="hljs-literal">YES</span></span>;</code> </pre> <br>  For this code to work, you must also declare the <code>statusBar</code> property in the <code>@interface</code> section: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">@property</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">strong</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">nonatomic</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">NSStatusItem</span></span> *statusBar;</code> </pre> <br>  To be able to check our application, you just need to add 1 key with the value <code>YES</code> to the <i>Clipshare-Info.plist file</i> , it will allow our application to work without a window: <br><br><img src="https://habrastorage.org/storage3/804/137/4e3/8041374e3c1179a12d5d0d34efeac4a1.png"><br><br>  We launch our application and observe it in the status bar of OS X and we can even exit it via Cmd-Q or simply by pointing to the single menu item: <br><br><img src="https://habrastorage.org/storage3/756/74d/6c8/75674d6c802b1d19a7d2588e0401e328.png"><br><br><h4>  We introduce the main logic </h4><br>  I suggest checking the contents of the clipboard on a timer every half second, and depending on what we find in it, perform certain actions.  Apparently, there is no other way to learn about changes in the clipboard, and pity ( <a href="http://stackoverflow.com/a/5033480/440168">stackoverflow.com/a/5033480/440168</a> ).  Ok, set the timer.  Create a timer object, tell it what method and how often it should call and add a timer to the message loop: <br><br><pre> <code class="hljs objectivec"><span class="hljs-built_in"><span class="hljs-built_in">NSTimer</span></span> * timer = [<span class="hljs-built_in"><span class="hljs-built_in">NSTimer</span></span> timerWithTimeInterval:<span class="hljs-number"><span class="hljs-number">0.5</span></span> target:<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> selector:<span class="hljs-keyword"><span class="hljs-keyword">@selector</span></span>(timerFire:) userInfo:<span class="hljs-literal"><span class="hljs-literal">nil</span></span> repeats:<span class="hljs-literal"><span class="hljs-literal">YES</span></span>]; [[<span class="hljs-built_in"><span class="hljs-built_in">NSRunLoop</span></span> currentRunLoop] addTimer:timer forMode:<span class="hljs-built_in"><span class="hljs-built_in">NSDefaultRunLoopMode</span></span>];</code> </pre> <br>  Now, the timer processing cycle calls the selector (method) <code>-timerFire:</code> on the <code>self</code> object.  Do not forget to implement this method: <br><br><pre> <code class="hljs objectivec">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)timerFire:(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)sender { <span class="hljs-built_in"><span class="hljs-built_in">NSPasteboard</span></span> * pboard = [<span class="hljs-built_in"><span class="hljs-built_in">NSPasteboard</span></span> generalPasteboard]; <span class="hljs-built_in"><span class="hljs-built_in">NSPasteboardItem</span></span> * pboardItem = [[pboard pasteboardItems] lastObject]; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> * text = [pboardItem stringForType:<span class="hljs-built_in"><span class="hljs-built_in">NSPasteboardTypeString</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre> <br>  In the body of the method, we refer to the main clipboard, to the last object contained in it and try to extract text data from it.  I propose to memorize the changes in the clipboard in the array of previous values, as well as store a parallel array ( <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B0%25D1%2580%25D0%25B0%25D0%25BB%25D0%25BB%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BC%25D0%25B0%25D1%2581%25D1%2581%25D0%25B8%25D0%25B2">ru.wikipedia.org/wiki/Parallel_array</a> ) of the dates and times of the corresponding changes: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">@property</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">strong</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">nonatomic</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">NSMutableArray</span></span> * texts; <span class="hljs-keyword"><span class="hljs-keyword">@property</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">strong</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">nonatomic</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">NSMutableArray</span></span> * times;</code> </pre> <br>  Do not forget at the beginning of the program to initialize both properties with empty liabilities: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.texts = [<span class="hljs-built_in"><span class="hljs-built_in">NSMutableArray</span></span> array]; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.times = [<span class="hljs-built_in"><span class="hljs-built_in">NSMutableArray</span></span> array];</code> </pre> <br>  Now we will implement the following logic: we will search for the text found in the clipboard in the array with previous values ‚Äã‚Äãand if there is no such one, add it to the beginning of the array and add a new item to the top of the menu: <br><br><pre> <code class="hljs ruby">NSInteger index = [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.texts <span class="hljs-symbol"><span class="hljs-symbol">indexOfObject:</span></span>text]; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ... NSMenuItem * menuItem = [[NSMenuItem alloc] <span class="hljs-symbol"><span class="hljs-symbol">initWithTitle:</span></span>@<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-symbol"><span class="hljs-symbol">action:</span></span>@selector(<span class="hljs-symbol"><span class="hljs-symbol">menuItemSelect:</span></span>) <span class="hljs-symbol"><span class="hljs-symbol">keyEquivalent:</span></span>@<span class="hljs-string"><span class="hljs-string">""</span></span>]; [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.menu <span class="hljs-symbol"><span class="hljs-symbol">insertItem:</span></span>menuItem <span class="hljs-symbol"><span class="hljs-symbol">atIndex:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>]; [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.texts <span class="hljs-symbol"><span class="hljs-symbol">insertObject:</span></span>text <span class="hljs-symbol"><span class="hljs-symbol">atIndex:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>]; [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.times <span class="hljs-symbol"><span class="hljs-symbol">insertObject:</span></span>[NSDate date] <span class="hljs-symbol"><span class="hljs-symbol">atIndex:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>];</code> </pre> <br>  If such text is already in the array with the previous values, we will tick off the corresponding item of our menu and nothing more.  To do this, we will create a new <code>selectedIndex</code> property of type <code>BOOL</code> : <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index != <span class="hljs-built_in"><span class="hljs-built_in">NSNotFound</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.selectedIndex = index; [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span> updateItemTitlesAndStates]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; }</code> </pre> <br><br>  The <code>updateItemTitlesAndStates</code> method is used to bypass all menu items and update their names (the names indicate the time elapsed since copying to the clipboard) and setting a check mark to the left of the <code>selectedIndex</code> item: <br><br><pre> <code class="hljs objectivec">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)updateItemTitlesAndStates { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.menu.itemArray.count<span class="hljs-number"><span class="hljs-number">-2</span></span>; i++) { <span class="hljs-built_in"><span class="hljs-built_in">NSDate</span></span> * time = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.times[i]; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> * text = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.texts[i]; <span class="hljs-built_in"><span class="hljs-built_in">NSMenuItem</span></span> * menuItem = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.menu.itemArray[i]; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> * timeStr = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">NSTimeInterval</span></span> secs = MAX(<span class="hljs-number"><span class="hljs-number">0</span></span>,[[<span class="hljs-built_in"><span class="hljs-built_in">NSDate</span></span> date] timeIntervalSinceDate:time]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (secs &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>) timeStr = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat:<span class="hljs-string"><span class="hljs-string">@"%ds"</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(secs)]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (secs &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>) timeStr = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat:<span class="hljs-string"><span class="hljs-string">@"%dm"</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(secs/<span class="hljs-number"><span class="hljs-number">60</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (secs &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">24</span></span>) timeStr = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat:<span class="hljs-string"><span class="hljs-string">@"%dh"</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(secs/<span class="hljs-number"><span class="hljs-number">60</span></span>/<span class="hljs-number"><span class="hljs-number">60</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (secs &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">24</span></span>*<span class="hljs-number"><span class="hljs-number">7</span></span>) timeStr = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat:<span class="hljs-string"><span class="hljs-string">@"%dd"</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(secs/<span class="hljs-number"><span class="hljs-number">60</span></span>/<span class="hljs-number"><span class="hljs-number">60</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (secs &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">24</span></span>*<span class="hljs-number"><span class="hljs-number">365.75</span></span>) timeStr = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat:<span class="hljs-string"><span class="hljs-string">@"%dw"</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(secs/<span class="hljs-number"><span class="hljs-number">60</span></span>/<span class="hljs-number"><span class="hljs-number">60</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span>/<span class="hljs-number"><span class="hljs-number">7</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (secs &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">24</span></span>*<span class="hljs-number"><span class="hljs-number">365.75</span></span>*<span class="hljs-number"><span class="hljs-number">3</span></span>) timeStr = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat:<span class="hljs-string"><span class="hljs-string">@"%dM"</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(secs/<span class="hljs-number"><span class="hljs-number">60</span></span>/<span class="hljs-number"><span class="hljs-number">60</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span>/<span class="hljs-number"><span class="hljs-number">30.5</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (secs &lt; <span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">24</span></span>*<span class="hljs-number"><span class="hljs-number">365.75</span></span>*<span class="hljs-number"><span class="hljs-number">100</span></span>) timeStr = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat:<span class="hljs-string"><span class="hljs-string">@"%dy"</span></span>,(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(secs/<span class="hljs-number"><span class="hljs-number">60</span></span>/<span class="hljs-number"><span class="hljs-number">60</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span>/<span class="hljs-number"><span class="hljs-number">365.75</span></span>)]; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> timeStr = <span class="hljs-string"><span class="hljs-string">@".."</span></span>; menuItem.title = [<span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> stringWithFormat:<span class="hljs-string"><span class="hljs-string">@"(%@) \"%@%@\""</span></span>, timeStr, [text substringToIndex:MIN(MaxVisibleChars,text.length)], (text.length &lt;= MaxVisibleChars) ? <span class="hljs-string"><span class="hljs-string">@""</span></span> : <span class="hljs-string"><span class="hljs-string">@"..."</span></span>]; menuItem.state = (i == <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.selectedIndex) ? <span class="hljs-built_in"><span class="hljs-built_in">NSOnState</span></span> : <span class="hljs-built_in"><span class="hljs-built_in">NSOffState</span></span>; menuItem.keyEquivalent = [@(i+<span class="hljs-number"><span class="hljs-number">1</span></span>) description]; } }</code> </pre> <br>  Well, in the case of adding a new item, you must also delete old items, if there are too many of them: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.menu.itemArray.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> &gt;= <span class="hljs-type"><span class="hljs-type">MaxVisibleItems</span></span>+<span class="hljs-number"><span class="hljs-number">2</span></span>) { [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.menu removeItemAtIndex:<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.menu.itemArray.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">3</span></span>]; [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.texts removeLastObject]; [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.times removeLastObject]; }</code> </pre> <br>  It remains to process the clicks on the menu items: <br><br><pre> <code class="hljs objectivec">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)menuItemSelect:(<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>)sender { <span class="hljs-built_in"><span class="hljs-built_in">NSInteger</span></span> index = [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.menu.itemArray indexOfObject:sender]; <span class="hljs-built_in"><span class="hljs-built_in">NSPasteboard</span></span> * pboard = [<span class="hljs-built_in"><span class="hljs-built_in">NSPasteboard</span></span> generalPasteboard]; [pboard clearContents]; <span class="hljs-built_in"><span class="hljs-built_in">NSPasteboardItem</span></span> * pboardItem = [[<span class="hljs-built_in"><span class="hljs-built_in">NSPasteboardItem</span></span> alloc] init]; [pboardItem setString:<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.texts[index] forType:<span class="hljs-built_in"><span class="hljs-built_in">NSPasteboardTypeString</span></span>]; [pboard writeObjects:@[pboardItem]]; }</code> </pre> <br><br>  Now the application works as we wanted!  When a text that has been there recently arrives on the clipboard, the check mark jumps down to the desired item.  The same happens if we click on this item ourselves: <br><br><img src="http://habrastorage.org/storage3/760/585/af8/760585af85f04c1e3e6ed547f0fa4c58.png"><br><img src="http://habrastorage.org/storage3/ae6/241/176/ae62411765e5f5e9a4b712a37cbdd3d7.png"><br><br>  The application is designed only for text data, and does not work properly with pictures, files and other things that fall into the clipboard, but I myself have been using it for a couple of days.  This is the first application I wrote in a couple of hours - which I actually use.  Thanks to those who read and looked through all the pictures, I hope you enjoyed it! <br><br>  For magic numbers and parallel arrays in the code, please do not kick!  As it was easier and faster and wrote.  Who loves Feng Shui everything - waiting for your pool rekvest! <br><br>  Sources of the application can be found here: <a href="https://github.com/k06a/Clipshare">github.com/k06a/Clipshare</a> <br>  The binary can be downloaded from releases: <a href="https://github.com/k06a/Clipshare/releases">github.com/k06a/Clipshare/releases</a> <br><br>  <b>PS</b> If you do not skimp on the pros and comments, in the next article we will create an application for iOS and synchronize the clipboard between devices! <br><br>  <b>PPS</b> Who will find an epic typo in the text, will get a plus in karma! </div><p>Source: <a href="https://habr.com/ru/post/197348/">https://habr.com/ru/post/197348/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197334/index.html">The digest of news from the world of mobile development for the last week ‚Ññ28 (October 7‚Äî13, 2013)</a></li>
<li><a href="../197336/index.html">10 golden rules of twitter</a></li>
<li><a href="../197340/index.html">Idea Presentation: Mobile Office</a></li>
<li><a href="../197344/index.html">My first overlay program</a></li>
<li><a href="../197346/index.html">Project ‚ÄúBacup of the Planet‚Äù</a></li>
<li><a href="../197350/index.html">The Large Hadron Collider with my own eyes. Part 4</a></li>
<li><a href="../197358/index.html">Node.js and new frontend on the web</a></li>
<li><a href="../197360/index.html">KolibriOS: Interview with Sergey Kuzmin (Wildwest)</a></li>
<li><a href="../197362/index.html">Free Mafia2 or Civilization V (Steam)</a></li>
<li><a href="../197364/index.html">Erlang for the little ones. Chapter 2: Modules and Functions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>