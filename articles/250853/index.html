<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple webdev in java 8</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to talk about how I got the idea to do web development in Java. 

 So, as soon as I matured for this business, I made a small list to which the...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple webdev in java 8</h1><div class="post__text post__text-html js-mediator-article">  I want to talk about how I got the idea to do web development in Java. <br><br>  So, as soon as I matured for this business, I made a small list to which the development tools I chose should correspond: <br><ul><li>  Build with maven; </li><li>  Simple deployment and startup process; </li><li>  Libraries should be lightweight; </li><li>  Ability to use a template engine. </li></ul><br>  Going hard, I found what I needed: <a href="http://sparkjava.com/">Spark</a> , <a href="https://github.com/neuland/jade4j">jade4j</a> and <a href="http://ormlite.com/">OrmLite</a> . <br><br>  So, tools are chosen, we will consider each of them separately. <br><a name="habracut"></a><br><h2>  Spark Framework </h2><br>  I chose the latest version, which requires Java 8 to work. The framework itself is positioned as Sinatra-inspired, since I am not familiar with Sinatra too closely, it rather reminded me of Express for Node.js. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The idea was close, especially since there was already a positive experience with Express.  The documentation seems to be poor, but in the development process you are convinced that it is more than enough.  I think it‚Äôs a big plus that the development does not require pre-setting the environment, installing a servlet container, and so on.  All you need to do is add a dependency in pom.xml, write a couple of lines - and everything will take off. <br><br><h2>  Jade4j </h2><br>  If you have worked with Node.js template engines, in particular with jade, then you probably want to use it more.  Easy to read code, good documentation, many beautiful features and experience of using earlier made me choose this template engine. <br><br>  A small example of layout.jade: <br><br><pre><code class="hljs vhdl">doctype html html head <span class="hljs-keyword"><span class="hljs-keyword">block</span></span> headsection <span class="hljs-keyword"><span class="hljs-keyword">body</span></span> header div#main <span class="hljs-keyword"><span class="hljs-keyword">block</span></span> content footer</code> </pre> <br>  Elements {block blockname} are implemented in other files as follows: <br><br><pre> <code class="hljs erlang-repl">extends layout block headsection title , ! block content h1 Hello, habr!</code> </pre><br><br><h2>  Ormlite </h2><br>  Most likely, some android developers are well acquainted with this ORM.  It is easy to use, lightweight and configurable with annotations. <br><br>  Here is a simple example of a pojo User class: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vagga.pojo; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.j256.ormlite.field.DatabaseField; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.j256.ormlite.table.DatabaseTable; <span class="hljs-meta"><span class="hljs-meta">@DatabaseTable</span></span>(tableName = <span class="hljs-string"><span class="hljs-string">"users"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@DatabaseField</span></span>(columnName = <span class="hljs-string"><span class="hljs-string">"user_id"</span></span>, generatedId = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> userId; <span class="hljs-meta"><span class="hljs-meta">@DatabaseField</span></span>(columnName = <span class="hljs-string"><span class="hljs-string">"username"</span></span>, unique = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, canBeNull = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String userName; <span class="hljs-meta"><span class="hljs-meta">@DatabaseField</span></span>(columnName = <span class="hljs-string"><span class="hljs-string">"user_pass"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String password; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-comment"><span class="hljs-comment">/* *  - */</span></span> }</code> </pre><br>  Interaction with the database can be carried out through the built-in ORM Dao.  I wrote a small singleton class to simplify my life (maybe the code below will upset you a bit, so I‚Äôll make another reservation: the main goal was to be easy to implement and use): <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vagga.utils; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.j256.ormlite.dao.Dao; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.j256.ormlite.dao.DaoManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.j256.ormlite.jdbc.JdbcConnectionSource; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vagga.pojo.Category; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vagga.pojo.Comment; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vagga.pojo.Post; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vagga.pojo.User; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.SQLException; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DbUtil</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> DbUtil ourInstance = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DbUtil(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> JdbcConnectionSource dbSource; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Dao&lt;User, Integer&gt; userDao; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Dao&lt;Post, Integer&gt; postDao; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Dao&lt;Category, Integer&gt; categoryDao; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Dao&lt;Comment, Integer&gt; commentDao; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> DbUtil </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getInstance</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ourInstance; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DbUtil</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { dbSource = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JdbcConnectionSource(<span class="hljs-string"><span class="hljs-string">"jdbc:mysql://localhost:3306/vagga?user=root&amp;characterEncoding=utf8"</span></span>); userDao = DaoManager.createDao(dbSource, User.class); postDao = DaoManager.createDao(dbSource, Post.class); categoryDao = DaoManager.createDao(dbSource, Category.class); commentDao = DaoManager.createDao(dbSource, Comment.class); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (SQLException e) { e.printStackTrace(); System.out.println(<span class="hljs-string"><span class="hljs-string">"Cannot establish DB connection "</span></span> + e.getMessage() + <span class="hljs-string"><span class="hljs-string">" "</span></span> + e.getCause()); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Dao&lt;User, Integer&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUserDao</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> userDao; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Dao&lt;Post, Integer&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPostDao</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> postDao; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Dao&lt;Category, Integer&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCategoryDao</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> categoryDao; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Dao&lt;Comment, Integer&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCommentDao</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> commentDao; } }</code> </pre><br><h2>  Several solutions that may disappoint you </h2><br>  Having started the coding process, I came across several problems that had to be solved in some way. <br><br>  The number one problem was that Spark did not support the jade out of the box, so I had to google and figure out how to make friends with them.  The solution to the problem was quite simple.  You just need to inherit from the TemplateEngine class and implement the interface render method. <br><br>  In the same google group, I found this quite working code: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vagga.utils; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> de.neuland.jade4j.JadeConfiguration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> de.neuland.jade4j.exceptions.JadeException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> de.neuland.jade4j.model.JadeModel; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> de.neuland.jade4j.template.FileTemplateLoader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> de.neuland.jade4j.template.JadeTemplate; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> de.neuland.jade4j.template.TemplateLoader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spark.ModelAndView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spark.TemplateEngine; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.StringWriter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JadeEngine</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TemplateEngine</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> JadeConfiguration configuration; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String directory = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(<span class="hljs-string"><span class="hljs-string">"."</span></span>).getCanonicalPath(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">JadeEngine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.configuration = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JadeConfiguration(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.directory = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.directory + <span class="hljs-string"><span class="hljs-string">"/src/main/resources/templates/"</span></span>; TemplateLoader loader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileTemplateLoader(directory, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); configuration.setTemplateLoader(loader); } <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>(<span class="hljs-string"><span class="hljs-string">"unchecked"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ModelAndView modelAndView)</span></span></span><span class="hljs-function"> </span></span>{ StringWriter stringWriter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringWriter(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { JadeTemplate template = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.configuration.getTemplate(modelAndView.getViewName()); JadeModel jadeModel = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JadeModel((Map&lt;String, Object&gt;) modelAndView.getModel()); template.process(jadeModel, stringWriter); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JadeException | IOException e) { e.getCause(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stringWriter.toString(); } }</code> </pre><br>  The next problem was related to the fact that I did not know how to properly split the request mapping into different classes.  As a result, I decided to create an interface with three methods: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vagga.routes; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseRoute</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initBeforeAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initActions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initAfterActions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre><br>  Next, I created the base class of the route, in which I initialized the template rendering helpers: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vagga.routes; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vagga.utils.JadeEngine; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vagga.utils.JsonTransformer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Route</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> JadeEngine templateEngine; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> JsonTransformer jsonTransformer; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Route</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ templateEngine = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JadeEngine(); jsonTransformer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JsonTransformer(); } }</code> </pre><br>  The implementation of the final mapper class is here: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.vagga.routes; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vagga.pojo.Category; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vagga.pojo.User; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.vagga.utils.DbUtil; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> spark.ModelAndView; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.sql.SQLException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.HashMap; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Map; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> spark.Spark.*; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HomeRoute</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Route</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseRoute</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HomeRoute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initBeforeAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initActions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, (req, res) -&gt; { Map&lt;String, Object&gt; model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, Object&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { List&lt;Category&gt; categories = DbUtil.getInstance().getCategoryDao().queryForAll(); User user = DbUtil.getInstance().getUserDao().queryForId(<span class="hljs-number"><span class="hljs-number">1</span></span>); model.put(<span class="hljs-string"><span class="hljs-string">"user"</span></span>, user); model.put(<span class="hljs-string"><span class="hljs-string">"categories"</span></span>, categories); model.put(<span class="hljs-string"><span class="hljs-string">"title"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (SQLException e) { e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ModelAndView(model, <span class="hljs-string"><span class="hljs-string">"home/index.jade"</span></span>); }, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.templateEngine); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initAfterActions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre><br>  Now all the mapping classes need to be instantiated somehow.  I do it right in the main class, because I haven't thought of anything smarter yet (I will be grateful if someone suggests how it can be done better): <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VaggaMain</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { ArrayList&lt;BaseRoute&gt; routes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); routes.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HomeRoute()); routes.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AdminRoute()); routes.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ApiRoute()); routes.forEach((route) -&gt; { route.initBeforeAction(); route.initActions(); route.initAfterActions(); }); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { e.printStackTrace(); } } }</code> </pre><br><br><h2>  Total </h2><br>  All the goals that I set for myself were realized.  I was satisfied with the tools.  The main problems encountered are the extreme scarcity of information on the Internet about the above tools.  In general, the framework is cool, simple and makes you happy. <br><br>  Thank you all for your attention!  Constructive criticism is welcome. </div><p>Source: <a href="https://habr.com/ru/post/250853/">https://habr.com/ru/post/250853/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../250837/index.html">Introducing the new version of Kerio Control 8.5</a></li>
<li><a href="../250841/index.html">JIT compiler as an academic project at the Academic University</a></li>
<li><a href="../250845/index.html">Anti-patterns of design: Dead End</a></li>
<li><a href="../250847/index.html">The tools that allowed us to speed up the development of the game</a></li>
<li><a href="../250851/index.html">Why Bittorent via Tor is a Bad Idea</a></li>
<li><a href="../250855/index.html">Applied optimization practice and some history</a></li>
<li><a href="../250857/index.html">MailChimp UX Team: Collaboration [Part 2 of the Book]</a></li>
<li><a href="../250859/index.html">VPN everywhere: IPsec without L2TP with strongSwan</a></li>
<li><a href="../250861/index.html">Parsing function calls in PHP</a></li>
<li><a href="../250867/index.html">When the site can be more than 1Mb?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>