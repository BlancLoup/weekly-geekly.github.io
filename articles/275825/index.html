<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Machine learning techniques for predicting stock prices: indicator functions and news analysis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In our blog, we have already covered the topic of predicting stock prices using an adaptive filtering algorithm . A New York-based financier, Vatsal S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Machine learning techniques for predicting stock prices: indicator functions and news analysis</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/itinvest/blog/275825/"><img src="https://habrastorage.org/files/d08/298/d8c/d08298d8c6ff4c6ab1ff4ae74ec06d7b.png"></a> <br><br>  In our blog, we have already covered the topic of predicting stock prices using <a href="https://habrahabr.ru/company/itinvest/blog/274821/">an adaptive filtering algorithm</a> .  A New York-based financier, Vatsal Shah, in his <a href="http://www.vatsals.com/Essays/MachineLearningTechniquesforStockPrediction.pdf">work</a> considered the possibility of using machine learning algorithms for this purpose.  We bring to your attention the main thoughts of this document. <a name="habracut"></a><br><br><h4>  Introduction </h4><br>  There are two methods for predicting stock prices: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <b>Fundamental analysis</b> - in this case, analysts evaluate information that is more relevant to the company, whose shares are traded on the stock exchange, rather than to the shares themselves.  Decisions on certain actions on the market are made based on an analysis of the company's previous activities, revenue and profit forecasts, and so on. </li><li>  <b>Technical analysis</b> - in this case, the behavior of the stock price is examined and its various patterns are identified (time series analysis is used). </li></ul><br>  In the case of the use of machine learning methods for processing trade data, it is often the technical analysis method that is used - the goal is to understand whether the algorithm can accurately determine the patterns of stock behavior over time.  However, machine learning can also be used to evaluate and predict the results of a company‚Äôs operations for further use in fundamental analysis.  In the end, the most effective method of automated stock price prediction and generating investment recommendations is a hybrid approach that combines the approaches of fundamental and technical analysis. <br><br><h4>  The efficient market hypothesis </h4><br>  <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D0%25B8%25D0%25BF%25D0%25BE%25D1%2582%25D0%25B5%25D0%25B7%25D0%25B0_%25D1%258D%25D1%2584%25D1%2584%25D0%25B5%25D0%25BA%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D1%2580%25D1%258B%25D0%25BD%25D0%25BA%25D0%25B0">The</a> Efficient Market Hypothesis (EMH) hypothesis assumes that all relevant information immediately and fully affects the market value of securities.  There are three forms of market efficiency: weak, medium and strong.  The weak form implies that the value of a market asset fully reflects past information, and strong - that value reflects all information, both past and public or internal. <br><br><h4>  Hypothesis of random walk </h4><br>  The mathematical model of random walk (Random Walk Hypothesis) suggests that changes in the price of shares at each step do not depend on the previous ones and on time.  Thus, it is impossible to identify any patterns of price behavior and use them. <br><br><h4>  Indicator Functions </h4><br>  For technical analysis of market prices, various attributes and indicators are used.  The latter include, for example: <br><br><ul><li>  Moving Average (MA) - displays the average n past values ‚Äã‚Äãup to the current moment; </li><li>  Exponential Moving Average (EMA) - gives more weight to the most recent values, but does not discard the old values ‚Äã‚Äãcompletely; </li><li>  <b>Momentum or rate of change</b> (Rate of Change, RoC) is one of the simplest technical indicators, calculated as the ratio or difference between the current price and the price n periods ago. </li><li>  <b>The relative strength index</b> (Relative Strength Index, RSI) - determines the strength of the trend and the probability of its change during a certain time (usually, 9-14 days). </li></ul><br>  For the described project, EMA was chosen as the main indicator - it allows you to process a virtually unlimited amount of historical data, which is very important for analysis using time series.  However, it is worth noting that the use of other indicators can also bring greater accuracy of forecasts of the analyzed shares. <br><br> <code>EMA (t) = EMA (t-1) + alpha * (Price (t) - EMA (t-1))</code> <br> <br>  where, alpha = 2 / (N + 1), thus, for N = 9, alpha = 0.20 <br><br>  In theory, the problem of predicting the stock price can be considered as an estimate of the function F in time T based on the previous values ‚Äã‚Äãof F at time t-1, t-2 ... tn, assigning the appropriate weight function w to at each moment F: <br><br> <code>F (t) = w1*F (t-1) + w2*F (t-2) + ‚Ä¶ + w*F (tn)</code> <br> <br>  The chart below shows how EMA models the current stock price: <br><br><img src="https://habrastorage.org/files/7fb/18f/a1e/7fb18fa1eda44c05a152cf2e81a95f61.png"><br><br><h4>  Learning environment </h4><br>  During the project, Weka and YALE data mining environments were used.  The configuration looked like this: <br><br><img src="https://habrastorage.org/files/47f/cf9/b77/47fcf9b77eb6468ab720f5e63e16fb90.png"><br><br>  The attribute selection step for some machine learning methods was skipped because their total number was less than 10. <br><br><h4>  Pre-processing of historical data </h4><br>  For the experiment, Yahoo Finance has uploaded historical data on the stock prices of Google Inc.  (GOOG ticker) and Yahoo Inc.  (YHOO).  The data set had the following attributes: Date Open High Low Close Adj.  Close. <br><br>  The EMA indicator assumes that the stock price on the previous trading day will have the highest value at the current price.  Thus, the closer the time point is to the current moment, the more value it has on the price of the current day.  In the course of time analysis, the researcher took the Date as the X axis - each date represented an integer value.  Another attribute has been added to the existing attributes - Indicator, in this particular case EMA. <br><br><h4>  Machine learning techniques </h4><br>  In this section, the research presents the results of applying various machine learning algorithms. <br><br><blockquote><h6>  <a href="https://en.wikipedia.org/wiki/Decision_stump">Decision Stump</a> Algorithm </h6></blockquote><br>  The application of a simple algorithm for predicting EMA has achieved the following results: <br><br><ul><li>  Correlation coefficient 0.8597 </li><li>  Mean absolute error 46.665 </li><li>  The root mean square error 57.8192 </li><li>  Relative absolute error of 46.8704% </li><li>  Root mean square relative error 50.9763% </li><li>  Total number of periods 681 </li></ul><br><blockquote><h6>  Linear regression </h6></blockquote><br>  Using simple linear regression (using only numerical attributes) to predict EMA yielded the following results: <br><br><ul><li>  Correlation Coefficient 0.9591 </li><li>  Mean absolute error 12.9115 </li><li>  The root mean square error is 32.0499 </li><li>  Relative absolute error 12.9684% </li><li>  Root RMS relative error 28.2568% </li><li>  Total number of periods 681 </li></ul><br><blockquote><h5>  Support Vector Machine </h5></blockquote><br>  Using the support vector method (C-Class) with the application of the radial basis function of the kernel with the C parameter in the range from 512 to 65536, allowed us to obtain the following accuracy for predicting the price movement: <br><br>  Root RMS error: 0.486 ¬± 0.012 <br>  Accuracy: 60.20 ¬± 0.49% <br><br><blockquote><h6>  Busing </h6></blockquote><br>  After using the C-SVC algorithm, the AdaBoostM1 boosting algorithm was applied to the dataset to achieve a significant improvement in accuracy. <br><br>  Root RMS error: 0.467 ¬± 0.008 <br>  Accuracy: 64.32% ¬± 3.99% <br><br>  From the output of YALE, the following inaccuracy matrix was extracted: <br><br><img src="https://habrastorage.org/files/38a/aca/67f/38aaca67f3fd49768b08a9d68352d7a1.png"><br><br><h4>  Share price prediction based on textual analysis of financial news </h4><br>  Currently, a large amount of valuable data that may affect the situation on the market is available online (we wrote about this effect in <a href="http://habrahabr.ru/company/itinvest/blog/230235/">our article</a> ).  Most of this information is contained in financial news, company reports and expert recommendations (for example, a blog of insiders and analysts, for example, can serve as a source of such recommendations).  Most of this data is presented in text format, which makes it difficult to use it.  Thus, a new problem is the need to analyze text documents simultaneously with the analysis of time series. <br><br>  The researcher used a method that involves determining the degree of influence of news on a specific stock: it can be positive (Positive), negative (Negative) or neutral (Neutral). <br><br>  It is believed that the news has a positive effect (or negative) if the price of the stock rises seriously (or falls) in the period immediately after its publication.  If the stock price does not seriously change after the news is published, then its effect is considered neutral. <br><br>  Another method used involves the definition of patterns in news articles that directly correspond to an increase or decrease in the price of shares.  It works as follows: <br><br>  A special search robot passes through news articles and indexes them for a specific portfolio of stocks.  The learning environment requests news for the period T minutes from the moment of indexing.  This environment consists of several training modules that search for the necessary information in the text of a news note or materials from expert blogs (for example, ‚Äúthe price of oil will decrease‚Äù).  The dictionary for analysis includes words and phrases that affect the conditions of positive (Positive Prediction Terms) or negative movement (Negative Prediction).  Each time a phrase from the set of Positive Prediction Terms appears in the text of the article, it is assigned a positive Vote. <br><br>  The diagram below shows the architecture of such a system: <br><br><img src="https://habrastorage.org/files/c6b/d5d/b56/c6bd5db5643e48ab8400302cfc90d929.png"><br><br>  As it is easy to see, this method allows you to make only rather rough assumptions.  To increase their accuracy, it is necessary to add more weights to the articles - for example, based on the ranking of information sources for publication.  In addition, text header formats containing phrases from the Positive or Negative Prediction Terms sets should be considered. <br><br><h4>  Use as weight news authoritativeness experts </h4><br>  The researcher also describes the use of an assessment of the authority of experts who express a particular point of view for additional weighting of text materials.  For example, for Google shares, he picked up a list of analysts who have been writing about this company for a long time, and he noted the quality of their predictions with asterisks: <br><br><img src="https://habrastorage.org/files/591/0d2/d11/5910d2d11a8c48b49b64835101112dbc.png"><br><br>  At the entrance of the system, the opinions of stock market experts are presented (just their opinion, which is not necessarily true), and then, based on their forecasts, predictions of possible price movements are made time after time.  At each iteration, the weight of the expert, whose prediction turned out to be true, rises, while for those who made a mistake, on the contrary, it decreases.  Another type of method involves the complete removal from the list of those experts who made a mistake, but it is not the most effective - after all, even the best and most respected financial analysts are mistaken. <br><br>  The expert weighting algorithm can be described as follows: <br><br><blockquote>  <i>Given: vector E = {e1, e2,‚Ä¶ .eN} of financial experts and their forecasts.</i> <i><br><br></i>  <i>Assign a weight W (e (i)) = 1 for each expert e (i).</i> <i><br></i>  <i>For the round t in 1 ... T</i> <i><br></i>  <i>Make a prediction based on <a href="https://books.google.ru/books%3Fid%3D0_DGBgAAQBAJ%26pg%3DPA165%26lpg%3DPA165%26dq%3D%25D0%25B0%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC%2B%25D0%25B2%25D0%25B7%25D0%25B2%25D0%25B5%25D1%2588%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE%2B%25D0%25B1%25D0%25BE%25D0%25BB%25D1%258C%25D1%2588%25D0%25B8%25D0%25BD%25D1%2581%25D1%2582%25D0%25B2%25D0%25B0%26source%3Dbl%26ots%3Dvs6T8IiKFv%26sig%3DKohWLdK_0VH4YjPIzuvJp_Pwtqs%26hl%3Den%26sa%3DX%26ved%3D0ahUKEwjr-Jbsmr3KAhWCJXIKHSmeBGwQ6AEIIzAB">a weighted majority algorithm</a> .</i> <i><br><br></i>  <i>For experts who made the correct prediction W (e (i)) (t) = 2 * W (e (i)) (t-1)</i> <i><br><br></i>  <i>For experts who made an incorrect prediction W (e (i)) (t) = ¬Ω * W (e (i)) (t-1)</i> <i><br></i>  <i>Save expert rating (Expert Rating) for subsequent weighing.</i> </blockquote><br>  Such a weighing technique based on expert opinions can be viewed as a hybrid approach combining fundamental and technical analysis ‚Äî experts make predictions based on fundamental analysis, and the algorithm subsequently uses them to generate their own forecasts using technical analysis methods. <br><br><h4>  Conclusion </h4><br>  Of all the algorithms used, only a combination of the support vector method and the boosting algorithm made it possible to achieve any satisfactory prediction accuracy results. <br><br>  Another promising method of analysis is the weighting of experts.  However, at present, the effectiveness of linguistic analysis methods for generating forecasts of stock price movements is a subject of further study and no definite conclusions can be drawn about its applicability in practice. </div><p>Source: <a href="https://habr.com/ru/post/275825/">https://habr.com/ru/post/275825/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275815/index.html">How we prepared Elasticsearch, or How to process 36 thousand logs per second</a></li>
<li><a href="../275817/index.html">Preparing ASP.NET Core: let's talk more about OWIN and Katana</a></li>
<li><a href="../275819/index.html">Undocumented features of the optical terminal ZTE ZXHN F660 from MGTS</a></li>
<li><a href="../275821/index.html">How to criticize employees: Case Facebook</a></li>
<li><a href="../275823/index.html">Notes on the article ‚ÄúHow to write in C in 2016‚Äù</a></li>
<li><a href="../275827/index.html">What is modern linguistics. Lecture in Yandex</a></li>
<li><a href="../275829/index.html">Learn ActionScript 3. ‚ÄúHello, world!‚Äù</a></li>
<li><a href="../275831/index.html">General principles in creating mobile applications for the novice UX / UI-designer</a></li>
<li><a href="../275833/index.html">Automatic Migration of Containers in Data Centers: Microsoft Azure and AWS Integration</a></li>
<li><a href="../275835/index.html">UK government promotes crypto protocol for VoIP with backdoor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>