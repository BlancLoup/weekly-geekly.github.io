<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using the Hopfield neural network to solve the simplest problem</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Currently, a rather interesting area of ‚Äã‚Äãprogramming is the use of neural networks. Despite all the prospects of this idea, most of the implementatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using the Hopfield neural network to solve the simplest problem</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/ca0/cfc/b5e/ca0cfcb5e956d4b112766c564f4ecdb6.jpg" alt="image" align="left">  Currently, a rather interesting area of ‚Äã‚Äãprogramming is the use of neural networks.  Despite all the prospects of this idea, most of the implementations that I met were associated with various analyzes of statistical samples and the prediction of the possible value of a parameter. <br><br>  Talking about artificial intelligence and cumbersome expert systems is all well and good, but how can we bring this whole theory to life, to our appropriate problems? <br><a name="habracut"></a><br>  <b>A little bit about the task</b> <br><br>  It is required to write a program that will recognize reference images in a ‚Äúnoisy picture‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Neural network selection</b> <br><br>  In this article I will not consider the theoretical basis of neural networks, I think this information on the Internet is enough =) But still without theoretical material it will be difficult to understand what I am writing. <br><br>  And so, the Hopfield neural network is the best solution for solving our problem. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/55e/b70/8c4/55eb708c4b9952a974a5e04ff226f64c.jpg" alt="image"><br>  It consists of a single layer of neurons, the number of which is simultaneously the number of inputs and outputs of the network.  Each neuron is connected by synapses with all other neurons, and also has one input synapse, through which the signal is input.  The output signals, as usual, are formed on axons. <br><br>  This network requires a certain set of binary signals at the input, which are considered exemplary.  The network should be able to select (‚Äúremember‚Äù by partial information) the corresponding pattern (if any) from an arbitrary non-ideal signal applied to its input, or otherwise produce the most similar image. <br><br>  In general, any signal can be described by the vector X = {xi: i = 1, 2, ..., n}, <br>  n is the number of neurons in the network and the dimension of the input and output vectors.  Each xi element is either +1 or -1. <br>  There is a vector describing the kth sample.  When the network recognizes (or ‚Äúremembers‚Äù) a sample based on the data presented to it, all outputs will contain it, i.e.  Y is the vector of network output values: Y = {i: i = 1, 2, ..., n}.  Otherwise, if the noise is too strong at the outputs will be "garbage". <br><br>  At the network initialization stage, the weights of synapses are set as follows: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/871/0c4/f36/8710c4f36fb5286fe134d1c386317257.jpg" alt="image"><br>  Here i and j are indices of presynaptic and postsynaptic neurons, respectively; <br><br>  The network operation algorithm is as follows (t iteration number): <br>  <b><i>1.</i></b> An unknown signal is sent to the network inputs.  In fact, it is entered directly by setting the values: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/f83/240/ba3/f83240ba38c9d1efd4d1f3fbe97241e8.jpg" alt="image"><br>  therefore, the designation on the network diagram of the input synapses in an explicit form is purely conditional.  Zero in the bracket to the right of yi means zero iteration in the network loop. <br>  <b><i>2.</i></b> Calculate the new state of neurons. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/8cc/6b7/4f5/8cc6b74f5179b0d31f9b38c2dc3398c4.jpg" alt="image"><br>  and new values ‚Äã‚Äãof axons <br><img src="https://habrastorage.org/getpro/geektimes/post_images/be9/3d3/f9c/be93d3f9cb16e8733f5ffac1e02daab0.jpg" alt="image"><br>  <b><i>3.</i></b> Check whether the output values ‚Äã‚Äãof axons have changed during the last iteration.  If yes, go to step 2, otherwise (if the outputs are stabilized) - end.  At the same time, the output vector is a sample that is best combined with the input data. <br><br>  Thus, when a new vector is supplied, the network moves from a vertex to a vertex until it stabilizes.  The stable vertex is determined by the network weights and the current inputs.  If from vertex to vertex, until stabilized.  The stable vertex is determined by the network weights and the current inputs.  If the input vector is partially incorrect or incomplete, the network stabilizes at the vertex nearest to the desired one. <br>  It is proved that a sufficient condition for the stable operation of such a network is the fulfillment of the following conditions: <br>  Wij = Wji, Wii = 0. <br><br>  As I said, sometimes the network can not conduct recognition and outputs a non-existent image.  This is due to the problem of limited network capabilities.  For the Hopfield network, the number of memorized images N must not exceed a value approximately equal to 0.15n.  In addition, if the two images A and B are very similar, they will probably cause cross associations in the network, i.e.  the presentation of the vector A to the inputs of the network will result in the appearance of the vector B at its outputs and vice versa. <br><br>  <b>Let's start writing the program</b> <br><br>  And so a binary sequence is necessary for a neural network (in our case, -1/1). <br>  Let "1" is the black color of a pixel, and "-1" is white, <br>  this way we can convert the image into a sequence. <br><br>  For speed and accuracy of recovery, we will use the following scheme: <br>  A picture of 100x100 pixels and each pixel has its own neuron. <br>  Thus, the network will consist of 10,000 neurons. <br><br>  Let's start with the presentation of the elementary unit - the neuron: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">// </font> <br> <font color="#0000ff">private</font> <font color="#0000ff">class</font> Neuron <br> { <br> <font color="#008000">//  </font> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> ChangeState() <br> { <br> <font color="#0000ff">if</font> (s &gt; 0) y = 1; <br> <font color="#0000ff">if</font> (s &lt; 0) y = -1; <br> <font color="#0000ff">if</font> (s == 0) y = 0; <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> s; <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> x; <font color="#008000">//</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> y; <font color="#008000">//</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> index; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Now consider the neural network itself, I think for a better understanding, you should give the main part of the listing =) <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">namespace</font> Neurons <br> { <br> <font color="#0000ff">class</font> NetHopfild <br> { <br> <font color="#008000">// </font> <br> <font color="#0000ff">private</font> <font color="#0000ff">class</font> Neuron <br> { <br> ... <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">int</font> size = 10000; <br> <font color="#0000ff">public</font> NetHopfild() <br> { <br> <font color="#008000">// ,  </font> <br> mass = <font color="#0000ff">new</font> Neuron[size]; <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) <br> { <br> mass[i] = <font color="#0000ff">new</font> Neuron(); <br> } <br> matrix_of_connect = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [size, size]; <br> last_y = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [size]; <br> <font color="#008000">//</font> <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) <br> { <br> mass[i].index = i; <br> } <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) <br> { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; j &lt; size; j++) <br> { <br> matrix_of_connect[i,j] = 0; <br> } <br> } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> Initialise( <font color="#0000ff">int</font> []input) <br> { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) <br> { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; j &lt; size; j++) <br> { <br> <font color="#0000ff">if</font> (i == j) matrix_of_connect[i,j] = 0; <br> <font color="#0000ff">else</font> matrix_of_connect[i,j] += input[i] * input[j]; <br> } <br> } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> FindImage( <font color="#0000ff">int</font> []input) <br> { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) <font color="#008000">//  </font> <br> { <br> mass[i].x = input[i]; <br> last_y[i] = mass[i].y; <br> } <br> <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> k = 0; k &lt; size; k++) <font color="#008000">//  S  </font> <br> { <br> mass[k].s = 0; <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) <br> { <br> mass[k].s = mass[k].s + matrix_of_connect[i,mass[k].index] * mass[i].x; <br> } <br> mass[k].ChangeState(); <br> } <br> <font color="#0000ff">bool</font> flag = <font color="#0000ff">true</font> ; <br> <font color="#008000">//      </font> <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) <br> { <br> <font color="#0000ff">if</font> (last_y[i]!=mass[i].y) <br> { <br> flag = <font color="#0000ff">false</font> ; <br> <font color="#0000ff">break</font> ; <br> } <br> } <br> <font color="#0000ff">if</font> (flag == <font color="#0000ff">false</font> ) <br> { <br> <font color="#0000ff">int</font> [] temp = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [size]; <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; size; i++) <br> { <br> temp[i] = mass[i].y; <br> } <br> <font color="#008000">//  ,    ,     </font> <br> FindImage(temp); <br> } <br> } <br> <font color="#0000ff">private</font> Neuron []mass; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> [,] matrix_of_connect; <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> [] last_y; <br> <font color="#008000">//    (   )</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> [] Synapses <br> { <br> ... <br> } <br> }; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  And so the network is ready, now we will work with it. <br><br>  In this case, I will not describe the entire source code, I will describe only the main points. <br><br>  Convert the image into a binary sequence <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">int</font> [] BitmapToIntArray() <br> { <br> <font color="#008000">//     1  -1</font> <br> Color currentPixel; <br> <font color="#0000ff">int</font> [] temp = <font color="#0000ff">new</font> <font color="#0000ff">int</font> [size]; <br> <font color="#0000ff">int</font> index = 0; <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; picture.Height; i++) <br> { <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> j = 0; j &lt; picture.Width; j++) <br> { <br> currentPixel = picture.GetPixel(j, i); <br> currentPixel.ToArgb(); <br> <font color="#0000ff">if</font> (currentPixel == Color.FromArgb(255, 255, 255)) <br> { <br> temp[index] = -1; <br> } <br> <font color="#0000ff">else</font> <br> { <br> temp[index] = 1; <br> } <br> index++; <br> } <br> } <br> <font color="#0000ff">return</font> temp; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  <b>results</b> <br><br>  Let there be two standard images. <br><br><img src="http://dl.dropbox.com/u/940011/%D0%A1%D1%82%D0%B0%D1%82%D1%8C%D1%8F/obraz1.bmp" alt="image"><img src="http://dl.dropbox.com/u/940011/%D0%A1%D1%82%D0%B0%D1%82%D1%8C%D1%8F/obraz2.bmp" alt="image"><br>  We train our neural network <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a2b/e20/3c5/a2be203c5572fbc095c3692b52852d86.jpg" alt="image"><br><br>  Similarly, we teach the second image. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/ffb/151/0b8/ffb1510b83d9cb1f1da780cbc3129a07.jpg" alt="image"><br><br>  Interfere with the picture: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/302/4c5/523/3024c55234c14eab11998369629dd1f7.jpg" alt="image"><br><br>  Download the distorted picture into the program: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/3b2/fe4/57e/3b2fe457e6b51111a2fd083a19a3ad11.jpg" alt="image"><br><br>  Click "Restore" in a few seconds: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/1d4/9e2/26e/1d49e226e208666414206295b5f0cb1f.jpg" alt="image"><br><br>  As you can see, having located two emoticons after learning, the one for which the distorted design is most suitable.  You can play with the recovery process for a long time, but I think it‚Äôs enough for this article =) Experiment, you get really interesting results;) <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/245/03e/3d4/24503e3d42fa6aa108f2584cae1752be.jpg" alt="image" align="right">  And since our network operates only with binary sequences, I think it will not be difficult to rewrite this program, for example, to restore typos in the words =) and other goodies =) <br><br>  For those who are interested, I post an <a href="">archive with images and noises</a> , <a href="">the program itself</a> <br><br>  And of course, if someone completely imbued with the idea and need sorts, write in the comments, I will post it =) <br><br>  <b>UPD:</b> Corrected the passion in the code =) which indicated: <a href="https://geektimes.ru/users/graninas/" class="user_link">graninas</a> , <a href="https://geektimes.ru/users/nagg/" class="user_link">Nagg</a> , <a href="https://geektimes.ru/users/peregrinus/" class="user_link">Peregrinus</a> </div><p>Source: <a href="https://habr.com/ru/post/80730/">https://habr.com/ru/post/80730/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../80721/index.html">Cheat sheet to decipher the names of video files</a></li>
<li><a href="../80722/index.html">Russian national Internet film award "George"</a></li>
<li><a href="../80724/index.html">How many active mailboxes do you have?</a></li>
<li><a href="../80725/index.html">Gordon: Flash runtime implemented in javascript</a></li>
<li><a href="../80729/index.html">Babbage analytical machine. Part two - the tragic fate of computer technology of the XIX century</a></li>
<li><a href="../80731/index.html">Intel Core i5 660 processor overview</a></li>
<li><a href="../80732/index.html">Session Delivery in English</a></li>
<li><a href="../80735/index.html">On the birthday of jQuery, the long-awaited version 1.4 was released!</a></li>
<li><a href="../80737/index.html">ATI Radeon HD 5670 - the first budget graphics card with DirectX 11</a></li>
<li><a href="../80738/index.html">State Duma deputies proposed to equate CoD Modern Warfare 2 to extremist allowance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>