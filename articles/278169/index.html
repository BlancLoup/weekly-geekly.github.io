<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to shoot yourself in Kotlin</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most recently, Kotlin was released , and its development team offered to ask questions about the language. He is now at the hearing, and perhaps many ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to shoot yourself in Kotlin</h1><div class="post__text post__text-html js-mediator-article">  Most recently, Kotlin was <a href="http://blog.jetbrains.com/kotlin/2016/02/kotlin-1-0-released-pragmatic-language-for-jvm-and-android/">released</a> , and its development team offered <a href="https://habrahabr.ru/company/JetBrains/blog/277573/">to ask questions</a> about the language.  He is now at the hearing, and perhaps many would like to try it. <br>  A couple of weeks ago, the team leader made a presentation for the company that Kotlin was good.  One of the most interesting questions was ‚ÄúHow can I shoot myself in Kotlin in the foot?‚Äù It so happened that I answered this question. <br><br>  Disclaimer: <br>  Do not take this article as "Kotlin - sucks."  Although I rather belong to the category of those who are good with Scala, I think that the language is not bad. <br>  All points are controversial, but once a year the stick shoots.  Sometime you will shoot your head at the same time, and someday you will be able to shoot only at midnight of the full moon, if you first perform a black ritual of creating bad code. <br><br>  Our team recently completed a big project on Scala, now we are doing a smaller project on Kotlin, so the spoilers will have a comparison with Scala.  I will assume that Notolble in Kotlin is the equivalent of Option, although this is not at all the case, but most likely, those who have worked with Option will use Nullable instead. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><h4>  1. Post-increment and pre-increment as expressions </h4><br>  I quote the questioner: ‚ÄúUgh, this is the button accordion, boring.‚Äù  So many copies broken, a million questions in C ++ interviews ... If you have a habit, then you could leave it with an instruction (statement).  In fairness, other operators, like + =, are instructions. <br>  <a href="https://habrahabr.ru/company/JetBrains/blog/277573/">I quote</a> one of the developers, <a href="https://habr.com/users/abreslav/" class="user_link">abreslav</a> : <br><blockquote>  We looked at the cases, saw what was going to break, we decided to leave. <br><br>  I note that we do not have C ++ here, and there is nothing to ask about the increment at the interview.  Is that the difference between prefix and postfix. </blockquote>  There is no court.  Of course, in their right mind no one will do that, but by chance - maybe. <br><pre><code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">5</span></span> i = i++ + i++ println(i)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">No undefined behavior, the result is obviously 12</b> <div class="spoiler_text">  eleven </div></div><br><pre> <code class="scala hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-number"><span class="hljs-number">5</span></span> a = ++a + ++a println(a)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">It's all easier, of course, 14</b> <div class="spoiler_text">  13 </div></div><br><div class="spoiler">  <b class="spoiler_title">More examples</b> <div class="spoiler_text"><br><pre> <code class="scala hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> b = <span class="hljs-number"><span class="hljs-number">5</span></span> b = ++b + b++ println(b)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Banal logic says that the answer should be between 11 and 13</b> <div class="spoiler_text">  yes 12 </div></div><br><pre> <code class="scala hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> c = <span class="hljs-number"><span class="hljs-number">5</span></span> c = c++ + ++c println(c)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">From the permutation of the terms of the sum does not change</b> <div class="spoiler_text">  certainly 12 </div></div><br><pre> <code class="scala hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d = <span class="hljs-number"><span class="hljs-number">5</span></span> d = d + d++ + ++d + ++d println(d) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-number"><span class="hljs-number">5</span></span> e = ++e + ++e + e++ + e println(e)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">From the permutation of the terms of the sum does not change!</b> <div class="spoiler_text">  Of course: <br>  25 <br>  28 <br></div></div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">What is there in Scala?</b> <div class="spoiler_text">  There is nothing interesting, there are no increments in Scala.  The compiler will say that there is no ++ method for int.  But if you really want to, it, of course, can be determined. <br></div></div><br><h4>  2. Approved method </h4><br><pre> <code class="scala hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> foo: <span class="hljs-type"><span class="hljs-type">Int</span></span>? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> bar = foo!! + <span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">What they wanted was what they got</b> <div class="spoiler_text">  Exception in thread "main" kotlin.KotlinNullPointerException </div></div><br>  The documentation states that you only need to do this if you really want to get a NullPointerException.  This is a good method to shoot yourself in the leg: !!  cuts the eye and at first glance at the code everything is clear.  Of course, use !!  it is supposed then, when you checked the value for null before and the smart cast did not work for some reason.  Or when for some reason you are sure that there can not be null. <br><br><div class="spoiler">  <b class="spoiler_title">What is there in Scala?</b> <div class="spoiler_text"><pre> <code class="scala hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> foo: <span class="hljs-type"><span class="hljs-type">Option</span></span>[<span class="hljs-type"><span class="hljs-type">Int</span></span>] = <span class="hljs-type"><span class="hljs-type">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> bar = foo.get + <span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">What they wanted was what they got</b> <div class="spoiler_text">  Exception in thread "main" java.util.NoSuchElementException: None.get </div></div><br></div></div><br><h4>  3. Override invoke () </h4><br>  Let's start with a simple one: what does this piece of code do and what type of a? <br><pre> <code class="scala hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class">(</span><span class="hljs-params"></span><span class="hljs-class"><span class="hljs-params"></span>)</span></span>{...} <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> a = <span class="hljs-type"><span class="hljs-type">A</span></span>()</code> </pre><br><div class="spoiler">  <b class="spoiler_title">To a stupid question - a stupid answer</b> <div class="spoiler_text">  Correctly, creates a new object of type A, invoking the default constructor. </div></div><br>  And what will happen here? <br><pre> <code class="scala hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"></span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">constructor</span></span></span><span class="hljs-class">(</span><span class="hljs-params"></span><span class="hljs-class"><span class="hljs-params"></span>)</span></span>{...} <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> b = <span class="hljs-type"><span class="hljs-type">B</span></span>()</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Well, probably, the compilation error will be ...</b> <div class="spoiler_text">  And no! <br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">B</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">constructor</span></span></span><span class="hljs-class">(</span><span class="hljs-params"></span><span class="hljs-class"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> param = <span class="hljs-number"><span class="hljs-number">6</span></span> constructor(a: <span class="hljs-type"><span class="hljs-type">Int</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>(){ param = a } companion <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span></span>{ operator fun invoke() = <span class="hljs-type"><span class="hljs-type">B</span></span>(<span class="hljs-number"><span class="hljs-number">7</span></span>) } }</code> </pre><br>  For a class, a factory can be defined.  And if she were in class A, then the constructor would still be called there. <br></div></div><br>  Now you are ready for everything: <br><pre> <code class="scala hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title"></span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">constructor</span></span></span><span class="hljs-class">(</span><span class="hljs-params"></span><span class="hljs-class"><span class="hljs-params"></span>)</span></span>{...} <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> c = <span class="hljs-type"><span class="hljs-type">C</span></span>()</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Here an object of class C is created through a factory defined in a companion object of class C.</b> <div class="spoiler_text">  Of course not! <br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">private</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">constructor</span></span></span><span class="hljs-class">(</span><span class="hljs-params"></span><span class="hljs-class"><span class="hljs-params"></span>)</span></span>{ ... companion <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span></span>{ operator fun invoke() = <span class="hljs-type"><span class="hljs-type">A</span></span>(<span class="hljs-number"><span class="hljs-number">9</span></span>) } }</code> </pre><br>  Variable c will have type A. Notice that A and C are not related. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Full code</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> param = <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(a: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>(){ param = a } <span class="hljs-keyword"><span class="hljs-keyword">companion</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>= A(<span class="hljs-number"><span class="hljs-number">10</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">B</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">private</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> param = <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(a: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>(){ param = a } <span class="hljs-keyword"><span class="hljs-keyword">companion</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = B(<span class="hljs-number"><span class="hljs-number">7</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">private</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">constructor</span></span></span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> param = <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(a: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>(){ param = a } <span class="hljs-keyword"><span class="hljs-keyword">companion</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = A(<span class="hljs-number"><span class="hljs-number">9</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">D</span></span></span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> param = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(a: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>(){ param = a } <span class="hljs-keyword"><span class="hljs-keyword">companion</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">25</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = D(a) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(args: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Array</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> a = A() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> b = B() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> c = C() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> d = D() println(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${a.javaClass}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${a.param}</span></span></span><span class="hljs-string">"</span></span>) println(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${b.javaClass}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${b.param}</span></span></span><span class="hljs-string">"</span></span>) println(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${c.javaClass}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${c.param}</span></span></span><span class="hljs-string">"</span></span>) println(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${d.javaClass}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${d.param}</span></span></span><span class="hljs-string">"</span></span>) }</code> </pre><br>  Result of performance: <pre> class A, 5
 class B, 7
 class A, 9
 class D, 10
</pre><br></div></div><br>  Unfortunately, I could not come up with a short example where you really break everything.  But you can dream a little.  If you return the left class, as in the example with class C, then most likely the compiler will stop you.  But if you don‚Äôt pass the object anywhere, you can simulate the duck typing, as in the example.  Nothing criminal, but a person reading the code can go crazy and shoot himself if he doesn‚Äôt have the class source. <br>  If you have inheritance and functions for working with the base class (Animal), and invoke () from one heir (Dog) will return another heir to you (Duck), then when checking types (Animal as Dog) you can shake your misfortune. <br><br><div class="spoiler">  <b class="spoiler_title">What is there in Scala?</b> <div class="spoiler_text">  In Scala is easier - there is new, which always calls the constructor.  If new is not present, the companion's apply method is always called (which can also return the left type).  Of course, if something is not available to you because of private, then the compiler will curse.  All the same, only more obvious. <br></div></div><br><h4>  4. lateinit </h4><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SlowPoke</span></span></span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> value: String <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value == <span class="hljs-literal"><span class="hljs-literal">null</span></span>){ <span class="hljs-comment"><span class="hljs-comment">//  ,     (  ) println("null") return } if (value == "ololo") println("ololo!") else println("alala!") } } SlowPoke().test()</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">The result is predictable.</b> <div class="spoiler_text">  Exception in thread "main" kotlin.UninitializedPropertyAccessException: lateinit property value has not been initialized </div></div><br><div class="spoiler">  <b class="spoiler_title">What is the right way then?</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SlowBro</span></span></span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> value: String? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { println(<span class="hljs-string"><span class="hljs-string">"null"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value == <span class="hljs-string"><span class="hljs-string">"ololo"</span></span>) println(<span class="hljs-string"><span class="hljs-string">"ololo!"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> println(<span class="hljs-string"><span class="hljs-string">"alala!"</span></span>) } } SlowBro().test()</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text">  null </div></div><br></div></div><br>  I would say that this is also an approved way, but when reading the code it is not obvious, unlike the !!.  The documentation says a bit covertly that, they say, it is not necessary to check, if anything, we will throw Exception to you.  In theory, this modifier is used when you are sure that the field will be initialized by someone else.  That is, never.  In my experience, all fields that were lateinit, sooner or later became Nullable.  Not bad, this field fit into the JavaFX application controller, where Gui is loaded from FXML, but even this ‚Äúreinforced concrete‚Äù solution was overthrown after an alternative appeared without a pair of buttons.  Once it happened that in SceneBuilder I changed fx: id, but I forgot it in the code.  In the first days of coding on Kotlin, I got a little mad that you can't do lateinit Int.  I can think of why they did it this way, but I doubt that there is no way around these reasons (read: to make a crutch). <br><br><div class="spoiler">  <b class="spoiler_title">What is there in Scala?</b> <div class="spoiler_text">  And there is no analogue of lateinit as such.  At least I did not find. </div></div><br><h4>  5. Constructor </h4><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IAmInHurry</span></span></span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> param = initSecondParam() <span class="hljs-comment"><span class="hljs-comment">/*tons of code*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> twentySecondParam = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-comment"><span class="hljs-comment">/*tons of code*/</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initSecondParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>{ println(<span class="hljs-string"><span class="hljs-string">"Initializing by default with </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$twentySecondParam</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> twentySecondParam } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IAmInHurryWithStrings</span></span></span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> param = initSecondParam() <span class="hljs-comment"><span class="hljs-comment">/*tons of code*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> twentySecondParam = <span class="hljs-string"><span class="hljs-string">"Default value of param"</span></span> <span class="hljs-comment"><span class="hljs-comment">/*tons of code*/</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initSecondParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: String{ println(<span class="hljs-string"><span class="hljs-string">"Initializing by default with </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$twentySecondParam</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> twentySecondParam } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(args: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Array</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;)</span></span></span></span>{ IAmInHurry() IAmInHurryWithStrings() }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text">  Initializing by default with 0 <br>  Initializing by default with null </div></div><br>  Everything is simple - the field is addressed before it was initialized.  Apparently, here it is worth a little refine the compiler.  In theory, if you write code well, you should not have such a problem, but anything can happen, but I didn‚Äôt take this example from the ceiling (a colleague shot himself in the leg, accidentally through a chain of methods in a rarely triggered code caused a field that was not initialized). <br><br><div class="spoiler">  <b class="spoiler_title">What is there in Scala?</b> <div class="spoiler_text">  All the same. <br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Initializer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IAmInHurry</span></span></span><span class="hljs-class">(</span><span class="hljs-params"></span><span class="hljs-class"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> param = initSecondParam() <span class="hljs-comment"><span class="hljs-comment">/*tons of code*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> twentySecondParam = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-comment"><span class="hljs-comment">/*tons of code*/</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initSecondParam</span></span></span></span>(): <span class="hljs-type"><span class="hljs-type">Int</span></span> = { println(<span class="hljs-string"><span class="hljs-string">s"Initializing by default with </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">$twentySecondParam</span></span></span><span class="hljs-string">"</span></span>) twentySecondParam } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IAmInHurryWithStrings</span></span></span><span class="hljs-class">(</span><span class="hljs-params"></span><span class="hljs-class"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> param = initSecondParam() <span class="hljs-comment"><span class="hljs-comment">/*tons of code*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> twentySecondParam = <span class="hljs-string"><span class="hljs-string">"Default value of param"</span></span> <span class="hljs-comment"><span class="hljs-comment">/*tons of code*/</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initSecondParam</span></span></span></span>(): <span class="hljs-type"><span class="hljs-type">String</span></span> = { println(<span class="hljs-string"><span class="hljs-string">s"Initializing by default with </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">$twentySecondParam</span></span></span><span class="hljs-string">"</span></span>) twentySecondParam } } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>(args: <span class="hljs-type"><span class="hljs-type">Array</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>]){ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">IAmInHurry</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">IAmInHurryWithStrings</span></span>() } }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text">  Initializing by default with 0 <br>  Initializing by default with null </div></div><br></div></div><br><h4>  6. Interacting with Java </h4><br>  There is enough space for a shot here.  The obvious solution is to consider everything that came from Java, Nullable.  But there is a long and instructive <a href="http://blog.jetbrains.com/kotlin/2015/04/upcoming-change-more-null-safety-for-java/">story</a> .  As I understand it, it is mainly related to patterns, inheritance, and the Java-Kotlin-Java chain.  And with such scenarios, you had to make a lot of crutches to make it work.  Therefore, we decided to abandon the idea of ‚Äã‚Äã"all Nullable". <br>  But it seems like one of the main scenarios - we write our code in Kotlin, libraries take Java (as I see it, a simple peasant coder).  And in this situation, better security for the most part of the code and obvious crutches in a small part of the code, which can be seen than ‚Äúnice and comfortable‚Äù + a sudden rake at runtime (or a pit with stakes, as lucky).  But the developers have a different <a href="https://habrahabr.ru/company/JetBrains/blog/277573/">opinion</a> : <br><blockquote>  One of the main reasons was that writing in such a language was inconvenient, and reading it was unpleasant.  There are question and exclamation marks everywhere, which do not really help because they are arranged mainly to satisfy the compiler, and not to correctly handle the cases when the expression is evaluated in null.  Especially painful in the case of generics: for example, Map &lt;String ?, String?&gt;? .. <br></blockquote><br>  Make a small Java class: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JavaCopy</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String a = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">JavaCopy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">JavaCopy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span></span>{ a = s; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a; } }</code> </pre><br>  And try to call him from Kotlin: <br><pre> <code class="kotlin hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">printString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { println(s) } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> j1 = JavaCopy() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> j1Got = j1.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() printString(j1Got)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text">  Exception in thread "main" java.lang.IllegalStateException: j1Got must not be null </div></div><br>  Type at j1 - String!  and we will get an exception only when we call printString.  Ok, let's set the type explicitly: <pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> j2 = JavaCopy(<span class="hljs-string"><span class="hljs-string">"Test"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> j3 = JavaCopy(<span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> j2Got: String = j2.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> j3Got: String = j3.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>() printString(j2Got) printString(j3Got)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text">  Exception in thread "main" java.lang.IllegalStateException: j3.get () must not be null </div></div><br>  Everything is logical.  When we explicitly indicate that we need NotNullable, then we catch an exception.  It would seem, indicate all variables Nullable, and everything will be fine.  But if you do this: <br><pre> <code class="kotlin hljs">printString(j2.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>())</code> </pre>  then you may not find an error soon. <br><br><div class="spoiler">  <b class="spoiler_title">What is there in Scala?</b> <div class="spoiler_text">  No guarantees, NPE can be caught simply.  The solution is to wrap everything in Option, which, I remind you, has a good property that Option (null) = None.  On the other hand, there are no illusions that the java interop is safe. </div></div><br><h4>  7. infix notation and lambda </h4><br>  Make a chain of methods and call it: <br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;R&gt;</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">first</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func: ()</span></span></span></span> -&gt; R): R{ println(<span class="hljs-string"><span class="hljs-string">"calling first"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> func() } <span class="hljs-keyword"><span class="hljs-keyword">infix</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;R, T&gt;</span></span></span><span class="hljs-function"> R.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">second</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func: (</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">R</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> -&gt; T): T{ println(<span class="hljs-string"><span class="hljs-string">"calling second"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> func(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) } first { println(<span class="hljs-string"><span class="hljs-string">"calling first body"</span></span>) } second { println(<span class="hljs-string"><span class="hljs-string">"calling second body"</span></span>) }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text">  calling first <br>  calling first body <br>  Oops! <br>  calling second body </div></div><br>  Wait ... there is some kind of setup!  Indeed, I forgot to insert one method: <pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T&gt;</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">second</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func: ()</span></span></span></span> -&gt; T): T{ println(<span class="hljs-string"><span class="hljs-string">"Oops!"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> func() }</code> </pre><br>  And in order to work ‚Äúas it should,‚Äù it was necessary to write this: <pre> <code class="kotlin hljs">first { println(<span class="hljs-string"><span class="hljs-string">"calling first body"</span></span>) } second { println(<span class="hljs-string"><span class="hljs-string">"calling second body"</span></span>) }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Result</b> <div class="spoiler_text">  calling first <br>  calling first body <br>  calling second <br>  calling second body </div></div><br>  Just one line break, which is easy to remove / add behavior when reformatting.  Based on real events: there was a chain of ‚Äúmake in background‚Äù and ‚Äúthen make in ui thread‚Äù.  And there was a ‚Äúdo it in ui‚Äù method with the same name. <br><br><div class="spoiler">  <b class="spoiler_title">What is there in Scala?</b> <div class="spoiler_text">  The syntax is a little different, so it's so easy to shoot yourself here: <br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Infix</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">first</span></span></span></span>[<span class="hljs-type"><span class="hljs-type">R</span></span>](func: () =&gt; <span class="hljs-type"><span class="hljs-type">R</span></span>): <span class="hljs-type"><span class="hljs-type">R</span></span> = { println(<span class="hljs-string"><span class="hljs-string">"calling first"</span></span>) func() } <span class="hljs-keyword"><span class="hljs-keyword">implicit</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Second</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">R</span></span></span><span class="hljs-class">](</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">val value: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">R</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AnyVal</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">second</span></span></span></span>[<span class="hljs-type"><span class="hljs-type">T</span></span>](func: (<span class="hljs-type"><span class="hljs-type">R</span></span>) =&gt; <span class="hljs-type"><span class="hljs-type">T</span></span>): <span class="hljs-type"><span class="hljs-type">T</span></span> = { println(<span class="hljs-string"><span class="hljs-string">"calling second"</span></span>) func(value) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">second</span></span></span></span>[<span class="hljs-type"><span class="hljs-type">T</span></span>](func: () =&gt; <span class="hljs-type"><span class="hljs-type">T</span></span>): <span class="hljs-type"><span class="hljs-type">T</span></span> = { println(<span class="hljs-string"><span class="hljs-string">"Oops!"</span></span>) func() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>(args: <span class="hljs-type"><span class="hljs-type">Array</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>]) { first { () =&gt; println(<span class="hljs-string"><span class="hljs-string">"calling first body"</span></span>) } second { () =&gt; <span class="hljs-comment"><span class="hljs-comment">//&lt;--------type mismach println("calling second body") } } }</span></span></code> </pre><br>  But, trying to adjust the skalovsky code at least for non-obviousness due to implicit / underscore, I blew everything around. <br><div class="spoiler">  <b class="spoiler_title">Caution!</b>  <b class="spoiler_title">Blood, guts and dismemberment ...</b> <div class="spoiler_text"><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Infix2</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">first</span></span></span></span>(func: (<span class="hljs-type"><span class="hljs-type">Unit</span></span>) =&gt; <span class="hljs-type"><span class="hljs-type">Unit</span></span>): <span class="hljs-type"><span class="hljs-type">Unit</span></span> = { println(<span class="hljs-string"><span class="hljs-string">"calling first"</span></span>) func() } <span class="hljs-keyword"><span class="hljs-keyword">implicit</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Second</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">val value: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">Unit</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AnyVal</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">second</span></span></span></span>(func: (<span class="hljs-type"><span class="hljs-type">Unit</span></span>) =&gt; <span class="hljs-type"><span class="hljs-type">Unit</span></span>): <span class="hljs-type"><span class="hljs-type">Unit</span></span> = { println(<span class="hljs-string"><span class="hljs-string">"calling second"</span></span>) func(value) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">second</span></span></span></span>(func: (<span class="hljs-type"><span class="hljs-type">Unit</span></span>) =&gt; <span class="hljs-type"><span class="hljs-type">Unit</span></span>): <span class="hljs-type"><span class="hljs-type">Unit</span></span> = { println(<span class="hljs-string"><span class="hljs-string">"Oops!"</span></span>) func() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>(args: <span class="hljs-type"><span class="hljs-type">Array</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>]) { first { _ =&gt; println(<span class="hljs-string"><span class="hljs-string">"calling first body"</span></span>) } second { _ =&gt; println(<span class="hljs-string"><span class="hljs-string">"calling second body"</span></span>) } } }</code> </pre><br>  And the result: <br><pre> Exception in thread "main" java.lang.VerifyError: Operand stack underflow
 Exception Details:
   Location:
     Infix2 $ Second $ .equals $ extension (Lscala / runtime / BoxedUnit; Ljava / lang / Object;) Z @ 40: pop
   Reason:
     Attempt to pop empty stack.
   Current Frame:
     bci: @ 40
     flags: {}
     locals: {'Infix2 $ Second $', 'scala / runtime / BoxedUnit', 'java / lang / Object', 'java / lang / Object', integer}
     stack: {}
   Bytecode:
     0000000: 2c4e 2dc1 0033 9900 0904 3604 a700 0603
     0000010: 3604 1504 9900 4d2c c700 0901 5701 a700
     0000020: 102c c000 33b6 0036 57bb 0038 59bf 3a05
     0000030: b200 1f57 b200 1fb2 001f 57b2 001f 3a06
     0000040: 59c7 000c 5719 06c6 000e a700 0f19 06b6
     0000050: 003c 9900 0704 a700 0403 9900 0704 a700
     0000060: 0403 ac                                
   Stackmap Table:
     append_frame (@ 15, Object [# 4])
     append_frame (@ 18, Integer)
     same_frame (@ 33)
     same_locals_1_stack_item_frame (@ 46, Null)
     full_frame (@ 77, {Object [# 2], Object [# 27], Object [# 4], Object [# 4], Integer, Null, Object [# 27]}, {Object [# 27]})
     same_frame (@ 85)
     same_frame (@ 89)
     same_locals_1_stack_item_frame (@ 90, Integer)
     chop_frame (@ 97.2)
     same_locals_1_stack_item_frame (@ 98, Integer)<font></font>
<font></font>
	 at Infix2 $ .main (Infix.scala)
</pre></div></div></div></div><br><h4>  8. Overload methods and it </h4><br>  It is, rather, a method to play with others.  Imagine that you are writing a library and there is a function in it <br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applier</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, func: (</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>){ func(x) }</code> </pre><br>  Of course, the people use it in a rather transparent way: <br><pre> <code class="kotlin hljs"> applier (<span class="hljs-string"><span class="hljs-string">"arg"</span></span>) { println(it) } applier (<span class="hljs-string"><span class="hljs-string">"no arg"</span></span>) { println(<span class="hljs-string"><span class="hljs-string">"ololo"</span></span>) }</code> </pre><br>  The code is compiled, it works, everyone is happy.  And then you add the method <br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applier</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, func: ()</span></span></span></span> -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>){ println(<span class="hljs-string"><span class="hljs-string">"not applying </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$x</span></span></span><span class="hljs-string">"</span></span>) func() }</code> </pre><br>  And so that the compiler does not swear, users will have to abandon it everywhere (read: rewrite a bunch of code): <br><pre> <code class="kotlin hljs"> applier (<span class="hljs-string"><span class="hljs-string">"arg"</span></span>) { it -&gt; <span class="hljs-comment"><span class="hljs-comment">//FIXED println(it) } applier ("no arg") { -&gt; //yes, explicit! println("ololo") }</span></span></code> </pre><br>  Although, theoretically, the compiler could guess that if it is, then it is lambda with 1 input argument.  I think that with the development of the language and the compiler will grow wiser, and this point is temporary. <br><br><div class="spoiler">  <b class="spoiler_title">What is there in Scala?</b> <div class="spoiler_text">  Without arguments, you have to explicitly indicate that this is lambda.  And when you add a new method, the behavior will not change. <br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Its</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applier</span></span></span></span>(x: <span class="hljs-type"><span class="hljs-type">String</span></span>, func: (<span class="hljs-type"><span class="hljs-type">String</span></span>) =&gt; <span class="hljs-type"><span class="hljs-type">Unit</span></span>){ func(x) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">applier</span></span></span></span>(x: <span class="hljs-type"><span class="hljs-type">String</span></span>, func: () =&gt; <span class="hljs-type"><span class="hljs-type">Unit</span></span>){ println(<span class="hljs-string"><span class="hljs-string">"not applying $x"</span></span>) func() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>(args: <span class="hljs-type"><span class="hljs-type">Array</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>]) { applier(<span class="hljs-string"><span class="hljs-string">"arg"</span></span>, println(_)) applier(<span class="hljs-string"><span class="hljs-string">"no arg"</span></span>, _ =&gt; println(<span class="hljs-string"><span class="hljs-string">"ololo"</span></span>)) } }</code> </pre></div></div><br><h4>  9. Why you shouldn‚Äôt think of Nullable as Option </h4><br>  Suppose we have a wrapper for the cache: <br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cache</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">T</span></span></span><span class="hljs-class">&gt;</span></span>(){ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> elements: MutableMap&lt;String, T&gt; = HashMap() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">put</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(key: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">, elem: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">T</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = elements.put(key, elem) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(key: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = elements[key] }</code> </pre><br>  And a simple usage scenario: <pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cache = Cache&lt;String&gt;() cache.put(<span class="hljs-string"><span class="hljs-string">"foo"</span></span>, <span class="hljs-string"><span class="hljs-string">"bar"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(key: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { cache.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(key)?.let { println(<span class="hljs-string"><span class="hljs-string">"Got </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$key</span></span></span><span class="hljs-string"> from cache: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$it</span></span></span><span class="hljs-string">"</span></span>) } ?: println(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$key</span></span></span><span class="hljs-string"> is not in cache!"</span></span>) } getter(<span class="hljs-string"><span class="hljs-string">"foo"</span></span>) getter(<span class="hljs-string"><span class="hljs-string">"baz"</span></span>)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">The result is pretty predictable.</b> <div class="spoiler_text">  Got foo from cache: bar <br>  baz is not in cache! </div></div><br>  But if we suddenly want to keep the cache Nullable ... <pre> <code class="kotlin hljs"> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cache = Cache&lt;String?&gt;() cache.put(<span class="hljs-string"><span class="hljs-string">"foo"</span></span>, <span class="hljs-string"><span class="hljs-string">"bar"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(key: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { cache.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(key)?.let { println(<span class="hljs-string"><span class="hljs-string">"Got </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$key</span></span></span><span class="hljs-string"> from cache: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$it</span></span></span><span class="hljs-string">"</span></span>) } ?: println(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$key</span></span></span><span class="hljs-string"> is not in cache!"</span></span>) } getter(<span class="hljs-string"><span class="hljs-string">"foo"</span></span>) getter(<span class="hljs-string"><span class="hljs-string">"baz"</span></span>) cache.put(<span class="hljs-string"><span class="hljs-string">"IAmNull"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>) getter(<span class="hljs-string"><span class="hljs-string">"IAmNull"</span></span>)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">That will not work very well.</b> <div class="spoiler_text">  Got foo from cache: bar <br>  baz is not in cache! <br>  IAmNull is not in cache! </div></div><br>  Why keep null?  For example, to show that the result is not computable.  Of course, it would be better to use Option or Either, but, unfortunately, neither the one nor the other is in the standard library (but there is, for example, in <a href="https://github.com/MarioAriasC/funKTionale/wiki">funKTionale</a> ).  Moreover, just when implementing Either, I stepped on the rake of this item and the previous one.  To solve this problem with the ‚Äúdouble Nullable‚Äù you can, for example, return a Pair or a special data class. <br><br><div class="spoiler">  <b class="spoiler_title">What is there in Scala?</b> <div class="spoiler_text">  No one forbids making Option from Option.  I hope it is clear that everything will be alright.  Yes, and with null too: <br><pre> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">doubleNull</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Cache</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">T</span></span></span><span class="hljs-class">]</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> elements = mutable.<span class="hljs-type"><span class="hljs-type">Map</span></span>.empty[<span class="hljs-type"><span class="hljs-type">String</span></span>, <span class="hljs-type"><span class="hljs-type">T</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">put</span></span></span></span>(key: <span class="hljs-type"><span class="hljs-type">String</span></span>, elem: <span class="hljs-type"><span class="hljs-type">T</span></span>) = elements.put(key, elem) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span></span>(key: <span class="hljs-type"><span class="hljs-type">String</span></span>) = elements.get(key) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span></span>(args: <span class="hljs-type"><span class="hljs-type">Array</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cache = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Cache</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>]() cache.put(<span class="hljs-string"><span class="hljs-string">"foo"</span></span>, <span class="hljs-string"><span class="hljs-string">"bar"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getter</span></span></span></span>(key: <span class="hljs-type"><span class="hljs-type">String</span></span>) { cache.get(key) <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-type"><span class="hljs-type">Some</span></span>(value) =&gt; println(<span class="hljs-string"><span class="hljs-string">s"Got </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">$key</span></span></span><span class="hljs-string"> from cache: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">$value</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-type"><span class="hljs-type">None</span></span> =&gt; println(<span class="hljs-string"><span class="hljs-string">s"</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">$key</span></span></span><span class="hljs-string"> is not in cache!"</span></span>) } } getter(<span class="hljs-string"><span class="hljs-string">"foo"</span></span>) getter(<span class="hljs-string"><span class="hljs-string">"baz"</span></span>) cache.put(<span class="hljs-string"><span class="hljs-string">"IAmNull"</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>) getter(<span class="hljs-string"><span class="hljs-string">"IAmNull"</span></span>) }</code> </pre><div class="spoiler">  <b class="spoiler_title">All is well</b> <div class="spoiler_text">  Got foo from cache: bar <br>  baz is not in cache! <br>  Got IAmNull from cache: null </div></div></div></div><br><h4>  10. Declaring methods </h4><br>  Bonus for those who previously wrote on Scala.  The sponsor of this item is <a href="https://habr.com/users/lgorsl/" class="user_link">lgorSL</a> . <br>  <a href="https://habrahabr.ru/post/277479/">I quote:</a> <br><blockquote>  ... <br>  Or, for example, the syntax of a method declaration: <br>  In scala: def methodName (...) = {...} <br>  In kotlin, two options are possible - as in scala (with the = sign) and as in java (without it), but these two ways of declaring are not equivalent to each other and work a little differently, I once spent a lot of time searching for such a ‚Äúfeature‚Äù in code. <br>  ... <br></blockquote><br><blockquote>  I meant the following: <br><br>  fun test () {println ("it works")} <br>  fun test2 () = println ("it works too") <br>  fun test3 () = {println ("surprise!")} <br><br>  To display ‚Äúsurprise‚Äù, you have to write test3 () ().  The test3 () call option is also compiled normally, it only works not as expected - adding ‚Äúextra‚Äù parentheses drastically changes the program logic. <br><br>  Because of these rakes, the transition from cliff to Kotlin turned out to be a bit painful - sometimes I write an equal sign ‚Äúout of habit‚Äù in declaring some method, and then I have to look for mistakes. </blockquote><br><br><h4>  Conclusion </h4><br>  This list is probably not exhausted, so share in the comments how you were on the road to adventure, but then something went wrong ... <br>  The language has many positive features about which you can read on the <a href="http://kotlinlang.org/">official website</a> , in <a href="https://habrahabr.ru/post/277479/">articles</a> <a href="https://habrahabr.ru/post/268463/">on</a> <a href="https://habrahabr.ru/post/274997/">Habr√©</a> and many more where.  But personally, I disagree with some architectural solutions (classes final by default, java interop) and sometimes it is felt that the language lacks uniformity and consistency.  In addition to the example with lateinit Int, I will give two more.  Inside the let blocks we use it, inside with with this, and inside run, <a href="http://beust.com/weblog/2015/10/30/exploring-the-kotlin-standard-library/">which is a combination of let and this</a> what should I use?  And the class String!  You can call the methods isBlank (), isNotBlank (), isNullOrBlank (), and there is no ‚Äúcomplementary‚Äù method like <code>isNotNullOrBlank</code> :( After Scala lacks some things - Option, Either, matching, currying. But in general, the language leaves a pleasant impression, I hope that he will continue to develop with dignity <br><br>  PS Kablin's illumination of Habrovskaya is lame, I hope that the administration of <a href="https://habr.com/users/habrahabr/" class="user_link">habrahabr</a> will sometime correct this ... <br><br><h4>  UPD: Shots from commentators (I will update) </h4><br>  <a href="https://habrahabr.ru/post/278169/">The obvious priority of the elvis operator</a> .  The author is <a href="https://habr.com/users/senia/" class="user_link">senia</a> . <br><br><h4>  UPD2 </h4><br>  Pay attention to the article <a href="https://habrahabr.ru/post/308312/">Kotlin: without Best Practices and life is not the same</a> . <br>  In the <a href="https://habrahabr.ru/post/308312/">comments</a> there is another smart shot from <a href="https://habr.com/users/artem_zin/" class="user_link">Artem_zin</a> : the ability to redefine get () from val and return values ‚Äã‚Äãdynamically. <br><br><h4>  UPD3 </h4><br>  Some more newbies might think that the <code>and</code> and <code>or</code> operators for Boolean variables are such a sugar for ‚Äúunreadable‚Äù <code>&amp;&amp;</code> and <code>||</code>  .  However, this is not so: although the result of the calculations will be the same, but the "old" operators are calculated lazily.  Therefore, if you suddenly write like this: <br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((i &gt;= <span class="hljs-number"><span class="hljs-number">3</span></span>) and (someArray[i-<span class="hljs-number"><span class="hljs-number">3</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>)){ <span class="hljs-comment"><span class="hljs-comment">//do something }</span></span></code> </pre>  then get an exception when <code>i&lt;3</code> . </div><p>Source: <a href="https://habr.com/ru/post/278169/">https://habr.com/ru/post/278169/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278153/index.html">Part 1. Installing and Configuring a Reputable DNS Server Based on the PowerDNS Solution // Basic Installation</a></li>
<li><a href="../278159/index.html">Debian's RISC under QEMU</a></li>
<li><a href="../278163/index.html">CodingFuture + Puppet. Part III: Install Puppet Server (cfpuppetserver)</a></li>
<li><a href="../278165/index.html">Best practices Richard Siddeway Powershell in depth</a></li>
<li><a href="../278167/index.html">HTTP / 2: getting ready for the transition</a></li>
<li><a href="../278171/index.html">Simple checksum calculation</a></li>
<li><a href="../278173/index.html">ASP.NET Core + Docker: Cooking Together</a></li>
<li><a href="../278175/index.html">Differences between Azure Resource Manager and Azure Service Manager - a developer‚Äôs perspective</a></li>
<li><a href="../278177/index.html">Azure-IaaS-Digest number 2 (February)</a></li>
<li><a href="../278179/index.html">Why technical debt is good</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>