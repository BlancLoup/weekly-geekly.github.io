<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PyGA: using Google Analytics tracking in a backend written in Python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For the recently made me in the framework of the study of Flask microservice shares.datagreed.ru I wanted to track transitions to different API addres...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PyGA: using Google Analytics tracking in a backend written in Python</h1><div class="post__text post__text-html js-mediator-article"> For the recently made me in the framework of the study of Flask microservice <a href="http://shares.datagreed.ru/">shares.datagreed.ru</a> I wanted to track transitions to different API addresses.  How to do this if Google Analytics is integrated into the page via JS? <br><br>  So I did not know either.  The search led me to the official PHP library for mobile sites that were not supposed (once) to use JavaScript. <br><br>  Further my research resulted in a <a href="https://bitbucket.org/DataGreed/pyga">small</a> python <a href="https://bitbucket.org/DataGreed/pyga">module</a> that allows you to use page tracking (events, alas, are not supported) by Google Analytics from the server side.  Regularly in the library included classes for Django and Flask.  The class for Flask is currently deployed and run around me on <a href="http://shares.datagreed.ru/">shares.datagreed.ru</a> , and I have not tested the class for Django yet, so bug reports are welcome. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  Django is used like this (in <code>views.py</code> ): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyga <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DjangoGATracker <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">some_view</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(request)</span></span></span><span class="hljs-function">:</span></span> ga = DjangoGATracker(<span class="hljs-string"><span class="hljs-string">'domain.com'</span></span>, <span class="hljs-string"><span class="hljs-string">'UA-xxxx'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   GA ga.track(request) #    #&lt;...&gt;</span></span></code> </pre><br><br>  For Flask, you need to pass another session object: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> flask <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> request, session <span class="hljs-comment"><span class="hljs-comment">#   secret_key    flask, .   flask from pyga import FlaskGATracker #&lt;...&gt; ga = FlaskGATracker('domain.com', 'UA-xxxx') # GA ga.track(request, session) #  </span></span></code> </pre><br><br>  If necessary, you can use all of this at a slightly lower level: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyga <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GATracker ga = GATracker(<span class="hljs-string"><span class="hljs-string">'domain.com'</span></span>, <span class="hljs-string"><span class="hljs-string">'UA-xxxx'</span></span>) ga.track(<span class="hljs-string"><span class="hljs-string">'/api/news/'</span></span>, user_session_id, ip_address, useragent)</code> </pre><br><br>  The project lives <a href="https://bitbucket.org/DataGreed/pyga">on the beatback</a> .  Documentation there is a draft, if someone is interested, I can add it. <br><br>  Installing with pip: <br><pre> <code class="bash hljs">pip install -e git+https://bitbucket.org/DataGreed/pyga.git<span class="hljs-comment"><span class="hljs-comment">#egg=pyga-dev</span></span></code> </pre><br><br>  Pull requests are welcome :) </div><p>Source: <a href="https://habr.com/ru/post/157621/">https://habr.com/ru/post/157621/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../157611/index.html">NVIDIA turned to Linux</a></li>
<li><a href="../157613/index.html">So how to delete millions of files from one folder?</a></li>
<li><a href="../157615/index.html">Implementing a Singleton design pattern for PHP 5.4</a></li>
<li><a href="../157617/index.html">MongoDb for developers. Week 2</a></li>
<li><a href="../157619/index.html">Real-time identification and positioning technologies</a></li>
<li><a href="../157627/index.html">ScrollUP buttons. Fast scrolling on any site</a></li>
<li><a href="../157631/index.html">Overview of Corporate Training Services</a></li>
<li><a href="../157633/index.html">MIPS sold its patents, and then Imagination was purchased.</a></li>
<li><a href="../157635/index.html">THQ lost half its capitalization</a></li>
<li><a href="../157639/index.html">Calendar for ITshnikov: introduction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>