<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Add Javascript to XSLT</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello dear habrazhiteli! 
 I would like to present you my small project which I think may be useful to many of you. XSR is an extension for the Saxon ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Add Javascript to XSLT</h1><div class="post__text post__text-html js-mediator-article">  Hello dear habrazhiteli! <br>  I would like to present you my small project which I think may be useful to many of you.  <b>XSR</b> is an extension for the Saxon XSLT processor that allows you to use JavaScript directly in the XSLT program code.  So what we have: <br><ul><li>  The Saxon XSLT processor is a reasonable choice for someone who wants to use a modern XSLT 2, and as far as I know the most complete implementation is only in Saxon. </li><li>  Mozilla Rhino JavaScript engine is essentially a virtual JavaScript machine written in Java. </li><li>  Apache ant build tool is mainly used to automate routine operations (for example, deploying an application on a remote server, after automatic compression of all files ... </li><li>  The desire to put it all together and get a working JavaScript in XSLT runtime </li></ul><a name="habracut"></a>  So let's proceed directly to the installation and use, in order to show all the living examples.  For a start, you can get acquainted with the main features of my crafts on this page: <a href="http://code.google.com/p/xsr/wiki/introduction">Description (eng.)</a> . <br><br><h4>  Briefly about installation and configuration </h4><ul><li>  If you have not installed ANT, then we do this by reading the description for example <a href="http://www.jboss.ru/translate/jboss24/ch01s05.html">here.</a> </li><li>  We are taking the trunk <a href="http://xsr.googlecode.com/svn/trunk/">from here</a> .  There you will find a project under NetBeans, source codes, binaries and tests.  Immediately make a reservation, I'm not a Java programmer, and therefore my code from those of you who are professional in this field may seem hmm ... funny? </li><li>  Go to the test folder and check the correctness of the paths in the build.xml file </li><li>  Go to the console in the same test folder, write <b>ant</b> and watch how the examples from the test.xsl / test.js file are executed </li></ul> To use the extension, you will need to add the following namespace definition to the root element of the XSLT document: <br> <code>xmlns:xsr="java:/xsr.XSRElementFactory"</code> <br> <br>  Then add <code>extension-element-prefixes="xsr"</code> to the same - i.e.  to the list of root element attributes.  This instruction will tell Saxon that the xsr prefix defines an external extension.  In other words, after the above manipulations, the root element will look like this: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <h4>  Using the xsr: script statement </h4><br>  There are two ways to define and use xsr: script. <br>  Firstly, you can use the href attribute to connect (and immediately execute) an external javascript file.  Like this: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- script defined in external file --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#ff0000">href</font> <font color="#0000ff">="test.js"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- script defined in external file --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#ff0000">href</font> <font color="#0000ff">="test.js"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- script defined in external file --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#ff0000">href</font> <font color="#0000ff">="test.js"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code>  This code will connect the external test.js file (which should be located relative to the location of the document) to your xsl document and execute it. <br><br>  Secondly, you can write your JavaScript code directly in an XSLT document, in this simple way: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- simple script --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message('The Obligatory Hello World Example:');&lt;br&gt;                message('HELLO WORLD!');&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- simple script --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message('The Obligatory Hello World Example:');&lt;br&gt;                message('HELLO WORLD!');&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- simple script --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message('The Obligatory Hello World Example:');&lt;br&gt;                message('HELLO WORLD!');&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <h4>  Passing parameters to the script using xsr: with-param </h4><br>  In some cases, you may need to pass parameters declared from the outside into your JavaScript code.  For these purposes, you can use a special instruction: xsr: with-param.  Example: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- simple script --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:with-param</font> <font color="#ff0000">name</font> <font color="#0000ff">="foo"</font> <font color="#ff0000">select</font> <font color="#0000ff">="string('bar')"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:with-param</font> <font color="#ff0000">name</font> <font color="#0000ff">="bar"</font> <font color="#ff0000">select</font> <font color="#0000ff">="local-name(.)"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message('foo is:', getParam('foo'));&lt;br&gt;                message('bar is:', getParam('bar'));&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- simple script --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:with-param</font> <font color="#ff0000">name</font> <font color="#0000ff">="foo"</font> <font color="#ff0000">select</font> <font color="#0000ff">="string('bar')"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:with-param</font> <font color="#ff0000">name</font> <font color="#0000ff">="bar"</font> <font color="#ff0000">select</font> <font color="#0000ff">="local-name(.)"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message('foo is:', getParam('foo'));&lt;br&gt;                message('bar is:', getParam('bar'));&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- simple script --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:with-param</font> <font color="#ff0000">name</font> <font color="#0000ff">="foo"</font> <font color="#ff0000">select</font> <font color="#0000ff">="string('bar')"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:with-param</font> <font color="#ff0000">name</font> <font color="#0000ff">="bar"</font> <font color="#ff0000">select</font> <font color="#0000ff">="local-name(.)"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message('foo is:', getParam('foo'));&lt;br&gt;                message('bar is:', getParam('bar'));&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code>  <b>Attention!</b>  At the moment, everything that was transferred to the script in such a described manner will be automatically converted into a string, so transferring the fragments of the XML document in this way will not work. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Using xsr: body with XSL elements </h4><br>  You can mix JavaScript and XSLT by creating a situation when your JavaScript code is generated on the fly in this way: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- script generate itself --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt;                message('\r');&lt;br&gt;                message('Script generate itself:');&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:for-each</font> <font color="#ff0000">select</font> <font color="#0000ff">="1 to 5"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;                    message('position() = ' + <font color="#0000ff">&lt;</font> <font color="#800000">xsl:value-of</font> <font color="#ff0000">select</font> <font color="#0000ff">="position()"</font> <font color="#0000ff">/&gt;</font> );&lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:for-each</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- script generate itself --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt;                message('\r');&lt;br&gt;                message('Script generate itself:');&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:for-each</font> <font color="#ff0000">select</font> <font color="#0000ff">="1 to 5"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;                    message('position() = ' + <font color="#0000ff">&lt;</font> <font color="#800000">xsl:value-of</font> <font color="#ff0000">select</font> <font color="#0000ff">="position()"</font> <font color="#0000ff">/&gt;</font> );&lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:for-each</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- script generate itself --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt;                message('\r');&lt;br&gt;                message('Script generate itself:');&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:for-each</font> <font color="#ff0000">select</font> <font color="#0000ff">="1 to 5"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;                    message('position() = ' + <font color="#0000ff">&lt;</font> <font color="#800000">xsl:value-of</font> <font color="#ff0000">select</font> <font color="#0000ff">="position()"</font> <font color="#0000ff">/&gt;</font> );&lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:for-each</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <h4>  Using JavaScript to generate the resulting XML document </h4><br>  Use the following example to generate the resulting XML document using JavaScript: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- script that produces simple XML document as a result --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message();&lt;br&gt;                startElement('test');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> 10; c++) {&lt;br&gt;                    startElement('item_' + c);&lt;br&gt;                    characters('value_' + c);&lt;br&gt;                    endElement();&lt;br&gt;                }&lt;br&gt;                endElement();&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- script that produces simple XML document as a result --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message();&lt;br&gt;                startElement('test');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> 10; c++) {&lt;br&gt;                    startElement('item_' + c);&lt;br&gt;                    characters('value_' + c);&lt;br&gt;                    endElement();&lt;br&gt;                }&lt;br&gt;                endElement();&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font>&lt;!-- script that produces simple XML document as a result --&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message();&lt;br&gt;                startElement('test');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> 10; c++) {&lt;br&gt;                    startElement('item_' + c);&lt;br&gt;                    characters('value_' + c);&lt;br&gt;                    endElement();&lt;br&gt;                }&lt;br&gt;                endElement();&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code>  Generated XML document: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">test</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_0</font> <font color="#0000ff">&gt;</font> value_0 <font color="#0000ff">&lt;/</font> <font color="#800000">item_0</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_1</font> <font color="#0000ff">&gt;</font> value_1 <font color="#0000ff">&lt;/</font> <font color="#800000">item_1</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_2</font> <font color="#0000ff">&gt;</font> value_2 <font color="#0000ff">&lt;/</font> <font color="#800000">item_2</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_3</font> <font color="#0000ff">&gt;</font> value_3 <font color="#0000ff">&lt;/</font> <font color="#800000">item_3</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_4</font> <font color="#0000ff">&gt;</font> value_4 <font color="#0000ff">&lt;/</font> <font color="#800000">item_4</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_5</font> <font color="#0000ff">&gt;</font> value_5 <font color="#0000ff">&lt;/</font> <font color="#800000">item_5</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_6</font> <font color="#0000ff">&gt;</font> value_6 <font color="#0000ff">&lt;/</font> <font color="#800000">item_6</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_7</font> <font color="#0000ff">&gt;</font> value_7 <font color="#0000ff">&lt;/</font> <font color="#800000">item_7</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_8</font> <font color="#0000ff">&gt;</font> value_8 <font color="#0000ff">&lt;/</font> <font color="#800000">item_8</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_9</font> <font color="#0000ff">&gt;</font> value_9 <font color="#0000ff">&lt;/</font> <font color="#800000">item_9</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">test</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">test</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_0</font> <font color="#0000ff">&gt;</font> value_0 <font color="#0000ff">&lt;/</font> <font color="#800000">item_0</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_1</font> <font color="#0000ff">&gt;</font> value_1 <font color="#0000ff">&lt;/</font> <font color="#800000">item_1</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_2</font> <font color="#0000ff">&gt;</font> value_2 <font color="#0000ff">&lt;/</font> <font color="#800000">item_2</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_3</font> <font color="#0000ff">&gt;</font> value_3 <font color="#0000ff">&lt;/</font> <font color="#800000">item_3</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_4</font> <font color="#0000ff">&gt;</font> value_4 <font color="#0000ff">&lt;/</font> <font color="#800000">item_4</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_5</font> <font color="#0000ff">&gt;</font> value_5 <font color="#0000ff">&lt;/</font> <font color="#800000">item_5</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_6</font> <font color="#0000ff">&gt;</font> value_6 <font color="#0000ff">&lt;/</font> <font color="#800000">item_6</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_7</font> <font color="#0000ff">&gt;</font> value_7 <font color="#0000ff">&lt;/</font> <font color="#800000">item_7</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_8</font> <font color="#0000ff">&gt;</font> value_8 <font color="#0000ff">&lt;/</font> <font color="#800000">item_8</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_9</font> <font color="#0000ff">&gt;</font> value_9 <font color="#0000ff">&lt;/</font> <font color="#800000">item_9</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">test</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">test</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_0</font> <font color="#0000ff">&gt;</font> value_0 <font color="#0000ff">&lt;/</font> <font color="#800000">item_0</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_1</font> <font color="#0000ff">&gt;</font> value_1 <font color="#0000ff">&lt;/</font> <font color="#800000">item_1</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_2</font> <font color="#0000ff">&gt;</font> value_2 <font color="#0000ff">&lt;/</font> <font color="#800000">item_2</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_3</font> <font color="#0000ff">&gt;</font> value_3 <font color="#0000ff">&lt;/</font> <font color="#800000">item_3</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_4</font> <font color="#0000ff">&gt;</font> value_4 <font color="#0000ff">&lt;/</font> <font color="#800000">item_4</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_5</font> <font color="#0000ff">&gt;</font> value_5 <font color="#0000ff">&lt;/</font> <font color="#800000">item_5</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_6</font> <font color="#0000ff">&gt;</font> value_6 <font color="#0000ff">&lt;/</font> <font color="#800000">item_6</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_7</font> <font color="#0000ff">&gt;</font> value_7 <font color="#0000ff">&lt;/</font> <font color="#800000">item_7</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_8</font> <font color="#0000ff">&gt;</font> value_8 <font color="#0000ff">&lt;/</font> <font color="#800000">item_8</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">item_9</font> <font color="#0000ff">&gt;</font> value_9 <font color="#0000ff">&lt;/</font> <font color="#800000">item_9</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">test</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <h4>  Using Java classes in JavaScript code </h4><br>  You can use any Java classes in your JavaScript code, as follows: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                function buildDirectoryTree(sRootDirectory, sTrimDirectory) {&lt;br&gt;                    var aResultTree = [];&lt;br&gt;                    var aFiles = (new Packages.java.io.File(sRootDirectory)).listFiles();&lt;br&gt;                    for (var iFile = 0; iFile <font color="#0000ff">&lt;</font> aFiles.length; iFile++) {&lt;br&gt;                        var sFileName = String(aFiles[iFile]);&lt;br&gt;                        var bIsDirectory = aFiles[iFile].isDirectory();&lt;br&gt;                        if (!bIsDirectory) {&lt;br&gt;                            aResultTree.push(sFileName.substr((&lt;br&gt;                                sTrimDirectory ?&lt;br&gt;                                sTrimDirectory :&lt;br&gt;                                sRootDirectory&lt;br&gt;                            ).length));&lt;br&gt;                        } else {&lt;br&gt;                            aResultTree = aResultTree.concat(&lt;br&gt;                                buildDirectoryTree(&lt;br&gt;                                    sFileName,&lt;br&gt;                                    sRootDirectory&lt;br&gt;                                )&lt;br&gt;                            );&lt;br&gt;                        }&lt;br&gt;                    }&lt;br&gt;                    return aResultTree;&lt;br&gt;                }&lt;br&gt;                // Build directory tree&lt;br&gt;                var aDirectoryTree = buildDirectoryTree('.');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> aDirectoryTree.length; c++) {&lt;br&gt;                    message('Found directory:', aDirectoryTree[c]);&lt;br&gt;                }&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                function buildDirectoryTree(sRootDirectory, sTrimDirectory) {&lt;br&gt;                    var aResultTree = [];&lt;br&gt;                    var aFiles = (new Packages.java.io.File(sRootDirectory)).listFiles();&lt;br&gt;                    for (var iFile = 0; iFile <font color="#0000ff">&lt;</font> aFiles.length; iFile++) {&lt;br&gt;                        var sFileName = String(aFiles[iFile]);&lt;br&gt;                        var bIsDirectory = aFiles[iFile].isDirectory();&lt;br&gt;                        if (!bIsDirectory) {&lt;br&gt;                            aResultTree.push(sFileName.substr((&lt;br&gt;                                sTrimDirectory ?&lt;br&gt;                                sTrimDirectory :&lt;br&gt;                                sRootDirectory&lt;br&gt;                            ).length));&lt;br&gt;                        } else {&lt;br&gt;                            aResultTree = aResultTree.concat(&lt;br&gt;                                buildDirectoryTree(&lt;br&gt;                                    sFileName,&lt;br&gt;                                    sRootDirectory&lt;br&gt;                                )&lt;br&gt;                            );&lt;br&gt;                        }&lt;br&gt;                    }&lt;br&gt;                    return aResultTree;&lt;br&gt;                }&lt;br&gt;                // Build directory tree&lt;br&gt;                var aDirectoryTree = buildDirectoryTree('.');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> aDirectoryTree.length; c++) {&lt;br&gt;                    message('Found directory:', aDirectoryTree[c]);&lt;br&gt;                }&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                function buildDirectoryTree(sRootDirectory, sTrimDirectory) {&lt;br&gt;                    var aResultTree = [];&lt;br&gt;                    var aFiles = (new Packages.java.io.File(sRootDirectory)).listFiles();&lt;br&gt;                    for (var iFile = 0; iFile <font color="#0000ff">&lt;</font> aFiles.length; iFile++) {&lt;br&gt;                        var sFileName = String(aFiles[iFile]);&lt;br&gt;                        var bIsDirectory = aFiles[iFile].isDirectory();&lt;br&gt;                        if (!bIsDirectory) {&lt;br&gt;                            aResultTree.push(sFileName.substr((&lt;br&gt;                                sTrimDirectory ?&lt;br&gt;                                sTrimDirectory :&lt;br&gt;                                sRootDirectory&lt;br&gt;                            ).length));&lt;br&gt;                        } else {&lt;br&gt;                            aResultTree = aResultTree.concat(&lt;br&gt;                                buildDirectoryTree(&lt;br&gt;                                    sFileName,&lt;br&gt;                                    sRootDirectory&lt;br&gt;                                )&lt;br&gt;                            );&lt;br&gt;                        }&lt;br&gt;                    }&lt;br&gt;                    return aResultTree;&lt;br&gt;                }&lt;br&gt;                // Build directory tree&lt;br&gt;                var aDirectoryTree = buildDirectoryTree('.');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> aDirectoryTree.length; c++) {&lt;br&gt;                    message('Found directory:', aDirectoryTree[c]);&lt;br&gt;                }&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code>  You can also use classes that are not a standard part of Java.  The following example shows how you can use SQLiteJDBC (http://www.zentus.com/sqlitejdbc/) to connect and work with a SQLite database: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                function SQLite() {&lt;br&gt;                    Packages.java.lang.Class.forName('org.sqlite.JDBC');&lt;br&gt;                    this.connection = null;&lt;br&gt;                    this.connect = function(sDBFileName) {&lt;br&gt;                        this.connection = new Packages.java.sql.DriverManager.getConnection(&lt;br&gt;                            'jdbc:sqlite:' + sDBFileName&lt;br&gt;                        );&lt;br&gt;                        this.statement = this.connection.createStatement();&lt;br&gt;                    };&lt;br&gt;                    this.close = function() {&lt;br&gt;                        if (!this.connection) return;&lt;br&gt;                        this.connection.close();&lt;br&gt;                        this.statement.close();&lt;br&gt;                        this.connection = null;&lt;br&gt;                        this.statement = null;&lt;br&gt;                    };&lt;br&gt;                    this.query = function(sQuery) {&lt;br&gt;                        if (!this.statement) return;&lt;br&gt;                        var aResultSet = [];&lt;br&gt;                        try {&lt;br&gt;                            var oResultSet = this.statement.executeQuery(sQuery);&lt;br&gt;                        } catch (e) {}&lt;br&gt;                        if (oResultSet) {&lt;br&gt;                            while (oResultSet.next()) {&lt;br&gt;                                var aRowData = {};&lt;br&gt;                                for (var c = 1; c <font color="#0000ff">&lt;</font> = oResultSet.columnCount; c++) {&lt;br&gt;                                    var sColumnName = oResultSet.getColumnName(c);&lt;br&gt;                                    aRowData[sColumnName] = oResultSet.getString(&lt;br&gt;                                        sColumnName&lt;br&gt;                                    );&lt;br&gt;                                }&lt;br&gt;                                aResultSet.push(aRowData);&lt;br&gt;                            }&lt;br&gt;                            oResultSet.close();&lt;br&gt;                        }&lt;br&gt;                        return aResultSet;&lt;br&gt;                    };&lt;br&gt;                };&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font>&lt;!-- let's do something interesting with our database now --&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message('SQLite example:\r\n');&lt;br&gt;                var oSQLite = new SQLite();&lt;br&gt;                oSQLite.connect('test.db');&lt;br&gt;                oSQLite.query('\&lt;br&gt;                    CREATE TABLE if not exists test_table (\&lt;br&gt;                        id INTEGER PRIMARY KEY AUTOINCREMENT,\&lt;br&gt;                        name TEXT\&lt;br&gt;                    );\&lt;br&gt;                ');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> 100; c++) {&lt;br&gt;                    oSQLite.query('INSERT INTO test_table (name) VALUES ("item_'+c+'")');&lt;br&gt;                }&lt;br&gt;                var aResult = oSQLite.query('SELECT * FROM test_table;');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> aResult.length; c++) {&lt;br&gt;                    startElement('row');&lt;br&gt;                    for (var sCellName in aResult[c]) {&lt;br&gt;                        startElement(sCellName);&lt;br&gt;                        characters(aResult[c][sCellName]);&lt;br&gt;                        endElement();&lt;br&gt;                    }&lt;br&gt;                    endElement();&lt;br&gt;                }&lt;br&gt;                oSQLite.query('DROP TABLE test_table');&lt;br&gt;                oSQLite.close();&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                function SQLite() {&lt;br&gt;                    Packages.java.lang.Class.forName('org.sqlite.JDBC');&lt;br&gt;                    this.connection = null;&lt;br&gt;                    this.connect = function(sDBFileName) {&lt;br&gt;                        this.connection = new Packages.java.sql.DriverManager.getConnection(&lt;br&gt;                            'jdbc:sqlite:' + sDBFileName&lt;br&gt;                        );&lt;br&gt;                        this.statement = this.connection.createStatement();&lt;br&gt;                    };&lt;br&gt;                    this.close = function() {&lt;br&gt;                        if (!this.connection) return;&lt;br&gt;                        this.connection.close();&lt;br&gt;                        this.statement.close();&lt;br&gt;                        this.connection = null;&lt;br&gt;                        this.statement = null;&lt;br&gt;                    };&lt;br&gt;                    this.query = function(sQuery) {&lt;br&gt;                        if (!this.statement) return;&lt;br&gt;                        var aResultSet = [];&lt;br&gt;                        try {&lt;br&gt;                            var oResultSet = this.statement.executeQuery(sQuery);&lt;br&gt;                        } catch (e) {}&lt;br&gt;                        if (oResultSet) {&lt;br&gt;                            while (oResultSet.next()) {&lt;br&gt;                                var aRowData = {};&lt;br&gt;                                for (var c = 1; c <font color="#0000ff">&lt;</font> = oResultSet.columnCount; c++) {&lt;br&gt;                                    var sColumnName = oResultSet.getColumnName(c);&lt;br&gt;                                    aRowData[sColumnName] = oResultSet.getString(&lt;br&gt;                                        sColumnName&lt;br&gt;                                    );&lt;br&gt;                                }&lt;br&gt;                                aResultSet.push(aRowData);&lt;br&gt;                            }&lt;br&gt;                            oResultSet.close();&lt;br&gt;                        }&lt;br&gt;                        return aResultSet;&lt;br&gt;                    };&lt;br&gt;                };&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font>&lt;!-- let's do something interesting with our database now --&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message('SQLite example:\r\n');&lt;br&gt;                var oSQLite = new SQLite();&lt;br&gt;                oSQLite.connect('test.db');&lt;br&gt;                oSQLite.query('\&lt;br&gt;                    CREATE TABLE if not exists test_table (\&lt;br&gt;                        id INTEGER PRIMARY KEY AUTOINCREMENT,\&lt;br&gt;                        name TEXT\&lt;br&gt;                    );\&lt;br&gt;                ');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> 100; c++) {&lt;br&gt;                    oSQLite.query('INSERT INTO test_table (name) VALUES ("item_'+c+'")');&lt;br&gt;                }&lt;br&gt;                var aResult = oSQLite.query('SELECT * FROM test_table;');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> aResult.length; c++) {&lt;br&gt;                    startElement('row');&lt;br&gt;                    for (var sCellName in aResult[c]) {&lt;br&gt;                        startElement(sCellName);&lt;br&gt;                        characters(aResult[c][sCellName]);&lt;br&gt;                        endElement();&lt;br&gt;                    }&lt;br&gt;                    endElement();&lt;br&gt;                }&lt;br&gt;                oSQLite.query('DROP TABLE test_table');&lt;br&gt;                oSQLite.close();&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="UTF-8"</font> ? <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="2.0"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> &lt;br&gt; <font color="#ff0000">xmlns:xsr</font> <font color="#0000ff">="java:/xsr.XSRElementFactory"</font> &lt;br&gt; <font color="#ff0000">extension-element-prefixes</font> <font color="#0000ff">="xsr"</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#ff0000">omit-xml-declaration</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="//*"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                function SQLite() {&lt;br&gt;                    Packages.java.lang.Class.forName('org.sqlite.JDBC');&lt;br&gt;                    this.connection = null;&lt;br&gt;                    this.connect = function(sDBFileName) {&lt;br&gt;                        this.connection = new Packages.java.sql.DriverManager.getConnection(&lt;br&gt;                            'jdbc:sqlite:' + sDBFileName&lt;br&gt;                        );&lt;br&gt;                        this.statement = this.connection.createStatement();&lt;br&gt;                    };&lt;br&gt;                    this.close = function() {&lt;br&gt;                        if (!this.connection) return;&lt;br&gt;                        this.connection.close();&lt;br&gt;                        this.statement.close();&lt;br&gt;                        this.connection = null;&lt;br&gt;                        this.statement = null;&lt;br&gt;                    };&lt;br&gt;                    this.query = function(sQuery) {&lt;br&gt;                        if (!this.statement) return;&lt;br&gt;                        var aResultSet = [];&lt;br&gt;                        try {&lt;br&gt;                            var oResultSet = this.statement.executeQuery(sQuery);&lt;br&gt;                        } catch (e) {}&lt;br&gt;                        if (oResultSet) {&lt;br&gt;                            while (oResultSet.next()) {&lt;br&gt;                                var aRowData = {};&lt;br&gt;                                for (var c = 1; c <font color="#0000ff">&lt;</font> = oResultSet.columnCount; c++) {&lt;br&gt;                                    var sColumnName = oResultSet.getColumnName(c);&lt;br&gt;                                    aRowData[sColumnName] = oResultSet.getString(&lt;br&gt;                                        sColumnName&lt;br&gt;                                    );&lt;br&gt;                                }&lt;br&gt;                                aResultSet.push(aRowData);&lt;br&gt;                            }&lt;br&gt;                            oResultSet.close();&lt;br&gt;                        }&lt;br&gt;                        return aResultSet;&lt;br&gt;                    };&lt;br&gt;                };&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt;&lt;br&gt; <font>&lt;!-- let's do something interesting with our database now --&gt;</font> &lt;br&gt;&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;&lt;!</font> [CDATA[&lt;br&gt;                message('SQLite example:\r\n');&lt;br&gt;                var oSQLite = new SQLite();&lt;br&gt;                oSQLite.connect('test.db');&lt;br&gt;                oSQLite.query('\&lt;br&gt;                    CREATE TABLE if not exists test_table (\&lt;br&gt;                        id INTEGER PRIMARY KEY AUTOINCREMENT,\&lt;br&gt;                        name TEXT\&lt;br&gt;                    );\&lt;br&gt;                ');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> 100; c++) {&lt;br&gt;                    oSQLite.query('INSERT INTO test_table (name) VALUES ("item_'+c+'")');&lt;br&gt;                }&lt;br&gt;                var aResult = oSQLite.query('SELECT * FROM test_table;');&lt;br&gt;                for (var c = 0; c <font color="#0000ff">&lt;</font> aResult.length; c++) {&lt;br&gt;                    startElement('row');&lt;br&gt;                    for (var sCellName in aResult[c]) {&lt;br&gt;                        startElement(sCellName);&lt;br&gt;                        characters(aResult[c][sCellName]);&lt;br&gt;                        endElement();&lt;br&gt;                    }&lt;br&gt;                    endElement();&lt;br&gt;                }&lt;br&gt;                oSQLite.query('DROP TABLE test_table');&lt;br&gt;                oSQLite.close();&lt;br&gt;            ]] <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">xsr:body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsr:script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <h4>  Conclusion </h4><br>  You may wonder why all this is necessary?  The answer is very simple, XSLT together with XML is a very powerful bundle that can perform very many tasks, adding JavaScript and the ability to easily run from the command line using Apache Ant, we get a powerful automation tool with an already built-in mechanism for generating the final result .  Given the fact that for JavaScript, tons of code are now written that perform various application tasks, this project (in any case, to me) no longer seems so crazy. <br>  A more realistic example: we need to write something so that we can tear off external resources using the HTTP protocol, do something with this text - and then drop the XML report into the database or to another server. <br><br>  This is my first topic on Habr√© and therefore, any constructive criticism is welcome.  I would also like to know from the community if you are interested in this topic and should I publish something like this in the near future? <br><br><h4>  Links </h4><ul><li>  Project home page: <a href="http://code.google.com/p/xsr/">http://code.google.com/p/xsr/</a> </li><li>  You can read about Mozilla Rhino JS Engine here: <a href="http://www.mozilla.org/rhino/">http://www.mozilla.org/rhino/</a> </li><li>  XSLT2 documentation can be found here: <a href="http://www.saxonica.com/documentation/index.html">http://www.saxonica.com/documentation/index.html</a> and here: <a href="http://www.zvon.org/xxl/XSL-Ref/Tutorials/index.html">http://www.zvon.org/xxl/XSL-Ref/Tutorials/index.html</a> </li><li>  Saxon - documentation related to the mechanism of the extensions is available here: <a href="http://www.saxonica.com/documentation/extensibility/intro.html">http://www.saxonica.com/documentation/extensibility/intro.html</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/82380/">https://habr.com/ru/post/82380/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../82371/index.html">IFPI lost the case against Baidu search engine</a></li>
<li><a href="../82372/index.html">Print: moving along the Z axis</a></li>
<li><a href="../82374/index.html">Lookalike.me - service for people like you or your friends</a></li>
<li><a href="../82375/index.html">Catalog of online stores in Belarus</a></li>
<li><a href="../82376/index.html">HTML5, Theora and everything all everything ... (practice)</a></li>
<li><a href="../82381/index.html">Render on a remote machine using the Dropbox & Mail bundle</a></li>
<li><a href="../82383/index.html">IR remote control</a></li>
<li><a href="../82384/index.html">MSI WIND U90 3G</a></li>
<li><a href="../82385/index.html">In the depths of yourself ...</a></li>
<li><a href="../82386/index.html">Bank sues cyber fraud victim</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>