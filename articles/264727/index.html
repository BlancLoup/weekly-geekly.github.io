<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 33: Doors Without Locks, Microsoft Invulnerability, Disassembler and Pain</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Welcome to the weekly digest of security events, season one, episode two. In the previous series, we learned about self-opening typewriters, a chronic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 33: Doors Without Locks, Microsoft Invulnerability, Disassembler and Pain</h1><div class="post__text post__text-html js-mediator-article">  Welcome to the weekly digest of security events, season one, episode two.  In the previous series, we <a href="http://habrahabr.ru/company/kaspersky/blog/264329/">learned</a> about self-opening typewriters, a chronic dread of the scene in Android, and how we will not be tracked on the net anymore (in fact, they will).  In this release, two seemingly completely unrelated news, which nevertheless have one thing in common: they are not that someone is vulnerable somewhere, but that vulnerability is sometimes caused by a reluctance to connect available security measures.  And the third is that it is not about security at all, but rather about particular cases of interrelations within the industry.  Interestingly, all three, if you delve, turn out to be not quite as they seem initially. <br><br>  I remind the rules: each week the editors of the news site <a href="https://threatpost.ru/">Threatpost</a> selects the three most significant news, to which I add an extended and merciless comment.  All episodes of the series can be found <a href="http://habrahabr.ru/search/%3Fq%3D%255Bklsw%255D%26target_type%3Dposts">here</a> . <br><a name="habracut"></a><br>  <b>Hacking hotel doors</b> <br>  <a href="https://threatpost.ru/2015/08/10/blekey-device-breaks-rfid-physical-access-controls/">News</a> <br><br><img src="https://habrastorage.org/files/f78/ed8/dd2/f78ed8dd23f546fa85875a1f2a71927c.jpg" align="right">  They say that there are humanists, and there are techies, and these two categories of people hardly understand each other.  And it‚Äôs impossible to turn from a humanist into a techie.  Such a stereotype at the time was refuted by John Wiegand, who initially chose a career as a musician.  In the 30s of the last century, he <a href="http://machinedesign.com/engineering-essentials/brushing-wiegand-man-effect-and-wire-changed-engineering">played the piano</a> and conducted a children's choir until he became interested in the device of sound amplifiers.  In the 1940s, he was working on a novelty of that time - magnetic sound recording - and in 1974 (at the age of, for a moment, 62 years), he made his main discovery. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In Wigand's wire, from the alloy of cobalt, iron and vanadium, placed in a magnetic field, the polarity of the core and the shell changes places, due to which a potential difference arises.  Moreover, the polarity does not change until the next magnetization, which made it possible to use the effect to, say, create hotel keys.  Unlike modern cards, units and zeroes are recorded not in a microchip, but directly by a sequence of wires laid in a special way.  It is impossible to reprogram such a key, and in general according to the scheme, it is more like not modern modern metro and credit cards, but cards with magnetic stripes - only more reliable ones. <br><br>  That is, breaking contactless cards?  <i>Not really</i> .  The name of Wigand is named not only the effect, but also the <a href="https://en.wikipedia.org/wiki/Wiegand_interface">protocol</a> , rather ancient, by which data is exchanged.  With the protocol, everything is bad enough.  Firstly, it was not really standardized, and there are many different implementations.  Secondly, initially the ID of the card could be recorded with a maximum of 16 bits, which gives very few possible combinations.  Thirdly, the feature of those most contactless cards with wire, invented even before they learned to place an entire computer on a credit card, limits the key length to 37 bits - the reading reliability drops further. <br><br>  So, at the Black Hat conference last week, researchers Eric Evenchik and Mark Baseggio showed their device to intercept (unencrypted) key sequences during authorization.  What is most interesting, the cards have nothing to do with it - the data is stolen during transmission from the card reader to the controller: there, historically, the very same Wigand protocol is used. <br><br>  They called the device BLEKey - it is such a small board that can be plugged directly into the reader‚Äôs body, say, at the hotel door, and it was shown that the whole process takes a few seconds.  Then everything is simple: read the key, wait until the real owner leaves, open the door.  Or do not wait.  Or do not open.  Without going into technical subtleties, the dialogue between the door and the reader / wireless key looks like this: <br><br>  <i>- Who's there?</i> <i><br></i>  <i>- It's me.</i> <i><br></i>  <i>- And it's you.</i>  <i>Come on in.</i> <i><br></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/48a/c96/8fb/48ac968fbc754d4498b03c05225919a6.jpg"></div><br>  <i>Satisfied <a href="https://twitter.com/ericevenchick/status/629324182459940864">researcher</a> on the background of the vulnerable door model.</i> <br><br>  It seems that everything is clear, but there is a nuance.  Well, as usual, not all access control systems are subject to such an attack.  And even those that are exposed can be protected without replacing it in its entirety.  According to the researchers, the readers have the means to protect against such hacks, they are usually, ahem, turned off.  Some even support the <a href="http://www.siaonline.org/Pages/Standards/OSDP.aspx">Open Supervised Device Protocol</a> , which allows you to encrypt the transmitted key sequence.  These "features" are not used, because, I do not get tired of repeating it, do not think about security cheap and easy. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/008/5e0/5d2/0085e05d21c14d6a8966db9c66fdf811.jpg"></div><br><br>  Here is another interesting <a href="https://www.defcon.org/images/defcon-17/dc-17-presentations/defcon-17-mike_davis_who_invented_the_proximity_card.pdf">study</a> on the topic of 2009, with technical details.  Apparently, the vulnerability of the cards (not the readers) was indicated as far back as 1992, but then it was suggested that the card itself be either disassembled or skipped through x-rays.  For this, it must, for example, be taken away from the owner.  And now everything is decided by a handkerchief the size of a coin.  However, progress! <br><br>  <b>Invulnerability in Microsoft.</b>  <b>The subtleties of Windows Server Update Services in companies.</b> <br>  <a href="https://threatpost.ru/2015/08/06/pri-pomoshhi-windows-update-mozhno-vzlamyvat-kompyutery/">News</a>  The original <a href="https://www.blackhat.com/docs/us-15/materials/us-15-Stone-WSUSpect-Compromising-Windows-Enterprise-Via-Windows-Update-wp.pdf">whitepaper</a> researchers. <br><br>  Windows Server Update Services allows large companies to centrally install updates on a fleet of computers, using an internal server instead of an external one for distribution.  And it is a very reliable and fairly secure system.  First, all updates must be signed by Microsoft.  Secondly, communication between the corporate update server and the vendor server is encrypted using the SSL protocol. <br><br>  And this is a fairly simple system.  The list of updates is received by the server of the company in the form of a file in XML format, where it is actually stated what to download and how to update.  And this is the initial interaction, as it turned out, is made in clear text.  More precisely not so.  It must be encrypted (the "must" keyword), and when deploying WSUS, the administrator is strongly recommended to enable encryption.  But by default it is off. <br><br>  It‚Äôs not that horror-horror: it‚Äôs not easy to replace the ‚Äúinstructions‚Äù, but if the attacker already has the ability to intercept traffic (man-in-the-middle has already taken place), then it is possible.  Researchers Paul Stone and Alex Chapman found out that the substitution of instructions allows you to run arbitrary code with high privileges on an updated system.  No, checking for a Microsoft digital certificate is still performed, but any company certificate is accepted.  For example, you can drag the PsExec utility from the SysInternals suite in such a way, and with its help, run anything. <br><br>  Why does this happen at all?  The fact is that enabling SSL cannot be automated when deploying WSUS ‚Äî you need to generate a certificate.  And, as the researchers note, Microsoft in this case and can not do anything, but to strongly recommend the inclusion of SSL.  That is, it turns out that the vulnerability seems to be there, but as if there is none.  And nothing can be done.  Yes, and no one except the admin is to blame. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4f7/b24/376/4f7b24376fed4917b867a8ba90ea2edc.jpg"></div><br>  <i><a href="https://twitter.com/markrussinovich/status/631505582139117569">Picture</a> on request.</i> <br><br>  By the way, the cyber spyware found by ‚ÄúLab‚Äù Flame also <a href="https://securelist.com/blog/incidents/33002/flame-replication-via-windows-update-mitm-proxy-server-18/">used the</a> Windows update system to infect, though in a different way: with the help of a fake proxy, they intercepted requests to the Microsoft server and some of the files, some of which were even signed by vendor certificates, were sent in response. <br><br>  <b>Reverse engineering and pain</b> <br>  <a href="https://threatpost.ru/2015/08/12/oracle-cso-you-must-not-reverse-engineer-our-code/114220/">News</a>  Original CSO Oracle Post (Google <a href="https://blogs.oracle.com/maryanndavidson/entry/no_you_really_can_t%2B%26cd%3D1%26hl%3Den%26ct%3Dclnk%26gl%3Dus">cache</a> , <a href="http://seclists.org/isn/2015/Aug/4">another</a> copy). <br><br>  Above, two presentations at the Black Hat conference are quoted, and they are united by the fact that the authors of these studies - security experts - have discovered some kind of vulnerability in a technology or product that someone else is developing.  And they made public, and in the case of BLEKey, they also put all the code and hardware in open access.  In general, this is the standard interaction of the security industry with the outside world, but not everyone likes this situation.  Fundamentally, I will refrain from assessing here, I will just say that this is a very delicate topic.  Is it possible to analyze someone else's code and under what conditions?  How to disclose information about vulnerabilities so as not to harm?  Can I pay for the holes found?  Legislative restrictions, the criminal code, the unwritten rules of the industry - all this affects. <br><br>  The effect of an elephant in a china shop was made by the recent post of Chief Security Officer at Oracle by Mary Ann Davidson.  Captioned (inaccurate translation from English) " <i>In fact, no</i> , you can not", it is almost entirely addressed to the company's customers (and not to the industry as a whole), which send information about vulnerabilities found in the vendor's products.  Quote post, published in the blog of Oracle on August 10, can paragraphs, but the main thing: if the client could not get information about the vulnerability other than using reverse engineering, the client violates the license agreement, but this is not good. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/246/b61/613/246b616130da4772b6b4356f4e365c77.png"></div><br><br>  Quote: <br>  <i>The client can not analyze the entire code and make sure that there is an algorithm that blocks a potential attack, which some scanner reports to it ... The client cannot create a patch to solve the problem - only the vendor can.</i>  <i>The client absolutely violates the license agreement using a static analysis utility.</i> <br><br>  The reaction of the public looked like <a href="https://twitter.com/nicboul/status/631183093580341248">this</a> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/704/ee5/bb0/704ee5bb070f402cb055f5f1b8aacee1.png"></div><br><br>  Or <a href="https://twitter.com/briankrebs/status/631257607530020864">so</a> : <br><div style="text-align:center;"><img src="https://habrastorage.org/files/7a8/60b/566/7a860b5664b544e58233a973ced975ef.png"></div><br><br>  Or even <a href="https://twitter.com/headhntr/status/631081198534664192">like this</a> : <br><div style="text-align:center;"><img src="https://habrastorage.org/files/df4/4b7/4cc/df44b74ccdbc4e808b4d33d0f4d26381.png"></div><br><br>  In short, the post hung for no more than a day, it was deleted due to ‚Äúinconsistencies with [official] views on customer interaction‚Äù (but the Internet remembers everything).  Let me remind you that Oracle is developing Java, the vulnerability in which does not exploit only lazy.  Three years ago, we <a href="https://securelist.ru/analysis/obzor/20794/otchet-laboratorii-kasperskogo-java-pod-udarom-evolyuciya-eksplojtov-v-2012-2013-gg/">calculated the</a> number of vulnerabilities in Java for 12 months and found 160 (!) Pieces.  Perhaps, in an ideal world, only a software developer really needs to look for and close vulnerabilities in software.  In the real world, is it sometimes impossible that the people responsible for this work according to the ‚Äúbees versus honey‚Äù scheme? <br><br>  But look from the other side.  Last week, the founder of the very Black Hat, Jeff Moss, <a href="https://threatpost.ru/2015/08/06/software-liability-is-inevitable/">spoke</a> about the responsibility of software developers for holes in it.  They say it's time to delete all these lines from the EULA about the fact that the company is not obliged to customers.  The statement is interesting, but no less pretentious than ‚Äúlet's ban the disassembler‚Äù.  So far it is clear only that users (corporate and simple), vendors and researchers, if they can come to an agreement with each other, then clearly not with the help of loud statements and jokes on Twitter. <br><br>  <b>What else happened:</b> <br>  Another <a href="https://threatpost.ru/2015/08/11/researchers-unveil-square-reader-mobile-pos-hacks/">presentation</a> from Black Hat about hacking the Square Reader plastic card reader - well, the thing that connects to the smartphone, and through it you pay the courier for sushi delivery.  Requires a soldering iron. <br><br>  Lenovo's laptops (not all, but some) again found the <a href="https://threatpost.com/lenovo-hit-with-criticism-over-second-rootkit-like-utility/114261">rootkit</a> from the vendor.  Previous <a href="https://threatpost.ru/2015/02/19/v-novye-noutbuki-lenovo-vnedren-somnitelnyj-soft/">story</a> . <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right">  <b>Antiquities:</b> <br>  Family "Small" <br><br>  Resident viruses are usually written to the end of COM files (except for ‚ÄúSmall-114, -118, -122‚Äù, these are at the beginning) when loading files into memory.  Most of the viruses in the family use the POPA and PUSHA 80x86 processors.  "Small-132, -149" incorrectly infect some files.  Belong to various authors.  Apparently, the emergence of the Small family can be viewed as a contest for the shortest resident virus for MS-DOS.  It remains only to decide on the size of the prize fund. <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 45.</i> <br><br>  <i>Disclaimer: This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/264727/">https://habr.com/ru/post/264727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264713/index.html">Microsoft released a set of updates for its products, August 2015</a></li>
<li><a href="../264717/index.html">Can I rely on data retrieved by the WMI classes?</a></li>
<li><a href="../264719/index.html">jQuery Video Extend - extending the capabilities of HTML5 video player</a></li>
<li><a href="../264723/index.html">Cryptocurrency developers - who are they? [Interview]</a></li>
<li><a href="../264725/index.html">ReactPHP speeds up PHPixie 8 times</a></li>
<li><a href="../264731/index.html">Systemd logging control</a></li>
<li><a href="../264735/index.html">Five signs that you should hire this programmer right now</a></li>
<li><a href="../264737/index.html">Talking to FPConf speakers (part 2)</a></li>
<li><a href="../264739/index.html">Who is better or Walsh vs. Fourier</a></li>
<li><a href="../264741/index.html">How to become a cool designer for 365 days</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>