<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VexorCI: how we prepare configuration files</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 When VexorCI started, we decided that it was not necessary to write a configuration file to start using. We ourselves are trying to guess wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VexorCI: how we prepare configuration files</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br><br>  When <a href="https://vexor.io/">VexorCI</a> started, we decided that it was not necessary to write a configuration file to start using.  We ourselves are trying to guess what exactly is needed to run the tests and constantly teach the service to recognize the new settings.  But the development world is very diverse, so some projects need configs. <br>  Over the past couple of months, 100 projects have joined the Vexor.  Very different projects with unique settings.  During this time, we learned a lot about how to prepare configuration files so that it is convenient for our users.  In the process, we have revised our initial approach and want to share with you the innovations. <br><a name="habracut"></a><br><h3>  We have remade the generation of scripts to run. </h3><br>  In order to understand what tasks need to be performed to prepare the environment and run tests in VexorCI, use the configuration file vexor.yml.  This file is located in the root of the repository, or is generated automatically.  It specifies the commands that will be executed to prepare the test environment and run the tests. <br><br>  Earlier, in order to convert vexor.yml directly into commands that the worker performs when running tests, we: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  Received a build config; </li><li>  Parsed it; </li><li>  Generated a large bash script; </li><li>  Sent the script to the worker. </li></ol><br>  With this scheme, there were a lot of problems: <br><br><ul><li>  Nontrivial things were very difficult to do, for example, patching the config / secrets.yml in a Rails application. </li><li>  Bash is not the most successful language for writing large amounts of code, there were a lot of hard-to-find bugs. </li><li>  Incomprehensible to the user error messages. </li></ul><br>  We decided to remake it.  Now we: <br><br><ol><li>  Get the build configuration in yaml format; </li><li>  We convert the intermediate representation into a file, also in the yaml format.  The file structure itself is made by analogy with the ansible (example <a href="https://gist.github.com/dima-exe/7febc69f62bb0ccc6abe">here</a> ). </li><li>  This file is sent to the worker for execution. </li></ol><br>  The refusal to generate a giant shell script allowed us to more flexibly manage the deployment of the environment, show our users understandable error messages and forget about difficult to fix bugs in the shell. <br><br><h3>  We slightly changed the key assignment in the configuration file. </h3><br>  To start using VexorCI, it is not necessary to write a config.  We ourselves are trying to guess what exactly is needed to run the tests.  Unfortunately, in the old version there were situations when the tasks generated by default clashed with the tasks specified by the user in the configuration file. <br><br>  In order to further avoid such conflicts, all settings related to databases that were previously in the 'before_script' key should now be in a separate key - 'database'. <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  before_script: - rake db:create - rake db:migrate #  database: - rake db:create - rake db:migrate</span></span></code> </pre> <br><br>  Using a separate key for the database makes the configuration easier and clearer. <br><br><h3>  We added support for <a href="http://ccmenu.org/">CCMenu</a> . </h3><br>  CCMenu is a popular application that displays build statuses in the toolbar and allows you to be always aware of what is happening on the CI server.  Now projects from VexorCI can be easily added to CCMenu. <br><br>  Go to the project's ‚ÄúSettings‚Äù page and copy the ‚ÄúCCMenu URL.‚Äù <br><br><img src="https://habrastorage.org/files/1fb/04c/b98/1fb04cb98f3a4a979ef6877d18738972.png"><br><br>  Insert url in the feed url field <br><br><img src="https://habrastorage.org/files/cf9/8c2/4cd/cf98c24cd6044ff8af77423824a613dc.png"><br><br>  Works! <br><br><img src="https://habrastorage.org/files/9d4/87f/571/9d487f5718344b2a9f34231994e94afb.png"><br><br>  Now it is even more convenient to track build statuses. <br><br>  <b>By the way, we have another great news: 100 minutes of tests every month became free.</b>  <b><a href="https://vexor.io/">Join now!</a></b> </div><p>Source: <a href="https://habr.com/ru/post/244829/">https://habr.com/ru/post/244829/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../244815/index.html">Optimizing web page performance: CSS</a></li>
<li><a href="../244817/index.html">21 million measurements showed who has the fastest internet access in Moscow</a></li>
<li><a href="../244821/index.html">Effective JSON with functional concepts and generics in Swift</a></li>
<li><a href="../244823/index.html">New monitoring point in Australia</a></li>
<li><a href="../244825/index.html">How Composer is 70% sped up</a></li>
<li><a href="../244831/index.html">Stream theory: how to create a game that everyone will love</a></li>
<li><a href="../244833/index.html">USB Monitor Adapter or how I was looking for the meaning of life</a></li>
<li><a href="../244835/index.html">Unit tests on C - nothing is easier</a></li>
<li><a href="../244839/index.html">The romantic merging of JSON files in Git</a></li>
<li><a href="../244841/index.html">Firewood, electricity and sms - we maintain the temperature in the summer house cheaply</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>