<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The experience of automating uneasy correspondence (Completion. Sampling and Export)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In conclusion of the description of my experience in improving the process of managing correspondence, it remains for me to tell only about the sample...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The experience of automating uneasy correspondence (Completion. Sampling and Export)</h1><div class="post__text post__text-html js-mediator-article">  In conclusion of the description of my experience in improving the process of managing correspondence, it remains for me to tell only about the samples that all participants in the process deal with.  Visual presentation of information is one of the most important components of a successful launch, agree! <br><img src="https://habrastorage.org/files/a67/c95/693/a67c956932a44fca84d16a0fb1c0dd11.jpg"><br>  Let me remind you that in previous articles the behavior of <a href="https://habrahabr.ru/company/easla/blog/281839/">incoming</a> and <a href="https://habrahabr.ru/company/easla/blog/281999/">outgoing</a> letters was described.  The climax under the cut: a lot of text, code and a little animation. <br><a name="habracut"></a><br>  I had to divide all the requirements of the participants of the process for the presentation of information into two unequal groups: <br><ul><li>  Records Management Requirements </li><li>  Requirements of all other employees. </li></ul><br>  It turned out that the requirements of a clerk were somewhat different from the requirements of all the others.  It can be said that the members of each group look at the process from different angles. <br>  If it is important for a case management specialist how the document entered the organization or, on the contrary, how it should be sent to the addressee, then the rest is completely uninteresting. <br>  Based on this, it became clear that although users should see similar registries of incoming and outgoing emails, the list of attributes displayed in registries will be different. <br>  Initially, it seemed to me that it would be necessary to create for each group a separate set of types (this is <a href="http://easla.com/">how</a> sampling is called <a href="http://easla.com/">easla.com</a> ) and to ‚Äúarrange‚Äù access to them using rights, but after understanding, it became clear that in most cases you can do with a few lines of code the form itself. <br>  Yes, yes, in <a href="http://easla.com/">easla.com</a> , all types are described by code, which allows for extraordinary flexibility.  For example, it does not cost anything to build a code so that an individual user or group displays objects that correspond to an important criterion for them.  Or, for example, add a category to the view, each of which has a separate filter. <br>  All types are configured using the parameters passed to the exec () function.  Of course, parameters can be generated programmatically in code. <br>  By the way, in <a href="http://easla.com/">easla.com</a> there is a so-called "Quick Master", which allows you to create kinds of "naklikivaniyami."  It helps when creating a new look and is convenient for beginners. <br>  So, I will describe all types, focusing on the features of each. <br><br><h4>  Incoming documents </h4><br>  The first of the two most important registries of documents in the process.  Reflects the complete list of all incoming documents in descending order of date.  Thus, in the beginning of the list there are always the newest incoming letters. <br><pre><code class="php hljs">$attributes = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_receive_regnum'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'object'</span></span>, <span class="hljs-string"><span class="hljs-string">'actions'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(), <span class="hljs-string"><span class="hljs-string">'header'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'.  '</span></span>), ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cuser()-&gt;inGroup(<span class="hljs-string"><span class="hljs-string">'group_dp'</span></span>) == <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) $attributes += <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'crs_management_incoming_content'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>)); $attributes += <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_receive_date'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contragent_regnum'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'header'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'.  '</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contragent'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contact'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_subj'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_outgoing'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contract'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>,<span class="hljs-string"><span class="hljs-string">'max'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_document'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_forwardto'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'status'</span></span> ); cviewpub()-&gt;exec(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'object'</span></span>=&gt;objectdef(<span class="hljs-string"><span class="hljs-string">'crs_management'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming'</span></span>), <span class="hljs-string"><span class="hljs-string">'attributes'</span></span>=&gt;$attributes, <span class="hljs-string"><span class="hljs-string">'conditions'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'permission'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'2'</span></span>, ), <span class="hljs-string"><span class="hljs-string">'sort'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_receive_date'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'default'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'desc'</span></span>, <span class="hljs-string"><span class="hljs-string">'enable'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contragent'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'enable'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) ), <span class="hljs-string"><span class="hljs-string">'sorting'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'pagination'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'pagesize'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">10</span></span>), <span class="hljs-string"><span class="hljs-string">'showcreate'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ));</code> </pre> <br>  In this form, I had to create a list of attributes in the $ attributes variable only because of the requirement of the clerk.  Only she needs to see the content type of each incoming letter. <br>  The first column of the view is configured to display the context menu of the object next to the value of the crs_management_incoming_receive_regnum attribute.  It contains not only standard actions, but also actions announced by the administrator. <br><img src="https://habrastorage.org/files/01f/a19/39c/01fa1939c94d465d9301b36161436493.gif"><br>  In addition, an interesting nuance surfaced with the crs_management_incoming_contract attribute.  It is plural and stores references to the contracts to which the incoming document belongs.  In most cases, the attribute had one, maximum two values ‚Äã‚Äãand there were no problems with it.  However, one of the customers was awarded a large contract with more than twenty extra.  agreements.  He began to send us letters, referring then to one additional.  agreement, then a few, then almost everything.  The case management specialist had no choice but to diligently indicate all the extras.  agreements referenced by the author of the incoming letter.  As a result, the number of attribute values ‚Äã‚Äãbecame indecently large, and easla.com diligently displayed them all, stretching the cell to almost the entire screen.  In general, everything was decided simply, the max option allows you to limit the number of displayed values ‚Äã‚Äãby hiding them in ellipsis. <br><img src="https://habrastorage.org/files/3ad/319/3d1/3ad3193d1e7c47e9ad525c5c40e583dd.png"><br>  The status of the incoming document is colored by the object itself (see in <a href="https://habrahabr.ru/company/easla/blog/281839/">another part</a> ), the view in this plan is not necessary to customize.  Ultimately, it looks like this: <br><img src="https://habrastorage.org/files/e50/dd1/e15/e50dd1e15c2b4f5681a9140569bfb95f.png"><br><br><a name="publicview1"></a><h4>  Outgoing documents </h4><br>  The second of the most important registries of documents.  And this is the only form in my practice that I have divided into two, delimiting access by roles.  In other words, he created two types with the same name, but one is intended for a clerk and the other for all others. <br>  By the way, the matrix of accessibility of species by roles looks like this: <br><img src="https://habrastorage.org/files/761/2dd/221/7612dd221d984e369b2ea7a880941bdb.png"><br>  Of course, if you try, you could delineate everything with code, but I made that decision.  At that moment it seemed to me the most true. <br>  I will give the code of only one type, which is intended for all: <br><pre> <code class="php hljs">cviewpub()-&gt;categories = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">' '</span></span>); cviewpub()-&gt;category = is_null(cviewpub()-&gt;category) ? <span class="hljs-number"><span class="hljs-number">0</span></span> : cviewpub()-&gt;category; $attributes = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_regnum'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'object'</span></span>, <span class="hljs-string"><span class="hljs-string">'actions'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(), <span class="hljs-string"><span class="hljs-string">'export'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_regnum'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_sentdate'</span></span> ) ), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_sentdate'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_performers'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contragent'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contact'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_subj'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_incomingdocs'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>, <span class="hljs-string"><span class="hljs-string">'export'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contragent_regnum'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contragent_date'</span></span> ) ), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contract'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>,<span class="hljs-string"><span class="hljs-string">'max'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_content'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), ); $conditions = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(cviewpub()-&gt;category) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: $attributes[] = <span class="hljs-string"><span class="hljs-string">'status'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: $conditions += <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'status'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_create'</span></span>,<span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_created'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } cviewpub()-&gt;exec(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'object'</span></span>=&gt;objectdef(<span class="hljs-string"><span class="hljs-string">'crs_management'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing'</span></span>), <span class="hljs-string"><span class="hljs-string">'attributes'</span></span>=&gt;$attributes, <span class="hljs-string"><span class="hljs-string">'conditions'</span></span>=&gt;$conditions, <span class="hljs-string"><span class="hljs-string">'sort'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_regdate'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'default'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'desc'</span></span>, <span class="hljs-string"><span class="hljs-string">'enable'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contragent'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'enable'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) ), <span class="hljs-string"><span class="hljs-string">'sorting'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'pagination'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'pagesize'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">10</span></span>), <span class="hljs-string"><span class="hljs-string">'showcreate'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ));</code> </pre><br>  In this form, I used several extremely useful features for us <a href="http://easla.com/">easla.com</a> . <br>  First of all, I will pay attention to the category.  With their help, <a href="http://easla.com/">easla.com</a> allows <a href="http://easla.com/">you</a> to display a view from different angles, or more simply, several views in one.  Although you can filter by status directly in the form, some active users are very strongly asked to create for them a separate view with unsent outgoing letters, to which I suggested to allocate them into a separate category.  On this and agreed.  A couple of lines of code: <br><pre> <code class="php hljs">cviewpub()-&gt;categories = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">' '</span></span>); cviewpub()-&gt;category = is_null(cviewpub()-&gt;category) ? <span class="hljs-number"><span class="hljs-number">0</span></span> : cviewpub()-&gt;category;</code> </pre><br>  They create two categories and choose the first, unless otherwise indicated.  The active value of the category is used in switch and forms the condition for selecting the $ conditions objects.  It turned out easy and convenient. <br><img src="https://habrastorage.org/files/9b9/dfe/2a8/9b9dfe2a896c4e32990a236dba6bfac6.gif"><br>  In addition, it is interesting to dwell on the export option that was used in the columns crs_management_outgoing_regnum and crs_management_outgoing_incomingdocs.  This option allows for exporting data (about export below), instead of, say, one attribute value crs_management_outgoing_regnum, to unload attribute values: <br><ul><li>  id </li><li>  crs_management_outgoing_regnum (aka) </li><li>  crs_management_outgoing_sentdate. </li></ul><br>  In our case, this feature has been very useful in preparing reports that needed to be generated based on the exported data. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Outgoing and incoming for the counterparty </h4><br>  In <a href="http://easla.com/">easla.com</a> there is a unique opportunity to create views not in the <u>context of a process</u> , but in the <u>context of an object</u> .  Such views are not displayed in the main menu, but are displayed in the tabs of the object that will use them.  The smart system will find the connections between the active object and the sample objects! <br>  I needed to display two tabs (views) in the form of the counterpart: <u>Outgoing for the counterparty</u> and <u>Inbox from the counterparty</u> .  They allowed to visualize the entire correspondence with the selected counterparty.  A very useful feature for the main project engineer.  Again, you can make similar samples in the above described types, but it is more convenient. <br>  In the ‚ÄúCounterparty‚Äù object I needed to add the following lines: <br><pre> <code class="php hljs">$objectTabs = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'crm_management_contact'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (corganization()-&gt;hasViewpub(<span class="hljs-string"><span class="hljs-string">'crs_management_all_incoming_by_contragent'</span></span>)) $objectTabs[] = <span class="hljs-string"><span class="hljs-string">'crs_management_all_incoming_by_contragent'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (corganization()-&gt;hasViewpub(<span class="hljs-string"><span class="hljs-string">'crs_management_all_outgoing_by_contragent'</span></span>)) $objectTabs[] = <span class="hljs-string"><span class="hljs-string">'crs_management_all_outgoing_by_contragent'</span></span>; cobjectref()-&gt;objectTabs = $objectTabs;</code> </pre><br>  The objectTabs property must contain codes or names of the species whose bookmarks should appear on the object.  The species code for the object is the following: <br><div class="spoiler">  <b class="spoiler_title">Outgoing for counterparty</b> <div class="spoiler_text"><pre> <code class="php hljs">$attributes = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_regnum'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'object'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_regdate'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contact'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_subj'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_incomingdocs'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contract'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>,<span class="hljs-string"><span class="hljs-string">'max'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_document'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'status'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'actions'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>()) ); cviewpub()-&gt;exec(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'object'</span></span>=&gt;objectdef(<span class="hljs-string"><span class="hljs-string">'crs_management'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing'</span></span>), <span class="hljs-string"><span class="hljs-string">'attributes'</span></span>=&gt;$attributes, <span class="hljs-string"><span class="hljs-string">'sort'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_regdate'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'default'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'desc'</span></span>, <span class="hljs-string"><span class="hljs-string">'enable'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) ), <span class="hljs-string"><span class="hljs-string">'pagination'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'pagesize'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">10</span></span>), ));</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Incoming from the counterparty</b> <div class="spoiler_text"><pre> <code class="php hljs">cviewpub()-&gt;exec(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'object'</span></span>=&gt;objectdef(<span class="hljs-string"><span class="hljs-string">'crs_management'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming'</span></span>), <span class="hljs-string"><span class="hljs-string">'attributes'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_receive_regnum'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'object'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_receive_date'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contragent_regnum'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contact'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_subj'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_content'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contract'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>,<span class="hljs-string"><span class="hljs-string">'max'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_document'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'status'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'actions'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>()) ), <span class="hljs-string"><span class="hljs-string">'conditions'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'permission'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'2'</span></span>, ), <span class="hljs-string"><span class="hljs-string">'sort'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_receive_date'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'default'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'desc'</span></span>, <span class="hljs-string"><span class="hljs-string">'enable'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) ), <span class="hljs-string"><span class="hljs-string">'sorting'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'pagination'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'pagesize'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">10</span></span>), ));</code> </pre><br></div></div><br>  As a result, the form of the counterparty began to look like this: <br><img src="https://habrastorage.org/files/857/8fd/1f8/8578fd1f82264459bfa265083725d764.gif"><br>  I remember that in elma I did not manage to achieve such a result. <br><br><h4>  My inbox </h4><br>  An auxiliary view that displays a list of all incoming documents addressed to the active user.  Especially convenient to the chief engineer and the GUIs. <br><pre> <code class="php hljs">cviewpub()-&gt;categories = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-string"><span class="hljs-string">' '</span></span>,<span class="hljs-string"><span class="hljs-string">' '</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>); cviewpub()-&gt;category = is_null(cviewpub()-&gt;category) ? <span class="hljs-number"><span class="hljs-number">0</span></span> : cviewpub()-&gt;category; $attributes = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_receive_regnum'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'object'</span></span>, <span class="hljs-string"><span class="hljs-string">'actions'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>()), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_receive_date'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contragent'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contact'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_subj'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_contract'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>,<span class="hljs-string"><span class="hljs-string">'max'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_document'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), ); $conditions = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'crs_management_incoming_forwardto'</span></span>=&gt;cuser()-&gt;id, <span class="hljs-string"><span class="hljs-string">'permission'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'2'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(cviewpub()-&gt;category) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: $attributes[] = <span class="hljs-string"><span class="hljs-string">'status'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: $conditions += <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'status'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'crs_management_incoming_create'</span></span>,<span class="hljs-string"><span class="hljs-string">'crs_management_incoming_created'</span></span>,<span class="hljs-string"><span class="hljs-string">'crs_management_incoming_handed'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: $conditions += <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'status'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'crs_management_incoming_exec'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: $conditions += <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'status'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'crs_management_incoming_ok'</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } cviewpub()-&gt;exec(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'object'</span></span>=&gt;objectdef(<span class="hljs-string"><span class="hljs-string">'crs_management'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_incoming'</span></span>), <span class="hljs-string"><span class="hljs-string">'attributes'</span></span>=&gt;$attributes, <span class="hljs-string"><span class="hljs-string">'conditions'</span></span>=&gt;$conditions, <span class="hljs-string"><span class="hljs-string">'sort'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_incoming_receive_date'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'default'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'desc'</span></span>, <span class="hljs-string"><span class="hljs-string">'enable'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) ), <span class="hljs-string"><span class="hljs-string">'sorting'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'pagination'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'pagesize'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">10</span></span>), <span class="hljs-string"><span class="hljs-string">'showcreate'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ));</code> </pre><br>  As can be seen from the source code, in the form there are also several categories for quick filtering of letters.  Otherwise, it is not remarkable. <br><img src="https://habrastorage.org/files/0d2/755/6e7/0d27556e7c5f4e6ca4c7afbda622735d.png"><br><br><h4>  My outgoing </h4><br>  An auxiliary view that displays a complete list of letters in the development of which an active user participated. <br><pre> <code class="php hljs">$attributes = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_regnum'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'object'</span></span>, <span class="hljs-string"><span class="hljs-string">'actions'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>()), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_regdate'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_performers'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contragent'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contact'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_subj'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_incomingdocs'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contract'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>,<span class="hljs-string"><span class="hljs-string">'max'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">3</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_document'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'link'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'value'</span></span>), <span class="hljs-string"><span class="hljs-string">'status'</span></span> ); $conditions = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_performers'</span></span>=&gt;cuser()-&gt;id); cviewpub()-&gt;exec(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'object'</span></span>=&gt;objectdef(<span class="hljs-string"><span class="hljs-string">'crs_management'</span></span>, <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing'</span></span>), <span class="hljs-string"><span class="hljs-string">'attributes'</span></span>=&gt;$attributes, <span class="hljs-string"><span class="hljs-string">'conditions'</span></span>=&gt;$conditions, <span class="hljs-string"><span class="hljs-string">'sort'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_regdate'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'default'</span></span>=&gt;<span class="hljs-string"><span class="hljs-string">'desc'</span></span>, <span class="hljs-string"><span class="hljs-string">'enable'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>), <span class="hljs-string"><span class="hljs-string">'crs_management_outgoing_contragent'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'enable'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) ), <span class="hljs-string"><span class="hljs-string">'sorting'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">'pagination'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'pagesize'</span></span>=&gt;<span class="hljs-number"><span class="hljs-number">10</span></span>), <span class="hljs-string"><span class="hljs-string">'showcreate'</span></span>=&gt;<span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ));</code> </pre><br>  Many users start searching for their letters from it. <br><br><h4>  Export </h4><br>  In <a href="http://easla.com/">easla.com</a> , the export is implemented in <a href="https://msdn.microsoft.com/en-us/library/aa338205(v%3Doffice.12).aspx">Microsoft Excel</a> (xlsx) and <a href="https://technet.microsoft.com/ru-ru/magazine/2006.01.blogtales(en-us).aspx">Microsoft Excel XML</a> (xml) <a href="https://technet.microsoft.com/ru-ru/magazine/2006.01.blogtales(en-us).aspx">format</a> , which allows you to upload document registries and process them in the desired form. <br><img src="https://habrastorage.org/files/d75/76e/034/d7576e0340174111a77120e553062244.gif"><br>  When exporting, the attribute values ‚Äã‚Äãspecified in the view settings are unloaded.  In other words, the view is unloaded just as it is displayed. <br>  But, we needed to unload a view that contained all incoming and outgoing reciprocal for transmission to the customer, a kind of register confirming the fact of response to each letter by both parties, and in it it was necessary to unload the letter designation, date of dispatch and turn it into a hyperlink.  Add the appropriate attributes to the view, moveton.  The user only needs a description of the object, why would he need two extra attributes.  You can create a separate view with the necessary attributes, but it will be visible in the main menu all the time, and it will only be accessed occasionally.  Again ugly. <br>  It turned out that you can specify the export parameter in the column parameters (see the <a href="https://habr.com/ru/company/easla/blog/282347/">example above</a> ), and specify the list of attributes that should be unloaded during the export instead of the displayed attribute.  Insanely comfortable! <br>  In general, with the help of the export parameter, I supplemented all types with the necessary attributes for export and got what I needed. <br><br><h4>  Unloading letters in the registry </h4><br>  The most interesting from the point of view of implementation is to upload the register of letters from <a href="http://easla.com/">easla.com</a> and then unload the letters themselves.  It is impossible to do this with system tools, only the registry is downloaded, but not files, so I had to write a macro. <br>  Write a macro instructed his colleague, he is in this master.  The algorithm is pretty simple.  Go through the unloaded registry, access each object in <a href="http://easla.com/">easla.com</a> (you can use <a href="https://ru.wikipedia.org/wiki/SOAP">SOAP</a> , <a href="https://ru.wikipedia.org/wiki/Component_Object_Model">COM</a> or <a href="https://ru.wikipedia.org/wiki/.NET_Framework">.NET</a> ) at the identifier specified in the registry and download the letter and application files to a separate folder.  In the registry, replace the letter designation with a hyperlink to the folder with uploaded files. <br>  Here is the registry in Microsoft Excel after unloading: <br><img src="https://habrastorage.org/files/24e/768/1f9/24e7681f9ae54da88f6c5286d478387d.png"><br>  "Inciting" him: <br><div class="spoiler">  <b class="spoiler_title">Add-on upload files</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Excel = Microsoft.Office.Interop.Excel; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Office = Microsoft.Office.Core; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> TNGP_Office_Helper; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Windows.Forms; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.IO; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> EaslaHelper; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">TNGP_ExcelAddIn_Specification</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Letters</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> SHEET_NAME = <span class="hljs-string"><span class="hljs-string">"Export"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> COLUMNS_COUN = <span class="hljs-number"><span class="hljs-number">12</span></span>; Excel.Workbook wb = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RunForestRun</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { ReadData(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { wb = Exl.ActiveWb; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (wb == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> exportSheet = wb.GetSheet(SHEET_NAME); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (exportSheet == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> path = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fbd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FolderBrowserDialog(); fbd.Description = <span class="hljs-string"><span class="hljs-string">"   ."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fbd.ShowDialog() == DialogResult.OK) path = fbd.SelectedPath; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (wb.Path != path) wb.SaveAs(Path.Combine(path, wb.Name)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rowsCount = ExcelHelper.CountDataRows(exportSheet, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, COLUMNS_COUN); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iRow = rowsCount; iRow &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span>; iRow--) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> idOut = exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"A"</span></span> + iRow].Text; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> numberOut = exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"B"</span></span> + iRow].Text; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> pathOut = Path.Combine(path, Helper.ReplaceChars(numberOut)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Directory.Exists(pathOut)) Directory.CreateDirectory(pathOut); EaslaHelperClass.DLDocument(<span class="hljs-string"><span class="hljs-string">"Out"</span></span>, <span class="hljs-string"><span class="hljs-string">"OutDocAttach"</span></span>, idOut, pathOut); index++; exportSheet.Hyperlinks.Add(Anchor: exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"B"</span></span> + iRow], Address: Helper.ReplaceChars(numberOut), TextToDisplay: numberOut); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> idIn = exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"H"</span></span> + iRow].Text; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(idIn)) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> numberIn = exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"I"</span></span> + iRow].Text; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> dateIn = exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"J"</span></span> + iRow].Text; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] arrId = idIn.Split(<span class="hljs-string"><span class="hljs-string">';'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] arrNumber = numberIn.Split(<span class="hljs-string"><span class="hljs-string">';'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] arrDate = dateIn.Split(<span class="hljs-string"><span class="hljs-string">';'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrId.Length &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> RngToCopy = exportSheet.Rows[<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Format(<span class="hljs-string"><span class="hljs-string">"{0}:{0}"</span></span>, iRow)]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; arrId.Length - <span class="hljs-number"><span class="hljs-number">1</span></span>; j++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> RngToInsert = exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"A"</span></span> + iRow].EntireRow; RngToInsert.Insert(Excel.XlInsertShiftDirection.xlShiftDown, RngToCopy.Copy(Type.Missing)); } } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; arrId.Length; i++) { exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"H"</span></span> + (iRow + i)].Value2 = arrId[i]; exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"J"</span></span> + (iRow + i)].Value2 = arrDate[i]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> numberInNew = Helper.ReplaceChars(arrNumber[i]); exportSheet.Hyperlinks.Add(Anchor: exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"I"</span></span> + (iRow + i)], Address: numberInNew, TextToDisplay: arrNumber[i]); <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> pathIn = Path.Combine(path, numberInNew); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Directory.Exists(pathIn)) Directory.CreateDirectory(pathIn); EaslaHelperClass.DLDocument(<span class="hljs-string"><span class="hljs-string">"In"</span></span>, <span class="hljs-string"><span class="hljs-string">"InDocAttach"</span></span>, arrId[i], pathIn); index++; } } <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> percent = index * <span class="hljs-number"><span class="hljs-number">100</span></span> / (rowsCount * <span class="hljs-number"><span class="hljs-number">2</span></span>); ExcelHelper.SetStatusBarPercent(Exl.ExlApp, Helper.PercentProgressBar(percent), <span class="hljs-string"><span class="hljs-string">" "</span></span>); } exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"A:A"</span></span>].EntireColumn.Hidden = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; exportSheet.Range[<span class="hljs-string"><span class="hljs-string">"H:H"</span></span>].EntireColumn.Hidden = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; wb.Save(); MessageBox.Show(<span class="hljs-string"><span class="hljs-string">" !"</span></span>); } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Secondary functions</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> DWReturnType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DLDocument</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> objdef, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> attrs, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> path, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> filename = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> objectdef = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] attrrefs = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (objdef) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"Out"</span></span>: objectdef = <span class="hljs-string"><span class="hljs-string">"crs_management_outgoing"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"In"</span></span>: objectdef = <span class="hljs-string"><span class="hljs-string">"crs_management_incoming"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (attrs) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"InDocAttach"</span></span>: attrrefs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"crs_management_incoming_document"</span></span>, <span class="hljs-string"><span class="hljs-string">"crs_management_incoming_attachments"</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"InDoc"</span></span>: attrrefs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"crs_management_incoming_document"</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"OutDocAttach"</span></span>: attrrefs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"crs_management_outgoing_document"</span></span>, <span class="hljs-string"><span class="hljs-string">"crs_management_outgoing_attachments"</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"OutDoc"</span></span>: attrrefs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>[] { <span class="hljs-string"><span class="hljs-string">"crs_management_outgoing_document"</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> process = EaslaApp.getProcess(<span class="hljs-string"><span class="hljs-string">"crs_management"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> object_def = EaslaApp.getObjectdef(process, objectdef, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> objectrefs = GetObjectRefs(id, object_def, attrrefs); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (objectrefs == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DWReturnType.Error; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (objectrefs.Length == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DWReturnType.LetterNotFound; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (objectrefs.Length &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DWReturnType.FoundManyLetters; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> DownloadFile(filename, path, objectrefs[<span class="hljs-number"><span class="hljs-number">0</span></span>].attributerefs); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> DWReturnType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DownloadFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> filename, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> path, Easla.AttributerefSimpleSoap[] attrs</span></span></span><span class="hljs-function">)</span></span> { DWReturnType result = DWReturnType.FileNotFound; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> attr <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> attrs) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (attr.values != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> files = attr.values.OfType&lt;Easla.FileSimpleSoap&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> selectfiles = files.Where(f =&gt; f.isdeleted == <span class="hljs-string"><span class="hljs-string">"0"</span></span> &amp; f.vid == <span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fss <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> selectfiles) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> filePath = Path.Combine(path, fss.nowname); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrEmpty(filename)) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> ext = Path.GetExtension(fss.nowname); filePath = Path.Combine(path, filename + ext); } EaslaApp.DownloadFile(fss.id, filePath); result = DWReturnType.Ok; } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre><br></div></div><br>  The result looks like this: <br><img src="https://habrastorage.org/files/001/fd7/1db/001fd71db39d4ce4896091f4e5ad8132.png"><br>  I think it‚Äôs not even worth convincing anyone of the economic effect of such a decision.  Time, which means the money spent on the preparation of the report and the unloading of letters decreased by two, then by three orders of magnitude!  A couple of weeks ago, one of the GUI assistants unloaded in this way more than a hundred or even two letters.  All correspondence with the customer for a certain period.  Launched unloading in the evening and left for the night.  In the morning I got the finished result!  Manually, he would have a couple of weeks, if not more, collected all the files. <br><br><h4>  Results </h4><br>  Despite the fact that I needed to write three voluminous articles to describe the process, I can safely say that creating a process in <a href="http://easla.com/">easla.com is</a> simple and easy.  In fact, the entire process of managing correspondence took 2-3 part-time days, because I was distracted by current affairs.  A serious and attentive approach required only the action ‚ÄúSend by email.  mail ‚Äùin the‚Äú Outgoing Document ‚Äùobject (see <a href="https://habrahabr.ru/company/easla/blog/281999/">previous article</a> ).  Otherwise, the code of objects and attributes is simple, repetitive and easy to read. <br>  I am convinced that any other process administrator at <a href="http://easla.com/">easla.com</a> can easily read the process code and will understand it in two accounts. <br>  With full confidence, I can insist that <a href="http://easla.com/">easla.com is</a> an excellent electronic document management system, ready to fight back many similarly expensive commercial products on the Russian market! <br>  PS I would like to draw your attention to the fact that <u>the process described is</u> not available for borrowing only because of the presence of confidential data in it.  Its full analogue. <a href="https://easla.com/ru/process/infoAlone/process_id/159">Correspondence</a> published on the site for general use without any restrictions!  There will be questions - write to <a href="">support@easla.com</a> - you will be answered! </div><p>Source: <a href="https://habr.com/ru/post/282347/">https://habr.com/ru/post/282347/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282333/index.html">Confessions of Bitrix Hayter</a></li>
<li><a href="../282335/index.html">Difficult integrity constraint - 2</a></li>
<li><a href="../282337/index.html">Report from Percona Live 2016: what to expect from MySQL 8?</a></li>
<li><a href="../282339/index.html">"Have I been pwned" received the first "independent request"</a></li>
<li><a href="../282345/index.html">Results of the big programming championship - 2016 for 5 thousand people</a></li>
<li><a href="../282349/index.html">DGA Domain Detection</a></li>
<li><a href="../282351/index.html">The Internet of Things on a real example - car search system</a></li>
<li><a href="../282353/index.html">Explosive final of the Imagine Cup 2016</a></li>
<li><a href="../282357/index.html">Local positioning technology. Part II</a></li>
<li><a href="../282359/index.html">cx_Freeze + virtualenv = bugs and zigzags</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>