<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Formula parser using recursive descent method</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day, dear Habrovchane! 

 I want to share with you the implementation of the algorithm "Method of recursive descent" on the example of writing a ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Formula parser using recursive descent method</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/d3f0530f/0aee4eec/cf2e4d21/5109315b.png"><br><br>  Good day, dear Habrovchane! <br><br>  I want to share with you the implementation of the algorithm <a href="http://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B4_%25D1%2580%25D0%25B5%25D0%25BA%25D1%2583%25D1%2580%25D1%2581%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE_%25D1%2581%25D0%25BF%25D1%2583%25D1%2581%25D0%25BA%25D0%25B0">"Method of recursive descent"</a> on the example of writing a parser of formulas with support for variables and functions in the Java language 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This article in (most likely, in any case, I hope :)) will be interesting for beginners, or to apply to someone as a foundation for solving this problem. <br>  Who cares - I ask under the cat <br><a name="habracut"></a><br><br><h4>  TK </h4><br>  Develop a formula parser that: <br><ul><li>  keeps the correct queue of operations </li><li>  supports functions </li><li>  supports variables </li></ul><br><br><h4>  Introduction </h4><br>  The essence of this method is that it is divided into its subtasks.  In turn, the subtask should work only with what it can work with, if the conditions are not met to transfer control further.  If the conditions are satisfied, we do the calculations and pass the rest of the raw text.  Execution occurs as long as the text is still there or if no subtask can handle the current state. <br><br>  Subtask priority is also important.  Changing the priority of the subtask will change the behavior of the parser. <br>  Since we will implement the parser of mathematical formulas, to prioritize, we will be guided by the priorities of mathematical operations: <br><ol><li>  function and variable </li><li>  parentheses </li><li>  multiplication and division </li><li>  addition and subtraction </li></ol><br><br><h4>  Flew </h4><br><br>  Well, now for the cause. <br>  As I have already mentioned above, we will manipulate the remainder of the line, that is, each task bites off what it does in the teeth and passes on what it cannot swallow. <br>  Total we need the following structure: <br>  string variable to hold the rest of the string <br>  and the so-called accumulator, to store the current state of the calculation process <br>  Need to?  Let's do it! <br><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Result</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> acc; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> String rest; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Result</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v, String r)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.acc = v; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.rest = r; } }</code> </pre> <br><br>  Now let's start the parser itself: <br>  first we will call the subtask with the lowest priority. <br>  Subtasks, in turn, transfer control to subtasks with a higher priority, and after each of their actions that have affected the text, we also transfer control to subtasks with a high priority. <br>  And as mentioned above, program execution will continue until there is something to parse, or we stumble upon an unknown structure or sequence of data. <br><br>  From the method that performs addition / subtraction, we will cause multiplication / division, and so on. <br><br>  For a common understanding, let's slightly simplify the task, let's make a parser that only performs addition and subtraction operations: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MatchParserPlusMinus</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MatchParserPlusMinus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Parse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ Result result = PlusMinus(s); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!result.rest.isEmpty()) { System.err.println(<span class="hljs-string"><span class="hljs-string">"Error: can't full parse"</span></span>); System.err.println(<span class="hljs-string"><span class="hljs-string">"rest: "</span></span> + result.rest); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.acc; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Result </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlusMinus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ Result current = Num(s); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> acc = current.acc; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (current.rest.length() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(current.rest.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-string"><span class="hljs-string">'+'</span></span> || current.rest.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-string"><span class="hljs-string">'-'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> sign = current.rest.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>); String next = current.rest.substring(<span class="hljs-number"><span class="hljs-number">1</span></span>); acc = current.acc; current = Num(next); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sign == <span class="hljs-string"><span class="hljs-string">'+'</span></span>) { acc += current.acc; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { acc -= current.acc; } current.acc = acc; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Result(current.acc, current.rest); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Result </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Num</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dot_cnt = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> negative = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       if( s.charAt(0) == '-' ){ negative = true; s = s.substring( 1 ); } //      while (i &lt; s.length() &amp;&amp; (Character.isDigit(s.charAt(i)) || s.charAt(i) == '.')) { //   ,        ! if (s.charAt(i) == '.' &amp;&amp; ++dot_cnt &gt; 1) { throw new Exception("not valid number '" + s.substring(0, i + 1) + "'"); } i++; } if( i == 0 ){ // -       throw new Exception( "can't get valid number in '" + s + "'" ); } double dPart = Double.parseDouble(s.substring(0, i)); if( negative ) dPart = -dPart; String restPart = s.substring(i); return new Result(dPart, restPart); } }</span></span></code> </pre><br><br>  and when calling: <br><pre> <code class="java hljs"> MatchParserPlusMinus pm = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MatchParserPlusMinus(); String f = <span class="hljs-string"><span class="hljs-string">"10-8+2+6"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ System.out.println( <span class="hljs-string"><span class="hljs-string">"PlusMinus: "</span></span> + pm.Parse(f) ); }<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception e){ System.err.println( <span class="hljs-string"><span class="hljs-string">"Error while parsing '"</span></span>+f+<span class="hljs-string"><span class="hljs-string">"' with message: "</span></span> + e.getMessage() ); }</code> </pre><br><br>  Will bring us: <br> <code>PlusMinus: 10.0 <br></code> <br><br>  In this parser, I implemented the following functions (you can expand this list with your functions by adding the corresponding condition in the <b>processFunction</b> ): <br><ul><li>  sin </li><li>  cos </li><li>  tan </li></ul><br>  I didn‚Äôt particularly bother with error handling (so as not to clutter up the ‚Äúuseful‚Äù code), otherwise the error handling code may be more than the code for the parser itself :) <br><br>  Here is the full listing of the class without simplification: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MatchParser</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> HashMap&lt;String, Double&gt; variables; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MatchParser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ variables = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, Double&gt;(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setVariable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String variableName, Double variableValue)</span></span></span><span class="hljs-function"> </span></span>{ variables.put(variableName, variableValue); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Double </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getVariable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String variableName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!variables.containsKey(variableName)) { System.err.println( <span class="hljs-string"><span class="hljs-string">"Error: Try get unexists variable '"</span></span>+variableName+<span class="hljs-string"><span class="hljs-string">"'"</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> variables.get(variableName); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Parse</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ Result result = PlusMinus(s); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!result.rest.isEmpty()) { System.err.println(<span class="hljs-string"><span class="hljs-string">"Error: can't full parse"</span></span>); System.err.println(<span class="hljs-string"><span class="hljs-string">"rest: "</span></span> + result.rest); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.acc; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Result </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlusMinus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ Result current = MulDiv(s); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> acc = current.acc; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (current.rest.length() &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(current.rest.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-string"><span class="hljs-string">'+'</span></span> || current.rest.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-string"><span class="hljs-string">'-'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> sign = current.rest.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>); String next = current.rest.substring(<span class="hljs-number"><span class="hljs-number">1</span></span>); current = MulDiv(next); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sign == <span class="hljs-string"><span class="hljs-string">'+'</span></span>) { acc += current.acc; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { acc -= current.acc; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Result(acc, current.rest); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Result </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Bracket</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> zeroChar = s.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (zeroChar == <span class="hljs-string"><span class="hljs-string">'('</span></span>) { Result r = PlusMinus(s.substring(<span class="hljs-number"><span class="hljs-number">1</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!r.rest.isEmpty() &amp;&amp; r.rest.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-string"><span class="hljs-string">')'</span></span>) { r.rest = r.rest.substring(<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { System.err.println(<span class="hljs-string"><span class="hljs-string">"Error: not close bracket"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> FunctionVariable(s); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Result </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FunctionVariable</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String s)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ String f = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      //       while (i &lt; s.length() &amp;&amp; (Character.isLetter(s.charAt(i)) || ( Character.isDigit(s.charAt(i)) &amp;&amp; i &gt; 0 ) )) { f += s.charAt(i); i++; } if (!f.isEmpty()) { //  -  if ( s.length() &gt; i &amp;&amp; s.charAt( i ) == '(') { //      -   Result r = Bracket(s.substring(f.length())); return processFunction(f, r); } else { //  -   return new Result(getVariable(f), s.substring(f.length())); } } return Num(s); } private Result MulDiv(String s) throws Exception { Result current = Bracket(s); double acc = current.acc; while (true) { if (current.rest.length() == 0) { return current; } char sign = current.rest.charAt(0); if ((sign != '*' &amp;&amp; sign != '/')) return current; String next = current.rest.substring(1); Result right = Bracket(next); if (sign == '*') { acc *= right.acc; } else { acc /= right.acc; } current = new Result(acc, right.rest); } } private Result Num(String s) throws Exception { int i = 0; int dot_cnt = 0; boolean negative = false; //       if( s.charAt(0) == '-' ){ negative = true; s = s.substring( 1 ); } //      while (i &lt; s.length() &amp;&amp; (Character.isDigit(s.charAt(i)) || s.charAt(i) == '.')) { //   ,        ! if (s.charAt(i) == '.' &amp;&amp; ++dot_cnt &gt; 1) { throw new Exception("not valid number '" + s.substring(0, i + 1) + "'"); } i++; } if( i == 0 ){ // -       throw new Exception( "can't get valid number in '" + s + "'" ); } double dPart = Double.parseDouble(s.substring(0, i)); if( negative ) dPart = -dPart; String restPart = s.substring(i); return new Result(dPart, restPart); } //     ,       private Result processFunction(String func, Result r) { if (func.equals("sin")) { return new Result(Math.sin(Math.toRadians(r.acc)), r.rest); } else if (func.equals("cos")) { return new Result(Math.cos(Math.toRadians(r.acc)), r.rest); } else if (func.equals("tan")) { return new Result(Math.tan(Math.toRadians(r.acc)), r.rest); } else { System.err.println("function '" + func + "' is not defined"); } return r; } }</span></span></code> </pre><br><br>  And when calling: <br><br><pre> <code class="java hljs"> String[] formulas = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[] { <span class="hljs-string"><span class="hljs-string">"2+2*2"</span></span>, <span class="hljs-string"><span class="hljs-string">"2+X*2"</span></span>, <span class="hljs-string"><span class="hljs-string">"sin(90)+4-cos(0)"</span></span>, <span class="hljs-string"><span class="hljs-string">"2--4"</span></span>, <span class="hljs-string"><span class="hljs-string">"2**3*5-----7"</span></span>, <span class="hljs-string"><span class="hljs-string">"3.5.6-2"</span></span> }; MatchParser p = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MatchParser(); p.setVariable(<span class="hljs-string"><span class="hljs-string">"X"</span></span>, <span class="hljs-number"><span class="hljs-number">2.0</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; formulas.length; i++){ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ System.out.println( formulas[i] + <span class="hljs-string"><span class="hljs-string">"="</span></span> + p.Parse( formulas[i] ) ); }<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception e){ System.err.println( <span class="hljs-string"><span class="hljs-string">"Error while parsing '"</span></span>+formulas[i]+<span class="hljs-string"><span class="hljs-string">"' with message: "</span></span> + e.getMessage() ); } }</code> </pre><br>  Displays: <br> <code>2+2*2=6.0 <br> 2+X*2=6.0 <br> sin(90)+4-cos(0)=4.0 <br> 2--4=6.0 <br> Error while parsing '2**3*5-----7' with message: can't get valid number in '*3*5-----7' <br> Error while parsing '3.5.6-2' with message: not valid number '3.5.' <br></code> <br><br>  You can download the whole project <a href="http://narod.ru/disk/16776714001/MatchParserRun.zip.html">here</a> (thanks to <a href="https://habrahabr.ru/users/flexoid/" class="user_link">flexoid</a> for the hint where you can save the archive) <br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/122397/">https://habr.com/ru/post/122397/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122390/index.html">Plugin for expanding short links</a></li>
<li><a href="../122391/index.html">Nokia N950 (aka Nokia N9 Devkit)</a></li>
<li><a href="../122392/index.html">Sony Ericsson's premier day: the latest Xperia ray, Xperia active and others</a></li>
<li><a href="../122395/index.html">Graphic Google search, or "Zaporozhets" is also a machine</a></li>
<li><a href="../122396/index.html">Nokia Play 360 external speaker for Nokia N9</a></li>
<li><a href="../122400/index.html">Agile camp of strict regime or impressions of AgileCamp 2011 in Samara</a></li>
<li><a href="../122401/index.html">Quick access to 2D flash array</a></li>
<li><a href="../122404/index.html">Domen.RUS will unite the Russian-speaking population of the planet</a></li>
<li><a href="../122408/index.html">How to make friends with SQLite android with a language other than English</a></li>
<li><a href="../122411/index.html">Failover DHCP. Unsuccessful test history</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>