<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Talk about hosting security: how could I hack tens of thousands of sites</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello. 

 Today I would like to talk about the security of hosting and how bad things are in this area. In the middle of 2014, I was reading another a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Talk about hosting security: how could I hack tens of thousands of sites</h1><div class="post__text post__text-html js-mediator-article">  Hello. <br><br>  Today I would like to talk about the security of hosting and how bad things are in this area.  In the middle of 2014, I was reading another article at the time about protecting sites from viruses and wondered how secure the hosting was, and whether vulnerabilities could be used for mass hacking of sites.  In short, everything is much worse than I expected, and this story stretched for 3 years. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/dac/287/673/dac287673e96479f90bce9e1cbe906d4.jpg" alt="image"></div><br>  <i>Most of the hosting looks like this</i> <br><a name="habracut"></a><br>  Back in 2014, I started by checking the hosting that I used at that time, and immediately found CSRF to change my account information.  If you can talk about CSRF as simply as possible, this vulnerability allows forging requests on behalf of the user.  When you send an HTML form from one domain to another, the browser will automatically add to the request your cookies set for the target domain.  This allows an attacker, without access to your cookies, to send a request to the target domain on your behalf with your cookies.  To protect against this attack, CSRF tokens, checking the referer header, or entering a password to confirm important requests are used (this is a very strange and insecure solution).  You can read more about this on <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D0%25B6%25D1%2581%25D0%25B0%25D0%25B9%25D1%2582%25D0%25BE%25D0%25B2%25D0%25B0%25D1%258F_%25D0%25BF%25D0%25BE%25D0%25B4%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25BA%25D0%25B0_%25D0%25B7%25D0%25B0%25D0%25BF%25D1%2580%25D0%25BE%25D1%2581%25D0%25B0">Wikipedia</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I quickly checked out 10 more major hosting sites, more than half found such a vulnerability.  In fact, I could create a special page, after switching to an authorized user, his email address was changed to mine, and I could recover the password by mail and access to the account and all files.  It sounds scary, but it's not deadly.  To successfully execute an attack, you need to find the user, lure him to a special page, and the user must be authorized in the hosting control panel.  This significantly reduces the chances of a successful mass hacking. <br><br>  However, most hosting uses ready-made control panels.  In this case, the administrator is the same user account with a bunch of additional rights: he often has access to all accounts on the server.  For a successful attack, it was enough to create a page, the code on which will automatically send a request to change the administrator's mail, create a new account with additional rights, or perform any other action that is possible in the control panel.  If you wish, you can change the extension of such a page to .jpg and place a screenshot on it to hide what is actually happening on it.  After that, you can create a ticket "Help, the site does not work, here is a screenshot of the error" and attach a link to the page.  After the administrator has moved to this page, the attacker gains access to all accounts of the hosting users. <br><br>  To select hosting, I combined data from several ratings, after that I checked the targets for the presence of CSRF vulnerabilities.  I usually checked the hosting only for the presence of CSRF, as this does not take a lot of time, but if I accidentally found something else, I reported these vulnerabilities too. <br><br><h3>  Results and technical details </h3><br>  As I wrote above, out of ten major hosting sites, more than half were vulnerable.  Out of a total of 100 web hosts tested in 2014, 63 were vulnerable.  Usually these were simple CSRFs, although surprising vulnerabilities were met, which I will discuss later. <br><br>  In the case of handwritten panels, you can usually use the CSRF to change mail, and then restore the password through the mail.  The most popular of the vulnerable panels were ISPmanager, DirectAdmin, WHMCS and RootPanel.  I can not call myself an expert in the hosting control panels, so I can be mistaken with the versions or other subtleties. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/33c/1f0/a32/33c1f0a32283486bb8149ae631dafa38.gif" alt="image"></div><br><br>  This is a very popular panel, while its current version does not contain CSRF.  However, an extremely outdated and leaky old version of the panel is often used. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/f0e/084/00c/f0e08400cc2a49cebf7f20b802f4877f.png" alt="image"></div><br><br>  After finding the CSRF on different hosts using this panel, I wrote to the panel developers about this.  However, they reported that for a long time there was protection against CSRF in the form of checking the referer header, however, it was turned off for most of the hosts. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/768/832/229/7688322291244aa29988dd33a07904b6.png" alt="image"></div><br><br>  A similar problem was with WHMCS.  For some surprising reason, the CSRF token was not tested on many hosting systems, there was no protection against forgeries.  Probably, someone incorrectly configured something. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/aac/7e8/cab/aac7e8cab8d843329e4a4fae9bd0a640.png" alt="image"></div><br><br>  And in this panel were present CSRF initially, the vulnerability was fixed by the developer after I wrote to him. <br><br><h3>  Hosting Reaction </h3><br>  Perhaps the most correct would be to publish this information in 2014 and watch for mass hacks and hacker complaints.  But then I decided that it was better to report the vulnerabilities to hosting, and began to do so.  I told 63 vulnerable hosting about the problem, only 52 responded. After some time, 48 hosts fixed the vulnerability, the rest did not do anything. <br><br>  The most interesting thing started later.  After some time, I checked these hostings again, and part of them made the vulnerabilities magically appear again.  In 2015 and in 2016, I selected another 20-30 hosting sites, checked them and wrote to companies about vulnerabilities.  The situation is similar: more than half of the hosting sites are vulnerable, some time after the fix, some of the vulnerabilities reappear. <br><br>  At some point, it all began to resemble a circus: I send the information, the vulnerability disappears.  Often, especially in the case of samopisnymi panels, after six months, the vulnerability returns in the same or similar form. <br><br>  Some companies were ready to fix the vulnerability only by installing an update of the control panel used (‚ÄúWe are using the latest version of the panel, this is a problem for developers‚Äù).  At the same time, their panel generation has not been updated for a long time. <br><br>  At some point I decided to end this circus and publish information about existing problems. <br><br><h3>  The scale of the problem </h3><br>  The number of sites that could be hacked using these vulnerabilities is difficult to calculate.  If we proceed from the number of vulnerable hosting sites (of the order of 90-100) and the minimum number of hosted sites in 1000 on each hosting (I am pretty sure that the real number is much larger), then this is at least 100,000 sites.  However, indirect signs (ID of accounts and sites in the system, own statements of hosting and information from ratings) suggest that more than a few million sites were in danger.  It is clear that most of the sites are visited by a couple of people a month, but even so, the situation is scary. <br><br><h3>  Brief results and condition to date </h3><br>  In 2014 and 2015, the situation was frightening: more than half of the hosting sites, including some of the largest ones at that time, had simple vulnerabilities that allow access to user data.  In the worst case, immediately to all accounts.  Gradually, the situation began to improve: those who planned to close vulnerabilities corrected them, new hosting finally began to use newer control panels. <br><br>  However, there is a barrel of tar: even now, a number of major hosting sites that are in the top 10‚Äì20 of the most popular ones contain simple CSRFs that allow you to access a user account.  There is a suspicion that in a similar way you can perform queries on behalf of the administrator, but this is a separate issue (they use their control panels, I don‚Äôt know the format of the administrator requests).  Among the smaller hosting companies, there are still quite a lot of those who for some reason have not fixed the vulnerabilities.  In addition, there are many related vulnerabilities, the security level in the field of hosting is surprisingly low. <br><br><h3>  A few notes and funny situations </h3><br>  * <b>Rewards</b> .  Usually they offered free hosting, and the conditions were very different: from the truly adequate 10,000 to 20,000 thousand to the personal account, before the discount of 120 rubles for 1 month, I was impressed by this generosity.  Cash rewards were offered much less frequently, usually they were symbolic 1000-2000 rubles, although there were two much more pleasant times.  But these are isolated situations, most did not offer anything. <br><br>  * <b>Adequacy</b> .  I have never faced rudeness or threats.  The most annoying thing is to ignore messages or reply ‚ÄúWe do not consider this a vulnerability.‚Äù <br><br>  * <b>Brilliant solutions to security problems</b> .  Several companies have decided to deal with the threat of CSRF in a strange way: "administrators will not follow links from users," and users must "take care of themselves." <br><br>  * <b>Other vulnerabilities</b> .  I only looked for CSRF, but sometimes there were other vulnerabilities.  The most common is incorrect HTTPS configuration, sometimes it was absent altogether, there was a bunch of XSS, there were strange data leaks.  It's funny that the hosting, which has positioned itself as the most secure (reliable systems, access control, round-the-clock monitoring), could get access to any account by simply sorting through identifiers.  Apparently, the cost of PR is too high to make secure services. <br><br>  * <b>Publication of company names</b> .  For a long time I could not decide whether to publish the full results of the audit with all the company names and a detailed description of the vulnerabilities.  However, given the check only for CSRF, its selectivity, still vulnerable hosting and some conditions for receiving remuneration, I did not publish this information. <br><br>  If, after reading the article, you have a desire to do something, then I strongly urge you not to commit unlawful actions or break the hosting. <br><br>  I hope that next week I will tell you something more interesting, for example, about unclosed vulnerabilities in Telegram. <br><br>  <b>UPD</b> : The comments were requested to provide proofs.  Under the spoiler there are screenshots of several hosting responses (in the screenshots I tried to hide all the data that uniquely identify the company) and the answer from the developers of DirectAdmin. <br><div class="spoiler">  <b class="spoiler_title">Screenshots</b> <div class="spoiler_text">  one) <img src="https://habrastorage.org/web/e51/8c0/ded/e518c0ded64c4d32b785e15ab7ce49ad.png"><br>  2) <img src="https://habrastorage.org/web/f80/0f3/1dc/f800f31dc1974784888db66a1df5c943.png"><br>  3) <img src="https://habrastorage.org/web/74f/a72/0e1/74fa720e15de421999ccec4df226819c.png"><br>  four) <img src="https://habrastorage.org/web/a1e/07f/2ad/a1e07f2ad33a41579226a3e3ad3db971.png"><br>  five) <img src="https://habrastorage.org/web/c17/cce/d04/c17cced049b640ecb87554cc8e7e14cc.png"><br>  6) <img src="https://habrastorage.org/web/e90/6dc/ce2/e906dcce25934fe29d100a2576406018.png"><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/337906/">https://habr.com/ru/post/337906/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337892/index.html">Just about the complex: what you need to know about bioinformatics</a></li>
<li><a href="../337896/index.html">Playfully BASH'im further</a></li>
<li><a href="../337898/index.html">China made a new move in the race supercomputers</a></li>
<li><a href="../337900/index.html">The right choice of SrZI: from flyers to use case</a></li>
<li><a href="../337902/index.html">Robots in human society</a></li>
<li><a href="../337908/index.html">We invite to the Azov Developers Meetup conference - September 23 in Taganrog</a></li>
<li><a href="../337910/index.html">Developer Evolution</a></li>
<li><a href="../337912/index.html">Corporate Laboratories: Identifying Information Security Incidents</a></li>
<li><a href="../337914/index.html">Cloud Fabric: how SDN helps IT more responsive to change</a></li>
<li><a href="../337916/index.html">Unicorn technology companies are revalued by an average of 48%: research by scientists from Stanford</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>