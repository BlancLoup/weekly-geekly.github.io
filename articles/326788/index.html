<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>GA Measurement Protocol - complete guide</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Habr√© there is already one review of the Measurement Protocol, but since there are a number of additions and the presence of cases, I decided to wr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>GA Measurement Protocol - complete guide</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/f45/b8e/f0b/f45b8ef0bb5e42bdab4036ccf0bba0da.jpg"><br>  On Habr√© there is already one <a href="https://habrahabr.ru/post/222169/">review of the</a> Measurement Protocol, but since there are a number of additions and the presence of cases, I decided to write a complete guide. <br><br>  <b>Content</b> <br><br><ul><li>  Technical side 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Required parameters </li><li>  GA interaction transfer </li><li>  Parameters cid, uid, ni </li></ul><br></li><li>  Measurement Protocol in practice <br><br><ul><li>  GA standard tracking code </li><li>  CRM Integration </li><li>  Transaction tracking </li><li>  Return or partial refund </li><li>  Offline points of sale </li><li>  Opening letters </li></ul><br></li><li>  Additional resources </li><li>  findings </li></ul><a name="habracut"></a><br>  <b>Measurement Protocol (MP)</b> is a basic tool by which Google Analytics (GA) collects information.  That is, it is a technology that is used to transmit information about page views and other events in GA. <br><br><h2>  Technical side </h2><br>  The protocol works on HTTP, has a single entry point: <a href="https://www.google-analytics.com/collect">www.google-analytics.com/collect</a> <br><br>  Data can be sent with POST and GET requests. <br><br><h3>  Required parameters </h3><br>  <b>v</b> - the current protocol version is 1 (v = 1). <br>  <b>tid</b> - the identifier of your resource in GA. <br>  <b>cid</b> - a unique identifier of the user (either the standard GA JS-code puts it in the Cookie, or you need to generate it yourself - we will take a closer look at this below). <br>  <b>t</b> - type of interaction, for example pageview / event (t = event). <br><br>  That is, the request will look like this: <br><br><pre><code class="hljs cs">v=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;tid=UA<span class="hljs-number"><span class="hljs-number">-123456</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>&amp;cid=<span class="hljs-number"><span class="hljs-number">1482535147.1490885188</span></span>&amp;t=<span class="hljs-keyword"><span class="hljs-keyword">event</span></span></code> </pre> <br>  Since  we chose the type of interaction Event, we need to add the required parameters describing the event: <br><br>  <b>ec</b> (event category) - event category (ec = registration). <br>  <b>ea</b> (event action) - event action (ea = form). <br><br><pre> <code class="hljs cs">v=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;tid=UA<span class="hljs-number"><span class="hljs-number">-123456</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>&amp;cid=<span class="hljs-number"><span class="hljs-number">1482535147.1490885188</span></span>&amp;t=<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>&amp;ec=registration&amp;ea=form</code> </pre> <br>  <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters">Full list of parameters</a> <br><br><h3>  GA event transfer </h3><br><br>  You can send a request using one of the following methods: <br><br>  POST <br><br><pre> <code class="hljs ruby">User-<span class="hljs-symbol"><span class="hljs-symbol">Agent:</span></span> user_agent_string /<span class="hljs-regexp"><span class="hljs-regexp">/ https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/en.wikipedia.org/wiki</span></span><span class="hljs-regexp"><span class="hljs-regexp">/User_agent#Format POST /collect</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">Host:</span></span> www.google-analytics.com v=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;tid=UA-<span class="hljs-number"><span class="hljs-number">123456</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;cid=<span class="hljs-number"><span class="hljs-number">1482535147.1490885188</span></span>&amp;t=event&amp;ec=registration&amp;ea=form</code> </pre> <br>  Get <br><br>  In order to avoid problems with caching, it is recommended to add z, with the last parameter, with a unique value for each of the requests. <br><br><pre> <code class="hljs cs">GET /collect?v=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;tid=UA<span class="hljs-number"><span class="hljs-number">-123456</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>&amp;cid=<span class="hljs-number"><span class="hljs-number">1482535147.1490885188</span></span>&amp;t=<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>&amp;ec=registration&amp;ea=form&amp;z=<span class="hljs-number"><span class="hljs-number">12345</span></span> HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Host: https:<span class="hljs-comment"><span class="hljs-comment">//www.google-analytics.com User-Agent: user_agent_string</span></span></code> </pre> <br>  <a href="https://ga-dev-tools.appspot.com/hit-builder/">Service to verify the correctness of the data sent</a> <br><br><h3>  Parameters cid, uid, ni </h3><br>  There are often questions on these parameters, so we will take a closer look. <br><br>  <b>cid</b> <br>  cid is the client id, the unique identifier of the user's client application (for example, a web browser), the cid is stored in a <b>_ga</b> cookie for a specific domain. <br><br>  The _ga cookie stores something similar to: GA1.2.602320690.1474476467 <br><br>  In the cid parameter you need to transfer everything that is located after the second point.  That is, in this case: <br><br><pre> <code class="hljs 1c"><span class="hljs-meta"><span class="hljs-meta">&amp;cid=602320690.1474476467</span></span></code> </pre> <br>  Cook <b>_ga is</b> put down at the moment when Google Analytics Tracker is initialized: <br><br><pre> <code class="javascript hljs">&lt;script&gt; (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i,s,o,g,r,a,m</span></span></span><span class="hljs-function">)</span></span>{i[<span class="hljs-string"><span class="hljs-string">'GoogleAnalyticsObject'</span></span>]=r;i[r]=i[r]||<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ (i[r].q=i[r].q||[]).push(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>)},i[r].l=<span class="hljs-number"><span class="hljs-number">1</span></span>*<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>();a=s.createElement(o), m=s.getElementsByTagName(o)[<span class="hljs-number"><span class="hljs-number">0</span></span>];a.async=<span class="hljs-number"><span class="hljs-number">1</span></span>;a.src=g;m.parentNode.insertBefore(a,m) })(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>,<span class="hljs-string"><span class="hljs-string">'script'</span></span>,<span class="hljs-string"><span class="hljs-string">'https://www.google-analytics.com/analytics.js'</span></span>,<span class="hljs-string"><span class="hljs-string">'ga'</span></span>); ga(<span class="hljs-string"><span class="hljs-string">'create'</span></span>, <span class="hljs-string"><span class="hljs-string">'UA-12345678-1'</span></span>, <span class="hljs-string"><span class="hljs-string">'auto'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      ga('send', 'pageview'); //         Google Analytics &lt;/script&gt;</span></span></code> </pre><br>  The cid parameter is required for all queries in the Measurement Protocol.  If you have a delayed sending of events in GA to MP - you need to save the user's cid on the backend side. <br><br>  <u>What if there is no cid</u> <br><br>  Examples of cases: <br><br>  1) you have not previously saved cid users <br>  2) the user has cookies disabled or some browser extensions block the execution of the google analytics script. <br><br>  Since the cid parameter is mandatory for sending data to GA, in such cases it is necessary to generate a cid on the backend side. <br><br>  We generate a cid like this: <br><br><pre> <code class="php hljs">$cookieId = rand(<span class="hljs-number"><span class="hljs-number">1000000000</span></span>, <span class="hljs-number"><span class="hljs-number">2147483647</span></span>) . <span class="hljs-string"><span class="hljs-string">'.'</span></span> . time();</code> </pre> <br>  <u>What threatens self cid generation</u> <br>  The submitted data will not be associated with the user on the side of Google Analytics. <br><br>  But you get a complete picture of the number of events.  Because if you didn't send the information on the Measurement Protocol from the backend, it would generally pass by the statistics. <br><br>  <b>uid</b> <br><br>  The unique identifier of the user on your system (for example, on the site).  The parameter is required to enable the User ID function. <br><br>  This will allow you to create a separate view with statistics for all logged in users, where you can track the sequence of actions (views, pages, events, payments) for each of the users.  A Cross Device report will also be available. <br><br>  Learn more about User ID: <a href="https://support.google.com/analytics/answer/3123662">support.google.com/analytics/answer/3123662</a> <br><br>  With this parameter, we can inform GA that this interaction was performed by a specific user.  The parameter can take any string value, but you cannot transfer information that reveals the user's identity (for example, email or last name, first name). <br><br>  We connected the User ID for all logged in users.  But we prod uid not only into the base parameter, but also duplicated it in Custom Dimension 1 (this allowed us to use segments in the User ID view). <br><br>  In the main GA JS code, this is done like this: <br><br><pre> <code class="javascript hljs">ga(<span class="hljs-string"><span class="hljs-string">'create'</span></span>, <span class="hljs-string"><span class="hljs-string">'UA-XXXXX-Y'</span></span>, <span class="hljs-string"><span class="hljs-string">'auto'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">userId</span></span>: USER_ID, <span class="hljs-string"><span class="hljs-string">'dimension1'</span></span>: USER_ID }); ga(<span class="hljs-string"><span class="hljs-string">'send'</span></span>, <span class="hljs-string"><span class="hljs-string">'pageview'</span></span>);</code> </pre> <br>  This can be done more elegantly with Google Tag Manager, but this is a topic for a separate article. <br><br>  To send requests from the backend, add parameters: <br><br><pre> <code class="hljs 1c"><span class="hljs-meta"><span class="hljs-meta">&amp;uid=USER_ID&amp;cd1=USER_ID</span></span></code> </pre> <br>  <b>ni</b> <br><br>  The presence of the parameter will not initialize the new session. <br><br>  If you do not use this parameter, then with pending events, a new session with empty parameters will be created in GA (the traffic source will go to direct / none, devices will be in (not set), geography will be built relative to your server‚Äôs IP).  That is, it will be a session that carries no value, winds up the statistics counter and breaks the reporting on traffic sources. <br><br>  For example, if this is a deferred event - change the status of the transaction in CRM.  It usually happens when the user (who is assigned to this transaction) does not have an active session on the site.  Therefore, without using &amp; ni = 1, a new session will be created. <br><br>  In general, for pending events, use &amp; ni = 1. <br><br><h2>  Measurement Protocol in practice </h2><br><h3>  GA standard tracking code </h3><br>  Even the most standard JS GA code uses the Measurement Protocol when executed.  Let's see how it works. <br><br><ol><li>  Open the Google Chrome window with the Developer Tools panel (CTRL + Shift + I or F12). </li><li>  In the address bar, enter habrahabr.ru. </li><li>  In the panel for developers we are interested in the Network tab.  If you first opened the panel for developers, then opened the site - in this tab there will be information.  If another sequence, then the tab will be empty, press F5 to rediscover the page. </li><li>  In the line Filter we write <a href="http://www.google-analytics.com/collect">www.google-analytics.com/collect</a> </li><li>  Open the details of the request. </li></ol><br>  You will see similar information: <br><br>  <u>Request URL:</u> <br><br><pre> <code class="hljs perl">https:<span class="hljs-regexp"><span class="hljs-regexp">//www</span></span>.google-analytics.com/collect?v=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;_v=j5<span class="hljs-number"><span class="hljs-number">0</span></span>&amp;a=<span class="hljs-number"><span class="hljs-number">643761009</span></span>&amp;t=pageview&amp;_s=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;dl=https%3A%2F%2Fhabrahabr.ru%2F&amp;ul=en-us&amp;de=UTF-<span class="hljs-number"><span class="hljs-number">8</span></span>&amp;dt=%D0%9B%D1%83%D1%87%D1%88%D0%B8%D0%B5%20%D0%BF%D1%83%D0%B1%D0%BB%D0%B8%D0%BA%D0%B0%D1%86%D0%B8%D0%B8%20%D0%B7%D0%B0%20%D1%81%D1%83%D1%82%D0%BA%D0%B8%20%2F%20%D0%A5%D0%B0%D0%B1%D1%80%D0%B0%D1%85%D0%B0%D0%B1%D1%80&amp;sd=<span class="hljs-number"><span class="hljs-number">24</span></span>-bit&amp;sr=<span class="hljs-number"><span class="hljs-number">1920</span></span>x108<span class="hljs-number"><span class="hljs-number">0</span></span>&amp;vp=<span class="hljs-number"><span class="hljs-number">1109</span></span>x966&amp;je=<span class="hljs-number"><span class="hljs-number">0</span></span>&amp;fl=<span class="hljs-number"><span class="hljs-number">25.0</span></span>%20r0&amp;_u=QCCAgEAB~&amp;jid=<span class="hljs-number"><span class="hljs-number">1630561303</span></span>&amp;cid=<span class="hljs-number"><span class="hljs-number">774042187.1492148509</span></span>&amp;tid=UA-<span class="hljs-number"><span class="hljs-number">726094</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;cd1=guest&amp;cd4=<span class="hljs-keyword"><span class="hljs-keyword">no</span></span>&amp;cd5=other&amp;z=<span class="hljs-number"><span class="hljs-number">1998272259</span></span></code> </pre> <br>  <u>Query String Parameters</u> <br><br><pre> <code class="hljs pgsql">v:<span class="hljs-number"><span class="hljs-number">1</span></span> _v:j50 a:<span class="hljs-number"><span class="hljs-number">643761009</span></span> t:pageview _s:<span class="hljs-number"><span class="hljs-number">1</span></span> dl:https://habrahabr.ru/ ul:en-us de:UTF<span class="hljs-number"><span class="hljs-number">-8</span></span> dt:    /  sd:<span class="hljs-number"><span class="hljs-number">24</span></span>-<span class="hljs-type"><span class="hljs-type">bit</span></span> sr:<span class="hljs-number"><span class="hljs-number">1920</span></span>x1080 vp:<span class="hljs-number"><span class="hljs-number">1109</span></span>x966 je:<span class="hljs-number"><span class="hljs-number">0</span></span> fl:<span class="hljs-number"><span class="hljs-number">25.0</span></span> r0 _u:QCCAgEAB~ jid:<span class="hljs-number"><span class="hljs-number">1630561303</span></span> cid:<span class="hljs-number"><span class="hljs-number">774042187.1492148509</span></span> tid:UA<span class="hljs-number"><span class="hljs-number">-726094</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span> cd1:guest cd4:<span class="hljs-keyword"><span class="hljs-keyword">no</span></span> cd5:other z:<span class="hljs-number"><span class="hljs-number">1998272259</span></span></code> </pre> <br>  <u>What do we see here?</u> <br><br>  A number of parameters that were sent to GA.  This is a standard page view.  A description of each of the parameters, see the <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters">official documentation</a> . <br><br><h3>  CRM Integration </h3><br>  We are faced with the situation that the Goal Conversion Rate does not provide a complete picture of the quality of traffic sources. <br><br>  One of the goals on our site is an application for a free introductory lesson.  There are cases when the user does not understand what they are talking about, but still fills out a form.  Naturally, all applications fall into the CRM and load our sales department. <br><br>  In GA, any successfully completed form = conversion, so even non-targeted applications will spin the conversion counter. <br><br>  In order to assess in more detail the quality of each of the traffic channels, we decided to enter additional parameters: Target application and an introductory lesson. <br><br>  These two parameters we can determine by the status of the transaction in CRM. <br><br>  Since our CRM is able to send Webhook to our server when changing the status of the transaction, we have configured: <br><br><ul><li>  When the transaction enters the ‚ÄúAssigned introductory‚Äù status - send the event ‚ÄúTarget order‚Äù (for example, ec = Quality &amp; ea = Good_lead) </li><li>  When the transaction goes to the Introduced status - send the ‚ÄúIntroductory completed‚Äù event (for example, ec = Quality &amp; ea = 1Lesson_done) </li></ul><br>  For each of the events set up tracking goals.  As a result, got the opportunity to estimate the number of targeted applications. <br><br><h3>  Transaction tracking </h3><br>  We decided to consider not just billing, but directly the facts of receipt of money to the account of the payment acceptance system. <br><br>  Quite often this is a postponed event: we decided to pay via bank transfer or payment terminal.  Also as an example can be ‚ÄúCash payment to the courier‚Äù. <br><br>  When the payment acceptance system reported receipt of funds, we send the Transaction to Google Analytics: <br><br><pre> <code class="hljs cs">v=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;tid=UA<span class="hljs-number"><span class="hljs-number">-12345678</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>&amp;cid=<span class="hljs-number"><span class="hljs-number">455045511.1409504244</span></span>&amp;uid=<span class="hljs-number"><span class="hljs-number">12345</span></span>&amp;t=<span class="hljs-keyword"><span class="hljs-keyword">event</span></span>&amp;tr=<span class="hljs-number"><span class="hljs-number">225</span></span>&amp;pa=Transaction&amp;ec=Oplata&amp;ea=Individ&amp;ev=<span class="hljs-number"><span class="hljs-number">225</span></span>&amp;ni=<span class="hljs-number"><span class="hljs-number">1</span></span>&amp;pr1id=<span class="hljs-number"><span class="hljs-number">12345</span></span>_individual_id&amp;pr1nm=Individ&amp;pr1pr=<span class="hljs-number"><span class="hljs-number">225</span></span>&amp;pr1qt=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><h3>  Return or partial refund </h3><br>  For more accurate statistics in GA, it is possible to issue returns (cancel transactions). <br>  Since we have a very rare case, we have not automated it. <br><br>  Example from official documentation: <br><br><pre> <code class="hljs sql"> // Refund an entire transaction and send <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> a non-interaction event. v=<span class="hljs-number"><span class="hljs-number">1</span></span> // Version. &amp;tid=UA-XXXXX-Y // <span class="hljs-keyword"><span class="hljs-keyword">Tracking</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> / Property ID. &amp;cid=<span class="hljs-number"><span class="hljs-number">555</span></span> // Anonymous <span class="hljs-keyword"><span class="hljs-keyword">Client</span></span> ID. &amp;t=<span class="hljs-keyword"><span class="hljs-keyword">event</span></span> // <span class="hljs-keyword"><span class="hljs-keyword">Event</span></span> hit type. &amp;ec=Ecommerce // <span class="hljs-keyword"><span class="hljs-keyword">Event</span></span> Category. Required. &amp;ea=Refund // <span class="hljs-keyword"><span class="hljs-keyword">Event</span></span> Action. Required. &amp;ni=<span class="hljs-number"><span class="hljs-number">1</span></span> // Non-interaction parameter. &amp;ti=T12345 // <span class="hljs-keyword"><span class="hljs-keyword">Transaction</span></span> ID. Required. &amp;pa=refund // Product <span class="hljs-keyword"><span class="hljs-keyword">action</span></span> (refund). Required.</code> </pre> <br>  More information on the link: <br><br>  <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/devguide">developers.google.com/analytics/devguides/collection/protocol/v1/devguide#enhancedecom</a> <br><br><h3>  Offline points of sale </h3><br>  <b>Attendance</b> <br>  There are counters of store visitors (offline) with the ability to send information to the web.  Using the Measurement Protocol, you can use this information in Google Analytics.  By submitting Pageview to GA, you can track how your marketing activities affect the attendance of offline points. <br><br>  <b>Transactions</b> <br>  All payments can also be sent to GA, and here you can already use UserID. <br>  In the future, you will be able to segment users who make purchases offline, and who - via the Internet. <br>  Marketers will tell you Thank you. <br><br><h3>  Opening letters </h3><br><br>  Since the Measurement Protocol can work through GET requests, nothing prevents you from adding a picture to the list: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äùhttps://www.google-analytics.com/collect?v</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1&amp;tid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">UA-123456-1&amp;cid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1482535147.1490885188&amp;uid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">12345&amp;t</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">event&amp;ec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">email&amp;ea</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">open&amp;dp</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">%2Fletter_name&amp;z</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">12345‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Parameters z, uid and cid substitute depending on the user who leaves the letter. <br>  dp (Document Path) - to make it clear which letter was opened. <br><br><h2>  Additional resources </h2><br>  ‚Üí <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/reference">Official documentation</a> <br>  ‚Üí <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/parameters">Detailed description of the parameters</a> <br>  ‚Üí <a href="https://ga-dev-tools.appspot.com/hit-builder/">Service for checking the correctness of sent data</a> <br><br>  <b>Libraries:</b> <br>  PHP: <a href="https://github.com/theiconic/php-ga-measurement-protocol">github.com/theiconic/php-ga-measurement-protocol</a> <br>  Python: <a href="https://github.com/mirumee/google-measurement-protocol">github.com/mirumee/google-measurement-protocol</a> <br>  NodeJS: <a href="https://github.com/peaksandpies/universal-analytics">github.com/peaksandpies/universal-analytics</a> <br>  Ruby: <a href="https://github.com/tpitale/staccato">github.com/tpitale/staccato</a> <br><br><h2>  findings </h2><br>  The Measurement Protocol is quite a powerful tool that allows you to automate the uploading of any interactions to Google Analytics, which will help you for analytics in general and will be a great bonus for marketing activities. <br><br>  If you are also using the Measurement Protocol - write your cases in the comments! <br><br><h2>  Bonuses from EnglishDom for Habr's readers </h2><br>  <b>Online Courses</b> <br>  We give you access for a year to the English course for self-study "Online course". <br>  To access, simply <a href="https://www.englishdom.com/myprofile/purchases/habra412/%3Futm_medium%3Dblog%26utm_source%3Dhabrahabr">follow the link</a> . <br><br>  <b>Individually by Skype</b> <br>  Specialized course " <a href="https://www.englishdom.com/skype/courses/it/%3Futm_medium%3Dblog%26utm_source%3Dhabrahabr">English for IT-specialists</a> " <br>  Classes are held at any time convenient for you. <br>  Promo code for 15% discount: habra215 <br>  Valid until May 1st.  Enter it when paying or use the <a href="https://www.englishdom.com/myprofile/purchases/habra215/%3Futm_medium%3Dblog%26utm_source%3Dhabrahabr">link</a> . <br><br>  Among our students there are already students from Habr, GeekBrains, ITVDN, GoIT, BrainBasket, Softengi, Netology.  Join now! </div><p>Source: <a href="https://habr.com/ru/post/326788/">https://habr.com/ru/post/326788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326778/index.html">Four years to Djinn, anonymous job search service</a></li>
<li><a href="../326780/index.html">SAP BUILD - user interface building tool</a></li>
<li><a href="../326782/index.html">Creating a Tinkoff Design System. The first steps</a></li>
<li><a href="../326784/index.html">What famous companies use Docker in production and for what?</a></li>
<li><a href="../326786/index.html">Do not believe the navigator: GPS and GLONASS vulnerabilities</a></li>
<li><a href="../326790/index.html">About safety, nuclear physics and love: about the contradictions of modern IT architecture of front-end solutions</a></li>
<li><a href="../326792/index.html">Online Ticket Act: Let's Put A Point? Electronic money and aggregators</a></li>
<li><a href="../326794/index.html">ESP8266 as MQTT Broker for Mobile Application</a></li>
<li><a href="../326796/index.html">Fighting HTTPS traffic interception. Experience Yandex Browser</a></li>
<li><a href="../326798/index.html">Why should you go?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>