<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Internationalization of the local django project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Well, when developing a project under django, the project developers initially attended to its internationalization. 

 Minimal effort, the project ad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Internationalization of the local django project</h1><div class="post__text post__text-html js-mediator-article">  Well, when developing a project under django, the project developers initially attended to its internationalization. <br><br>  Minimal effort, the project adapts to different languages.  Django has a rich set of tools, enough for almost automatically adding new languages, correcting and adding translations of individual sections of text, and so on. <br><br>  The situation looks quite different if the project was not originally intended for internationalization.  A huge array of files in which local lines are scattered in utter confusion, with many of them duplicated in different files.  Collecting all these lines in one file, sorting, replacing their contents in the source files with message identifiers is a great and ungrateful job. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Having met this task, I realized that by performing it manually, I would die of boredom, if before that I did not vomit.  At the same time, I was surprised to find that there are still no tools that would facilitate my life at least by half.  Four days of work - and the <a href="https://github.com/nnseva/django-make-i18n">django-make-i18n</a> project was born, which I present to you. <br><br>  All the work is done by one fairly lengthy python script.  In addition to the python (I have 2.7), the script itself depends only on polib and does not require the presence of the django environment. <br><br>  By launching the script for the first time and launching it on the project directory, you get a stub file django.po, which collected all the detected lines in the local (by default - Russian) language.  The captured lines are placed in msgstr sections, and msgid is filled with the initial value ‚ÄúNEEDS TO BE EDITED [nnn]‚Äù. <br><br>  The source files are not changed, instead a parallel one is created next to the source project, with the extension .i18n added to the directory name. <br><br>  Next, you have to go through the django.po file and perform a ‚Äúreverse translation‚Äù, that is, replace the initial msgid values ‚Äã‚Äãwith some intelligible equivalent in English.  It is only necessary to ensure that all the lines of msgid values ‚Äã‚Äãremain unique. <br><br>  The second run of the script analyzes the django.po file and performs substitution of calls to the translation subsystem instead of the original local strings.  For example, suppose you have a views.py file in which the following code is placed: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> request.method == <span class="hljs-string"><span class="hljs-string">'POST'</span></span>: <span class="hljs-comment"><span class="hljs-comment"># If the form has been submitted... post = True logging.info('POST  ') request_form = RequestVideoForm(request.POST) if request_form.is_valid(): # All validation rules pass logging.info(' ') ok = True send_request(request,request_form,request.region.urlname,'feedback@doroga.tv') message = u'   ' request_form = None # clean form else: message = u'   '</span></span></code> </pre> <br><br>  After the first run of the script, the following lines will appear in django.po like this: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">msgid</span></span> <span class="hljs-string"><span class="hljs-string">"NEEDS TO BE EDITED [333]"</span></span> msgstr <span class="hljs-string"><span class="hljs-string">"POST  "</span></span> msgid <span class="hljs-string"><span class="hljs-string">"NEEDS TO BE EDITED [334]"</span></span> msgstr <span class="hljs-string"><span class="hljs-string">" "</span></span> msgid <span class="hljs-string"><span class="hljs-string">"NEEDS TO BE EDITED [335]"</span></span> msgstr <span class="hljs-string"><span class="hljs-string">"   "</span></span> msgid <span class="hljs-string"><span class="hljs-string">"NEEDS TO BE EDITED [336]"</span></span> msgstr <span class="hljs-string"><span class="hljs-string">"   "</span></span></code> </pre><br><br>  If you do not change anything in the django.po file, then after the second run of the script, a copy of the views.py file will be created, containing approximately the following lines: <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> request.method == <span class="hljs-string"><span class="hljs-string">'POST'</span></span>: <span class="hljs-comment"><span class="hljs-comment"># If the form has been submitted... post = True logging.info(_('NEEDS TO BE EDITED [333]')) request_form = RequestVideoForm(request.POST) if request_form.is_valid(): # All validation rules pass logging.info(_('NEEDS TO BE EDITED [334]')) ok = True send_request(request,request_form,request.region.urlname,'feedback@doroga.tv') message = _('NEEDS TO BE EDITED [335]') request_form = None # clean form else: message = _('NEEDS TO BE EDITED [336]') else: logging.info(_('NEEDS TO BE EDITED [337]')) request_form = RequestVideoForm(auto_id=True)</span></span></code> </pre><br><br>  Let's try to fill in the lines in django.po as follows: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">msgid</span></span> <span class="hljs-string"><span class="hljs-string">"POST request has been found"</span></span> msgstr <span class="hljs-string"><span class="hljs-string">"POST  "</span></span> msgid <span class="hljs-string"><span class="hljs-string">"Form is valid"</span></span> msgstr <span class="hljs-string"><span class="hljs-string">" "</span></span> msgid <span class="hljs-string"><span class="hljs-string">"Your request has just been sent"</span></span> msgstr <span class="hljs-string"><span class="hljs-string">"   "</span></span> msgid <span class="hljs-string"><span class="hljs-string">"Fix form data"</span></span> msgstr <span class="hljs-string"><span class="hljs-string">"   "</span></span></code> </pre><br><br>  Run the script again - and we get a quite tolerable code of the following form: <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> request.method == <span class="hljs-string"><span class="hljs-string">'POST'</span></span>: <span class="hljs-comment"><span class="hljs-comment"># If the form has been submitted... post = True logging.info(_('POST request has been found')) request_form = RequestVideoForm(request.POST) if request_form.is_valid(): # All validation rules pass logging.info(_('Form is valid')) ok = True send_request(request,request_form,request.region.urlname,'feedback@doroga.tv') message = _('Your request has just been sent') request_form = None # clean form else: message = _('Fix form data')</span></span></code> </pre><br><br>  Additionally, the script adds the internationalization package import code to the beginning of the file: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> django.utils.translation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ugettext <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> _</code> </pre><br><br>  in case you accidentally forgot to do it. <br><br>  The same operations, taking into account the specifics of the language and the use of django, are performed on the html and js files.  This creates a djangojs.po file for JavaScript. <br><br>  It remains to compile the messages: <br><br><pre> <code class="bash hljs">python manage.py compilemessages --all</code> </pre><br><br>  Voila - your project is prepared for internationalization.  Of course, there are still all sorts of details of the very internationalization under django, but they are beyond the scope of this article. </div><p>Source: <a href="https://habr.com/ru/post/156879/">https://habr.com/ru/post/156879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../156865/index.html">Light your star</a></li>
<li><a href="../156867/index.html">Maven: Access to repositories with custom directory structure</a></li>
<li><a href="../156869/index.html">Microsoft in social networks</a></li>
<li><a href="../156873/index.html">Animated tag cloud on css3</a></li>
<li><a href="../156875/index.html">Meet the IntelliCommand (Visual Studio 2010/2012 extension)</a></li>
<li><a href="../156887/index.html">QEMU on FreeBSD-9.0-RELEASE-amd64</a></li>
<li><a href="../156889/index.html">Installing LivestreetCMS on MODX Revolution from the package in 10 clicks</a></li>
<li><a href="../156891/index.html">About the arbitration court, EDS and international jurisdiction</a></li>
<li><a href="../156893/index.html">German copyright holders worried about analog hole</a></li>
<li><a href="../156895/index.html">The first experience in the study of malware under Microsoft Windows</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>