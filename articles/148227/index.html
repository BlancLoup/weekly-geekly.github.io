<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Portable Components, software development tools</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing my previous article on the POCO ( Portable Components ) library, I would like to talk about the POCO Application snap-in and its derivative...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Portable Components, software development tools</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/storage2/9df/4f6/30d/9df4f630dbc826ab1192248dc731a7b7.jpg"><br>  Continuing my <a href="http://habrahabr.ru/post/148173">previous article</a> on the POCO ( <i>Portable Components</i> ) library, I would like to talk about the POCO Application snap-in and its derivatives such as ServerApplication and ConsoleApplication. <br>  The <i>Application</i> snap-in is designed to simplify software development and, as a rule, save time.  Using this snap-in, we can create console applications, Windows services and UNIX daemons in minutes. <br><br><a name="habracut"></a><br><h4>  Description </h4><br>  Derivatives from <i>Application</i> are divided into 2 groups: <i>console and server</i> . <br>  Equipment includes such things that the application needs, such as: <br><ul><li>  Working with command line arguments at a high level.  There is also a system for checking parameters based on regular expressions and checking for integer values. </li><li>  Tools for creating <i>UNIX daemons</i> and <i>Windows services</i> . </li><li>  Work with loading configuration.  This item is important in modern software.  The configuration can be set to any behavior of the program, without recompiling the project completely.  Can download from files or from the <i>Windows</i> registry. </li><li>  Initialization and completion of the program.  The life of the program in the <i>POCO Application is</i> subject to the cycle: <b>Initialization - Execution of an applied task - Completion of work</b> .  This procedure allows us to arrange the application part in <i>Main</i> , and hide all minor things away. </li><li>  Means of logging.  It is not a secret for anyone that competent systems for collecting logs allow us to save time and sometimes even money.  POCO provides us with very powerful logging tools.  Logs can be sent to the console, to a file, to the Windows event log, to the SYSLOG server (for example, when the hard disk is the bottleneck of the system).  It is also possible to combine these methods, set an arbitrary recording format for each channel.  In general, a very powerful tool with which I will certainly introduce you. </li><li>  Creation of subsystems of the application, their design in the module and packaging in the dynamic library.  Very handy tool for creating a modular system in which modules can be replaced without recompiling the program. </li></ul><br><h3>  Practice </h3><br>  To create a program using this snap-in, you must inherit from <i>Poco :: Util :: Application</i> and overload the following methods: <br><ul><li><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Application&amp; self)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">// </span></span></span></span></code> </pre> </li><li><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uninitialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//  </span></span></span></span></code> </pre> </li><li><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reinitialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Application&amp; self)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">// </span></span></span></span></code> </pre> </li><li><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defineOptions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">// </span></span></span></span></code> </pre> </li><li><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleOption</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//   </span></span></span></span></code> </pre> </li><li><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;&amp; args)</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">//    </span></span></span></span></code> </pre> </li></ul><br><h6>  Application launch options </h6><br>  Application startup parameters in POCO are implemented using the Option class. <br>  Each parameter has the following properties: <br><ul><li>  Full name </li><li>  Short name </li><li>  Character name (1 character) </li><li>  Description </li></ul><br>  Parameters can be grouped and can be optional.  Validators can be attached to each parameter.  Two types of validators are predefined in POCO: IntValidator - checks numerical values, RegExpValidator - checks a parameter for consistency with a regular expression.  If the program is started with parameters that failed to validate, the program will return an error and show all possible options, which in turn are generated automatically.  You can ‚Äúhang‚Äù handler functions (callbacks) on the parameters, which will be called when these parameters are used during initialization. <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">myApp</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Application { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: myApp(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> argc, <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>** argv) : Application(argc,argv) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Application&amp; self)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">""</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; loadConfiguration(); <span class="hljs-comment"><span class="hljs-comment">//    Application::initialize(self); } void reinitialize() { cout &lt;&lt; "" &lt;&lt; endl; Application::uninitialize(); } void uninitialize(Application&amp; self) { cout &lt;&lt; "" &lt;&lt; endl; Application::reinitialize(self); } void HelpHim(const std::string&amp; name, const std::string&amp; value) { cout &lt;&lt; "  -   " &lt;&lt; endl; } void Configure(const std::string&amp; name, const std::string&amp; value) { cout &lt;&lt; "     " &lt;&lt; endl; } void defineOptions(OptionSet&amp; options) { cout &lt;&lt; " " &lt;&lt; endl; Application::defineOptions(options); options.addOption( Option("help", "h", " . ") .required(false) //  .repeatable(false) //  //myApp::handleOption - -  .callback(OptionCallback&lt;myApp&gt;(this, &amp;myApp::handleOption))); options.addOption( Option("config-file", "f", "   ") .required(false) .repeatable(true) .argument("file") .callback(OptionCallback&lt;myApp&gt;(this, &amp;myApp::Configure))); options.addOption( Option("bind", "b", "  =") .required(false) //  -   .argument("value") // ,  ,       [0; 100] .validator(new IntValidator(0, 100)) .binding("test.property")); //     } int main(const std::vector&lt;std::string&gt;&amp; args) { cout &lt;&lt; " -" &lt;&lt; endl; } }; //  POCO_APP_MAIN   -  : // int wmain(int argc, wchar_t** argv) // { // myApp A(argc,argv); // return A.run(); // } POCO_APP_MAIN(myApp)</span></span></code> </pre><br><br><h6>  Tools for creating UNIX daemons and Windows services. </h6><br>  To create a server, it is sometimes necessary that its process be launched from another user (for example, from a system) and does not occupy resources from the latter.  Also, this function is useful for launching an application when the OS starts and did not depend on the user status.  The implementation of a service or daemon in POCO is reduced to inheritance from <i>Poco :: Util :: ServerApplication</i> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We implement a class of a task, which will be the logic of our server, for example, every second it will write to the log how much our program has completed: <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">myServerTask</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Task { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: myServerTask(): Task(<span class="hljs-string"><span class="hljs-string">"MyTask"</span></span>) <span class="hljs-comment"><span class="hljs-comment">//    "MyTask" { } //  void runTask() { Application&amp; app = Application::instance(); while (!isCancelled()) { //  sleep(1000); //    Application::instance().logger().information ("  " + DateTimeFormatter::format(app.uptime())); } } };</span></span></code> </pre><br>  Next, we implement the server directly: <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">myServer</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ServerApplication { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Application&amp; self)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  loadConfiguration(); // ServerApplication ServerApplication::initialize(self); //       logger().setChannel(AutoPtr&lt;FileChannel&gt;(new FileChannel("C:\\log.log"))); //    logger().information(""); } void uninitialize() { logger().information(""); // ServerApplication ServerApplication::uninitialize(); } int main(const std::vector&lt;std::string&gt;&amp; args) { if (!config().getBool("application.runAsDaemon") &amp;&amp; !config().getBool("application.runAsService")) { //     //       cout &lt;&lt; "   ,      " &lt;&lt; endl; } else { //        //  //   TaskManager tm; //     tm.start(new myServerTask); //     waitForTerminationRequest(); //     tm.cancelAll(); tm.joinAll(); } // return Application::EXIT_OK; } }; //  POCO_SERVER_MAIN(myServer)</span></span></code> </pre><br><br>  Everything, service and demon are written. <br>  Now compile and register the Windows service with the following keys: <br><ul><li>  To register a Windows service: <b>/ registerService</b> </li><li>  To turn off the Windows service: <b>/ unregisterService</b> </li><li>  To change the Windows service name: <b>/ displayName "Name"</b> </li></ul><br><br>  The application is launched and terminated as follows: <br><ul><li>  To run the Unix daemon: <b>--daemon</b> </li><li>  To start the Windows service, do the following in the command line: <b>net start &lt;Application&gt;</b> </li><li>  To complete the <b>killall &lt;Application&gt;</b> </li><li>  To complete the <b>net stop</b> service <b>&lt;Application&gt;</b> </li></ul><br><br><h6>  Loading configuration </h6><br>  Configuration loaded method: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadConfiguration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&amp; path, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> priority = PRIO_DEFAULT)</span></span></span></span>;</code> </pre> <br>  File type is determined by the extension: <br><ul><li>  .properties - Properties file (PropertyFileConfiguration) </li><li>  .ini - Initialization file (IniFileConfiguration) </li><li>  .xml - XML ‚Äã‚Äãfile (XMLConfiguration) </li></ul><br>  Once the data is loaded you can use it.  In POCO, the data model is a tree in which access to each element is specified by a string. <br>  For example XML: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">recipe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">preptime</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cooktime</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"180"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">composition</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ingredient</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">unit</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ingredient</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ingredient</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.25"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">unit</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ingredient</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ingredient</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">unit</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ingredient</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ingredient</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">unit</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" "</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ingredient</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">composition</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">instructions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">step</span></span></span><span class="hljs-tag">&gt;</span></span>     .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">step</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">step</span></span></span><span class="hljs-tag">&gt;</span></span>         .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">step</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- &lt;step&gt;  .&lt;/step&gt; -   ... --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">step</span></span></span><span class="hljs-tag">&gt;</span></span>  ,       .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">step</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">instructions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">recipe</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Ship as follows: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Application&amp; self)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-function">ofstream </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"out.txt"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">""</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; loadConfiguration(<span class="hljs-string"><span class="hljs-string">"a:\\conf.xml"</span></span>); file &lt;&lt; <span class="hljs-string"><span class="hljs-string">" : "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"title"</span></span>) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">"   : "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[0]"</span></span>) &lt;&lt; <span class="hljs-string"><span class="hljs-string">" : "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[0][@amount]"</span></span>) &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[0][@unit]"</span></span>) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[1]"</span></span>) &lt;&lt; <span class="hljs-string"><span class="hljs-string">" : "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[1][@amount]"</span></span>) &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[1][@unit]"</span></span>) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[2]"</span></span>) &lt;&lt; <span class="hljs-string"><span class="hljs-string">" : "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[2][@amount]"</span></span>) &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[2][@unit]"</span></span>) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[3]"</span></span>) &lt;&lt; <span class="hljs-string"><span class="hljs-string">" : "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[3][@amount]"</span></span>) &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"composition.ingredient[3][@unit]"</span></span>) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span> &lt;&lt; <span class="hljs-string"><span class="hljs-string">" : "</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"instructions.step[0]"</span></span>) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"instructions.step[1]"</span></span>) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span> &lt;&lt; config().getString(<span class="hljs-string"><span class="hljs-string">"instructions.step[2]"</span></span>) &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> timeToCook = config().getInt(<span class="hljs-string"><span class="hljs-string">"[@cooktime]"</span></span>); file &lt;&lt; <span class="hljs-string"><span class="hljs-string">"  : "</span></span> &lt;&lt; timeToCook &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; file.close(); }</code> </pre><br>  The result is: <br><blockquote>  We cook: Simple bread <br>  For this we need: Flour: 3 glass <br>  Yeast: 0.25 grams <br>  Warm water: 1.5 glass <br>  Salt: 1 tsp. <br>  Perform the steps: <br>  Mix all ingredients and knead thoroughly. <br>  Cover with a cloth and leave for one hour in a warm room. <br>  Knead again, put on a baking sheet and put in the oven. <br>  Cooking time: 180 <br></blockquote><br>  Similarly, you can parse and INI.  Accordingly, there will always be an identifier of the form "category.key". <br>  for example <br><pre> <code class="hljs vhdl">;INI-<span class="hljs-keyword"><span class="hljs-keyword">File</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">Group</span></span>] ValueText = <span class="hljs-string"><span class="hljs-string">"hello world"</span></span> IntValue = <span class="hljs-number"><span class="hljs-number">123</span></span></code> </pre><br>  Ship as follows: <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> text = config().getString(<span class="hljs-string"><span class="hljs-string">"Group.ValueText"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// text == "Hello world" int value = config().getInt("Group.IntValue"); // value == 123</span></span></code> </pre><br>  The .property files have the name of the variable itself in the file. <br><blockquote>  ; Java property file <br>  Value.Text = "hello world" <br>  Int.Value = 123 <br></blockquote><br>  Ship as follows: <br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> text = config().getString(<span class="hljs-string"><span class="hljs-string">"Value.Text"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// text == "Hello world" int value = config().getInt("Int.Value"); // value == 123</span></span></code> </pre><br><br><h6>  Logging tools </h6><br>  Logging tools consist of four main parts: <br><ul><li>  Logger </li><li>  Channel </li><li>  Data storage object (file, database) </li><li>  Formatter </li></ul><br>  <b>Logger</b> is a link in the given chain that is accessed by our application to send data to the log.  The unit of the logging process is the message. <br>  The message is an object that has: <br><ul><li>  Data source (preselected text value) </li><li>  Data - a string that carries useful information about the event. </li><li>  Timestamp </li><li>  Message priority </li><li>  Process IDs (PID) and Flow (TID) </li><li>  Some optional parameters </li></ul><br>  Priorities are set in the following sequence (from low to high): <br><ul><li>  Trace Information (Trace) </li><li>  Debug Information (Debug) </li><li>  Technical Information (Information) </li><li>  Reminder (Notice) </li><li>  Warning </li><li>  Error (Error) </li><li>  Critical error </li><li>  Fatal error (Fatal) </li></ul><br>  The data is represented by a string, but other data can be encoded into it.  A time stamp is created with an accuracy of a microsecond. <br><br>  <b>The channel</b> is the link between the logger and the storage object. <br>  There are several base channels: <br><ul><li>  ConsoleChannel - as it is not difficult to guess, this is a channel that outputs data to the standard output stream STDOUT </li><li>  WindowsConsoleChannel - a Windows-specific console channel that outputs data to std :: clog </li><li>  NullChannel - discards all data </li><li>  SimpleFileChannel - a simple channel for output to a file, with each new message on a new line.  It has a max file size.  Able to use a secondary file to store data when the primary exceeds the maximum size. </li><li>  FileChannel - all-wheel drive file channel.  Supports archiving, time zones, compression, the maximum lifetime of the log. </li><li>  EventLogChannel is a Windows-specific data channel that allows you to display messages in the Windows system event log. </li><li>  SyslogChannel is the channel that sends messages to the syslog daemon server. </li><li>  AsyncChannel is a bridge that allows you to send messages to any channel asynchronously. </li><li>  SplitterChannel - a channel that allows you to send one message to multiple channels </li></ul><br><br>  Example of using the logger: <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  AutoPtr&lt;ConsoleChannel&gt; console(new ConsoleChannel); //  AutoPtr&lt;PatternFormatter&gt; formater(new PatternFormatter); formater-&gt;setProperty("pattern", "%Y-%m-%d %H:%M:%S %s: %t"); //  AutoPtr&lt;FormattingChannel&gt; formatingChannel(new FormattingChannel(formater, console)); //  Logger::root().setChannel(formatingChannel); //   Logger::get("Console").information("  "); //      AutoPtr&lt;FormattingChannel&gt; file(new FormattingChannel(formater, AutoPtr&lt;FileChannel&gt;(new FileChannel("A:\\123.txt")))); //  Logger::create("File", file); //  Logger::get("File").fatal("I want to play a game.    "); //   AutoPtr&lt;SplitterChannel&gt; splitter(new SplitterChannel); //       splitter-&gt;addChannel(file); splitter-&gt;addChannel(console); //    Logger::create("AllChannel", file); //    Logger::get("AllChannel").fatal("    "); //    AutoPtr&lt;EventLogChannel&gt; event(new EventLogChannel); //  Logger::create("Event", event); //     (  Windows) Logger::get("Event").fatal("   ");</span></span></code> </pre><br><br><h6>  We make classes in separate modules </h6><br>  In POCO, the basic concept is modularity at any cost, and such modularity at runtime can be achieved with a good tool ‚Äî the class loader (ClassLoader), which allows loading from dynamic libraries. <br>  Implement an abstract class for sorting an array. <br>  To export, you need to implement a default constructor and a virtual destructor in the base class, as well as create a pure virtual method <i>virtual string name () const = 0;</i>  and in the heir class to implement it. <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// sort.h class ABaseSort { protected: vector&lt;int&gt; array; //   public: ABaseSort () {} // - virtual ~ABaseSort() {} // virtual string name() const = 0; //  name ,    //    virtual void sort() = 0; //  - void loadVector(vector&lt;int&gt;&amp; lArray) { array.assign(lArray.begin(), lArray.end()); } vector&lt;int&gt; getArray() { return array; } //Xor-swap static void swap(int &amp;A, int &amp;B) { A ^= B ^= A ^= B; } };</span></span></code> </pre><br>  Next, create 2 sorting classes: using the bubble method and the standard STL method (stable_sort) <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    // sort.cpp #include "sort.h" class bubbleSort : public ABaseSort { public: //   string name() const { return "Bubble Sort"; } //     void sort() { size_t size = array.size(); for (int i=0; i&lt;size-1; ++i) for (int j=i; j&lt;size; ++j) if (array[i] &gt; array[j]) swap(array[i],array[j]); } }; //   STL (std::stable_sort) class stableSort : public ABaseSort { public: //   string name() const { return "Stable Sort"; } //     void sort() { stable_sort(array.begin(), array.end()); } };</span></span></code> </pre><br>  It remains to add export options <br><pre> <code class="cpp hljs">POCO_BEGIN_MANIFEST(ABaseSort) <span class="hljs-comment"><span class="hljs-comment">//   POCO_EXPORT_CLASS(bubbleSort) //     POCO_EXPORT_CLASS(stableSort) //    stable_sort POCO_END_MANIFEST</span></span></code> </pre><br>  We compile the project as a dynamic library. <br>  And now let's use our classes. <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// logic.cpp #include "sort.h" //     ABaseSort Poco::ClassLoader&lt;ABaseSort&gt; loader; loader.loadLibrary("myImportedFile.dll"); //   if (loader.isLibraryLoaded("myImportedFile.dll")) { //    cout &lt;&lt; "   : " &lt;&lt; endl; for (auto it = loader.begin(); it != loader.end(); ++it) { cout &lt;&lt; "  '" &lt;&lt; it-&gt;first &lt;&lt; "': " &lt;&lt; endl; for (auto jt = it-&gt;second-&gt;begin(); jt != it-&gt;second-&gt;end(); ++jt) { cout &lt;&lt; jt-&gt;name() &lt;&lt; endl; } } //  int arr[13] = {32,41,23,20,52,67,52,34,2,5,23,52,3}; vector&lt;int&gt; A (arr,arr+13); //   if (ABaseSort *sort = loader.create("bubbleSort")) { //    sort-&gt;loadVector(A); // sort-&gt;sort(); //  auto vect = sort-&gt;getArray(); // for (auto it = vect.begin(); it != vect.end(); ++it) cout &lt;&lt; *it &lt;&lt; " "; cout &lt;&lt; endl; //    loader.classFor("bubbleSort").autoDelete(sort); } //     stableSort if (ABaseSort *sort = loader.create("stableSort")) { sort-&gt;loadVector(A); sort-&gt;sort(); auto vect = sort-&gt;getArray(); for (auto it = vect.begin(); it != vect.end(); ++it) cout &lt;&lt; *it &lt;&lt; " "; cout &lt;&lt; endl; loader.classFor("stableSort").autoDelete(sort); } }</span></span></code> </pre><br>  Thus, we can change the logic of the program, without recompiling it completely.  It is enough to recompile its individual modules and ‚Äúfeed‚Äù them to the program. <br><br><h3>  Conclusion </h3><br>  The above examples show some features of the development using the POCO library.  You may notice that creating an application or service on a POCO is not a hard work.  In the future, I would like to tell you in detail about the modules XML, ZIP, Data, Net.  More in detail will stop on creation of high-performance servers on POCO.  Disassemble the notification and event system (Notifications &amp; Events), the caching system and the cryptography module. <br><br>  <b>Thank you for reading the article.</b>  <b>Reasoned criticism and suggestions are welcome.</b> </div><p>Source: <a href="https://habr.com/ru/post/148227/">https://habr.com/ru/post/148227/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148218/index.html">Resizing a widget in Android 4.1 Jelly Bean</a></li>
<li><a href="../148219/index.html">Firebug 1.10 - new features</a></li>
<li><a href="../148221/index.html">Would you like your soulmate to work with you?</a></li>
<li><a href="../148224/index.html">Responsive Web Design vs. Responsive web design, what's the difference?</a></li>
<li><a href="../148225/index.html">Black Duck Team Launches Updated Open Source Search Engine</a></li>
<li><a href="../148228/index.html">Facebook offered advertisements in search results</a></li>
<li><a href="../148229/index.html">Night view from the international space station</a></li>
<li><a href="../148231/index.html">Simple-Science - Simple Experiments (Digest # 9)</a></li>
<li><a href="../148233/index.html">Library of Congress continues to attempt to archive all tweets from 2006-2012</a></li>
<li><a href="../148234/index.html">Salary for show</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>