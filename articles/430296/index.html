<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Make your ideas come app. Serverless application - step by step instructions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In 2018, serverless is the fastest way to make backend applications, even if you have never done them. Yes, I know about countless application constru...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Make your ideas come app. Serverless application - step by step instructions</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/y6/ow/ec/y6oweczabj_yovxgms6829zzsno.png"><br><br>  In 2018, serverless is the fastest way to make backend applications, even if you have never done them.  Yes, I know about countless application constructors, MBaaS or BaaS, but I want to show that serverless is suitable not only for elementary applications, but also for scalable compound backends that cannot be done on the designer. <br><a name="habracut"></a><br>  The other day we launched the <a href="https://www.rusonyx.ru/swifty/index.html">first serverless cloud in Russia - Rusonyx Serverless</a> based on the <a href="https://swifty.cloud/">Swifty</a> platform.  The first three months of using the platform are free, so that everyone can try a serverless approach to business. <br><br>  In the article I will tell you how to create a simple todo application with authentication, user profile, image storage and, in fact, task management using the serverless approach.  We will naturally do this on Swifty, but the approach here is about the same for all serverless solutions.  An example of the finished application can be found <a href="http://todoapp.5b34d6cfb95703000125cfde.s3.swifty.cloud/">here</a> .  The frontend is written in vue.js, which we will run on the built-in Object Storage (S3), we will do backend on functions on Go and Python. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You do not need knowledge of JavaScript, Goshechka and Python to pass this guide.  Source code of the application can be found <a href="https://github.com/swiftycloud/swifty.todoapp">here</a> . <br><br><h3>  <font color="#cc0000">User Authentication</font> </h3><br>  At the first stage, we will create the functions themselves for the backend of the application.  First of all, you need an account in Swifty, which you can create <a href="https://www.rusonyx.ru/swifty/index.html">here</a> .  After logging into the dashboard you should open such a screen. <br><br><img src="https://habrastorage.org/webt/bb/sd/gu/bbsdgudmhebk0prnocq16uyqzli.png"><br><br>  Now that you have an account, you can start creating the functions themselves.  Swifty includes an authentication service ‚Äî Authentication, which provides basic signup, signin, and logout operations, as well as the ability to create, modify, retrieve, and delete a user profile.  It also has Facebook integration and the ability to associate an already created profile with a Facebook profile.  But we will not need them yet.  Maybe later. <br><br>  <b>Create an authentication service</b> : <br><br><ul><li>  Open Swifty -&gt; Authentication Services. </li><li>  Click Create Auth Database and call the base todoapp.  I will use this name in the future, but you can name your base as desired. </li></ul><br>  <b>As a result, a lot of things will be created</b> : <br><br><ol><li>  <i>Function todoapp.base</i> - makes signup, signin and logout users, implements the OAuth 2.0 protocol. </li><li>  <i>The todoapp.fb function</i> allows you to authenticate users via fb. </li><li>  <i>Function todoapp.link</i> - links accounts already created users with their accounts on fb. </li><li>  <i>The function todoapp.profiles</i> - creates, updates, deletes user profiles in MongoDB. </li><li>  <i>DB todoapp_mgo</i> - Mongo for storing user accounts. </li><li>  <i>DB todoapp_profiles</i> - Mongo for storing user profiles. </li><li>  <i>Authentication Middleware (AuthMW)</i> is a proxy that, when accessing the function API, verifies the user's authentication by checking its JWT token, which the todoapp.base function issued to it.  There is no token or it is not true - the request to the API will be dropped. </li></ol><br>  We use ‚Äú.‚Äù In the name of the functions to separate them into folders.  Therefore, if you create a new function with the name todoapp.newfunction, then it will automatically go to the todoapp folder and appear there with the name newfunction.  Your list of functions should now contain the following set (see picture). <br><br><img src="https://habrastorage.org/webt/g6/lm/j7/g6lmj7x-0kpguapjdznjmwyywme.png"><br><br><h3>  <font color="#cc0000">You can skip, but better to read</font> </h3><br>  This paragraph, in principle, can be skipped.  Or not, if you want to understand how our authentication service works and a little more to understand about the principles of Swifty.  The todoapp.base function, written in Go, provides basic authentication capabilities, but nothing prevents you from expanding its capabilities according to the needs of your application.  No matter how you change it, without touching signin and signout, it will still do its job.  The function has a variable SWIFTY_AUTH_NAME that stores the name AuthMW.  Functions also need access to MongoDB and AuthMW itself, which are listed on the Access tab in the function properties.  It also has a REST API trigger that has a link that you need to call to access the function. <br><br>  The todoapp.base function expects you to pass a userid and password to it as request arguments.  The password is encrypted. <br><br>  <b>Here are examples of such requests:</b> <br><br><pre><code class="plaintext hljs">* Sign up: https://api.swifty.cloud:8686/call/012.../signup&amp;userid=user@yourmail.com&amp;password=xxxxxxxx * Sign in: https://api.swifty.cloud:8686/call/012.../signin&amp;userid=user@yourmail.com&amp;password=xxxxxxxx * Log out: https://api.swifty.cloud:8686/call/012.../leave&amp;userid=user@yourmail.com</code> </pre> <br>  If, for example, signin was successful (the function successfully checked the transmitted password), then you will receive a JSON with a JWT token, which you will need to use every time you access functions with authentication enabled.  The JWT token is created based on the Bearer Authentication scheme.  You can read more about OAuth 2.0 and Bearer <a href="https://oauth.net/">here</a> . <br><br>  If the authentication is not successful, then the called function does not start and the request returns code 401. <br><br><h3>  <font color="#cc0000">User Profile Management</font> </h3><br>  So, each function has a REST API url, a link that needs to be called to start the function.  To get this link for the authentication function, open the todoapp.base function, go to the Triggers tab, copy the REST API url and save it as AUTH_URL somewhere.  A little further we will need to insert this link into the frontend configuration file of our application. <br><br><img src="https://habrastorage.org/webt/ms/8h/0u/ms8h0ul5mcvceacfwr8k8nfsrsq.png"><br><br>  We also need a URL API for todoapp.profiles so that our application can manage user profiles.  Open this function, go to the Triggers tab, copy the REST API url and save it as PROFILE_URL. <br><br><h3>  <font color="#cc0000">Manage user avatar</font> </h3><br>  Our application also allows you to load a user's avatar and demonstrate how you can store files in the built-in Object Storage.  The user's picture is loaded using a special function and stored on the built-in Object Storage.  Access to the picture can be obtained through a function or using a standard S3 API, access keys to which can be obtained on the Object Storage tab of the UI. <br><br>  <b>To create an image management function:</b> <br><br><ol><li>  Go to the Functions tab -&gt; New Function -&gt; From repo (Templates).  We store all the function templates in the public git repository swifty.demo.  This repository should be selected by default. </li><li>  Select the Avatar management (python) function, click Next and enter the name of the new function todoapp.avatar.  Click Create. </li><li>  Next, go to the Triggers tab, click Add Trigger, select REST API (URL).  Copy the link that appears and save it as PICTURE_URL. </li></ol><br>  Next you need to create a bake in Object Storage to store user pictures: <br><br><ol><li>  Go to the tab Object Storage -&gt; Create Bucket.  Name the new bucket todoappimages. </li><li>  Go to the Functions tab -&gt; todoapp.avatar -&gt; Access -&gt; click Add, select Object Storage, the newly created todoappimgaes batch and click Add. </li></ol><br>  Now our function has access to the specified batch.  So simple and we do not need to register any accesses to the bucket inside the function.  The only thing we need to specify the functions in which the bucket to store pictures using the environment variable: <br><br><ol><li>  Go to the Functions tab -&gt; todoapp.avatar -&gt; Variables and click Create Variable. </li><li>  Enter the variable name - BUCKET_NAME, and its value - todoappimages. </li></ol><br><h3>  <font color="#cc0000">Task Management</font> </h3><br>  Actually, we are making a task management application and it's time to finally make the appropriate function.  We have a template for it that allows you to create a task, mark it as completed and delete the task. <br><br>  <b>Create a function:</b> <br><br><ol><li>  Go to the Functions tab -&gt; New Function -&gt; From repo (Templates). </li><li>  Select the TODO application (python) function, click Next and enter the name of the new function todoapp.tasks.  Click Create. </li><li>  Next, go to the Triggers tab, click Add Trigger, select REST API (URL).  Copy the link that appears and save it as TASKS_URL. </li></ol><br>  Next we need a database to store our tasks.  The easiest option is MongoDB. <br><br><ol><li>  Go to the Mongo Database -&gt; Create Database tab and create a database named todoapp_tasks. </li><li>  Go to the Functions tab -&gt; todoapp.tasks -&gt; Access -&gt; Add and add a new database. </li></ol><br>  Now our function has access to the todoapp_tasks database and we can access it from a function using the swifty library, for example: <br><br> <code>db = swifty.MongoDatabase(os.getenv('TASKS_DB_NAME'))</code> <br> <br>  It only remains for us to register an environment variable with the name of the database: <br><br><ol><li>  Go to the Functions tab -&gt; todoapp.tasks -&gt; Variables and click Create Variable. </li><li>  Enter the variable name - TASKS_DB_NAME, and its value - todoapp_tasks. </li></ol><br><h3>  <font color="#cc0000">Enable authentication for functions.</font> </h3><br>  When we have a backend for authenticating users and the functions themselves that make up the backend of our application, we can enable authentication for them so that only authorized users can access the profile management functions, avatar and tasks. <br><br>  <b>How to enable verification of tokens for certain functions:</b> <br><br><ol><li>  Go to the Functions tab and select the functions todoapp.tasks and todoapp.avatar. </li><li>  Click Manage Authentication and select the todoapp service, click Enable. </li></ol><br>  Now, the functions todoapp.tasks and todoapp.avatar will only be executed for users with the correct JWT token generated by todoapp.base. <br><br>  After all the above actions, our list of functions should look something like this. <br><br><img src="https://habrastorage.org/webt/hw/37/hs/hw37hsabidgh0yiuc44qt1nyk20.png"><br><br><h3>  <font color="#cc0000">Application Publishing</font> </h3><br>  Let's take the front end of our application.  The frontend is written in vue.js and we just need to add links to our functions in its configuration file and rebuild the application with this updated configuration.  Everything is simple here and no knowledge of vue.js and JavaScript is needed. <br><br>  In order to rebuild the application you need an installed node.js.  If you do not have it, then please use the official <a href="https://nodejs.org/en/">guide</a> to put it.  If you have a mac, then there is a good guide <a href="http://blog.teamtreehouse.com/install-node-js-npm-mac">here</a> .  You will also need git to pull the repository onto your computer.  Please do: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># git clone https://github.com/swiftycloud/swifty.todoapp</span></span></code> </pre> <br>  After that, go to the <code>/swifty.todoapp/src</code> folder and open the <code>config.js</code> file in your favorite editor.  You need to change the variables contained there to those you saved earlier: <br><br> <code>export const AUTH_URL = "https://api.swifty.cloud/call/991..." <br> export const PROFILE_URL = "https://api.swifty.cloud/call/281..." <br> export const PICTURE_URL = "https://api.swifty.cloud/call/e6a..." <br> export const TASKS_URL = "https://api.swifty.cloud/call/4b1..."</code> <br> <br>  The variables associated with the FB we do not need. <br><br>  Then you need to rebuild the application: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># npm run build</span></span></code> </pre> <br>  ... <br>  DONE Build complete.  The dist directory is ready to be deployed. <br><br>  Before building the application you can also test it locally: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># npm run serve</span></span></code> </pre> <br>  and enter it through the browser at http: // localhost: 8080 <br><br>  We use Object Storage to store static files of our application.  Go to the Object Storage tab, create a todoapp baket and upload files from the <code>/swifty.todoapp/dist/</code> folder to <code>/swifty.todoapp/dist/</code> observing the naming of the folders (you will have to create them manually). <br><br>  The last step is to publish the application.  Click More -&gt; HTTP Server Settings and enable HTTP Server for your baket.  Copy the link that appears and click on it - this is your application! <br><br><img src="https://habrastorage.org/webt/qa/es/lx/qaeslxv7dqgcn9fzbdh4la88rde.png"><br><br>  Now you can create an account in it and try it in action.  If you now go to the functions screen, you will see that the functions have just been launched - for authentication, profile loading, and so on. <br><br><h3>  <font color="#cc0000">What's next?</font> </h3><br>  We showed a simple example of how to use serverless to create applications.  We still have a lot of templates of popular features, and you, I am sure, still have many ideas for new applications.  Try templates, write your own functions and make your ideas come app. <br><br>  And of course, contact us if you have any questions about serverless in general and Swifty in particular. <br><br>  Enjoy! </div><p>Source: <a href="https://habr.com/ru/post/430296/">https://habr.com/ru/post/430296/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../430284/index.html">The digest of interesting materials for the mobile # 275 developer (November 12 - 18)</a></li>
<li><a href="../430286/index.html">Details of the promiscuous and dark side of pirated games for the Nintendo Switch</a></li>
<li><a href="../430290/index.html">Attempt to predict the fourth iteration of the SpaceX BFR project</a></li>
<li><a href="../430292/index.html">Electronic Frontier Foundation: network performance of police car license scanners in the US - 0.5%</a></li>
<li><a href="../430294/index.html">10 unobvious benefits of using Rust</a></li>
<li><a href="../430300/index.html">Microservices on Go with the Go kit: Introduction</a></li>
<li><a href="../430302/index.html">Introduction to ptrace or code injection in sshd for fun</a></li>
<li><a href="../430304/index.html">Wonderful outpost in orbit</a></li>
<li><a href="../430306/index.html">Drilled the first tunnel Boring Company Ilona Mask</a></li>
<li><a href="../430308/index.html">Python internals. Easter eggs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>