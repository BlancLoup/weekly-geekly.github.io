<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>10+ tips on writing fast code in Mathematica</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translation of the post by John McLune (Jon McLoone) " 10 Tips for Writing Fast Mathematica Code ". 
 Many thanks to Kirill Guzenko KirillGuzenko for ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>10+ tips on writing fast code in Mathematica</h1><div class="post__text post__text-html js-mediator-article">  <i>Translation of the post by John McLune (Jon McLoone) " <a href="http://blog.wolfram.com/2011/12/07/10-tips-for-writing-fast-mathematica-code/">10 Tips for Writing Fast Mathematica Code</a> ".</i> <i><br></i>  <i><a href="https://habrahabr.ru/users/kirillguzenko/" class="user_link">Many</a> thanks to Kirill Guzenko <a href="https://habrahabr.ru/users/kirillguzenko/" class="user_link">KirillGuzenko</a> for help with the translation.</i> <hr>  The post of John McLune talks about common techniques for speeding up code written in the Wolfram Language.  For those interested in this issue, we recommend that you familiarize yourself with the video ‚ÄúOptimizing Code in Wolfram Mathematica‚Äù, from which you will learn in detail and many interesting examples about code optimization techniques, both discussed in the article (but in more detail) and others. <br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/wysmwnzjfPM%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi2ILtChrGf3VJ5oPo6OxdDvaSOrw" frameborder="0" allowfullscreen=""></iframe><hr>  When people tell me that <a href="http://www.wolfram.com/mathematica"><i>Mathematica is</i></a> not fast enough, I usually ask you to look at the code and often discover that the problem is not <i>Mathematica</i> performance, but not optimal use.  I would like to share a list of things that I pay attention to first of all when I try to optimize the code in <i>Mathematica</i> . <br><br><h2>  1. Use floating point numbers, and go to them as early as possible. </h2><br>  The most common mistake that I notice when I deal with slow code is setting too high a precision for a given task.  Yes, inappropriate use of exact symbolic arithmetic is the most common case. <br><br>  Most computational software systems have no such thing as exact arithmetic ‚Äî for them, 1/3 is the same as 0.33333333333333.  This difference can play a big role when you are faced with complex and unstable tasks, however for most tasks the floating-point numbers fully satisfy the needs, and what is important - the calculations with them are much faster.  In <i>Mathematica,</i> any number with a dot and with less than 16 digits is automatically processed with machine precision, so you should always use a decimal point if speed is more important than precision in this task (for example, enter a third as 1./3.).  Here is a simple example where working with floating-point numbers is almost 50.6 times faster than working with exact numbers, which will only be converted to floating-point numbers.  And in this case the same result is obtained. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/adf/884/5dc/adf8845dcd1debedc61d36cdd40c259b.jpg" width="451" height="34"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7fa/8ee/944/7fa8ee944bcaa940bff1cdd1b98ff5c2.jpg" width="227" height="23"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/545/6e9/291/5456e929173fad6578a18650ba27031a.jpg" width="468" height="35"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6f3/073/b6b/6f3073b6bca7e3d7181c41ecc0b66374.jpg" width="226" height="25"><br><a name="habracut"></a><br>  The same can be said for symbolic calculations.  If the symbolic form of the answer is not important for you and the stability in this task does not play a special role, then try as soon as possible to proceed to the form of a floating-point number.  For example, solving this polynomial equation in symbolic form, before substituting values, <i>Mathematica</i> builds an intermediate symbolic solution of five pages. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/91b/986/b16/91b986b168bc5daea7361c230e1ae5cf.jpg" width="392" height="35"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3df/a06/9b7/3dfa069b76cfa236d1e4cabf0a12bbc3.jpg" width="426" height="35"><br><br>  But if you do the substitution first, <a href="http://reference.wolfram.com/mathematica/ref/Solve.html"><b>Solve</b></a> will use much faster numerical methods. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5c8/d3b/e92/5c8d3be9264dcf7ed7cf4bf615439a00.jpg" width="425" height="36"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/637/00a/619/63700a619b1b403ee629c2be157fa616.jpg" width="426" height="32"><br><br>  When working with data lists, you should be consistent in the use of real numbers.  Just one exact value in the data set will translate it into a more flexible, but less efficient form. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/907/bf8/735/907bf8735642f0783e05e56452c3a9b1.jpg" width="270" height="33"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/50b/b8d/7c7/50bb8d7c7c7f76f679acaae52297cfc3.jpg" width="100" height="19"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba6/86f/7e1/ba686f7e130e789f7cf88501323b69f6.jpg" width="227" height="18"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/31c/bd8/60c/31cbd860cf7df947232a197779b2c505.jpg" width="108" height="19"><br><br><h2>  2. Use <b>Compile</b> ... </h2><br>  The <a href="http://reference.wolfram.com/mathematica/ref/Compile.html"><b>Compile</b></a> function accepts <i>Mathematica</i> code and allows you to pre-set the types (real, complex, etc.) and structures (value, list, matrix, etc.) of the input arguments.  This deprives parts of the <i>Mathematica</i> language of flexibility, but frees it from having to worry about, ‚ÄúWhat if the argument is in symbolic form?‚Äù And other such things.  <i>Mathematica</i> can optimize the program and create a bytecode to run it on its virtual machine (compilation in C is also possible - see below).  Not everything can be compiled, and a very simple code may not get any advantages, however complex and low-level computational code can get really big acceleration. <br><br>  Here is an example: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e30/1dd/a40/e301dda40d9c7c5a5213f73413c47cfa.jpg" width="240" height="17"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d67/1b1/56e/d671b156e38d83c3bc705bb90e6be4af.jpg" width="439" height="48"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ed6/2bb/25a/ed62bb25a491c9c42105ad1ad5ecadf3.jpg" width="258" height="18"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f3/c73/e36/4f3c73e368769ee8febba042d9dffd2b.jpg" width="169" height="18"><br><br>  Using <b>Compile</b> instead of <a href="http://reference.wolfram.com/mathematica/ref/Function.html"><b>Function</b></a> gives acceleration more than 80 times. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/353/c35/b5b/353c35b5bed95aec5b535c21735da737.jpg" width="438" height="48"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/677/e95/61c/677e9561c93d2a69d47bf8082862b331.jpg" width="266" height="18"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1d/d0a/fe9/d1dd0afe99db72157ac5b0139a84b7e9.jpg" width="165" height="19"><br><br>  But we can go further by telling <b>Compile</b> about the possibility of parallelizing this code, getting even better results. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/721/624/b7d/721624b7d3eb87befdfced0d44b6179e.jpg" width="458" height="65"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b3e/48e/2eb/b3e48e2eb41401ea0fe15c1085402319.jpg" width="239" height="17"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f0b/74e/37e/f0b74e37e14a70a646da739ca1d5ed43.jpg" width="163" height="17"><br><br>  On my dual-core machine, I got a result 150 times faster than in the original case;  The speed increase will be even more noticeable with a large number of cores. <br><br>  However, it should be remembered that many functions in <i>Mathematica</i> , such as <a href="http://reference.wolfram.com/mathematica/ref/Table.html"><b>Table</b></a> , <a href="http://reference.wolfram.com/mathematica/ref/Plot.html"><b>Plot</b></a> , <a href="http://reference.wolfram.com/mathematica/ref/NIntegrate.html"><b>NIntegrate,</b></a> and some more automatically compile their arguments, so that you will not see any improvements when using <a href="http://reference.wolfram.com/mathematica/ref/Table.html"><b>Compile</b></a> for your code. <br><br><h3>  2.5. ... and use <b>Compile</b> to generate code in C. </h3><br>  In addition, if your code is compiled, you can also use the <a href="http://reference.wolfram.com/mathematica/ref/CompilationTarget.html"><b>CompilationTarget</b></a> -&gt; <b>‚ÄúC‚Äù</b> option to generate C code, which automatically causes the C compiler to compile into a DLL and send a link to it in <i>Mathematica</i> .  We have additional costs at the compilation stage, but the DLL is executed directly in the processor and not in the <i>Mathematica</i> virtual machine, so the results can be even faster (in our case, 450 times faster than the original code). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/958/2f7/565/9582f75652765ddbfcb3d55bc8df41ad.jpg" width="451" height="76"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c3d/59e/719/c3d59e719cd4878595c9156071147b2e.jpg" width="246" height="19"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/0f7/09d/970/0f709d9704508fa02e70accfde5eb4ed.jpg" width="163" height="19"><br><br><h2>  3. Use built-in functions. </h2><br>  <i>Mathematica</i> contains many features.  More than an ordinary person can learn in one go (the latest version of Mathematica 10.2 already contains more than 5000 functions).  So it is not surprising that I often see code where someone implements some operations, not knowing that <i>Mathematica</i> already knows how to implement them.  And this is not only a waste of time for the invention of the bicycle;  Our guys have worked hard to create and most effectively implement the best algorithms for various types of input data, so the built-in functions work really fast. <br><br>  If you find something similar, but not quite, then you should check the parameters and optional arguments - they often generalize functions and cover many special and more distant applications. <br><br>  Here is an example.  If I have a list of a million 2x2 matrices that I want to turn into a list of a million one-dimensional lists of 4 elements, then in theory the easiest way would be to use the <a href="http://reference.wolfram.com/mathematica/ref/Map.html"><b>Map</b></a> to the <a href="http://reference.wolfram.com/mathematica/ref/Flatten.html"><b>Flatten</b></a> function applied to the list. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b04/e5a/9eb/b04e5a9ebca16c3b9f07980c406ac709.jpg" width="303" height="20"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c21/851/cb3/c21851cb32c84d0cd94b1a1e8838dc7a.jpg" width="302" height="17"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d4c/3bb/392/d4c3bb392720adfabd7cb9db0b04275c.jpg" width="164" height="18"><br><br>  But <b>Flatten</b> knows how to solve this problem yourself, if you indicate that levels 2 and 3 of the data structure should be merged, and level 1 is not affected.  Specifying such details may be somewhat inconvenient, however using only one <b>Flatten</b> , our code will be executed 4 times faster than in the case when we will reinvent the capabilities built into the function. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/200/6c8/3db/2006c83db81e86625fef01d72d00ee20.jpg" width="365" height="18"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f06/26a/95c/f0626a95c33d8d3df4ed792955b93c3b.jpg" width="163" height="16"><br><br>  So do not forget to look into the certificate before you enter some of its functionality. <br><br><h2>  4. Use the Wolfram <i>Workbench.</i> </h2><br>  <i>Mathematica</i> forgives some kinds of errors in the code, and everything will work quietly if you suddenly forgot to initialize the variable at the right moment, and you do not need to worry about recursion or unexpected data types.  And it's great when you just need a quick answer.  However, such a code with errors will not allow you to get the optimal solution. <br><br>  <a href="http://www.wolfram.com/products/workbench/"><i>Workbench</i></a> helps in several ways at once.  First, it allows you to better debug and organize large projects, and when everything is clear and orderly, it is much easier to write good code.  But the key feature in this context is the profiler, which allows you to see which lines of code are used at certain points in time, how many times they were called. <br><br>  Let us consider as an example a similar, terribly non-optimal (from the point of view of calculations) method of obtaining <a href="http://reference.wolfram.com/mathematica/ref/Fibonacci.html"><b>Fibonacci numbers</b></a> .  If you didn‚Äôt think about the consequences of double recursion, then you‚Äôre probably somewhat surprised by 22 seconds to estimate <b>fib [35]</b> (approximately the same time it will take the built-in function to calculate all 208,987,639 numbers of <b>Fibonacci [1000000000]</b> [see clause 3] ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/23e/380/493/23e38049345bde5adcd68a2050973cca.jpg" width="262" height="62"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e68/312/a18/e68312a182a19b1c2c07ae0db4374d88.jpg" width="171" height="21"><br><br>  Code execution in Profiler shows the reason.  The main rule is called 9 227 464 times, and the value of <b>fib [1] is</b> requested 18 454 929 times. <br><br>  To see the code as it really is can be a real revelation. <br><br><h2>  5. Remember the values ‚Äã‚Äãthat you will need in the future. </h2><br>  This is a good tip for programming in any language.  Here's how to do this in <i>Mathematica</i> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/92a/af9/bfa/92aaf9bfa6fc14d7a00f52d73af738c4.jpg" width="287" height="14"><br><br>  It stores the result of calling <b>f</b> for any argument, so if the function is called for an argument already called earlier, then <i>Mathematica</i> will not need to be evaluated again.  Here we give the memory, instead of receiving speed, and, of course, if the number of possible arguments to the function is huge, and the probability of re-calling a function with the same argument is very small, then you should not do so.  But if the set of possible arguments is small, it can really help.  This code saves the program that I used to illustrate the advice 3. It is necessary to replace the first rule with this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a3b/6b2/607/a3b6b260795f529b13e072b0a867eb92.jpg" width="277" height="16"><br><br>  And the code starts working incomparably quickly, and to calculate <b>fib [35] the</b> main rule should be called only 33 times.  Remembering previous results prevents the need to repeatedly recursively descend to <b>fib [1]</b> . <br><br><h2>  6. Parallelize the code. </h2><br>  An increasing number of operations in <i>Mathematica are</i> automatically parallelized to local kernels (especially linear algebra, image processing, statistics), and, as we have already seen, can be implemented on demand via <b>Compile</b> .  But for other operations that you want to parallelize on remote equipment, you can use built-in constructions for parallelization. <br><br>  There is a set of tools for this, but in the case of fundamentally mono-threaded problems, using only <a href="http://reference.wolfram.com/mathematica/ref/ParallelTable.html"><b>ParallelTable</b></a> , <a href="http://reference.wolfram.com/mathematica/ref/ParallelMap.html"><b>ParallelMap</b></a> and <a href="http://reference.wolfram.com/mathematica/ref/ParallelTry.html"><b>ParallelTry</b></a> can increase the computation time.  Each of the functions automatically solves the problem of communication, control and collection of results.  There are some additional costs in sending the task and getting the result, that is, getting a time gain in one, we lose time in the other.  <i>Mathematica</i> comes with a certain maximum number of available cores (depending on license), and you can scale them with a <a href="http://www.wolfram.com/gridmathematica/"><i>Mathematica</i> grid</a> if you have access to additional cores.  In this example, <b>ParallelTable</b> gives me double performance because it runs on my dual-core machine.  A larger number of processors will give a larger increase. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f07/2cd/f6e/f072cdf6e4b58dd22a86a016d7455c87.jpg" width="388" height="32"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e4d/da5/648/e4dda56484dd835e1216c4b988a64238.jpg" width="162" height="19"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d5d/e51/909/d5de5190977b861a63c69be07748c2b0.jpg" width="444" height="32"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c86/5e8/e93/c865e8e9316d1ebfc8306425abbcf554.jpg" width="163" height="18"><br><br>  Everything <i>Mathematica</i> can do can be parallelized.  For example, you can send sets of parallel tasks to remote devices, each of which compiles and runs in C or on a GPU. <br><br><h3>  6.5.  Consider using <i>CUDALink</i> and <i>OpenCLLink.</i> </h3><br>  With the help of the GPU, some tasks can be solved in parallel mode much faster.  Apart from the case when solving your problems, functions already optimized for CUDA are required, you need to do a little work, however, the <a href="http://reference.wolfram.com/mathematica/CUDALink/guide/CUDALink.html"><i>CUDALink</i></a> and <a href="http://reference.wolfram.com/mathematica/OpenCLLink/guide/OpenCLLink.html"><i>OpenCLLink tools</i></a> automate for you a large amount of any routine. <br><br><h2>  7. Use <b>Sow</b> and <b>Reap</b> to accumulate large amounts of data (but not <b>AppendTo</b> ). </h2><br>  Due to the flexibility of data structures in <i>Mathematica,</i> <a href="http://reference.wolfram.com/mathematica/ref/AppendTo.html"><b>AppendTo</b></a> cannot know that you will add a number, because you can add a document, sound or image in the same way.  As a result of <b>AppendTo,</b> you need to create a new copy of all data, restructured to accommodate the attached information.  As data is accumulated, work will be slower (and the <b>data = Append [data, value]</b> construction is equivalent to <b>AppendTo</b> ). <br><br>  Instead, use <a href="http://reference.wolfram.com/mathematica/ref/Sow.html"><b>Sow</b></a> and <a href="http://reference.wolfram.com/mathematica/ref/Reap.html"><b>Reap</b></a> .  <b>Sow</b> passes the values ‚Äã‚Äãyou want to collect, and <b>Reap</b> collects them and creates a data object at the end.  The following examples are equivalent: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ce/227/c42/2ce227c42e5dca552f98632f76d15a8f.jpg" width="346" height="34"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ee6/954/350/ee6954350ce922e62fbec40a552086ae.jpg" width="164" height="19"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/625/db8/17a/625db817aa3d8d90394169d29687445f.jpg" width="448" height="31"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/252/a59/2de/252a592de7b337a7b6fe99cd30721a1d.jpg" width="162" height="17"><br><br><h2>  8. Use <b>Block</b> and <b>With</b> instead of <b>Module</b> . </h2><br>  <a href="http://reference.wolfram.com/mathematica/ref/Block.html"><b>Block</b></a> (localization of a variable's value), <a href="http://reference.wolfram.com/mathematica/ref/With.html"><b>With</b></a> (replacing variables in a code fragment with their specific values ‚Äã‚Äãand then calculating the entire code) and <a href="http://reference.wolfram.com/mathematica/ref/Module.html"><b>Module</b></a> (localizing variable names) are restrictive constructs that have several different properties.  In my experience, <b>Block</b> and <b>Module are</b> interchangeable, at least in 95% of the cases I encounter, but <b>Block</b> , as a rule, works faster, and in some cases <b>With</b> (actually <b>Block</b> with read-only variables) even faster. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/70d/9c3/817/70d9c381748ee7cd64c4a12212ad9176.jpg" width="425" height="18"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c1b/574/545/c1b5745458e64282805c3192533e676a.jpg" width="164" height="16"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7fe/8c0/727/7fe8c0727c01aeafb92582d44e8c81cb.jpg" width="420" height="19"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/432/456/41c/43245641c0e37e39d2059633dd985dbb.jpg" width="164" height="17"><br><br><h2>  9. Do not overdo the templates. </h2><br>  Template expressions are great.  Many tasks with their help are easily solved.  However, patterns are not always fast, especially such fuzzy ones as <b>BlankNullSequence</b> (usually recorded as "___"), which can search for patterns in the data for a long time and persistently, which obviously cannot be there.  If the execution speed is fundamental, use clear models, or discard patterns altogether. <br><br>  As an example, I will give an elegant way to <a href="http://en.wikipedia.org/wiki/Bubble_sort">sort a bubble</a> into one line of code through templates: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/161/647/dad/161647dad34a3c266acc934330e174aa.jpg" width="408" height="45"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3c3/5f6/5f8/3c35f65f86ea864871e64d0923516271.jpg" width="164" height="17"><br><br>  In theory, everything is neat, but too slow compared to the procedural approach that I studied when I first started programming: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2e7/181/943/2e7181943d79c3e4c869f95fc993a128.jpg" width="361" height="151"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2e6/a0f/367/2e6a0f367799f70a469b9d18f24476cc.jpg" width="163" height="18"><br><br>  Of course, in this case you should use the built-in <b>Sort</b> function (see tip 3), which works most quickly. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dee/b4f/bb1/deeb4fbb17b4a1ad44e07e5fad518d4f.jpg" width="358" height="17"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/9d2/2c5/6b0/9d22c56b0926da73dbb7735dfc93c360.jpg" width="113" height="15"><br><br><h2>  10. Use different approaches. </h2><br>  One of the strengths of <i>Mathematica</i> is the ability to solve problems in different ways.  This allows you to write code as you think, and not to rethink the problem under the style of a programming language.  However, conceptual simplicity is not always the same as computational efficiency.  Sometimes an easy-to-understand idea generates more work than is necessary. <br><br>  But another point is that due to all sorts of special optimizations and smart algorithms that are automatically applied in <i>Mathematica,</i> it is often difficult to predict which path to take.  For example, here are two ways to calculate factorial, but the second is more than 10 times faster. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/651/33d/b76/65133db766e11b1034bb0abcee58eff1.jpg" width="423" height="19"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/ee9/2cb/18a/ee92cb18a107cf0efb480613be36c523.jpg" width="163" height="18"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c02/0ab/b9f/c020abb9f4de11d2fc238217e478e54d.jpg" width="353" height="18"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3fd/855/839/3fd855839b42c87dc08561444f3ebf3f.jpg" width="162" height="15"><br><br>  Why?  You might assume that <a href="http://reference.wolfram.com/mathematica/ref/Do.html"><b>Do</b></a> scrolls the cycles more slowly, or all these <a href="http://reference.wolfram.com/mathematica/ref/Set.html">Set</a> assignments to <i>temp</i> take time, or something else is wrong with the first implementation, but the real reason is likely to be quite unexpected.  <a href="http://reference.wolfram.com/mathematica/ref/Times.html"><b>The Times</b></a> (multiplication operator) knows a clever binary partitioning trick that can be used when you have a large number of integer arguments.  Recursive separation of arguments into two smaller pieces (1 * 2 * ... * 32767) * (32768 * ... * 65536) works faster than processing all arguments, from the first to the last.  The number of multiplications is the same, but however a smaller number of them include larger numbers, because on average, the algorithm is faster.  There are many other hidden magic in <i>Mathematica,</i> and with each version of it more and more. <br><br>  Of course, the best option in this case is to use the built-in function (again, tip 3): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cc2/062/119/cc20621192e361ec5e614981d975d755.jpg" width="211" height="18"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/617/c45/7dc/617c457dc90f7d8c4397fa2740ceac2c.jpg" width="163" height="16"><br><br>  <i>Mathematica</i> is able to provide superior computational performance, as well as high speed and accuracy, but not always at the same time.  I hope these tips will help you balance the often conflicting demands of fast programming, fast execution, and accurate results. <br><br>  <i>All timings are given for 7 64-bit Windows PC, with 2.66 GHz Intel Core 2 Duo and 6 GB of RAM.</i> <br><br>  <i>In addition to this brief post by John Maclone, we encourage you to read the two videos below.</i> <br><div class="spoiler">  <b class="spoiler_title">Developing large applications in Mathematica</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/4eYC-SFZ8lw%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhh18KnSFoPV9h7eqVlnWvFRsyM5NQ" frameborder="0" allowfullscreen=""></iframe></div></div><br><div class="spoiler">  <b class="spoiler_title">Common mistakes and misconceptions of novice Mathematica users</b> <div class="spoiler_text"><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Dfxc4E0iRro%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi37F6EwmdPxZTrom1LWV6OcHwDDQ" frameborder="0" allowfullscreen=""></iframe></div></div></div><p>Source: <a href="https://habr.com/ru/post/262879/">https://habr.com/ru/post/262879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../262863/index.html">Intel vs. Moore's Law: IBM - to the rescue</a></li>
<li><a href="../262865/index.html">Virusday Launches Social Experiment</a></li>
<li><a href="../262867/index.html">AngelHack: the second international hackathon in Moscow. Who has won?</a></li>
<li><a href="../262869/index.html">The path of the analyst. Bug work</a></li>
<li><a href="../262871/index.html">How computers stack numbers</a></li>
<li><a href="../262883/index.html">A convenient log is not a luxury, but a debugging tool, or how to connect a dll using the h file</a></li>
<li><a href="../262887/index.html">Technical Interview: Five Ways to Scare a Candidate / Five Ways to Fuck the Interviewer</a></li>
<li><a href="../262889/index.html">Why Go and Rust are not enemies, but friends</a></li>
<li><a href="../262891/index.html">Six ways to reliably protect your organization from external and internal threats</a></li>
<li><a href="../262893/index.html">Gigahertz does not happen much</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>