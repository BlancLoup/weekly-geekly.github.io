<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúWhat has the progRess come to?‚Äù Replacing "mental" labor by a mechanical process based on R</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Every new day often throws up new puzzles. Not in the sense of their radical novelty, but in the sense of ‚Äúone more type of tasks‚Äù, which are usually ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúWhat has the progRess come to?‚Äù Replacing "mental" labor by a mechanical process based on R</h1><div class="post__text post__text-html js-mediator-article"><p>  Every new day often throws up new puzzles.  Not in the sense of their radical novelty, but in the sense of ‚Äúone more type of tasks‚Äù, which are usually found in the business environment. </p><br><p>  This time the task turned out to be extremely simple and pragmatic, but its solution gives far-reaching consequences. </p><br><h1 id="keys">  Case </h1><br><p>  The essence of the problem is as follows: <a name="habracut"></a></p><br><ol><li>  There are long-term contracts for the provision of services. </li><li>  Under these contracts reporting activities should be carried out in the form of a large number of paper documents (boxes), stitched and under the blue seal.  And nothing else. </li><li>  Monthly reporting. </li><li>  The reports themselves are fairly formalized, but their preparation requires lengthy and, as the performers confidently declared, strictly manual work to collect information from a dozen systems, comparison and reconciliation, analysis, development of aggregates and formation of word documents in a consistent form. </li></ol><br><p>  The amount of work is such that a couple of analysts worked on this every month for a couple of weeks.  Naturally, at the same time something was forgotten, something was missing, errors were made somewhere.  The only thing that saves is that the receiving party does not have the resources to completely check all the reports provided. </p><br><p>  One of the approximate report types is as follows: <br><img src="https://habrastorage.org/files/ff8/592/ba1/ff8592ba1bb446609975f2a4d82800d5.png" alt="image"><br>  The cumulative number of pages is in the thousands (tens of thousands in a bad month). </p><br><p>  The data sources are a pair of desks service, a trio of monitoring systems, corporate directories, contracts, an accounting system. </p><br><p>  For justice, I must say that earlier we have already done work on connecting these sources by means of R. Not to say that this is very heavy work, but not simpler than simple.  The main thing was to figure out where the information lies and how it correlates: </p><br><ul><li>  80% of the time for formalization (what needs to be done in any case, whether manual or automatic data collection); </li><li>  20% for the implementation of these procedures in the code on R. </li></ul><br><p>  So, in the course of the working discussion that it is fundamentally impossible to automate from the current activity this task was announced.  She was hailed as ‚Äúcreative‚Äù and inaccessible to the understanding of the <a href="https://ru.wikipedia.org/wiki/%25D0%25AF,_%25D1%2580%25D0%25BE%25D0%25B1%25D0%25BE%25D1%2582">‚Äúpositron brain‚Äù</a> . </p><br><p>  The call has been accepted. </p><br><p>  After 4 hours, we already had a working R script (~ 4 screens with comments) that performs this task of preparing one of the reports. <br>  The script performs the work on a turnkey basis, producing at the word output a file of the required format with actual data: </p><br><ol><li>  loads data from three sources (excel and 2 databases); </li><li>  conducts pre-processing to identify confirmed cases; </li><li>  carries out calculations (very unpretentious, but it does not matter) on the correlation of cases with contractual SLAs; </li><li>  cleans and consolidates time intervals; </li><li>  calculates monthly indicators; </li><li>  generates a word file containing headings, text, generated formatted tables, generated according to the graphic data. </li></ol><br><p>  A significant addition to previous publications is the last item - the generation of a word file.  This task is elegantly solved with the help of the cross-platform package <a href="http://davidgohel.github.io/ReporteRs/">ReporteRs</a> .  In addition to creating word files, it also allows you to generate powerpoint files, which is also very useful.  It is no secret that many companies like to watch statements in the form of presentations.  A good manual with examples can be read here: <a href="http://www.sthda.com/english/wiki/create-and-format-word-documents-using-r-software-and-reporters-package">"Create and format Word documents using R software and Reporters package</a> . <a href="http://www.sthda.com/english/wiki/create-and-format-word-documents-using-r-software-and-reporters-package">"</a> </p><br><p>  As a result, 2 people * 2 weeks = 1 person months.  is replaced by the script for 5-15 minutes.  The benefit to the company is obvious. </p><br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>  The whole story could be described exclusively in iridescent colors, if it did not contain sad moments. </p><br><p>  Yes, we fundamentally decided it, but at the very top, the results have not yet been reported. <br>  This is not entirely correct with respect to analysts, it is necessary to give time for them to become aware of the situation and adopt a certain position.  It is obvious that after such a report and trial operation (a month or two), the desire to optimize the payroll from the theoretical plane will be transferred to the practical one. </p><br><p>  But, on the other hand, it is an inevitable vector of development and it is also impossible to keep silent about it. </p><br><p>  PS <br>  Using this approach allows you to do such tricks in a couple of lines that are very laborious when manually creating a word report: </p><br><ul><li>  regrouping the tables according to changing criteria; </li><li>  criterial coloring of tables, design change; </li><li>  calculation of various units; </li><li>  bulk update of calculated fields; </li><li>  change the structure of the document. </li></ul><br><p>  Naturally, the classic approach ‚ÄúMade in Excel, dragged into Word‚Äù exists, but it is a long manual effort, error-prone and not always available for use in dynamically changing requirements.  Those who want to get an independent view of the situation can also ask questions to the user <a href="https://habrahabr.ru/users/AristarXXXX/"><strong>AristarXXXX</strong></a> , who is an active participant in the process. </p><br><p>  Previous post: <a href="https://habrahabr.ru/post/315870/">"More examples of using R to solve practical business problems"</a> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/317130/">https://habr.com/ru/post/317130/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317120/index.html">NFC - let's go ...</a></li>
<li><a href="../317122/index.html">Own traffic exchange point in the data center. Part 1. How it works</a></li>
<li><a href="../317124/index.html">CRM for small business: how to implement one, two, three</a></li>
<li><a href="../317126/index.html">How IT professionals work. Alexey Akulovich, senior developer of the VKontakte project</a></li>
<li><a href="../317128/index.html">Why hold a hackathon in a strip club?</a></li>
<li><a href="../317132/index.html">Failover Evolution in PostgreSQL</a></li>
<li><a href="../317134/index.html">How to order Internet marketing with reference to the result?</a></li>
<li><a href="../317136/index.html">How to get maximum revenue from advertising systems on your site</a></li>
<li><a href="../317138/index.html">Alcatel Lucent Service Router as an Access Domain Gateway</a></li>
<li><a href="../317140/index.html">An inside look at OpenBMC for OpenPOWER systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>