<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple battle model on Modelica</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! Having recently learned about a modeling tool such as the Modelica language and its free implementation of OpenModelica , I was surprised th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple battle model on Modelica</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/14c/fe6/316/14cfe63169f9456dc4e76eca2ebd287b.png" align="right"><br>  Good day!  Having recently learned about a modeling tool such as the <a href="https://modelica.org/">Modelica</a> language and its free implementation of <a href="https://openmodelica.org/index.php">OpenModelica</a> , I was surprised that there is only one <a href="http://habrahabr.ru/post/202596/">article</a> on Habr√©.  Since the topic is somewhat unusual, the details had to be comprehended on <s>their own skin with</s> some example taken from the head.  This article will discuss how to build a simple battle model (for example), along with some concepts of the language (the main one). <br><br><a name="habracut"></a><br><br>  <i>Note: for the preparation of the article, the last nightly build of OpenModelica (rev18625) was used.</i>  <i>When installing, note that you need to specify the path without spaces.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Task </h4><br>  Imagine a war as a process in which two adversaries, possessing different forces (in terms of proportion, but not in strength), achieve the same goal - to capture as large enemy territory as possible by destroying the enemy forces on it.  For definiteness, we will assume that the territory was conquered when the infantry set foot on it (ground forces).  The sea is not included in the territory.  Victory is counted when the entire territory of the enemy is conquered. <br><br>  Generally speaking, wars also include economics, but modeling this would take too much space.  For now, let us consider three types of forces: sea, land, and aviation (we will not consider nuclear weapons either).  Each has resistance to attack, or health (one unit), as well as the actual attack power (we will measure, say, the number of bullets).  And let every few units of time, new units come into battle. <br><img src="https://habrastorage.org/getpro/habr/post_images/cbb/626/9e4/cbb6269e4e507174c05310abf02f1dbc.png" align="right"><br>  The fighting takes place in a square, across which the front line runs horizontally, and to the right is the sea, where actions are carried out by ships.  The length of the side of the square is denoted by L (for definiteness, we take as 100 kilometers).  Then the area conquered by side A will be equal to A * L, conquered by the adversary - (LA) * L. The change to A will depend on the correlation of forces.  The greater the forces at the front prevail, the more A changes (in favor of those forces that are greater).  Let's say for definiteness, a unit of infantry on one side advances a front (if without a fight) by 1 kilometer per unit of time. <br><br><h4>  Concepts Modelica </h4><br>  The basis of modeling in Modelica are the classes (and their variations according to the options of the announcement / application, but more on that a bit later).  A class in Modelica is somewhat different from the classes we are used to, since it contains not only fields and methods (in Modelica, functions), but also equations that relate variables to each other.  Also, the fields can have a different type of "variability" - a constant (and there is a constant), a parameter (does not change in the current simulation), and, in fact, a variable.  A field in a class can be either an object of built-in types (Boolean, Real, etc.) or user-defined types.  A more complex concept is the possibility of ‚Äútemplate‚Äù - the replacement of the field type, its redefinition. <br><br>  Classes can be inherited (including multiple, and only diamond).  For Modelica, this means that all the contents of the inheritance are copied into the inherited class, including the equations.  And here we should mention the basic rule of Modelica - the number of equations for variables must correspond to the number of variables.  No more, no less. <br><br><h4>  An example of solving the problem </h4><br>  The simplest type of class - record - cannot contain equations. <br>  First, we define the abstract type of a combat unit. <br><div class="spoiler">  <b class="spoiler_title">UnitData.mo</b> <div class="spoiler_text"><pre><code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">record</span></span> UnitData "Abstract army unit record" parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> unitHealth; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> unitAttack; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> supplyTime; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> supplyNumber; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> UnitData;</code> </pre> <br></div></div><br>  This code declares four non-initialized parameters.  In quotes, after declaring classes and variables, you can add document strings.  In general, the comments in Modelica - C ++ - style, that is, // or / * / * (comments of this kind are ignored by the environment). <br><br>  The next step is to declare a class with equations, the objects of which will be some military forces, characterized by the same as combat units + numbers. <br><div class="spoiler">  <b class="spoiler_title">Forces.mo</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Forces "Abstract army forces class" extends UnitData; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> startNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-type"><span class="hljs-type">Real</span></span> number (start = startNumber); <span class="hljs-type"><span class="hljs-type">Boolean</span></span> destroyed; equation destroyed = number &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> destroyed <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> reinit(number, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> sample(supplyTime, supplyTime) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> reinit(number, pre(number) + supplyNumber); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Forces;</code> </pre><br></div></div><br>  Using this file as an example, you can trace inheritance, as well as work with Modelica events. <br>  If the equation is destroyed = number &lt;0;  should not cause questions, then inside the first when block a special operator reinit is used, which sets the value of the variable to the result of the expression with the second parameter.  reinit, like pre (the value of the previous step), can only be used inside a when block.  pre must be used so that the equation (namely, the equation) is not: x = x + 1. <br><br>  The built-in function sample returns true if the simulation time (time) is equal to the first parameter (first call), and then at intervals equal to the second parameter (in our case they are equal - the help arrives at equal intervals from the moment of supplyTime). <br><br>  Next we need a class representing the enemy army: <br><div class="spoiler">  <b class="spoiler_title">EnemyForces.mo</b> <div class="spoiler_text"><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">class</span></span> EnemyForces <span class="hljs-string"><span class="hljs-string">"Enemy forces references"</span></span> replaceable Forces enemyAir; <span class="hljs-attribute"><span class="hljs-attribute">replaceable</span></span> Forces enemySea; <span class="hljs-attribute"><span class="hljs-attribute">replaceable</span></span> Forces enemyLand; <span class="hljs-attribute"><span class="hljs-attribute">end</span></span> EnemyForces;</code> </pre><br></div></div><br><br>  Specifying a variable as replaceable allows you to further override the type of the variable when declaring an EnemyForces object. <br><br>  Now we come to the most important thing.  Actually a class representing the army. <br><div class="spoiler">  <b class="spoiler_title">Army.mo</b> <div class="spoiler_text"><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Army</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LandArmy</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Forces</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitHealth</span></span></span><span class="hljs-class"> = 100, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class"> = 400, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplyTime</span></span></span><span class="hljs-class"> = 0.25, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplyNumber</span></span></span><span class="hljs-class"> = 800); </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AirArmy</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Forces</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitHealth</span></span></span><span class="hljs-class"> = 400, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class"> = 750, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplyTime</span></span></span><span class="hljs-class"> = 0.5, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplyNumber</span></span></span><span class="hljs-class"> = 400); </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SeaArmy</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Forces</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitHealth</span></span></span><span class="hljs-class"> = 3000, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class"> = 7000, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplyTime</span></span></span><span class="hljs-class"> = 1, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplyNumber</span></span></span><span class="hljs-class"> = 20); </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SeaArmy</span></span></span><span class="hljs-class"> seaArmy; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AirArmy</span></span></span><span class="hljs-class"> airArmy; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LandArmy</span></span></span><span class="hljs-class"> landArmy; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EnemyForces</span></span></span><span class="hljs-class"> enemyForces (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">redeclare</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Army</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AirArmy</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyAir</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">redeclare</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Army</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">SeaArmy</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemySea</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">redeclare</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Army</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">LandArmy</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyLand</span></span></span><span class="hljs-class">); </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Real</span></span></span><span class="hljs-class"> armyForce; equation armyForce = seaArmy.unitHealth * seaArmy.number + airArmy.unitHealth * airArmy.number + landArmy.unitHealth * landArmy.number; der(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">seaArmy</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">) = if not seaArmy.destroyed then -(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyAir</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyAir</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemySea</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemySea</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class">) / seaArmy.unitHealth else 0; der(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">airArmy</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">) = if not airArmy.destroyed then -(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyAir</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyAir</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemySea</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemySea</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyLand</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyLand</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class">) / airArmy.unitHealth else 0; der(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">landArmy</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class">) = if not landArmy.destroyed then -(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyAir</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyAir</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class"> + </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyLand</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">number</span></span></span><span class="hljs-class"> * </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyForces</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">enemyLand</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">unitAttack</span></span></span><span class="hljs-class">) / landArmy.unitHealth else 0; end </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Army</span></span></span><span class="hljs-class">;</span></span></code> </pre><br></div></div><br><br>  What's going on here.  First, we create specific classes of the armed forces, simply equating them with the existing Forces class and initializing its parameters.  Immediately declare objects.  The next thing is to create an object that will be used as a reference to the enemy army, and replace the replaceable variables with the redeclare keyword.  Variable armyForce we will need purely for "analytical conclusions". <br>  About equations - the first equation means that the strength of the army is the armor of all units that are. <br>  The following three equations mean: <br><ol><li>  If the naval army is not destroyed, then at each moment of time from all its armor decreases the damage inflicted by air and sea forces </li><li>  If the air army is not destroyed, then at each moment of time from all its armor the damage caused by any enemy troops decreases, </li><li>  Similarly with ground forces, except that the naval forces do not cause damage to them. </li></ol><br><br>  The notation der (var) is a time derivative of var (variable). <br><br>  And finally, we describe the armed conflict itself. <br><div class="spoiler">  <b class="spoiler_title">Conflict.mo</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">model <span class="hljs-keyword"><span class="hljs-keyword">Conflict</span></span> "Conflict of two armies model" parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> armyASea = <span class="hljs-number"><span class="hljs-number">200</span></span>; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> armyAAir = <span class="hljs-number"><span class="hljs-number">1000</span></span>; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> armyALand = <span class="hljs-number"><span class="hljs-number">4000</span></span>; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> armyBSea = <span class="hljs-number"><span class="hljs-number">100</span></span>; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> armyBAir = <span class="hljs-number"><span class="hljs-number">1800</span></span>; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> armyBLand = <span class="hljs-number"><span class="hljs-number">3600</span></span>; Army armyA ( seaArmy.startNumber = armyASea, airArmy.startNumber = armyAAir, landArmy.startNumber = armyALand, enemyForces.enemyAir.startNumber = armyBAir, enemyForces.enemySea.startNumber = armyBSea, enemyForces.enemyLand.startNumber = armyBLand ); Army armyB ( seaArmy.startNumber = armyBSea, airArmy.startNumber = armyBAir, landArmy.startNumber = armyBLand, enemyForces.enemyAir.startNumber = armyAAir, enemyForces.enemySea.startNumber = armyASea, enemyForces.enemyLand.startNumber = armyALand ); parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> L = <span class="hljs-number"><span class="hljs-number">100</span></span>; parameter <span class="hljs-type"><span class="hljs-type">Real</span></span> landArmySpeed = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-type"><span class="hljs-type">Real</span></span> A (start = L / <span class="hljs-number"><span class="hljs-number">2</span></span>); equation armyA.enemyForces.enemyAir.number = armyB.airArmy.number; armyA.enemyForces.enemySea.number = armyB.seaArmy.number; armyA.enemyForces.enemyLand.number = armyB.landArmy.number; armyB.enemyForces.enemyAir.number = armyA.airArmy.number; armyB.enemyForces.enemySea.number = armyA.seaArmy.number; armyB.enemyForces.enemyLand.number = armyA.landArmy.number; <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> A &gt; L <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> terminate("Army A wins"); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> A &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> terminate("Army B wins"); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">when</span></span>; der (A) = (armyA.landArmy.number - armyB.landArmy.number) * landArmySpeed / L; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Conflict</span></span>;</code> </pre><br></div></div><br><br>  The keyword model is used here.  This is also a class, but only models can be used for optimization (about which later). <br>  In addition to declaring warring parties, which we will not dwell on, there are equations that establish that enemy A is B, and vice versa.  Two when-conditions mean terminating a simulation with a mark of what happened. <br><br><h4>  Launch and Results </h4><br>  In order to run the model, you can use the shell OpenModelica, typing the following in it: <br><div class="spoiler">  <b class="spoiler_title">Shell commands OpenModelica</b> <div class="spoiler_text"><pre> <code class="hljs lisp">loadModel(<span class="hljs-name"><span class="hljs-name">Modelica</span></span>) loadFile(<span class="hljs-string"><span class="hljs-string">"d:/path/UnitData.mo"</span></span>) loadFile(<span class="hljs-string"><span class="hljs-string">"d:/path/Forces.mo"</span></span>) loadFile(<span class="hljs-string"><span class="hljs-string">"d:/path/EnemyForces.mo"</span></span>) loadFile(<span class="hljs-string"><span class="hljs-string">"d:/path/Army.mo"</span></span>) loadFile(<span class="hljs-string"><span class="hljs-string">"d:/path/Conflict.mo"</span></span>) simulate(<span class="hljs-name"><span class="hljs-name">Conflict</span></span>, stopTime = <span class="hljs-number"><span class="hljs-number">2</span></span>) plot({armyA.armyForce, armyB.armyForce}, xRange = {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}) plot({armyA.landArmy.number, armyB.landArmy.number, armyA.seaArmy.number, armyB.seaArmy.number, armyA.airArmy.number, armyB.airArmy.number}, xRange = {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>}) plot(<span class="hljs-name"><span class="hljs-name">A</span></span>, xRange = {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>})</code> </pre><br></div></div><br><br>  Relevant constructions are shown in the pictures below. <br><img src="https://habrastorage.org/getpro/habr/post_images/774/4f6/53e/7744f653e2f25725c10ad2e91087aa19.png"><br>  This is the correlation of forces in time. <br><img src="https://habrastorage.org/getpro/habr/post_images/521/edf/348/521edf3483458a00368673adbab6fd72.png"><br>  This is the ratio of forces in time in the context of the types of troops. <br><img src="https://habrastorage.org/getpro/habr/post_images/0a8/998/6a1/0a89986a143d1ac3859b0b2d6fffb6cd.png"><br>  And so - the front line.  From the graphs it is clear that army A first won, but then army B won it. <br><br><h4>  Optimization with OpenModelica </h4><br>  Besides the fact that you can simulate, you can also find answers to the questions asked by the model.  For example, if you ask yourself what is the minimum initial number of ground forces, Army B will win, then with the help of OMOptim tool included in OpenModelica you can get the following picture: <br><img src="https://habrastorage.org/getpro/habr/post_images/4c8/cb5/9ff/4c8cb59ffdf4a6930a1b206bf22a7443.png"><br><br><h4>  Instead of conclusion </h4><br>  OpenModelica is well documented, for those who are familiar with English.  Overall, the tool is promising.  While the error messages are not very talking, and the debug information is not to say that it is easily interpreted.  But on the whole, with enough time and interest, everything is victorious. <br><br><h4>  Still instead of the conclusion </h4><br>  It is clear that the battle model is very simple, and the reality, if it reflects, is only in the fact that (in our case, the minimum) the strength in forces can not guarantee victory, and the final result is determined by the structure of the system (who beats someone) to a lesser degree than the initial conditions. <br><br><h4>  useful links </h4><br>  <a href="https://openmodelica.org/images/docs/userdocs/modprod2012-tutorial1-Peter-Fritzson-ModelicaTutorial.pdf">Excellent tutorial</a> (in English). <br>  <a href="http://modref.xogeny.com/">Web Reference</a> (in English). <br><br>  <b>UPDATE</b> <br>  After some time, I realized that to call her armor ‚Äúthe strength of the army‚Äù is somewhat hastily.  However, light modifications: <br><div class="spoiler">  <b class="spoiler_title">Army.mo changes</b> <div class="spoiler_text"><pre> <code class="hljs ruby"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Army</span></span></span><span class="hljs-class"> //... </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Real</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">armyHealth</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">armyStrength</span></span></span><span class="hljs-class">;</span></span> equation armyHealth = seaArmy.unitHealth * seaArmy.number + airArmy.unitHealth * airArmy.number + landArmy.unitHealth * landArmy.number; armyStrength = seaArmy.unitAttack * seaArmy.number + airArmy.unitAttack * airArmy.number + landArmy.unitAttack * landArmy.number; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> Army;</code> </pre><br></div></div><br>  You can come to the picture, which will confirm the already stated conclusions. <br><div class="spoiler">  <b class="spoiler_title">Schedule</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/71a/91b/296/71a91b29650307517c49bdcaca0c8711.png"><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/209112/">https://habr.com/ru/post/209112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209102/index.html">Startup alone. My-Wins Story</a></li>
<li><a href="../209104/index.html">Where do multicopters fly? Technology roadmap</a></li>
<li><a href="../209106/index.html">Kepler equation</a></li>
<li><a href="../209108/index.html">Angular Light. We manage declarative data binding in HTML</a></li>
<li><a href="../209110/index.html">Analysis of Suspicious PDF Files</a></li>
<li><a href="../209116/index.html">Electronic money in Russia will limit</a></li>
<li><a href="../209118/index.html">Using XenServer and other free / opensource in manual testing</a></li>
<li><a href="../209122/index.html">Training course "Data Visualization"</a></li>
<li><a href="../209126/index.html">MathML or Latex - how we implemented a changing salary in calculating salary using MathJax</a></li>
<li><a href="../209128/index.html">But how does multithreading work? Part II: memory ordering</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>