<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We create the robot on HabraWars</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 
 Probably many have already heard about the project called HabraWars , if briefly - this is a game for programmers, in which you write artific...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We create the robot on HabraWars</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br>  Probably many have already heard about the project called <a href="http://habrawars.appspot.com/">HabraWars</a> , if briefly - this is a game for programmers, in which you write artificial intelligence for your own robot on JS. <br><br>  I think that this will not be my first article on this topic, if only because here I am not going to disclose the whole topic, but only part of it.  But first, I think you need to form some kind of robot concept ... Immediately I say that in js I am far from specialized and in general my knowledge of this language is rather poor in my opinion ... So, how should our robot look from the inside and it should be logic, no matter how obvious it may sound, but logic is a rather complicated thing, it will control the robot, asking questions (such as: ‚ÄúDoes a projectile fly at me‚Äù) and, based on answers, call functions responsible for a robot ... But I will not start with logic (I myself have not even started writing it :)), but I will start with  functions responsible for performing the actions assigned by logic. <a name="habracut"></a><br><br>  So let's get started.  In this post it will be discussed exactly the attack of our robot (in the next one, probably dodging bullets, read defense).  To begin with we throw such a dry code: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; };</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> /* <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font>  ID       ,      <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font>   ... <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> */ <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } /* <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font>  ( )          <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font>  ,    ,    <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> -1      ,  1    <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font>   ...   0    ... <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font>        :   <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font>    3    ,  90  <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font>  12- ... <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> */ <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); /* <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font>        : c^2 = a^2 + b^2 -  <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font>     ... =&gt; c = sqrt(a^2 + b^2) <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><font color="#008000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> */ <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; }; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">this</font> .enemyId = 0; <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ){ <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyId){ <font color="#008000">//      ,       </font> <font color="#008000">/*</font> <font color="#008000"> ID       ,     </font> <font color="#008000">  ...</font> <font color="#008000">*/</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); } <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ){ <font color="#008000">//     ,    ...</font> <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this</font> .getNearestEnemy( enemies, {x: my_state.x, y: my_state.y}, my_state.angle ); <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies){ <font color="#0000ff">if</font> (enemies[key][ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies[key]; } } <font color="#008000">/*</font> <font color="#008000"> ( )         </font> <font color="#008000"> ,    ,   </font> <font color="#008000">-1      ,  1   </font> <font color="#008000">  ...   0    ...</font> <font color="#008000">       :  </font> <font color="#008000">   3    ,  90 </font> <font color="#008000"> 12- ...</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle ); <font color="#008000">/*</font> <font color="#008000">       : c^2 = a^2 + b^2 - </font> <font color="#008000">    ... =&gt; c = sqrt(a^2 + b^2)</font> <font color="#008000">*/</font> <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt( Math.pow(enemy.x - my_state.x, 2) + Math.pow(enemy.y - my_state.y, 2) ); <font color="#0000ff">return</font> [ 0.5, angle, <font color="#0000ff">this</font> .fire( {x: my_state.x, y: my_state.y}, {x: enemy.x, y: enemy.y}, my_state.angle, distanceToEnemy ), distanceToEnemy ]; };</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I hope with the comments in the code everything is clear ... So, we have several methods that have not yet been described, but are used, which means we need to write them, this is what we will write right now: <br><ul><li>  getNearestEnemy (enemies, myCoords, myAngle) </li><li>  getAngleDeflection (myCoords, enemyCoords, myAngle) </li><li>  fire (myCoords, enemyCoords, myAngle, distance) </li></ul><br><br>  We describe the getNearestEnemy method (enemies, myCoords, myAngle): <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">this</font> .getNearestEnemy = <font color="#0000ff">function</font> (enemies, myCoords, myAngle) { </li><li>  <font color="#0000ff">var</font> howLong = Array ();  <font color="#008000">// This array will contain the ID of the enemies and its range from us</font> </li><li>  <font color="#0000ff">var</font> distance = Array ();  <font color="#008000">// This array will contain the ID and range of the nearest enemy to us</font> </li><li>  <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0; i &lt;enemies.length; i ++) { </li><li>  howLong [i] = Array (); </li><li>  <font color="#008000">/ *</font> </li><li>  <font color="#008000">Get directions in degrees from us to the enemy</font> </li><li>  <font color="#008000">* /</font> </li><li>  <font color="#0000ff">var</font> direction = get_direction (myCoords.x, myCoords.y, enemies [i] [ <font color="#A31515">'x'</font> ], enemies [i] [ <font color="#A31515">'y'</font> ]); </li><li>  <font color="#008000">/ *</font> </li><li>  <font color="#008000">Now the difference between our direction and the direction towards the enemy.</font>  <font color="#008000">This difference also matters</font> </li><li>  <font color="#008000">because</font>  <font color="#008000">time spent on turning too</font> </li><li>  <font color="#008000">* /</font> </li><li>  direction = angle_size (direction, myAngle); </li><li>  <font color="#008000">/ *</font> </li><li>  <font color="#008000">Now summarize the distance and angle difference ...</font> </li><li>  <font color="#008000">* /</font> </li><li>  howLong [i] [ <font color="#A31515">'distance'</font> ] = Math.sqrt ( </li><li>  Math.pow ([i] [ <font color="#A31515">'x'</font> ] - myCoords.x, 2) </li><li>  + Math.pow (enemies [i] [ <font color="#A31515">'y'</font> ] - myCoords.y, 2) </li><li>  ) + direction; </li><li>  howLong [i] [ <font color="#A31515">'id'</font> ] = enemies [i] [ <font color="#A31515">'id'</font> ]; </li><li>  } </li><li>  <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0; i &lt;howLong.length; i ++) { <font color="#008000">// Here we select the ID of the nearest robot</font> </li><li>  <font color="#0000ff">if</font> (! i) distance = howLong [i]; </li><li>  <font color="#0000ff">else</font> <font color="#0000ff">if</font> (distance [ <font color="#A31515">'distance'</font> ]&gt; howLong [i] [ <font color="#A31515">'distance'</font> ]) distance = howLong [i]; </li><li>  } </li><li>  <font color="#0000ff">return</font> distance [ <font color="#A31515">'id'</font> ]; </li><li>  }; </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Now getAngleDeflection (myCoords, enemyCoords, myAngle) method: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">this</font> .getAngleDeflection = <font color="#0000ff">function</font> (myCoords, enemyCoords, myAngle) { <font color="#008000">// Well, everything seems to be clear here)</font> </li><li>  <font color="#0000ff">return</font> get_angle_control ( </li><li>  myAngle, </li><li>  get_direction (myCoords [ <font color="#A31515">'x'</font> ], myCoords [ <font color="#A31515">'y'</font> ], enemyCoords [ <font color="#A31515">'x'</font> ], enemyCoords [ <font color="#A31515">'y'</font> ]) </li><li>  ); </li><li>  }; </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  And the last method is fire (myCoords, enemyCoords, myAngle, distance), it tells us to shoot or not (for example, if we have 100 percent energy but the robot has not yet had time to aim, then it is NOT necessary to shoot): <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">this</font> .fire = <font color="#0000ff">function</font> (myCoords, enemyCoords, myAngle, distance) { </li><li>  <font color="#0000ff">var</font> direction = get_direction (myCoords [ <font color="#A31515">'x'</font> ], myCoords [ <font color="#A31515">'y'</font> ], enemyCoords [ <font color="#A31515">'x'</font> ], enemyCoords [ <font color="#A31515">'y'</font> ]); </li><li>  <font color="#0000ff">var</font> angle = angle_size (direction, myAngle);  <font color="#008000">// Equalize for variable angle difference</font> </li><li>  <font color="#0000ff">if</font> (distance! = 0 &amp;&amp; angle! = 0) { <font color="#008000">// If any of the variables is zero, then theoretically you can shoot</font> </li><li>  <font color="#008000">/ *</font> </li><li>  <font color="#008000">10 divided by the product of distance and angle difference, we obtain the coefficient of "focus"</font> </li><li>  <font color="#008000">* /</font> </li><li>  <font color="#0000ff">if</font> (10 / (distance * angle)&gt; 0.6) <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; </li><li>  <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; </li><li>  } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Everything is ready, now you can assemble our robot in pieces: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">this</font> .getNearestEnemy = <font color="#0000ff">function</font> (enemies, myCoords, myAngle) { </li><li>  <font color="#0000ff">var</font> howLong = Array (); </li><li>  <font color="#0000ff">var</font> distance = Array (); </li><li>  <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0; i &lt;enemies.length; i ++) { </li><li>  howLong [i] = Array (); </li><li>  <font color="#0000ff">var</font> direction = get_direction (myCoords.x, myCoords.y, enemies [i] [ <font color="#A31515">'x'</font> ], enemies [i] [ <font color="#A31515">'y'</font> ]); </li><li>  direction = angle_size (direction, myAngle); </li><li>  howLong [i] [ <font color="#A31515">'distance'</font> ] = Math.sqrt ( </li><li>  Math.pow ([i] [ <font color="#A31515">'x'</font> ] - myCoords.x, 2) </li><li>  + Math.pow (enemies [i] [ <font color="#A31515">'y'</font> ] - myCoords.y, 2) </li><li>  ) + direction; </li><li>  howLong [i] [ <font color="#A31515">'id'</font> ] = enemies [i] [ <font color="#A31515">'id'</font> ]; </li><li>  } </li><li>  <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i = 0; i &lt;howLong.length; i ++) { </li><li>  <font color="#0000ff">if</font> (! i) distance = howLong [i]; </li><li>  <font color="#0000ff">else</font> <font color="#0000ff">if</font> (distance [ <font color="#A31515">'distance'</font> ]&gt; howLong [i] [ <font color="#A31515">'distance'</font> ]) distance = howLong [i]; </li><li>  } </li><li>  <font color="#0000ff">return</font> distance [ <font color="#A31515">'id'</font> ]; </li><li>  }; </li><li></li><li>  <font color="#0000ff">this</font> .getAngleDeflection = <font color="#0000ff">function</font> (myCoords, enemyCoords, myAngle) { </li><li>  <font color="#0000ff">return</font> get_angle_control ( </li><li>  myAngle, </li><li>  get_direction (myCoords [ <font color="#A31515">'x'</font> ], myCoords [ <font color="#A31515">'y'</font> ], enemyCoords [ <font color="#A31515">'x'</font> ], enemyCoords [ <font color="#A31515">'y'</font> ]) </li><li>  ); </li><li>  }; </li><li></li><li>  <font color="#0000ff">this</font> .fire = <font color="#0000ff">function</font> (myCoords, enemyCoords, myAngle, distance) { </li><li>  <font color="#0000ff">var</font> direction = get_direction (myCoords [ <font color="#A31515">'x'</font> ], myCoords [ <font color="#A31515">'y'</font> ], enemyCoords [ <font color="#A31515">'x'</font> ], enemyCoords [ <font color="#A31515">'y'</font> ]); </li><li>  <font color="#0000ff">var</font> angle = angle_size (direction, myAngle); </li><li>  <font color="#0000ff">if</font> (distance! = 0 &amp;&amp; angle! = 0) { </li><li>  <font color="#0000ff">if</font> (10 / (distance * angle)&gt; 0.6) <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; </li><li>  <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">false</font> ; </li><li>  } <font color="#0000ff">else</font> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; </li><li>  } </li><li></li><li>  <font color="#0000ff">this</font> .enemyId = 0; </li><li></li><li>  <font color="#0000ff">this</font> .action = <font color="#0000ff">function</font> (my_state, enemies, shots, <font color="#0000ff">params</font> ) { </li><li>  <font color="#0000ff">if</font> (! <font color="#0000ff">this</font> .enemyd) { </li><li>  <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this.</font> getNearestEnemy ( </li><li>  enemies, </li><li>  {x: my_state.x, y: my_state.y}, </li><li>  my_state.angle </li><li>  ); </li><li>  } </li><li>  <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies) { </li><li>  <font color="#0000ff">if</font> (enemies [key] [ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies [key]; </li><li>  } </li><li>  <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> (enemy) == <font color="#A31515">'undefined'</font> ) { </li><li>  <font color="#0000ff">this</font> .enemyId = <font color="#0000ff">this.</font> getNearestEnemy ( </li><li>  enemies, </li><li>  {x: my_state.x, y: my_state.y}, </li><li>  my_state.angle </li><li>  ); </li><li></li><li>  <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> key <font color="#0000ff">in</font> enemies) { </li><li>  <font color="#0000ff">if</font> (enemies [key] [ <font color="#A31515">'id'</font> ] == <font color="#0000ff">this</font> .enemyId) <font color="#0000ff">var</font> enemy = enemies [key]; </li><li>  } </li><li>  } </li><li>  <font color="#0000ff">var</font> angle = <font color="#0000ff">this</font> .getAngleDeflection ( </li><li>  {x: my_state.x, y: my_state.y}, </li><li>  {x: enemy.x, y: enemy.y}, </li><li>  my_state.angle </li><li>  ); </li><li>  <font color="#0000ff">var</font> distanceToEnemy = Math.sqrt ( </li><li>  Math.pow (enemy.x - my_state.x, 2) </li><li>  + Math.pow (enemy.y - my_state.y, 2) </li><li>  ); </li><li>  <font color="#0000ff">return</font> [ </li><li>  0.5, </li><li>  angle, </li><li>  <font color="#0000ff">this</font> .fire ( </li><li>  {x: my_state.x, y: my_state.y}, </li><li>  {x: enemy.x, y: enemy.y}, </li><li>  my_state.angle, </li><li>  distanceToEnemy </li><li>  ), </li><li>  distanceToEnemy </li><li>  ]; </li><li>  }; </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  Of course, this is not all and you can think of a lot more, for example, often if the robot shoots from far away, the bullet does not reach, this can be corrected if you know the direction of the enemy's movement ... </div><p>Source: <a href="https://habr.com/ru/post/76946/">https://habr.com/ru/post/76946/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../76936/index.html">~ / mysql_history and security</a></li>
<li><a href="../76937/index.html">There are pirates in Australia too!</a></li>
<li><a href="../76941/index.html">Never to fall - Pirate Bay has adapted and survived</a></li>
<li><a href="../76943/index.html">Google abandons Gears in favor of HTML5</a></li>
<li><a href="../76944/index.html">Legends of the gaming industry - Prince of Persia</a></li>
<li><a href="../76948/index.html">Summed up the semi-finals of the competition "Web Ready"</a></li>
<li><a href="../76949/index.html">Google App Engine</a></li>
<li><a href="../76951/index.html">Auditorium - test for all</a></li>
<li><a href="../76952/index.html">Effective employee - no cog</a></li>
<li><a href="../76954/index.html">How do people buy security</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>