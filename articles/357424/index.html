<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Miners and antivirus</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I personally encountered the theme of miners after the statement of German Klimenko that a huge number of Moscow servers are struck by the miners. Bef...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Miners and antivirus</h1><div class="post__text post__text-html js-mediator-article">  I personally encountered the theme of miners after the <a href="http://www.rbc.ru/technology_and_media/24/07/2017/5975d00b9a7947dce3612e8d">statement of</a> German Klimenko that a huge number of Moscow servers are struck by the miners.  Before that, the miners were for me personally only one of the types of malware.  There is not so much time since then, but the number of people who want to make money on other people's computers is growing and I think it's time to talk about this phenomenon. <br><br>  Who cares how many miners are created per day, how they are distributed and (most importantly) how antiviruses treat them - please under the cat! <br><a name="habracut"></a><br>  Let's start with the last stated topic - about the attitude of antiviruses and miners.  To answer this question, you need to understand that there is a malicious program from an anti-virus point of view. <br><br>  A malicious program is a program that is installed on a computer without the user's knowledge or performs unauthorized actions on the user's computer.  The definition is not perfect, but very close to the truth. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Two quotes from the <a href="https://geektimes.ru/post/292749">article</a> : <br><br><blockquote>  The problem for the victim is that her computer infected with a crypto miner runs much slower than usual ... <br><br>  ... advanced malware stops working during the launch of "heavy" applications like games on the PC ... </blockquote><br>  Definitely harmful behavior that makes miners legal booty of antivirus (and other protection systems, because they are not the only antivirus). <br><br>  <b>But can antivirus catch a miner?</b> <br><br><blockquote>  There are a lot of miners, and the difficulty of detecting them is that mining itself is a standard process.  These are not attempts to erase or modify files, change the contents of the boot sector of a hard disk, etc.  No, mining in the usual case will not be determined by antivirus.  Therefore, antivirus developers have to look for new ways to determine the presence of such programs on victims' computers. <br></blockquote><br>  Not certainly in that way.  In the above quote, we are talking about a behavioral analyzer (or its variants - cloud antivirus).  These anti-virus components really track behavior.  And if the malicious program were engaged in pure mining, then it would be impossible to really decide that this is a malicious program or not.  Therefore, I propose to see what are the miners. <br><br>  Roughly speaking, two varieties.  The first implements the mining self-written component.  And here everything is clear - the anti-virus database signatures will not even allow miners to start, no matter how it penetrates the machine.  The above article claims that ‚Äúattackers on the network are infecting, exploiting a vulnerability such as EternalBlue‚Äù.  Similarly, spread Wanna Cry.  But at the same time, it could not always start.  So one of the antiviruses caught it with a heuristic, the other with the included cloud - with its components. <br><br>  <a href="https://news.drweb.ru/show/%3Fi%3D11326">An example of</a> such a miner: <br><blockquote>  Miner Trojan.BtcMine.1259 is downloaded to the computer by Trojan-loader Trojan.DownLoader24.64313, which, in turn, is distributed using the DoublePulsar backdoor.  Immediately after launching, Trojan.BtcMine.1259 checks whether its copy is running on the infected computer.  Then it determines the number of processor cores, and if it is greater than or equal to the number of threads specified in the Trojan‚Äôs configuration, it decrypts and loads the library stored in its body into memory.  This library is a modified version of the open source remote administration system known as Gh0st RAT (it is detected by Dr.Web Anti-virus under the name BackDoor.Farfli.96).  Then Trojan.BtcMine.1259 saves its copy to the disk and starts it as a system service.  After a successful launch, the Trojan attempts to download its update from the management server whose address is specified in the configuration file. <br></blockquote><br>  The second option is to use the usual miner. <br><br>  <a href="http://news.drweb.com/show/%3Fc%3D5%26i%3D1771%26lng%3Dru">Example</a> <br><blockquote>  Trojan.BtcMine.1, uses two legitimate mining programs, by which it uses the computing resources of the victim's computer in order to ‚Äúextract‚Äù virtual coins.  Being an unsuspecting user running on the system, Trojan.BtcMine.1 saves itself to a temporary folder under the name udpconmain.exe.  Then he writes the path to the executable file in the registry key responsible for the application startup.  Then the malware downloads from the Internet and places the second ‚Äúminer‚Äù in the temporary folder under the name miner.exe in order to maximally load the computer with calculations.  After that, the Trojans connect to one of the pools of the payment system and start making calculations, earning the corresponding reward for the intruders.  In the illustration you can see the load on the processor that is created by the miner program launched by the Trojan.BtcMine.1 Trojan. </blockquote><br><img src="https://habrastorage.org/getpro/geektimes/post_images/2f6/3a9/63d/2f63a963d76958d62298186e6beffa5b.jpg" alt="image"><br>  In this case, to start a legitimate miner, you must first deliver it to the machine, start it and preferably hide the presence of the process in the system / icon in the tray.  So there are malicious components that can again be detected either by signature or by behavior. <br><br>  In general - there will be a signature - the miner will not pass.  There will be no signature, the miner will find out by the increased load of the machines and the signature will appear. <br><br>  How many miners are created?  We take a random date on <a href="https://updates.drweb.com/">updates.drweb.com</a> <br><blockquote>  Trojan.BtcMine.1065 (2) Trojan.BtcMine.1084 Trojan.BtcMine.1177 Trojan.BtcMine.1247 Trojan.BtcMine.1336 Trojan.BtcMine.1421 (3) Trojan.BtcMine.1440 Trojan.BtcMine.1447 (2) Trojan .BtcMine.1448 (10) Trojan.BtcMine.1449 Trojan.BtcMine.1500 Trojan.BtcMine.1501 Trojan.BtcMine.1502 (2) Trojan.BtcMine.1503 Trojan.BtcMine.1506 Trojan.BtcMine.1507 Trojan.BtcMine.1508 <br>  Tool.BtcMine.1000 Tool.BtcMine.1001 Tool.BtcMine.1002 Tool.BtcMine.1003 (2) Tool.BtcMine.1004 Tool.BtcMine.1005 Tool.BtcMine.1006 Tool.BtcMine.1007 Tool.BtcMine.1008 (2 ) Tool.BtcMine.1009 (2) Tool.BtcMine.1010 (2) Tool.BtcMine.1011 (4) Tool.BtcMine.1012 Tool.BtcMine.1013 Tool.BtcMine.1014 Tool.BtcMine.1015 Tool.BtcMine.1016 (2) Tool.BtcMine.1021 (2) Tool.BtcMine.1022 Tool.BtcMine.1023 (2) Tool.BtcMine.1024 Tool.BtcMine.1025 Tool.BtcMine.1026 Tool.BtcMine.1027 (3) Tool.BtcMine .1028 (2) Tool.BtcMine.1029 (2) Tool.BtcMine.1030 (2) Tool.BtcMine.230 Tool.BtcMine.278 Tool.BtcMine.288 (7) Tool.BtcMine.390 (2) Tool.BtcMine .433 Tool.BtcMine.483 (2) Tool.BtcMine.573 (3) Tool.BtcMine.800 Tool.BtcMine.810 (11) Tool.BtcMine.916 (2) Tool.BtcMine.917 Tool.BtcMine.943 Tool .BtcMine.944 (7) Tool.BtcMine.948 (2) Tool.BtcMine.958 (3) Tool.BtcMine.968 Tool.BtcMine.970 (4) Tool.BtcMine.973 (4) Tool.BtcMine.974 Tool .BtcMine.975 Tool.BtcMine.976 Tool.BtcMine.977 (4) Tool.BtcMine.978 (6) Tool.BtcMine.979 Tool.BtcMine.980 Tool.BtcMine.  981 (3) Tool.BtcMine.982 Tool.BtcMine.983 Tool.BtcMine.984 Tool.BtcMine.985 Tool.BtcMine.986 Tool.BtcMine.987 (2) Tool.BtcMine.988 Tool.BtcMine.989 Tool.BtcMine .990 Tool.BtcMine.991 (4) Tool.BtcMine.992 Tool.BtcMine.993 Tool.BtcMine.994 Tool.BtcMine.995 Tool.BtcMine.996 (2) Tool.BtcMine.997 Tool.BtcMine.998 Tool. BtcMine.999 Tool.Linux.BtcMine.163 Tool.Linux.BtcMine.164 Tool.Linux.BtcMine.165 Tool.Linux.BtcMine.166 Tool.Linux.BtcMine.167 Tool.Linux.BtcMine.168 Tool.Linux.BtcMine .169 Tool.Linux.BtcMine.170 Tool.Linux.BtcMine.171 Tool.Linux.BtcMine.172 Tool.Linux.BtcMine.173 Tool.Linux.BtcMine.174 Tool.Linux.BtcMine.175 Tool.Linux.BtcMine. 176 Tool.Linux.BtcMine.178 Tool.Linux.BtcMine.179 Tool.Linux.BtcMine.180 Tool.Linux.BtcMine.181 Tool.Linux.BtcMine.182 Tool.Linux.BtcMine.183 Tool.Linux.BtcMine.184 Tool.Linux.BtcMine.186 Tool.Linux.BtcMine.187 Tool.Linux.BtcMine.188 Tool.Linux.BtcMine.189 Tool.Linux.BtcMine.190 Tool.Linux.BtcMine.191 Tool .Linux.BtcMine.194 Tool.Linux.  BtcMine.195 Tool.Linux.BtcMine.196 Tool.Linux.BtcMine.197 Tool.Linux.BtcMine.198 Tool.Linux.BtcMine.199 Tool.Linux.BtcMine.201 Tool.Linux.BtcMine.202 Tool.Linux.BtcMine .203 Tool.Linux.BtcMine.204 Tool.Linux.BtcMine.205 Tool.Linux.BtcMine.206 Tool.Linux.BtcMine.207 Tool.Linux.BtcMine.208 Tool.Linux.BtcMine.209 Tool.Linux.BtcMine. 210 Tool.Linux.BtcMine.211 Tool.Linux.BtcMine.212 Tool.Linux.BtcMine.213 Tool.Linux.BtcMine.214 Tool.Linux.BtcMine.215 Tool.Linux.BtcMine.216 Tool.Linux.BtcMine.219 Tool.Linux.BtcMine.220 Tool.Linux.BtcMine.221 Tool.Linux.BtcMine.222 Tool.Linux.BtcMine.223 Tool.Linux.BtcMine.224 Tool.Linux.BtcMine.225 Tool.Linux.BtcMine.226 Tool .Linux.BtcMine.227 Tool.Linux.BtcMine.228 Tool.Linux.BtcMine.229 Tool.Mac.BtcMine.35 Tool.Mac.BtcMine.36 Tool.Mac.BtcMine.37 Tool.Mac.BtcMine.38 Tool. Mac.BtcMine.39 Tool.Mac.BtcMine.40 Tool.Mac.BtcMine.41 Tool.Mac.BtcMine.42 Tool.Mac.BtcMine.43 Tool.Mac.BtcMine.44 Tool.Mac.BtcMine.45 Tool.Mac .BtcMine.46 Tool.Mac.BtcMine.47 Tool.Mac.BtcMin  e.48 Tool.Mac.BtcMine.50 Tool.Mac.BtcMine.51 Tool.Mac.BtcMine.52 Tool.Mac.BtcMine.53 Tool.Mac.BtcMine.54 Tool.Mac.BtcMine.55 Tool.Mac.BtcMine .56 Tool.Mac.BtcMine.57 </blockquote><br>  On the selected date, Android turned out to be ignored by the virus makers; let's take an example from the <a href="https://news.drweb.ru/show/%3Fc%3D5%26i%3D9222%26lng%3Dru">news</a> <br><blockquote> Android-miners Android.CoinMine.1.origin and Android.CoinMine.2.origin, designed for the extraction of virtual currencies Litecoin, Dogecoin and Casinocoin were distributed by attackers in the popular applications they modified and <b>activated in those periods of time when the mobile device was not used by</b> its owner .  Since these malicious programs actively used the hardware resources of infected smartphones and tablets, this could cause them to overheat, accelerate battery drain and even result in financial losses for users due to excessive consumption of Internet traffic by Trojans.  And in April 2014, new versions of these Trojans appeared, which were discovered in the Google Play catalog and intended for the extraction of Bitcoin cryptocurrency.  These malicious applications were hidden in harmless "live wallpaper" and also began their illegal activities if the infected mobile device was not used for a certain time. </blockquote><br><img src="https://habrastorage.org/getpro/geektimes/post_images/613/f70/f10/613f70f109ff8b65a5dc8b9b429c9254.png" alt="image"><img src="https://habrastorage.org/getpro/geektimes/post_images/8e2/d2e/34f/8e2d2e34f96cae1ba4228177dc54961f.png" alt="image"><br><br>  An example of a miner for Linux can be found <a href="https://news.drweb.ru/show/%3Fi%3D11429">here</a> . <br><br>  <b>How are miners spread?</b> <br><br>  In all ways the spread of malware.  A couple of examples <br><br>  Through the hacked <a href="https://news.drweb.ru/show/%3Fc%3D5%26i%3D9497%26lng%3Dru">site</a> <br><blockquote>  The attackers placed on the VCIOM server web pages from which visitors were offered to download the malware under the guise of various ‚Äúuseful‚Äù files. <br>  Both the Russian-language (wciom.ru) and the English-language (wciom.com) versions of the VTsIOM official web site have been cracked.  Cybercriminals created a special section on the compromised server that hosted web pages with headlines that are highly popular according to search engine statistics: for example, ‚Äúnew-commands-chl-2015-2016‚Äù, ‚Äúdownload-book-metro-2035-in- format-fb2 "," catalogs-avon-12-2015-view-online-free-russia-flipping "," traffic jams-on-the-route-m4-dong-today-online "," download-adblock ", etc. When you try to open such a link in a browser window, the user was shown a fake webpage of a popular file storage service.  ‚ÄúYandex.Disk‚Äù or a web page with the title WCIOM.RU, where a potential victim was offered to download the archive allegedly with some ‚Äúuseful‚Äù content, for example, the popular book ‚ÄúMetro 2035‚Äù or the latest Avon catalog. </blockquote><br>  <a href="https://news.drweb.ru/show/%3Fc%3D5%26i%3D9554%26lng%3Dru">Network</a> scan: <br><br><blockquote>  Trojan.BtcMine.737 lists the computers available in the network environment and tries to connect to them, sorting through logins and passwords using the special list at its disposal.  In addition, the malware is trying to find the password to the local Windows user account.  If this succeeds, Trojan.BtcMine.737, if it has the appropriate equipment, launches an open WiFi access point on the infected computer.  If the malware was able to access one of the computers on the local network, an attempt is made to save and run a copy of the Trojan on it either using the Windows Management Instrumentation (WMI) toolkit or using the Task Scheduler </blockquote><br>  <b>How widespread are miners?</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/546/305/167/546305167a3e6694bc1579a6d6b22222.png" alt="image"></div><br>  In total miners will be about 0.3 of all caught in a month.  Not every month, but periodically miners get into the top of the most common malware. <br><br>  Total: <br><br><ol><li>  Miners are the legitimate goal of antiviruses and, if signatures and rules are present, they can be removed and deleted. </li><li>  Any malware is found and removed by the antivirus only if there are rules / signatures.  Since miners like to create botnets, they fall into the hands of analysts guaranteed </li><li>  Antivirus is not a panacea or a golden bullet.  Therefore, you should not neglect other methods of protection, the same restriction of rights </li></ol><br>  I hope it was interesting, if you have questions - I will try to answer. <br><br>  Update.  Are there miners who are not greedy and do not take all the resources on themselves.  And if so, is it possible to detect them?  Yes, there are such miners, nevertheless, their appearance is accompanied by the appearance of brakes, though small, but brakes.  Lags when starting programs at an unexpected moment.  Therefore, if the computer started to glitch more than normal: <br><ol><li>  Update antivirus and check the system.  It seems ridiculous, but a huge number of people have outdated bases </li><li>  If the databases are fresh, download a different antivirus and check them </li><li>  Check for unknown processes for system services.  As a rule, the miner does not make it difficult to disguise itself and the services / processes are visible.  <a href="https://forum.drweb.com/index.php%3Fshowtopic%3D327849">Example</a> </li></ol><br>  And I recommend to follow that you are trying to access the Internet <br><br>  Update2.  Are there miners whose processes are not visible?  Little, but there is. ... Miner selects an existing system service in netsvcs, replaces the service file, restores the time attributes and starts the service ... But there is no perfection in the world - detected by the processor load <br><br>  Here, apart from a behavioral analyzer, changes in protection measures can hardly be invented.  Plus, of course, control of everything that starts new </div><p>Source: <a href="https://habr.com/ru/post/357424/">https://habr.com/ru/post/357424/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357414/index.html">The state will take control of the critical infrastructure of the Runet</a></li>
<li><a href="../357416/index.html">Account gosuslugi.ru and FZ-152</a></li>
<li><a href="../357418/index.html">And once again about 320 million passwords</a></li>
<li><a href="../357420/index.html">How will execute the law banning Tor, VPN and anonymizers in Russia</a></li>
<li><a href="../357422/index.html">Testing of Russian SSL certificates begins on the website of public services</a></li>
<li><a href="../357426/index.html">Viruses, statistics and a bit of everything</a></li>
<li><a href="../357428/index.html">Your phone is the key to your money or the security of entering the Sberbank mobile app.</a></li>
<li><a href="../357430/index.html">Kinopoisk: with tens of thousands of hacked accounts scored a rating of the film "Crimea"</a></li>
<li><a href="../357432/index.html">Should I wait for new botnets from online cash registers?</a></li>
<li><a href="../357434/index.html">Over 37,000 Chrome users install fake AdBlock Plus extension</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>