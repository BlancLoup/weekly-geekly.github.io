<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Malicious software to steal bitcoins spread through Download.com</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you ask an IT professional about basic security measures on the Internet, he will probably advise downloading software only from legitimate sites. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Malicious software to steal bitcoins spread through Download.com</h1><div class="post__text post__text-html js-mediator-article">  If you ask an IT professional about basic security measures on the Internet, he will probably advise downloading software only from legitimate sites.  It is a pity that this is not a panacea.  We found three trojanized applications hosted on download.cnet.com - one of the most popular sites in the world (163 in <a href="https://www.alexa.com/topsites">Alexa</a> ranking). <br><br><img src="https://habrastorage.org/webt/mo/yy/8p/moyy8pw_db-b6w_qcg5mkhjkid4.jpeg"><br><br><a name="habracut"></a>  One of Malvari's victims was Crawsh, a user of subreddit / r / monero, but in his case the story ended well. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/c0/is/wd/c0iswd1kspu1ibc2t_ku4qwepja.png"><br><br>  Crawsh suspected something was wrong when he tried to copy and paste the address of his Monero wallet to transfer funds there, and suddenly saw a message that the address was invalid.  He decided to figure out what could be the cause of the error, and found out that the problem is in malware.  Malvar intercepted the user's wallet address on the clipboard and replaced it with its own bitcoin wallet, which was hard-coded. <br><br>  Fortunately for Crawsh, the attacker's address was intended for bitcoin transactions.  The target application rejected Monero before the user transferred the funds.  Unlike other victims working with bitcoins, their transfers were made without failures.  To date, the attackers have collected 8.8 military-technical cooperation - about 4 million rubles (at the exchange rate for March 15). <br><br>  ‚ÄúAlmost injured‚Äù Crawsh wrote about the incident at Sabreddit / r / Monero.  Post noticed in ESET and conducted an investigation to find out the circumstances of the infection and help potential victims. <br><br>  After checking the Google bitcoin address of the attackers, we found several victims.  In particular, someone wrote a post about hacking a site (not associated with this malware).  But in the text, the original Bitcoin wallet address has been replaced by the already familiar Bitcoin abductor address (see figure below).  It is possible that the author of the post is faced with the same malware as Crawsh. <br><br><img src="https://habrastorage.org/webt/5w/bt/ww/5wbtww3odusnyy2f9sojtwhb8a0.png"><br><img src="https://habrastorage.org/webt/zv/rl/gr/zvrlgr8vwfzaa9uh6e1hrwg010w.png"><br><br><h3>  Spread </h3><br>  We found out that the Crawsh user‚Äôs computer was infected with a Trojanized Win32 Disk Imager application downloaded from download.com, where it was hosted since May 2, 2016. <br><br>  ESET anti-virus products detect this application as MSIL / TrojanDropper.Agent.DQJ.  The program was downloaded from CNET 311 times just last week and more than 4500 times in total. <br><br><img src="https://habrastorage.org/webt/tt/vg/ls/ttvglso36unndfl0grciee5-n-s.png"><br><br>  Later we discovered that Win32 Disk Imager is not the only trojanized application on download.com.  Found at least two programs of the same authors.  The first is CodeBlocks, it contains the same payload (MSIL / CLipBanker.DF) and is already blocked by CNET.  CodeBlocks is a popular cross-platform development environment (IDE - Integrated Development Environment) based on open source code, it is used by many C / C ++ developers. <br><br><img src="https://habrastorage.org/webt/xp/ld/z2/xpldz234hooyeiwysve8xkidnfg.png"><br><br>  The second trojanized application is MinGW-w64, available for download at the time of the start of the study.  Its payload includes malware to steal bitcoins and a virus.  MinGW - compiler, software port GNU Compiler Collection for Microsoft Windows. <br><br><img src="https://habrastorage.org/webt/ns/2-/is/ns2-isihvujqn6lzgwf9gr7wnz4.png"><br><br>  Below is the download statistics for these applications (information from download.com).  Please note that the number of recent downloads of CodeBlocks is zero because the program has been removed by CNET.  We do not know the exact date of removal, but, according to our telemetry, this could happen in March 2017. <br><br><img src="https://habrastorage.org/webt/qq/e-/sa/qqe-samqa_ayh99d37s1vcxbbmu.png"><br><br>  After an ESET warning, CNET promptly removed malicious applications. <br><br><h3>  Analysis </h3><br>  <b>Troyanizirovanny dropper (MSIL / TrojanDropper.Agent.DQJ)</b> <br><br>  At the first stage, a simple dropper extracts the legitimate application installer (Win32DiskImager, CodeBlocks, MinGw) and the payload from the resources, saves both files to the% temp% folder and executes them. <br><br><img src="https://habrastorage.org/webt/pu/oq/ra/puoqra3ipwvn40exyw_juffmkgk.png"><br><br>  <b>Malicious software that replaces the addresses of the purses in the clipboard</b> <br><br>  <b>1. MSIL / ClipBanker.DF</b> <br><br>  The Malvari payload resembles a dropper in terms of simplicity.  The program copies itself to the path <code>%appdata%\Dibifu_8\go.exe</code> and adds an autorun key to the registry to ensure persistence. <br><br>  Replacing the address of a Bitcoin wallet is done with a simple code, which can be seen in the figure below.  The code searches for a bitcoin address using a regular expression and replaces it with the address of a hard-coded wallets of attackers: 1BQZKqdp2CV3QV5nUEsqSg1ygegLmqRygj. <br><br><img src="https://habrastorage.org/webt/gj/76/wq/gj76wqhyi5mscbcpgh6bfvs9vd8.png"><br><br>  The attackers did not make any special efforts to conceal the activity, since even the path of the dropper debugging symbol and ClipBanker demonstrate their intentions.  We believe that SF to CNET (see below) means SourceForce to CNET, since all three applications have clean instances in the source code repository. <br><br> <code>C:\Users\Ngcuka\Documents\V\SF to CNET\Btc Clipboard Rig\WindowsFormsApplication1\obj\x86\Release\WindowsFormsApplication1.pdb</code> <br> <br><img src="https://habrastorage.org/webt/fs/kk/ty/fskktyi7-qo1446iuveegichzku.png"><br><br>  There are several additional infection indicators that victims can check.  In particular, the payload and the trojanized packet are reset to% temp% under the names y3_temp008.exe and Win32DiskImage_0_9_5_install.exe, respectively, and are executed. <br><br>  <b>2. Win32 / ClipBanker.DY</b> <br><br>  Malvari's payload is reset by the Trojanized MinGW-w64 application.  This is a slightly more complicated variant, using a similar regular expression to search for a wallet: <br><br><img src="https://habrastorage.org/webt/q4/yu/-i/q4yu-iwm4oxjkz8mlkfo2fux6ou.png"><br><br>  In addition, it contains additional malicious components, encrypted in resources, and about 3,500 addresses of bitcoin wallets (see figure). <br><br><img src="https://habrastorage.org/webt/az/n7/t5/azn7t5vkldohjqb7scy51vyjt7m.png"><br><br>  The additional payload delivered along with malware to steal bitcoins also has a PDB path.  One of them is <code>C:\Users\Ngcuka\Documents\V\Flash Spreader\obj\x86\Release\MainV.pdb</code> . <br><br>  The username is identical to the name found in the PDB path of the first Malvari.  Thus, we are sure that these malicious programs were developed by the same author. <br><br><h3>  How to clean the infected system </h3><br>  - Remove the following downloaded installers: win32diskimager.exe (SHA1: 0B1F49656DC5E4097441B04731DDDD02D4617566);  codeblocks.exe (SHA1: 7242AE29D2B5678C1429F57176DDEBA2679EF6EB);  mingw-w64-install.exe (SHA1: 590D0B13B6C8A7E39558D45DFEC4BDE3BBF24918) from the download folder <br>  - Delete the executable file in the% appdata% \ dibifu_8 \ folder (SHA1: E0BB415E858C379A859B8454BC9BA2370E239266) <br>  - Delete the file y3_temp008.exe from the folder% temp% \ (SHA1: 3AF17CDEBFE52B7064A0D8337CAE91ABE9B7E4E3; C758F832935A30A865274AA683957B8CBC65DFDE) <br>  - Delete the registry entry ScdBcd from HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Run <br><br>  During the study, we reported a problem to CNET, and they promptly removed trojnized applications from the site, preventing the further spread of malware. <br><br>  If you suspect your computer has been infected, install a modern anti-virus solution that automatically deletes files.  <b>The most effective measure of protection against spoofing the contents of the clipboard is double-checking addresses when performing transactions.</b> <br><br><h3>  Indicators of compromise </h3><br>  <b>Triple applications:</b> <br><br>  win32diskimager.exe 0B1F49656DC5E4097441B04731DDDD02D4617566 MSIL / TrojanDropper.Agent.DQJ trojan <br>  codeblocks.exe 7242AE29D2B5678C1429F57176DDEBA2679EF6EB MSIL / ClipBanker.EY trojan <br>  mingw-w64-install.exe 590D0B13B6C8A7E39558D45DFEC4BDE3BBF24918 MSIL / TrojanDropper.Agent.DQJ trojan <br><br>  <b>ClipBankers:</b> <br><br>  mingw-w64 payload # 1 BE33BDFD9151D0BC897EE0739F1137A32E4437D9 Win32 / ClipBanker.DY trojan <br>  mingw-w64 payload # 1 2EABFFA385080A231156420F9F663DC237A9843B Win32 / ClipBanker.DY trojan <br>  mingw-w64 payload # 1 7B1E9A6E8AF6D24D13F6C561399584BFBAF6A2B5 Win32 / ClipBanker.DY trojan <br>  codeblocks.exe payload E65AE5D0CE1F675962031F16A978F582CC67D3D5 MSIL / ClipBanker.AB trojan <br>  win32diskimager.exe payload E0BB415E858C379A859B8454BC9BA2370E239266 MSIL / ClipBanker.DF trojan <br><br>  <b>URLs:</b> <br><br>  MinGW-w64: <a href="http://download.cnet.com/MinGW-w64/3000-2069_4-77411782.html">download.cnet.com/MinGW-w64/3000-2069_4-77411782.html</a> <br>  Win32 Disk imager: <a href="http://download.cnet.com/Win32-Disk-Imager/3000-2242_4-76554991.html">download.cnet.com/Win32-Disk-Imager/3000-2242_4-76554991.html</a> <br>  CodeBlocks: <a href="http://download.cnet.com/Code-Blocks/3000-2212_4-10516243.html">download.cnet.com/Code-Blocks/3000-2212_4-10516243.html</a> </div><p>Source: <a href="https://habr.com/ru/post/351262/">https://habr.com/ru/post/351262/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351252/index.html">Let's Encrypt began issuing wildcard certificates</a></li>
<li><a href="../351254/index.html">Using environment variables in Node.js</a></li>
<li><a href="../351256/index.html">How JS Works: Tracking DOM Changes with MutationObserver</a></li>
<li><a href="../351258/index.html">Fintech-digest. African heat, identification methods and cryptocrolics</a></li>
<li><a href="../351260/index.html">Building a network for storage systems, SMB sector: Part 1. Selection of network equipment</a></li>
<li><a href="../351264/index.html">How to get to the investor: a short way through retail</a></li>
<li><a href="../351266/index.html">Compress and improve handwritten notes</a></li>
<li><a href="../351268/index.html">Twice as powerful for the same money! Intel Xeon E5 vs. E3-series</a></li>
<li><a href="../351272/index.html">Future technologies: rejection of physical SIM cards</a></li>
<li><a href="../351276/index.html">PHDays technical program: how to break IoT, bypass Windows Hello and are protected from a quantum computer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>