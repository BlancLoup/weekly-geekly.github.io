<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Philosophy or when the letters were green</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Previously, everything was better: the computers were large, and the letters on the screen were green. Then they were called computers, and engineers ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Philosophy or when the letters were green</h1><div class="post__text post__text-html js-mediator-article">  Previously, everything was better: the computers were large, and the letters on the screen were green.  Then they were called computers, and engineers went around the engine room in white coats.  In those blessed times, no one bothered about user-friendly interfaces, but simply required the user to prepare a deck of punch cards in accordance with a specific format.  Prepared wrong - himself to blame.  This does not seem very convenient and is not at all ‚Äúintuitively understandable,‚Äù but this Spartan approach made it possible to calculate some very serious tasks, such as modeling nuclear reactions or calculating the flight task for space rockets.  And all this with resources, two or three orders of magnitude smaller than almost any modern smartphone. <br><br>  Time passed, and punch cards with magnetic drums sank into oblivion, in favor of the user, programs with a developed GUI began to dominate.  It began to be presented as technical progress and concern for user convenience.  Is it always good?  Is it always more convenient than a regular text configuration file?  Is it convenient to perceive something? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/956/797/5c3/9567975c31224dacb1650b1d1a953bf1.jpg" alt="image"></div><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/web/1c0/d94/0e1/1c0d940e13f64fae866a42738f08c288.jpg" alt="image"></div><br>  Not really ... The nesting of tuning windows is more than 2 levels, in each of which there are a dozen of two or three ‚Äúpuffs‚Äù - is this convenient?  And if you are an administrator, and you need to replicate this engineering marvel for two hundred jobs with all the settings?  Oh ... how good it was before, when you just could put a configuration file next. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Indeed, the test configuration file has a lot of advantages, and it is not at all obsolete: <br><br>  ‚Ä¢ no need to write a very time-consuming GUI to configure the software <br>  ‚Ä¢ easily replicated with software; <br>  ‚Ä¢ easy to create programmatically, if it is great; <br>  ‚Ä¢ if the configuration file uses the principle of optional parameters, it can be made more readable than many forms with dozens of controls. <br><br>  There is only one serious problem with the configuration file: if the syntax is clear and readable, then the parser is a rather laborious product.  Separate individuals may argue that there is XML in the world for which everything is ready for a long time, but I would not call XML a well-read and convenient format.  To the advocates of this approach, I would like to work with large XML tables in the field, having at hand only the editor vi.  I am sure that it will sober up the supporters of XML. <br><br>  It is very convenient to work with the configuration file, the syntax of which is as close to the application as possible.  In this case, the best option is to create a parser using a parser generator, for example, one of those listed in <a href="https://en.wikipedia.org/wiki/Comparison_of_parser_generators">this list</a> . <br><br>  Of all the variety, the COCO / R generator, created at the University of Linz in Upper Austria, is distinguished by its simplicity and affordability.  I selected it based on the following considerations: <br><br>  ‚Ä¢ it can create parsers for C, C ++, C #, F #, Java, Ada, all types of Pascal, Modula, Ruby and several other languages; <br>  ‚Ä¢ tokens and actions with them are described in one file, which is easy to read; <br>  ‚Ä¢ it can be built and used on any platform; <br>  ‚Ä¢ it can be integrated into Visual Studio (a trifle, but nice). <br><br>  I will not go into the specifics of using COCO / R, since this is beautifully written in its documentation, but I will immediately turn to a practical example. <br><br>  We create a parser to build an abstract network routing table consisting of several routers and several end devices.  It is convenient to present the general view of the configuration file as follows (herewith, we are in no way limited by the number of routers, the number of ports on them and the number of terminals): <br><br><pre><code class="hljs pgsql">//     <span class="hljs-number"><span class="hljs-number">1102</span></span> DEVICE ID=(<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) DI=<span class="hljs-number"><span class="hljs-number">0x03740038</span></span> <span class="hljs-type"><span class="hljs-type">NAME</span></span>="sw1102" UMASK=<span class="hljs-number"><span class="hljs-number">0666</span></span> CAPS={MN} { PORT = <span class="hljs-number"><span class="hljs-number">7</span></span> PW=X1 LS=G25 ID={ <span class="hljs-number"><span class="hljs-number">0</span></span> }, //  PORT = <span class="hljs-number"><span class="hljs-number">9</span></span> PW=X4 LS=G3125 ID={ <span class="hljs-number"><span class="hljs-number">8</span></span> }, //  PORT = <span class="hljs-number"><span class="hljs-number">10</span></span> PW=X4 LS=G25 ID={ <span class="hljs-number"><span class="hljs-number">16</span></span> } //   }; DEVICE ID=(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) DI=<span class="hljs-number"><span class="hljs-number">0x04000003</span></span> <span class="hljs-type"><span class="hljs-type">NAME</span></span>="host" UMASK=<span class="hljs-number"><span class="hljs-number">0444</span></span> CAPS={ MN,MB0, DB,DIO }; DEVICE ID=(<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-type"><span class="hljs-type">NAME</span></span>="meter" UMASK=<span class="hljs-number"><span class="hljs-number">0444</span></span> CAPS={ MN,MB0,MB1,MB2,MB3,DB,DIO }; DEVICE ID=(<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) DI=<span class="hljs-number"><span class="hljs-number">0x03780038</span></span> <span class="hljs-type"><span class="hljs-type">NAME</span></span>="sw1101" UMASK=<span class="hljs-number"><span class="hljs-number">0444</span></span> CAPS={ MN } { PORT = <span class="hljs-number"><span class="hljs-number">12</span></span> PW=X1 LS=G25 ID={ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span> } // , ,   };</code> </pre> <br>  Now we build the syntax descriptor for the parser (we build the parser for C ++): <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// #include &lt;_&gt; COMPILER SRIO_CONFIG //    CHARACTERS letter = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz". digit = "0123456789". cr = '\r'. lf = '\n'. tab = '\t'. stringch = ANY - '"' - '\\' - cr - lf - tab. hexDigit = "0123456789abcdefABCDEF". printable = '\u0020' .. '\u007e'. TOKENS ident = letter {"_"} { letter | "_" | digit }. number = digit { digit } | "0x" hexDigit {hexDigit}. string = '"' { stringch | "\"\"" } '"' . COMMENTS FROM "/*" TO "*/" NESTED COMMENTS FROM "//" TO lf IGNORE cr + lf + tab PRODUCTIONS //      DEVICE&lt;int &amp;iStepDefNo&gt; (. ConfDevice dev; dev.iStepNo=iStepDefNo; .) = "DEVICE" (. dev.iId = 0xFF; dev.iHopCnt=0xFF; .) [ { DEVNAME&lt;dev&gt; | "ID" "=" "(" NUMBER&lt;dev.iId&gt; "," NUMBER&lt;dev.iHopCnt&gt; ")" | "DI" "=" NUMBER&lt;(int &amp;)dev.uDidCar&gt; | DEVCAPS&lt;dev&gt; | "UMASK" "=" NUMBER&lt;(int &amp;)dev.uMask&gt; } ] [ "{" { (. ConfPort cport; .) ASSIGPort&lt;cport&gt; (. dev.lstPorts.Add(cport); .) [","] } "}" ] [ ";" ] (. m_pDevices-&gt;Add(dev); .) . //     ASSIGPort&lt;ConfPort &amp;pPort&gt; (. int num=-1; .) = "PORT" "=" NUMBER&lt;pPort.nPort&gt; { "PW" "=" PW&lt;pPort.Pw&gt; | "LS" "=" LS&lt;pPort.Ls&gt; | "ID" "=" "{" NUMBER&lt;num&gt; (. pPort.lstIds.Push(num); .) { ',' NUMBER&lt;num&gt; (. pPort.lstIds.Push(num); .) } "}" } . //      PW&lt;ePW &amp;pw&gt; (. int iTmp=0; .) = ( "X1" (. pw = PWX1; .) | "X2" (. pw = PWX2; .) | "X4" (. pw = PWX4; .) | "X1L0" (. pw = PWX1L0; .) | "X1L1" (. pw = PWX1L1; .) | "X1L2" (. pw = PWX1L2; .) |NUMBER&lt;iTmp&gt; (. pw=(ePW)iTmp; .) ) . //     LS&lt;eLS &amp;ls&gt; (. int iTmp=0; .) = ( "G125" (. ls = LSG125; .) | "G25" (. ls = LSG25; .) | "G3125" (. ls = LSG3125; .) | "G5" (. ls = LSG5; .) | "G625" (. ls = LSG625; .) |NUMBER&lt;iTmp&gt; (. ls=(eLS)iTmp; .) ) . //  ,    STRING&lt;CStr &amp;str&gt; = string (. str=CStr::FromPosLen(t-&gt;val, 1, strlen(t-&gt;val)-2); .) . //  10-  16-  NUMBER&lt;int &amp;value&gt; = number (. value=Utils::ToInt32(t-&gt;val); .) . //   (,   devfs  ) DEVNAME&lt;ConfDevice &amp;dev&gt; (. CStr str; .) = "NAME" "=" STRING&lt;str&gt; (. strcpy(dev.szName, (LPCSTR)str); .) . //  API  DEVCAPS&lt;ConfDevice &amp;dev&gt; (. dev.uCaps = 0; .) = "CAPS" "=" "{" { [','] ( "MN" (. dev.uCaps |= MN; .) |"MB0" (. dev.uCaps |= MB0; .) |"MB1" (. dev.uCaps |= MB1; .) |"MB2" (. dev.uCaps |= MB2; .) |"MB3" (. dev.uCaps |= MB3; .) |"DB" (. dev.uCaps |= DB; .) |"DIO" (. dev.uCaps |= DIO; .) |"ST" (. dev.uCaps |= ST; .) ) } "}" . ////////////////////////////////////////////////////////////// //   SRIO_CONFIG = DEVICE&lt;iStepDefNo&gt; { DEVICE&lt;iStepDefNo&gt; } . END SRIO_CONFIG</span></span></code> </pre><br>  It turns out very briefly and elegantly.  Now it is enough to pass this descriptor through the parser generator.  In this case, a generator modified by me many years ago was used: <br><br><pre> <code class="hljs coffeescript">D:\WRL&gt;cocor cocor ‚Äìnamespace cfg sdrv_conf.atg Coco/R (Nov <span class="hljs-number"><span class="hljs-number">17</span></span>, <span class="hljs-number"><span class="hljs-number">2010</span></span>), changed <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> APRCPV checking sdrv_conf.atg(<span class="hljs-number"><span class="hljs-number">1</span></span>): warning LL1: <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> DEVICE: contents <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> [...] <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> {...} must <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> be deletable sdrv_conf.atg(<span class="hljs-number"><span class="hljs-number">1</span></span>): warning LL1: <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> BLK_STEPDEF: <span class="hljs-string"><span class="hljs-string">"DEVICE"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> start &amp; successor <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> deletable structure parser + scanner generated <span class="hljs-number"><span class="hljs-number">0</span></span> errors detected D:\WRL &gt;</code> </pre><br>  The result of the generator is the Parser.cpp files of Scanner.cpp Parser.h Scanner.h, which we will immediately include in the project and can immediately use: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadConfigFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> bSuc=<span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     if (access(m_szConfFileName, 0)!=0) { TRACE(eLL_CRIT, "Error: Configuration file '%s' not found or unaccessable!\n", m_szConfFileName); abort(); } cfg::Scanner &amp;s = *new cfg::Scanner(m_szConfFileName); //   cfg::Parser &amp;p = *new cfg::Parser(&amp;s); //   p.m_pConfigData = this; //      p.Parse(); //     //        //  ,      : error(row:col) bSuc=(p.errors-&gt;count &lt; 1); delete &amp;p; delete &amp;s; //       return bSuc; }</span></span></code> </pre><br>  It's done, now my program is able to perceive the configuration file in the format in which it is convenient to write.  Moreover, you can always change the syntax and add new features to it. <br><br>  Using this technology, you can not only parse the configuration files, but generally disassemble any formal syntax, which is very useful.  For example, you can create a specialized editor with syntax highlighting no worse than in Eclipse or Visual Studio, but only the syntax we can define ourselves. <br><br>  And now let's fantasize a bit ... Surely, many were not bothered by the laurels of Nicholas Wirth or Kernighan and Ricci: why did they manage to develop a new programming language, but I can't ?!  And indeed, why?  After all, from building a configuration file parser to a programming language is just one step.  You can write an interpreter, but you can also have a fully-fledged compiler if you add code generation, which we have already discussed <a href="https://habrahabr.ru/post/327580/">in one of the articles</a> . <br><br>  <i>Arkady Pchelintsev, project architect</i> </div><p>Source: <a href="https://habr.com/ru/post/328296/">https://habr.com/ru/post/328296/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../328284/index.html">Game development based on physical simulation (for realistic destructible game world)</a></li>
<li><a href="../328286/index.html">The delay in online broadcasts from a webcam, you heartless bitch</a></li>
<li><a href="../328288/index.html">Returning a customer is easy - don't let him go</a></li>
<li><a href="../328290/index.html">Troubleshooting MySQL Access Permissions: Frequently Asked Questions</a></li>
<li><a href="../328294/index.html">12 tools for debugging .NET-applications for performance and memory</a></li>
<li><a href="../328298/index.html">Good in the village in the summer with stagabitnom Internet</a></li>
<li><a href="../328300/index.html">Contemplation Syndrome</a></li>
<li><a href="../328304/index.html">Hi, SaaS | 5 reasons to stay with amoCRM</a></li>
<li><a href="../328306/index.html">What should a network engineer know? Check list</a></li>
<li><a href="../328308/index.html">The best tricks of minimal design</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>