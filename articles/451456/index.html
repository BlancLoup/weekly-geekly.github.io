<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Russian storage AERODISK: load testing. Squeeze the IOPS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! As promised, we publish the results of the load test of the Russian-made data storage system - AERODISK ENGINE N2. 


 In the last article, we ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Russian storage AERODISK: load testing. Squeeze the IOPS</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/uj/gt/g3/ujgtg3hzch1rzeuhtxa240tpdsi.jpeg"></p><br><p>  Hello!  As promised, we publish the results of the load test of the Russian-made data storage system - AERODISK ENGINE N2. </p><a name="habracut"></a><br><p>  In the last article, we broke the storage system (i.e., we performed crash tests) and the crash test results were positive (that is, we never broke the data storage system).  The results of the crash test can be found <a href="https://habr.com/ru/company/aerodisk/blog/447070/">HERE</a> . </p><br><p>  In comments to the previous article, there were suggestions for additional - more cunning crash tests.  We fixed them all and we will definitely implement them in one of the following articles.  At the same time, you can visit our laboratory in Moscow at any time (come by foot or do it remotely via the Internet) and perform these tests yourself (you can even do testing for a specific project :-)).  Write to us, consider all the scenarios! </p><br><p>  In addition, if you are not in Moscow, you can, however, also take a closer look at our storage system by visiting a free training event at the center of competence in the city closest to you. </p><br><p>  Below is a list of upcoming events and the dates of work of the competence centers. </p><br><ul><li>  Yekaterinburg.  May 16, 2019.  Training workshop.  You can register via the link: <a href="https://aerodisk.promo/ekb/">https://aerodisk.promo/ekb/</a> </li><li>  Yekaterinburg.  May 20 - June 21, 2019.  Competence Center.  Come to any working time for a live demonstration of the storage system AERODISK ENGINE N2.  The exact address and link to registration will be later.  Watch for information. </li><li>  Novosibirsk  FOLLOW INFORMATION ON OUR SITE or ON HABRA. <br>  October 2019 </li><li>  Kazan  FOLLOW INFORMATION ON OUR SITE or ON HABRA. <br>  October 2019 </li><li>  Krasnoyarsk.  FOLLOW INFORMATION ON OUR SITE or ON HABRA. <br>  November 2019 </li></ul><br><p>  We also want to share another good news: we finally finally earned our <a href="https://www.youtube.com/channel/UCOnFSximR_IIBQVhAc6909g">YouTube</a> channel, where you can watch videos from past events.  In the same place we regularly post our educational videos. </p><br><h2 id="testovyy-stend">  Test stand </h2><br><p>  So back to the tests.  We upgraded our laboratory storage ENGINE N2, installing additional SAS SSD drives, as well as Front-end Fiber Channel 16G adapters.  In a symmetrical way, we have upgraded the server from which we will load, adding the FC 16G adapters there. </p><br><p>  As a result, we have in labs a 2-controller storage system with 24 SAS SSD 800GB, 3 DWPD disks, which is connected via SAN switches to a physical Linux server via FC 16G. <br>  The scheme of the test stand in the figure below. </p><br><p><img src="https://habrastorage.org/webt/2u/k8/f9/2uk8f9p2wcxh1qkejgcylejodwm.png"></p><br><h2 id="metodika-testirovaniya">  Testing method </h2><br><p>  For the best performance on the block access, we will use the DDP (Dynamic Disk Pool) pools, which we once created for the ALL-FLASH systems. <br>  For testing, we created two LUNs with a capacity of 1 TB each with a RAID-10 protection level.  We will ‚Äúspread‚Äù each LUN on 12 disks (24 in total) in order to fully utilize the potential of each of the installed disks in the storage system. </p><br><p>  LUNs are presented to the server through different controllers in order to maximize the utilization of storage resources. </p><br><p>  Each of the tests will last for one hour, and the tests will be performed by the Flexible IO (FIO) program, the FIO data will automatically be uploaded to Excel, in which graphs are already being built, for clarity. </p><br><h3 id="profili-nagruzki">  Load profiles </h3><br><p>  In total, we will perform three tests for one hour without taking into account the warm-up time, to which we allocate 15 minutes (this is exactly what is needed to warm up an array of 24 SSD disks).  These tests emulate the most frequently encountered load profiles, in particular, these or those DBMS, video surveillance systems, broadcast media content and backup. </p><br><p>  Also in all tests, we deliberately turned off the possibility of caching into RAM on the storage system and on the host.  The results, of course, will worsen it, but, in our opinion, in such conditions the test will be more honest. </p><br><h2 id="rezultaty-testov">  Test results </h2><br><p>  <strong>Test number 1.</strong>  <strong>Random load of small blocks.</strong>  Emulation of high-load transactional DBMS. </p><br><ul><li>  Block size = 4k </li><li>  Read / write = 70% / 30% </li><li>  Number of works = 16 </li><li>  Queue Depth = 32 </li><li>  Character load = Full Random </li></ul><br><p><img src="https://habrastorage.org/webt/ik/3-/ae/ik3-aerqgglbsfdws6ozlnzbpmg.png"></p><br><p><img src="https://habrastorage.org/webt/ss/3-/mj/ss3-mjplbuxjimcbevjyz6fjq8c.png"></p><br><p>  Test results: </p><br><p><img src="https://habrastorage.org/webt/ds/pr/h-/dsprh-xsreu3furbzl90m0dc4xy.png"></p><br><p>  Total from the junior mid-range of the Engine N2 system, we received 438k IOPS with a delay of 2.6 milliseconds.  Given the class of the system, in our opinion, the result is quite decent.  To understand whether this is the limit for the system, we will look at the utilization of storage controller resources. </p><br><p>  We are primarily interested in the CPU, because, as stated above, we deliberately disabled the RAM cache so as not to distort the test results. </p><br><p>  On both storage controllers, we see roughly the same picture. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/st/dr/r2/stdrr25vmyjtez-hc9kwlridbk0.png"></a> </p><br><p>  That is, the CPU load is 50%.  This suggests that this is still far from the limit of this storage system and you can still safely scale it.  Let's run a little ahead: all the following tests also showed a load on the controller processors in the region of 50%, therefore we will not re-bring them. </p><br><p>  Based on our laboratory tests, the comfortable limit of the AERODISK Engine N2 system, if we assume random IOPS with 4k blocks is ~ 700 000 IOPS.  If this is not enough and you need to strive for a million, then we have the older model ENGINE N4. </p><br><p>  That is, the story about millions of IOPS is ENGINE N4, and if a million is too much for you, then calmly use N2. </p><br><p>  We return to the tests. </p><br><p>  <strong>Test number 2.</strong>  <strong>Sequential write large blocks.</strong>  Emulation of video surveillance systems, loading data into an analytical database or recording backup copies. </p><br><p>  In this test, we are no longer interested in IOPSs, since with consistent load in large blocks they do not make any sense.  First of all, we are interested in: the recording stream (megabytes per second) and the delays, which with large blocks, of course, will be higher than with small ones. </p><br><ul><li>  Block size = 128k </li><li>  Read / write = 0% / 100% </li><li>  Number of works = 16 </li><li>  Queue Depth = 32 </li><li>  The nature of the load - Sequential </li></ul><br><p><img src="https://habrastorage.org/webt/jx/g8/c1/jxg8c1sqy-xrvstsnywth1wypvw.png"></p><br><p><img src="https://habrastorage.org/webt/qo/kf/_k/qokf_knndwunfvn0pdle1geycf0.png"></p><br><p><img src="https://habrastorage.org/webt/z6/vp/rw/z6vprw755rfukhjqkqtackszndq.png"></p><br><p>  Total: we have a record of five and a half gigabytes per second with delays of eleven milliseconds.  If we compare it with our closest foreign competitors, the result, in our opinion, is excellent, and also is not the limit of the ENGINE N2 system. </p><br><p>  <strong>Test number 3.</strong>  <strong>Sequential reading in large blocks.</strong>  Emulation of broadcasting media content, generating reports from an analytical database or recovering data from backups. </p><br><p>  As in the past test, we are interested in flow and delays. </p><br><ul><li>  Block size = 128k </li><li>  Read / write = 100% / 0% </li><li>  Number of works = 16 </li><li>  Queue Depth = 32 </li><li>  The nature of the load - Sequential </li></ul><br><p><img src="https://habrastorage.org/webt/ab/jr/ff/abjrffrngftgpvnplxuht65icgm.png"></p><br><p><img src="https://habrastorage.org/webt/1i/cy/ca/1icycakntgog_iqjvi1x7bl_o6e.png"></p><br><p><img src="https://habrastorage.org/webt/te/nw/0w/tenw0wp3cr8--e1dvqyxdm7dohw.png"></p><br><p>  Streaming read performance is predictable slightly better than streaming performance. </p><br><p>  Interestingly, the rate of delays in the entire test is identical (straight line).  This is not an error, in case of sequential reading in large blocks in our case, this is a common situation. </p><br><p>  Of course, if we leave the system in this form for a couple of weeks, we will eventually see periodic jumps on the charts that will be associated with external factors.  But, in general, they will not affect the picture. </p><br><h2 id="vyvody">  findings </h2><br><p>  With the AERODISK ENGINE N2 dual-controller system, we were able to squeeze out quite serious indicators (~ 438,000 IOPS and ~ 5-6 gigabytes per second).  Load tests showed that we are definitely not ashamed of our storage.  On the contrary, the indicators are very decent and correspond to a good storage system. </p><br><p>  Although, as we wrote above, Engine N2 is the youngest model, and besides, the results shown in this article are not its limit.  Later we will publish a similar test with our older system ENGINE N4. </p><br><p>  Naturally, within the framework of a single article, we cannot cover all possible tests, therefore, we repeatedly call for readers to share their wishes for future tests in the comments, we will definitely take them into account in future publications. </p><br><p>  In addition, we remind you that this year we are actively engaged in training, so we invite you to our centers of competence, where you can get training on AERODISK storage systems, and at the same time it is interesting and have fun. </p><br><p>  Duplicate information about the next training events. </p><br><ul><li>  Yekaterinburg.  May 16, 2019.  Training workshop.  You can register via the link: <a href="https://aerodisk.promo/ekb/">https://aerodisk.promo/ekb/</a> </li><li>  Yekaterinburg.  May 20 - June 21, 2019.  Competence Center.  Come to any working time for a live demonstration of the storage system AERODISK ENGINE N2.  The exact address and link to registration will be later.  Watch for information. </li><li>  Novosibirsk  FOLLOW INFORMATION ON OUR SITE or ON HABRA. <br>  October 2019 </li><li>  Kazan  FOLLOW INFORMATION ON OUR SITE or ON HABRA. <br>  October 2019 </li><li>  Krasnoyarsk.  FOLLOW INFORMATION ON OUR SITE or ON HABRA. <br>  November 2019 </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/451456/">https://habr.com/ru/post/451456/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451434/index.html">How I bought a fiber laser marker in Russia + the nuances of choosing devices for engraving and marking in 2018</a></li>
<li><a href="../45144/index.html">Schedule a programmer in one place</a></li>
<li><a href="../451442/index.html">Terraform it: a review of terragenesis</a></li>
<li><a href="../451448/index.html">Why Do-Not-Track Can Be Mandatory</a></li>
<li><a href="../451454/index.html">Change the contents of the iOS app notification</a></li>
<li><a href="../451462/index.html">We write less duplicate code using Binding in Laravel</a></li>
<li><a href="../451466/index.html">graphql - pitfalls</a></li>
<li><a href="../451468/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ 364 (May 6 - 12, 2019)</a></li>
<li><a href="../45147/index.html">Down with the language barrier!</a></li>
<li><a href="../451480/index.html">Why does the Ministry of Industry and Trade prohibit the storage of data on foreign equipment?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>