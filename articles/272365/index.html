<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DreemChest: Chain Reaction</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About transfer 
 Hello to all. I decided to do the translation of the documentation for the game engine DreemChest, I don‚Äôt know if someone did it to ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DreemChest: Chain Reaction</h1><div class="post__text post__text-html js-mediator-article"><h4>  About transfer </h4><br>  Hello to all.  I decided to do the translation of the documentation for the game engine DreemChest, I don‚Äôt know if someone did it to me, but I hope not. <br>  Why did I decide to start with the translation of "Chain Reaction"?  The answer is simple: this is the most interesting lesson at the same time as the practical part of all the documentation. <br>  Well, let's start. <br><h4>  Chain reaction </h4><br>  In this lesson, you will see an example of a simple chain reaction game (The name corresponds to the genre).  The meaning of the game is that the player needs to destroy constantly appearing objects by clicking on them with the mouse, as quickly as possible. <br><h5>  The foundation </h5><br>  Run the engine and create a new project.  When it is launched, you will see a dialog box that prompts you to create a new project or to load an already created one.  Enter the project name and click on the ‚ÄúGreate‚Äù button. <br><a name="habracut"></a><br><img src="http://dreemchest.com/doc/en/img/new-project.png" alt="image"><br>  By standard, the editor has only one game screen resolution (320x480), but you can always add your own.  Let's give our project a new resolution, for example 640x480, to do this, open the pull-down menu (Well, honestly, did not know how to translate, correct, if that), which is shown in the image below in the main toolbar and select the option "Edit". <br><img src="http://dreemchest.com/doc/en/img/edit-resolutions.png" alt="image"><br>  Now you can see the dialog box that has just appeared.  To add a new resolution, enter the width and height, edit in the first and second window, and then click on the ‚ÄúAdd‚Äù button.  To close the dialog box, click on the ‚ÄúClose‚Äù button, to remove the permission, click on it, thereby selecting it and click on the ‚ÄúRemove‚Äù button. <br><img src="http://dreemchest.com/doc/en/img/create-resolution.png" alt="image"><br>  Now that the new resolution has been added, you can select it in the pull-down menu, if you select a different resolution, the borders of the scene will be changed. <br><img src="http://dreemchest.com/doc/en/img/select-resolution.png" alt="image"><br><h5>  Adding resources </h5><br>  A standard project contains only one htcehc with the name ‚Äúroot‚Äù, which is the only game level (scene).  Let's now add some sprites, which we will use in the future. <br>  To import a resource, click the RMB (Right mouse button) on the ‚ÄúAssest‚Äù panel and in the menu that appears just select ‚ÄúImport Assest‚Äù.  We see a window appeared through which we will select and add our sprites.  Let's add 2 sprites "Enemy.png" ("Enemy") and "Bullet.png" ("Bullet"). <br>  The ‚ÄúAssest‚Äù panel is located in the lower right corner, if you did not find it because it is not there, you can always add it through ‚ÄúView‚Äù -&gt; ‚ÄúAssests‚Äù <br><img src="http://dreemchest.com/doc/en/img/import-assets.png" alt="image"><br>  The Assest panel allows you to create resources (script, shape, stage object, etc.), as well as import ready resources (Sprites, flash menus and sounds / music).  To make a prototype of the future game, we need to register the game logic, let's start by creating a script.  Right-click on the Asssest panel and in the menu that appears just select ‚ÄúCreate‚Äù -&gt; ‚ÄúScript‚Äù. <br><img src="http://dreemchest.com/doc/en/img/create-script.png" alt="image"><br>  Before writing the script, let's select the ‚Äúbullet‚Äù and ‚Äúenemy‚Äù resources.  The image loaded by us can be dragged onto our scene, but it cannot be called through the script, unless this script is the main class of the object.  So that we can create an object from a script, let's set a unique name for our object class, for ‚Äúbullet‚Äù it will be ‚ÄúbmpBullet‚Äù, and for ‚Äúenemy‚Äù ‚ÄúbmpEnemy‚Äù, we can always change the name of the object class to another or write it for the first time object in the ‚ÄúAssest‚Äù panel, and then in the ‚ÄúProperties‚Äù panel in the ‚ÄúClass‚Äù line, enter the name of the main object class. <br>  The class of our resource can be called in any other resource, or attached to another object, but at the moment we are interested in working with scripts. <br><img src="http://dreemchest.com/doc/en/img/asset-class-chain.png" alt="image"><br>  Let's start writing our script.  The prototype of our script will contain 1 class and 8 methods. <br>  <i><b>Main</b></i> - Method called at the start of the game.  Each main class must contain this method. <br>  <i><b>spawnEnemies</b></i> - Creates a certain number of Enemy objects. <br>  <i><b>spawnEnemy</b></i> - Creates a single "Enemy" object on the stage with a built-in sprite. <br>  <i><b>shoot</b></i> - Creates 4 bullets at specific coordinates. <br>  <i><b>spawnBullet</b></i> - Creates a single ‚ÄúBullet‚Äù object on the stage with an embedded sprite. <br>  <i><b>onUpdate</b></i> - Updates objects (Coordinates, status, etc.). <br>  <i><b>updateBullet</b></i> - Allows Bullet objects to move around the scene and checks for collisions with Enemy objects. <br>  <i><b>updateEnemy</b></i> - Allows Enemy objects to move around the scene. <br><br><blockquote>  - Declare the Main class, derived from Graphics. <br>  - it must be a child <br>  - of the Graphics class. <br>  class "Main" (Graphics) <br><br>  - Constants <br>  Main.Enemies = 50 <br>  Main.EnemySpeed ‚Äã‚Äã= 100 <br>  Main.BulletSpeed ‚Äã‚Äã= 500 <br>  Main.EnemyTag = 1 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - main <br>  - Entry point which assigns message listeners and enemies <br>  function Main: main () <br><br>  - Add handlers which react to clicks and updates <br>  Stage.attachListener (TapEvent.Up, function (e) self: shoot (ex, ey) end) <br>  Stage.attachListener (GenericEvent.Update, self) <br><br>  - Rectangle which sets the window size <br>  self.screen = Rect.new (0, 0, Stage.getWidth (), Stage.getHeight ()) <br><br>  - Set enemies loose <br>  self: spawnEnemies (Main.Enemies) <br>  end <br><br>  - spawnEnemies <br>  function Main: spawnEnemies (count) <br>  for i = 1, count do <br>  self: spawnEnemy (Color.new (0.0, 1.0, 0.0, 1.0)) <br>  end <br>  end <br><br>  - spawnEnemy <br>  function Main: spawnEnemy (color) <br>  - Create an instance of the bmpEnemy class.  It's the same identifier <br>  - assigned to the enemy image in step 7. <br>  local e = bmpEnemy.new () <br><br>  e.relX = math.random () <br>  e.relY = math.random () <br>  e.dir = Vec2.randDirection () <br>  e.color = color <br>  e.speed = Main.EnemySpeed <br><br>  - Each stage object can be given a tag.  We use it to check for <br>  - collisions between bullets and enemies. <br>  e.tag = Main.EnemyTag <br><br>  - Add the created object to the stage <br>  self: attach (e) <br>  end <br><br>  - shoot <br>  function Main: shoot (x, y) <br>  local color = Color.new (1.0, 0.0, 0.0, 1.0) <br>  self: spawnBullet (x, y, -1, 0, color) <br>  self: spawnBullet (x, y, 1, 0, color) <br>  self: spawnBullet (x, y, 0, 1, color) <br>  self: spawnBullet (x, y, 0, -1, color) <br>  end <br><br>  - spawnBullet <br>  - the same thing happens here in the spawnEnemy method <br>  function Main: spawnBullet (x, y, dx, dy, color) <br>  local bullet = bmpBullet.new () <br>  bullet.x = x <br>  bullet.y = y <br>  bullet.color = color <br>  bullet.speed = Main.BulletSpeed <br>  bullet.dir = Vec2.new (dx, dy) <br><br>  self: attach (bullet) <br>  end <br><br>  - onUpdate <br>  - Update message handler, called every frame. <br>  function Main: onUpdate (e) <br>  local i = 0 <br>  local n = self.totalChildren <br><br>  - Scan the stage objects list and update them.  We use objects' <br>  - tag this property to <br>  - process: the enemy or bullet. <br>  while i &lt;n do <br>  local child = self: getChild (i) <br><br>  if child.tag == Main.EnemyTag then <br>  self: updateEnemy (e.dt, child) <br>  else <br>  self: updateBullet (e.dt, child) <br>  end <br><br>  i = i + 1 <br>  end <br>  end <br><br>  - updateBullet <br>  - Bullet updating method.  We change its position every frame according <br>  - to speed. <br>  function Main: updateBullet (dt, bullet) <br><br>  - We used the previously created Rect class object here, to <br>  - determine if the bullet has flown off-screen or not. <br>  if not self.screen: pointInside (bullet.x, bullet.y) then <br>  - Each stage object has a release method <br>  - and labels it as unneeded.  After a while, memory used by this object <br>  - will be freed. <br>  bullet: release () <br>  return <br>  end <br><br>  - Move the bullet <br>  bullet.x = bullet.x + bullet.dir.x * bullet.speed * dt <br>  bullet.y = bullet.y + bullet.dir.y * bullet.speed * dt <br><br>  - Checking for collisions between this and that? <br>  It is a radius equal to <br>  - the bullet's size.  The <br>  - handler will therefore <br>  - tag property is equal to Main.EnemyTag. <br>  Stage.forEachInRadius (self, Main.EnemyTag, bullet.x, bullet.y, bullet.width, <br>  function (object, distance) <br><br>  - We found the appropriate object, which <br>  - means a collision occurred.  Shot four <br>  - more bullets. <br>  self: shoot (object.x, object.y) <br><br>  - Delete the object and bullet <br>  object: release () <br>  bullet: release () <br>  end) <br>  end <br><br>  - updateEnemy <br>  - Enemy updating method.  Simply move it on the screen.  Wrap it around <br>  If it goes out of bounds. <br>  function Main: updateEnemy (dt, enemy) <br>  enemy.x = enemy.x + enemy.dir.x * enemy.speed * dt <br>  enemy.y = enemy.y + enemy.dir.y * enemy.speed * dt <br><br>  local w = Stage.getWidth () <br>  local h = Stage.getHeight () <br><br>  if enemy.x &lt;0 then enemy.x = enemy.x + w <br>  elseif enemy.x&gt; w then enemy.x = enemy.x - w <br>  end <br><br>  if enemy.y &lt;0 then enemy.y = enemy.y + h <br>  elseif enemy.y&gt; h then enemy.y = enemy.y - h <br>  end <br>  end </blockquote><br><br>  The script of the prototype of our game is ready.  But why, when the game starts, nothing happens (to start the game you need to click the "Start" button on the main toolbar)?  This is because our script is not standard when you start the game.  To fix this, open the drop-down menu next to the ‚ÄúStart‚Äù button and select our script. <br><img src="http://dreemchest.com/doc/en/img/select-startup.png" alt="image"><br><h5>  Testing and exporting </h5><br>  The launch function of the project was done in order to save the time we spend on compilation in order to test what happened with us.  To pause the game launched in the editor, you need to click on the Stop button, which replaces the Start button when the game starts.  If you edited the project and started it, but nothing has changed, then you forgot to save it (Ctrl + S), only after saving the changes they will be visible when the game starts. <br><img src="http://dreemchest.com/doc/en/img/game-screen.png" alt="image"><br>  Let's run our game. <br><img src="http://dreemchest.com/doc/en/img/start.png" alt="image"><br>  To separate our project from the engine and export it to a specific platform, select the ‚ÄúExport‚Äù item in the ‚ÄúFile‚Äù drop-down menu (‚ÄúFile‚Äù -&gt; ‚ÄúExport‚Äù).  There you can also configure many options for exporting.  (PS Exporting takes longer than just launching a project and much longer). <img src="http://dreemchest.com/doc/en/img/export.png" alt="image"></div><p>Source: <a href="https://habr.com/ru/post/272365/">https://habr.com/ru/post/272365/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272355/index.html">C # .NET: Five little wonders that will make your code better. Part 1</a></li>
<li><a href="../272357/index.html">We write the application for firefox os and place it in the Marketplace</a></li>
<li><a href="../272359/index.html">How does email filtering in gmail work?</a></li>
<li><a href="../272361/index.html">The devil is not so bad, or how many domains are actually used.</a></li>
<li><a href="../272363/index.html">How I won the programming contest without knowing how to program</a></li>
<li><a href="../272367/index.html">Several "buns" for symfony 2 && Doctrine</a></li>
<li><a href="../272371/index.html">Hacker mathematician</a></li>
<li><a href="../272373/index.html">Use TSQL to play Sudoku</a></li>
<li><a href="../272375/index.html">Apple has released Swift source code</a></li>
<li><a href="../272381/index.html">Useful Snippets for Nginx Configs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>