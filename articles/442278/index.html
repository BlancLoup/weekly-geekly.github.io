<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kibana User Guide. Visualization. Part 6</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The fifth part of the translation of official documentation on data visualization in Kibana. 

 Link to original material: Kibana User Guide [6.6] "Vi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kibana User Guide. Visualization. Part 6</h1><div class="post__text post__text-html js-mediator-article">  The fifth part of the translation of official documentation on data visualization in Kibana. <br><br>  Link to original material: <a href="https://www.elastic.co/guide/en/kibana/6.6/visualize.html">Kibana User Guide [6.6] "Visualize</a> <br><br>  Link to 1 part: <a href="https://habr.com/ru/post/441214/">Kibana User Guide.</a>  <a href="https://habr.com/ru/post/441214/">Visualization.</a>  <a href="https://habr.com/ru/post/441214/">Part 1</a> <br>  Link to part 2: <a href="https://habr.com/ru/post/441264/">Kibana User Guide.</a>  <a href="https://habr.com/ru/post/441264/">Visualization.</a>  <a href="https://habr.com/ru/post/441264/">Part 2</a> <br>  Link to part 3: <a href="https://habr.com/ru/post/441362/">Kibana User Guide.</a>  <a href="https://habr.com/ru/post/441362/">Visualization.</a>  <a href="https://habr.com/ru/post/441362/">Part 3</a> <br>  Link to part 4: <a href="https://habr.com/ru/post/441830/">Kibana User Guide.</a>  <a href="https://habr.com/ru/post/441830/">Visualization.</a>  <a href="https://habr.com/ru/post/441830/">Part 4</a> <br>  Link to Part 5: <a href="https://habr.com/ru/post/442104/">Kibana User Guide.</a>  <a href="https://habr.com/ru/post/442104/">Visualization.</a>  <a href="https://habr.com/ru/post/442104/">Part 5</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Content: <br><br>  1. Vega Graphs <br><br>  2. Inspecting Visualizations <br><a name="habracut"></a><br><h3>  Vega Counts </h3><br>  <b>A warning.</b>  This feature is experimental and may be modified or removed in a future release.  Elastic will make every effort to correct any problems, but the experimental features are not subject to the support of the official GA functions of the GA. <br>  You can build a visualization of <a href="https://vega.github.io/vega/examples/">Vega</a> and <a href="https://vega.github.io/vega-lite/examples/">VegaLite data</a> inside Kibana, both offline and on top of a map.  To see Vega in action, watch this <a href="https://www.youtube.com/watch%3Fv%3DlQGCipY3th8">short overview video</a> . <br><br><h3>  Get started with Vega </h3><br>  Follow these steps to create your first Vega visualization. <br><br><ol><li>  In Kibana, select Visualize and add a Vega visualization.  You should see the default graph. </li><li> Try changing the <code>mark</code> from <code>line</code> to <code>point</code> , <code>area</code> , <code>bar</code> , <code>circle</code> , <code>square</code> , ... (see <a href="https://vega.github.io/vega-lite/docs/mark.html">documentation</a> ). </li><li>  Try the rest of the Vega or VegaLite renderings.  You may need to make the URLs absolute, for example, replace the <code>"url": "data/world-110m.json"</code> with the <code>"url": "https://vega.github.io/editor/data/world-110m.json"</code> (see note below). </li><li>  Using the <a href="https://www.npmjs.com/package/makelogs">makelogs utility</a> , create some logstash data and try the <a href="https://www.elastic.co/guide/en/kibana/6.6/public/examples/logstash">logstash examples</a> ( <b>Do not use makelogs on the production cluster).</b> </li></ol><br><h3>  Vega vs VegaLite </h3><br>  VegaLite is a simplified version of Vega, useful for a quick start, but with a number of limitations.  VegaLite is automatically converted to Vega before execution.  Compare <a href="">logstash-simple_line-vega</a> and <a href="">logstash-simple_line-vegalite</a> (both use some of the logstash data from Elasticsearch).  You can use <a href="https://vega.github.io/editor/">this editor</a> to convert VegaLite to Vega. <br><br><h3>  Elasticsearch Requests </h3><br>  By default, the Vega <a href="https://vega.github.io/vega/docs/data/">data</a> element can use embedded and external data with the <code>"url"</code> parameter.  Kibana adds support for direct Elasticsearch requests by resetting the <code>"url"</code> value. <br>  Here is an example of an Elasticsearch query that counts the number of documents in all indexes.  The query uses the <code><b>@timestamp</b></code> field to filter the time range and split it into histogram segments. <br><br><pre> <code class="plaintext hljs">// An object instead of a string for the url value // is treated as a context-aware Elasticsearch query. url: { // Filter the time picker (upper right corner) with this field %timefield%: @timestamp // Apply dashboard context filters when set %context%: true // Which indexes to search index: _all // The body element may contain "aggs" and "query" subfields body: { aggs: { time_buckets: { date_histogram: { // Use date histogram aggregation on @timestamp field field: @timestamp // interval value will depend on the daterange picker // Use an integer to set approximate bucket count interval: { %autointerval%: true } // Make sure we get an entire range, even if it has no data extended_bounds: { min: { %timefilter%: "min" } max: { %timefilter%: "max" } } // Use this for linear (eg line, area) graphs // Without it, empty buckets will not show up min_doc_count: 0 } } } // Speed up the response by only including aggregation results size: 0 } }</code> </pre><br>  The full result has the following structure type: <br><br><pre> <code class="plaintext hljs">{ "aggregations": { "time_buckets": { "buckets": [{ "key_as_string": "2015-11-30T22:00:00.000Z", "key": 1448920800000, "doc_count": 28 }, { "key_as_string": "2015-11-30T23:00:00.000Z", "key": 1448924400000, "doc_count": 330 }, ...</code> </pre><br>  Note that <code>"key"</code> is a Unix timestamp and can be used without transformations by Vega date expressions. <br><br>  For most graphs, we only need a list of segment values, so we use the expression <code>format: {property: "aggregations.time_buckets.buckets"}</code> to focus only on the data we need. <br><br>  The request can be specified with an individual range and contextual information panel.  This query is equivalent to <code>"%context%": true, "%timefield%": "@timestamp"</code> , except for shifting the time range 10 minutes ago. <br><br><pre> <code class="plaintext hljs">{ body: { query: { bool: { must: [ // This string will be replaced // with the auto-generated "MUST" clause "%dashboard_context-must_clause%" { range: { // apply timefilter (upper right corner) // to the @timestamp variable @timestamp: { // "%timefilter%" will be replaced with // the current values of the time filter // (from the upper right corner) "%timefilter%": true // Only work with %timefilter% // Shift current timefilter by 10 units back shift: 10 // week, day (default), hour, minute, second unit: minute } } } ] must_not: [ // This string will be replaced with // the auto-generated "MUST-NOT" clause "%dashboard_context-must_not_clause%" ] } } } }</code> </pre><br>  <code>"%timefilter%"</code> can also be used to determine one minimum or maximum value.  As shown above, the <code>extended_bounds</code> in date_histogram can be set with two values ‚Äã‚Äã‚Äî minimum and maximum.  Instead of hard-coding the value, you can use <code>"min": {"%timefilter%": "min"}</code> , which will be overwritten at the beginning of the current time range.  The <code>shift</code> and <code>unit</code> values ‚Äã‚Äãare also supported.  "Interval" can be set dynamically, depending on the currently selected range: <code>"interval": {"%autointerval%": 10}</code> will try to get about 10-15 data points (segments). <br><br><h3>  Elastic Map Files </h3><br>  This is the ability to access Elastic Map Service files according to some mechanism. <br><br><pre> <code class="plaintext hljs">url: { // "type" defaults to "elasticsearch" otherwise type: emsfile // Name of the file, exactly as in the Region map visualization name: World Countries } // The result is a geojson file, get its features to use // this data source with the "shape" marks // https://vega.github.io/vega/docs/marks/shape/ format: {property: "features"}</code> </pre><br><h3>  Vega with map </h3><br>  The default Kibana map can be used as a base for the Vega graph.  To enable, the graph must define <code>type=map</code> in the host configuration. <br><br><pre> <code class="plaintext hljs">{ "config": { "kibana": { "type": "map", // Initial map position "latitude": 40.7, // default 0 "longitude": -74, // default 0 "zoom": 7, // default 2 // defaults to "default". Use false to disable base layer. "mapStyle": false, // default 0 "minZoom": 5, // defaults to the maximum for the given style, // or 25 when base is disabled "maxZoom": 13, // defaults to true, shows +/- buttons to zoom in/out "zoomControl": false, // defaults to true, disables mouse wheel zoom "scrollWheelZoom": false, // When false, repaints on each move frame. // Makes the graph slower when moving the map "delayRepaint": true, // default true } }, /* the rest of Vega JSON */ }</code> </pre><br>  This visualization will automatically embed a projection called <code>"projection"</code> .  Use this to calculate the position of all geo-oriented labels.  Additionally, you can use longitude, latitude and scaling.  These signals can be used in the graph or can be updated to change the positioning of the map. <br><br><h3>  Debugging </h3><br><h4>  Brouzer debug console </h4><br>  Use the browser tools for debugging (for example, F12 or Ctrl + Shift + J in Chrome) to inspect the variable <code>VEGA_DEBUG</code> : * <code>view</code> - access to the View object Vega.  See the <a href="https://vega.github.io/vega/docs/api/debugging/">Vega Debugging Guide</a> for how to inspect data and signals at runtime.  For VegaLite, <code>VEGA_DEBUG.view.data('source_0')</code> gets the main data set.  For Vega, it uses the data name, which is specifically in your Vega specification.  * <code>vega_spec</code> specification of the Vega JSON graph after some modifications from Kibana.  In the case of VegaLite, this is the output of the VegaLite compiler.  * <code>vegalite_spec</code> - if this is a VegaLite graph, a JSON graph specification before compiling VegaLite <br><br><h4>  Data </h4><br>  If you use the Elasticsearch query, make sure that the data received is what you expected.  The easiest way to see this is by using the ‚Äúnetworking‚Äù tab in the browser debugging tools (for example, F12).  Modify the graph slightly to make a search query and view the server response.  Another approach is to use the <a href="https://www.elastic.co/guide/en/kibana/current/console-kibana.html">Kibana Dev Tools</a> tab - put the index name inside the first line: <code>GET &lt;INDEX_NAME&gt;/_search</code> , and add your query in the next line (just the value of the <code>"query"</code> field). <br>  If you need to share a graph with someone, you can copy the response of the data line to <a href="https://gist.github.com/discover">gist.github.com</a> , possibly with a .json extension, use the [raw] button, and use this url directly in your graph. <br>  To prevent Vega from using non-ES data sources, add <code>vega.enableExternalUrls: false</code> to the kibana.yml file. <br><br><h3>  useful links </h3><br><ul><li>  <a href="https://vega.github.io/editor/">Editor</a> - includes examples for Vega and VegaLite, but does not support any specific Kibana features for Elasticsearch queries and interactive basemaps. </li><li>  <a href="https://vega.github.io/vega-lite/tutorials/getting_started.html">Textbooks</a> , <a href="https://vega.github.io/vega-lite/docs/">documents</a> and <a href="https://vega.github.io/vega-lite/examples/">examples</a> VegaLite. </li><li>  <a href="https://vega.github.io/vega/tutorials/">Textbooks</a> , <a href="https://vega.github.io/vega/docs/">documents</a> and <a href="https://vega.github.io/vega/examples/">examples</a> Vega. </li></ul><br><h4>  Using Vega and VegaLite Examples </h4><br>  When the <a href="https://vega.github.io/vega/examples/">Vega</a> and <a href="https://vega.github.io/vega-lite/examples/">VegaLite</a> examples are used, you need to modify the ‚Äúdata‚Äù section to use the absolute URL.  For example, replace <code>"url": "data/world-110m.json"</code> with <code>"url": "https://vega.github.io/editor/data/world-110m.json"</code> .  Also in regular examples, Vega uses the <code>"autosize": "pad"</code> layout model <code>"autosize": "pad"</code> , and Kibana uses <code>fit</code> .  Remove all <code>autosize</code> , <code>width</code> and <code>height</code> values.  See below for dimensions and positioning. <br><br><h4>  Advanced configuration options </h4><br>  These options are specific to Kibana.  Card support has additional configuration options. <br><br><pre> <code class="plaintext hljs">{ config: { kibana: { // Placement of the Vega-defined signal bindings. // Can be `left`, `right`, `top`, or `bottom` (default). controlsLocation: top // Can be `vertical` or `horizontal` (default). controlsDirection: vertical // If true, hides most of Vega and VegaLite warnings hideWarnings: true // Vega renderer to use: `svg` or `canvas` (default) renderer: canvas } } /* the rest of Vega code */ }</code> </pre><br><h4>  Size and position </h4><br>  Vega and VegaLite. <br><br>  By default, Kibana‚Äôs Vega columns will use the <code>autosize = { type: 'fit', contains: 'padding' }</code> layout model for Vega and VegaLite graphs.  The <code>fit</code> model uses all available space, ignoring the <code>width</code> and <code>height</code> values, but takes into account the indent values.  You can override this behavior by specifying a different <code>autosize</code> value. <br><br>  Vega on the map. <br><br>  All Vega columns will ignore the <code>autosize</code> , <code>width</code> , <code>height</code> and <code>padding</code> values ‚Äã‚Äãusing the zero indent <code>fit</code> model. <br><br><h3>  Inspection Visualization </h3><br>  Many visualizations allow you to inspect the data underlying the visualization. <br>  To inspect the visualization, click the <b>Inspect</b> button in the editor or select <b>Inspect</b> from the Dashboard panel menu. <br><br>  The initial screen shows the basic data for visualization.  You can download data as a comma-separated value (CSV) file in <b>Formatted</b> or <b>Raw</b> formats.  <b>Formatted</b> loads data in a table format.  <b>Raw</b> loads the data as represented ‚Äî dates as timestamps, numbers without a thousand delimiters, etc. <br><br>  To view requests that collect data, select <b>Requests</b> from the <b>View</b> menu at the top right. <br><br>  Which views are available depends on the visualization being inspected. </div><p>Source: <a href="https://habr.com/ru/post/442278/">https://habr.com/ru/post/442278/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../442260/index.html">10 Git Commands A Developer Should Know</a></li>
<li><a href="../442266/index.html">Delta Chat - decentralized messenger on top of email</a></li>
<li><a href="../442268/index.html">AsyncIO Micropython: Synchronization Methods in Asynchronous Programming</a></li>
<li><a href="../442270/index.html">5 mistakes to avoid when creating 3D models for 3D printing</a></li>
<li><a href="../442272/index.html">Go + = package version control</a></li>
<li><a href="../442280/index.html">Machine learning in Dodo. How to start a new direction, if you are a developer</a></li>
<li><a href="../442284/index.html">NoVerify: Linter for PHP from Team VKontakte is now publicly available</a></li>
<li><a href="../442286/index.html">Russian ophthalmologists told about bionic vision. New mobile application demonstrates cybernet work</a></li>
<li><a href="../442290/index.html">Making ST-Link V2.1 from Chinese ST-Link V2</a></li>
<li><a href="../442292/index.html">Internship Sberseasons: Python, UX / UI, Data and more for students</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>