<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MSP430 Lunchpad Review and Test Project</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, thanks to user Dooez , I ordered a low-cost kit for playing on cold winter evenings on TI. 
 Literally a few days later, a ‚Äúcourier with a t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MSP430 Lunchpad Review and Test Project</h1><div class="post__text post__text-html js-mediator-article"> Recently, <a href="http://habrahabr.ru/blogs/DIY/134618/">thanks to</a> user <a href="https://geektimes.ru/users/dooez/" class="user_link">Dooez</a> , I ordered a low-cost kit for playing on cold winter evenings on TI. <br>  Literally a few days later, a ‚Äúcourier with a thick shoulder bag ...‚Äù and a wonderful FedEx box courier knocked me: <br><img src="https://habrastorage.org/storage2/b13/c3c/6bf/b13c3c6bfcb850ee6dc135d0501bceb9.jpg"><a name="habracut"></a><br>  The contents of the box did not disappoint me either.  Inside was a smaller box <br><img src="https://habrastorage.org/storage2/d0b/13b/214/d0b13b2144e9723fce05aed642a45d89.jpg"><br>  from which the lunchpad board itself was sequentially extracted: <br><img src="https://habrastorage.org/storage2/cc9/576/2bf/cc95762bf295269e84102550cab558f7.jpg"><br>  sealed bags with another processor, connectors for the board and quartz at 32 kHz: <br><img src="https://habrastorage.org/storage2/03a/557/f16/03a557f16619ed13b4399028c5194366.jpg"><br>  short miniUSB <br><img src="https://habrastorage.org/storage2/f4b/986/696/f4b986696a513b89b134550537812158.jpg"><br>  and, as a bonus, a couple of stickers <br><img src="https://habrastorage.org/storage2/735/268/c5b/735268c5b576bb5e4482351041c71f0b.jpg"><br><br>  First of all, of course, unpack the board and the cord and stick it into the comp.  Winda happily offers to look for drivers and, of course, does not find anything.  Not scary.  Downloading pirated IAR Embedded WorkBench from torrents (of course, you could get a trial version from the TI website, but followers of the <a href="http://news.most.ua/Life/World/v-shvecii-poyavilas-novaya-religiya">church of copyism</a> do not look for easy ways), and after installing a programmer / debugger and a virtual COM port in the system. <br>  Initially, a demo program is flashed into the processor, flashing the LED depending on the temperature (yes, percent with all its simplicity can measure its temperature), which we immediately wipe with our simple ‚Äúflash LED‚Äù program, ‚ÄúHello, World!‚Äù for embeds. <br>  I would especially like to mention the possibility of downloading from TI site an archive with a couple of hundreds of tiny (literally a dozen lines) programs in C and Assembler, which demonstrate the features of the microprocessor.  As soon as something did not work out - I simply loaded the corresponding example into the processor, and in a few minutes I found the essence of the problem in the debager. <br>  By the way, debager.  Great thing!  Brekpointy can be put both on the command and on the fulfillment of any condition, plus the possibility, having stopped the processor, to change the bits in the service registers and immediately receive a response in the hardware on the board.  Or vice versa, look directly in the registers of the processor response to the applied external influence. <br>  Having played enough, the thought arose to make something useful.  And the catcher, as you know, and the beast runs. <br>  In this old oak Chinese electric screwdriver, the batteries had just died by this time.  And the new iron-phosphate accumulators bought on the occasion were lying in store, which all hands did not reach: <br><img src="https://habrastorage.org/storage2/cbb/1e2/66c/cbb1e266cfcd6262287f6647b258df14.jpg"><br>  The main plus of the 430 series (according to TI) is in ultra-low power consumption.  The processor simply asks for some self-powered device.  So try to make a screwdriver controller instead of Chinese junk. <br>  So, crush the screwdriver and ruthlessly throw out its dull contents: <br><img src="https://habrastorage.org/storage2/1d6/1fd/5c7/1d61fd5c79783c12e2e155e697f2c6d0.jpg"><br>  and check that the battery is great (if you break a couple of partitions) and there is still room for a small controller scarf: <br><img src="https://habrastorage.org/storage2/458/a5b/25e/458a5b25e7758df6e06a6e18e0403917.jpg"><br>  He pretends to be on the knee an approximate diagram of the internal electronics of those parts that roll on all sorts of boxes and bags (by the way, because criticism of the selection of components is not accepted, it is soldered from the existing house, I didn‚Äôt want to go to the radio market) <br><img src="https://habrastorage.org/storage2/73a/17d/142/73a17d1422ffc8055778f530118bd277.png"><br>  A little explanation to the diagram: USB port is used for charging.  It can produce 500 mA at 5 volts, on the battery of this type, the cut-off voltage should be 3.6 volts (3.3V working), we are laying on the charge current of 100 mA when the 1.4V key drops, i.e.  To the key resistance we add another small current-limiting resistor.  Q2, Q3 are needed precisely for the cut-off when the battery is fully charged.  Plus, the same cutoff is triggered by overheating. <br>  Q4 controls the motor (switching directions there is done mechanically, so I did not have to bother with the full bridge), it is more powerful, because  motor at start takes up to 3A from battery. <br>  D1 reduces the microprocessor supply voltage to acceptable values. <br>  R14, R18 measure the voltage on the battery, R16 and R19 measure the input voltage. <br>  S1 - a large button on the screwdriver, including the motor.  S2 and D2-D4 - a tiny scarf (yes, I did not throw out all the Chinese junk) with a button and three LEDs, red, yellow and green, indicating the charge of the battery. <br><br>  First, I connect a variable resistor to the LanchPad legs, which represents a battery, and a board with indicators.  The motor and key represent the LEDs on the board: <br><img src="https://habrastorage.org/storage2/252/601/f8e/252601f8e191c3c8f8e964592437f45a.jpg"><br>  I achieve on the mock up more or less confident work of all the pieces of the program and proceed to the assembly of the final board.  First we check the geometric dimensions after installing the keys: <br><img src="https://habrastorage.org/storage2/897/3ec/3f7/8973ec3f781b2be0bb02cb59c5f2894f.jpg"><br>  Normally, fit in size, you can solder a spare microprocessor, hang on it the necessary SMD components and make all the connections using a thin MGTF: <br><img src="https://habrastorage.org/storage2/636/41e/f30/63641ef30736d811f946d7e5359e3819.jpg"><br>  (Yes, in this picture there is an assembled board with all the soldered parts. The wire in red shrink - connect the programmer to the processor, then it will be removed) <br>  Now from the blinking LEDs go to the torsion of the motor.  Lunchpad turns into a programmer with a slight movement of the hand, and the variable resistor temporarily migrates to the finished board in order to check the critical limits of the battery without torturing the battery itself: <br><img src="https://habrastorage.org/storage2/a71/91b/275/a7191b27504a0c59dba7b817c97a6535.jpg"><br>  Along the way, we check different sleep modes for the processor.  Even with fully included power saving, our result is one and a half orders of magnitude higher than what was stated in the documentation, which is not surprising given the resistor dividers for the ADC and the Q2 control circuit.  However, 40 microamps is a perfectly acceptable result for several ampere-hours of a battery.  For a dozen years on a single charge, the processor will work exactly, and there either the shah will die, or the donkey: <br><img src="https://habrastorage.org/storage2/758/1e3/dd1/7581e3dd1e139338271d2bfc97f099c0.jpg"><br>  All right, the LEDs flash as expected, the voltage is measured, overheating (simulated by a hair dryer) cuts off the load, charging when plugged into USB turns on - you can collect. <br>  Carefully shove the stuffing inside the case <br><img src="https://habrastorage.org/storage2/380/a68/11d/380a6811df4e9623b96d5e5f9bbba20f.jpg"><br>  and twist both halves <br><img src="https://habrastorage.org/storage2/9b4/b88/8ab/9b4b888ab9e4a71716c4dff4d06bd46c.jpg"><br>  now you can, with a clear conscience, upload your source code to a public repository, because the main commandment of copyism fans is ‚ÄúInformation must be free!‚Äù.  Who is interested in the project - you can download the latest version of the source code and altiumovskuyu scheme <a href="http://code.google.com/a/eclipselabs.org/p/li430/">from here</a> . <br>  There, of course, combing and combing - in the software there are still tails left from the original version of the program with FSM, later I abandoned it in favor of sleep-modes, and the numbering of the elements in the diagram is slightly strange after running in the simulator and erasing unnecessary parts . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How to improve the scheme: well, at least instead of a wire, use a miniUSB mom in the case of a screwdriver, because the dangling wire is not Feng Shui. <br>  Another option for aesthetes: after Q2, an inductance and a Schottky diode is installed according to the pulse-step-down converter circuit, then the microprocessor with the help of PWM can charge the battery from any input voltage. <br>  The serial port remained unused on the microprocessor - it is quite possible (using a CP2102 or FTDI converter) to tell the computer battery charge-discharge statistics. <br><br>  The construction itself will then be used as a basis for tourist battery charging for mobile phones / lamps for overnight stays, which can be charged from Peltye, solar batteries and dynamos.  But this is a topic for the next article on Habr. <br><br>  PS: But generally speaking, this is just a brain break - what would I think if I was told 20 years ago that I would sit at the computer and <i>program a screwdriver</i> ?  Another ten years, and learn how to hack toothpicks. </div><p>Source: <a href="https://habr.com/ru/post/136219/">https://habr.com/ru/post/136219/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../136210/index.html">Why C is faster than Java (from the perspective of a Java developer)</a></li>
<li><a href="../136213/index.html">We are 1 year old!</a></li>
<li><a href="../136214/index.html">[archlinux testing news] / usr support on a separate section</a></li>
<li><a href="../136216/index.html">Facebook allows you to listen to music with friends</a></li>
<li><a href="../136218/index.html">Integration of some features of Scoreloop social gaming network into an Android application</a></li>
<li><a href="../136220/index.html">The first batch of 25-dollar computers Raspberry Pi entered production</a></li>
<li><a href="../136221/index.html">Playstation 4 will not be introduced in June</a></li>
<li><a href="../136222/index.html">Manual: Pyramid for People - Part 2</a></li>
<li><a href="../136224/index.html">We build a tracked Bluetooth robot with a camera. Part 3</a></li>
<li><a href="../136225/index.html">About two-dimensional packaging: offline algorithms</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>