<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>FLProg + Nextion HMI. Lesson 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In previous lessons ( lesson 1 , lesson 2 ), I explained how to draw the interface of the Nextion HMI panel, how to control the panel with the Arduino...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>FLProg + Nextion HMI. Lesson 3</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/221/5cc/315/2215cc315ef044008bfbc77b0a9b6a9a.png"><br><br>  In previous lessons ( <a href="https://geektimes.ru/company/flprog/blog/273868/">lesson 1</a> , <a href="https://geektimes.ru/company/flprog/blog/274050/">lesson 2</a> ), I explained how to draw the interface of the Nextion HMI panel, how to control the panel with the Arduino.  In this tutorial, I’ll show you how to solve the inverse problem — control the Arduino board using the Nextion HMI panel. <br>  In the lesson, we will expand the project of the previous lesson, add fan control, which will turn on when the temperature exceeds the specified limit, and turn off when the temperature drops below the second limit.  The settings will be set from the panel and stored in the non-volatile memory of the Arduino controller.  In addition, we will make a light switch on the panel (two-way) and a button with which we will turn on the flashlight (for example, to give a signal to aliens). <br><a name="habracut"></a><br>  Modified scheme from the last lesson.  The lantern, the light and the fan will mimic the LEDs. <br><img src="https://habrastorage.org/files/108/887/fc9/108887fc97124f3aa2597671e1fc523c.PNG"><br><br>  Also the project of the panel is improved.  Added two pages.  In addition, the font loaded in the panel has been replaced.  The project for the panel is in the archive, a link to which is given at the end of the article.  In the comments to the past lesson, I was quite rightly scolded for the lack of design talent.  I completely agree with this, so the new pages have no design, pure functionality. <br>  Consider new pages. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Management page (“page3”, ID = 3).</b> <br><img src="https://habrastorage.org/files/f53/475/3e3/f534753e34d541b0a519e9d63ba3ca8a.PNG"><br><br>  Consider the items on the page. <br><br><ol><li>  Just text fields.  Nothing interesting. </li><li>  Field display setpoint fan on.  As I already wrote, the panel does not know how to work with fractional numbers.  Therefore, these are text fields.  The row for display will be prepared on arduinka.  Item Parameters <br><img src="https://habrastorage.org/files/413/8a4/81d/4138a481d6b34b849c9f1c3181800186.PNG"><br>  Since the value in this field will be sent from the controller, we make it global (the “vscope” attribute is set to “global”).  Clicking on this field will open the value edit page.  Therefore, the following code is recorded in the “Touch Press Event” event. <br><img src="https://habrastorage.org/files/3d5/dec/ee6/3d5decee64374165a29854797e74f286.PNG"><br>  When you click on an element, first in the editable value field on page 4 we enter the current value. <br><pre><code class="hljs">page4.evtemp.txt=onV.txt</code> </pre> <br>  Then in the variable that stores the identifier of the editable field on page 4, enter the identifier of the field that was clicked. <br><pre> <code class="hljs scala">page4.varN.<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  Well, go to the edit value page. <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">page</span></span> page4</code> </pre> <br><br></li><li>  Field display setting off the fan.  Almost identical to the previous field.  Item Parameters <br><img src="https://habrastorage.org/files/b4a/e51/538/b4ae51538bef45bfb53ce2ae154a46ca.PNG"><br>  The code in the event “Touch Press Event”. <br><img src="https://habrastorage.org/files/9ef/379/001/9ef379001eed40578b7c421a88f8993e.PNG"><br>  In this code, the difference from the previous one is only in the field identifier. <br><pre> <code class="hljs scala">page4.varN.<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><br></li><li>  Button back.  Copied from the last lesson.  Item Parameters <br><img src="https://habrastorage.org/files/e89/e52/5af/e89e525af96248868f8506c259f05fec.PNG"><br>  The code in the event “Touch Press Event”. <br><img src="https://habrastorage.org/files/72f/15a/e66/72f15ae66eac437e84eca112fc64e1b0.PNG"><br><br></li><li>  Two-position switch (“Dual-state button”) - light control. <br>  Item Parameters <br><img src="https://habrastorage.org/files/6c3/8a4/341/6c38a43413f4435a8292add512061f4f.PNG"><br>  The state value of this element will be read from the controller, therefore the global element (the “vscope” attribute and the value “global”).  As the background display mode, the picture mode is selected (the “sta” attribute is set to “image”).  Pictures are set in the attributes “pic0” for state 0 and “pic1” for state 1. <br><br></li><li>  Button (“Button”) - turn on the flashlight.  Item Parameters <br><img src="https://habrastorage.org/files/8c5/5e3/e8b/8c55e3e8b7394171adb4436992cc2d2e.PNG"><br>  We will stop here in more detail.  We will monitor the button presses from the controller to control the lamp.  Unfortunately, in Arduino it is impossible to set an interrupt to receive a byte from the UART (at least by means of standards).  Therefore, we had to implement memorization of the fact of pressing and releasing the button using two variables (7 and 8).  We will not directly apply to the button, so it can be done both locally and globally (I made it global just in case).  The following code is written in the button click handler (“Touch Press Event”). <br><img src="https://habrastorage.org/files/68f/4e8/233/68f4e82332df4f54ab4a757174a78369.PNG"><br>  And in the button release handler (“Touch Release Event”) such. <br><img src="https://habrastorage.org/files/c04/25f/66d/c0425f66d38244288a707c3f47a0cd87.PNG"><br>  We need these variables in the click tracking block in the FLProg project. <br><br></li></ol><br>  <b>Edit value window (“page4”, ID = 4).</b> <br><img src="https://habrastorage.org/files/93e/87e/629/93e87e629fd44572a6116bfa7549578c.PNG"><br>  Consider what is included in it. <br><ol><li>  Editable value field.  Item Parameters <br><img src="https://habrastorage.org/files/cdc/34f/371/cdc34f3719d044ee9f4fc2e1bd69268d.PNG"><br>  The value of this field will be read from the controller, accordingly we make it global (the “vscope” attribute is set to “global”). <br><br></li><li>  Value entry buttons.  All these buttons are almost identical, and differ in the inscription and code in the event handler “Touch Press Event”.  When you click on one of these buttons, the corresponding symbol is added to the current value of the editable value field. <br><div class="spoiler">  <b class="spoiler_title">The code in the event “Touch Press Event” for each of the buttons.</b> <div class="spoiler_text">  “0” <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"0"</span></span></code> </pre> <br>  "one" <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"1"</span></span></code> </pre> <br>  “2” <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"2"</span></span></code> </pre> <br>  “3” <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"3"</span></span></code> </pre> <br>  "four" <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"4"</span></span></code> </pre> <br>  "five" <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"5"</span></span></code> </pre> <br>  “6” <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"6"</span></span></code> </pre> <br>  “7” <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"7"</span></span></code> </pre> <br>  "eight" <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"8"</span></span></code> </pre> <br>  "9" <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"9"</span></span></code> </pre> <br>  “.” <br><pre> <code class="hljs objectivec">evtemp.txt=evtemp.txt+<span class="hljs-string"><span class="hljs-string">"."</span></span></code> </pre> <br></div></div><br></li><li>  Button to clear the field.  Pressing it deletes the field value. <br>  The code in the event “Touch Press Event” <br><pre> <code class="hljs objectivec">evtemp.txt=<span class="hljs-string"><span class="hljs-string">""</span></span></code> </pre> <br></li><li>  Button to delete the last character. <br>  The code in the event “Touch Press Event” <br><pre> <code class="hljs">evtemp.txt=evtemp.txt-1</code> </pre> <br>  This is not a documented feature.  It removes the last character in the string.  I spied it on one of the videos on the manufacturer's website.  In general, I did not find almost any information on working with strings on the panel. <br><br></li><li>  Button to finish editing the value. <br>  Pressing this button will be tracked on the controller, so two variables are created for it (“endPress” and “endRel”) and the code is written in the event handlers. <br>  The code in the event “Touch Press Event” <br><pre> <code class="hljs scala">page4.endPress.<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  The code in the event “Touch Release Event” <br><pre> <code class="hljs scala">page4.endRel.<span class="hljs-keyword"><span class="hljs-keyword">val</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><br></li><li>  Cancel button.  By pressing this button, we simply return to the control page. <br>  The code in the event “Touch Press Event” <br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">page</span></span> page3</code> </pre> <br><br></li></ol><br>  With the panel finished, go to the FLProg program.  It also uses the project from the last lesson a little modified.  The project file is in the archive, the link to which is given at the end of the post. <br>  As in the last lesson, I will show the finished circuit boards and tell what is happening in them. <br>  <b>Fee 7 - "Lantern Management"</b> <br><br><img src="https://habrastorage.org/files/20c/561/619/20c561619b51414fbb0c0fdb36da2d1b.PNG"><br><br>  Everything is simple here.  Block B46 - “Tracking Clicks” (library of elements, folder “Nextion HMI Panel”).  At its output, it has a value corresponding to the state of the monitored button or another element of the having the “Touch Press Event” and “Touch Release Event” on the panel.  This value is directly recorded in the exit tied to the lamp.  The block is parameterized using the block editor. <br><br><img src="https://habrastorage.org/files/082/eab/5de/082eab5dedc34570a35e925aa8993a55.PNG"><br><br>  In the block editor, you need to select a panel, and then create a new page and write the necessary elements on it.  How to do this, I told in the previous lesson. <br><br><img src="https://habrastorage.org/files/b3f/94f/ea2/b3f94fea2181418aa75de4462c9f4206.PNG"><br><br>  You should get this picture. <br><br><img src="https://habrastorage.org/files/fbd/252/df3/fbd252df3fcb4f3c97317d06d8237a49.PNG"><br><br>  As a pressing variable, select the variable to which we write the unit in the “Touch Press Event” button, and as the release variable, the variable from the “Touch Release Event” button. <br><br>  <b>Fee 8 - "Control of the light."</b> <br><br><img src="https://habrastorage.org/files/884/fdb/e32/884fdbe3225b4449aca906a410ae234e.PNG"><br><br>  Same very simple fee.  Here we read the switch position using block B47 - “Get Parameter” (element library -&gt; Nextion HMI Panel folder -&gt; Elements folder).  This value is then sent directly to the output block tied to the lighting.  The block is parameterized using the block editor. <br><br><img src="https://habrastorage.org/files/210/53e/646/21053e6461ea4a86a2d518bfd0f8a3ba.PNG"><br><br>  To reduce the load on the controller, we will make a request for the state of the switch once a second. <br><br>  <b>Board 9 - "The end of the editing parameters."</b> <br>  On this board, we will process the click on the "Finish" button on the edit options page. <br><br><img src="https://habrastorage.org/files/848/9d8/c85/8489d8c852da426aa4f88e0fca493e44.PNG"><br><br>  With the help of block B48 - “Tracking of clicks” (library of elements, folder “Nextion HMI Panel”) we determine the moment of clicking.  In the editor of this block, we will create page 4 and fill it with elements of interest to us. <br><br><img src="https://habrastorage.org/files/2f7/818/f29/2f7818f298d34f609971a64c09053c10.PNG"><br><br>  And configure the block. <br><br><img src="https://habrastorage.org/files/379/1d2/3c6/3791d23c667f416d82bff16ca6c4f37a.PNG"><br><br>  Using block 49 - “Rtrig” (library of elements, “Triggers” folder), select the leading edge of the signal that the “Done” button is clicked and write to the “Editing end” variable. <br>  Also on this front, we read the value of the variable that stores the identifier of the editable field using the block B54 - “Get Parameter” (element library -&gt; Nextion HMI Panel folder -&gt; Elements folder).  Block settings. <br><br><img src="https://habrastorage.org/files/bd2/bc1/c66/bd2bc1c66daf4ba19e8424d74648463b.PNG"><br><br>  The resulting value is set to the variable "Editable field number". <br>  And for the same impulse, we will directly read the new value from the text field using the B50 block - - “Get Parameter” (element library -&gt; Nextion HMI Panel folder -&gt; Elements folder).  Block settings. <br><br><img src="https://habrastorage.org/files/b46/3a0/32b/b463a032bde0419da9d26ca913e8bc2c.PNG"><br><br>  We transform a new value from a string into a number in the Float format using block B51 - “String Conversion” (library of elements, “Type Conversion” folder).  Block settings. <br><br><img src="https://habrastorage.org/files/6a7/516/598/6a7516598acf4c6c83c8512b19841b5f.PNG"><br><br>  Multiply the number by 10 using the block B52 - “MUL (*)” (library of elements, “Mathematics” folder), change the type to Integer using the block B53 - “Convert Float to Integer” (library of elements, “Conversion of types” folder) and put in the variable "New value". <br><br>  <b>Fee 10 - "Processing the results of editing values"</b> <br><br><img src="https://habrastorage.org/files/1e9/970/39c/1e997039cc3c4537bbd4aefe2e5a8e87.PNG"><br><br>  Using the block B55 - “Comparator” (library of elements, folder “Comparison”) we determine which field was edited and, depending on the result, write the value from the variable “New value” by impulse in the variable “Editing end” to one of two variables, in the “fan off setting x10” or in the “fan on setting x10”.  Also for the same impulse, we give the panel command to go to the control page using the B58 block “Go to page” (library of elements, folder “Nextion HMI Panel” -&gt; “Page” folder).  Block settings. <br><br><img src="https://habrastorage.org/files/f67/1e9/03c/f671e903cfc34abcb725e0e241b3c797.PNG"><br><br>  <b>Fee 11 - “Writing setting values ​​to the panel and EEProm”</b> <br><br><img src="https://habrastorage.org/files/3f4/c77/146/3f4c77146fe9469bb9d6fdc7f7df14b6.PNG"><br><br>  With the help of block 59 - “Number change detector” (library of elements, folder “Basic elements”) we determine the fact of changing the value of the variable “Fan activation setting x10”.  At the output of the block, a short pulse is formed at the moment of changing the value at the input “Value”.  This impulse records the value to the non-volatile memory of the controller.  This is done with the help of block B65 - “Recording in EEPROM” (library of elements, folder “EEPROM”).  The block is configured using the block editor. <br><br><img src="https://habrastorage.org/files/2da/162/bf6/2da162bf62144c4a864c8aabd1ad309f.PNG"><br><br>  Before writing a variable in the EEPROM, you need to create it there.  To do this, click the "Create" button in the block editor.  The variable creation window opens. <br><br><img src="https://habrastorage.org/files/755/94e/c4c/75594ec4cb8243b5a88a7eb857a4b1d6.PNG"><br><br>  In it we set the name of the variable and its type.  After pressing the button, the block is ready to be bound to this variable. <br><br><img src="https://habrastorage.org/files/e80/76c/4bd/e8076c4bd256488290502c409775024b.PNG"><br><br>  Also, by the signal of a variable change, its value is divided into a constant of type Float equal to 10 with the help of block 61 - “DIV (/)” (library of elements, folder “Mathematics”), turns into a string with the help of block B62 - “String conversion” (library of elements, folder “type conversion”), and is sent to the panel in the appropriate field using block B63 - “Set Parameter” (library of elements, folder “Nextion HMI Panel” -&gt; Elements folder).  Settings of this unit. <br><br><img src="https://habrastorage.org/files/b4c/ee8/803/b4cee88034a54492a5441d394b2678d1.PNG"><br><br>  The logic of the variable control “Setting the fan off x10” is similar, the settings of the blocks are as follows. <br><br>  Block b65. <br><br><img src="https://habrastorage.org/files/c1d/543/faf/c1d543faf0a0479eb0dea94b12b9e30d.PNG"><br><br>  Block B68. <br><br><img src="https://habrastorage.org/files/77d/c88/6c5/77dc886c54cb4c9981dfed2416a2a397.PNG"><br><br>  Now we will ensure reading the settings from the EEPROM at the time of the controller start.  To do this, we insert a new board at the very top of the project in order for the circuit located on it to be executed in the first place.  To do this, select the first plan and press the button "Insert board before the selected one". <br><br><img src="https://habrastorage.org/files/981/31f/ca6/98131fca63f940659d73bd8adf398b80.PNG"><br><br>  Let's call the new board “Reading settings from EEPROM”. <br><br>  <b>Fee 1.</b> <br><br><img src="https://habrastorage.org/files/141/f9d/23a/141f9d23ac12428397de261516f52fb2.PNG"><br><br>  Using the block B72 - “Rtrig” (library of elements, folder “Triggers”) we create one short impulse when the controller is turned on.  According to this impulse, the values ​​read from the non-volatile memory are recorded into the variables “Setting the fan on x10” and “Setting the fan x10 off”.  This happens with the help of blocks B71 and B73 - “Reading from EEPROM” (library of elements, “EEPROM” folder).  Blocks are parameterized using the block editor. <br><br><img src="https://habrastorage.org/files/2da/48a/e59/2da48ae5964a45768b2983e24b7faf63.PNG"><br><br>  Parameters block B71. <br><br><img src="https://habrastorage.org/files/377/ce7/122/377ce71220fd460982eea7fbbe704d7f.PNG"><br><br>  The selection of a readable variable in the EEPROM is made by pressing the “Select” button.  The variable selection window opens. <br><br><img src="https://habrastorage.org/files/5d5/b01/d35/5d5b01d35ef74968a8a18367cb27548a.PNG"><br><br>  Block B73 parameters. <br><br><img src="https://habrastorage.org/files/518/a99/862/518a998626ad4583ba0f6587a3d4b309.PNG"><br><br>  Well, the last board in the project. <br><br>  <b>Fee 12. "Fan control"</b> <br><br><img src="https://habrastorage.org/files/336/979/a52/336979a526da49e7b457edfcb70c98a0.PNG"><br><br>  If the current temperature exceeds the setpoint “Fan on setpoint x10”, this will detect the comparison unit B69 and set trigger B70 to state 1, and when the temperature drops below set point setpoint fan off switch x10, it will be detected by block B71, which sets trigger B70 to state 0. The state of the trigger is fed to the output unit associated with the fan. <br><br>  <a href="https://yadi.sk/d/-LMYfYBQque7m">Archive with source code of projects.</a> <br><br>  Video demonstration <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/j8ZimsAfq8k%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiIYKtLcEuwGEws3VmNA_09rfM3qw" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/392865/">https://habr.com/ru/post/392865/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../392855/index.html">The future of storage systems</a></li>
<li><a href="../392857/index.html">Alteration of the push-button radio switch to touch</a></li>
<li><a href="../392859/index.html">Robots now steal money from Russian bank cards</a></li>
<li><a href="../392861/index.html">Brew beer in drip coffee maker</a></li>
<li><a href="../392863/index.html">Little secret artist Alexei Leonov</a></li>
<li><a href="../392867/index.html">The Chinese have edited the DNA of a human embryo a second time.</a></li>
<li><a href="../392869/index.html">Airbus and Siemens will build electric and hybrid aircraft engines</a></li>
<li><a href="../392871/index.html">Uber gave the US authorities data on 12 million users and published testimony of canary</a></li>
<li><a href="../392873/index.html">CO (carbon monoxide) detector. What is it and why?</a></li>
<li><a href="../392875/index.html">Automatic generation of inventions for the public domain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>