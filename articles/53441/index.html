<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Grab pages with WebHarvest</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The task of hornbeat information from web pages is always relevant. As for a project, and in order to more convenient use of the resource. I mean usab...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Grab pages with WebHarvest</h1><div class="post__text post__text-html js-mediator-article">  The task of hornbeat information from web pages is always relevant.  As for a project, and in order to more convenient use of the resource.  I mean usability or simply the need to see the data in another section.  To rob someone else's information and use it for commercial purposes is always bad, they usually try to punish and punish for it.  And for personal use, you can use it freely.  This can probably be compared with the use of a pencil or colored markers when reading newspapers and magazines.  For example, if I am circling ads in red, then in yellow, and some are crossed out in bold, I simply qualitatively change the display of information in the light necessary for my tasks.  But lawyers need to be afraid. <br><a name="habracut"></a><br><h4>  The origin of the task </h4><br>  About six months ago, a blogcampCEE was scheduled to take place in Kiev and everyone who wanted to take part in the event had to register and fill out their profile.  At that time I was little acquainted with the local market of Internet projects, as well as with who does what on the Ukrainian IT and Internet markets.  Public profiles of the participants of this event will allow to make a certain picture of the market participants (parties).  It is convenient to use such information when it is on one page.  In order to collect all these data manually, it would be necessary to spend a lot of time navigating through pages and save-pastes, and it would also have to be updated with pens over time. <br><br><h4>  Finding the way </h4><br>  Programming skills there, it means you can come up with something.  And laziness, as we know, is the engine of progress.  Just recently, colleagues at work solved the problem of getting a site rating from <a href="http://www.alexa.com/">Alex‚Äôs</a> html page on <a href="http://www.alexa.com/">Alex</a> .  And it was hidden behind a bunch of dummy spans with generated styles, which made it impossible to directly draw out this value.  So we met then <a href="http://web-harvest.sourceforge.net/">WebHarvest</a> .  And they perfectly solved this task, and even with a bunch of similar ones that arise when writing tools for SEO.  After all, they need a lot of data, page ranks, persistence of keywords, competitor analysis, etc.  etc.  And for 80% of the tasks associated with the collection of information, the API does not exist, you just have to run around the pages and collect this info. <br><br>  So, I want to share my experience of getting the necessary information in a readable form from BlogcampCEE (just a real life example) using WebHarvest library, Java programming language (in the background), <a href="http://ant.apache.org/">Ant</a> build tool and XSLT processor for converting XML to HTML. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  First approach </h4><br>  Found at that time page <a href="http://blogcampcee.com/ru/group/tracker">blogcampcee.com/ru/group/tracker</a> which tracks all open events occurring on the site.  Among them is an event of type Usernode, which means the registration of a new user and contains a link to the user profile. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/e90/ea0/3fc/e90ea03fce626075eb4382fbf432995e.gif" alt="image"><br><br>  Later, I found the <a href="http://blogcampcee.com/ru/userlist">blogcampcee.com/ru/userlist</a> page, where only users are shown, and it would be more logical to take it as an entry point to a task.  But it was too late, everything has already been done.  She would not really help, except that she accelerated the work due to the absence of uninteresting events and additional type checking.  From the clicks would not save for sure. <br><br>  The task was to scroll through all possible pages, get all the links to the users' pages and then go through each user and collect the necessary information. <br><br>  It is necessary to write a configuration file in the GUI of Webharvest, not so hot development environment, but nothing is better than it.  Debugging is also not easy.  But at least the state of the variables can be viewed at any point in the execution.  And this is a lot. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/f0c/fe2/603/f0cfe260346bc687730d1fede72b72a8.gif" alt="image"><br>  WebHarvest GUI <br><br>  <a href="">Functions</a> are taken out in the functions.xml file, which will then be used in the main configuration file.  A separate function was used to walk on leaflets and pull links to user pages (borrowed with some changes from the examples on WebHarvest). <br><br>  The main configuration file <a href="">blogcamp.xml</a> contains the logic of passing through the pages of users and pulling out some fields, including links to personal pages and sites of projects, which I was most interested in.  And all this information in the custom xml format ( <a href="">users-samples.xml</a> ) is saved to a file. <br><br><h4>  Modernization </h4><br>  The XML file is not very convenient to read, so user <a href="">-style.xsl</a> was written for it to give a readable and convenient look. <br><br>  And we get this page at the output of the XSLT processor. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/3be/e0a/f73/3bee0af73d47cdcea1d9347808c32255.gif" alt="image"><br>  The desired format of the list of users. <br><br><h4>  The structure of the mini-project </h4><br>  WebHarvest is a purely programmer tool which, as a library, is convenient to use in your projects by feeding it the necessary configuration files and getting the desired result.  Therefore, we will link the hornbeam and XSL transformation into a single process with the help of Ant, as if it will continue to develop into a complex product or so that it does not have to be remembered in the future, but how did this whole business come about and where did it come from.  So <a href="">build.xml</a> and such structure turned out. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/f5d/edf/91a/f5dedf91aaf5868313b65ab8e59ccbfc.gif" alt="image"><br><br>  Now, when in the future it is necessary to remember what is happening and what is going on here, and repeating these procedures (and this happens not infrequently and after a long time, when you have time to completely forget what it is all about) it will be very easy to resume, repeat, edit and etc.  etc. <br><br>  Problem solved.  The necessary information is on one page in a convenient form for me.  The whole process is easily repeated by pressing a single button, which is very important as the number of users increases and over time you will need to update your sheet. <br><br><h4>  disadvantages </h4><br>  The most important is the absence of multithreading in the hornbeam process.  The command line works in this way only.  This was not critical for my task.  Programmatically you are free to do what you want.  And please organize multithreading, parallelization and work in distributed mode on a cluster of N computers.  All in your hands. <br><br>  Not entirely successful structure of the solution itself.  When a passage is immediately made to identify all user references, and then processing is already done on them.  It is better to do the processing of the user's link as soon as it is received and save the result to a file.  Then, at the break of a connection or something else, you will not have to run a hornbeam from the very beginning, but you can continue from the place where everything fell. <br><br>  There is no sequence number in the resulting HTML, I already noticed that later, and it was too lazy to finish it, because this is XSLT again. <br><br>  Few comments in all configuration files.  Sorry, but it is a scourge that haunts me constantly.  Usually they begin to be written after marking the six months of work on the project and you realize that the memory resource has exhausted itself, and the project bells and whistles do not think to stop :) <br><br>  And many more can be found. <br><br><h4>  Materials </h4><br>  I do not like when reading an article you can not immediately try everything in life.  Therefore, I post the <a href="">archive with the full project</a> , including WebHarvest.  For convenient operation, you need to run Ant from the command line anywhere on your system.  Important!  Do not torment the blogcamp site.  Although the event has passed, but anyway, this is after all the hosting and traffic is not necessarily anlim. <br><br>  If you don't work a lot with XPath, then this is all quickly forgotten.  Here are a couple of resources that helped me refresh (learn) the features of these technologies. <br><br>  <a href="http://www.w3.org/TR/xpath">XPath specification</a> <br>  <a href="http://www.zvon.org/xxl/XPathTutorial/General/examples.html">XPath writing examples</a> <br><br><h4>  Conclusion </h4><br>  The main goal is to show the possibility of using WebHarvest tools, as a grabber in their projects. <br><br>  Tulza has enough features and frills, including using Javascript and XQuery, saving cookies, basic authentication, user-agent substitution, custom request headers, etc.  Yes, and you can rewrite a part of the API or cast it beyond recognition, which the father of the creator will not recognize later. </div><p>Source: <a href="https://habr.com/ru/post/53441/">https://habr.com/ru/post/53441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../53435/index.html">Vim as an IDE for web development, and not only.</a></li>
<li><a href="../53436/index.html">Intel: Programmable and Transformable Matter</a></li>
<li><a href="../53437/index.html">Read the book out loud - to prison</a></li>
<li><a href="../53438/index.html">Some innovations in the profile</a></li>
<li><a href="../53439/index.html">Skortovki for programmers</a></li>
<li><a href="../53442/index.html">Internet Explorer 8 Mail.Ru</a></li>
<li><a href="../53443/index.html">Module Responses</a></li>
<li><a href="../53445/index.html">Next Mac mini, iMac, Mac Pro update</a></li>
<li><a href="../53446/index.html">Notepad for everything else</a></li>
<li><a href="../53447/index.html">Comic: "Why computer scientists always look like idlers"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>