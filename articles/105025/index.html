<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The principles of the poker bot. part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is a continuation of this habratopik . In this part of creating a poker bot, we will talk about the decision-making algorithm. Basically,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The principles of the poker bot. part 2</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/051fbbdd/10607e46/ffd25aee/3df34568.gif" align="left"><br><br>  This article is a continuation of this <a href="http://habrahabr.ru/company/pokeroff/blog/96491/">habratopik</a> .  In this part of creating a poker bot, we will talk about the decision-making algorithm.  Basically, it will focus on strategies that can be successfully applied and receive some kind of income.  It is necessary to understand that standard algorithms can work in plus only on small limits, where there are many players with a very non-optimal game who are willing to give us a lot of money.  For further improvement, you need to introduce additional elements that players of higher limits take into account using player statistics. <br><a name="habracut"></a><br><br><h4>  Basics of Poker Mathematics </h4><br><img src="https://habrastorage.org/storage/1c18176b/a632f90a/b9f2a2d8/407a9721.png" align="left"><br>  Poker is in many ways a mathematical game.  Especially a large part of the mathematics is in online games, because we do not see our opponent, we cannot use the so-called ‚Äútelsy‚Äù - tips that the player‚Äôs behavior gives us.  All our decisions are based on the estimated range of the opponent's cards and how our hand stands against this range. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To determine the profitability of an action, we use the concept of mathematical expectation in monetary terms, or EV (Expected Value).  It is defined as the sum of all possible outcomes of an event expressed in money multiplied by the probability of this event: <br><br>  EV = X <sub>1</sub> ($) * P <sub>X1</sub> + X <sub>2</sub> ($) * P <sub>X2</sub> +‚Ä¶ + X <sub>n</sub> ($) * P <sub>Xn</sub> . <br><br>  For example, let's take a situation: a no-limit hold'em game with blinds of $ 1 / $ 2, we have Q in our hands <img src="https://habrastorage.org/storage/30d74c87/fd1d5300/6918c7bd/d671feb4.gif">  Q <img src="https://habrastorage.org/storage/8094605a/8d751d2e/ba1e2501/cafc3d12.gif">  and $ 200 per stack, opponent A has <img src="https://habrastorage.org/storage/7b6a3195/00430bfb/d9fd87ad/db0239ef.gif">  K <img src="https://habrastorage.org/storage/7b6a3195/00430bfb/d9fd87ad/db0239ef.gif">  and $ 200.  Suppose the following actions occur preflop: you are raised to $ 8 in the small blind (everyone folds to you), your opponent in the big blind still raises to $ 20.  We have 3 possible actions: fold (fold), call (call), raise (raise).  For simplicity, we assume that we will do the following increase for the whole stack, the so-called push.  Calculate the EV of each of the actions. <br><br>  EV <sub>fold is</sub> always zero. <br><br>  To calculate EV, <sub>Eq. We</sub> take the <sub>following</sub> assumptions: if the flop is A or K, then we immediately play check / fold;  if not, then we play a check, our opponent bets (let it be $ 25), we raise and our opponent folds.  We get two events and the probability of A or K going to the flop is 32%. <br><br>  EV <sub>equal</sub> = ($ 40 - $ 12 + $ 25) * 0.68 + (-12 $) * 0.32 = $ 32.2. <br><br>  To calculate the EV push, we assume that the opponent is always ready to play the stack.  To determine the probability of the outcome of each of the events, use the wonderful program <a href="http://manuals.pokeroff.ru/blog/note/394433/">PokerStove</a> (you can download it <a href="http://pokerstove.com/download/">here</a> ).  The principle of its work is quite simple: considering the given cards (specific or card ranges) of opponents, the program randomly distributes the missing cards of the board a large number of times, and thus the probability of winning / draw for each opponent in percentages is statistically obtained.  In our case, the probability of winning Q <img src="https://habrastorage.org/storage/30d74c87/fd1d5300/6918c7bd/d671feb4.gif">  Q <img src="https://habrastorage.org/storage/8094605a/8d751d2e/ba1e2501/cafc3d12.gif">  - 53.786% and 46.214% for A <img src="https://habrastorage.org/storage/7b6a3195/00430bfb/d9fd87ad/db0239ef.gif">  K <img src="https://habrastorage.org/storage/7b6a3195/00430bfb/d9fd87ad/db0239ef.gif">  .  Get the EV calculation: <br><br>  <sub>Push Push</sub> EV = $ 208 * 0.53786 + (-192 $) * 0.46214 = $ 28.9. <br><br>  As a result, we have a positive EV for both calling and pushing.  Moreover, a call is more profitable, because on average, each time $ 32.2 will be paid to us.  We received a rather simplified calculation based on what our opponent's cards knew.  In the real game, we will not see the opponent's cards and he may not be alone, which complicates the calculation of EV.  For the actions of opponents in the full calculation will be taken into account three actions: fold, call, raise;  and for each street.  Therefore, the number of terms in the calculation will increase greatly.  In addition, we will not be able to accurately determine the probability of an opponent's actions (how often he will raise, call), but in any case, EV is a common parameter for determining the profitability of an action. <br><br>  For a simple algorithm for playing on micro-limits, it is sufficient to clearly define the rules with which cards are worth playing, and with which are not.  First, we will look at the simplest strategies that can be easily algorithmized, and then we will discuss how to improve decision making by the bot with the help of additional parameters and non-standard techniques. <br><br><h4>  Short Stack Strategy </h4><br>  One of the basic strategies is the Short Stack Strategy (SSS).  Its main advantages are that it is quite simple, basically it is an exact algorithm of actions for each of the variants of the rally;  the main disadvantage is a small win.  In general, the concept of winrate is used to determine the profitability of a game in poker, which is measured in BB / 100 hands - the number of big blinds won per 100 hands.  So, for a standard SSS, the average win rate is 2 BB / 100, although the professionals of this strategy, using additional techniques, can bring the profit up to 5 BB / 100 and more.  Not so long ago, in the Pokerstars room, the accounts on which the bots played were revealed and they used exactly the strategy of short stacks, details can be read <a href="http://interesnoe.pokeroff.ru/blog/note/1485667/">here</a> .  In general, it is quite difficult to identify bots, you need to have a very large history of hands on them in order to somehow prove the stereotyped nature of their actions, so it is not known how many bots play on the Internet now. <br><br>  Briefly consider the strategy itself, a detailed description of it can always be found on poker sites.  Its very name comes from the fact that you need to enter the game with a short stack.  The standard purchase of No Limit Hold'em is 100 BB, for SSS you need to enter the game with 20 BB.  And if the stack becomes more than 30 BBs, you need to leave the table, because the strategy becomes unprofitable;  and if the stack drops to 15 BB, you need to re-buy again to 20 BB.  A small stack leads to the fact that often the game ends already on the flop or the maximum on the turn, because after raising preflop we only have all-in or fold on the flop.  Therefore, the strategy is very simple and you do not need to take into account all possible options for the development of actions postflop. <br><br>  The strategy itself is applied at long (full ring) tables (9-10 people), the fewer people at the table, the worse for a short stack, and it is not profitable to play against other short stacks.  Therefore, when choosing tables, you need to look at tables with at least 6-7 players with a full stack. <br><br>  The beginning of our strategy is the starting hands chart (descriptions with which hands it is worth entering the game preflop, when we see only two cards in our hands).  We get an exact table of actions preflop: <br><br><img src="https://habrastorage.org/storage/c983446c/0c704294/2607dd5b/6a8ee28c.png"><br><br>  Where s - suited cards (suited), if the letters "s" are not present, then cards are also suited and unsuited.  For example, the range ‚Äú77+, AJ +, ATs, KQs‚Äù includes - ‚ÄúAA, KK, QQ, JJ, TT, 99, 88, 77, AKs, AKo, AQs, AQo, AJs, AJo, ATs, KQs‚Äù. <br><br>  Let's determine the size of the bets: we increase by 4 BB + 1 BB for each limper (limp - calling the game preflop with a call).  For example, with BB = 0.1 $ and two limpers in front of us, if we want to enter the game with a raise, we should bet 4 * 0.1 $ + 2 * 0.1 $ = 0.6 $.  If there has already been a raise before us and we want to make a re-raise, then its size should be 3 times the size of the raise + 1 raise for each call equalized.  For example, with an increase of $ 0.4, we need to bet $ 1.2.  There is still a rule: if the size of our bet is more than half of our stack, then you should immediately move all in. <br><br>  We have analyzed preflop actions, now let's define what we should do with 3 open cards on the table.  You need to continue to bet and play, if necessary, on the stack with the finished hand (top pair and better) and strong draws (when one card is not enough to flush or straight).  It is also necessary to use the continued bid, but about this technique in the last part of the article. <br><br>  Recently, there is a tendency to fight poker rooms with short stacks.  On Full Tilt, the minimum entry to the game is 35 BB on standard tables and there are a small number of tables where you can play with 20 BBs on the stack, where it is often not profitable to play according to the SSS strategy due to the large number of short stacks at the tables.  Pokerstars divided their tables at minimum-maximum purchases by 20-50 BB, 50-100 BB.  But all the same, in all rooms there are tables for playing with a short stack, and in smaller poker rooms there are no such restrictions at all where you can successfully use this strategy. <br><br><h4>  Independent chip model (ICM) </h4><br>  ICM is a mathematical model that is used in Sit-n-go games (CIS) and is successfully used in the late stage of these tournaments, the so-called push-fold.  Usually this stage comes when the stack becomes less than 10 BB and there is no sense to enter the game with a raise or a call, and there are only two options for playing: push or fold.  In tournaments other than EV (or chipEV, cEV), you need to introduce the concept of $ EV - the cash value of EV (how many chips are in prize money), because in tournaments they do not match.  This can be seen quite clearly in the initial stage, when doubling chips (EV) will not double the $ EV.  Therefore, there are such border moves that are simultaneously + EV and - $ EV, it is important for us to receive a monetary profit,  make moves + $ EV. <br><br>  Then a small tie-in with boring ICM math, who are not interested, can skip this section. <br><blockquote>  <font color="gray">In ICM, to calculate $ EV - the player's expected income based on the current number of chips, the following method is used: the probability with which the player takes a certain place is calculated, then each of the probabilities is multiplied by the money equivalent for that place and summed up.</font>  <font color="gray">The probability of winning first place is defined as the ratio of the number of player chips to all chips in a tournament.</font>  <font color="gray">For clarity, we will use an example: in a CIS tournament for 10 people, costing $ 10 (distribution of prizes between the first 3 places: $ 5, $ 3, $ 2) there are 3 players left with stacks: A = 7500, B = 4500, C = 3000 (for simplicity and clarity of calculations we will not take into account that the blinds have already been put and are not in the stacks of players).</font>  <font color="gray">Thus, the probability of winning first place for player B:</font> <font color="gray"><br><br></font>  <font color="gray">P <sub>B1</sub> = V <sub>B</sub> / (V <sub>ALL</sub> ) = 4500 / (7500 + 4500 + 3000) = 30%.</font> <font color="gray"><br><br></font>  <font color="gray">To determine the probability of a player B to take 2nd place, you need to determine it for the case if player A wins (R <sub>A1</sub> = 50%) and if player C wins (P <sub>C1</sub> = 20%) and add them together.</font>  <font color="gray">In this case, the winner‚Äôs stack is not taken into account:</font> <font color="gray"><br><br></font>  <font color="gray">P <sub>B2</sub> = P <sub>A1</sub> * P <sub>B2, C3</sub> + P <sub>C1</sub> * P <sub>B2, A3</sub> =</font> <font color="gray"><br><br></font>  <font color="gray">= 0.5 * 4500 / (4500 + 3000) + 0.2 * 4500 / (4500 + 7500) = 0.395 = 39.5%.</font> <font color="gray"><br><br></font>  <font color="gray">We get P <sub>B3</sub> = 1 - P <sub>B1</sub> - P <sub>B2</sub> = 1 - 0.3 - 0.395 = 0.305 = 30.5%.</font> <font color="gray"><br><br></font>  <font color="gray">So $ EV <sub>B</sub> = P <sub>B1</sub> * V1 <sub>$</sub> + P <sub>B2</sub> * V2 <sub>$</sub> + P <sub>B3</sub> * V3 <sub>$</sub> =</font> <font color="gray"><br><br></font>  <font color="gray">= 0.3 * $ 5 + 0.395 * $ 3 + 0.305 * $ 2 = $ 3.30.</font> <font color="gray"><br><br></font>  <font color="gray">Now that we know how to calculate $ EV, we can determine the profitability of our move.</font>  <font color="gray">To clarify our example, player B is in the small blind position with A</font> <font color="gray"><img src="https://habrastorage.org/storage/7b6a3195/00430bfb/d9fd87ad/db0239ef.gif"></font>  <font color="gray">T</font> <font color="gray"><img src="https://habrastorage.org/storage/7b6a3195/00430bfb/d9fd87ad/db0239ef.gif"></font>  <font color="gray">in hand, player A folds.</font>  <font color="gray">Let's calculate which move is more profitable: push or fold.</font> <font color="gray"><br><br></font>  <font color="gray">With a fold, nothing changes and Player B has the same $ EV <sub>fold</sub> = $ 3.30.</font> <font color="gray"><br><br></font>  <font color="gray">When pushing there are three options:</font> <font color="gray"><br><br></font> <ol><li>  1. Player C will accept our bet and lose.  Suppose he calls with a range: 88+, A9s +, ATo, KTs +, KQo (10% of the spectrum), then he loses in 42% of cases.  The probability of such an outcome is 10% * 42% = 4.2%, and $ EV <sub>B</sub> after it will be $ 4. </li><li>  2. Player C will accept our bet and win.  The probability of this outcome is 10% * 58% = 5.8%, and $ EV <sub>B</sub> = $ 2.47. </li><li>  3. Player C will fold 90% of the time and EV <sub>B</sub> will remain equal to $ 3.30. </li></ol><br>  We get a total of $ EV <sub>push</sub> taking into account all possible outcomes: <br><br>  $ EV <sub>push</sub> = 0.042 * $ 4 + 0.058 * $ 2.47 + 0.9 * $ 3.295 = $ 3.28.  Those.  Our share in the tournament after this push will eventually decrease, it turns out to be unprofitable.  In fact, the difference is insignificant, so this push can be called borderline, i.e.  it is profitable for us to do it with the best hands, but not with the worst.  The calculations did not take into account the blinds, so as not to be confused with unnecessary numbers, but the principle of calculation was clear. </blockquote><br>  If everything is clear with mathematics, then only one relative value remains - the range of cards with which the opponent will answer or raise, which we need to calculate our chances of winning.  For this, you can use predefined average call and push ranges for different levels of the stack relative to the blinds.  For example, for 9-10 BB, you can take a push range from early position: 77+, AJs, AQo, KQs;  and calling: TT +, AQ.  The fewer blinds in the stack, the wider the range.  Ready-made push-fold tables can be found and used on many poker sites, you can take them for the ranges of the average player.  And if you work well with these ranges, you can get quite a positive bot. <br><br><h4>  Improving Algorithms </h4><br>  The basic algorithms are the basis for an improved strategy, it will be very useful to diversify the game of the bot with the techniques that other players often use and make it possible to confuse the opponent with their actions.  In general, let's talk about bluffing, or rather his particular cases. <br><br>  <i>Continued bet</i> - a bet on the next street with aggression on the previous (raise, re-raise).  A very popular trick, often used on the flop if we raise a pre-flop with a good card (for example, AK), but we don‚Äôt hit the board and still make a bet, showing that we have a good card (say, a high pair).  For a bot, so that its game is not too readable, you can enter a continued bet in 70-80% of cases.  The size of the bet must be chosen the same as the bet with the cards in hand so that it is impossible to determine the bluff.  For an advanced continuation bet, you can choose the appropriate flops for her.  Because  the purpose of this technique is to force the opponent to fold, then we need to choose flops in which the opponent is more likely not to hit.  Usually this is an uncoordinated offsuit flop, preferably with one high card (so that your opponent does not want to continue the game if he has a pair below), for example A27, K35. <br><br>  <i>An aggressive draw</i> is a semi-bluff variant when we can get a monster combination on the following streets.  It makes sense for a double-sided straight draw (we have QJ, on the table KT4 - ace and 9-ka give us a straight), a flush draw (we have AhTh, on the table 9h5h3c - any chirva gives us a nut flush) .  Reception is performed with the expectation that the opponent will fold, and even if the struggle continues, we have a chance to get the best hand.  At what our monster will be disguised, because we showed aggression, when there was no possibility of a flush or straight.  When programming a bot, you can use this technique, say, in 60-70% of cases. <br><br>  <i>Disguise</i> - here I would like to mention how you can try to disguise the behavior of our bot.  Determining a program based on a sufficient hand history is not so difficult - preflop and postflop actions will give it away.  To avoid this, you can enter an element of chance in the choice of cards to be played.  For example, if we have a draw of JJ + pairs in the range, then jacks can be played in 80% and, for example, tens in 20% of cases.  Or vary call and raise, say 50/50.  It is still useful sometimes to play random cards in general (as is often the case with people), then it will not be possible to select the exact range of cards played and determine patterned actions. <br><br><h4>  Conclusion </h4><br>  We have reviewed the short stack strategy and ICM with you, because they are fairly simple to describe.  There is a more general strategy of large stacks for no-limit hold'em, but it includes much more nuances, because the game continues on the turn and on the river, unlike the CCC, and the description will take more than one article.  The same can be said about limit hold'em - the strategy of the game cannot be described briefly, but it is even more suitable for algorithmization, because mathematics plays a greater role in it (than in no-limit hold'em).  Therefore, with proper knowledge of the strategy in limit hold'em, you can quite successfully apply it to the compilation of the algorithm. <br><br>  And yet do not forget that the use of bots and any similar programs that give an advantage over other players is prohibited in any poker rooms, so do not take this article as a guide to action. <br><br>  Article <a href="http://www.pokeroff.ru/">Pokeroff.ru</a> specifically for Habrahabr </div><p>Source: <a href="https://habr.com/ru/post/105025/">https://habr.com/ru/post/105025/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../105020/index.html">The battle with the "dark genius" or Microsoft-HTTPAPI / 2.0 strikes the first blow</a></li>
<li><a href="../105021/index.html">Java as a language for parallel computing. Installation, configuration, first program</a></li>
<li><a href="../105022/index.html">Redis 2.0</a></li>
<li><a href="../105023/index.html">The first Lenovo brand store opened in Moscow</a></li>
<li><a href="../105024/index.html">InvoiceMall - SaaS billing service for studios and freelancers</a></li>
<li><a href="../105026/index.html">Plugin for the Site Memory Button in WordPress</a></li>
<li><a href="../105028/index.html">160 byte Brainfuck interpreter</a></li>
<li><a href="../105029/index.html">DXCore - Free library for creating plugins in Visual Studio</a></li>
<li><a href="../105030/index.html">Welcome to the new era!</a></li>
<li><a href="../105032/index.html">Google buys a startup in two weeks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>