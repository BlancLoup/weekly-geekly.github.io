<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Iterators & Generators</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Processing elements of a collection / array is a common and frequent operation. There are several ways to bypass the collection in JavaScript, startin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Iterators & Generators</h1><div class="post__text post__text-html js-mediator-article"> Processing elements of a collection / array is a common and frequent operation.  There are several ways to bypass the collection in JavaScript, starting with a simple <code>for(;;)</code> and <code>for a in b</code> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> divs = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'div'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, c = divs.length; i &lt; c; i++) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(divs[i].innerHTML); }</code> </pre><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = {<span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">c</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> obj) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(i, obj[i]); }</code> </pre><br>  The Array object has methods to bypass all <code>map(), filter()</code> elements. <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doubled = numbers.map(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> item * <span class="hljs-number"><span class="hljs-number">2</span></span>; }); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(doubled);</code> </pre><br>  Firefox has an <a href="https://developer.mozilla.org/en/JavaScript/Guide/Predefined_Core_Objects">array filler</a> (Array comprehensions) <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> numbers = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doubled = [i * <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> each (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> numbers)]; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(doubled); <span class="hljs-comment"><span class="hljs-comment">// [2, 4, 6, 8]</span></span></code> </pre><br>  Iterators and Generators appeared in JavaScript 1.7 (according to Mozilla) they still exist in Firefox 2+ (the article will mention the way how they can be ‚Äúemulated‚Äù in almost all browsers with a crutch) Iterators and Generators introduce a mechanism that allows you to control <code>for in</code> and encapsulate the process of getting the next item in the list of objects. <br><br>  Often, to traverse and process the elements of an array, we write large constructions, often copy-pasting their parts.  The task of Generators and Iterators is to improve this process by adding syntactic sugar. <br><a name="habracut"></a><br><h4>  Iterators </h4><br>  Everyone knows that in JavaScript you can bypass almost any object: <br>  <b>Array</b> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> object = [<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> object) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(i, object[i]); }</code> </pre><br>  <b>An object</b> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> object = {<span class="hljs-attr"><span class="hljs-attr">a</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">c</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> object) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(i, object[i]); }</code> </pre><br>  <b>Line</b> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> object = <span class="hljs-string"><span class="hljs-string">'abc'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> object) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(i, object[i]); }</code> </pre><br>  <b>Some list</b> <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> object = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'div'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> object) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (object.hasOwnProperty(i)) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(i, object[i]); } }</code> </pre><br>  We traverse all objects sequentially and cannot control the sequence.  Iterators have a similar interface, but provide the ability to manage items: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      An iterator is an object that knows how to access the elements of a collection one at a time, keeping its current position (cursor) in this sequence.  In JavaScript, an iterator is an object that has a <code>next()</code> method that returns the next object in the sequence.  This method can cause a <code>StopIteration</code> exception when the sequence has ended. <br><br>  The iterator can be used in different ways: directly through a call to the <code>next()</code> method or using <code>for...in</code> or <code>for each</code> (FF) constructs. <br><br>  There are several ways to create an iterator: <br><br><h5>  Call Iterator function </h5><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lang = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'JavaScript'</span></span>, <span class="hljs-attr"><span class="hljs-attr">birthYear</span></span>: <span class="hljs-number"><span class="hljs-number">1995</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> it = Iterator(lang); <span class="hljs-comment"><span class="hljs-comment">// &lt;&lt;&lt;</span></span></code> </pre><br>  After creating an iterator, the <code>it</code> object can be iterated using <code>next()</code> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pair = it.next(); <span class="hljs-comment"><span class="hljs-comment">//  ["name", "JavaScript"] pair = it.next(); //  ["birthYear", 1995] pair = it.next(); //    StopIteration</span></span></code> </pre><br>  For traversal, you can use <code>for...in</code> or <code>for each</code> .  The traversal will be stopped as soon as the exception <code>StopIteration</code> is thrown: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> it = Iterator(lang); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> it) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(pair); <span class="hljs-comment"><span class="hljs-comment">// 2  [key, value] }</span></span></code> </pre><br>  One of the advantages of <code>Iterator()</code> is that it bypasses only its own properties (remember the example of traversing <code>querySelectorAll</code> ) while traversing you do not need to check <code>object.hasOwnProperty</code> . <br><br>  <code>Iterator()</code> can also be used for an array: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> langs = [<span class="hljs-string"><span class="hljs-string">'JavaScript'</span></span>, <span class="hljs-string"><span class="hljs-string">'Python'</span></span>, <span class="hljs-string"><span class="hljs-string">'C++'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> it = Iterator(langs); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> it) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(pair); <span class="hljs-comment"><span class="hljs-comment">// [index, language] }</span></span></code> </pre><br>  If the <code>Iterator</code> function <code>Iterator</code> second argument, then only the indices will be iterated: <pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> langs = [<span class="hljs-string"><span class="hljs-string">'JavaScript'</span></span>, <span class="hljs-string"><span class="hljs-string">'Python'</span></span>, <span class="hljs-string"><span class="hljs-string">'C++'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> it = Iterator(langs, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pair <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> it) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(pair); <span class="hljs-comment"><span class="hljs-comment">// 0, 1, 2 }</span></span></code> </pre><br>  For the index and value, you can select your own variables using <code>let</code> and destructive assignment (FF only): <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> langs = [<span class="hljs-string"><span class="hljs-string">'JavaScript'</span></span>, <span class="hljs-string"><span class="hljs-string">'Python'</span></span>, <span class="hljs-string"><span class="hljs-string">'C++'</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> it = Iterator(langs); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> [i, lang] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> it) { <span class="hljs-comment"><span class="hljs-comment">//  FF console.log(i + ': ' + lang); //  "0: JavaScript" . }</span></span></code> </pre><br>  This way of creating iterators is not very useful and is similar to the usual <code>for in</code> without <code>Iterator</code> . <br><br><h5>  Creating your own iterators </h5><br>  Some objects are a collection of items that need to be iterated in a special way.  For example: <br>  - Iteration of the Range object should return the numbers included in the set. <br>  - Tree leaves can be bypassed using <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25B8%25D1%2581%25D0%25BA_%25D0%25B2_%25D1%2588%25D0%25B8%25D1%2580%25D0%25B8%25D0%25BD%25D1%2583">a wide</a> <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25B8%25D1%2581%25D0%25BA_%25D0%25B2_%25D0%25B3%25D0%25BB%25D1%2583%25D0%25B1%25D0%25B8%25D0%25BD%25D1%2583">search</a> or <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25B8%25D1%2581%25D0%25BA_%25D0%25B2_%25D0%25B3%25D0%25BB%25D1%2583%25D0%25B1%25D0%25B8%25D0%25BD%25D1%2583">a depth search.</a> <br>  - The results of the query to the database are returned as an object that can be iterated and return the data set in one record. <br>  - An iterator of an infinite mathematical sequence (for example, a Fibonacci sequence) must return results one by one without creating an array of infinite length. <br><br>  Let's create a simple Range object that stores a range. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Range</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">low, high</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.low = low; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.high = high; }</code> </pre><br>  Now create your iterator, which returns a sequence of this range.  The iterator interface requires us to create a <code>next()</code> method that will return an element of the sequence and throw a <code>StopIteration</code> exception at the end. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RangeIterator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">range</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.range = range; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.range.low; } RangeIterator.prototype.next = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current &gt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.range.high) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">StopIteration</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.current++; };</code> </pre><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ri = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RangeIterator(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)); ri.next(); <span class="hljs-comment"><span class="hljs-comment">// ... ri.next(); // StopIteration</span></span></code> </pre><br><br>  Somehow not very comfortable.  To get rid of the <code>RangeIterator</code> constructor, <code>RangeIterator</code> will use the <code>__iterator__</code> method <code>__iterator__</code> the <code>Range</code> object.  This method will be called when trying to iterate over the elements of a <code>Range</code> object. This method should return a <code>RangeIterator</code> that includes the iterator logic. <br><br><pre> <code class="javascript hljs">Range.prototype.__iterator__ = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RangeIterator(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Range(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(i); <span class="hljs-comment"><span class="hljs-comment">// 3, 4, 5 }</span></span></code> </pre><br>  Conveniently enough, but a lot of excess. <br><br><h4>  Generators </h4><br>  Arbitrary iterators are handy, but creating them requires careful programming and memorizing the internal state.  Generators are a more common alternative.  They allow you to define an alternative algorithm using one function that remembers its state (a kind of finite automaton). <br><br>  A generator is a special type of function that works as a factory for creating iterators.  Any function containing at least one <code>yield</code> becomes a generator. <br><br>  <b>Note:</b> In the original, generators are only available in Firefox 2+ with an overridden version of JavaScript <code>&lt;script type="application/javascript;version=1.7"&gt;</code> <br><br>  When a generator function is called its body is not executed.  It works as a constructor that creates and returns an Iterator-Generator.  Each call to the Iterator-Generator method <code>next()</code> will perform the function body until a <code>yield</code> is returned that returns a result.  If the function ends with <code>return</code> or the function body ends, the <code>StopIteration</code> exception is <code>StopIteration</code> and the iterator stops its operation. <br><br>  We describe in the example: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simpleGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-string"><span class="hljs-string">"first"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-string"><span class="hljs-string">"second"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-string"><span class="hljs-string">"third"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>; i++) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> i; } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> g = simpleGenerator(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(g.next()); <span class="hljs-comment"><span class="hljs-comment">// "first" console.log(g.next()); // "second" console.log(g.next()); // "third" console.log(g.next()); // 0 console.log(g.next()); // 1 console.log(g.next()); // 2 console.log(g.next()); // StopIteration</span></span></code> </pre><br>  The Generator function can be used as the <code>__iterator__</code> method of an <code>__iterator__</code> object.  This will significantly reduce the amount of code.  Let's rewrite the example from Range using generators: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Range</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">low, high</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.low = low; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.high = high; } Range.prototype.__iterator__ = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.low; i &lt;= <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.high; i++) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> i; } }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Range(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(i); <span class="hljs-comment"><span class="hljs-comment">// 3, 4, 5 }</span></span></code> </pre><br>  It turned out 3 times shorter <br><br>  With the help of generators you can create endless sequences.  Let us examine an example of Fibonacci numbers: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fibonacci</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fn1 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fn2 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> current = fn2; fn2 = fn1; fn1 = fn1 + current; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> current; } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sequence = fibonacci(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(sequence.next()); <span class="hljs-comment"><span class="hljs-comment">// 1 console.log(sequence.next()); // 1 console.log(sequence.next()); // 2 console.log(sequence.next()); // 3 console.log(sequence.next()); // 5 console.log(sequence.next()); // 8 // ...</span></span></code> </pre><br>  Generator functions can pass arguments.  You can interrupt generators using <code>StopIteration</code> or <code>return</code> .  Rewrite the Fibonacci example using the <code>limit</code> argument. <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fibonacci</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">limit</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fn1 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fn2 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> current = fn2; fn2 = fn1; fn1 = fn1 + current; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (limit &amp;&amp; current &gt; limit) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> current; } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sequence = fibonacci(<span class="hljs-number"><span class="hljs-number">7</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(sequence.next()); <span class="hljs-comment"><span class="hljs-comment">// 1 console.log(sequence.next()); // 1 console.log(sequence.next()); // 2 console.log(sequence.next()); // 3 console.log(sequence.next()); // 5 console.log(sequence.next()); // StopIteration</span></span></code> </pre><br><h4>  Advanced Generators </h4><br>  Generators calculate their next value on request.  This allows you to create sequences that are difficult to calculate or they are infinite, as in the example above. <br><br>  In addition to the <code>next()</code> method, the Iterator-Generator has a <code>send()</code> method that allows you to change the internal state of the generator.  The value passed to <code>send()</code> will be perceived as the result of the last <code>yield</code> that stopped the generator.  You must start the generator with <code>next()</code> before calling <code>send()</code> . <br><br>  Here is a rewritten Fibonacci generator using <code>send()</code> to restart the sequence: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fibonacci</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fn1 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fn2 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> current = fn2; fn2 = fn1; fn1 = fn1 + current; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reset = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> current; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reset){ fn1 = <span class="hljs-number"><span class="hljs-number">1</span></span>; fn2 = <span class="hljs-number"><span class="hljs-number">1</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sequence = fibonacci(); print(sequence.next()); <span class="hljs-comment"><span class="hljs-comment">// 1 print(sequence.next()); // 1 print(sequence.next()); // 2 print(sequence.next()); // 3 print(sequence.next()); // 5 print(sequence.send(true)); // 1 print(sequence.next()); // 1 print(sequence.next()); // 2 print(sequence.next()); // 3</span></span></code> </pre><br>  You can force the generator to throw an exception by calling the <code>throw()</code> method.  This method takes one argument, which will throw the generator ( <code>throw value;</code> ).  This exception will be thrown from the current stopped generator context (in the place where the last <code>yield</code> ). <br><br>  If the generator was not started (there was no call to the <code>next()</code> method), then <code>throw()</code> will call <code>next()</code> and throw an exception at the <code>yield</code> . <br><br>  You can close the generator using the <code>close()</code> method: <br>  This method does the following: <br>  - All <code>finally</code> blocks will be executed. <br>  - If the <code>finally</code> block throws an exception other than <code>StopIteration</code> , then the exception will be thrown into the context from which the <code>close()</code> method was called <br>  - The generator is destroyed <br><br><h4>  Generators Expressions </h4><br>  The ‚Äúarray placeholder‚Äù has one significant drawback when it is called; it fills the array and takes up memory.  When an array is small, it is invisible, in the case of large arrays, it is very expensive, and in the case of an infinite number of elements, the Array array does not make sense. <br><br>  Generators perform calculations on demand.  Generator expressions are similar to ‚ÄúArray placeholders‚Äù, but instead of creating an array, Generator expressions create iterator generators that are executed on demand.  You can call them short generators. <br><br>  Suppose we have an iterator that bypasses a large number of integers.  We want to create a new iterator that will iterate over duplicate numbers.  Using the "Array Filler" we will create a whole array in memory containing the multiplied values: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> doubles = [i * <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> it)];</code> </pre><br>  Generators expressions will create a new iterator that will multiply the numbers on demand: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> it2 = (i * <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> it)); print(it2.next()); <span class="hljs-comment"><span class="hljs-comment">//    print(it2.next()); //   </span></span></code> </pre><br>  An expression generator can be passed as an argument to a function.  Additional brackets in this case can be omitted: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = doSomething(i * <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> it));</code> </pre><br><br><h4>  Examples </h4><br>  Doubles of numbers, Finobacci sequence is very cool, but somehow far from life.  Let's look at life examples: <br><br><h5>  1. Traversing the DOM tree </h5><br>  On the page there are several links.  For each, you need to get a domain and <code>innerHTML</code> and if <code>innerHTML</code> matches the domain, output the domain to the console. <br><br>  Links for test: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://ya.ru/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://google.ru/"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://habrahabr.ru/"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://twitter.com/"</span></span></span><span class="hljs-tag">&gt;</span></span>twitter.com<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Our code to Generators: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> aList = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.querySelectorAll(<span class="hljs-string"><span class="hljs-string">'a'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>, c = aList.length, a, content, domain; i &lt; c; i++) { a = aList[i]; content = a.innerHTML; domain = a.getAttribute(<span class="hljs-string"><span class="hljs-string">'href'</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'http://'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).split(<span class="hljs-string"><span class="hljs-string">'/'</span></span>).shift(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (content === domain) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(domain); } }</code> </pre> <br>  Everything is natural and understandable.  And if we need to use this cycle for other checks?  Skopipastim code?  Generators helps;) Rewrite: <br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//    type="application/javascript;version=1.7" var aDomainContentGenerator = function () { var aList = document.querySelectorAll('a'); for (var i = 0, c = aList.length, a, content, domain; i &lt; c; i++) { a = aList[i]; content = a.innerHTML; domain = a.getAttribute('href').replace('http://', '').split('/').shift(); yield {domain: domain, content: content}; } }; var ancors = aDomainContentGenerator(); //  -      //   for c if,   . ,     var ancorsWithSameContentAndDomain = (item for (item in ancors) if (item.content === item.domain)); for (item in ancorsWithSameContentAndDomain) { console.log(item.domain); }</span></span></code> </pre><br>  The code has turned out a little more, but the code has grown in width (this is an important plus) and now we can use the <code>aDomainContentGenerator()</code> generator for other purposes. <br><br><h5>  2. Traversing the tree </h5><br>  There is a tree in which lines are scattered.  You must display them in ascending order: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Tree</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">left, label, right</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.left = left; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.label = label; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.right = right; } <span class="hljs-comment"><span class="hljs-comment">//      function inorder(t) { if (t) { for (var item in inorder(t.left)) { yield item; } yield t.label; for (var item in inorder(t.right)) { yield item; } } } //    function make(array) { //  : if (array.length == 1) return new Tree(null, array[0], null); return new Tree(make(array[0]), array[1], make(array[2])); } var tree = make([[['a'], 'b', ['c']], 'd', [['e'], 'f', ['g']]]); //  for (var node in inorder(tree)) { console.log(node); // a, b, c, d, ... }</span></span></code> </pre><br>  There was one bulky structure in the code. <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> inorder(t.right)) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> item; }</code> </pre> <br>  Which in the future they want to replace with: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> inorder(t.right);</code> </pre><br><h5>  Generators can be used for </h5><br>  - Beautiful iteration of iterated objects: lists (lines in a file, query result to a database,), recursive traversal of trees (XML, HTML, Binary, and other arbitrary), creation and traversing of Range objects (0..10) <br>  - Bypass access logs.  For example, there are several rotated access logs. It is necessary to collect information about the amount of transferred data. <br>  - yield can act as a breakpoint during debug <br>  - Can be used to split a long cycle into several parts (both in time and in the number of processed cycle elements) <br>  - Pseudo-random number generator or sequence <br>  - Basis for Wizards / Wizards (step-by-step interface) <br>  - Can be used to change the behavior of an event (for example, clicking on a button) <br><br><h4>  Generator Benefits </h4><br>  1. Perform on-demand calculations <br>  2. Do not take up extra memory <br>  3. Encapsulate the process of getting a collection item. <br>  4. Stretch the code <br>  5. Generators can be used as filters, sticking together in the pipeline <br><br><h4>  Performance </h4><br>  Judging by the Python tests Generators are not inferior to normal cycles.  Read more in the presentation " <a href="http://www.dabeaz.com/generators/Generators.pdf">Generator Tricks For Systems Programmers An Introduction</a> " (Slide 22) <br>  According to the <a href="http://jsperf.com/generator-vs-common-loop/2">Generator vs Common Loop</a> test, the generators are one third slower than the cycle. <br><br><h4>  When can it be used? </h4><br>  In Firefox 2+ with an override of JavaScript, you can write right now.  The rest is getting worse.  There is one good project - Google traceur-compiler.  This compiler allows you to process future ES6 + code into ES3 code.  But this is not a panacea, the code from the ‚ÄúTree Traversal‚Äù example did not work in any browser <br>  TC does not understand for..in cycles of generators: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> node <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> inorder(tree)) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(node); <span class="hljs-comment"><span class="hljs-comment">// a, b, c, d, ... }</span></span></code> </pre><br>  He needs <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> node : inorder(tree)) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(node); <span class="hljs-comment"><span class="hljs-comment">// a, b, c, d, ... }</span></span></code> </pre><br>  But this view does not understand Firefox.  TC requires <code>Function#bind</code> , <code>Object.defineProperty</code> so the compiled version only works in the TC creator‚Äôs browser, Google Chrome :).  The compiled code of the generator is obtained monstrous with the use of a finite state machine and dances around <code>try catch</code> and other perversions.  It turns out this "code": <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Tree</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">left, label, right</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.left = left; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.label = label; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.right = right; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inorder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $that = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">__traceurIterator__</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $state = <span class="hljs-number"><span class="hljs-number">20</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $storedException; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $finallyFallThrough; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $__1; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $__2; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $__3; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $__4; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $result = { <span class="hljs-attr"><span class="hljs-attr">moveNext</span></span>:(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>($state) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(t) { $state = <span class="hljs-number"><span class="hljs-number">7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $state = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>: $__2 = inorder(t.left).__traceurIterator__(); $state = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($__2.moveNext()) { $state = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $state = <span class="hljs-number"><span class="hljs-number">5</span></span>; $finallyFallThrough = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: $__1 = $__2.current; $state = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: $result.current = $__1; $state = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($__2.close) $__2.close(); } $state = <span class="hljs-number"><span class="hljs-number">6</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>: $result.current = t.label; $state = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>: $__4 = inorder(t.right).__traceurIterator__(); $state = <span class="hljs-number"><span class="hljs-number">19</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($__4.moveNext()) { $state = <span class="hljs-number"><span class="hljs-number">13</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $state = <span class="hljs-number"><span class="hljs-number">16</span></span>; $finallyFallThrough = <span class="hljs-number"><span class="hljs-number">15</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span>: $__3 = $__4.current; $state = <span class="hljs-number"><span class="hljs-number">14</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>: $result.current = $__3; $state = <span class="hljs-number"><span class="hljs-number">19</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($__4.close) $__4.close(); } $state = <span class="hljs-number"><span class="hljs-number">17</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>: $state = $finallyFallThrough; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span>: $state = $finallyFallThrough; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span>: $state = <span class="hljs-number"><span class="hljs-number">22</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> $storedException; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-string"><span class="hljs-string">"traceur compiler bug: invalid state in state machine"</span></span> + $state; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>($caughtException) { $storedException = $caughtException; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>($state) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span>: $state = <span class="hljs-number"><span class="hljs-number">5</span></span>; $finallyFallThrough = <span class="hljs-number"><span class="hljs-number">21</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>: $state = <span class="hljs-number"><span class="hljs-number">5</span></span>; $finallyFallThrough = <span class="hljs-number"><span class="hljs-number">21</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>: $state = <span class="hljs-number"><span class="hljs-number">5</span></span>; $finallyFallThrough = <span class="hljs-number"><span class="hljs-number">21</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">19</span></span>: $state = <span class="hljs-number"><span class="hljs-number">16</span></span>; $finallyFallThrough = <span class="hljs-number"><span class="hljs-number">21</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span>: $state = <span class="hljs-number"><span class="hljs-number">16</span></span>; $finallyFallThrough = <span class="hljs-number"><span class="hljs-number">21</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span>: $state = <span class="hljs-number"><span class="hljs-number">16</span></span>; $finallyFallThrough = <span class="hljs-number"><span class="hljs-number">21</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> $storedException; } } }).bind($that) }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $result; } }; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">make</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">array</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(array.length == <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Tree(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, array[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Tree(make(array[<span class="hljs-number"><span class="hljs-number">0</span></span>]), array[<span class="hljs-number"><span class="hljs-number">1</span></span>], make(array[<span class="hljs-number"><span class="hljs-number">2</span></span>])); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tree = make([[[<span class="hljs-string"><span class="hljs-string">'a'</span></span>], <span class="hljs-string"><span class="hljs-string">'b'</span></span>,[<span class="hljs-string"><span class="hljs-string">'c'</span></span>]], <span class="hljs-string"><span class="hljs-string">'d'</span></span>,[[<span class="hljs-string"><span class="hljs-string">'e'</span></span>], <span class="hljs-string"><span class="hljs-string">'f'</span></span>,[<span class="hljs-string"><span class="hljs-string">'g'</span></span>]]]); { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> $__0 = inorder(tree).__traceurIterator__(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>($__0.moveNext()) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(node) { node = $__0.current; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(node); } } } } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($__0.close) $__0.close(); } }</code> </pre>  <i>Code for half the article - left to show that everything is bad with him ...</i> <br><br><h4>  Conclusion </h4><br>  In the original Generators can only be used in Firefox, and therefore can not be used (but you can play).  Even if you finish <code>Function#bind</code> and <code>Object.defineProperty</code> , in any case, TC turns the code into a brake monster and therefore its use is questionable. <br><br>  The only place where they can be successfully applied is the future <a href="http://blog.zpao.com/post/5641702863/spidernode-at-nodeconf-2011">SpiderNode</a> .  Iterators and Generators are an incredibly useful thing.  On the client, we will use them in 5 years (for all known reasons).  On the server, I hope, in the near future. <br><br><h4>  Read </h4><br>  1. MDC - <a href="https://developer.mozilla.org/en/JavaScript/Guide/Predefined_Core_Objects">Array comprehensions</a> <br>  2. <a href="http://wiki.ecmascript.org/doku.php%3Fid%3Dharmony:iterators">ES Harmony Iterators</a> <br>  3. <a href="http://wiki.ecmascript.org/doku.php%3Fid%3Dharmony:generators">ES Harmony Generators</a> <br>  4. MDC - <a href="https://developer.mozilla.org/en/JavaScript/Guide/Iterators_and_Generators">MDC Iterators and Generators Guide</a> <br>  5. MDC - <a href="">New in JavaScript 1.7</a> <br>  6. <a href="http://code.google.com/p/traceur-compiler/wiki/LanguageFeatures">traceur-compiler LanguageFeatures</a> <br><br>  JavaScript adopted 1-in-1 generators and iterators from Python, but there are few examples in JavaScript.  Kinu Palu links to resources Python: <br>  7. PEP 380, " <a href="http://www.python.org/dev/peps/pep-0380/">Syntax for delegating to a sub-generator</a> " <br>  8. PEP 255, " <a href="http://www.python.org/dev/peps/pep-0255/">Simple generators</a> " <br>  9. Presentation of " <a href="http://www.dabeaz.com/generators/Generators.pdf">Generator Tricks For Systems Programmers An Introduction</a> " <br><br>  Suggestions, suggestions, criticism are welcome! <br><br>  <b>UPD</b> Added generator performance test <a href="http://jsperf.com/generator-vs-common-loop/2">Generator vs Common Loop</a> </div><p>Source: <a href="https://habr.com/ru/post/122620/">https://habr.com/ru/post/122620/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../122612/index.html">Photocell bikini</a></li>
<li><a href="../122614/index.html">Review Yota Many</a></li>
<li><a href="../122615/index.html">Google cow</a></li>
<li><a href="../122616/index.html">Full IP-KVM for all deductible servers</a></li>
<li><a href="../122617/index.html">Integration of sites and social networks: ergonomic aspects</a></li>
<li><a href="../122623/index.html">About the WPA-PSK hacking algorithm</a></li>
<li><a href="../122625/index.html">"Innovative Laboratory" became a venture partner of RVK</a></li>
<li><a href="../122626/index.html">Toshiba took part in the celebration of the 20th anniversary of Intel in Russia</a></li>
<li><a href="../122627/index.html">A few words about high</a></li>
<li><a href="../122628/index.html">In St. Petersburg, a joint start-up is coming!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>