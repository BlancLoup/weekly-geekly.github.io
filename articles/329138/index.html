<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ENTRYPOINT vs CMD: Back to Basics</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The name ENTRYPOINT always confused me. This name implies that each container must have a specific ENTRYPOINT . But after reading the official documen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ENTRYPOINT vs CMD: Back to Basics</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/web/db7/f1b/ef2/db7f1bef2d5345deb8d484fb762a58ee.jpg" alt="Construction"></p><br><p> The name <code>ENTRYPOINT</code> always confused me.  This name implies that each container must have a specific <code>ENTRYPOINT</code> .  But after reading the <a href="https://docs.docker.com/engine/reference/builder/">official documentation,</a> I realized that this was not true. </p><a name="habracut"></a><br><h2 id="fakt-1-trebuetsya-opredelit-hotya-by-odnu-instrukciyu-entrypoint-ili-cmd-dlya-zapuska">  Fact 1: <code>ENTRYPOINT</code> define at least one instruction ( <code>ENTRYPOINT</code> or <code>CMD</code> ) (to run). </h2><br><p>  If you do not identify any of them, you will receive an error message.  Let's try launching an Alpine Linux image for which neither <code>ENTRYPOINT</code> nor <code>CMD</code> are defined. </p><br><pre> <code class="hljs pgsql">$ docker run alpine docker: Error response <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> daemon: <span class="hljs-keyword"><span class="hljs-keyword">No</span></span> command specified. See <span class="hljs-string"><span class="hljs-string">'docker run --help'</span></span>.</code> </pre> <br><h2 id="fakt-2-esli-vo-vremya-vypolneniya-opredelena-tolko-odna-iz-instrukciy-to-i-cmd-i-entrypoint-budut-imet-odinakovyy-effekt">  Fact 2: If only one of the instructions is specified at runtime, then both <code>CMD</code> and <code>ENTRYPOINT</code> will have the same effect. </h2><br><pre> <code class="hljs pgsql">$ cat Dockerfile <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> alpine ENTRYPOINT ls /usr</code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><pre> <code class="hljs pgsql">$ docker run test bin lib <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> sbin <span class="hljs-keyword"><span class="hljs-keyword">share</span></span></code> </pre> <br><p>  We will get the same results if we use <code>CMD</code> instead of <code>ENTRYPOINT</code> . </p><br><pre> <code class="hljs pgsql">$ cat Dockerfile <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> alpine CMD ls /usr # <span class="hljs-keyword"><span class="hljs-keyword">Using</span></span> CMD <span class="hljs-keyword"><span class="hljs-keyword">instead</span></span></code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><pre> <code class="hljs pgsql">$ docker run test bin lib <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> sbin <span class="hljs-keyword"><span class="hljs-keyword">share</span></span></code> </pre> <br><p>  Although this example shows that there is no difference between <code>ENTRYPOINT</code> and <code>CMD</code> , you can see it by comparing container metadata. </p><br><p>  For example, the first <strong>Dockerfile</strong> file (with a specific <code>ENTRYPOINT</code> ): </p><br><pre> <code class="hljs cs">$ docker inspect b52 | jq .[<span class="hljs-number"><span class="hljs-number">0</span></span>].Config { ... <span class="hljs-string"><span class="hljs-string">"Cmd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, ... <span class="hljs-string"><span class="hljs-string">"Entrypoint"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"/bin/sh"</span></span>, <span class="hljs-string"><span class="hljs-string">"-c"</span></span>, <span class="hljs-string"><span class="hljs-string">"ls /"</span></span> ], ... }</code> </pre> <br><h2 id="fakt-3-i-dlya-cmd-i-dlya-entrypoint-suschestvuyut-rezhimy-shell-i-exec">  Fact 3: Both for <code>CMD</code> and <code>ENTRYPOINT</code> there are <em>shell</em> and <em>exec</em> modes. </h2><br><p>  From the <a href="https://docs.docker.com/engine/reference/builder/">manual</a> : </p><br><blockquote>  <code>ENTRYPOINT</code> has two execution modes: <br><ul><li>  <code>ENTRYPOINT ["executable", "param1", "param2"]</code> (executable form, preferred) </li><li>  <code>ENTRYPOINT command param1 param2</code> (shell form) </li></ul><br></blockquote><p>  So far, we have used <em>shell</em> mode, or shells.  This means that our <code>ls -l</code> runs inside <code>/bin/sh -c</code> .  Let's try both modes and examine the running processes. </p><br><p>  <em>Shell</em> mode: </p><br><pre> <code class="hljs pgsql">$ cat Dockerfile <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> alpine ENTRYPOINT ping www.google.com # "shell" <span class="hljs-keyword"><span class="hljs-keyword">format</span></span></code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><pre> <code class="hljs bash">$ docker run -d <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> 11718250a9a24331fda9a782788ba315322fa879db311e7f8fbbd9905068f701</code> </pre> <br><p>  Then we study the processes: </p><br><pre> <code class="hljs dos">$ docker exec <span class="hljs-number"><span class="hljs-number">117</span></span> ps PID USER <span class="hljs-built_in"><span class="hljs-built_in">TIME</span></span> COMMAND <span class="hljs-number"><span class="hljs-number">1</span></span> root <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> /bin/sh -c <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> www.google.com <span class="hljs-number"><span class="hljs-number">7</span></span> root <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> www.google.com <span class="hljs-number"><span class="hljs-number">8</span></span> root <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ps</code> </pre> <br><p>  Note that the <code>sh -c</code> process has a PID of 1. Now the same, using the <em>"exec"</em> mode: </p><br><pre> <code class="hljs pgsql">$ cat Dockerfile <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> alpine ENTRYPOINT ["ping", "www.google.com"] # "exec" <span class="hljs-keyword"><span class="hljs-keyword">format</span></span></code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><pre> <code class="hljs bash">$ docker run -d <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> 1398bb37bb533f690402e47f84e43938897cbc69253ed86f0eadb6aee76db20d</code> </pre> <br><pre> <code class="hljs pgsql">$ docker exec <span class="hljs-number"><span class="hljs-number">139</span></span> ps PID <span class="hljs-keyword"><span class="hljs-keyword">USER</span></span> <span class="hljs-type"><span class="hljs-type">TIME</span></span> COMMAND <span class="hljs-number"><span class="hljs-number">1</span></span> root <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ping www.google.com <span class="hljs-number"><span class="hljs-number">7</span></span> root <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ps</code> </pre> <br><p>  We see that when using the <em>exec</em> mode, the <code>ping www.google.com</code> command works with the process PID of 1, and the <code>sh -c</code> process is missing.  Note that the above example works the same way if you use <code>CMD</code> instead of <code>ENTRYPOINT</code> . </p><br><h2 id="fakt-4-rezhim-exec-yavlyaetsya-rekomenduemym">  Fact 4: The <em>exec</em> mode is recommended. </h2><br><p>  This is due to the fact that containers are designed to contain a single process.  For example, signals sent to a container are redirected to a process running inside a container with a PID of 1. Very informative experience: to check the fact of redirection, it is useful to start the <em>ping</em> container and try pressing <em>ctrl + c</em> to stop the container. </p><br><p>  The container defined using the <em>exec</em> mode successfully exits: </p><br><pre> <code class="hljs pgsql">$ cat Dockerfile <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> alpine ENTRYPOINT ["ping", "www.google.com"]</code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><pre> <code class="hljs pgsql">$ docker run test PING www.google.com (<span class="hljs-number"><span class="hljs-number">172.217</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.164</span></span>): <span class="hljs-number"><span class="hljs-number">56</span></span> data bytes <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">172.217</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.164</span></span>: seq=<span class="hljs-number"><span class="hljs-number">0</span></span> ttl=<span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.246</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">172.217</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.164</span></span>: seq=<span class="hljs-number"><span class="hljs-number">1</span></span> ttl=<span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.467</span></span> ms ^C <span class="hljs-comment"><span class="hljs-comment">--- www.google.com ping statistics --- 3 packets transmitted, 3 packets received, 0% packet loss round-trip min/avg/max = 0.246/0.344/0.467 ms $</span></span></code> </pre> <br><p>  When using the <em>shell</em> mode <em>, the</em> container does not work as expected. </p><br><pre> <code class="hljs pgsql">$ cat Dockerfile <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> alpine ENTRYPOINT ping www.google.com</code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><pre> <code class="hljs pgsql">$ docker run test PING www.google.com (<span class="hljs-number"><span class="hljs-number">172.217</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.164</span></span>): <span class="hljs-number"><span class="hljs-number">56</span></span> data bytes <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">172.217</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.164</span></span>: seq=<span class="hljs-number"><span class="hljs-number">0</span></span> ttl=<span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.124</span></span> ms ^C^C^C^C64 bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">172.217</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.164</span></span>: seq=<span class="hljs-number"><span class="hljs-number">4</span></span> ttl=<span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.334</span></span> ms <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">172.217</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.164</span></span>: seq=<span class="hljs-number"><span class="hljs-number">5</span></span> ttl=<span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.400</span></span> ms</code> </pre> <br><p>  Help, I can not go out!  The <code>SIGINT</code> signal that was sent to the <code>sh</code> process will not be redirected to the <code>ping</code> subprocess, and the shell will not shut down.  If for some reason you really want to use <em>shell</em> mode, the way out is to use <code>exec</code> to replace the shell process with the <code>ping</code> process. </p><br><pre> <code class="hljs pgsql">$ cat Dockerfile <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> alpine ENTRYPOINT exec ping www.google.com</code> </pre> <br><h2 id="fakt-5-net-obolochki-net-peremennyh-okruzheniya">  Fact 5: No shell?  No environment variables. </h2><br><p>  The problem with starting NOT in shell mode is that you cannot take advantage of the environment variables (such as <code>$PATH</code> ) and other features that the use of the shell provides.  There are two problems in the <strong>Dockerfile</strong> below: </p><br><pre> <code class="hljs pgsql">$ cat Dockerfile <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> openjdk:<span class="hljs-number"><span class="hljs-number">8</span></span>-jdk-alpine WORKDIR /data <span class="hljs-keyword"><span class="hljs-keyword">COPY</span></span> *.jar /data CMD ["java", "-jar", "*.jar"] # "exec" <span class="hljs-keyword"><span class="hljs-keyword">format</span></span></code> </pre> <br><p>  The first problem: since you cannot use the <code>$PATH</code> environment variable, you need to specify the exact location of the java-executable file.  The second problem: wildcards are interpreted by the shell itself, so the string <code>*.jar</code> will not be processed correctly.  After fixing these problems, the resulting <strong>Dockerfile</strong> file looks like this: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> openjdk:<span class="hljs-number"><span class="hljs-number">8</span></span>-jdk-alpine WORKDIR /data <span class="hljs-keyword"><span class="hljs-keyword">COPY</span></span> *.jar /data CMD ["/usr/bin/java", "-jar", "spring.jar"]</code> </pre> <br><h2 id="fakt-6-argumenty-cmd-prisoedinyayutsya-k-koncu-instrukcii-entrypoint--inogda">  Fact 6: CMD arguments are attached to the end of the <code>ENTRYPOINT</code> ... sometimes. </h2><br><p>  This is where the confusion begins.  The <a href="https://docs.docker.com/engine/reference/builder/" title="guide">manual</a> has a table whose purpose is to clarify this issue. </p><br><p><img src="https://habrastorage.org/web/ca2/564/592/ca25645927e9445c9a70475de1be7afc.png" alt="Entrypointscreen"></p><br><p>  I will try to explain <strong>on the fingers</strong> . </p><br><h3 id="fakt-6a-esli-vy-ispolzuete-rezhim-shell-dlya-entrypoint-cmd-ignoriruetsya">  Fact 6a: If you use <em>shell</em> mode for <code>ENTRYPOINT</code> , the <code>CMD</code> ignored. </h3><br><pre> <code class="hljs objectivec">$ cat Dockerfile FROM alpine ENTRYPOINT ls /usr <span class="hljs-built_in"><span class="hljs-built_in">CMD</span></span> blah blah blah blah</code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><pre> <code class="hljs pgsql">$ docker run test bin lib <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> sbin <span class="hljs-keyword"><span class="hljs-keyword">share</span></span></code> </pre> <br><p>  The string <code>blah blah blah blah</code> was ignored. </p><br><h3 id="fact-6b-pri-ispolzovanii-rezhima-exec-dlya-entrypoint-argumenty-cmd-dobavlyayutsya-v-konce">  FACT 6b: When using <em>exec</em> for <code>ENTRYPOINT</code> <code>CMD</code> arguments are added at the end. </h3><br><pre> <code class="hljs objectivec">$ cat Dockerfile FROM alpine ENTRYPOINT [<span class="hljs-string"><span class="hljs-string">"ls"</span></span>, <span class="hljs-string"><span class="hljs-string">"/usr"</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">CMD</span></span> [<span class="hljs-string"><span class="hljs-string">"/var"</span></span>]</code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><pre> <code class="hljs sql">$ docker run test /usr: bin lib local sbin share /var: <span class="hljs-keyword"><span class="hljs-keyword">cache</span></span> <span class="hljs-keyword"><span class="hljs-keyword">empty</span></span> lib <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> opt run spool tmp</code> </pre> <br><p>  The <code>/var</code> argument was added to our <code>ENTRYPOINT</code> , which allowed us to effectively run the <code>ls/usr/var</code> . </p><br><h3 id="fakt-6c-pri-ispolzovanii-rezhima-exec-dlya-instrukcii-entrypoint-neobhodimo-ispolzovat-rezhim-exec-i-dlya-instrukcii-cmd-esli-etogo-ne-sdelat-docker-popytaetsya-dobavit-sh--c-v-uzhe-dobavlennye-argumenty-chto-mozhet-privesti-k-nekotorym-nepredskazuemym-rezultatam">  Fact 6c: When using the <em>exec</em> mode for the <code>ENTRYPOINT</code> instruction, <code>ENTRYPOINT</code> must use the <em>exec</em> mode and for the <code>CMD</code> instruction.  If this is not done, Docker will try to add <code>sh -c</code> to the arguments already added, which can lead to some unpredictable results. </h3><br><h2 id="fakt-7-instrukcii-entrypoint-i-cmd-mogut-byt-pereopredeleny-s-pomoschyu-flagov-komandnoy-stroki">  Fact 7: The <code>ENTRYPOINT</code> and <code>CMD</code> instructions can be overridden using command line flags. </h2><br><p>  The <code>--entrypoint</code> flag can be used to override the <code>ENTRYPOINT</code> : </p><br><pre> <code class="hljs pgsql">docker run <span class="hljs-comment"><span class="hljs-comment">--entrypoint [my_entrypoint] test</span></span></code> </pre> <br><p>  Everything that follows the image name in the <code>docker run</code> overrides the <code>CMD</code> instruction: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">docker</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">run</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">test</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[command 1]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[arg1]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[arg2]</span></span></code> </pre> <br><p>  All of the above facts are true, but keep in mind that developers have the ability to override the flags in the <code>docker run</code> .  It follows that ... </p><br><h2 id="dostatochno-faktov-chto-zhe-delat-mne">  Enough facts ... What should I do? </h2><br><p>  Ok, if you have read the article to this place, here is the information, in which cases use <code>ENTRYPOINT</code> , and in which <code>CMD</code> . </p><br><p>  I am going to leave this decision to the person creating the <strong>Dockerfile</strong> , which can be used by other developers. </p><br><p>  Use <code>ENTRYPOINT</code> if you do not want developers to modify the executable file that starts when the container is started.  You can imagine that your container is an <em>executable shell</em> .  A good strategy would be to define a <em>stable</em> combination of parameters and an executable file as <code>ENTRYPOINT</code> .  For it, you can (optionally) specify the default <code>CMD</code> arguments that other developers can use to override. </p><br><pre> <code class="hljs objectivec">$ cat Dockerfile FROM alpine ENTRYPOINT [<span class="hljs-string"><span class="hljs-string">"ping"</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">CMD</span></span> [<span class="hljs-string"><span class="hljs-string">"www.google.com"</span></span>]</code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><p>  Run with default parameters: </p><br><pre> <code class="hljs pgsql">$ docker run test PING www.google.com (<span class="hljs-number"><span class="hljs-number">172.217</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.164</span></span>): <span class="hljs-number"><span class="hljs-number">56</span></span> data bytes <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">172.217</span></span><span class="hljs-number"><span class="hljs-number">.7</span></span><span class="hljs-number"><span class="hljs-number">.164</span></span>: seq=<span class="hljs-number"><span class="hljs-number">0</span></span> ttl=<span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.306</span></span> ms</code> </pre> <br><p>  Override CMD with your own parameters: </p><br><pre> <code class="hljs pgsql">$ docker run test www.yahoo.com PING www.yahoo.com (<span class="hljs-number"><span class="hljs-number">98.139</span></span><span class="hljs-number"><span class="hljs-number">.183</span></span><span class="hljs-number"><span class="hljs-number">.24</span></span>): <span class="hljs-number"><span class="hljs-number">56</span></span> data bytes <span class="hljs-number"><span class="hljs-number">64</span></span> bytes <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-number"><span class="hljs-number">98.139</span></span><span class="hljs-number"><span class="hljs-number">.183</span></span><span class="hljs-number"><span class="hljs-number">.24</span></span>: seq=<span class="hljs-number"><span class="hljs-number">0</span></span> ttl=<span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>=<span class="hljs-number"><span class="hljs-number">0.590</span></span> ms</code> </pre> <br><p>  Use only <code>ENTRYPOINT</code> (without an <code>ENTRYPOINT</code> definition), if required, so that developers can easily override the executable file.  If the entry point is defined, the executable file can still be overridden using the <code>--entrypoint</code> flag.  But it will be much more convenient for developers to add the desired command to the end of the <code>docker run</code> . </p><br><pre> <code class="hljs objectivec">$ cat Dockerfile FROM alpine <span class="hljs-built_in"><span class="hljs-built_in">CMD</span></span> [<span class="hljs-string"><span class="hljs-string">"ping"</span></span>, <span class="hljs-string"><span class="hljs-string">"www.google.com"</span></span>]</code> </pre> <br><pre> <code class="hljs bash">$ docker build -t <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> .</code> </pre> <br><p>  <em>Ping</em> is good, but let's try to run a container with a shell instead of a <code>ping</code> command. </p><br><pre> <code class="hljs pgsql">$ docker run -it test sh / # ps PID <span class="hljs-keyword"><span class="hljs-keyword">USER</span></span> <span class="hljs-type"><span class="hljs-type">TIME</span></span> COMMAND <span class="hljs-number"><span class="hljs-number">1</span></span> root <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> sh <span class="hljs-number"><span class="hljs-number">7</span></span> root <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span> ps / #</code> </pre> <br><p>  I prefer this method for the most part because it gives developers the freedom to easily override an executable file with a shell or other executable file. </p><br><h2 id="ochistka">  Cleaning </h2><br><p>  After running the commands, a bunch of stopped containers remained on the host.  Clean them with the following command: </p><br><pre> <code class="hljs pgsql">$ docker <span class="hljs-keyword"><span class="hljs-keyword">system</span></span> prune</code> </pre> <br><h2 id="obratnaya-svyaz">  Feedback </h2><br><p>  I will be glad to hear your thoughts on this article below in the comments.  In addition, if you know a simpler way to search for a docker output with <em>jq</em> so that you can do something like <code>docker inspect [id] | jq * .config</code>  <code>docker inspect [id] | jq * .config</code> , also write in the comments. </p><br><h3 id="dzhon-zakkone">  John zaccone </h3><br><p>  Captain Docker and IBM Cloud Engineer.  Specializes in Agile, microservices, containers, automation, REST, DevOps. </p><br><h3 id="ssylki">  References: </h3><br><ol><li>  <a href="http://www.johnzaccone.io/entrypoint-vs-cmd-back-to-basics/">ENTRYPOINT vs CMD: Back to Basics</a> </li></ol></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/329138/">https://habr.com/ru/post/329138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../329128/index.html">Another logging system, now on ElasticSearch, Logstash, Kibana and Prometheus</a></li>
<li><a href="../329130/index.html">The digest of interesting materials for Mobile Developer # 204 (May 15-21)</a></li>
<li><a href="../329132/index.html">Big data for big science. Lecture in Yandex</a></li>
<li><a href="../329134/index.html">Palmistry UX</a></li>
<li><a href="../329136/index.html">What is the essence of the Moby project and why the main Docker repository suddenly became moby / moby?</a></li>
<li><a href="../329140/index.html">Exception hierarchy in modern PHP application</a></li>
<li><a href="../329142/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ263 (May 15 - 21, 2017)</a></li>
<li><a href="../329146/index.html">Unity3d We play with the mesh. Part 3 - Collision Based Mesh Warp</a></li>
<li><a href="../329148/index.html">[Saint Petersburg] Andrei Ershov - CRDT. Conflict-free data synchronization</a></li>
<li><a href="../329150/index.html">How to write a chat bot in PHP for the VKontakte community</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>