<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Coloring images</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, Habrahabr. Today we will color. 
 What will be here? It will search for a color image with similar colors in black and white and the method of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Coloring images</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/667/f69/ec7/667f69ec73b2ee373c410acb4c5dde1f.png"><br>  Hello, Habrahabr.  Today we will color. <br>  What will be here?  It will search for a color image with similar colors in black and white and the method of transferring colors from first to second. <br><a name="habracut"></a><br><h4>  Color Image Search </h4><br>  What do we have?  Suppose we have a bunch of color images and one black and white, we want to choose from this heap one that best suits our black and white colors (if they had colors, he would have).  Each image in the election will represent its signature. <br><br>  <b>The signature</b> is 128 floating-point numbers, they are obtained from the histogram of the l (brightness) image (from the lab color model) normalized to one, that is, the sum of all 128 numbers is equal to 1 (normalization is needed to remove the image size effect on signature).  Schematically getting the image signature looks like this: <br><img src="https://habrastorage.org/storage2/8a5/730/65c/8a573065c2f4acae2eaf706c74f07db9.png"><br><br>  A similar approach is described in [2], there are other options for signatures and experimental results.  Now every color image has a signature, and black and white also has it, how do we choose an image?  We calculate the correlation between the signature of our colorless experimental and color candidates, and we get the winner by the largest value.  Correlation, by the way, is calculated like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/4d7/2e6/d3a/4d72e6d3a5b15a999c118f3e35c1e430.png"><br><br><img src="https://habrastorage.org/storage2/635/455/070/63545507065bf2b7935aa6253180e6e4.png"><br>  <i>Here H1 and H2 are signatures, N = 128 is the number of signature elements.</i>  <i>If d = 1, then the maximum match, -1 is the maximum difference, 0 means no correlation.</i>  <i>Thanks for the note of <a href="http://habrahabr.ru/users/assorium/" class="user_link">Assorium</a> , the deductible is really equal to 1/128 in this case.</i> <br>  At this stage, we already have a black and white image and an image of the source of color, let's call it that.  In the first picture, these are left and right images, it remains to get the central one. <br><br><h4>  Transfer color from color to black and white </h4><br>  The stages of color transfer are as follows: <br>  1. We superimpose a 15x15 grid on the source color image, in each cell we take a random pixel (this is called <a href="http://www.schorsch.com/en/kbase/glossary/jitter.html">jittered sampling</a> ) <br>  2. Consider a neighborhood of 25x25 pixels, calculate the expectation and variance (working with channel l). <br>  After the first two steps, we receive 225 color samples from the color image, each of which is characterized by the following: two values ‚Äã‚Äãof channels a and b;  mat.  waiting and dispersion. <br>  <i>15x15 and 25x25 were obtained during the experiments.</i> <br>  3. Pixel bypass our black and white image, calculate the variance and mat.  wait, compare with samples, transfer the values ‚Äã‚Äãof color channels a and b from the most appropriate sample. <br><br>  This method came up with Welsh with his friends, you can read more with him [1]. <br><br>  As a result of these simple manipulations, quite colorful pictures are obtained: <br><br><img src="https://habrastorage.org/storage2/999/f06/1b6/999f061b60cc7f7eb35fbcaa073a4142.png"><br><br>  Well, as without a red cat: <br><br><img src="https://habrastorage.org/storage2/9dc/280/2a1/9dc2802a1a3ca58316f86137c0e60870.png"><br><h4>  findings </h4><br>  Well, the advantages here are obvious, we do nothing with our hands, everything happens beautifully, and what‚Äôs the disadvantages?  For images where the main tones are not two or three, but many more, the results can be very inadequate, this is eliminated very simply in words and very difficult in practice: using recognition, for example, using the <a href="http://habrahabr.ru/post/103107/">SURF</a> method and <a href="http://habrahabr.ru/post/118486/">contour analysis</a> to search for a machine instead: <br><br><img src="https://habrastorage.org/storage2/dc7/84b/e41/dc784be41b515a5be67deba93aa56f6e.png"><br><br>  get a much more believable picture: <br><br><img src="https://habrastorage.org/storage2/612/7de/17b/6127de17b79359a63157b5b1d71cfd16.png"><br><br>  but that's another story. <br><br><h4>  PS </h4><br>  I will be extremely grateful for alternative approaches to coloring in the comments, at least at the level of ideas. <br><br>  Used sources: <br>  1 <a href="http://www.cse.iitd.ernet.in/~pkalra/csl783/assignment1/colorize.pdf">Welsh, T., Transferring color to greyscale images</a> <br>  2 <a href="http%253A%252F%252Fwww.researchgate.net%252Fpublication%252F220611081_Fully_automatic_coloring_of_grayscale_images%252Ffile%252Fd912f51002339bae01.pdf%26ei%3DSZ23Ub-_I8nT4QS-i4CwAg%26usg%3DAFQjCNG5cPgJ-yE5xqf0M-uak0eYSnwFPA%26sig2%3DqsHzK6fhEYOnOUmjNJ8tYQ%26bvm%3Dbv.47534661,d.bGE%26cad%3Drjt">Vieira, LFM at al.</a>  <a href="http%253A%252F%252Fwww.researchgate.net%252Fpublication%252F220611081_Fully_automatic_coloring_of_grayscale_images%252Ffile%252Fd912f51002339bae01.pdf%26ei%3DSZ23Ub-_I8nT4QS-i4CwAg%26usg%3DAFQjCNG5cPgJ-yE5xqf0M-uak0eYSnwFPA%26sig2%3DqsHzK6fhEYOnOUmjNJ8tYQ%26bvm%3Dbv.47534661,d.bGE%26cad%3Drjt">Fully automatic coloring of grayscale images</a> </div><p>Source: <a href="https://habr.com/ru/post/183226/">https://habr.com/ru/post/183226/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../183208/index.html">Reservations on Layer2 without STP</a></li>
<li><a href="../183216/index.html">Symbian perseverance</a></li>
<li><a href="../183218/index.html">Sync video or use multiple cameras</a></li>
<li><a href="../183222/index.html">Setup of support of Russian in GVim (windows)</a></li>
<li><a href="../183224/index.html">Against teachers who read on paper</a></li>
<li><a href="../183228/index.html">Terminals - RDP client with connection manager and tabs</a></li>
<li><a href="../183230/index.html">As I wrote LZ4 compression plugin for Reiser4</a></li>
<li><a href="../183232/index.html">Customization captcha in Zend Framework 2</a></li>
<li><a href="../183234/index.html">Edward Snowden claims that the NSA hacked hundreds of cars in China</a></li>
<li><a href="../183236/index.html">New versions of Flask and Werkzeug with Python 3.3 support</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>