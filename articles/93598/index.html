<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NoSQL using MongoDB, NoRM and ASP.NET MVC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, I would like to tell you how to work with NoSQL and the document-oriented database MongoDB, NoRM and ASP.NET MVC 2. 

 NoSQL and docu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NoSQL using MongoDB, NoRM and ASP.NET MVC</h1><div class="post__text post__text-html js-mediator-article"><img src="http://img29.imageshack.us/img29/942/logomongodb.png" align="left"><br><br>  In this article, I would like to tell you how to work with NoSQL and the document-oriented database MongoDB, NoRM and ASP.NET MVC 2. <br><br><h3>  NoSQL and document-oriented database </h3><br>  This year, active movements in the direction of NoSQL are especially noticeable, and people are constantly discussing the use of document-oriented databases with web applications.  According to Wikipedia, ‚ÄúNoSQL is a movement promoting a free class of non-relational data warehouses that has interrupted a long history of relational databases.  Storage data may not require fixed schemas for tables, most often avoid join-operations and usually have horizontal scaling.  Teachers often refer to such databases as structured vaults. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Document-oriented databases are not dependent on schemas, so you can focus on the problem domain and not worry about updating the schema during domain extensions, which allows you to use a real domain-oriented approach during development.  One of the main problem areas in relational databases is the synchronization of the database schema with the domain entities, when the domain itself develops.  At the moment, there are a huge number of implementations of the NoSQL approach, but CouchDB and MongoDB attracted my attention more.  Observing the development of both databases, I found that CouchDB is not able to perform dynamic queries, so I later adopted MongoDB.  For this database there are many drivers for .NET. <br><br><h3>  MongoDB </h3><br>  MongoDB is an open source, scalable, high-performance, schema-free, document-oriented database written in C ++.  Developed since October 2007 by 10gen.  MonoDB stores all your data in binary JSON (BSON) format.  MongoDB attracts more and more attention and, as you can see, it has <a href="http://www.mongodb.org/display/DOCS/Production%2BDeployments">become widespread</a> in real life. <br><br><h3>  NoRM - C # driver for MongoDB </h3><br>  NoRM is a C # driver for MongoDB that supports LINQ.  NoRM project is available on <a href="http://github.com/atheken/NoRM">Github</a> . <br><br><h3>  Demonstration of working with ASP.NET MVC </h3><br>  I will show a simple example using MongoDB, NoRM and ASP.NET MVC.  To work with MongoDB and NoRM, follow these steps: <br><ol><li>  Install MongoDB for <a href="">32bit</a> or <a href="">64bit</a> version.  Archives contain mongodb.exe to start the server and mongo.exe for the client. </li><li>  Download <a href="http://github.com/atheken/NoRM">the NoRM driver</a> for MongoDB </li><li>  Create a directory with the name ‚ÄúC: \ data \ db‚Äù.  This is the standard location of the MongoDB databases. </li><li>  Start the MongoDB server C: \ Mongo \ bin \ mongod.exe. </li></ol><br>  Now, I'm going to demonstrate how to create an ASP.NET MVC application using MongoDB and NoRM. <br><br>  Let's write a domain class. <br><blockquote><code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> Category <br> { <br> [MongoIdentifier] <br> <font color="#0000ff">public</font> ObjectId Id { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> [Required(ErrorMessage = "Name Required")] <br> [StringLength(25, ErrorMessage = "Must be less than 25 characters")] <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ;} <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Description { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> }</font></code> </blockquote> <br>  ObjectId is a NoRM type that represents MongoDB ObjectId.  NoRM will automatically update the Id because it is equipped with the MongoIdentifier attribute.  The next step is to create the MongoSession class.  He will perform any interaction with MongoDB. <br><blockquote> <code><font color="black"><font color="#0000ff">internal</font> <font color="#0000ff">class</font> MongoSession&lt;tentity&gt; : IDisposable <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> MongoQueryProvider provider; <br> <br> <font color="#0000ff">public</font> MongoSession() <br> { <br> <font color="#0000ff">this</font> .provider = <font color="#0000ff">new</font> MongoQueryProvider("Expense"); <br> } <br> <br> <font color="#0000ff">public</font> IQueryable&lt;tentity&gt; Queryable <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> <font color="#0000ff">new</font> MongoQuery&lt;tentity&gt;( <font color="#0000ff">this</font> .provider); } <br> } <br> <br> <font color="#0000ff">public</font> MongoQueryProvider Provider <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> <font color="#0000ff">this</font> .provider; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> Add&lt;t&gt;(T item) <font color="#0000ff">where</font> T : <font color="#0000ff">class</font> , <font color="#0000ff">new</font> () <br> { <br> <font color="#0000ff">this</font> .provider.DB.GetCollection&lt;t&gt;().Insert(item); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> Dispose() <br> { <br> <font color="#0000ff">this</font> .provider.Server.Dispose(); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> Delete&lt;t&gt;(T item) <font color="#0000ff">where</font> T : <font color="#0000ff">class</font> , <font color="#0000ff">new</font> () <br> { <br> <font color="#0000ff">this</font> .provider.DB.GetCollection&lt;t&gt;().Delete(item); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> Drop&lt;t&gt;() <br> { <br> <font color="#0000ff">this</font> .provider.DB.DropCollection( <font color="#0000ff">typeof</font> (T).Name); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> Save&lt;t&gt;(T item) <font color="#0000ff">where</font> T : <font color="#0000ff">class</font> , <font color="#0000ff">new</font> () <br> { <br> <font color="#0000ff">this</font> .provider.DB.GetCollection&lt;t&gt;().Save(item); <br> } <br> }</font></code> </blockquote> <br>  The MongoSession constructor creates an instance of MongoQueryProvider that supports LINQ expressions, and also creates a database called ‚ÄúExpense‚Äù.  If the base with the same name is already present, it will use the existing one.  The Save method can be used for both Insert and Update operations.  If the object is new, a new record will be created, otherwise the document data will be updated with the passed ObjectId. <br><br>  Let's create an ASP.NET MVC controller and action methods to handle the <a href="http://ru.wikipedia.org/wiki/CRUD">CRUD</a> script for the Category domain class. <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> CategoryController : Controller <br> { <br> <br> <font color="#008000">//Index ‚Äì   </font> <br> <font color="#0000ff">public</font> ActionResult Index() <br> { <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> session = <font color="#0000ff">new</font> MongoSession&lt;category&gt;()) <br> { <br> <font color="#0000ff">var</font> categories = session.Queryable.AsEnumerable&lt;category&gt;(); <br> <font color="#0000ff">return</font> View(categories); <br> } <br> } <br> <br> <font color="#008000">//  </font> <br> [HttpGet] <br> <font color="#0000ff">public</font> ActionResult Edit(ObjectId id) <br> { <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> session = <font color="#0000ff">new</font> MongoSession&lt;category&gt;()) <br> { <br> <font color="#0000ff">var</font> category = session.Queryable <br> .Where(c =&gt; c.Id == id) <br> .FirstOrDefault(); <br> <br> <font color="#0000ff">return</font> View("Save",category); <br> } <br> } <br> <br> <font color="#008000">// GET: /Category/Create</font> <br> [HttpGet] <br> <font color="#0000ff">public</font> ActionResult Create() <br> { <br> <font color="#0000ff">var</font> category = <font color="#0000ff">new</font> Category(); <br> <font color="#0000ff">return</font> View("Save", category); <br> } <br> <br> <font color="#008000">//   </font> <br> [HttpPost] <br> <font color="#0000ff">public</font> ActionResult Save(Category category) <br> { <br> <font color="#0000ff">if</font> (!ModelState.IsValid) <br> { <br> <font color="#0000ff">return</font> View("Save", category); <br> } <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> session = <font color="#0000ff">new</font> MongoSession&lt;category&gt;()) <br> { <br> session.Save(category); <br> <font color="#0000ff">return</font> RedirectToAction("Index"); <br> } <br> } <br> <br> <font color="#008000">// </font> <br> [HttpPost] <br> <font color="#0000ff">public</font> ActionResult Delete(ObjectId Id) <br> { <br> <font color="#0000ff">using</font> ( <font color="#0000ff">var</font> session = <font color="#0000ff">new</font> MongoSession&lt;category&gt;()) <br> { <br> <font color="#0000ff">var</font> category = session.Queryable <br> .Where(c =&gt; c.Id == Id) <br> .FirstOrDefault(); <br> session.Delete(category); <br> <font color="#0000ff">var</font> categories = session.Queryable.AsEnumerable&lt;category&gt;(); <br> <font color="#0000ff">return</font> PartialView("CategoryList", categories); <br> } <br> } <br> }</font></code> </blockquote> <br>  As you can see, you can easily work with MongoDB using NoRM in ASP.NET MVC applications.  I created a repository on <a href="http://mongomvc.codeplex.com/">CodePlex</a> , where you can <a href="http://mongomvc.codeplex.com/releases/view/43682">download the source code of</a> this ASP.NET MVC application. </div><p>Source: <a href="https://habr.com/ru/post/93598/">https://habr.com/ru/post/93598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../93592/index.html">Clock Race Over</a></li>
<li><a href="../93594/index.html">3d engine on js + canvas</a></li>
<li><a href="../93595/index.html">How I sold the games ...</a></li>
<li><a href="../93596/index.html">What programming languages ‚Äã‚Äãare most in demand</a></li>
<li><a href="../93597/index.html">Near the Amazon data center a pillar fell: fifth downtime in a week</a></li>
<li><a href="../93599/index.html">HTML5 video</a></li>
<li><a href="../93600/index.html">Simulate height: auto when using animate ()</a></li>
<li><a href="../93603/index.html">Yandex promote illegal content</a></li>
<li><a href="../93605/index.html">Droider Chart. Release 1. The hit parade of applications for Android</a></li>
<li><a href="../93606/index.html">ReSharper PowerToys</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>