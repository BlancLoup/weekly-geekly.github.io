<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installation of userscripts in Opera in general cases and for secure pages (https)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For some userscripts it starts to matter how the user installs it in the Opera browser. If you make the installation without allowing access to some d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installation of userscripts in Opera in general cases and for secure pages (https)</h1><div class="post__text post__text-html js-mediator-article">  For some userscripts it starts to matter how the user installs it in the Opera browser.  If you make the installation without allowing access to some domains, the work will be inadequate, and this can easily happen when installing a cross-domain script, and even using the secure protocol (HTTPS).  For example, for the HabrAjax user <a href="https://greasyfork.org/en/scripts/1970-habrajax">script</a> , besides the main Habr site, access to the Google Plus buttons on <i>plusone.google.com is used</i> and script updates are checked on the domain <i>userscripts.org</i> .  All this requires additional settings, which were described right in the user script (link in the settings " <u>note for Opera</u> "), but made quite briefly and with one illustration.  Here we will look at the question more broadly so that Opera users and developers of user scripts for it have instructions at hand and fully understand the breadth of the question.  At the same time, described the installation site user styles.  For those who know all this, it will be useful to look at the paragraph of conclusions with 2 comments at the very bottom. <br><a name="habracut"></a><br>  The first feature of the work of userscripts in Opera is that special BeforeScript events do not work for them, which work fine for ordinary scripts and provide cross-browser compatibility.  Therefore, if we want to work with another domain in the frame, userscript should provide access to another domain, which means that the main site and the site located in the frame must be specified in the script settings for the sites - strictly in accordance with what is written in meta -directory script for other browsers. <br><br>  The second peculiarity is that if sites work under the https: protocol, they need to set the permission for users to use scripts in this protocol - the general setting of the Opera, which will then often remind you of itself.  If you do not want to do this, there is a way out in the design of user scripts as an addon.  Now - more. <br><br><h3>  How to start a simple one-site user script in Opera? </h3><br>  Users scripts in Opera can run a lot of users.  Just look at the usage statistics of HabrAjax in browsers, which 26 people agreed to give, it is clear that 8 people installed the script on Opera (not excluding other browsers).  By the way, if you used HabrAjax, please vote in this poll: " <a href="http://pollservice.ru/p/dd12f28d55258167c83e">In which browser do you use HabrAjax</a> ?".  It will help to collect more statistics. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For reference, for those who have not yet installed users in the Opera, see the instructions below.  It is not the easiest, but the whole focus of this article is that for protected pages with userscripts it is even more complicated.  Not everyone also knows that there are not one but two ways to install scripts in Opera (not counting add-ons);  in instructions - both are illustrated.  Mobile Opera also has all the possibilities of working with userscripts and user styles, but the settings for resolving functions can be disabled in <i>opera: config</i> and you will need to verify them if something doesn't work (beyond the scope of the article). <br><br>  <b>1.</b> You can install a user script (without addon mechanism, introduced in version 11) in Opera <b>in 2 modes</b> : for all sites at once, with the use of script meta-directives, or for a certain site on the same domain (and there can be many such sites) .  User scripts accepted as the de facto standard in 2 main browsers (Firefox and Chrome) have meta directives - several commented lines, usually located at the beginning of the user script file.  They contain URLs in which scripts operate, so the installation of work rules is determined by directives and requires a single click on the ‚ÄúAllow installation‚Äù button in these browsers.  In the Opera, it was initially not so, but it was better than at the dawn of the introduction of user scripts, when Safari started scripts for all sites at once, and only the actions of the script itself could select the group of URLs in which it continued to work.  Therefore, the first mode (for all sites) is a repetition of a primitive way of running scripts, but with improvements in terms of understanding directives. <br><br>  The second way - to prescribe settings for sites - goes away from the modern way of setting up userscripts through directives.  But they are left in the Opera due to the fact that the sites can be manually set a lot of limitations and features, including individual styles and scripts.  These 2 methods somewhat conflict with each other: using the second one blocks the work of the first method (scripts from the shared folder are not launched, even if they have the necessary directives) for the selected site.  This should be understood when prescribing individual settings, as it is not obvious.  We will show this general information with illustrations. <br><br>  <b>1.a)</b> Open the browser and its <i>General Settings</i> (Ctrl-F12 or from the menu, as shown). <br><img src="https://habrastorage.org/getpro/habr/post_images/c73/223/b3a/c73223b3a49c7d9a5e57e19ce7ba195c.png"><br>  Hereinafter we will show Opera 11.61 in WinXP OS with the theme of the (Shift-F12) <i>Netbook Skin v.11.3</i> - for compactness: <br><img src="https://habrastorage.org/files/b6f/5fb/664/b6f5fb664d0842adb2dcad4ffe0d5227.png"><br><br>  <b>1.b)</b> Open the tab " <i>Tools - General Settings - Advanced - Content - Configure Javascript</i> " - we get into the settings of the 1st mode of user scripts.  If you place the script in the Folder of user files specified in the settings, it will be executed in each browser window.  If you write directives <a href="http://habrahabr.ru/users/include/" class="user_link">include</a> , as usual for scripts, with the indication of sites, it will be filtered by directives in other sites.  Scripts are rarely left without directives.  Not always the script written for a specific site can work correctly everywhere (do nothing on all other sites), and the resources for the initial launch of the script in each window will be spent. <br><img src="https://habrastorage.org/getpro/habr/post_images/b5f/3fb/544/b5f3fb544be81c28d5de48a1224d1a15.png"><br><br>  Features of userscripts: if there is a script with <a href="http://habrahabr.ru/users/include/" class="user_link">include</a> directives in the shared scripts folder and there are more precise settings for sites for the same site (‚ÄúSettings for sites ...‚Äù button), it is not executed.  The script is not required to have the extension * .user.js, * .js is sufficient.  Scripts are executed in alphabetical order of their file names, case insensitive (in Win at least). <br><br>  <b>1.c)</b> Similar to scripts, there are settings for common styles: for all sites, for each window in " <i>Tools - General Settings - Advanced - Content - Customize Styles ...</i> ". <br><img src="https://habrastorage.org/getpro/habr/post_images/a3d/f06/1a7/a3df061a7c334d89ccd3552b9808ad0b.png"><br><br>  They can also have side effects on non-their sites, if we put the style for a specific site in a folder for all sites (the inscription on the screenshot is ‚Äú <i>My Style Sheet</i> ‚Äù).  A similar primitive feature is in IE7-9 and Safari.  Therefore, individual sites settings for scripts and styles are made for sites in Opera. <br><img src="https://habrastorage.org/getpro/habr/post_images/295/b23/d3f/295b23d3f9f04c43b67f62cab96a66f1.png"><br><br>  Individual settings of scripts and styles that are only available to Opera among the major browsers are also an outdated and outdated phenomenon against the background of addons that Opera supports (from the 11th version), because the work on the browser settings for the user is much more than when installing the addon . <br><br>  <b>1.d)</b> Open " <i>Tools - General Settings - Advanced - Content - Settings for Sites ...</i> " to install scripts and styles for some sites.  Since all other settings are set to normal, you need to pay attention to 3 places: the domain name, the path to the styles for the site, the path to the scripts for the site (to the scripts folder). <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/462/e79/981/462e7998142b421d7e2ed4e45d5ffcdd.jpg"></a> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/89b/e7c/0ea/89be7c0ea2e05f06fe01cf488979e602.jpg"></a> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/252/ef2/ee9/252ef2ee94bc26724c8af588f9f574cc.jpg"></a> <br>  So, it turns out that if the site has at least one feature other than scripts, for example, custom styles, then the scripts are forced to write not in the common script folder with the effect of directives, but in Settings for sites.  Then, if more than one site is mentioned in the directives, it is <b>also</b> necessary <b>for them to set up the settings for the sites</b> .  If the script is in the common scripts folder, you can rely on user script directives - they will work. <br><br>  The general description of 2 installation options for user scripts in Opera and their features has been completed.  But there is another feature, after which it will be clear that the difficulties of the browser interfaces are just beginning. <br><br><h3>  The work of userscripts on pages with a secure protocol HTTPS </h3><br>  <b>2.</b> What to do if there are URLs with a secure https protocol among the sites?  Such sites Opera simply does not allow to work with userscripts.  They do not work by default.  Allow users to use scripts on such sites by installing a browser: <br><br>  " <i>opera: config # on% 20https</i> " (write this in the address bar; will show the desired setting in the section "User Prefs") <br>  - <i>User JavaScript on HTTPS - Checked</i> (select checkbox) <br>  - " <i>Save</i> " (click the button below in this section) <br>  - restart the Opera browser. <br><img src="https://habrastorage.org/getpro/habr/post_images/96f/715/b67/96f715b677ee1568ed742e5084fa841b.png"><br><br>  This installation will deliver a lot of unpleasant minutes in the future.  On each site with HTTPS, it will ask the same question (when you first access the site after opening the browser or after changing the script): "And it doesn‚Äôt matter that the user script is not going to look into this domain. You open, say, GMail - the question will be (the first time). After restarting the Opera - again. <br><img src="https://habrastorage.org/getpro/habr/post_images/244/52f/eea/24452feeaca412555560d7419a728874.png"><br><br>  Uninstalling an intrusive parameter cannot be avoided even when running a script from a shared folder - and this permission is required in the settings. <br><br>  The imperfection of the paranoid and illogical issue is unlikely to be corrected in the near future - the company has many more serious bugs that have been hanging for years.  It would be logical to have more flexible settings (UserJS on https in the ‚ÄúSettings for sites‚Äù) and ask for permission only when the browser has a user script for working on this site.  Therefore, in order to achieve perfection, you will have to abandon this method of https resolution and try to create an addon by script. <br><br>  (In order for Opera to not feel lonely among the bugs of userscripts, in the next article we will examine Chrome's bug (2.5 years from the date of its execution) with access to the next frame and its solution.) <br><br><h3>  Creating an addon of the Opera and add-on issues in general </h3><br>  The transition from user scripts to add-ons is a different amount of developer fuss around codes and browser options.  Cross-browser user scripts are a convenient way to design and publish.  The developer does not need a special environment for compiling browser variants.  Therefore, the developer is less dependent on the workplace.  More precisely, independent.  A text editor is enough to correct or add userscript. <br><br>  It is also convenient for the user to work with one file.  At least, Firefox and Chrome require 2 clicks to download and confirm the installation.  In Safari, too, although NinjaKit doesn‚Äôt even support GreaseMonkey‚Äôs functions ‚Äî Firefox‚Äôs user support environments that exist as a de facto standard.  In Opera, if you don‚Äôt make settings for sites ‚Äî there‚Äôs also a bit of a fuss ‚Äî copy the file to the common scripts folder. <br><br>  But, starting with ‚Äúcustomization‚Äù (in a bad sense) across browsers, it gets worse for everyone.  The user needs to know that there are different script hosting sites for different browsers.  He needs to restart the browser in most cases.  One convenience - the same 1-2 clicks for installation, not counting the restart. <br><br>  It is even worse for the developer because the logic of customization goes beyond the limits of one language (JS) and spreads to the build script or to a set of its own manual build and publishing rules in different places.  Therefore, whenever possible, it is necessary to strive for minimal confusion of technologies in customization across browsers.  But since Opera can‚Äôt do a decent job with HTTPS scripts, you‚Äôll have to look into the problems of building addons. <br><br>  There is also a crazy idea - to create cross-browser add-ons that work everywhere with one code, distinguished by the letters of extensions.  This is also very suitable for Safari, for which there is no full support for userscripts (problems, for example, in the implementation of cross-domain exchange).  True, IE7-9 will also need a unique solution that goes back to user scripts, because the user scripts format for IE add-ons is a classic user script with a lot of limitations and, of course, a difference in JS logic. <br><br>  That is the price of the decision to go to the addon instead of user scripts.  If both parties - the developers and the user group - agree to the transition to the addon, in order to avoid problems with HTTPS, go to the instructions for creating the addon in Opera. <br><br>  As a positive factor, we get more flexible and new features in add-ons, which are partially inaccessible in user scripts.  For example, the moment of launching scripts is determined more flexibly, styles are set before the document is created, therefore the picture of the site does not ‚Äújump‚Äù in the first second after loading. <br><br>  At this we allow ourselves to interrupt the allowed speeches, and the creation of the add-on is analyzed next time, in order to complete the theme of the features of creating user scripts for Opera. <br><br><h3>  Practical conclusions </h3><br>  The installation in the Opera of such a multifunctional script as <a href="https://greasyfork.org/en/scripts/1970-habrajax">HabrAjax</a> , supplemented by user styles ( <a href="http://userstyles.org/styles/36690">ZenComment</a> ), containing work with several sites and protected pages (https), comes up against 2 features of the installation.  Depending on the type of installation (in the general directory or in the site specific), if individual site settings are set, you need to remember to set up the same script settings for all sites mentioned in the <a href="http://habrahabr.ru/users/include/" class="user_link">include</a> directives.  Or put the script in a shared directory, but specify it in the individual settings.  Otherwise there will be bewilderment - why do not the auxiliary functions work?  Bug  No, it will not be a bug, but insufficient settings.  And if the script works with protected pages (and it has to work with them, if there is a cross-domain exchange), it is necessary to include the HTTPS permission for userscripts, which further hinders the ‚Äúlive in peace‚Äù on the Opera.  Salvation - in addons, but about it - next time. <br><br>  <i>(The article is from the <a href="http://habrahabr.ru/post/139724/">general pool of articles</a> generated by working with user scripts for Habr.)</i> </div><p>Source: <a href="https://habr.com/ru/post/140643/">https://habr.com/ru/post/140643/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140636/index.html">How to tell your game about an asshole</a></li>
<li><a href="../140638/index.html">DirectX Debugging - Easy.</a></li>
<li><a href="../140639/index.html">Game Way: play with a stranger</a></li>
<li><a href="../140640/index.html">Casket with music lock</a></li>
<li><a href="../140641/index.html">Part number 5. Biochemistry on folding. One fundamental problem</a></li>
<li><a href="../140644/index.html">Using mental maps for teaching with the example of Cisco CCNA Exploration</a></li>
<li><a href="../140645/index.html">Asterisk + FreePBX + 7937G</a></li>
<li><a href="../140647/index.html">XBMC 11 released</a></li>
<li><a href="../140649/index.html">Monitor file system changes</a></li>
<li><a href="../140651/index.html">Old news as the main traffic generator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>