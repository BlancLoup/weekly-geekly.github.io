<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Failsafe data transfer node</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Each broadband operator is thinking about how to release users to the Internet and intelligently limit the speed of the network according to the exist...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Failsafe data transfer node</h1><div class="post__text post__text-html js-mediator-article"> Each broadband operator is thinking about how to release users to the Internet and intelligently limit the speed of the network according to the existing tariff plans and have a reserve in case of equipment failure or work related to equipment disconnection.  I will try to tell and show by example how it is implemented by us (more than 3 thousand users are connected to us and the option I described works very well) <br><a name="habracut"></a><br><br>  For a start, we are given: <br>  1) 1U rack mount server (Intel Xeon E5335, 1GB Ram, Intel PRO / 1000 EB dual port NIC), we use two of these.  For what - I will tell in the text of the article <br>  2) Border router (in my case Juniper j4350, 2 pieces) <br>  3) L3 switch supporting BGP or OSPF <br>  4) And also the task: A) Having all this household to release users to the Internet. <br>  B) to make a reserve, which in the event of an accident will be involved <br>  automatically and without our participation <br><br>  Edge Router (recommendations) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's start with setting up the border router. <br>  It can be any one, even a PC under FreeBSD / Linux with the well-known Quagga package, or it can be hardware from Cisco or Juniper.  How to configure a border router on a PC with a quagga or cisco package there are a lot of articles on the Internet and a lot of detailed documentation (yes, the quag configuration is identical to the cisco configuration).  There is information on the juniper, too, not so much, but there is.  And the topic of the article is not about setting up a border router and BGP protocol on it, but a little about something else. <br><br>  In my case, two Juniper j4350s are used as border routers, the hardware is not very powerful, but it suits the current tasks and budget. <br>  Each of these routers is installed on its own node (nodes in different places) and its uplink is connected to each of them.  On the uplink side of the bgp protocol, we accept full-view and announce our networks to them.  And on the shapers, we give on the internal bgp, in the specially allocated for this vlan-e only the default route (default route) <br>  For a juniper, these are lines in the config file: <br> <code>protocols bgp <br> neighbor 195.xxx.xxx.226 { export [ default-originate reject ]; <br> <br>  policy options <br> policy-statement default-originate { <br> from { <br> route-filter 0.0.0.0/0 exact; <br> } <br> then accept; <br> },        <br> policy-statement reject { <br> then reject; <br> } ,       .</code> <br> <br>  Border routers are configured, each accepts full-view from uplinks and gives away our networks.  Now we configure vlan for internal bgp, inside it we raise communication on the bgp protocol between border routers for an exchange of routes between them.  We select IP addresses with future shapers, but preferably not one, but several, for a pool of external IP addresses used for NAT.  In my case, there are 4 addresses for each shaper, but you can do more or less.  Depending on the size of the network and the number of subscribers. <br><br>  Setting up a server for shaping and NAT on FreeBSD <br><br>  We take the server out of the box, and begin to install FreeBSD on it, better than the latest stable version.  It is advisable to install FreeBSD in the most minimal configuration, not forgetting to mark the ports and the kernel source tree (you can delete it after setup) <br><br>  After we set up FreeBSD, we start setting up a network on it.  In /etc/resolv.conf we set the addresses of the dns servers and set the default route and IP addresses in the /etc/rc.conf file (despite the presence of bgp, the default route will never be superfluous, in case of problems with quag which we will put Further) <br>  ------ / etc / rc.conf ---- <br> <code>defaultrouter="195.xxx.xxx.225" #   <br> gateway_enable="YES" #      <br> hostname="gw2.xxx.ru" #   <br> # em0 ‚Äì     c  bgp <br> ifconfig_em0="up" <br> ifconfig_em0="inet 195.xxx.xx.231 netmask 255.255.255.240" # IP  <br> ifconfig_em0_alias0="inet 195.xxx.xxx.232 netmask 255.255.255.255" # IP. <br> ifconfig_em0_alias1="inet 195.xxx.xxx.233 netmask 255.255.255.255" # <br> ifconfig_em0_alias2="inet 195.xxx.xxx.234 netmask 255.255.255.255" <br> #em1 ‚Äì  ,     vlan    l3  <br> ifconfig_em1="up" <br> ifconfig_em1="inet 195.xxx.xxx.193 netmask 255.255.255.248"</code> <br>  - The network has risen, Yandex has faltered.  Now we are updating the ports tree <br>  The ports tree can be updated using the portsnap utility or csup <br>  In our case, we will update via portsnap.  To do this, write the command: <br>  portsnap fetch, this will load the complete ports tree into the / var / db / portsnap directory <br>  portsnap extract, with this command we will unpack the new ports tree into the / usr / ports directory <br><br>  After upgrading the ports, it makes sense to build your own kernel, although it is not necessary to do this, ipfw, dummynet and pf can be loaded by modules, and the reassembled kernel does not particularly affect performance.  In our case, kernel reassembly is needed because of the HZ option, this is the timer interval.  By default it costs 100, which is not very suitable for high speeds, so we will change it to 2000 <br><br>  Copy the distributive kernel config to another file <br>  cp / usr / src / sys / i386 / conf / GENERIC / usr / src / sys / i386 / conf / router-001 <br>  open the file router-001 with a text editor (vi, nano) and begin to edit it.  After editing the kernel for your needs, you need to remember to add the following parameters to the kernel config: <br><br> <code>#ipfw firewall ,      <br> options IPFIREWALL <br> options IPFIREWALL_VERBOSE <br> options IPFIREWALL_VERBOSE_LIMIT=100 <br> options IPFIREWALL_FORWARD <br> options DUMMYNET <br> options HZ=2000 <br> <br> # pf,     NAT-  IP <br> device pf <br> device pflog <br> device pfsync</code> <br> <br>  Next, using the make buildkernel and make installkernel commands, we build and install the kernel <br><br>  After building the kernel, go to setting up our ipfw firewall <br>  Add the following lines to the /etc/rc.conf file: <br> <code>firewall_enable="YES" <br> pf_enable="YES" <br> pf_rules="/etc/pf.conf" <br></code> <br>  we completely clear the /etc/rc.firewall file and start writing our own rules into it, there is nothing complicated so rc.firewall is the most common shell script that starts when ipfw starts <br><br>  the lines that we add to the new /etc/rc.firewall <br> <code>#!/bin/sh ,      <br> <br> /sbin/ipfw -q flush <br> /sbin/ipfw -q pipe flush ,      dummynet   <br> fwcmd="/sbin/ipfw -q" ,    ipfw     . ‚Äìq    ,      <br> <br> WAN_IP = 195.xxx.xxx.231,   IP    <br> IBGP_NET = 195.xx.xx.224/xx <br> LAN_IP = 10.249.0.0/16 ,      <br> <br> ${fwcmd} add 10 allow ip from any to any via lo0 ,      <br> loopback e <br> <br> ${fwcmd} add 11 allow ip from me to me ,         <br> <br> ${fwcmd} add 12 allow icmp from any to me,  icmp    <br> <br> ${fwcmd} add 20 allow tcp from table(1) to me dst-port 22 ,     <br>   ssh  IP     1.       <br>  ipfw table 1 add &lt;ip_address&gt; <br> <br> ${fwcmd} add 21 deny tcp from any to me dst-port 22 ,   ssh.   <br>   ,     1 <br> <br> ${fwcmd} add 30 pipe tablearg ip from any to table(2) out via em1 <br> ${fwcmd} add 31 pipe tablearg ip from table(3) to any in via em1 ,     2  3          .        ,       (2    , 3 ‚Äì  ).       ipfw table 2 add &lt;ip &gt; &lt; &gt;  ipfw table 2 add &lt;ip &gt; &lt; &gt; <br> <br>      ,       <br>  - ( nginx) <br> ${fwcmd} add 38 fwd 127.0.0.1,3128 tcp $LAN_NET to not me dst-port 80 <br> ${fwcmd} add 39 allow tcp from any $LAN_NET src-port 80 <br> <br> ${fwcmd} add 40 deny all from $LAN_NET to not me <br> ${fwcmd} add 41 deny all from not me to $LAN_NET ,     .           2   3 <br> <br> ${fwcmd} add 50 allow ip from me to any keep-state ,            . <br> <br> ${fwcmd} add 51 allow tcp from $IBGP_NET to $WAN_IP dst-port 179 ,     vlan   BGP      179  (bgp ) <br> <br> ${fwcmd} add 52 allow ospf from 195.xxx.xxx.192/29 to any ,  ospf    <br>     ,    <br>   : <br> #Speed 15Mbps,   <br> ${fwcmd} pipe 1 config mask dst-ip 0xffffffff bw 16000Kbit/s <br> ${fwcmd} pipe 101 config mask src-ip 0xffffffff bw 16000Kbit/s <br> <br> #Speed 20Mbps,   <br> ${fwcmd} pipe 2 config mask dst-ip 0xffffffff bw 21000Kbit/s <br> ${fwcmd} pipe 102 config mask src-ip 0xffffffff bw 21000Kbit/s <br> <br> #Speed 3Mbps,   <br> ${fwcmd} pipe 3 config mask dst-ip 0xffffffff bw 3500Kbit/s <br> ${fwcmd} pipe 103 config mask src-ip 0xffffffff bw 3500Kbit/s <br></code> <br>  In any case, we govern everything for ourselves (do not forget that the packet will first be covered by ipfw, and only then it will go on to pf processing) in accordance with these recommendations, we consider this firewall configured.  In principle, if you do not want to use tablearg, then you can not use it.  There are more options for pipe per customer or a separate table for the tariff.  I do not consider these options, due to the high load on the equipment (pipe per customer) and inconvenience (table for tariff) <br><br>  For completeness, it remains only to configure the NAT, which we will do through pf. <br>  Create the file /etc/pf.conf and enter the following lines into it <br><br>  WAN_IF = "em0", this is our external interface in a vlan with an internal bgp.  It is on it that we will produce NAT <br><br>  LOCAL_NET = "10.249.0.0/16", this is the range of our local network which we will NAT <br><br>  nat on $ WAN_IF from $ LOCAL_NET to!  $ LOCAL_NET -&gt; ($ WAN_IF) is a round-robin sticky-address, and this is the rule for NAT from the internal network to the next interface <br>  the round-robin parameter means using the pool addresses in a circle. <br>  The sticky-address parameter is used to ensure that the same source address is always assigned to the pool address. <br><br>  Now we are setting up the quagga package. <br>  From him we need bgp support and ospf support in my case <br><br>  I will not publish Zebra.conf, everything is simple and of the same type.  We describe interfaces and static routes, here is a clipping from it: <br><br>  i <code>nterface em0 <br> ip address 195.xx.xxx.231/xxx <br> description ibgp <br> ! <br> interface em1 <br> ip address 195.xxx.xxx.193/29 <br> description ospf <br> ! <br> ! Static routes. <br> ! <br> ip route 10.0.0.0/8 Null0 254 <br> ip route 79.142.80.132/30 195.xxx.xxx.238 <br> ip route 94.124.180.57/30 195.xxx.xxx.225</code> <code>nterface em0 <br> ip address 195.xx.xxx.231/xxx <br> description ibgp <br> ! <br> interface em1 <br> ip address 195.xxx.xxx.193/29 <br> description ospf <br> ! <br> ! Static routes. <br> ! <br> ip route 10.0.0.0/8 Null0 254 <br> ip route 79.142.80.132/30 195.xxx.xxx.238 <br> ip route 94.124.180.57/30 195.xxx.xxx.225</code> <br> <br>  We bring bgp config approximately here to such look.  That is, we accept the default route from the border routers and give it any specific routes. <br><br> <code>hostname gw2.xxx.ru <br> password rxxxx <br> enable password rxxxxx <br> log file /var/log/quagga/bgpd.log <br> ! <br> router bgp 3333 <br> bgp router-id 195.xxx.xxx.231 <br> bgp log-neighbor-changes <br> network 195.xxx.xxx.192/29 <br> neighbor 195.xxx.xxx.225 remote-as 3333 <br> neighbor 195.xxx.xxx.225 description j4350-1 <br> neighbor 195.xxx.xxx.225 next-hop-self <br> neighbor 195.xxx.xxx.238 remote-as 3333 <br> neighbor 195.xxx.xxx.238 description j4350-2 <br> neighbor 195.xxx.xxx.238 next-hop-self <br> ! <br></code> <br>  Next, we configure the OSPF protocol (used in my case, since Dlink DGS-3612 is installed in parallel with the Cisco Catalyst 3560) <br><br> <code>Hostname gw2.xxx.ru <br> password xxx <br> enable password xxxx <br> log file /var/log/quagga/ospfd.log <br> ! <br> interface em1 <br> ! <br> router ospf <br> ospf router-id 195.xxx.xxx.193 <br> network 195.xxx.xxx.192/29 area 0.0.0.0 <br> default-information originate metric 100 <br> ! <br> line vty</code> <br> <br>  If you have a switch that can work with BGP, then it is better to stop using OSPF and use BGP for this purpose.  In this case, <br>  bgpd.conf need to make the following lines <br><br> <code>neighbor 195.xxx.xxx.195 remote-as 3333 <br> neighbor 195.xxx.xxx.195 description sw-c3560-xxx.ru <br> neighbor 195.xxx.xxx.195 default-originate</code> <br> <br>  It seems everything is set up, now the main thing is not to forget the small tuning sysctl <br>  Add the following lines to the existing /etc/sysctl.conf <br> <code>net.inet.ip.forwarding=1 #     <br> net.inet.ip.fw.one_pass=1 #   ipfw <br> net.inet.icmp.bmcastecho=0 #       <br> net.inet.tcp.blackhole=2 #     (  ) <br> net.inet.udp.blackhole=1 #      (  ) <br> net.inet.ip.dummynet.io_fast=1 #  dummynet(  ) <br> net.inet.icmp.drop_redirect=1 # icmp  <br> net.inet.icmp.log_redirect=1 # icmp   log,   <br> net.inet.ip.redirect=0 #  0,     ICMP REDIRECT  <br> net.inet.ip.dummynet.expire=0 #        <br> #    <br> net.inet.ip.dummynet.hash_size=16384 #  -,  dummynet  <br> # .      <br> #dummynet   # ,   <br> #    </code> <br> <br>  At this, our shaper is considered complete, I have lowered its integration with the billing system in advance, since each has its own and its own methods <br>  You can safely write the reboot command and if everything was correctly configured then you can proceed to configure the level 3 switch (l3) <br><br>  And if we also want to redirect users who are not allowed to access the Internet on a specific page with information about blocking, then put the web server nginx and write to it in the config (nginx.conf) the following text <br><br> <code><a href="http://blocked.wktnet.ru/index.htm"></a> user nobody; <br> worker_processes 2; <br> events { <br> worker_connections 1024; <br> } <br> http { <br> include mime.types; <br> default_type application/octet-stream; <br> sendfile on; <br> keepalive_timeout 35; <br> server { <br> listen 3128; <br> server_name wkt_router; <br> charset windows-1251; <br> access_log /dev/null; <br> rewrite ^(.*) blocked.wktnet.ru/index.htm permanent; <br> } <br> } <br></code> <br>  Configuring Level 3 Switch <br><br>  My network uses Cisco WS-C3560G-24-TS-S, everything is simple <br>  Go to configuration mode: conf t <br>  We assign an IP address to the vlan interface, within which ospf runs, (the same network as on the shaper on the em1 interface) <br>  And set up ospf <br><br> <code>router ospf 1 <br> router-id 195.xxx.xxx.195 <br> log-adjacency-changes <br> network 10.249.33.0 0.0.0.255 area 0.0.0.0 <br> network 10.249.42.0 0.0.0.255 area 0.0.0.0 <br> network 10.249.51.0 0.0.0.255 area 0.0.0.0 <br> network 10.249.55.0 0.0.0.255 area 0.0.0.0</code> <br> <br>  save the config with the wr command and enjoy the achieved result <br><br>  if instead of the ospf protocol you decide to use bgp, then the following lines should be added to the switch config <br><br> <code>router bgp 3333 <br> bgp log-neighbor-changes <br> network 10.249.33.0 255.255.255.0 <br> redistribute ospf 1 <br> neighbor 195.xxx.xxx.193 remote-as 3333 <br> neighbor 195.xxx.xxx.193 description gw <br> <br></code> <br>  If you use a D-link l3 switch, then configure OSPF with the following commands: <br><br>  enable ospf, enable ospf on the switch <br>  config ospf router_id 195.xxx.xxx.196, specify the router id <br>  config ospf ipif &lt;interface&gt; area 0.0.0.0 state enable, enable ospf on the interface <br><br>  and save the config with the save command <br><br>  Setting up a backup server <br><br>  On the neighboring (backup shaper) we make the same configuration, except for the ospf config and IP addresses <br>  The difference is that the default-information originate we set the metric 200, then it becomes a backup.  Although we can leave the metric 100 and get load balancing between the shapers, but I don‚Äôt use this option in my network because with this setting, customers will get double speed (at the tariff rate on each shaper). <br><br>  Conclusion <br><br>  As a result, we get a system with dynamic routing (in case of failure of one of the shapers or border routers, we automatically begin to use the neighboring one, all the routes of the network specified on the level 3 switches appear automatically in the routing table on our shapers).  If you are frightened by the thought of an idle server, then you can play around with the settings, change ospf to bgp, install another L3 switch and release part of the network through it. <br><br>  Scheme of the resulting node: <br><img src="http://www.4picture.ru/pictures/0f288217f95456f6e5076663bacd1876.jpg" alt="image"><br><br>  For example, give your rc.firewall <br><br> <code>cat /etc/rc.firewall <br> #!/bin/sh <br> #Flush all firewall rules <br> /sbin/ipfw -q flush <br> /sbin/ipfw -q pipe flush <br> #Setting firewall path and options for working with rules <br> fwcmd="/sbin/ipfw -q" <br> #variables <br> IBGP_NET="195.93.xxx.xxx/28" #iBGP network (vlan9) <br> WAN_IP="195.93.xxx.xxx" #Primary WAN ip address <br> LAN_IP="195.93.xxx.xxx" #Primary LAN ip address <br> <br> ###System rules <br> ${fwcmd} add 10 allow ip from any to any via lo0 #do not filter loobpack <br> ${fwcmd} add 11 allow ip from me to me #allow packets from this host to this host <br> ${fwcmd} add 12 allow icmp from any to me #allow ICMP <br> <br> #allow ssh connections <br> ${fwcmd} add 20 allow tcp from table\(6\) to me dst-port 22 #Allow SSH connections (table 6) <br> ${fwcmd} add 29 deny tcp from any to me dst-port 22 <br> <br> #allowing users and add his ip to shaping pipe <br> ${fwcmd} add 30 pipe tablearg ip from any to table\(1\) out via em1 <br> ${fwcmd} add 31 pipe tablearg ip from table\(2\) to any in via em1 <br> <br> #Block spammerss <br> ${fwcmd} add 34 deny ip from table\(3\) to any dst-port 25 #for auto block spammers <br> <br> #allow connections to this networsk <br> ${fwcmd} add 40 allow all from table\(7\) to any <br> ${fwcmd} add 41 allow all from any to table\(7\) <br> <br> #allow active users <br> ${fwcmd} add 45 allow all from not me to table\(1\) <br> ${fwcmd} add 46 allow all from table\(2\) to not me <br> <br> #By default block users <br> ${fwcmd} add 48 fwd 127.0.0.1,3128 tcp from table\(8\) to not me dst-port 80 <br> ${fwcmd} add 49 allow tcp from any to table\(8\) src-port 80 <br> ${fwcmd} add 50 deny all from table\(8\) to not me <br> ${fwcmd} add 51 deny all from not me to table\(8\) <br> <br> ###Access rules <br> #allow outgoing connections <br> ${fwcmd} add 60 allow ip from me to any keep-state #allow all ougoing packets and keep state <br> <br> #Rules allowing SNMP <br> ${fwcmd} add 61 allow udp from table\(6\) to $WAN_IP dst-port 161 #Allow SNMP <br> <br> #Rules allowing bgp <br> ${fwcmd} add 64 allow tcp from $IBGP_NET to $WAN_IP dst-port 179 #Allow BGP from iBGP network (vlan 9) <br> <br> ###############################################  <br> # 6 -         ssh,telnet  snmp <br> ${fwcmd} table 6 add 195.93.xxx.xxx #wkt office <br> ${fwcmd} table 6 add 89.xxx.xxx.1 # <br> ${fwcmd} table 6 add 93.xx.xxx.xxx # <br> <br> # 7 - IP         <br> ${fwcmd} table 7 add 195.xxx.xx.0/25 #binat <br> ${fwcmd} table 7 add 195.xx.xx.0/26 #servers dmz <br> ${fwcmd} table 7 add 195.xx3.xx.192/29 #int net <br> ${fwcmd} table 7 add 195.xx.xxx.xxx #c3560-b51 <br> ${fwcmd} table 7 add 10.88.88.1 <br> # 8 -        <br> ${fwcmd} table 8 add 10.87.0.0/16 <br> ${fwcmd} table 8 add 10.88.0.0/16 <br> ${fwcmd} table 8 add 10.249.0.0/16 <br> ${fwcmd} table 8 add 10.90.0.0/16 <br> ${fwcmd} table 8 add 195.93.xxx.0/25 <br> ${fwcmd} table 8 add 195.93.xxx.128/25 <br> ${fwcmd} table 8 add 195.93.xxx.64/26 <br> ${fwcmd} table 8 add 195.93.xxx.200/28 <br> <br> # 1  2 -      <br> ##WKT tech <br> ${fwcmd} table 1 add 10.87.xx.250/32 55 <br> ${fwcmd} table 2 add 10.87.xx.250/32 255 <br> ${fwcmd} table 1 add 10.87.xx.251/32 55 <br> ${fwcmd} table 2 add 10.87.xx.251/32 255</code> <br> <br>  And bgpd.conf <br><br> <code>hostname gw2.xxxx <br> password rxxxx <br> enable password xxx <br> log file /var/log/quagga/bgpd.log <br> ! <br> router bgp 44xxx <br> bgp router-id 195.93.xxx.xxx <br> bgp log-neighbor-changes <br> network 195.93.2xx.xxx/29 <br> neighbor 195.93.206.xx remote-as 44380 <br> neighbor 195.93.206.xx description j4350-b51 <br> neighbor 195.93.206.xx next-hop-self <br> neighbor 195.93.206.xx remote-as 44380 <br> neighbor 195.93.206.xx description j4350-k18 <br> neighbor 195.93.206.xx next-hop-self <br> neighbor 195.93.206.xx remote-as 65000 <br> neighbor 195.93.206.xxdefault-originate <br> neighbor 195.93.206.xx description sw-c3560g-24ts-b51 <br> neighbor 195.93.206.xx route-map c3560g-b51-in in <br> neighbor 195.93.206.xx remote-as 65001 <br> neighbor 195.93.206.xx default-originate <br> neighbor 195.93.206.xx description sw-c3560g-24ts-k18 <br> neighbor 195.93.206.xx route-map c3560g-k18-in in <br> ! <br> route-map c3560g-k18-in permit 10 <br> set local-preference 200 <br> ! <br> route-map c3560g-b51-in permit 10 <br> set local-preference 300 <br></code> <br><br>  UPD: in order to write kern.hz = ‚Äú2000‚Äù in / boot / loader.conf, it is not necessary to recompile the kernel. </div><p>Source: <a href="https://habr.com/ru/post/82656/">https://habr.com/ru/post/82656/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../82644/index.html">BookBook - an unusual cover for laptops</a></li>
<li><a href="../82648/index.html">Mastery Note</a></li>
<li><a href="../82649/index.html">Use SVG for flexible, extensible and fun backgrounds. Part one</a></li>
<li><a href="../82651/index.html">Perfect solution = PS3 + PS3 Media Server</a></li>
<li><a href="../82655/index.html">The story of one napilinga. Or a desktop for yourself</a></li>
<li><a href="../82658/index.html">GnuPG: Secure Mail for Win, Mac and * nix</a></li>
<li><a href="../82660/index.html">Let's protect Baikal from BPPM waste</a></li>
<li><a href="../82661/index.html">Creating your own usplash theme</a></li>
<li><a href="../82663/index.html">Champions config. Russians set a record in 3DMark Vantage</a></li>
<li><a href="../82665/index.html">A small demo client vkontakte on QML</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>