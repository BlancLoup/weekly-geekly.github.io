<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ERPXE like a magic pill</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings 

 On Habr√© articles about PXE sometimes flash. This is quite a handy thing for quick deployment of a large number of machines. Recently, sp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ERPXE like a magic pill</h1><div class="post__text post__text-html js-mediator-article">  Greetings <br><br>  On Habr√© articles about PXE sometimes flash.  This is quite a handy thing for quick deployment of a large number of machines.  Recently, specialized packages like Cobbler or OpenQRM have appeared for managing a fleet of servers, but this is not about them.  It will be a question of the ERPXE project, designed to ensure the operability of a network of computers.  As the creators write about their project - you can apply to any size company.  First of all, it allows you to manage the contents of the root tftp.  It does this through a system of plug-ins, the number of which is impressive; the list is <a href="http://erpxe.org/Category:Plugins">http://erpxe.org/Category:Plugins</a> .  There is almost everything you need and even more.  Well, what is not - it is easy to add. <br><a name="habracut"></a><br>  Dealing with ERPXE is easy, well documented.  I will try to describe the installation process on FreeBSD, there are no instructions on the site.  The project recommends unpacking all archives at the root, but for FreeBSD this is not entirely consistent with ideology.  We will unpack in / usr / local and edit everything you need.  Given that NFS exports the file system, it is better to make a separate tftpboot. <br><br>  If the server has a ZFS root file system, then we create file systems for our needs and configure it further in the manual.  If UFS, then you have to export / usr to write 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">zfs create -o compression=lz4 -o <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>=off -o setuid=off -o mountpoint=/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/tftpboot zroot/tftpboot zfs create -o compression=lz4 -o <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>=off -o setuid=off -o mountpoint=/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/images zroot/images zfs create -o compression=lz4 -o <span class="hljs-built_in"><span class="hljs-built_in">exec</span></span>=off -o setuid=off -o mountpoint=/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/images/dev zroot/images/dev</code> </pre> <br><br>  Then we take the main archive <br><br>  <a href="http://www.erpxe.com/download/">http://www.erpxe.com/download/</a> <br><br>  Unpack it: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span> tar -xzf erpxe.current.tar.gz</code> </pre><br><br>  Further we configure services for work with PXE, as usual, DHCP &amp; TFTP and for ERPXE it is necessary to configure NFS, HTTP and Samba.  I assume that these services are configured and working, you only need to make changes for ERPXE.  Configuring services makes the script tftpboot / bin / configure.sh.  But since we do not have an supported operating system, we‚Äôll review its content and make changes with our hands. <br><br>  DHCP &amp; TFTP: <br>  For dnsmasq you need the following lines in the config. <br><br><pre> <code class="bash hljs">dhcp-boot=pxelinux.0 tftp-root=/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/tftpboot/</code> </pre><br><br>  Restart dnsmasq: service dnsmasq restart <br><br>  NFS: <br>  We get acquainted with tftpboot / bin / setup / erpxe-exports.  We created the images directory earlier with all file systems, create an auxiliary user (adduser erpxe) and assign permissions (chown erpxe / usr / local / images / dev), add lines to / etc / export: <br><br><pre> <code class="bash hljs">/usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/images -mapall=nobody -ro -network=192.168.1.0/24 /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/images/dev -mapall=erpxe -network=192.168.1.0/24 /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/tftpboot/er/shares -alldirs -mapall=nobody -ro -network=192.168.1.0/24</code> </pre><br><br>  Update the folder list: service mountd reload <br><br>  Http: <br>  For Apache, copy the tftpboot / bin / setup / erpxe-httpd.conf file to /usr/local/etc/apache24/sites/erpxe.conf and replace the paths with those that exist. <br><br><pre> <code class="bash hljs">&lt;Directory <span class="hljs-string"><span class="hljs-string">"/usr/local/tftpboot/er/shares/"</span></span>&gt; Options Indexes FollowSymLinks Order deny,allow Allow from 192.168.1.0/24 Deny from all &lt;/Directory&gt; AliasMatch (?i)^/er(.*) /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/tftpboot/er/shares<span class="hljs-variable"><span class="hljs-variable">$1</span></span></code> </pre><br><br>  Restart service apache24 restart. <br><br>  Samba: <br>  Adding the erpxe ball to the example in the tftpboot / bin / setup / erpxe-smb.conf file <br><br><pre> <code class="bash hljs">[erpxe] path = /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/tftpboot/er/shares/ comment = Guest access share browseable = yes <span class="hljs-built_in"><span class="hljs-built_in">read</span></span> only = yes guest ok = yes</code> </pre><br><br>  Update state: service samba restart <br><br>  You can try to boot. <br><br>  The clean installation already contains Memtest, Hardware Detection Tool, NT Password Editor, etc. But, of course, all the charm of ERPXE in plug-ins, for each of which is described on the wiki installation process.  Usually this is unpacking the plugin and copying files from the image to the tftpboot tree.  I will not duplicate information from the wiki here, the only thing worth paying attention to is that some plugins require changing the IP in the menu file. <br><br>  After installing the plugins, you can diagnose hardware (Stresslinux, Inquisitor), back up (Clonezilla, Acronis True Image Home) and, of course, install your favorite distros (CentOS, Ubuntu) over the network. </div><p>Source: <a href="https://habr.com/ru/post/232095/">https://habr.com/ru/post/232095/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../232085/index.html">Experience using smart glasses Epson Moverio BT-200</a></li>
<li><a href="../232087/index.html">Automating the mounting of samba partitions on Mac OS</a></li>
<li><a href="../232089/index.html">Simple MVC model implementation with template hierarchy support</a></li>
<li><a href="../232091/index.html">Intel Pro 2500 - new SSD series with hardware encryption</a></li>
<li><a href="../232093/index.html">NASA confirms the performance of the "impossible" wave engine that does not use reactive mass - EmDrive</a></li>
<li><a href="../232097/index.html">Writing a simple interpreter in C ++ using TDD, part 3</a></li>
<li><a href="../232099/index.html">Clean and dirty test environments</a></li>
<li><a href="../232103/index.html">Node.js + HTML5 + js = online action game. Play on Node.js</a></li>
<li><a href="../232107/index.html">Motivation in a person‚Äôs life, or my little experience (introduction)</a></li>
<li><a href="../232109/index.html">The Rosetta interplanetary station measured the surface temperature of the comet Churyumov-Gerasimenko</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>