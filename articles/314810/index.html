<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analyzing the performance of the server Oracle SPARC T7-2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the most important news for Oracle in 2015 was the release of the new SPARC M7 processor and a line of servers based on it. This line includes ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analyzing the performance of the server Oracle SPARC T7-2</h1><div class="post__text post__text-html js-mediator-article">  One of the most important news for Oracle in 2015 was the release of the new SPARC M7 processor and a line of servers based on it.  This line includes T-series servers (T7-1, T7-2, T7-4) and M-series servers (M7-8, M7-16). <br><br>  In addition to the unique physical characteristics (frequency 4.13 GHz, 32 cores, up to 256 threads), the M7 processor is able to transfer part of the Oracle database SQL-logic to special DAX (Data Analytics Accelerator) coprocessors.  This technology was named ‚ÄúSQL in Silicon‚Äù - with it, the new M7 processor is positioned as the first processor in IT history, including the Oracle Database optimized for tasks. <br><br>  At the beginning of 2016, testing of T-series servers became possible, and we were one of the first in Russia to simultaneously test two T7-2 test servers at once (two M7 processors in each). <br><a name="habracut"></a><br>  Testing was organized in several stages: <br><ol><li>  analyzing the performance of the new SPARC server using synthetic benchmarks using the Oracle Database, </li><li>  A study of the virtualization capabilities of the T7-2 server (see <a href="https://habrahabr.ru/company/jetinfosystems/blog/311016/">Virtualization on Oracle SPARC T7-2</a> - our test results) </li><li>  study of technology "SQL in Silicon". </li></ol><br>  The purpose of this post is to share with the community the results obtained in the first and third stages. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There is a wide range of synthetic benchmarks on the market using Oracle Database.  Moreover, no matter how paradoxical it sounds, the choice of synthetics can largely determine the result.  As in the case of testing the previous generation SPARC (servers of the T5 line), we set out to find out what kind of maximum performance you can squeeze out of the server - to determine the moment when it ‚Äúboils‚Äù under the load of the Oracle Database. <br><br>  For this kind of research, classical SwingBench GUI synthetics are not suitable - the test software must have open source in order to be able to minimize the impact on the test results of the I / O system and the internal database mechanisms (in this case, the Oracle Database).  In the course of solving this task, we selected and significantly improved the open source software SLOB (Silly Little Oracle Benchmark, by Kevin Closson).  In the course of the study, we fixed the maximum values ‚Äã‚Äãof the Logical Reads Per Second (logical reading or reading from memory) of the Oracle instance with a fully heated cache and parallel sessions of the SLOB with almost no competition for the instance resources.  The intensity of logical reads from memory is an important characteristic of the new processor, and the reading of data from memory itself is an integral part of the operation of the Oracle Database. <br><br>  <b>Fig.</b>  <b>1. Results in domains of 32 cores (T5 vs T7)</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/994/95d/1f2/99495d1f259f46839ca68bddcae47a87.jpg"></div><br>  The figure shows the comparative results obtained on the T5-4 servers (previous generation of SPARC processors) and T7-2 (new SPARC M7 processors).  The results are recorded in the same processor power domains (32 cores) with the same versions of the Oracle Database and instance settings.  On the X axis, the number of parallel sessions of the finalized SLOB is postponed, on the Y axis, the maximum number of logical reads per second according to AWR statistics. <br><br>  It can be seen from the graph that saturation (when the server ‚Äúboils‚Äù) occurs when the number of SLOB sessions is compared with the number of domain flows (32 cores with eight threads each - 256).  It can also be seen that, with the same number of cores, the T7 server domain was 1.15‚Äì1.2 times more productive than the T5 server domain.  This means that the new M7 processor (in which twice the number of cores) is 2.3‚Äì2.4 times more productive than previous generation processors from Oracle.  Note that this result is fixed on the T7 server both in the control (control) and in the guest (guest) domain.  At the same time, a large number of sessions (192 and more) in the guest domain of the T7 server is noticeably influenced by virtualization: performance is 3-5% lower than in the control domain under the same conditions. <br><br>  The maximum value of the Logical Reads Per Second indicator under the load of SLOB was fixed at 512 threads - when all 64 cores were given to the control domain.  This value was 93‚Äì95 million logical reads per second - for the entire time of testing servers of various architectures under the load of the Oracle Database, we received such figures for the first time! <br><br>  <b>Fig.</b>  <b>2. Comparative results in the domains of 16 cores (T5 / T7 / P8 / x86)</b> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/bb5/ba9/cc4/bb5ba9cc46ce4a9e91e8212c7edbb72e.jpg"></div><br>  In parallel with testing the T7-2 server using the same methodology, actual servers of the IBM Power and x86 architecture were tested.  The figure shows the comparative results of the SLOB tests obtained in domains with the same number of cores (16).  Notice that the x86 server has 2 threads per core each, and Power and SPARC have 8 threads each.  On a large number of SLOB sessions, the result of the T7-2 server (about 24 million logical reads per second) turned out to be the best - despite the fact that on small numbers of sessions, the x86 architecture performed most efficiently. <br><br>  The results of the synthetic tests SLOB allow us to conclude that even without the special features of SQL in Silicon, the T7-2 server shows very high performance on Oracle Database tasks and can be recommended at least as an Oracle Database consolidation platform.  These are the brief results of the first stage of our research on the M7 processor. <br><br>  As for DAX (or ‚ÄúSQL in Silicon‚Äù), it can be explored in various ways.  First, the DAX API is open and can be directly used in the application.  This approach is described in our article <a href="https://habrahabr.ru/company/jetinfosystems/blog/307862/">Hardware Acceleration of Corporate Computing</a> ‚Äî using DAX, we managed to speed up operations with mathematical sets by a factor of 5-6. <br><br>  Secondly, it is possible to test how the technology ‚ÄúSQL in Silicon‚Äù speeds up queries to the database.  Today, this is only possible in Oracle Database 12c and only when using the In-Memory option.  Therefore, it will be correct to recall what this option is. <br>  Most databases use string data storage (Row Database) both on disks and in memory.  At the same time, there are and are actively developing on the market Database that implement column storage (Columnar Database).  It is generally accepted that the Row Database is optimal for transactional systems of the OLTP class, and in DWH class storages certain analytical queries can work much faster with the Columnar Database. <br><br>  Appeared in Oracle Database 12c, the Database In-Memory option implements column data storage in memory in addition to the traditional string.  Such storage is possible due to an additional memory area (In-Memory Cache), in which the Oracle Database administrator can cache data of entire tables, as well as individual columns or partitions in column format.  Such additional column data storage in memory is transparent to the application, while the Oracle Optimizer has the opportunity to select the necessary data from the memory both in the string and in the column view.  We can say that using In-Memory in Oracle, a unique combination of inline and column data storage is implemented. <br><br>  We have repeatedly introduced the community to the results obtained in our testing of In-Memory work, in particular, we have developed a methodology that emulates the operation of DWH class systems.  Randomly generated data on Europeans and their salaries were added to the Oracle database table (persons table, about 20 million records), all European countries were added to a separate reference table (countries table): <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> persons ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">38</span></span>), country_id <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">38</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">50</span></span>), salary <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">36</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> countries ( <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">38</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> varchar2(<span class="hljs-number"><span class="hljs-number">20</span></span>) );</code> </pre> <br><br>  The role of the analytical query was played by the SQL calculation of the sum of all the salaries of the residents of countries starting with R (these are Russia and Romania): <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(salary) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> persons <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> country_id <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">id</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> countries <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> <span class="hljs-string"><span class="hljs-string">'R%'</span></span>);</code> </pre> <br>  When working with In-Memory in the In-Memory cache, two columns of the persons table ‚Äî country_id and salary: ‚Äúrose‚Äù; <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">alter</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> persons <span class="hljs-keyword"><span class="hljs-keyword">inmemory</span></span> <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> <span class="hljs-keyword"><span class="hljs-keyword">inmemory</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">id</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">inmemory</span></span> <span class="hljs-keyword"><span class="hljs-keyword">memcompress</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">query</span></span> <span class="hljs-keyword"><span class="hljs-keyword">high</span></span> (country_id, salary);</code> </pre> <br>  When using the traditional buffer cache (after warming up), this request was processed on the T7-2 server in 1.9 seconds (note that the In-Memory mechanism was turned off by the hint).  When using the In-Memory cache on the same server, it takes 0.39 seconds or 4.8 times faster.  DAst monitoring of the busstat utility showed that during the execution of the request the counters were not zero - i.e.  DAX worked: <br><br> <code>5 dax0 DAX_SCH_query_cmd_sched 80 DAX_QRYO_input_valid 694586 DAX_QRYO_output_valid 1530256 <br> 5 dax1 DAX_SCH_query_cmd_sched 80 DAX_QRYO_input_valid 754450 DAX_QRYO_output_valid 2017088 <br> 5 dax2 DAX_SCH_query_cmd_sched 79 DAX_QRYO_input_valid 522635 DAX_QRYO_output_valid 758496 <br> 5 dax3 DAX_SCH_query_cmd_sched 79 DAX_QRYO_input_valid 672683 DAX_QRYO_output_valid 1529568 <br> 5 dax4 DAX_SCH_query_cmd_sched 79 DAX_QRYO_input_valid 589392 DAX_QRYO_output_valid 1073248 <br> 5 dax5 DAX_SCH_query_cmd_sched 79 DAX_QRYO_input_valid 635264 DAX_QRYO_output_valid 1502832 <br> 5 dax6 DAX_SCH_query_cmd_sched 79 DAX_QRYO_input_valid 615433 DAX_QRYO_output_valid 1080257 <br> 5 dax7 DAX_SCH_query_cmd_sched 80 DAX_QRYO_input_valid 810452 DAX_QRYO_output_valid 2295872 <br></code> <br>  Thus, this analytical query was partially performed on DAX coprocessors and we recorded almost 5-fold acceleration of its work due to the integrated In-Memory + DAX technology as compared to the work of Oracle Database using the traditional buffer cache.  Note that we did not specifically select the query or the size of the persons table ‚Äî we implemented a technique on T7-2 that we used to study the operation of the In-Memory option earlier.  In this case, the fivefold acceleration is more than a decent result, especially since it fits well with the conclusions that we made earlier when testing DAX via the API (see <a href="https://habrahabr.ru/company/jetinfosystems/blog/307862/">Hardware acceleration of corporate computing</a> ). <br><br>  Upd.  Colleagues, when placing messed up images, the error is eliminated. </div><p>Source: <a href="https://habr.com/ru/post/314810/">https://habr.com/ru/post/314810/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../314798/index.html">Automated testing survey results: 411 responses in 2016</a></li>
<li><a href="../314800/index.html">Russian hacker taught IT university students how to hack network</a></li>
<li><a href="../314802/index.html">About layout, logic, eccentrics and MTS portals</a></li>
<li><a href="../314804/index.html">50 shades of Go: traps, pitfalls and common mistakes beginners</a></li>
<li><a href="../314806/index.html">The history of the startup and our pivot</a></li>
<li><a href="../314814/index.html">Working with different units of measurement of the same type and converting them</a></li>
<li><a href="../314816/index.html">Microsoft fixed a serious vulnerability in Windows</a></li>
<li><a href="../314818/index.html">Search optimization when choosing a campaign</a></li>
<li><a href="../314820/index.html">Tricks for taking complex integrals</a></li>
<li><a href="../314822/index.html">Manage identity verification with Windows Hello for Business</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>