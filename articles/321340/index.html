<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Introduction to the design of entities, the problem of creating objects</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When modeling such a concept of a subject-oriented design as an entity, some difficulties may arise due to business requirements or the technical part...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Introduction to the design of entities, the problem of creating objects</h1><div class="post__text post__text-html js-mediator-article">  When modeling such a concept of a subject-oriented design as an entity, some difficulties may arise due to business requirements or the technical part.  In particular, sometimes there is a difficulty with the creation of an entity object. <br><br>  This article describes two such problems, and discusses how to solve them.  The same article is suitable as an introduction to the design of entities.  To understand the material will need a basic understanding of the subject-oriented design. <br><a name="habracut"></a><br>  So, we studied the subject area, formed a single language, identified limited contexts and decided on the requirements [2].  All this is beyond the scope of this article, here we will try to solve specific narrow problems: <br><br><ol><li>  Creating and maintaining the consistency of complex entity objects. </li><li>  Creation of entity objects with the generation of the identifier on the auto-increment field of the database. </li></ol><br><h2>  Introduction </h2><br>  We have a client that must be modeled as an entity (Entity) [2].  From the point of view of business, each client must have: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  name or title; </li><li>  organizational form (individual entity, individual entrepreneur, limited liability company, joint-stock company, etc.); </li><li>  general manager (one of the managers assigned to the client); </li><li>  information about the actual address; </li><li>  legal address information. </li></ul><br>  And there can also be all sorts of additional information. <br><br>  In the simple case, the class that implements the entity being modeled may look like this. <br><br><pre><code class="php">namespace Domain;

final class Client
{
    public function getId(): int;

    public function setId($id): void;

    public function setCorporateForm($corporateForm): void;

    public function setName($name): void;

    public function setGeneralManager(Manager $manager): void;

    public function setCountry($country): void;

    public function setCity($city): void;

    public function setStreet($street): void;

    public function setSubway($subway): void;
}
</code></pre><br>
    ,   ,      .<br>
<br>
  ,           -.   ,   ,         -,      .<br>
<br>
<pre><code class="php">$client = new Client();
//            
//      ,   , ..    
$client-&gt;getId();
//     ()   ,      
$repository-&gt;save($client);
</code></pre><br>
<h2>     -.</h2><br>
     .      ,         [4].  ,    ,                .      .<br>
<br>
<pre><code class="php">namespace Domain;

final class Client
{
    public function __construct(
        $id,
        $corporateForm,
        $name,
        $generalManager,
        $country,
        $city,
        $street,
        $subway = null
    );

    public function getId(): int;
}
</code></pre><br>
  ,     . 8   ,    . ,         , , ,    ,    .<br>
<br>
    ?     ‚Äî      - (Value Object) [3].<br>
<br>
<pre><code class="php">namespace Domain;

final class Address
{  
    public function __construct($country, $city, $street, $subway = null);
}
</code></pre><br>
<pre><code class="php">namespace Domain;

final class Client
{
    public function __construct(
        int $id,
        string $name,
        Enum $corporateForm,
        Manager $generalManager,
        Address $address
    );

    public function getId(): int;
}
</code></pre><br>
  ,      ,    ,     .  ‚Äî   (Builder) [5].<br>
<br>
<pre><code class="php">namespace Application;

interface ClientBuilder
{
    public function buildClient(): Client;

    public function setId($id): ClientBuilder;

    public function setCorporateForm($corporateForm): ClientBuilder;

    public function setName($name): ClientBuilder;

    public function setGeneralManager(Manager $generalManager): ClientBuilder;

    public function setAddress(Address $address): ClientBuilder;
}
</code></pre><br>
<pre><code class="php">$client = $builder-&gt;setId($id)
    -&gt;setName($name)
    -&gt;setGeneralManagerId($generalManager)
    -&gt;setCorporateForm($corporateForm)
    -&gt;setAddress($address)
    -&gt;buildClient();
</code></pre><br>
 ,                ,         .<br>
<br>
<h2> -        .</h2><br>
       , ..      .       ,           ,   .               ,     .               [1].<br>
<br>
    ,    ,     - ,    .<br>
<br>
C, , UUID            .          ,           .<br>
<br>
             ,         .<br>
<br>
       ,      .<br>
<br>
<pre><code class="php">namespace Infrastructure;

final class MySqlClientBuilder implements ClientBuilder
{
    private $connection;

    public function __construct(Connection $connection);

    public function buildClient()
    {
        $this-&gt;connection
            -&gt;insert('clients_table', [
                $this-&gt;name,
                $this-&gt;corporateForm,
                $this-&gt;generalManager-&gt;getId(),
                $this-&gt;address
            ]);
        
        $id = $this-&gt;connection-&gt;lastInsertId();
        
        return new Client(
            $id,
            $this-&gt;name,
            $this-&gt;corporateForm,
            $this-&gt;generalManager,
            $this-&gt;address
        );
    }
}
</code></pre><br>
         ,        .                        .<br>
<br>
<pre><code class="php">$builder = $container-&gt;get(ClientBuilder::class);

$client = $builder-&gt;setId($id)
    -&gt;setName($name)
    -&gt;setGeneralManagerId($generalManager)
    -&gt;setCorporateForm($corporateForm)
    -&gt;setAddress($address)
    -&gt;buildClient();

$repository-&gt;save($client);

$client-&gt;getId();
</code></pre><br>
  !<br>
<br>
<h4>P.S.:</h4><br>
<i>    , ¬´  ,  ¬ª.         ,       ,     ,    .<br>
<br>
       ‚Äî  , DDD      .<br>
<br>
      .</i><br>
<br>
<h4>:</h4><br>
<ol>
<li> ., ¬´-  (DDD).    .¬ª </li>
<li> ., ¬´  - .¬ª</li>
<li>. , <a href="https://martinfowler.com/bliki/ValueObject.html">Value Object</a></li>
<li>. , <a href="https://www.martinfowler.com/bliki/ConstructorInitialization.html">Constructor Initialization</a></li>
<li>. , . , . , . , ¬´ - .  .¬ª</li>
</ol></div><p>Source: <a href="https://habr.com/ru/post/321340/">https://habr.com/ru/post/321340/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321328/index.html">What we understood about creatives in native advertising when we launched 50,000 campaigns</a></li>
<li><a href="../321330/index.html">How support helps Dadate to get new customers and stand out against the competition</a></li>
<li><a href="../321332/index.html">What is the difference between a designer in a grocery company and a designer in an agency or studio?</a></li>
<li><a href="../321334/index.html">Crossover holds the Hiring challenge competition and hires hundreds of Java and Ruby on Rails developers.</a></li>
<li><a href="../321338/index.html">Cryptography and secure communication: the history of the first ciphers</a></li>
<li><a href="../321344/index.html">Inversion of injection control</a></li>
<li><a href="../321346/index.html">Switching from CruiseControl.NET to Jenkins in the PVS-Studio development team</a></li>
<li><a href="../321348/index.html">We recycle. So what?</a></li>
<li><a href="../321350/index.html">Kaggle and Linux. Digit Recognizer for analysts (for beginning analysts)</a></li>
<li><a href="../321352/index.html">Search for large documents in ElasticSearch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>