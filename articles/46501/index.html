<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Silverlight 2. Integration with HTML and JavaScript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the beginning I would like to share interesting news. We, with the support of creative designers from Samara Turbomilk, launched the alpha version ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Silverlight 2. Integration with HTML and JavaScript</h1><div class="post__text post__text-html js-mediator-article"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/0d1/a8c/d43/0d1a8cd431c1c2967869ca6727a5091a.png" alt="Silverlighter"></a> <br>  In the beginning I would like to share interesting news.  We, with the support of creative designers from Samara <a href="http://www.turbomilk.ru/">Turbomilk,</a> launched the alpha version of the Silverlight User Community - the site <a href="http://silverlighter.ru/">Silverlayter</a> . <br><br>  By the way, SilverLighter is not only a member of the community, but this remarkable creature with a gas glow in the picture :) <br><br>  Well, now, actually, let's move on to the article itself. <br>  Hello dear readers.  My name is Sergey Pugachev.  I have been a Silverlight developer for quite a long time and have been actively promoting this technology, so I am often asked about how to implement this or that feature or functionality.  This article is a kind of answer to these frequently asked questions.  This is the first part, it is devoted to issues of integration with HTML and JavaScript. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  But let's start with a small marketing introduction. <br><br>  Recently, Microsoft Silverlight technology is on everyone's lips.  Various possibilities of the second version (Silverlight 2), published on October 14, 2008, are vividly discussed at forums and blogs.  Many have already started writing Silverlight applications, and someone is going to start developing solutions using Silverlight technology in the very near future.  The range of possible applications of this technology is huge.  Here and online TV broadcasting, entertainment and educational portals.  In my opinion, in the near future, full-fledged corporate (Line of Business, Enterprise, CRM and ERP) Silverlight applications will appear and actively develop.  And the overwhelming majority of .NET developers with whom I spoke, like Silverlight technology.  And it inspires some optimism!  As they say, try and you. <br><br>  If you are not familiar with Silverlight technology yet, I recommend that you first read the water articles and see the screencasts that you can find at <a href="http://www.silverlighter.ru/">http://www.silverlighter.ru</a> and <a href="http://techdays.ru/">http://techdays.ru/</a> .  And then move on to reading this article. <br><br>  Well, dear readers, have you not thought to this place that ENOUGH this MARKETING already!  Yes, indeed, for us, for developers, the main program, and not marketing statements.  I promise that at this place all marketing ends and that which you and I love, namely CODE, begins. <br><br><br>  So, here are some topics I would like to highlight in the first part of the article: <br><ul><li>  <a href="https://habr.com/ru/post/46501/">Read initialization parameters</a> </li><li>  <a href="https://habr.com/ru/post/46501/">Access to HTML DOM (Document Object Model)</a> </li><li>  <a href="https://habr.com/ru/post/46501/">Calling JavaScript functions from Silverlight</a> </li><li>  <a href="https://habr.com/ru/post/46501/">Calling Silverlight functions from JavaScript</a> </li></ul><br><habracut><br><h3>  Creating a Silverlight project application </h3><br>  Let's create a new Silverlight application in Visual Studio 2008 SP1 with Silverlight Tools for Visual Studio installed.  To do this, select File-&gt; New-&gt; Project-&gt; Silverlight-&gt; Silverlight Application.  Name the application MySilverlightApplication and press the OK button.  In the Add Silverlight Application dialog, we will keep the default values.  Click OK and see two new projects in Visual Studio.  Actually Silverlight application and ASP.NET application for hosting Silverlight application.  Well, that you probably already know. <br><br><h3>  Read initialization parameters </h3><br>  Now we will do the following.  We will set the initialization parameters for the Silverlight plugin on the pages MySilverlightApplicationTestPage.html and MySilverlightApplicationTestPage.aspx.  After reading the Silverlight initialization parameters, the application will choose which XAML page to make as the starting page and accordingly show it to the user when loading: the default Page.xaml or the NextPage.xaml that we create. <br><br>  To do this, add a new page to the Silverlight application.  Right click on the project name, select Add-&gt; New Item-&gt; Silverlight User Control.  Let's call the control NextPage.xaml.  And press the OK button. <br><br>  Next, we will change the background color of the NextPage page to red in order to determine the loaded page at runtime, because the background of the Page.xaml page will remain white.  Set the Background property of the Grid element (named LayoutRoot) to the value ‚ÄúRed‚Äù. <br><br>  Now open the MySilverlightApplicationTestPage.html page in the ASP.NET project and take a look at the Silverlight implementation code for the application: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">object</font> <font color="#ff0000">data</font> <font color="#0000ff">="data:application/x-silverlight-2,"</font> <br> <font color="#ff0000">type</font> <font color="#0000ff">="application/x-silverlight-2"</font> <br> <font color="#ff0000">width</font> <font color="#0000ff">="100%"</font> <font color="#ff0000">height</font> <font color="#0000ff">="100%"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="source"</font> <font color="#ff0000">value</font> <font color="#0000ff">="ClientBin/MySilverlightApplication.xap"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="onerror"</font> <font color="#ff0000">value</font> <font color="#0000ff">="onSilverlightError"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="background"</font> <font color="#ff0000">value</font> <font color="#0000ff">="white"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="minRuntimeVersion"</font> <font color="#ff0000">value</font> <font color="#0000ff">="2.0.31005.0"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="autoUpgrade"</font> <font color="#ff0000">value</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> <font color="#0000ff">="http://go.microsoft.com/fwlink/?LinkID=124807"</font> <br> <font color="#ff0000">style</font> <font color="#0000ff">="text-decoration: none;"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">img</font> <font color="#ff0000">src</font> <font color="#0000ff">="http://go.microsoft.com/fwlink/?LinkId=108181"</font> <br> <font color="#ff0000">alt</font> <font color="#0000ff">="Get Microsoft Silverlight"</font> <font color="#ff0000">style</font> <font color="#0000ff">="border-style: none"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">object</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Let's add the following tag inside the object tag: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="initParams"</font> <font color="#ff0000">value</font> <font color="#0000ff">="startPage=Page"</font> <font color="#0000ff">/&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  This code sets the initialization parameter with the name ‚ÄústartPage‚Äù, the value of which is equal to ‚ÄúPage‚Äù.  In this case, the parameter is one, but we can write several parameters separated by a comma. <br><br>  Now open the ASP.NET page MySilverlightApplicationTestPage.aspx.  The implementation code for the Silverlight application is different and looks like this: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">asp:Silverlight</font> <font color="#ff0000">ID</font> <font color="#0000ff">="Xaml1"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <br> <font color="#ff0000">Source</font> <font color="#0000ff">="~/ClientBin/MySilverlightApplication.xap"</font> <br> <font color="#ff0000">MinimumVersion</font> <font color="#0000ff">="2.0.31005.0"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="100%"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="100%"</font> <font color="#0000ff">/&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Change it to this code: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">asp:Silverlight</font> <font color="#ff0000">ID</font> <font color="#0000ff">="Xaml1"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <br> <font color="#ff0000">Source</font> <font color="#0000ff">="~/ClientBin/MySilverlightApplication.xap"</font> <br> <font color="#ff0000">MinimumVersion</font> <font color="#0000ff">="2.0.31005.0"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="100%"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="100%"</font> <br> <font color="#ff0000">InitParameters</font> <font color="#0000ff">="startPage=Page"</font> <font color="#0000ff">/&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The changes made are obvious.  InitParameters property added. <br><br>  We used two equivalent, from the Silverlight point of view, applications for setting initialization parameters: for the object tag and for the asp: Silverlight server control. <br><br>  Now we need to get the initialization parameters in the Silverlight application itself.  To do this, open the C # code of the App.xaml page and replace the Application_Startup function code with the following: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">void</font> Application_Startup( <font color="#0000ff">object</font> sender, StartupEventArgs e) <br> { <br> <font color="#0000ff">string</font> startPage = e.InitParams[ <font color="#A31515">"startPage"</font> ]; <br> <font color="#0000ff">if</font> (startPage != <font color="#0000ff">null</font> &amp;&amp; startPage.Equals( <font color="#A31515">"Page"</font> )) <br> { <br> <font color="#0000ff">this</font> .RootVisual = <font color="#0000ff">new</font> <font color="#2B91AF">Page</font> (); <br> } <br> <font color="#0000ff">else</font> <br> { <br> <font color="#0000ff">this</font> .RootVisual = <font color="#0000ff">new</font> NextPage(); <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The StartupEventArgs.InitParams property is of type IDictionary &lt;string, string&gt;.  And we can get all the specified initialization parameters from this dictionary.  In our case, if the startPage parameter we set is equal to ‚ÄúPage‚Äù, the control element described in the Page.xaml file becomes the main visual element of the application.  For any other value, the NextPage.xaml page will be the main visual control of the application. <br><br>  Let's run the program and look at the result.  Change the value of the startPage parameter and see what happens.  Do not forget, then return the value of the parameter back.  Since we will use this Silverlight application for further examples. <br><br><h3>  Access to HTML DOM (Document Object Model) </h3><br>  In the first example, changes were made on two (HTML and ASP.NET) pages.  Later in the article, to debug Silverlight applications only the page will be used - MySilverlightApplicationTestPage.aspx and all changes will be made accordingly only on it. <br><br>  To access the HTML document of the page that hosts the Silverlight application, use an HtmlPage.Document object of type HtmlDocument.  Also do not forget to connect the namespace System.Windows.Browser.  To do this, add the following section to the usings section of the C # Page.xaml.cs file: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">using</font> System.Windows.Browser</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Let's now add a button to the Page.xaml page, which will have the name ‚ÄúmainButton‚Äù, and set the button press event.  Here is the source code of the page: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">UserControl</font> <font color="#ff0000">x:Class</font> <font color="#0000ff">="MySilverlightApplication.Page"</font> <br> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</font> <br> <font color="#ff0000">xmlns:x</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml"</font> <br> <font color="#ff0000">Width</font> <font color="#0000ff">="400"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="300"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Grid</font> <font color="#ff0000">x:Name</font> <font color="#0000ff">="LayoutRoot"</font> <font color="#ff0000">Background</font> <font color="#0000ff">="White"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Button</font> <font color="#ff0000">Click</font> <font color="#0000ff">="Button_Click"</font> <font color="#ff0000">Content</font> <font color="#0000ff">=" "</font> <br> <font color="#ff0000">Width</font> <font color="#0000ff">="250"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="50"</font> <font color="#ff0000">x:Name</font> <font color="#0000ff">="mainButton"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">UserControl</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Open the MySilverlightApplicationTestPage.aspx page in an ASP.NET application and look at the Silverlight implementation code for the plugin. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">style</font> <font color="#0000ff">="height:100%;"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">asp:Silverlight</font> <font color="#ff0000">ID</font> <font color="#0000ff">="Xaml1"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <br> <font color="#ff0000">Source</font> <font color="#0000ff">="~/ClientBin/MySilverlightApplication.xap"</font> <br> <font color="#ff0000">MinimumVersion</font> <font color="#0000ff">="2.0.31005.0"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="100%"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="100%"</font> <br> <font color="#ff0000">InitParameters</font> <font color="#0000ff">="startPage=Page"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The asp: Silverlight tag is inside a div tag.  Give the div the name ‚ÄúmyDIV‚Äù and change the style. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">="myDIV"</font> <font color="#ff0000">style</font> <font color="#0000ff">="background:blue;width:100%;height:100%"</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Also set the width for the Silverlight plugin, Width = "50%", not 100%. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">asp:Silverlight</font> <font color="#ff0000">ID</font> <font color="#0000ff">="Xaml1"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <br> <font color="#ff0000">Source</font> <font color="#0000ff">="~/ClientBin/MySilverlightApplication.xap"</font> <br> <font color="#ff0000">MinimumVersion</font> <font color="#0000ff">="2.0.31005.0"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="50%"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="100%"</font> <br> <font color="#ff0000">InitParameters</font> <font color="#0000ff">="startPage=Page"</font> <font color="#0000ff">/&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Now we will write the code for the button click handler: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">void</font> Button_Click( <font color="#0000ff">object</font> sender, RoutedEventArgs e) <br> { <br> HtmlDocument doc = HtmlPage.Document; <br> HtmlElement div = doc.GetElementById( <font color="#A31515">"myDIV"</font> ); <br> div.SetStyleAttribute( <font color="#A31515">"background"</font> , <font color="#A31515">"green"</font> ); <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  With this code we get the HTML document, find the element inside the HTML document and set the style for this element.  Thus, inside the Silverlight application, we have rich possibilities for changing the appearance and content of the HTML page. <br><br>  Moreover, we can handle HTML page events in our C # code.  To do this, add a code to the button click handler, Button_Click: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">div.AttachEvent( <font color="#A31515">"onclick"</font> , <font color="#0000ff">new</font> EventHandler((o, x) =&gt; <br> { <br> div.SetStyleAttribute( <font color="#A31515">"background"</font> , <font color="#A31515">"yellow"</font> ); <br> })); <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  We join the event of clicking on the free space of the div element.  With this click, the background color changes to yellow.  Here, a lambda expression is used for the event handler.  Here is the complete code for the button click handler: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">void</font> Button_Click( <font color="#0000ff">object</font> sender, RoutedEventArgs e) <br> { <br> HtmlDocument doc = HtmlPage.Document; <br> HtmlElement div = doc.GetElementById( <font color="#A31515">"myDIV"</font> ); <br> div.AttachEvent( <font color="#A31515">"onclick"</font> , <font color="#0000ff">new</font> EventHandler((o, x) =&gt; <br> { <br> div.SetStyleAttribute( <font color="#A31515">"background"</font> , <font color="#A31515">"yellow"</font> ); <br> })); <br> div.SetStyleAttribute( <font color="#A31515">"background"</font> , <font color="#A31515">"green"</font> ); <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Since this is a test example, each time you press the button, the event is signed.  In real applications, it is impossible to do this and it is necessary to bring this code to the initialization section.  For example: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#2B91AF">Page</font> () <br> { <br> InitializeComponent(); <br> HtmlDocument doc = HtmlPage.Document; <br> HtmlElement div = doc.GetElementById( <font color="#A31515">"myDIV"</font> ); <br> div.AttachEvent( <font color="#A31515">"onclick"</font> , <font color="#0000ff">new</font> EventHandler((o, x) =&gt; <br> { <br> div.SetStyleAttribute( <font color="#A31515">"background"</font> , <font color="#A31515">"yellow"</font> ); <br> })); <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> Button_Click( <font color="#0000ff">object</font> sender, RoutedEventArgs e) <br> { <br> HtmlDocument doc = HtmlPage.Document; <br> HtmlElement div = doc.GetElementById( <font color="#A31515">"myDIV"</font> ); <br> div.SetStyleAttribute( <font color="#A31515">"background"</font> , <font color="#A31515">"green"</font> ); <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Here we are in the page constructor subscribing to the event we need. <br>  Run this application.  Press the button.  The blue space will turn green.  Now click on the green space and it will turn yellow. <br><br>  It should be noted that you can deny access to the HTML page from the Silverlight application.  To do this, set the HtmlAccess = "Disabled" property on the asp: Silverlight server control.  Whether access to the HTML page and scripts is allowed can be checked from the Silverlight application through the HtmlPage.IsEnabled property. <br><br><h3>  Calling JavaScript functions from Silverlight </h3><br>  Now let's talk about JavaScript integration.  To call a JavaScript function from Silverlight, just write the following code: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">HtmlPage.Window.Invoke( <font color="#A31515">"DisplayMessage"</font> , <font color="#A31515">"  Silverlight!"</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Here we call the JavaScript function DisplayMessage and pass it as a parameter string.  Add this code to the button event handler. <br><br>  Now create this JavaScript function on the ASP.NET page.  Section head page will look like this: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">head</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> MySilverlightApplication <font color="#0000ff">&lt;/</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">type</font> <font color="#0000ff">="text/javascript"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">function</font> DisplayMessage(message) { <br> alert(message); <br> } <br> <font color="#0000ff">&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">head</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  After that, when you click on the button, the JavaScript function is performed.  Which displays a message with the specified text.  The message text is passed in the parameter.  Run the application and check its work. <br><br><h3>  Calling Silverlight functions from JavaScript </h3><br>  Now it's time to call functions from JavaScript in our Silverlight application.  To do this, set the ScriptableType attribute on the Page type in the Page.xaml.cs file. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[ScriptableType] <br> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> <font color="#2B91AF">Page</font> : UserControl <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  This will allow us to access the specially marked functions of this object from JavaScript.  But first we need to register the Page object as available for the call.  To do this, add the following code to the Page () constructor: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">HtmlPage.RegisterScriptableObject( <font color="#A31515">"silverlightApplication"</font> , <font color="#0000ff">this</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Here we set the name (‚ÄúsilverlightApplication‚Äù) by which we can access the .NET object from JavaScript. <br><br>  Now inside the Page class we need to create a function, which we will call from JavaScript.  Here is the code for this function.  It has the ScriptableMember attribute, which means that it can be called from scripts. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[ScriptableMember] <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> ChangeButtonContent( <font color="#0000ff">string</font> text) <br> { <br> mainButton.Content = text; <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  This function sets the text on the button on the Silverlight page. <br><br>  The following is the complete code for the Page class: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[ScriptableType] <br> <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> <font color="#2B91AF">Page</font> : UserControl <br> { <br> <font color="#0000ff">public</font> <font color="#2B91AF">Page</font> () <br> { <br> InitializeComponent(); <br> HtmlPage.RegisterScriptableObject( <font color="#A31515">"silverlightApplication"</font> , <font color="#0000ff">this</font> ); <br> HtmlDocument doc = HtmlPage.Document; <br> HtmlElement div = doc.GetElementById( <font color="#A31515">"myDIV"</font> ); <br> div.AttachEvent( <font color="#A31515">"onclick"</font> , <font color="#0000ff">new</font> EventHandler((o, x) =&gt; <br> { <br> div.SetStyleAttribute( <font color="#A31515">"background"</font> , <font color="#A31515">"yellow"</font> ); <br> })); <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">void</font> Button_Click( <font color="#0000ff">object</font> sender, RoutedEventArgs e) <br> { <br> HtmlDocument doc = HtmlPage.Document; <br> HtmlElement div = doc.GetElementById( <font color="#A31515">"myDIV"</font> ); <br> div.SetStyleAttribute( <font color="#A31515">"background"</font> , <font color="#A31515">"green"</font> ); <br> HtmlPage.Window.Invoke( <font color="#A31515">"DisplayMessage"</font> , <font color="#A31515">"  Silverlight!"</font> ); <br> } <br> <br> [ScriptableMember] <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> ChangeButtonContent( <font color="#0000ff">string</font> text) <br> { <br> mainButton.Content = text; <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  And the Page.xaml file: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">UserControl</font> <font color="#ff0000">x:Class</font> <font color="#0000ff">="MySilverlightApplication.Page"</font> <br> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</font> <br> <font color="#ff0000">xmlns:x</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml"</font> <br> <font color="#ff0000">Width</font> <font color="#0000ff">="400"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="300"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Grid</font> <font color="#ff0000">x:Name</font> <font color="#0000ff">="LayoutRoot"</font> <font color="#ff0000">Background</font> <font color="#0000ff">="White"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Button</font> <font color="#ff0000">Click</font> <font color="#0000ff">="Button_Click"</font> <br> <font color="#ff0000">Content</font> <font color="#0000ff">=" "</font> <br> <font color="#ff0000">Width</font> <font color="#0000ff">="250"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="50"</font> <font color="#ff0000">x:Name</font> <font color="#0000ff">="mainButton"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">UserControl</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Now, change the JavaScript function of the DisplayMessage so that it calls the C # function ChangeButtonContent. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">function DisplayMessage(message) { <br> alert(message); <br> silverLightControl = document.getElementById( <font color="#A31515">"Xaml1"</font> ); <br> silverLightControl.content.silverlightApplication.ChangeButtonContent( <br> message); <br> } <br> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  We get the Silverlight object of the plugin and call the ChangeButtonContent function, passing it the same parameter that we passed from the C # code to the DisplayMessage function. <br><br>  The full code for the MySilverlightApplicationTestPage.aspx page is below: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font>&lt;%@ Page Language="C#" AutoEventWireup="true" %&gt;</font> <br> <br> <font>&lt;%@ Register Assembly="System.Web.Silverlight" <br> Namespace="System.Web.UI.SilverlightControls" <br> TagPrefix="asp" %&gt;</font> <br> <br> <font color="#0000ff">&lt;!</font> <font color="#800000">DOCTYPE</font> <font color="#ff0000">html</font> <br> <font color="#ff0000">PUBLIC</font> <font color="#0000ff">"-//W3C//DTD XHTML 1.0 Transitional//EN"</font> <br> <font color="#0000ff">"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">html</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://www.w3.org/1999/xhtml"</font> <font color="#ff0000">style</font> <font color="#0000ff">="height:100%;"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">head</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> MySilverlightApplication <font color="#0000ff">&lt;/</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">type</font> <font color="#0000ff">="text/javascript"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">function</font> DisplayMessage(message) { <br> alert(message); <br> silverLightControl = <font color="#0000ff">document</font> .getElementById( <font color="#A31515">"Xaml1"</font> ); <br> silverLightControl.content.silverlightApplication.ChangeButtonContent( <br> message); <br> } <br> <font color="#0000ff">&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">head</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">body</font> <font color="#ff0000">style</font> <font color="#0000ff">="height:100%;margin:0;"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">form</font> <font color="#ff0000">id</font> <font color="#0000ff">="form1"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <font color="#ff0000">style</font> <font color="#0000ff">="height:100%;"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">asp:ScriptManager</font> <font color="#ff0000">ID</font> <font color="#0000ff">="ScriptManager1"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">asp:ScriptManager</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">="myDIV"</font> <font color="#ff0000">style</font> <font color="#0000ff">="background:blue;width:100%;height:100%"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">asp:Silverlight</font> <font color="#ff0000">ID</font> <font color="#0000ff">="Xaml1"</font> <font color="#ff0000">runat</font> <font color="#0000ff">="server"</font> <br> <font color="#ff0000">Source</font> <font color="#0000ff">="~/ClientBin/MySilverlightApplication.xap"</font> <br> <font color="#ff0000">MinimumVersion</font> <font color="#0000ff">="2.0.31005.0"</font> <font color="#ff0000">Width</font> <font color="#0000ff">="50%"</font> <font color="#ff0000">Height</font> <font color="#0000ff">="100%"</font> <br> <font color="#ff0000">InitParameters</font> <font color="#0000ff">="startPage=Page"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">form</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">html</font> <font color="#0000ff">&gt;</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Run the application and check its performance. <br><br><img src="http://pugachev.info/wp-content/uploads/2008/12/image01.png" alt="Silverlight app"><br>  When you click a button in the Silverlight application, the background color of the div element on the HTML page changes, and the JavaScript function of the DisplayMessage function is invoked, which displays a message.  This JavaScript function calls the C # function ChangeButtonContent in the Page class.  The ChangeButtonContent function changes the text on the button. <br><br>  This concludes the first part of the article.  The following sections will highlight other relevant Silverlight application development issues.  I will be glad to your wishes and comments. <br><br><habracut></habracut></habracut></div><p>Source: <a href="https://habr.com/ru/post/46501/">https://habr.com/ru/post/46501/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../46494/index.html">GMail now with To-Do sheets</a></li>
<li><a href="../46495/index.html">Costs of large projects or a look at programming in a team from within</a></li>
<li><a href="../46496/index.html">Free CRM for small business - IContracts</a></li>
<li><a href="../46498/index.html">Idea for captcha. Font generation</a></li>
<li><a href="../46500/index.html">Correct redirection of requests to nginx</a></li>
<li><a href="../46502/index.html">Image Optimization, Part 4: Sequential JPEG - to be or not to be?</a></li>
<li><a href="../46504/index.html">Convenient profiling in Kcachegrind</a></li>
<li><a href="../46505/index.html">The photon processor is almost a reality</a></li>
<li><a href="../46506/index.html">Feel the headshots with HTX Helmet</a></li>
<li><a href="../46507/index.html">Men's Journal - MenToday.ru</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>