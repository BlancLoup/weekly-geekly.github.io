<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A little paranoia for online storage</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dropbox appeared long ago. But from the very beginning I didn‚Äôt like the idea of ‚Äã‚Äãstoring my files on a server. After all, I wanted to keep things th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A little paranoia for online storage</h1><div class="post__text post__text-html js-mediator-article">  Dropbox appeared long ago.  But from the very beginning I didn‚Äôt like the idea of ‚Äã‚Äãstoring my files on a server.  After all, I wanted to keep things that are well, it is absolutely undesirable to see someone else ... <br><br>  Now there are dozens of such services, and the people are actively using them.  And what to do to us, dear like-minded paranoids :) so much so that the convenience of work does not suffer, and privacy was taken care of?  The solution is there, and, as it turned out, it is not new - to store files encrypted with eCryptfs online. <br><br>  It's about Linux.  Mostly about Ubuntu and Ubuntu One ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  If in brief - eCryptfs operates with two directories: in one of them are encrypted files (all are encrypted with the same key) with optionally encrypted names, in the other, which becomes available after mounting, the source files themselves are located.  For each source file - one is encrypted.  It's simple. <br>  Next, you need to share through the online storage directory with encrypted files, and make sure that all computers participating in the synchronization have the same keys for mounting. <br><br>  When installing, Ubuntu offers the option of encrypting the home directory, when enabled, all user files in encrypted form are located in /home/.ecryptfs, and the contents of the home directories are mounted at login. <br>  At first glance it seems that you can share in Ubuntu One / home /. Ecryptfs and deal with the end.  As if not so. <br>  First: the private key is generated by itself (that is, it will be different on all computers). <br>  Secondly: it is unlikely that anyone needs to synchronize all user directories completely. <br>  Thirdly: using this type of encryption is not a good idea.  The fact is that when encrypting file names, ecryptfs somewhat increases their length, and some, which are already long, run into the file system limit (256 bytes for ext4fs). <br><br>  Nevertheless, Ubuntu has another, no less convenient solution: the <b>ecryptfs-setup-private</b> program, which in just 3 questions will create a directory for encrypted ~ / .Private files and a directory for source files ~ / Private, automatically mounted on login. <br><br><pre><code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$sudo</span></span> apt-get install ecryptfs-utils $ ecryptfs-setup-private Enter your login passphrase [user]: Enter your mount passphrase [leave blank to generate one]: Enter your mount passphrase (again):</code> </pre> <br>  On the question "Enter your login passphrase" you need to enter a password to log in to the system - this is necessary for automounting <br>  On the question "Enter your mount passphrase", you must enter a password for encryption (the same on all computers involved in synchronization). <br>  Then relogin and share ~ / .Private.  And everything, you can sleep peacefully.  I use this method when sharing files via Ubuntu One. <br><br>  Now <b>an alternative way</b> for those who do not have ecryptfs-setup-private, who need customization for their own needs, or who have the ~ / [\. {0,1}] Private directory already taken. <br><br>  Suppose a new pair of directories is called ~ / .Storage and ~ / Storage. <br>  So: <br>  On all computers participating in synchronization we create the necessary directories: <br><pre> <code class="bash hljs">mkdir ~/.Storage mkdir ~/Storage</code> </pre><br><br>  On one of the computers we do the first mount: <br><pre> <code class="bash hljs">sudo mount -t ecryptfs /home/user/.Storage/ /home/user/Storage/ -o \ key=passphrase,ecryptfs_cipher=aes,ecryptfs_key_bytes=16, \ ecryptfs_passthrough=n,ecryptfs_enable_filename_crypto=yes</code> </pre><br>  Ask "passphrase" - enter the password for encryption (the same on all computers), <br>  Ask ‚ÄúFilename Encryption Key (FNEK) Signature‚Äù - enter the password to encrypt the names (the same on all computers), <br>  It will give something like this: <br><pre> <code class="bash hljs">Attempting to mount with the following options: ecryptfs_unlink_sigs ecryptfs_fnek_sig=a973e495a25fce46 ecryptfs_key_bytes=16 ecryptfs_cipher=aes ecryptfs_sig=a973e495a25fce46</code> </pre><br>  Remember signatures. <br>  He will say that the disk has not yet been mounted with such a password, and asks for confirmation - say ‚Äúyes‚Äù, <br>  Asks whether to add a signature so as not to ask for confirmation the next time - ‚Äúyes‚Äù. <br><br>  Now, using the received signatures and the password, we will make a complete command that will be executed without asking anything: <br><pre> <code class="bash hljs">mount -t ecryptfs /home/user/.Storage/ /home/user/Storage/ -o key=passphrase,ecryptfs_cipher=aes,ecryptfs_key_bytes=16, \ ecryptfs_passthrough=n,ecryptfs_enable_filename_crypto=yes, \ passphrase_passwd=&lt;my-password&gt;,ecryptfs_sig=a973e495a25fce46, \ ecryptfs_fnek_sig=a973e495a25fce46</code> </pre><br>  It remains to put it in any file, and run at startup.  And of course share ~ / .Storage in your favorite online storage. </div><p>Source: <a href="https://habr.com/ru/post/143327/">https://habr.com/ru/post/143327/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143321/index.html">Apple and Samsung share the revenue of almost the entire mobile market.</a></li>
<li><a href="../143322/index.html">Writing complex interfaces with Spine.js</a></li>
<li><a href="../143323/index.html">Using the Microsoft Bing Translator API in Your Application</a></li>
<li><a href="../143324/index.html">Installing iOS 4.2 simulator in Xcode 4.3</a></li>
<li><a href="../143325/index.html">What does the Titanium SDK update to version 2.0 carry?</a></li>
<li><a href="../143330/index.html">I am looking for a team of like-minded people</a></li>
<li><a href="../143331/index.html">PHP vulnerability in CGI mode</a></li>
<li><a href="../143332/index.html">RubyMotion: native iOS Ruby applications (translation)</a></li>
<li><a href="../143335/index.html">Baby talk or C ++ also begins with something</a></li>
<li><a href="../143336/index.html">Active Directory in Windows Server 8: Moving Forward</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>