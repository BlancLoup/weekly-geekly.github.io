<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to bypass SMS-identification when connecting to public Wi-Fi networks?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In 2014, the RF Government Decree No. 758 No. 801 began to take effect, obliging the owners of public WiFi networks to set up on their routers the ide...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to bypass SMS-identification when connecting to public Wi-Fi networks?</h1><div class="post__text post__text-html js-mediator-article">  In 2014, the RF Government Decree No. 758 No. 801 began to take effect, obliging the owners of public WiFi networks to set up on their routers the identification of users through passport data, sms or the state portal.  services.  The reluctance of the cafe owners to spend money on the <a href="https://ru.wikipedia.org/wiki/Captive_portal">Captive portal has</a> contributed to some providers in distributing their access points with paid sms authorization.  I had a desire to check whether it is possible to bypass such sms-authorization. <br><br><img src="https://habrastorage.org/webt/t0/nc/et/t0ncetc5ufoyxrjutfoz43yfgfg.jpeg" alt="image"><br><a name="habracut"></a><br><br><h4>  Disclaimer </h4><br>  This article is written for informational purposes only.  In no case does the author urge readers to violate the laws of the Russian Federation.  Please do not repeat the actions described in this article without first reading Chapter 28 of the Criminal Code of the Russian Federation.  All trademarks and names of Wi-Fi networks in this article are fictional, and all matches are random. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  To the point ... </h3><br>  To find the right victim, I took a laptop with Debian on board and headed to the nearest pizzeria.  Nearby were a couple of shopping centers, and a few eateries, which guaranteed me to find a suitable "victim".  I connected to one of the networks available to me, then opened the browser to go to the cherished <s>pornhab</s> habr.com and this is what I saw: <br><br><img src="https://habrastorage.org/webt/pg/dq/72/pgdq7267jnmrgkwmb8njngeftti.png" alt="image"><br><br>  This access point was controlled by one of the Russian providers.  I was offered to use this network as a guest at minimum speed, get a premium for 99 rubles or (if I am a client of this provider) enter through my personal account.  And, of course, I went the way not included in this list (otherwise why would I start writing this article). <br><br>  In my experience, I knew that if I passed identification on one access point of this provider, then when connecting the same device to another point, identification was not required (then it turned out that this was the case with all providers providing sms authorization).  Identification was not required even when a different browser was used.  So, the provider somehow remembers our "hardware".  The very first thing that occurred to me was that the provider remembers the mac-address of our device.  This means that if you set yourself the mac-address of the one who has already passed the identification, then we will be able to safely use the network.  And, as we shall see, intuition did not let me down. <br><br>  To attack, I decided to use the utilities from the aircrack-ng package and the TL-WN722N WiFi adapter with an external antenna for more coverage.  First, I connected the adapter and using airodump-ng I switched it to monitor mode.  I described this process briefly, in more detail you can read <a href="https://hackware.ru/%3Fp%3D60">here</a> . <br><br><pre><code class="bash hljs">sudo -s <span class="hljs-comment"><span class="hljs-comment">#       ifconfig #   ,    </span></span></code> </pre> <br>  We get the output: <br><br><pre> <code class="bash hljs">... wlx60e32719503f: flags=4099&lt;UP,BROADCAST,MULTICAST&gt; mtu 1500 ether 2a:36:62:d5:ec:63 txqueuelen 1000 (Ethernet) RX packets 0 bytes 0 (0.0 B) RX errors 0 dropped 0 overruns 0 frame 0 TX packets 0 bytes 0 (0.0 B) TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 ...</code> </pre><br>  wlx60e32719503f is our adapter <br>  We kill the processes that use the adapter, and translate it into monitor mode. <br><br><pre> <code class="bash hljs">airmon-ng check <span class="hljs-built_in"><span class="hljs-built_in">kill</span></span> airmon-ng start wlx60e32719503f</code> </pre><br><br><img src="https://habrastorage.org/webt/4u/ek/e1/4ueke1vtdc6v-wguaj5syk8aebu.png" alt="image"><br><br>  We see that a new network interface has appeared - wlan0mon.  Run it <br><br><pre> <code class="bash hljs">airodump-ng wlan0mon</code> </pre><br><br>  We are waiting for a couple of minutes, and we get this sign <br><br><img src="https://habrastorage.org/webt/hp/si/eq/hpsieqikoizhhbluad5p7uj-ns0.png" alt="image"><br><br>  We are interested in the BSSID (mac-address of the access point), CH (channel) and ESSID (network name) fields.  Through the ESSID field I found the network of interest (it is the sixth in a row).  We take from the table the mac-address of the access point (CC: B2: **: **: **: FC), the channel (channel 4) on which it works and transfer them to airodump-ng: <br><br><pre> <code class="bash hljs">airodump-ng wlan0mon -c 4 --bssid CC:B2:**:**:**:FC</code> </pre><br>  We are waiting for some time, and now we get the following conclusion: <br><br><img src="https://habrastorage.org/webt/-y/qw/45/-yqw457qf7qfmn8yfxzn24sbrme.png" alt="image"><br><br>  The first table has only one row.  This is our attacked network.  In the second table we see the list of clients of this network.  We are interested in the STATION field.  These are mac-addresses of clients, we save them in a text file.  We need to replace our mac-address with one of them.  I chose the mac of the penultimate client (1C: CD: **: **: **: 43), because this client is the most active on the network, and therefore, it must have been identified. <br><br>  As everyone knows (and I hope you know), it will be difficult for two devices with the same mac-addresses to get along on the same network.  And now we have 2 options. <br><br>  You can use the aireplay-ng utility to deauthenticate our client from the network. <br><br><pre> <code class="bash hljs">aireplay-ng -0 1000 -a CC:B2:**:**:**:FC -c 1C:CD:**:**:**:43 wlan0mon</code> </pre><br><ul><li>  "-a CC: B2: **: **: **: FC" is the attacked access point </li><li>  "-c 1C: CD: **: **: **: 43" is the client that we will disconnect </li><li>  "-0 1000" - here we indicate the type of attack (zero is deauthentication) and the number of deauthentication packets to disable the client if it connects again. </li></ul><br><br>  But I decided not to harm the person, but to go in a more humane way - to wait until the client leaves (just have time to eat pizza). <br>  Fortunately, this client quickly left.  Now we have to put his mac-address himself.  There are many ways to change the mac address to linux.  The easiest is to specify the desired mac-address directly in the network settings. <br><br><img src="https://habrastorage.org/webt/fc/mv/az/fcmvazw6wkqmvh1o9yqp-zlge4c.png" alt="image"><br><br>  Mac address is specified, now we can connect to the point, and check access to the Internet with the ping command. <br><br><img src="https://habrastorage.org/webt/fu/6i/hg/fu6ihgphp5fhvtdy4sldupzj_o4.png" alt="image"><br><br>  I tried to go to Google, and several other sites - successfully. <br><br><h4>  Conclusion </h4><br>  Thus, we managed to find out that SMS authorization is easy to get around by replacing your mac-address with the mac-address of a client who has already been authenticated.  In conclusion, I would like to say once again: ‚ÄúThis article is written for informational purposes, the author in no way encourages readers to violate the laws of the Russian Federation.‚Äù </div><p>Source: <a href="https://habr.com/ru/post/423931/">https://habr.com/ru/post/423931/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423919/index.html">How to automate the collection of KPI for the month and leave users almost satisfied</a></li>
<li><a href="../423921/index.html">10 years of Android: remember everything</a></li>
<li><a href="../423923/index.html">SAP Leonardo Hackathon from velcom and SAP for developers from Belarus</a></li>
<li><a href="../423925/index.html">Open webinar ‚ÄúStrange recursive template‚Äù</a></li>
<li><a href="../423927/index.html">10 promising search engines to improve SEO</a></li>
<li><a href="../423933/index.html">Microsoft Office Security: Embedded Objects</a></li>
<li><a href="../423935/index.html">Answers from the Embox stand to popular questions from the IT-festival TechTrain</a></li>
<li><a href="../423937/index.html">Privilege escalation in a Windows environment</a></li>
<li><a href="../423939/index.html">Dynamic programming or "Divide and Conquer"</a></li>
<li><a href="../423941/index.html">Reports from iOS mitap Redmadrobot</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>