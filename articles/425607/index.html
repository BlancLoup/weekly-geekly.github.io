<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Identify fraud using Enron dataset. Part 2, the search for the optimal model</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I present to you the second part of the article on the search for suspected fraud on the basis of data from Enron Dataset. If you have not read the fi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Identify fraud using Enron dataset. Part 2, the search for the optimal model</h1><div class="post__text post__text-html js-mediator-article"><p>  I present to you the second part of the article on the search for suspected fraud on the basis of data from Enron Dataset.  If you have not read the first part, you can read it <a href="https://habr.com/post/424891/">here</a> . </p><br><p>  Now we will talk about the process of building, optimizing and selecting a model that will give the answer: is it worth it to suspect a person of fraud? </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hn/gs/0i/hngs0ix8h0znhrykvqefaqfdcey.png" alt="Enron"></div><a name="habracut"></a><br><p>  Earlier, we analyzed one of the open datasets that gives information about suspects in the Enron case and fraud.  The offset in the original data was also corrected, gaps (NaN) were filled, after which the data were normalized and the signs were selected. </p><br><p>  The result was familiar to many: </p><br><ul><li>  X_train and y_train - sample used for training (111 entries); </li><li>  X_test and y_test is the sample on which the prediction of our models will be checked (28 records). </li></ul><br><p>  Speaking of models ... In order to correctly predict whether a person should be suspected, based on some signs that characterize his activity, we will use the classification.  The main types of models used to solve problems in this segment can be taken from Sklearn: </p><br><ul><li>  Naive Bayes (naive Bayes classifier); </li><li>  SVM (support vector machine); </li><li>  K-nearest neighbors (nearest neighbors search method); </li><li>  Random Forest (random forest); </li><li>  Neural Network (neural networks). </li></ul><br><p>  There is also a picture that illustrates their applicability quite well: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6_/te/_i/6_te_ipyv37mympp3nt1peuxq74.png" alt="image"></div><br><p>  Among them there is a familiar Decision Tree (decision tree), but perhaps there is no point in using this method together with Random Forest, which is an <abbr title="one type of entity set">ensemble</abbr> of decision trees, in one task.  Therefore, we replace it with the Logistic Regression (logistic regression), which is able to act as a classifier and produce one of the expected options (0 or 1). </p><br><h2 id="nachalo">  Start </h2><br><p>  We initialize all mentioned classifiers with default values: </p><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.naive_bayes <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> GaussianNB <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.linear_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LogisticRegression <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.neighbors <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KNeighborsClassifier <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.svm <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SVC <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.neural_network <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MLPClassifier <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifier random_state = <span class="hljs-number"><span class="hljs-number">42</span></span> gnb = GaussianNB() svc = SVC() knn = KNeighborsClassifier() <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> = LogisticRegression(random_state=random_state) rfc = RandomForestClassifier(random_state=random_state) mlp = MLPClassifier(random_state=random_state)</code> </pre> <br><p>  We will also group them in order to make it easier to work with them as with an aggregate, rather than writing code for each one individually.  For example, we can train them all at once: </p><br><pre> <code class="hljs pgsql">classifiers = [gnb, svc, knn, <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>, rfc, mlp] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> clf <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> classifiers: clf.fit(X_train, y_train)</code> </pre> <br><p>  After the models have been trained, it's time to first check their prediction quality.  Additionally, we visualize our results using Seaborn: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> accuracy_score def calculate_accuracy(X, y): result = pd.DataFrame(<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>=[<span class="hljs-string"><span class="hljs-string">'classifier'</span></span>, <span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> clf <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> classifiers: predicted = clf.predict(X_test) accuracy = round(<span class="hljs-number"><span class="hljs-number">100.0</span></span> * accuracy_score(y_test, predicted), <span class="hljs-number"><span class="hljs-number">2</span></span>) classifier = clf.__class__.__name__ classifier = classifier.replace(<span class="hljs-string"><span class="hljs-string">'Classifier'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) result = result.append({<span class="hljs-string"><span class="hljs-string">'classifier'</span></span>: classifier, <span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>: accuracy}, ignore_index=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) print(<span class="hljs-string"><span class="hljs-string">'Accuracy is {accuracy}% for {classifier_name}'</span></span>.format(accuracy=accuracy, classifier_name=classifier)) result = result.sort_values([<span class="hljs-string"><span class="hljs-string">'classifier'</span></span>], ascending=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>)) sns.barplot(x="classifier", y=<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>, palette=cmap, data=result)</code> </pre> <br><p>  Let's look at the general idea of ‚Äã‚Äãthe accuracy of the classifiers: </p><br><pre> <code class="hljs lisp">calculate_accuracy(<span class="hljs-name"><span class="hljs-name">X_train</span></span>, y_train)</code> </pre> <br><p><img src="https://habrastorage.org/webt/ob/ej/lk/obejlkx9brbl1tw_gqauqm8h66a.png"><br>  At first glance, it looks quite good, the accuracy of predictions on the test sample varies around 90%.  It seems that the task is done brilliantly! </p><br><div class="spoiler">  <b class="spoiler_title">In fact, not everything is so rosy.</b> <div class="spoiler_text"><p>  High accuracy is not a guarantee of correctness of predictions.  In our test sample, there are 28 records, 4 of which are related to suspects, and 24 to those who are beyond suspicion.  Imagine that we have created some kind of algorithm: </p><br><pre> <code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">QuaziAlgo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(features)</span></span></span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><p>  After that, we gave him our test sample at the entrance, and got that all 28 people are innocent.  What will be the accuracy of the algorithm in this case? </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9">y</span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-11">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">c</span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">P</span></span><span class="MJXp-mrow" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">N</span></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-21">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">c</span><span class="MJXp-mrow" id="MJXp-Span-26"><span class="MJXp-mn" id="MJXp-Span-27">24</span></span><span class="MJXp-mrow" id="MJXp-Span-28"><span class="MJXp-mn" id="MJXp-Span-29">28</span></span><span class="MJXp-mtext" id="MJXp-Span-30">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">x</span><span class="MJXp-mrow" id="MJXp-Span-37"><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0em;">$</span></span><span class="MJXp-mn" id="MJXp-Span-39">0.85</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="47.424ex" height="2.624ex" viewBox="0 -831.5 20418.6 1129.8" role="img" focusable="false" style="vertical-align: -0.693ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-41" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-63" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-63" x="1184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-75" x="1617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-72" x="2190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="2641" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-63" x="3171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-79" x="3604" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-3D" x="4379" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-66" x="5686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-72" x="6236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="6688" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-63" x="7217" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-50" x="7651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-4E" x="8402" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-3D" x="9568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-66" x="10875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-72" x="11425" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="11877" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-63" x="12406" y="0"></use><g transform="translate(12840,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-34" x="500" y="0"></use></g><g transform="translate(13841,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-38" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="15092" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-70" x="15621" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-70" x="16125" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-72" x="16628" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="17080" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-78" x="17565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-24" x="18138" y="0"></use><g transform="translate(18638,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-38" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-35" x="1279" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-1"> Accuracy = \ frac {P} {N} = \ frac {24} {28} \ approx $ 0.85</script></p><br><p>  Interestingly, KNeighbors has the same prediction accuracy ... </p></div></div><br><p>  But still, before flattering ourselves, let's build an error confusion matrix for the prediction results: </p><br><pre> <code class="hljs python"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> confusion_matrix <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">make_confussion_matrices</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(X, y)</span></span></span><span class="hljs-function">:</span></span> matrices = {} result = pd.DataFrame(columns=[<span class="hljs-string"><span class="hljs-string">'classifier'</span></span>, <span class="hljs-string"><span class="hljs-string">'recall'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> clf <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> classifiers: classifier = clf.__class__.__name__ classifier = classifier.replace(<span class="hljs-string"><span class="hljs-string">'Classifier'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) predicted = clf.predict(X_test) print(<span class="hljs-string"><span class="hljs-string">f'</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{predicted}</span></span></span><span class="hljs-string">-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{classifier}</span></span></span><span class="hljs-string">'</span></span>) matrix = confusion_matrix(y_test,predicted,labels=[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>]) matrices[classifier] = matrix.T <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> matrices</code> </pre> <br><p>  We calculate the error matrix for each classifier and at the same time we will see what they predicted: </p><br><pre> <code class="hljs lisp">matrices = make_confussion_matrices(<span class="hljs-name"><span class="hljs-name">X_train</span></span>,y_train)</code> </pre> <br><p><img src="https://habrastorage.org/webt/jg/i9/r-/jgi9r-1raw4acxfo5tdtsgyh9qw.png"></p><br><p>  Even a textual representation of the result of the work of the classifiers is enough to understand that something obviously went wrong. </p><br><p>  The method of the nearest neighbors did not reveal a single suspect in the test sample at all.  There are two questions: </p><br><ol><li>  What is the reason for such behavior of the KNeighbors classifier? </li><li>  Why did we build error matrices if we do not use them, but simply look at the results of the prediction? </li></ol><br><h3 id="zaglyanem-glubzhe">  Look deeper </h3><br><p>  Let's start with the second question.  Let's try to visualize our error matrices, and present the data in graphical format to understand where the classification error occurs: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> itertools <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> collections <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Iterable def draw_confussion_matrices(<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>,col,matrices,figsize = (<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>)): fig, (axes) = plt.subplots(<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>,col, sharex=<span class="hljs-string"><span class="hljs-string">'col'</span></span>, sharey=<span class="hljs-string"><span class="hljs-string">'row'</span></span>,figsize=figsize ) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span>(isinstance(i, Iterable) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> axes): axes = list(itertools.chain.from_iterable(axes)) idx = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>,matrix <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> matrices.items(): df_cm = pd.DataFrame( matrix, <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>=[<span class="hljs-string"><span class="hljs-string">'True'</span></span>,<span class="hljs-string"><span class="hljs-string">'False'</span></span>], <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>=[<span class="hljs-string"><span class="hljs-string">'True'</span></span>,<span class="hljs-string"><span class="hljs-string">'False'</span></span>], ) ax = axes[idx] fig.subplots_adjust(wspace=<span class="hljs-number"><span class="hljs-number">0.1</span></span>) sns.heatmap(df_cm, annot=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>,cmap=cmap,cbar=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span> ,fmt="d",ax=ax,linewidths=<span class="hljs-number"><span class="hljs-number">1</span></span>) ax.set_title(<span class="hljs-type"><span class="hljs-type">name</span></span>) idx += <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p>  Let's display them in 2 rows and 3 columns: </p><br><pre> <code class="hljs lisp">draw_confussion_matrices(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,matrices)</code> </pre> <br><p><img src="https://habrastorage.org/webt/er/_e/6q/er_e6q34-nsppof3cmoo--rfyyk.png"></p><br><p>  <em>Before continuing, it is worth giving some explanations.</em>  <em>The designation True, which is located to the left of the error matrix of a particular classifier, means that the classifier considered the person to be a suspect, the value False means that the person is out of suspicion.</em>  <em>Similarly, True and False at the bottom of the image gives us a real state of affairs that may not coincide with the decision of the classifier.</em> </p><br><p>  <em>For example, we see that the decisions of KNeighbors with a prediction accuracy of 85.71% coincided with the real state of affairs, when 24 people, who were above suspicion, were listed in the same list by the classifier.</em>  <em>But 4 people from the list of suspects were also included in this list.</em>  <em>If this classifier made decisions, perhaps someone would have avoided the court.</em> </p><br><p>  Thus, the error matrix is ‚Äã‚Äãa very good tool for understanding what went wrong in the classification tasks.  Their main advantage in visibility, and therefore we turn to them. </p><br><h2 id="metriki">  Metrics </h2><br><p>  In general terms, this can be illustrated by the following picture: <br><img src="https://habrastorage.org/webt/cu/4l/2w/cu4l2wliuqbqanpptc1y-rq3scu.png"></p><br><p>  <strong>What are TP, TN, FP and some FN in this case?</strong> </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">P</span><span class="MJXp-mtext" id="MJXp-Span-43">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-45">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">e</span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">e</span><span class="MJXp-mtext" id="MJXp-Span-59">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">n</span><span class="MJXp-mspace" id="MJXp-Span-68" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">T</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">N</span><span class="MJXp-mtext" id="MJXp-Span-71">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-73">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">e</span><span class="MJXp-mo" id="MJXp-Span-78" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">e</span><span class="MJXp-mtext" id="MJXp-Span-87">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">n</span><span class="MJXp-mspace" id="MJXp-Span-96" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">F</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">P</span><span class="MJXp-mtext" id="MJXp-Span-99">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-100" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-101">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">e</span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">e</span><span class="MJXp-mtext" id="MJXp-Span-116">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">n</span><span class="MJXp-mspace" id="MJXp-Span-125" style="width: 0em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">F</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">N</span><span class="MJXp-mtext" id="MJXp-Span-128">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-129" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-130">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">e</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">e</span><span class="MJXp-mtext" id="MJXp-Span-145">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.685ex" height="11.817ex" viewBox="0 -780.1 14503.4 5087.6" role="img" focusable="false" style="vertical-align: -10.005ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-50" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2212" x="1928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="3178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-72" x="3540" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-75" x="3991" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="4564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2212" x="5253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-70" x="6253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="6757" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-73" x="7242" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="7712" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="8057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="8419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-76" x="8764" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="9250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-73" x="9966" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="10436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6C" x="10921" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-75" x="11220" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="11792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="12154" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="12499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6E" x="12985" y="0"></use><g transform="translate(0,-1322)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-4E" x="704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2212" x="2065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="3315" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-72" x="3677" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-75" x="4128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="4701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2212" x="5390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6E" x="6390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="6991" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-67" x="7457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="7938" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="8467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="8829" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-76" x="9174" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="9660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-73" x="10376" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="10846" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6C" x="11331" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-75" x="11630" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="12202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="12564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="12909" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6E" x="13395" y="0"></use></g><g transform="translate(0,-2665)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-46" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-50" x="749" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2212" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-66" x="3223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="3774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6C" x="4303" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-73" x="4602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="5071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2212" x="5760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-70" x="6761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="7264" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-73" x="7750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="8219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="8565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="8926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-76" x="9272" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="9757" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-73" x="10474" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="10943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6C" x="11429" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-75" x="11727" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="12300" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="12661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="13007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6E" x="13492" y="0"></use></g><g transform="translate(0,-4007)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-46" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-4E" x="749" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2212" x="2110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-66" x="3360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="3911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6C" x="4440" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-73" x="4739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="5208" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2212" x="5897" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6E" x="6898" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="7498" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-67" x="7965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="8445" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="8975" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="9336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-76" x="9682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-65" x="10167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-73" x="10884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="11353" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6C" x="11839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-75" x="12137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-74" x="12710" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="13071" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="13417" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6E" x="13902" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-2"> TP \ - \ true-positive \ solution \\ TN \ - \ true-negative \ solution \\ FP \ - \ false-positive \ solution \\ FN \ - \ false-negative \ solution </script></p><br><p>  In other words, we strive to ensure that the classifier's answers and the real state of affairs coincide.  That is, to ensure that all numbers are distributed between the cells of TP and TN (true solutions) and do not fall into the FN and FP (false decisions). </p><br><div class="spoiler">  <b class="spoiler_title">everything is not always so dramatic and unambiguous</b> <div class="spoiler_text"><p>  For example, in the canonical case with the diagnosis of cancer, FP is preferable to FN, because in the case of a false verdict about cancer, the patient will be prescribed medication and will treat it.  Yes, it will affect his health and wallet, but still it is considered less dangerous than the FN and the missed period in which the cancer can be defeated with small means. <br>  What about the suspects in our case?  Probably, FN is not as bad as FP.  But more on that further ... </p></div></div><br><p>  And once we are talking about abbreviations, it's time to recall the accuracy metrics (Precision) and completeness (Recall). </p><br><p>  If you deviate from the formal record, then <strong>Precision</strong> can be expressed as: <br><img src="https://habrastorage.org/webt/m8/5g/uu/m85guuomhqmesua0dzx308wpb2g.png"><br>  In other words, an account is kept of how many positive responses received from the classifier are correct.  The greater the accuracy, the smaller the number of false hits (accuracy is 1 if there were no FPs). </p><br><p>  <strong>Recall</strong> is generally presented as: <br><img src="https://habrastorage.org/webt/nx/wa/a-/nxwaa-k0dt94hv2t5t4fv3wfk78.png"><br>  Recall characterizes the ability of the classifier to "guess" the largest possible number of positive answers from the expected ones.  The higher the completeness, the less FN was. </p><br><p>  Usually trying to balance between these two, but in this case, the priority will be fully given to Precision.  The reason: a more humanistic approach, a desire to minimize the number of false-positive positives and, as a result, to avoid suspicion falling on the innocent. </p><br><p>  We calculate Precision for our classifiers: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> precision_score def calculate_precision(X, y): result = pd.DataFrame(<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>=[<span class="hljs-string"><span class="hljs-string">'classifier'</span></span>, <span class="hljs-string"><span class="hljs-string">'precision'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> clf <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> classifiers: predicted = clf.predict(X_test) <span class="hljs-type"><span class="hljs-type">precision</span></span> = precision_score(y_test, predicted, average=<span class="hljs-string"><span class="hljs-string">'macro'</span></span>) classifier = clf.__class__.__name__ classifier = classifier.replace(<span class="hljs-string"><span class="hljs-string">'Classifier'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) result = result.append({<span class="hljs-string"><span class="hljs-string">'classifier'</span></span>: classifier, <span class="hljs-string"><span class="hljs-string">'precision'</span></span>: <span class="hljs-type"><span class="hljs-type">precision</span></span>}, ignore_index=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) print(<span class="hljs-string"><span class="hljs-string">'Precision is {precision} for {classifier_name}'</span></span>.format(<span class="hljs-type"><span class="hljs-type">precision</span></span>=round(<span class="hljs-type"><span class="hljs-type">precision</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>), classifier_name=classifier)) result = result.sort_values([<span class="hljs-string"><span class="hljs-string">'classifier'</span></span>], ascending=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>)) sns.barplot(x="classifier", y=<span class="hljs-string"><span class="hljs-string">'precision'</span></span>, palette=cmap, data=result) calculate_precision(X_train, y_train)</code> </pre> <br><p><img src="https://habrastorage.org/webt/hr/mk/qd/hrmkqdjyxnkbmj1llssq0coispi.png"></p><br><p>  As follows from the figure, it turned out quite expectedly: the accuracy of the KNeighbors turned out to be lower than everyone, because the TP value is the lowest. </p><br><p>  At the same time, there is a <a href="https://habr.com/company/ods/blog/328372/">good article</a> on Habr√© about metrics, and those who want to dive deeper into this topic should read it. </p><br><h2 id="podbor-giper-parametrov">  Selection of hyper-parameters </h2><br><p>  After we have found the metric that best fits the selected conditions (we reduce the number of FPs), we can return to the first question: What is the reason for such behavior of the KNeighbors classifier? </p><br><p>  The reason lies in the default parameters with which this model was created.  And, most likely, to this stage, many could exclaim: why train on default parameters?  There are special tools for the selection, for example, often used GridSearchCV. <br>  Yes, it is, and it is time to resort to it, </p><br><p>  But before that, we remove the Bayess classifier from our list.  It allows one FP, and at the same time, this algorithm does not accept any variable parameters, as a result of which the result will not change. </p><br><pre> <code class="hljs cs">classifiers.<span class="hljs-keyword"><span class="hljs-keyword">remove</span></span>(gnb)</code> </pre> <br><h3 id="podstroyka">  Adjustment </h3><br><p>  Let's set the parameter grid for each classifier: </p><br><pre> <code class="hljs pgsql">parameters = {<span class="hljs-string"><span class="hljs-string">'SVC'</span></span>:{<span class="hljs-string"><span class="hljs-string">'kernel'</span></span>:(<span class="hljs-string"><span class="hljs-string">'linear'</span></span>, <span class="hljs-string"><span class="hljs-string">'rbf'</span></span>,<span class="hljs-string"><span class="hljs-string">'poly'</span></span>), <span class="hljs-string"><span class="hljs-string">'C'</span></span>:[i <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>)],<span class="hljs-string"><span class="hljs-string">'random_state'</span></span>: (random_state,)}, <span class="hljs-string"><span class="hljs-string">'KNeighbors'</span></span>:{<span class="hljs-string"><span class="hljs-string">'algorithm'</span></span>:(<span class="hljs-string"><span class="hljs-string">'ball_tree'</span></span>, <span class="hljs-string"><span class="hljs-string">'kd_tree'</span></span>), <span class="hljs-string"><span class="hljs-string">'n_neighbors'</span></span>:[i <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>)]}, <span class="hljs-string"><span class="hljs-string">'LogisticRegression'</span></span>:{<span class="hljs-string"><span class="hljs-string">'penalty'</span></span>:(<span class="hljs-string"><span class="hljs-string">'l1'</span></span>, <span class="hljs-string"><span class="hljs-string">'l2'</span></span>), <span class="hljs-string"><span class="hljs-string">'C'</span></span>:[i <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>)],<span class="hljs-string"><span class="hljs-string">'random_state'</span></span>: (random_state,)}, <span class="hljs-string"><span class="hljs-string">'RandomForest'</span></span>:{<span class="hljs-string"><span class="hljs-string">'n_estimators'</span></span>:[i <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">101</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>)],<span class="hljs-string"><span class="hljs-string">'random_state'</span></span>: (random_state,)}, <span class="hljs-string"><span class="hljs-string">'MLP'</span></span>:{<span class="hljs-string"><span class="hljs-string">'activation'</span></span>:(<span class="hljs-string"><span class="hljs-string">'relu'</span></span>,<span class="hljs-string"><span class="hljs-string">'logistic'</span></span>),<span class="hljs-string"><span class="hljs-string">'solver'</span></span>:(<span class="hljs-string"><span class="hljs-string">'sgd'</span></span>,<span class="hljs-string"><span class="hljs-string">'lbfgs'</span></span>),<span class="hljs-string"><span class="hljs-string">'max_iter'</span></span>:(<span class="hljs-number"><span class="hljs-number">500</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>), <span class="hljs-string"><span class="hljs-string">'hidden_layer_sizes'</span></span>:[(<span class="hljs-number"><span class="hljs-number">7</span></span>,),(<span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>)],<span class="hljs-string"><span class="hljs-string">'random_state'</span></span>: (random_state,)}}</code> </pre> <br><p>  Additionally, I wanted to draw attention to the number of layers / neurons in the MLP. <br>  It was decided to set them not by enumerating all possible values, but still based on the <a href="https://stats.stackexchange.com/a/136542">formula</a> : </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-154"><span class="MJXp-msubsup" id="MJXp-Span-155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156" style="margin-right: 0.05em;">N</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-157" style="vertical-align: -0.4em;">h</span></span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-159">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">c</span><span class="MJXp-mrow" id="MJXp-Span-164"><span class="MJXp-msubsup" id="MJXp-Span-165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166" style="margin-right: 0.05em;">N</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-167" style="vertical-align: -0.4em;">s</span></span></span><span class="MJXp-mrow" id="MJXp-Span-168"><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-170">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">a</span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179" style="margin-right: 0.05em;">N</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-180" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183" style="margin-right: 0.05em;">N</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-184" style="vertical-align: -0.4em;">o</span></span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-186" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-188">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">c</span><span class="MJXp-mrow" id="MJXp-Span-193"><span class="MJXp-mn" id="MJXp-Span-194">117</span></span><span class="MJXp-mrow" id="MJXp-Span-195"><span class="MJXp-mo" id="MJXp-Span-196" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-197">2</span><span class="MJXp-mo" id="MJXp-Span-198" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-200">7</span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-202">1</span><span class="MJXp-mo" id="MJXp-Span-203" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-205">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">x</span><span class="MJXp-mn" id="MJXp-Span-212">7</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="67.304ex" height="2.66ex" viewBox="0 -832 28978.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-68" x="1136" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-3D" x="1588" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-66" x="2895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-72" x="3445" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="3897" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-63" x="4426" y="0"></use><g transform="translate(4860,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-73" x="1136" y="-213"></use></g><g transform="translate(6095,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6C" x="1169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-70" x="1467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-68" x="1971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="2547" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2217" x="3299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-28" x="4021" y="0"></use><g transform="translate(4411,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-69" x="1136" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2B" x="5781" y="0"></use><g transform="translate(6782,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="1136" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-29" x="8028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-29" x="8418" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-3D" x="15181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-66" x="16487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-72" x="17038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="17489" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-63" x="18019" y="0"></use><g transform="translate(18452,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-31" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-37" x="1001" y="0"></use></g><g transform="translate(19954,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-32" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2217" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-28" x="1834" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-37" x="2224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-2B" x="2947" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-31" x="3947" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-29" x="4448" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-29" x="4837" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-61" x="25431" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-70" x="25961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-70" x="26464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-72" x="26968" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-6F" x="27419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMATHI-78" x="27905" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/425607/&amp;xid=17259,1500004,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhg6dwROXBJRx3KhuOjjyN2jNTLoQ#MJMAIN-37" x="28477" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> N_h = \ frac {N_s} {(\ alpha * (N_i + N_o))} = \ frac {117} {(2 * (7 + 1))} \ approx 7 </script></p><br><p>  I would like to say right away that training and cross-validation will be carried out only on the training set.  I admit that there is an opinion that it is possible to do this on all data as in the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">example</a> with Iris Dataset.  But, in my opinion, such an approach is not entirely justified, since it will be impossible to trust the results of testing on a test sample. </p><br><p>  We will optimize and replace our classifiers with their improved version: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection import GridSearchCV warnings.filterwarnings(<span class="hljs-string"><span class="hljs-string">'ignore'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> idx,<span class="hljs-function"><span class="hljs-function">clf </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">in</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enumerate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">classifiers</span></span></span><span class="hljs-function">): classifier</span></span> = clf.__class__.__name__ classifier = classifier.replace(<span class="hljs-string"><span class="hljs-string">'Classifier'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">params</span></span> = parameters.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(classifier) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> not <span class="hljs-keyword"><span class="hljs-keyword">params</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> new_clf = clf.__class__() gs = GridSearchCV(new_clf, <span class="hljs-keyword"><span class="hljs-keyword">params</span></span>, cv=<span class="hljs-number"><span class="hljs-number">5</span></span>) result =gs.fit(X_train, y_train) print(f<span class="hljs-string"><span class="hljs-string">'The best params for {classifier} are {result.best_params_}'</span></span>) classifiers[idx] = result.best_estimator_</code> </pre> <br><p><img src="https://habrastorage.org/webt/hq/1p/qy/hq1pqyknfjzkh7zuauj_to-mylg.png"></p><br><p>  After we have selected the metric for evaluation and completed GridSearchCV, we are ready to draw the final line. </p><br><h2 id="podvodim-itogi">  Summing up </h2><br><h3 id="matrica-oshibok-v2">  Error Matrix v.2 </h3><br><pre> <code class="hljs lisp">matrices = make_confussion_matrices(<span class="hljs-name"><span class="hljs-name">X_train</span></span>,y_train) draw_confussion_matrices(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,first_row,figsize = (<span class="hljs-number"><span class="hljs-number">10.5</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>)) draw_confussion_matrices(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,second_row,figsize = (<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>))</code> </pre> <br><p><img src="https://habrastorage.org/webt/bp/-i/gb/bp-igb2cyu26v-klambsbv8squk.png"><br><img src="https://habrastorage.org/webt/7j/lv/_b/7jlv_btrr-2vb4jxjd3qxp0robk.png"><br>  As can be seen from the matrix, the MLP showed degradation and considered that there were no suspects in the test sample.  Random Forest added accuracy and corrected parameters for False Negative and True Positive.  And KNeighbors showed an improvement in prediction.  The forecast for others has not changed. </p><br><h3 id="tochnost-v2">  Accuracy v.2 </h3><br><p>  Now, none of our current classifiers have errors with False Positive, which is good news.  But, if we express everything in terms of numbers, we get the following picture: </p><br><pre> <code class="hljs lisp">calculate_precision(<span class="hljs-name"><span class="hljs-name">X_train</span></span>, y_train)</code> </pre> <br><p><img src="https://habrastorage.org/webt/nk/9i/14/nk9i14ik-o-pvnlombnb8msikc8.png"><br><img src="https://habrastorage.org/webt/lg/ze/te/lgzetelx1fyb3xz3wgfo3ako1m8.png"></p><br><p>  Identified 3 classifier with the highest rate of precision.  And they have the same values, based on the error matrix.  Which classifier to choose? </p><br><h3 id="kto-zhe-luchshe">  Who is better? </h3><br><p>  It seems to me that this is a rather difficult question to which there is no universal answer.  However, my point of view in this case would look something like this: </p><br><p>  1. The classifier should be as simple in its technical implementation as possible.  Then he will have less risk of retraining (this is probably what happened with the MLP).  Therefore, it is not Random Forest, since this algorithm is an ensemble of 30 trees and, as a result, depends on them.  In tune with one of the ideas of Python Zen: simple is better than complex. </p><br><p>  2. Not bad when the algorithm was intuitive.  That is, KNeighbors is perceived as simpler than SVM with potential multidimensional space. <br>  Which in turn is similar to another statement: the explicit is better than the implicit. </p><br><p>  Therefore, KNeighbors with 3 neighbors, in my opinion, the best candidate. </p><br><p>  This is the end of the second part, which describes the use of Enron Dataset as an example of a classification task in machine learning.  Based on materials from the course Introduction to Machine Learning at Udacity.  There is also a <a href="https://github.com/VeeSot/Enron-Fraud-Identify/blob/master/enron.ipynb">python notebook</a> , reflecting the entire sequence of actions described. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/425607/">https://habr.com/ru/post/425607/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425597/index.html">‚ÄúTechnological‚Äù musical instruments before the 20th century: magnetic harpsichord and electromechanical piano</a></li>
<li><a href="../425599/index.html">How has the perception of space changed for 61 years</a></li>
<li><a href="../425601/index.html">Eliminate the bug in the 2000 Shockwave game</a></li>
<li><a href="../425603/index.html">Finding a career path</a></li>
<li><a href="../425605/index.html">Acceptance of payments from the card without jur. faces on Yandex.Money</a></li>
<li><a href="../425609/index.html">Game Theory: Decision Making with Kotlin Examples</a></li>
<li><a href="../425611/index.html">Upper-level architecture frontend. Yandex lecture</a></li>
<li><a href="../425613/index.html">How I combined the Tempo plug-in data for the Jira Server and the Jira Cloud and migrated it back to the Jira Cloud</a></li>
<li><a href="../425619/index.html">Multi-armed gang problem - compare epsilon-greedy strategy and Thompson sampling</a></li>
<li><a href="../425621/index.html">A company that recycles atmospheric carbon dioxide starts methane production.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>