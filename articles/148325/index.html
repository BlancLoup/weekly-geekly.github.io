<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Computational geometry, or how I became involved in Olympiad programming. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 This is the second part of my article devoted to computational geometry. I think this article will be more interesting than the previou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Computational geometry, or how I became involved in Olympiad programming. Part 2</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  This is the second part of my article devoted to computational geometry.  I think this article will be more interesting than the previous one, because the tasks will be a little more complicated. <br><br>  We begin with the relative position of a point with respect to a straight line, a ray, and a segment. <br><a name="habracut"></a><br><h5>  Task number 1 </h5><br>  Determine the relative position of the point and the line: it lies above the line, on the line, under the line. <br><br>  <b>Decision</b> <br>  It is clear that if the straight line is given by its equation ax + by + c = 0, then there is nothing to solve.  It is enough to substitute the coordinates of the point in the equation of the line and check what it is equal to.  If more than zero, then the point is in the upper half-plane, if it is equal to zero, then the point is on the straight line and if less than zero, then the point is in the lower half-plane.  More interesting is the case when the straight line is given, given by the coordinates of two points we call them P <sub>1</sub> (x <sub>1</sub> , y <sub>1</sub> ), P <sub>2</sub> (x <sub>2</sub> , y <sub>2</sub> ).  In this case, you can safely find the coefficients a, b and c and apply the previous argument.  But we must first think, we need it?  Of course not!  As I said oblique works - this is just the pearl of computational geometry.  Let's apply it.  It is known that the skew product of two vectors is positive, if the rotation from the first vector to the second goes counterclockwise, is zero, if the vectors are collinear and negative, if the rotation goes clockwise.  Therefore, it is enough for us to calculate the skew product of the vectors P <sub>1</sub> P <sub>2</sub> and P <sub>1</sub> M and make a conclusion based on its sign. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/cee/e99/665/ceee996653a1e1a581f2b4c256e9c259.png"><br><br><h5>  Problem number 2 </h5><br>  Determine whether the point belongs to the beam. <br><br>  <b>Decision</b> <br>  Let's remember what a ray is: a ray is a straight line bounded by a point on the one hand, and on the other hand infinite.  That is, the beam is defined by some starting point and any point lying on it.  Let the point P <sub>1</sub> (x <sub>1</sub> , y <sub>1</sub> ) be the beginning of the ray, and P <sub>2</sub> (x <sub>2</sub> , y <sub>2</sub> ) be any point belonging to the ray.  It is clear that if a point belongs to a ray, then it also belongs to the straight line passing through these points, but not vice versa.  Therefore, membership of a straight line is a necessary, but not sufficient condition for belonging to a ray.  Therefore, we can‚Äôt get away from checking the braid work.  For a sufficient condition, you also need to calculate the scalar product of the same vectors.  If it is less than zero, then the point does not belong to the ray, but if it is not negative, then the point lies on the ray.  Why is that?  Let's look at the drawing. <br><br><img src="https://habrastorage.org/storage2/935/8dc/0db/9358dc0db049e52873397e4da09c0d13.png"><br><br>  So, for the point M (x, y) to lie on the ray with the initial point P <sub>1</sub> (x <sub>1</sub> , y <sub>1</sub> ), where P <sub>2</sub> (x <sub>2</sub> , y <sub>2</sub> ) lies on the ray, it is necessary and two conditions are sufficient: <br>  1. [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M] = 0 - skew product (point lies on the line) <br>  2. (P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M) ‚â• 0 - scalar product (point lies on the ray) <br><br><h5>  Task number 3 </h5><br>  Determine whether the point belongs to the segment. <br><br>  <b>Decision</b> <br>  Let points P <sub>1</sub> (x <sub>1</sub> , y <sub>1</sub> ), P <sub>2</sub> (x <sub>2</sub> , y <sub>2</sub> ) be the ends of a given segment.  Again, a necessary condition for a point to belong to a segment is its membership of a straight line passing through P <sub>1</sub> , P <sub>2</sub> .  Next, we need to determine whether the point lies between the points P <sub>1</sub> and P <sub>2</sub> , for this we can use the scalar product of vectors only this time: (MP <sub>1</sub> , MP <sub>2</sub> ).  If it is less than or equal to zero, then the point lies on the segment, otherwise outside the segment.  Why is that?  Let's look at the picture. <br><br><img src="https://habrastorage.org/storage2/bfc/c9d/3fb/bfcc9d3fb6911771eddb730299f6d13f.png"><br><br>  So, for the point M (x, y) to lie on a segment with the ends P <sub>1</sub> (x <sub>1</sub> , y <sub>1</sub> ), P <sub>2</sub> (x <sub>2</sub> , y <sub>2</sub> ), it is necessary and sufficient that the following conditions be met: <br>  1. [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M] = 0 - skew product (point lies on the line) <br>  2. (MP <sub>1</sub> , MP <sub>2</sub> ) ‚â§ 0 - scalar product (the point lies between P <sub>1</sub> and P <sub>2</sub> ) <br><br><h5>  Task number 4 </h5><br>  The relative position of two points is relatively straight. <br><br>  <b>Decision</b> <br>  In this task it is necessary to determine on one or on opposite sides of a straight line there are two points. <br><br><img src="https://habrastorage.org/storage2/e5f/bde/6d1/e5fbde6d1ed9a3bcbc6c2a6ea4d89ce5.png"><br><br>  If the points are on opposite sides with respect to a straight line, then skew products have different signs, which means their product is negative.  If the points lie on the same side with respect to a straight line, then the signs of skew products coincide, which means that their product is positive. <br>  So: <br>  1. [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>1</sub> ] * [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>2</sub> ] &lt;0 - the points lie on opposite sides. <br>  2. [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>1</sub> ] * [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>2</sub> ]&gt; 0 - the points lie on one side. <br>  3. [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>1</sub> ] * [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>2</sub> ] = 0 - one (or two) of the points lie on the line. <br><br>  By the way, the problem of determining the presence of an intersection point of a straight line and a segment is solved in the same way.  More precisely, this is the same problem: the segment and the line intersect when the ends of the segment are on different sides with respect to a straight line or when the ends of the segment lie on a straight line, that is, you need to require [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>1</sub> ] * [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>2</sub> ] ‚â§ 0. <br><br><h5>  Problem number 5 </h5><br>  Determine whether two straight lines intersect. <br><br>  <b>Decision</b> <br>  We assume that the lines do not coincide.  It is clear that straight lines do not intersect, only if they are parallel.  Therefore, by finding the condition of parallelism, we can determine whether the lines intersect. <br>  Suppose the straight lines are given by their own equations a <sub>1</sub> x + b <sub>1</sub> y + c <sub>1</sub> = 0 and a <sub>2</sub> x + b <sub>2</sub> y + c <sub>2</sub> = 0. Then the condition of parallelism of the straight lines is that a <sub>1</sub> b <sub>2</sub> - a <sub>2</sub> b <sub>1</sub> = 0 <br>  If the straight lines are given by the points P <sub>1</sub> (x <sub>1</sub> , y <sub>1</sub> ), P <sub>2</sub> (x <sub>2</sub> , y <sub>2</sub> ), M <sub>1</sub> (x <sub>3</sub> , y <sub>3</sub> ), M <sub>2</sub> (x <sub>4</sub> , y <sub>4</sub> ), then the condition for their parallelism is in checks of the skew product of the vectors P <sub>1</sub> P <sub>2</sub> and M <sub>1</sub> M <sub>2</sub> : if it is zero, then the lines are parallel. <br><br><img src="https://habrastorage.org/storage2/83c/8b1/927/83c8b1927c0df4dd757e4ba263c12a16.png"><br><br>  In general, when the straight lines are given by their own equations, we also check the skew product of vectors (-b <sub>1</sub> , a <sub>1</sub> ), (-b <sub>2</sub> , a <sub>2</sub> ) which are called directing vectors. <br><br><h5>  Problem number 6 </h5><br>  Determine whether two segments intersect. <br><br>  <b>Decision</b> <br>  I really like this task.  The segments intersect when the ends of each segment lie on opposite sides of the other segment.  Let's look at the picture: <br><br><img src="https://habrastorage.org/storage2/a03/5b4/ffa/a035b4ffa74057e35428196b55a4154b.png"><br><br>  So, we need to check that the ends of each of the segments lie on opposite sides of the relative ends of the other segment.  We use the skew product of vectors.  Look at the first picture: [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>2</sub> ]&gt; 0, [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>1</sub> ] &lt;0 =&gt; [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>2</sub> ] * [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M <sub>1</sub> ] &lt;0. Similarly <br>  [M <sub>1</sub> M <sub>2</sub> , M <sub>1</sub> P <sub>1</sub> ] * [M <sub>1</sub> M <sub>2</sub> , M <sub>1</sub> P <sub>2</sub> ] &lt;0. You probably think why it is not less or equal.  And because the following case is possible, in which the vector product is just zero, but the segments do not intersect: <br><br><img src="http://habrastorage.org/storage2/b7d/062/6c5/b7d0626c5fbfad31dc46d162ad596a56.png"><br><br>  Therefore, we need to make another check, namely, whether at least one end of each segment belongs to the other (the point belongs to the segment).  We have already solved this problem. <br><br>  So, for the segments to have common points, it is necessary and sufficient: <br>  1. The ends of the segments are on different sides relative to another segment. <br>  2. At least one of the ends of one segment belongs to another segment. <br><br><h5>  Task number 7 </h5><br>  The distance from the point to the line. <br><br>  <b>Decision</b> <br>  Let a straight line be given by two points P <sub>1</sub> (x <sub>1</sub> , y <sub>1</sub> ) and P <sub>2</sub> (x <sub>2</sub> , y <sub>2</sub> ). <br><br><img src="https://habrastorage.org/storage2/cdf/5bf/ab5/cdf5bfab52390bd25092c1607b63a1a5.png"><br><br>  In the previous article, we talked about the fact that the geometrically skew product is an oriented area of ‚Äã‚Äãa parallelogram, therefore S <sub>P <sub>1</sub> P <sub>2</sub> M</sub> = 0.5 * [P <sub>1</sub> P <sub>2</sub> , P <sub>1</sub> M].  On the other hand, each schoolchild knows the formula for finding the area of ‚Äã‚Äãa triangle: half the base of the height. <br>  S <sub>P <sub>1</sub> P <sub>2</sub> M</sub> = 0.5 * h * P <sub>1</sub> P <sub>2</sub> . <br>  Equating these areas, we find <img src="https://habrastorage.org/storage2/435/659/5ae/4356595ae4d0224cbaef35459ea62976.png"><br><br>  Modulo taken because the first area is oriented. <br><br>  If the straight line is given by the equation ax + by + c = 0, then the equation of the straight line passing through the point M perpendicular to the given straight line is: a (y - y <sub>0</sub> ) - b (x - x <sub>0</sub> ) = 0. Now you can safely solve the system from the obtained equations, find their intersection point and calculate the distance from the source point to the found one: it will be exactly œÅ = (ax <sub>0</sub> + by <sub>0</sub> + c) / ‚àö (a <sup>2</sup> + b <sup>2</sup> ). <br><br><h5>  Problem number 8 </h5><br>  The distance from the point to the beam. <br><br>  <b>Decision</b> <br>  This task differs from the previous one in that it can happen in this case, so the perpendicular from the point does not fall on the ray, but falls on its continuation. <br><br><img src="https://habrastorage.org/storage2/774/a5c/98b/774a5c98baa023fdcc6da74ce11ff78b.png"><br><br>  In the case when the perpendicular does not fall on the beam, it is necessary to find the distance from the point to the beginning of the beam - this will be the answer to the problem. <br><br>  How to determine whether the perpendicular falls on the beam or not?  If the perpendicular does not fall on the beam, then the angle MP <sub>1</sub> P <sub>2</sub> is blunt or sharp (straight).  Therefore, by the sign of the scalar product of vectors, we can determine whether the perpendicular falls on a ray or not: <br>  1. (P <sub>1</sub> M, P <sub>1</sub> P <sub>2</sub> ) &lt;0 perpendicular does not fall on the ray <br>  2. (P <sub>1</sub> M, P <sub>1</sub> P <sub>2</sub> ) ‚â• 0 the perpendicular falls on the ray <br><br><h5>  Problem number 9 </h5><br>  The distance from the point to the segment. <br><br>  <b>Decision</b> <br>  We reason like the previous problem.  If the perpendicular does not fall on a segment, then the minimum of the distances from this point to the ends of the segment will be the answer. <br><br><img src="https://habrastorage.org/storage2/78c/831/fd4/78c831fd449fd24892fd36d41e339c76.png"><br><br>  To determine whether a perpendicular to a segment falls on, it is necessary, by analogy with the previous task, to use the scalar product of vectors.  If the perpendicular does not fall on a segment, then either the angle MP <sub>1</sub> P <sub>2</sub> or the angle MP <sub>2</sub> P <sub>1</sub> will be obtuse.  Therefore, the sign of the scalar products, we can determine whether the perpendicular falls on a segment or not: <br>  If (P <sub>1</sub> M, P <sub>1</sub> P <sub>2</sub> ) &lt;0 or (P <sub>2</sub> M, P <sub>2</sub> P <sub>1</sub> ) &lt;0, then the perpendicular does not fall on the segment. <br><br><h5>  Problem number 10 </h5><br>  Determine the number of points of a line and a circle. <br><br>  <b>Decision</b> <br>  A line and a circle can have zero, one or two points of intersection.  Let's look at the pictures: <br><br><img src="https://habrastorage.org/storage2/8d6/2c5/686/8d62c5686ffd78b8df71937859b4d9c8.png"><br><br>  Here from the pictures and so everything is clear.  We have two points of intersection if the distance from the center of the circle to the straight line is less than the radius of the circle.  One touch point if the distance from the center to the line is equal to the radius.  And finally, not a single point of intersection if the distance from the center of the circle to the straight line is greater than the radius of the circle.  Since the problem of finding the distance from a point to a straight line has already been solved by us, this problem has also been solved. <br><br><h5>  Problem number 11 </h5><br>  Mutual arrangement of two circles. <br><br>  <b>Decision</b> <br>  Possible cases of the location of the circles: intersect, touch, do not intersect. <br><br><img src="https://habrastorage.org/storage2/414/a66/e19/414a66e19f3578abe8ebc4b9d6e3ce65.png"><br><br>  Consider the case when the circles intersect, and find the area of ‚Äã‚Äãtheir intersection.  I love this task very much, as I spent a fair amount of time on solving it (it was a long time ago - in the first year). <br><br><img src="https://habrastorage.org/storage2/ebb/1a5/495/ebb1a5495c753386d89d68b6bdeb75df.png"><br><img src="https://habrastorage.org/storage2/d95/593/6a9/d955936a93747b932b1acd37b71aee56.png"><br>  Recall now what a sector and a segment are. <br><img src="https://habrastorage.org/storage2/fe0/967/db5/fe0967db591e171e0cc270d48af1aedc.png"><br><br>  The intersection of circles consists of two segments O <sub>1</sub> AB and O <sub>2</sub> AB. <br><br><img src="https://habrastorage.org/storage2/8a2/281/454/8a2281454cdcf252647cdb86ab299f34.png"><br><br>  It would seem necessary to add the area of ‚Äã‚Äãthese segments and all.  However, things are not so simple.  It is also necessary to determine whether these formulas are always correct.  It turns out no! <br><br>  Consider the case when the center of the second circle O <sub>2</sub> coincides with point C. In this case, d <sub>2</sub> = 0 and for Œ± we take Œ± = œÄ.  In this case, we have a semicircle with an area of ‚Äã‚Äã1/2 œÄR <sub>2</sub> <sup>2</sup> . <br><br>  Now consider the case when the center of the second circle O <sub>2</sub> is between points O <sub>1</sub> and C. In this case, we obtain a negative value of d <sub>2</sub> .  The use of a negative d <sub>2</sub> value leads to a negative Œ± value.  In this case, it is necessary for the correct answer to be added to Œ± 2œÄ. <br><img src="https://habrastorage.org/storage2/207/504/772/207504772ba6bea952742983e70c4c92.png"><br><br><h5>  Conclusion </h5>  Well that's all.  We considered not all, but the most frequently encountered problems of computational geometry concerning the relative position of objects. <br><br>  Hope you enjoyed it. </div><p>Source: <a href="https://habr.com/ru/post/148325/">https://habr.com/ru/post/148325/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148317/index.html">Defending against spam with IronPort c170</a></li>
<li><a href="../148318/index.html">Auto-Renewable Subscription in iOS: proper implementation and pitfalls</a></li>
<li><a href="../148319/index.html">Recognition of numbers by 4 points</a></li>
<li><a href="../148323/index.html">Bot for browser Angry Pets</a></li>
<li><a href="../148324/index.html">Sublime Text 2: How to create a snippet?</a></li>
<li><a href="../148326/index.html">The practice of using digital filters</a></li>
<li><a href="../148327/index.html">‚ÄúDiv‚Äù blocks of the same height</a></li>
<li><a href="../148329/index.html">What have you spent your best karma on?</a></li>
<li><a href="../148331/index.html">Remote wipe on Android and Exchange ActiveSync</a></li>
<li><a href="../148332/index.html">Create a feedback form using Google Forms</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>