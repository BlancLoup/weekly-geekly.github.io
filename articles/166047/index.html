<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Developing iOS Ruby Applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, RubyMotion has become an increasingly popular tool for developing for iOS. After a close acquaintance with him, it becomes clear why Ruby is...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Developing iOS Ruby Applications</h1><div class="post__text post__text-html js-mediator-article">  Recently, RubyMotion has become an increasingly popular tool for developing for iOS.  After a close acquaintance with him, it becomes clear why Ruby is a much more attractive language for this purpose than Objective-C. <br><img src="https://habrastorage.org/storage2/361/25b/a05/36125ba05da5414db1c08f1da2ab11ba.png"><br><a name="habracut"></a><br><h4>  Introduction </h4><br><h5>  Is it Ruby or not? </h5><br>  RubyMotion is a ruby <a href="http://www.rubymotion.com/developer-center/guides/getting-started/">language</a> iOS development <i>toolkit</i> .  It consists of a <a href="http://www.rubymotion.com/developer-center/guides/runtime/">runtime environment</a> that implements Ruby functionality within iOS.  Although the scope of this ruby ‚Äã‚Äãcode is different from <a href="http://www.ruby-lang.org/en/">CRuby</a> , the implementation is based on the specifications of Ruby 1.9. <br><br>  Knowledge of Ruby does not guarantee that you can write iOS applications, but it definitely will not be superfluous.  To work with RubyMotion, it‚Äôs much more important to be familiar with the Objective-C and Foundation Framework APIs.  In essence, RubyMotion "codifies" Objective-C. <br><br><h5>  Project work </h5><br>  To work with RubyMotion, it is not necessary to use XCode, you can use your favorite editor.  Together with RubyMotion comes a <a href="http://www.rubymotion.com/developer-center/guides/project-management/">console tool</a> ( <code>motion</code> ) that helps you create and customize a folder with a project. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It also has a set of rake tasks that will help you build a project and run it in the iOS simulator.  It can recognize resources, such as images or pfile, as well as connect and use .xib, .storyboard and .xcdatamodeld files. <br><br><h5>  Where to begin? </h5><br>  If you can‚Äôt wait to start work, you will have to <a href="http://sites.fastspring.com/hipbyte/product/rubymotion">buy a license</a> ( <i>at the moment it costs $ 199, the website also shows the amount in rubles according to the curved exchange rate</i> ), since  This is a proprietary software.  After that, there is no harm in going through the <a href="http://www.rubymotion.com/developer-center/guides/getting-started">Getting Started Guide</a> on the RubyMotion site. <br><br>  An <a href="http://motioncasts.tv/get-moving-with-rubymotion/">introductory screencast</a> from the Motion Casts site will also be useful.  And there is a <a href="http://pragmaticstudio.com/screencasts/rubymotion">50-minute screencast</a> from Pragmatic Studio, which will tell you how to create a simple application.  This <a href="http://www.rubymotion-tutorial.com/">tutorial is</a> also good. <br><br><h4>  Simple application </h4><br>  We figured out what RubyMotion is and how it can be useful, so let's work on our first application. <br><br>  Since I could not find any ready more or less complex example, I offer you my own crafts.  Sources <a href="https://www.github.com/mariochavez/conference">are attached</a> . <br><br><h5>  Our application </h5><br>  Let's pretend that we are doing the applique for the conference.  For this, I will use the schedule <a href="http://magmarails.com/">MagmaRails 2012</a> .  The amount of information displayed is limited to the speakers and their speeches, divided by day. <br><br><h5>  Our interface </h5><br>  All resources on the RubyMotion developer site show how to build an interface using code, there are even some DSLs specially created for building user interfaces for iOS.  But instead, we will use Xcode Storyboard, which will help us build a model for navigating the application. <br><br>  Storyboards are tied to Xcode, and I previously promised that we will be able to develop applications without the need for it, but in this case we will use it simply because Storyboards are a very convenient visualization tool. <br><br><h5>  Preparing a project </h5><br>  The first step we will take is to create a new XCode project - it is assumed that you will use XCode 4.5.x for this - based on the Master-Detail Application, so give it a name, and also make sure that iPhone is selected in the Devices field. The checkboxes ‚ÄúUse StoryBoard‚Äù and ‚ÄúUse Core Data‚Äù are checked. <br><br><img src="https://habrastorage.org/storage2/59f/6fd/e09/59f6fde09054c1853c522c09edb797ac.png"><br><br>  Now let's create a project in RubyMotion and call it ‚Äúconference‚Äù: <br><br><pre> <code class="bash hljs">$ motion create conference</code> </pre><br>  Inside the structure of our RubyMotion project, there is a resources folder, into which you need to copy the <code>MainStoryboard.storyboard</code> file, which was created by XCode.  Copy the file and then remove the link to it from XCode. <br><br><img src="https://habrastorage.org/storage2/131/658/d98/131658d98b3617826f1735994312c8f2.png"><br><br>  Since we still want to be able to edit this file in XCode, you need to drag it from our daddy to the XCode interface.  We will be asked how exactly we want to do this.  Make sure that the <code>Copy items into destination group's folder (if needed)</code> unchecked, and then click Finish.  So we created a symlink to our file, and all changes inside Xcode will be automatically reflected in the project. <br><br><img src="https://habrastorage.org/storage2/b49/bbc/cdc/b49bbccdc119050cf3d75104b383d7ad.png"><br><br>  Now let's configure the Bundler: <br><br><pre> <code class="bash hljs">$ bundle init</code> </pre><br>  Edit the gemfile as follows: <br><br><pre> <code class="ruby hljs">source <span class="hljs-symbol"><span class="hljs-symbol">:rubygems</span></span> gem <span class="hljs-string"><span class="hljs-string">'xcodeproj'</span></span>, <span class="hljs-string"><span class="hljs-string">'~&gt; 0.3.0'</span></span> gem <span class="hljs-string"><span class="hljs-string">'ib'</span></span> gem <span class="hljs-string"><span class="hljs-string">'rake'</span></span></code> </pre><br>  Run the Bundler: <br><br><pre> <code class="bash hljs">$ bundle</code> </pre><br>  The <a href="https://github.com/CocoaPods/Xcodeproj">xmesproj</a> and <a href="https://github.com/yury/ib">ib</a> <a href="https://github.com/CocoaPods/Xcodeproj">gems</a> will help connect the Ruby Outlets with the Xcode Storyboards, which we will use later. <br><br>  Now we‚Äôll correct Rakefile and add, after the line, <code>require "motion/project"</code> code that connects the Bundler to the project: <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'rubygems'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'ib'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'bundler'</span></span> Bundler.<span class="hljs-keyword"><span class="hljs-keyword">require</span></span></code> </pre><br>  Find <code>app_delegate.rb</code> and open it in your favorite editor.  Inside it, the <code>application</code> method is declared, which is the entry point of our application.  Now we tell RubyMotion to download the <code>MainStoryboard.storyboard</code> : <br><br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(application, </span></span><span class="hljs-symbol"><span class="hljs-function"><span class="hljs-params"><span class="hljs-symbol">didFinishLaunchingWithOptions:</span></span></span></span><span class="hljs-function"><span class="hljs-params">launchOptions)</span></span></span></span> @window = UIWindow.alloc.initWithFrame(UIScreen.mainScreen.bounds) @storyboard <span class="hljs-params"><span class="hljs-params">||</span></span>= UIStoryboard.storyboardWithName(<span class="hljs-string"><span class="hljs-string">'MainStoryboard'</span></span>, <span class="hljs-symbol"><span class="hljs-symbol">bundle:</span></span>NSBundle.mainBundle) @window.rootViewController = @storyboard.instantiateInitialViewController @window.rootViewController.wantsFullScreenLayout = <span class="hljs-literal"><span class="hljs-literal">true</span></span> @window.makeKeyAndVisible <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  We initialize the screen frame, load the Storyboard, set the main Storyboard controller as our <code>rootViewController</code> and make our screen visible. <br><br>  To test, run: <br><br><pre> <code class="bash hljs">$ rake</code> </pre><br>  This command will compile our project in the iOS application, load it into the simulator and launch it.  If everything went well, you will see an empty grid.  To close an application, type <code>quit</code> in the console. <br><br><img src="https://habrastorage.org/storage2/579/dc6/946/579dc69461a82d7b6782291708890dcd.png"><br><br><h5>  Create a Storyboard </h5><br>  Going back to Xcode, let's open the <code>MainStoryboard.storyboard</code> file. <br><br><img src="https://habrastorage.org/storage2/983/9d8/827/9839d882728563d3bbe3a4d0d8bc2276.png"><br><br>  Select <code>Master View Controller</code> and double click on the title to change it to <code>MagmaRails</code> .  Now select the <code>Table View</code> and change the value of the <code>Content</code> property from <code>Dynamic</code> to <code>Static</code> .  The label should now have three rows of cells.  You need to select the first one and make two copies of it.  Change the title of each of them - double-click - to "Day One", "Day Two", "Day Three", "Speakers" and "Venue".  Click on the transition connecting the Master View Controller and the Detail View Controller to remove it. <br><br><img src="https://habrastorage.org/storage2/f7c/0d1/a3c/f7c0d1a3cfdc3151e3e7be4b22e8496e.png"><br><br>  We need another View Controller to display conferences by day, so let's drag it from the Objects Library directly to the canvas.  Drag the table view to this new controller, and the table-view cell in the table view. <br><br>  Using identity inspector, rename the controller to <code>TalksViewController</code> .  In the attribute inspector, change the identifier of our new cell to Talk, and from the identity inspector, change the class of the cell to TalkViewCell.  Also, make sure that our cell style is custom and change its height to 115. <br><br>  Add in the cell 3 labels and a picture that will display the information we need.  Once done, drag the cursor while holding the <code>ctrl</code> key from the Day One cell on the Master View Controller to the new TalksViewController to create the transition.  As the type of transition you need to select <code>push</code> , and as the name - <code>DayOne</code> .  Do the same for cells with the second and third day. <br><br><img src="https://habrastorage.org/storage2/f6d/601/d3c/f6d601d3c63881383f787a6b24ada628.png"><br><br><h5>  Core Data models and application seed </h5><br>  Before we continue, let's create the <a href="http://developer.apple.com/library/mac/">Core Data</a> models as well as the basic information sid. <br><br>  When we created the project in Xcode, the Use Core Data option was checked.  This means that together with our project an <code>.xcdatamodeld</code> file was created.  Find this file in Xcode and right click on it.  Navigate to it using Show File in Finder, move it to the resources folder of our application and remove the link to the file in Xcode, then drag it back, but from our folder. <br><br>  In Xcode, open Core Data Models and add two new entities, Talk and Presenter.  For Talk, add the attributes as shown in the image and verify with the Data Model Inspector that the Class is called Talk.  Repeat the same for Presenter. <br><br><img src="https://habrastorage.org/storage2/813/3e8/0ef/8133e80ef5c6626053640b234b9f368c.png"><br><img src="https://habrastorage.org/storage2/bf0/57e/529/bf057e529e3ce0d60be1efaed877a33c.png"><br><br>  Save the file.  Now we are ready to create Models inside RubyMotion. <br><br>  Let's connect two gems.  The first, <a href="https://github.com/HipByte/motion-cocoapods">motion-cocoapods</a> , will allow us to manage dependencies through <a href="http://cocoapods.org/">CocoaPods</a> , the dependency manager for Objective-C.  Yes, this means that even if we write code in Ruby, we can still freely use Objective-C libraries. <br><br>  The library we will use is called <a href="https://github.com/magicalpanda/MagicalRecord">MagicalRecord</a> .  It will allow us to work easily with Core Data. <br><br>  The second gem is called <a href="https://github.com/hookercookerman/motion_support">motion_support</a> .  It provides us with functionality similar to ActionSupport in Ruby on Rails (declensions and some kernel extensions), but with its own specifics.  Add these gems to the Gemfile and run the Bundler. <br><br><pre> <code class="ruby hljs">gem <span class="hljs-string"><span class="hljs-string">'motion-cocoapods'</span></span> gem <span class="hljs-string"><span class="hljs-string">'motion_support'</span></span></code> </pre><br>  To make both hemes available, open your Rackfile and add two lines to it immediately below the mention of rubygems. <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'motion-cocoapods'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'motion_support/all'</span></span></code> </pre><br>  We also need to tell RubyMotion that we want to use the Core Data framework and connect the MagicalRecord from cocoapods.  For these purposes, we will force RubyMotion to load files into <code>app/lib</code> before the rest, so let's fix app.files. <br><br>  Add to the end of the Motion :: Project :: App.setup block: <br><br><pre> <code class="ruby hljs">app.frameworks += <span class="hljs-string"><span class="hljs-string">%w(CoreData)</span></span> app.files.unshift Dir.glob(File.join(app.project_dir, <span class="hljs-string"><span class="hljs-string">'app/lib/**/*.rb'</span></span>)) app.pods <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> pod <span class="hljs-string"><span class="hljs-string">'MagicalRecord'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  After these changes, you need to install motion-cocoapods: <br><br><pre> <code class="bash hljs">$ pod setup $ rake UPDATE=1</code> </pre><br>  These two lines will configure cocoapods and install the Objective-C libraries we specified in the Rakefile. <br><br>  After all this, you can start using Core Data. <br><br>  You need to create a class for each model that we described in the Core Data digram.  Create a model directory inside the app, and in it the <code>Talk.rb</code> and <code>Presenter.rb</code> files: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Talk</span></span></span><span class="hljs-class"> &lt; NSManagedObject </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Presenter</span></span></span><span class="hljs-class"> &lt; NSManagedObject </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  In order for our models to behave like Core Data entities, you need to declare a couple of methods.  It is important to note that we do not need to declare any properties for storing data and relationships in the model.  These methods were declared for us during the configuration of the Core Data chart. <br><br>  Our models will need methods to fill themselves with data from hashes, as well as a couple of finders.  For this we need <code>MagicalRecord</code> . <br><br>  Also, inside the <code>app_delegate.rb</code> file <code>app_delegate.rb</code> we will need a method for filling the database for the first time.  This method will be called when the application starts.  Seed data is stored in a plist file, which is transformed into a hash, and then used to populate our models and save them to the database. <br><br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seedDatabase</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MagicalRecord</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupCoreDataStackWithStoreNamed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'database.sqlite'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> Talk.allTalks.size == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-comment"><span class="hljs-comment">#https://github.com/Bodacious/PListReadWrite PListRW.copyPlistFileFromBundle(:seed) seed = PListRW.plistObject(:seed, Hash) presenters = [] seed['presenters'].each do |presenter_attrs| presenters &lt;&lt; Presenter.createWithHash(presenter_attrs) end seed['talks'].each do |talk_attrs| talk = Talk.createWithHash(talk_attrs) presenter = presenters.select{|p| p.presenterId == talk.presenterId }.first talk.presenter = presenter talk.save presenter.addTalk(talk) presenter.save end end end</span></span></code> </pre><br><h5>  We work on controllers </h5><br>  Earlier we linked three MasterViewController and TalksViewController transitions, one for each conference day. <br><br>  Since all 3 transitions point to the same controller, we need to use identifiers so that the TalksViewController understands which day is being discussed. <br><br>  Create a <code>masterviewcontroller.rb</code> file inside the <code>app/controllers</code> and add the <code>prepareForSegue</code> method in it: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MasterViewController</span></span></span><span class="hljs-class"> &lt; UITableViewController </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">prepareForSegue</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">segue</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sender</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sender</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">case</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">segue</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">identifier</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">when</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DayOne</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DayTwo</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DayThree</span></span></span><span class="hljs-class">' </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">segue</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">destinationViewController</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">setFilter</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">segue</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">identifier</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  The <code>destinationViewController</code> property refers to the target controller, in our case <code>TalksViewController</code> , and it is assumed that we have a criterion by which we can filter the performances. <br><br>  So let's create our <code>TalksViewController</code> .  This controller will be the delegator of TableUIView, therefore we need to add two more methods: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TalksViewController</span></span></span><span class="hljs-class"> &lt; UIViewController </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">filter</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dataSource</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tableView</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tv</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">numberOfRowsInSection</span></span></span><span class="hljs-class">:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">section</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dataSource</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">count</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tableView</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tv</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cellForRowAtIndexPath</span></span></span><span class="hljs-class">:</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">indexPath</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reuseIdentifier</span></span></span><span class="hljs-class"> ||= '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TalkCell</span></span></span><span class="hljs-class">' </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cell</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">tv</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dequeueReusableCellWithIdentifier</span></span></span><span class="hljs-class">(@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reuseIdentifier</span></span></span><span class="hljs-class">) || </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">begin</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TalkCell</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alloc</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initWithStyle</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UITableViewCellStyleDefault</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reuseIdentifier</span></span></span><span class="hljs-class">:@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reuseIdentifier</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">talk</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">self</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">dataSource</span></span></span><span class="hljs-class">[</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">indexPath</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">row</span></span></span><span class="hljs-class">] </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment"># We will come back to this a bit later end def viewDidLoad day = case filter when 'DayOne' then 1 when 'DayTwo' then 2 when 'DayThree' then 3 end self.dataSource = Talk.talksByDay(day) end end</span></span></span></span></code> </pre><br>  In the <code>viewDidLoad</code> method, based on the value of the filter passed to <code>prepareSegue</code> , we select suitable reports from the database and save them in the <code>dataSource</code> property. <br><br>  The <code>tableView(tv, numberOfRowsInSection:section)</code> method <code>tableView(tv, numberOfRowsInSection:section)</code> needs to know how many rows we want to display in the table, and we simply know this information from the <code>datasource</code> . <br><br>  <code>tableView(tv, cellForRowAtIndexPath:indexPath)</code> somewhat more confusing, this method is called every time a row is displayed on the screen, and we need to pass a cell object here with all the relevant data.  If we have dozens or hundreds of records, this can lead to unwanted memory waste.  Therefore, the framework stores a pool of previously instantiated cells, and instead of creating a new cell each time, it takes the old one from the pool and reuses it.  Due to this, the number of objects in the memory is always small.  It uses cells in accordance with the identifier, and if not available at the moment, it creates a new one. <br><br>  In the case of our Storyboard, we created a custom cell for information about the report, and also added TalkCell as an identifier that has several labels and a picture.  So let's create a new <code>TalkViewCell</code> class inside <code>/app/cells/talkviewcell.rb</code> : <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TalkViewCell</span></span></span><span class="hljs-class"> &lt; UITableViewCell </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  The next step is to create IB Outlets that will allow us to connect our code with Storyboard labels and pictures, in which gem ib will help us: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TalkViewCell</span></span></span><span class="hljs-class"> &lt; UITableViewCell </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">extend</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IB</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">outlet</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">talk</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UILabel</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">outlet</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">speaker</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UILabel</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">outlet</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">day</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UILabel</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">outlet</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">picture</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIImageView</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre><br>  Once our outlets are in place, they need to be connected at Storyboard.  If you have Xcode open, close it and run the following command (provided by ib): <br><br><pre> <code class="ruby hljs">$ rake <span class="hljs-symbol"><span class="hljs-symbol">ib:</span></span>open</code> </pre><br>  This will open a fake ib Xcode project, which you can immediately close.  Open Storyboard in Xcode and select TalkViewCell, then click on the connections inspector.  You should see all the outlets we announce, connected to each other. <br><br>  Drag the outlet onto the canvas by pulling the circle to the right of its name and save the Storyboard. <br><br><img src="http://habrastorage.org/storage2/367/a8e/8b8/367a8e8b86fbde17e8a103d46367677f.png"><br><br>  Open the TalkViewCell class again and add the following method that will be used to set the contents of the cell: <br><br><pre> <code class="ruby hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setupTalk</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(talk)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.talk.text = talk.title <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.speaker.text = talk.presenter.name <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.picture.image = UIImage.imageNamed(talk.presenter.picture) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.day.text = <span class="hljs-string"><span class="hljs-string">"Day </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{talk.day}</span></span></span><span class="hljs-string">, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{talk.time}</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  Now go back to TalksViewController, and replace the comment <code>"# We will come back to this a bit later"</code> at the bottom of the <code>tableView(tv, cellForRowAtIndexPath:indexPath)</code> with the following code: <br><br><pre> <code class="ruby hljs">cell.setupTalk(talk) cell</code> </pre><br>  Run the simulator: <br><br><pre> <code class="bash hljs">rake</code> </pre><br>  It should turn out as in the screenshot. <br><br><img src="http://habrastorage.org/storage2/dea/603/619/dea603619401330fd4e1cf8adf5b6d58.png"><br><br>  When you click on Day Two, you will receive a list of all performances for that day: <br><br><img src="http://habrastorage.org/storage2/a9a/726/573/a9a7265731f144b5e8ce3607d78686c7.png"><br><br><h4>  Finally </h4><br>  You are reading these lines, which means that you have managed to build an iPhone application.  It uses: <br><br><ul><li>  Bundler and gems created specifically for RubyMotion </li><li>  Blend of Cocoapods and Objective-C Libraries </li><li>  XCode charts Core Data and local sqlite database </li><li>  Xcode Interface Builder with Ruby Code </li></ul><br>  If you want to play with the code from this post, then welcome to the <a href="https://github.com/mariochavez/conference">repository</a> . <br><br>  RubyMotion makes iOS development a pleasure. <br><br><h4>  Additional Information </h4><br><ul><li>  <a href="http://www.rubymotion.com/developer-center/api/index.html">RubyMotion API Reference</a> </li><li>  <a href="http://merbist.com/2012/05/04/macruby-on-ios-rubymotion-review/">MacRuby on iOS - RubyMotion Review</a> </li><li>  <a href="http://www.confreaks.com/videos/1303-rubyconf2012-rubymotion-for-faster-client-server-development">RubyMotion for Quick Client / Server Development</a> </li></ul><br><br><h4>  From translator </h4><br>  If you started to go through the tutorial and found any inaccuracies or errors, I will be grateful if you write me about this in PM. <br><br>  RubyMotion is really gaining momentum, although many people with whom I spoke are skeptical about it.  Yes, it is expensive, but damp.  But if you use Ruby in your daily development, you should understand the speed with which projects are usually developed thanks to the community. <br><br>  I bought myself a license, and in the near future I am going to sort out the question somewhat deeper.  From myself I can add a number of interesting links: <br><br><ul><li>  <a href="http://learn.thoughtbot.com/podcast/29">Launch of the Giant Robots podcast Smashing into the Other Giant Robots with iOS developers of thoughtbot</a> </li><li>  <a href="http://www.rubymotion.com/conference/">#inspect 2013 is the first RubyMotion conference.</a>  <a href="http://www.rubymotion.com/conference/">Will be held in Brussels April 25-29.</a> </li><li>  <a href="http://habrahabr.ru/post/143332/">Habrapevod "RubyMotion: native iOS applications on Ruby".</a>  <a href="http://habrahabr.ru/post/143332/">Felling in the comments is required to read.</a> </li><li>  <a href="http://blog.rubymotion.com/">Blog RubyMotion.</a> </li><li>  <a href="https://twitter.com/rubymotion">Twitter RubyMotion - generally a treasury.</a> </li><li>  <a href="http://tryios.codeschool.com/">Course Codeschool "Try iOS".</a>  <a href="http://tryios.codeschool.com/">Great start if you have never communicated with Objective-C.</a> </li><li>  <a href="http://blog.rubymotion.com/post/34235901509/rubymine-gets-rubymotion-support">RubyMotion support in RubyMine IDE.</a> </li><li>  <a href="http://pragprog.com/book/carubym/rubymotion">Come to the book, piping hot.</a> </li><li>  <a href="https://www.google.ru/">A fairly comprehensive source of other information on the subject.</a> </li><li>  <a href="https://groups.google.com/forum/%3Ffromgroups">Google group rubymotion</a> </li></ul><br><br>  Enjoy the development, make good applications and see you soon.  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/166047/">https://habr.com/ru/post/166047/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../166037/index.html">Aruba OS 6.1 and Split Tunnel on RAP 5</a></li>
<li><a href="../166039/index.html">11 important things you need to know about DevOps - part one</a></li>
<li><a href="../166041/index.html">From the airport in Mallorca to the House of Rock in Los Angeles: where software is used for smart homes iRidium</a></li>
<li><a href="../166043/index.html">jsiedit: idea and creation of a convenient WYSIWYM plug-in editor with an example for Habrahabr</a></li>
<li><a href="../166045/index.html">Introduction to NikaFramework (NKF). Part 1</a></li>
<li><a href="../166049/index.html">Navigation in the new version of the Moscow metro scheme for people with impaired color perception</a></li>
<li><a href="../166051/index.html">AnnotatedSQL: schema + content provider</a></li>
<li><a href="../166053/index.html">Localization and globalization</a></li>
<li><a href="../166055/index.html">PicUntu: Ubuntu for a mini PC based on Rockchip RK3066</a></li>
<li><a href="../166057/index.html">The first game I just wrote for myself</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>