<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AWS in Down: Why the skies collapsed</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="April 21 at 01:41 Pacific time, there was a serious failure in one of the data centers of Amazon Web Services, the "cloud" for many sites. Some major ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AWS in Down: Why the skies collapsed</h1><div class="post__text post__text-html js-mediator-article">  April 21 at 01:41 Pacific time, there was a serious failure in one of the data centers of Amazon Web Services, the "cloud" for many sites.  Some major projects (Reddit, Quora, Foursquare) went offline or badly hit.  I have already seen a bunch of misinformation with a hint that the problems of the affected sites are associated only with the laziness of the engineers of these projects, but in this case the reason is different.  And that's why. <br><br>  AWS has two accessibility concepts: Regions and Availability Zones (AZ).  There are five regions: two in the USA (the west and east coasts), one in Europe (Ireland) and two in Asia (Tokyo, Singapore).  There are several AZ in each region, which should be isolated from each other and not have a common point of failure, except for a natural disaster or something of a similar scale. <br><a name="habracut"></a><br>  AWS says that by ‚Äúputting instances in separate AZs, you can protect your applications from crashing in some particular place.‚Äù  By "place" they mean " <a href="http://aws.amazon.com/ec2/faqs/">physical independence</a> of accessibility from each other and independent infrastructure."  Apparently, these are separate data centers ( <i>although, from the description of Amazon, this is not obvious - maybe these are different floors / rooms in a data center with independent power supply and connection via different channels - approx. Lane</i> ).  They should not collapse simultaneously with each other, unless a catastrophe happened that covered the entire region. <br><br>  Availability zones also offer ‚Äúlow-cost, low-latency connectivity between availability zones in the same region.‚Äù  Interregional connection, on the other hand, goes through an open Internet connection, and is relatively expensive, slow and unreliable. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      These are the "rules of the game."  So if you play according to AWS rules and set up a master / slave MySQL database (to take the most common example), then, logically, you should put master and slave in the same region, but make sure they are in different zones availability.  You will not place them in different regions, otherwise you will have to drive traffic over slow and expensive channels between regions, and most likely you will have more problems with synchronizing databases.  You risk only if, for example, a hurricane hits the east coast and destroys the data center (s), but with the exception of this, everything should be in order - at least if the AWS promises are kept. <br><br>  So, in the end, we have a problem.  Yesterday several zones were inaccessible in the east coast region.  AWS violated its own promises for crash scenarios in availability zones.  This means that AWS has a certain common point of failure (assuming that some absolutely incredible scenario did not happen, such as the simultaneous physical damage of several independent infrastructures).  Sites that are still down are quite correct in fulfilling their ‚Äúrules of the game‚Äù conditions; the problem is that AWS did not follow its own specifications.  It happened because of incompetence or dishonesty, or something more forgivable, we just do not know at the moment.  But the developers at Quora, Foursquare and Reddit are very competent and it will be wrong to send accusations towards them. <br><br>  Of course, it is theoretically possible to protect even from catastrophic failures (several availability zones), but for most businesses these additional development costs and costs are not worth it (or may even be counterproductive, complicating the system).  I am sure that all sites that are now in Down have backups.  The problem is that their return to online can become difficult and risky - in practice, you need to move everything to another region, otherwise the network delay between your servers will be too big.  On AWS, this is extremely difficult: on servers in different regions - a different set of options, different AMI identifiers, I think that reserved instances cannot be moved between data centers at all - in reality, transferring control to another region is almost impossible.  Probably, it takes about as much effort as migrating to a completely different cloud, which is probably the best option for recovery after such a disaster.  As far as we know, Quora started this process the very minute that the AWS crashed, and has not completed it so far - this can take a day. <br><br>  So, in short, the blame here is exclusively AWS, which ‚Äúguaranteed‚Äù the conditions that it violated.  Errors happen, but here is the AWS error. <br><br>  And this is not a cloud hosting error as such.  This case shows that you need to carefully select the provider.  I think many people will reconsider their choice in favor of AWS. <br><br>  A few more thoughts: <br><ul><li>  The reason why so many sites are located in the east coast region is that it is here that AWS is first of all rolling out new features.  It is also the cheapest.  And this is probably the best traffic service region (normal performance for North America, tolerable performance for Europe) </li><li>  The cause of the failure was actually the <a href="http://aws.amazon.com/ebs/">EBS</a> (Elastic Block Store) disk arrays, which were disastrous in terms of reliability from the very beginning of their use.  But this is a topic for a completely different article! </li><li>  EBS arrays can only be in one availability zone and access to them can only be from this zone.  Apparently, the Amazon RDS distributed database uses secret APIs that allow access to EBS from other zones, but these interfaces are not accessible to anyone other than RDS (hmm ... a Seattle company that uses secret APIs to gain a competitive advantage - it sounds like is that familiar?) </li></ul></div><p>Source: <a href="https://habr.com/ru/post/118001/">https://habr.com/ru/post/118001/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../117994/index.html">Foreign experience in St. Petersburg startups</a></li>
<li><a href="../117996/index.html">Top C ++ Interview Questions and Answers</a></li>
<li><a href="../117997/index.html">Widget with unread message counter</a></li>
<li><a href="../117998/index.html">Beginning parallel programming contest Threading Challenge</a></li>
<li><a href="../118000/index.html">Two gifts on the DR ZX-Spectrum</a></li>
<li><a href="../118002/index.html">Principles of design of payment pages for online stores</a></li>
<li><a href="../118003/index.html">Introduction to the Apache log4cxx logging library</a></li>
<li><a href="../118005/index.html">Android phone is also watching ...</a></li>
<li><a href="../118010/index.html">Translation of the article ‚ÄúPimp My Pimpl‚Äù, part 1</a></li>
<li><a href="../118011/index.html">Silex - microfreemv from the creators of symfony2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>