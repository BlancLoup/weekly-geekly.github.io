<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>syslog-ng + MySQL + Net Source</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The task: To raise the syslog server, with the storage of logs in the SQL database and make it possible 
 dump logs from other clients of routers for ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>syslog-ng + MySQL + Net Source</h1><div class="post__text post__text-html js-mediator-article"> The task: To raise the syslog server, with the storage of logs in the SQL database and make it possible <br>  dump logs from other clients of <em>routers for example</em> <br><br>  What you need: unix like OS (although this can be done even on Windows-based OS), syslog-ng, MySQL and the notion of what this fig is for. <br><br>  I'll warn you right away, everything happens in the environment of gentoo linux.  And go in steps. <br><a name="habracut"></a><br>  <em>syslog-ng</em> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Installing this miracle, just do not forget to add a couple of yuz <br> <code>user$ echo "app-admin/syslog-ng sql tcpd"|sudo tee -a /etc/portage/packages.use <br> user$ emerge -av app-admin/syslog-ng</code> <br> <br>  Everything is super, then edit the config <em>/etc/syslog-ng/syslog-ng.conf</em> and that <br>  It turned out that something similar to mine: <br><br><ol><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li><li> <code><font color="black">options { <br> ## general settings <br> time_reopen(10); # Reopen a dead connection after this many seconds <br> time_reap(120); # Close an idle destination file after this many seconds <br> time_sleep(5); # Wait these many milliseconds between poll iterations <br> ts_format(rfc3164); # Timestamp format: rfc3164|rfc3339|bsd|iso <br> log_fifo_size(1000); # Output queue size <br> log_msg_size(8192); # Max size of a single message <br> log_fetch_limit(1000); # The maximum number of messages fetched from a source during a single poll loop. <br> flush_lines(10); # Buffer this many lines of output (0 to send to disk immediately) <br> flush_timeout(1000); # Wait at most this many milliseconds before forcibly flushing the output buffer <br> mark_freq(300); # MARK line logging interval <br> stats_freq(0); # Stats logging interval (0 = disabled) <br> ## remote logging <br> normalize_hostnames(yes); # Do normalize hostnames (transform to lower case) <br> chain_hostnames(on); # Chain hostnames? <br> keep_hostname(yes); # Keep the hostname the client sent? <br> keep_timestamp(no); # Do not use the timestamp the client sent -- it might be wrong <br> use_dns(yes); # Use DNS? Good for log servers. <br> use_fqdn(no); # Use FQDNs? Good for log servers. <br> dns_cache(yes); # Cache DNS results? <br> dns_cache_size(1024); # Number of DNS lookup results to cache <br> dns_cache_expire(3600); # Expire cached successful DNS lookup results after this many seconds <br> dns_cache_expire_failed(60); # Expire cached failed DNS lookup results after this many seconds <br> ## log file handling <br> create_dirs(yes); # Create directories for log files if they don't exist <br> dir_owner("root"); # Owner of newly created directories <br> dir_group("log"); # Group of newly created directories <br> dir_perm(0750); # Permissions of newly created directories <br> owner("root"); # Owner of newly created log files <br> group("log"); # Group of newly created log files <br> perm(0640); # Permissions of newly created log files <br> ## misc <br> bad_hostname("^gconfd$"); <br> }; <br> <br> #       <br> source src_local { <br> unix-stream("/dev/log" max-connections(1000)); <br> internal(); <br> }; <br> #   ,    <br> source src_kernel { <br> file("/proc/kmsg" flags(kernel) log_prefix("kernel: ")); <br> }; <br> #   . 0.0.0.0 -       <br> source src_rem { udp(ip("0.0.0.0") port(514)); <br> tcp(ip("0.0.0.0") port(514)); }; <br> # ,     . <br> # syslogpaster -      ,      ""  ,      . <br> destination d_my_server_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> #             ,       ,   <br> template("INSERT INTO MY_SERVER (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_dslmodem_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO dslmodem (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> destination d_wifi_mysql { <br> program("/usr/bin/mysql --user=syslogpaster --password='MYSUPERPASSWORD' syslog &lt; /var/log/mysql.pipe"); <br> pipe ("/var/log/mysql.pipe" <br> template("INSERT INTO wifi (host, facility, priority, level, tag, date, time, program, msg) VALUES ( '$HOST', '$FACILITY', '$PRIORITY', '$LEVEL','$TAG','$YEAR-$MONTH-$DAY', '$HOUR:$MIN:$SEC', '$PROGRAM', '$MSG' );") <br> template-escape(yes)); }; <br> <br> #    . <br> template t_logtty   { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_admintty { template("${DATE}; ${FACILITY}.${PRIORITY}; ${MSG}"); template&lt;em&gt;escape(no); }; <br> template t_local    { template("${YEAR}-${MONTH}-${DAY} ${HOUR}:${MIN}:${SEC} ${TZOFFSET}; ${HOST}; ${FACILITY}.${PRIORITY}; ${MSG}"); template_escape(no); }; <br> <br> #       , host   <br> #local log to mysql <br> filter f_my_server { host("MY_SERVER"); }; <br> log { source(src_local); source(src_kernel); filter(f_my_server); destination(d_my_server_mysql); }; <br> <br> #        <br> #remote dslmodem(10.39.1.1) <br> filter f_dslmodem { host("10.39.1.1"); }; <br> log { source(src_rem); filter(f_dslmodem); destination(d_dslmodem_mysql); }; <br> <br> #remote wifi(10.39.0.1) <br> filter f_wifi { host("10.39.0.1"); }; <br> log { source(src_rem); filter(f_wifi); destination(d_wifi_mysql); }; <br> <br> <br> #        ,        <br> #log to file <br> destination d_kernel { file("/var/log/kernel.log" template(t_local)); }; <br> log { source(src_kernel); destination(d_kernel); }; <br> destination d_logtty { file("/dev/tty10" template(t_logtty)); }; <br> log { source(src_local); source(src_kernel); destination(d_logtty); }; <br> destination d_messages { file("/var/log/messages" template(t_local)); }; <br> log { source(src_local); source(src_kernel); source(src_rem); destination(d_messages); };</font></code> </li> </ol><br><br>  <strong>Mysql</strong> <br>  Create a database named syslog <br><br> <code>user$ mysql -u root -p <br> mysql&gt; CREATE DATABASE syslog; <br></code> <br><br>  We get three users: <br>  * syslogadmin - the user has all rights to the database <br>  * sysloguser - can only watch <br>  * syslogpaster - can only add to the database <br><br> <code>CREATE USER syslogadmin IDENTIFIED BY '123456789'; <br> CREATE USER syslogadmin IDENTIFIED BY '123456'; <br> CREATE USER syslogpaster IDENTIFIED BY '123456'; <br> <br> GRANT USAGE ON syslog.* TO 'syslogadmin'@'localhost'; <br> GRANT ALL ON syslog.* TO 'syslogadmin'@'localhost'; <br> GRANT RELOAD ON *.* TO 'syslogadmin'@'localhost'; <br> <br> REVOKE ALL PRIVILEGES ON syslog.* FROM 'sysloguser'@'localhost'; <br> GRANT USAGE ON syslog.* TO 'sysloguser'@'localhost'; <br> GRANT SELECT ON syslog.* TO 'sysloguser'@'localhost'; <br> <br> REVOKE ALL PRIVILEGES ON syslog.* FROM 'syslogpaster'@'localhost'; <br> GRANT USAGE ON syslog.* TO 'syslogpaster'@'localhost'; <br> GRANT INSERT ON syslog.* TO 'syslogpaster'@'localhost'; <br></code> <br><br>  Now create the table.  The structure of the tables is the same, just changing the names: <br><br> <code>CREATE TABLE my_server ( <br> host varchar(32) default NULL, <br> facility varchar(10) default NULL, <br> priority varchar(10) default NULL, <br> level varchar(10) default NULL, <br> tag varchar(10) default NULL, <br> date date default NULL, <br> time time default NULL, <br> program varchar(15) default NULL, <br> msg text, <br> seq int(10) unsigned NOT NULL auto_increment, <br> PRIMARY KEY (seq), <br> KEY host (host), <br> KEY seq (seq), <br> KEY program (program), <br> KEY time (time), <br> KEY date (date), <br> KEY priority (priority), <br> KEY facility (facility) <br> ) TYPE=MyISAM; <br> <br> CREATE TABLE dslmodem ( <br> host varchar(32) default NULL, <br> facility varchar(10) default NULL, <br> priority varchar(10) default NULL, <br> level varchar(10) default NULL, <br> tag varchar(10) default NULL, <br> date date default NULL, <br> time time default NULL, <br> program varchar(15) default NULL, <br> msg text, <br> seq int(10) unsigned NOT NULL auto_increment, <br> PRIMARY KEY (seq), <br> KEY host (host), <br> KEY seq (seq), <br> KEY program (program), <br> KEY time (time), <br> KEY date (date), <br> KEY priority (priority), <br> KEY facility (facility) <br> ) TYPE=MyISAM; <br> <br> CREATE TABLE wifi ( <br> host varchar(32) default NULL, <br> facility varchar(10) default NULL, <br> priority varchar(10) default NULL, <br> level varchar(10) default NULL, <br> tag varchar(10) default NULL, <br> date date default NULL, <br> time time default NULL, <br> program varchar(15) default NULL, <br> msg text, <br> seq int(10) unsigned NOT NULL auto_increment, <br> PRIMARY KEY (seq), <br> KEY host (host), <br> KEY seq (seq), <br> KEY program (program), <br> KEY time (time), <br> KEY date (date), <br> KEY priority (priority), <br> KEY facility (facility) <br> ) TYPE=MyISAM; <br></code> <br><br>  <strong>Conclusion</strong> <br><br>  Well, in general, and all run syslog-ng, although no, I completely forgot, we still have to <br>  create a pipe <br> <code>user$ sudo mkfifo /var/log/mysql.pipe <br> user$ sudo /etc/init.d/syslog-ng start</code> <br> <br>  And everything should work) </div><p>Source: <a href="https://habr.com/ru/post/56926/">https://habr.com/ru/post/56926/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../56920/index.html">Swiss poster</a></li>
<li><a href="../56922/index.html">Augmented Reality</a></li>
<li><a href="../56923/index.html">There are no hopeless situations</a></li>
<li><a href="../56924/index.html">Scorpion-like robot a-pod</a></li>
<li><a href="../56925/index.html">Bluetooth 3.0 with Wi-Fi ready to go</a></li>
<li><a href="../56930/index.html">Parse the query from http://www.hugeurl.com/</a></li>
<li><a href="../56931/index.html">There is a question: how to competently protect your work</a></li>
<li><a href="../56932/index.html">Feature films on YouTube</a></li>
<li><a href="../56933/index.html">Openmoko FreeRunner will live</a></li>
<li><a href="../56936/index.html">2 GHz Atom</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>