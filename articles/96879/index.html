<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The story of one exploit or ‚Äúendless‚Äù 0-day: CVE-2010-1297</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This story began more than ten days ago, when it became aware of another vulnerability in Adobe products, leading to the possibility of remote executi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The story of one exploit or ‚Äúendless‚Äù 0-day: CVE-2010-1297</h1><div class="post__text post__text-html js-mediator-article">  This story began more than ten days ago, when it became aware of another <a href="http://www.adobe.com/support/security/advisories/apsa10-01.html">vulnerability</a> in Adobe products, leading to the possibility of remote execution of malicious code.  The active spread of this infection began, in particular, the exploit became part of many exploit packs that are actively spreading at a given time.  But the most interesting thing began after the <a href="">public exploit code</a> appeared in the Metasploit on June 10 in the evening. <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/0SuXM0qmwrA%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhhnbAhEi3Vh8BVfNy1SbmfhTVxEYA" frameborder="0" allowfullscreen=""></iframe><br><br><a name="habracut"></a><br>  Now there are already several modifications of this exploit, but fundamentally they are no different.  Basically, the changes affected the shellcode, which is executed immediately after successful heap-spray and the payload, which is executed after successful exploitation of the vulnerability.  The heap-spray attack is performed using a javascript script: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a38/62e/f58/a3862ef58e9da1c3c14a153ec3bfd648.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For successful exploitation of the vulnerability, the authors actively use techniques of return-oriented programming (popularly just ROP (Return-Oriented Programming)).  On the topic of ROP there is a good fact <a href="http://trailofbits.files.wordpress.com/2010/04/practical-rop.pdf">-</a> finding <a href="http://trailofbits.files.wordpress.com/2010/04/practical-rop.pdf">material</a> from the famous researcher Dino Dai Zovi. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b0/e2b/6aa/2b0e2b6aa38c42245c914393918f9a6e.png" alt="image"><br><br>  If you look at the memory card at the time of the heap-spray active attack, you can see a large number of allocated memory blocks of the same type with read and write attributes.  But at the very end of this block chain, you can see two blocks of memory that have an attribute to execute.  Actually, this is where the shellcode is located, which will be executed later. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/88c/4d6/7c8/88c4d67c8ec43fcab028bb3267979b86.png" alt="image"><br><br>  After successful application of heap-spray equipment, control is transferred to a shell code, which consists of several levels.  Each level decodes the next. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dd1/b98/5e5/dd1b985e54b42bd7c6b6cfd9f956b6e3.png" alt="image"><br><br>  As a result of the execution of this string of shell-code, the executable file and the pdf-file are reset to the temp directory.  The executable file is a Trojan downloader detected by us as Win32 / Small.NEM.  Interestingly, in the resources section it contains the following information: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dbc/c18/52c/dbcc1852c9d4867ffefa3c8e1972bad1.png" alt="image"><br><br>  Thus, he tries to disguise himself as a legal program. <br>  After the successful launch of the malicious program, the Adobe Reader is restarted and the previously prepared pdf file is opened. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b4/3e1/170/8b43e1170382d376aaf7255929910c26.png" alt="image"><br><br>  This pdf-file does not contain malicious content and is intended to bring down the user who has opened the file containing the exploit before. <br><br>  <b>Finally, I would like to note that the vulnerability for Adobe Reader has not yet been eliminated and can be successfully exploited.</b>  <b>An update for Adobe Reader that resolves this vulnerability is scheduled only for the end of the current month.</b>  <b>Be carefull!</b> </div><p>Source: <a href="https://habr.com/ru/post/96879/">https://habr.com/ru/post/96879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../96873/index.html">Social Network "Blogistan" suddenly turned out to be a restaurant</a></li>
<li><a href="../96874/index.html">Makhost: how to return your domain (except. RU)</a></li>
<li><a href="../96875/index.html">Sex with a client is a basic instinct. Free webinar from the Freelance School</a></li>
<li><a href="../96877/index.html">"Unlimited" mobile Internet or is it fantastic son</a></li>
<li><a href="../96878/index.html">Intel will help Skolkovo to create an innovative laboratory</a></li>
<li><a href="../96880/index.html">We write the simplest torrent tracker on php</a></li>
<li><a href="../96884/index.html">Create CHM with search and index</a></li>
<li><a href="../96887/index.html">How I updated Linux Mint</a></li>
<li><a href="../96888/index.html">VP8, x264 and libtheora codecs comparison</a></li>
<li><a href="../96889/index.html">MTS and the Moscow Metro presented a new way to pay for the subway using a mobile phone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>