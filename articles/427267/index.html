<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SNMP + Java is a personal experience. Writing MIB files parser</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="SNMP is not the user-friendly protocol: MIB files are too long and complicated, and OIDs are simply impossible to remember. What if it became necessar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SNMP + Java is a personal experience. Writing MIB files parser</h1><div class="post__text post__text-html js-mediator-article">  SNMP is not the user-friendly protocol: MIB files are too long and complicated, and OIDs are simply impossible to remember.  What if it became necessary to work with SNMP on Java?  For example, write autotests to test the SNMP server API. <br><br>  By trial and error in the presence of a fairly meager amount of information on the topic, we still figured out how to make friends with Java and SNMP. <br><br>  In this series of articles I will try to share my experience with the protocol.  The first article in the series will be devoted to the implementation of the parser for MIB files in Java.  In the second part I will talk about writing an SNMP client.  In the third part, we will discuss a real example of using the written library: autotests for checking the interaction with a device using the SNMP protocol. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/tv/lq/ai/tvlqaihbpnaqtlie8wr7hulxyhg.jpeg"><br><a name="habracut"></a><br><h2>  Introduction </h2><br>  It all started with the fact that the task came to write autotests to test the work of the audio-video recorder via the SNMP protocol.  The situation was complicated by the fact that there is not so much information on interaction with SNMP in Java, especially if we speak about the Russian-speaking segment of the Internet.  Of course, it was possible to look towards C # or Python.  But in C #, the protocol situation is about as complex as in Java.  In Python, there are a couple of good libraries, but we already had a ready infrastructure for REST API autotests for this device in Java. <br><br>  Like for any other protocol of interaction over the network, we needed an SNMP client to work with various kinds of requests.  Self-tests should be able to check the success of GET and SET queries for scalar and tabular parameters.  For tables, it was also required to be able to check the addition and deletion of records if the table itself permits these operations. <br><br>  But besides the client, the library had to contain a class for working with MIB files.  This class should have been able to parse a MIB file to get data types, permissible value boundaries, etc., so as not to hardcore something that can always change. <br><br>  During the search for suitable libraries for Java, we did not find a single library that would allow working with queries and with MIB files.  Therefore, we stopped at two different libraries.  For the client, the choice of the widely used org.snmp4j.snmp4j (https://www.snmp4j.org) seemed quite logical, and for the parser of MIB files, the choice was not on the not very famous net.percederberg.mibble library (https: // www. mibble.org).  If the choice was obvious with snmp4j, then mibble was chosen for having sufficiently detailed (albeit English) documentation with examples.  So, let's begin. <br><br><h2>  Writing MIB files parser </h2><br>  Anyone who has ever seen MIB files knows that this is a pain.  Let's try to fix it with the help of a simple parser, which will greatly facilitate the search for information from a file, reducing it to a call to a particular method. <br><br>  Such a parser can be used as a separate utility for working with MIB files or included in any other project under SNMP, for example, when writing an SNMP client or automating testing. <br><br><h4>  Project preparation </h4><br>  For ease of assembly, we use Maven.  Depending on, we add the net.percederberg.mibble library (https://www.mibble.org), which will make it easier for us to work with MIB files: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>net.percederberg.mibble<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>mibble<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.9.3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Since it is not located in the central Maven repository, we add the following code to pom.xml: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">repositories</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">repository</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>opennms<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>OpenNMS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://repo.opennms.org/maven2/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">repository</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">repositories</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  If the project is going with the help of mavena without errors, everything is ready for work.  It remains only to create a parser class (let's call it MIBParser) and import everything we need, namely: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> net.percederberg.mibble.*;</code> </pre> <br><h4>  Download and validate MIB file </h4><br>  Inside the class there will be only one field - an object of type net.percederberg.mibble.Mib for storing the loaded MIB file: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Mib mib;</code> </pre><br>  To download the file, write this method: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Mib </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadMib</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File file)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> MibLoaderException, IOException </span></span>{ MibLoader loader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MibLoader(); Mib mib; file = file.getAbsoluteFile(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { loader.addDir(file.getParentFile()); mib = loader.load(file); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (MibLoaderException e) { e.getLog().printTo(System.err); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> e; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { e.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> e; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mib; }</code> </pre><br>  The net.percederberg.mibble.MIBLoader class validates the file we are trying to load and throws the net.percederberg.mibble.MibLoaderException exception if it finds any errors, including import errors from other MIB files, if do not lie in the same directory or do not contain imported MIB-symbols. <br><br>  In the loadMib method, we catch all the exceptions, write about them to the log and push further, because  At this stage, the continuation of work is impossible - the file is not valid. <br><br>  We call the written method in the parser constructor: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MIBParser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File file)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> MibLoaderException, IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!file.exists()) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileNotFoundException(<span class="hljs-string"><span class="hljs-string">"File not found in location: "</span></span> + file.getAbsolutePath()); mib = loadMib(file.getAbsoluteFile()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!mib.isLoaded()) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MibLoaderException(file, <span class="hljs-string"><span class="hljs-string">"Not loaded."</span></span>); }</code> </pre><br>  If the file is successfully loaded and parsed, continue to work. <br><br><h4>  Methods for obtaining information from a MIB file </h4><br>  Using the methods of the net.percederberg.mibble.Mib class, you can search for individual characters of a MIB file by name or OID by calling the getSymbol (String name) or getSymbolByOid (String oid) methods, respectively.  These methods return the object net.percederberg.mibble.MibSymbol to us, the methods of which we will use to obtain the necessary information on a specific MIB symbol. <br><br>  Let's start with the simplest and write methods to get the name of a symbol by its OID and, conversely, OID by name: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String oid)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mib.getSymbolByOid(oid).getName(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ String oid = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; MibSymbol s = mib.getSymbol(name); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> MibValueSymbol) { oid = ((MibValueSymbol) s).getValue().toString(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((MibValueSymbol) s).isScalar()) oid = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OID(oid).append(<span class="hljs-number"><span class="hljs-number">0</span></span>).toDottedString(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> oid; }</code> </pre><br>  Perhaps these are the features of a particular MIB file that I needed to work with, but for some reason, for scalar parameters, an OID was returned without a zero at the end, so code was added to the method for obtaining an OID, in case MIB- the scalar character simply adds to the resulting OID ".0" using the append (int index) method from the net.percederberg.mibble.OID class.  If you work without a crutch, congratulations :) <br><br>  To get the rest of the data on a symbol, we write one auxiliary method, where we get the net.percederberg.mibble.snmp.SnmpObjectType object, which contains all the necessary information about the MIB symbol from which it was obtained. <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> SnmpObjectType </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSnmpObjectType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MibSymbol symbol)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (symbol <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> MibValueSymbol) { MibType type = ((MibValueSymbol) symbol).getType(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> SnmpObjectType) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (SnmpObjectType) type; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre><br>  For example, we can get the type of MIB symbol: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ MibSymbol s = mib.getSymbol(name); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (getSnmpObjectType(s).getSyntax().getReferenceSymbol() == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getSnmpObjectType(s).getSyntax().getName(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getSnmpObjectType(s).getSyntax().getReferenceSymbol().getName(); }</code> </pre><br>  There are 2 ways to get the type, because  for primitive types, the first option works: <br><br><pre> <code class="java hljs">getSnmpObjectType(s).getSyntax().getName();</code> </pre><br>  and for imported ones, the second: <br><br><pre> <code class="java hljs">getSnmpObjectType(s).getSyntax().getReferenceSymbol().getName();</code> </pre><br>  You can get the level of access to the symbol: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ MibSymbol s = mib.getSymbol(name); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> getSnmpObjectType(s).getAccess().toString(); }</code> </pre><br>  The minimum acceptable value of a numeric parameter: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Integer </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDigitMinValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ MibSymbol s = mib.getSymbol(name); String syntax = getSnmpObjectType(s).getSyntax().toString(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (syntax.contains(<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; Pattern p = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(-?\\d+)..(-?\\d+)"</span></span>); Matcher m = p.matcher(syntax); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.find()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">1</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre><br>  Maximum allowable value of a numeric parameter: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Integer </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDigitMaxValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ MibSymbol s = mib.getSymbol(name); String syntax = getSnmpObjectType(s).getSyntax().toString(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (syntax.contains(<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; Pattern p = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(-?\\d+)..(-?\\d+)"</span></span>); Matcher m = p.matcher(syntax); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m.find()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">2</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre><br>  The minimum allowed string length (depends on the type of string): <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Integer </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getStringMinLength</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ MibSymbol s = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mib.getSymbol(name); String syntax = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getSnmpObjectType(s).getSyntax().toString(); Pattern p = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(-?\\d+)..(-?\\d+)"</span></span>); Matcher m = p.matcher(syntax); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> syntax.contains(<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>) &amp;&amp; m.find()?Integer.valueOf(Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">1</span></span>))):<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre><br>  The maximum allowable length of the string (depends on the type of string): <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Integer </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getStringMaxLength</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ MibSymbol s = mib.getSymbol(name); String syntax = getSnmpObjectType(s).getSyntax().toString(); Pattern p = Pattern.compile(<span class="hljs-string"><span class="hljs-string">"(-?\\d+)..(-?\\d+)"</span></span>); Matcher m = p.matcher(syntax); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (syntax.contains(<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>) &amp;&amp; m.find()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Integer.parseInt(m.group(<span class="hljs-number"><span class="hljs-number">2</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre><br>  You can also get the names of all columns in the table by its name: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ArrayList&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTableColumnNames</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String tableName)</span></span></span><span class="hljs-function"> </span></span>{ ArrayList&lt;String&gt; mibSymbolNamesList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); MibValueSymbol table = (MibValueSymbol) mib.findSymbol(tableName, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (table.isTable() &amp;&amp; table.getChild(<span class="hljs-number"><span class="hljs-number">0</span></span>).isTableRow()) { MibValueSymbol[] symbols = table.getChild(<span class="hljs-number"><span class="hljs-number">0</span></span>).getChildren(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (MibValueSymbol mvs : symbols) { mibSymbolNamesList.add(mvs.getName()); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mibSymbolNamesList; }</code> </pre><br>  First, in the standard way, we obtain the MIB symbol by name: <br><br><pre> <code class="java hljs">MibValueSymbol table = (MibValueSymbol) mib.findSymbol(tableName, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>);</code> </pre><br>  Then we check whether it is a table and that the child MIB symbol is a row of this table and, if the condition returns true, in the loop, go over the children of the table row and add the element name to the resulting array: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (table.isTable() &amp;&amp; table.getChild(<span class="hljs-number"><span class="hljs-number">0</span></span>).isTableRow()) { MibValueSymbol[] symbols = table.getChild(<span class="hljs-number"><span class="hljs-number">0</span></span>).getChildren(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (MibValueSymbol mvs : symbols) { mibSymbolNamesList.add(mvs.getName()); } }</code> </pre><br><h2>  Results </h2><br>  These methods are sufficient for obtaining any information from the MIB file for each specific symbol, knowing only its name.  For example, when writing an SNMP client, you can include such a parser in it, so that the client methods accept, instead of OIDs, the names of MIB symbols.  This will increase the reliability of the code, since  A typo in the OID can lead to the wrong character to which we want to refer.  And there are no OIDs - no problems. <br><br>  A plus is the readability of the code, and therefore its support.  It is easier to grasp the essence of the project, if the code operates with human names. <br><br>  Another application is test automation.  In the test data, you can get the boundary values ‚Äã‚Äãof numeric parameters dynamically from a MIB file.  So, if the boundary values ‚Äã‚Äãof some MIB symbols in the new version of the component being tested change, there is no need to change the autotest code. <br><br>  In general, using the parser to work with MIB files becomes much more pleasant, and they cease to be such a pain. </div><p>Source: <a href="https://habr.com/ru/post/427267/">https://habr.com/ru/post/427267/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../427255/index.html">Cowon D2: musical long-liver</a></li>
<li><a href="../427257/index.html">Cameron Craig: Seven Lessons Learned in 10 Years of Managing Apple's PR Department</a></li>
<li><a href="../427259/index.html">What the Turing Test actually tests</a></li>
<li><a href="../427263/index.html">Be a security ninja: webinar recording and bonus level</a></li>
<li><a href="../427265/index.html">Protobuffers are wrong</a></li>
<li><a href="../427269/index.html">Google OKR Video Five Years Later - Review of Google Ventures OKR Implementation Experience (2012-2017)</a></li>
<li><a href="../427271/index.html">History and experience of using machine translation. Yandex lecture</a></li>
<li><a href="../427273/index.html">Can artificial intelligence leave bookmakers out of work?</a></li>
<li><a href="../427275/index.html">Information architecture on the Internet, part 3</a></li>
<li><a href="../427277/index.html">A diffraction pattern was found in the distribution of prime numbers, approximately as in quasicrystals.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>