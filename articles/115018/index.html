<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Search for the k-th smallest element</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today a very interesting article appeared on Habr√© , about finding the minimum (maximum) value on a segment in an array . Since the article turned out...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Search for the k-th smallest element</h1><div class="post__text post__text-html js-mediator-article">  Today a very interesting <a href="http://habrahabr.ru/blogs/algorithm/114980/">article</a> appeared on Habr√© <a href="http://habrahabr.ru/blogs/algorithm/114980/">, about finding the minimum (maximum) value on a segment in an array</a> .  Since the article turned out to be interesting and popular, I decided to share with you one more search algorithm in the array of some ‚Äúspecial‚Äù values. <br><a name="habracut"></a><br>  Surely everyone met the task of finding the k-th smallest element in the array.  The k-th element is characterized by the fact that it is greater than (or equal to) k elements of the array and less than or equal to Nk of the remaining elements (where N is the number of elements in the array). <br><br>  The task of finding the k-th smallest element is usually associated with the sorting task, since the obvious method of finding this element is to sort the N elements and choose the k-th. <br><br>  But we will go a little different way.  I assume that readers know how the quick sort algorithm works, but just in case, let me remind you.  A random element x is selected in the array, and the array is scanned to the left until a [i]&gt; x is found, then scans to the right until a [j] &lt;x is found.  As soon as two such elements are found, they are exchanged and viewed until the indices i, j become equal somewhere in the middle of the array.  The result is an array whose left side contains the elements &lt;= x, and the right side contains the elements&gt; = x.  The described procedure is applied recursively for the left and right side and continues until a fully sorted array is obtained.  ( <a href="http://habrahabr.ru/blogs/algorithm/104697/">A little more about effective sorting algorithms</a> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The separation procedure used in quick sorting gives the potential to find the desired (k-th) element much faster. <br>  This algorithm works as follows.  At the first step, the separation procedure with L = 1 and R = N is called (that is, the separation is performed for the entire array), and a [k] is selected as the separating value x.  After separation, the values ‚Äã‚Äãof the indices i, j are obtained such that <br><br>  a [h] &lt;x for all h &lt;i <br>  a [h]&gt; x for all h&gt; j <br>  i&gt; j <br><br>  Three cases are possible here: <br>  ‚Ä¢ The separation value of x turned out to be too small.  As a result, the boundary between the two parts is less than the desired value of k.  Then the separation operation must be repeated with elements a [i] ... a [R]. <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/6f/f2/6ff28ac6b49670e040cf9588ca1d0996.png"></a> <br>  ‚Ä¢ The selected x value was too large.  Then the separation operation should be repeated with elements a [L] ... a [j]. <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/26/05/2605e70aea5b67ffaca56bfbb24d9238.png"></a> <br>  ‚Ä¢ The element a [k] splits an array into two parts in the required proportion and therefore is the desired value. <br> <a title="Habraffe.ru" href=""><img src="https://habrastorage.org/storage/habraeffect/bc/0d/bc0d230ec5837732d0abd82e75848a88.png"></a> <br><br>  The separation operation must be repeated until Case 3 is implemented. This cycle is expressed in the following fragment (I apologize for Pascal, but my students still know only him): <br><blockquote><ol><li>  <font color="#000000">procedure</font> Find <font color="#000066">(</font> k <font color="#000066">:</font> <font color="#000066">integer</font> <font color="#000066">)</font> <font color="#000066">;</font> </li><li>  <font color="#000000">var</font> </li><li>  L <font color="#000066">,</font> R <font color="#000066">,</font> i <font color="#000066">,</font> j <font color="#000066">:</font> <font color="#000066">integer</font> <font color="#000066">;</font> </li><li>  w <font color="#000066">,</font> x <font color="#000066">:</font> <font color="#000066">integer</font> <font color="#000066">;</font> </li><li>  <font color="#000000">begin</font> </li><li>  L <font color="#000066">:</font> <font color="#000066">=</font> <font color="#0000ff">1</font> <font color="#000066">;</font>  R <font color="#000066">:</font> <font color="#000066">=</font> N <font color="#000066">;</font> </li><li>  <font color="#000000">while</font> L &lt;R <font color="#000066">-</font> <font color="#0000ff">1</font> <font color="#000000">do</font> </li><li>  <font color="#000000">begin</font> </li><li>  x <font color="#000066">:</font> <font color="#000066">=</font> a <font color="#000066">[</font> k <font color="#000066">]</font> <font color="#000066">;</font> </li><li>  i <font color="#000066">:</font> <font color="#000066">=</font> L <font color="#000066">;</font> </li><li>  j <font color="#000066">:</font> <font color="#000066">=</font> R <font color="#000066">;</font> </li><li>  <font color="#000000">REPEAT</font> </li><li>  <font color="#000000">while</font> a <font color="#000066">[</font> i <font color="#000066">]</font> &lt;x <font color="#000000">do</font> </li><li>  i <font color="#000066">:</font> <font color="#000066">=</font> i <font color="#000066">+</font> <font color="#0000ff">1</font> <font color="#000066">;</font> </li><li>  <font color="#000000">while</font> x &lt;a <font color="#000066">[</font> j <font color="#000066">]</font> <font color="#000000">do</font> </li><li>  j <font color="#000066">:</font> <font color="#000066">=</font> j <font color="#000066">-</font> <font color="#0000ff">1</font> <font color="#000066">;</font> </li><li>  <font color="#000000">if</font> i &lt; <font color="#000066">=</font> j <font color="#000000">then</font> </li><li>  <font color="#000000">begin</font> </li><li>  w <font color="#000066">:</font> <font color="#000066">=</font> a <font color="#000066">[</font> i <font color="#000066">]</font> <font color="#000066">;</font> </li><li>  a <font color="#000066">[</font> i <font color="#000066">]</font> <font color="#000066">:</font> <font color="#000066">=</font> a <font color="#000066">[</font> j <font color="#000066">]</font> <font color="#000066">;</font> </li><li>  a <font color="#000066">[</font> j <font color="#000066">]</font> <font color="#000066">:</font> <font color="#000066">=</font> w <font color="#000066">;</font> </li><li>  i <font color="#000066">:</font> <font color="#000066">=</font> i <font color="#000066">+</font> <font color="#0000ff">1</font> <font color="#000066">;</font> </li><li>  j <font color="#000066">:</font> <font color="#000066">=</font> j <font color="#000066">-</font> <font color="#0000ff">1</font> <font color="#000066">;</font> </li><li>  <font color="#000000">end</font> <font color="#000066">;</font> </li><li>  <font color="#000000">UNTIL</font> i&gt; j <font color="#000066">;</font> </li><li>  <font color="#000000">if</font> j &lt;k <font color="#000000">then</font> </li><li>  L <font color="#000066">:</font> <font color="#000066">=</font> i <font color="#000066">;</font> </li><li>  <font color="#000000">if</font> k &lt;i <font color="#000000">then</font> </li><li>  R <font color="#000066">:</font> <font color="#000066">=</font> j <font color="#000066">;</font> </li><li>  <font color="#000000">end</font> <font color="#000066">;</font> </li><li>  <font color="#000000">end</font> <font color="#000066">;</font> </li></ol></blockquote><br><br>  If we assume that, on average, each partition divides in half the size of the part of the array in which the desired value is located, then the required number of comparisons will be N + N / 2 + N / 4 + ... + 1 = 2N.  This explains the effectiveness of the above procedure for searching medians and other values, and also explains its superiority over the simple method consisting in pre-sorting the entire array with the subsequent selection of the k-th element (where the best behavior is of the order N * log (N)). <br><br>  I hope this algorithm will help you make your programs more efficient and faster.  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/115018/">https://habr.com/ru/post/115018/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../115009/index.html">Kohana 3.0 - simplify your life</a></li>
<li><a href="../115011/index.html">The Wikimedia Foundation published a financial report for the second half of 2010</a></li>
<li><a href="../115012/index.html">Habra Literacy for all</a></li>
<li><a href="../115014/index.html">Tablet and keyboard: the battle for a place in the sun</a></li>
<li><a href="../115015/index.html">About the "holes" in the security of ERP systems</a></li>
<li><a href="../115019/index.html">OpenStreetMap News ‚Ññ2</a></li>
<li><a href="../115020/index.html">VLC as a Windows service</a></li>
<li><a href="../115021/index.html">Running javascript in a C # program</a></li>
<li><a href="../115022/index.html">Android Development Tutorial. Part 1/?</a></li>
<li><a href="../115023/index.html">Google, unite!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>