<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with geofences (geofences) in Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, habrovchane. Today I would like to talk about Location APIs in general and about geofences (geofences) in particular, which were prese...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with geofences (geofences) in Android</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/495/a94/c0e/495a94c0e29ca7cff2a3b18513759673.png" align="left"><br>  Good afternoon, habrovchane.  Today I would like to talk about <a href="https://developer.android.com/google/play-services/location.html">Location APIs</a> in general and about geofences (geofences) in particular, which were presented at Google I / 0 2013 ( <a href="http://www.youtube.com/watch%3Fv%3DBte_GHuxUGc">video</a> and <a href="http://commondatastorage.googleapis.com/io-2013/presentations/106%2520-%2520Beyond%2520the%2520Blue%2520Dot-%2520New%2520features%2520in%2520Android%2520Location%2520(1).pdf">presentation</a> ).  Despite the fact that the event occurred more than half a year ago, there is still no imputed information about this in the Habr√© (just <a href="http://habrahabr.ru/post/191290/">one mention</a> ).  I will try to correct the situation a little. <br><a name="habracut"></a><br><h4>  What are Location APIs? </h4><br>  Location APIs are part of the Google Play services, which is designed to create applications that work with the location of the device.  Unlike similar functions in the <a href="http://developer.android.com/reference/android/location/LocationManager.html">LocationManager</a> , the API data is distinguished by improved energy saving.  The following functionality is currently available: determining the location of the device, working with geofences and recognizing user activity.  Positioning balances accuracy of determination with energy consumption, and also provides access to the most frequent locations.  Activity recognition allows you to find out what the device user is doing: riding a car, riding a bicycle, walking, or staying in one place.  Well, actually, working with geo-zones allows you to send messages when a device user enters a specific zone, leaves it, or is in a zone for a certain period of time. <br>  In my opinion, the <a href="">official example is</a> quite complicated and confusing.  This is due to the fact that in it: <br><ul><li>  tried to show all the features of the Location APIs </li><li>  a lot of comments and exception handling, which could be missed in the example </li><li>  all actions are performed from activit </li></ul><br>  Based on this, in this article I will focus only on geofences and omit some exception handling. <br><br>  <b>Note</b> : Google Play services may be disabled on the device.  This can disrupt the work of many applications and the system honestly warns the user about this before disconnecting them.  But it will still be good practice to check this in your application using <a href="http://developer.android.com/reference/com/google/android/gms/common/GooglePlayServicesUtil.html">GooglePlayServicesUtil.isGooglePlayServicesAvailable</a> and somehow alert the user. <br><br><h4>  Task </h4><br>  So, for example, let's write an application in which you can explicitly specify the coordinates and radius of the geofence.  When entering / leaving it, a notification will be added to the status bar with the geofence id and type of movement.  After exiting the geofence we will remove it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Sources for the impatient</b> <div class="spoiler_text">  <a href="https://github.com/Ne4istb/AndroidGeofenceTest">github</a> </div></div><br><br><h4>  Algorithm </h4><br>  In general, the process is as follows: <br><ol><li>  From the activit we create a service to which we transmit data on the geofence. </li><li>  The service initializes the <b>LocationClient</b> . </li><li>  When the <b>LocationClient is</b> initialized, we add geofence ( <b>Geofence</b> ) and the corresponding <i>PendingIntent to it</i> . </li><li>  When geofences are added, we disconnect from <b>LocationClient</b> and stop the service. </li><li>  Further, all hope for <i>PendingIntent</i> , which will launch the <i>IntentService</i> when entering the zone or leaving the zone.  The service adds notifications to the status bar and creates a service for deleting spent geofences. </li><li>  The newly created service initializes the <b>LocationClient</b> again. </li><li>  When the <b>LocationClient was</b> initialized, we delete the spent geofences. </li><li>  When geofences are removed, we disconnect from the <b>LocationClient</b> and stop the service. </li><li>  Profit! </li></ol><br>  As we see, the main actor is the <b>LocationClient</b> .  He is responsible for accessing the API for locating and working with geofences. <br><br><h4>  To the point! </h4><br>  First you need to connect Google Play services.  How to do this is described <a href="http://developer.android.com/google/play-services/setup.html">here</a> . <br>  Next, in the activation, we initialize the display elements.  From this area, we are interested in calling the service when handling button clicks: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> transitionType = Geofence.GEOFENCE_TRANSITION_ENTER | Geofence.GEOFENCE_TRANSITION_EXIT; MyGeofence myGeofence = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyGeofence(mId, latitude, longitude, radius, transitionType); Intent geofencingService = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(activity, GeofencingService.class); geofencingService.putExtra(GeofencingService.EXTRA_ACTION, GeofencingService.Action.ADD); geofencingService.putExtra(GeofencingService.EXTRA_GEOFENCE, myGeofence); activity.startService(geofencingService);</code> </pre> <br>  Here we create an <i>Intent</i> for our service ( <i>GeofencingService</i> ) and transfer the necessary data to it.  Since <i>GeofencingService</i> is responsible for adding and deleting geofences (in the example I decided not to divide these actions into different services), we need to transfer the type of operation that should be performed by the service.  In this case, the addition ( <i>GeofencingService.Action.ADD</i> ).  The service also needs data on the geofence.  We pass them as an object of the class MyGeofence, which is essentially a wrapper over <b>Geofence.Builder</b> (we'll talk about it later). <br>  So, we transfer the coordinates of the center and the zone radius, as well as the type of movement.  The latter can be of three types: GEOFENCE_TRANSITION_ENTER, GEOFENCE_TRANSITION_EXIT and GEOFENCE_TRANSITION_DWELL.  If with the first two everything is clear, then by the third clarification is needed.  GEOFENCE_TRANSITION_DWELL indicates that the user has entered the zone and spent some time in it.  To use this signal, you must set <i>setLoiteringDelay</i> when building a geofence.  In this example, GEOFENCE_TRANSITION_DWELL is not used. <br><br>  Go to the service.  The service implements <b>GooglePlayServicesClient.ConnectionCallbacks</b> , <b>GooglePlayServicesClient.OnConnectionFailedListener</b> , <b>LocationClient.OnAddGeofencesResultListener</b> , <b>LocationClient.OnRemoveGeofencesResultListener</b> interfaces.  This allows him to be fully responsible for working with the <b>LocationClient</b> . <br>  In <i>onStartCommand,</i> we get the type of operation (ADD or REMOVE) and pull the data necessary to perform this action.  After that, we initialize and run the <b>LocationClient</b> : <br><br><pre> <code class="java hljs"> mAction = (Action) intent.getSerializableExtra(EXTRA_ACTION); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (mAction) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ADD: MyGeofence newGeofence = (MyGeofence) intent.getSerializableExtra(EXTRA_GEOFENCE); mGeofenceListsToAdd.add(newGeofence.toGeofence()); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> REMOVE: mGeofenceListsToRemove = Arrays.asList(intent.getStringArrayExtra(EXTRA_REQUEST_IDS)); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } mLocationClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LocationClient(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); mLocationClient.connect();</code> </pre><br>  Before adding the <i>mGeofenceListsToAdd geofence</i> , we called the <i>toGeofence ()</i> method of the <i>MyGeofence</i> class <i>object</i> .  I already said that <i>MyGeofence</i> is a wrapper over <b>Geofence.Builder</b> : <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyGeofence</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> latitude, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> longitude, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> radius, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> transitionType)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id = id; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.latitude = latitude; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.longitude = longitude; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.radius = radius; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.transitionType = transitionType; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Geofence </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toGeofence</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Geofence.Builder() .setRequestId(String.valueOf(id)) .setTransitionTypes(transitionType) .setCircularRegion(latitude, longitude, radius) .setExpirationDuration(ONE_MINUTE) .build(); }</code> </pre><br>  <b>Geofence.Builder</b> is a utility class for creating <b>Geofence</b> .  We set the necessary parameters, and then call the <i>build ()</i> method to create the object.  Above is the required minimum of parameters.  Here you should pay attention to <i>setExpirationDuration</i> .  The fact is that registered geofences can be deleted only in two cases: after a specified time has elapsed or with an explicit removal.  Therefore, if you pass NEVER_EXPIRE as a parameter, then you must take care of deleting the object yourself.  <b>Location APIs</b> have a limitation: a maximum of 100 geozones per application at a time. <br><br>  After the <b>LocationClient</b> connects, the <i>onConnected</i> Google interface callbackPlayServicesClient.ConnectionCallbacks will work.  In it, we perform addition or deletion depending on the current type of action: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onConnected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle bundle)</span></span></span><span class="hljs-function"> </span></span>{ Log.d(<span class="hljs-string"><span class="hljs-string">"GEO"</span></span>, <span class="hljs-string"><span class="hljs-string">"Location client connected"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (mAction) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ADD: Log.d(<span class="hljs-string"><span class="hljs-string">"GEO"</span></span>, <span class="hljs-string"><span class="hljs-string">"Location client adds geofence"</span></span>); mLocationClient.addGeofences(mGeofenceListsToAdd, getPendingIntent(), <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> REMOVE: Log.d(<span class="hljs-string"><span class="hljs-string">"GEO"</span></span>, <span class="hljs-string"><span class="hljs-string">"Location client removes geofence"</span></span>); mLocationClient.removeGeofences(mGeofenceListsToRemove, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } }</code> </pre><br>  As we see, <b>addGeofences</b> one of the parameters requires <i>PendingIntent</i> , which will work when moving.  In our case, <i>PendingIntent</i> will run the <i>IntentService</i> : <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> PendingIntent </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPendingIntent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Intent transitionService = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, ReceiveTransitionsIntentService.class); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> PendingIntent.getService(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, transitionService, PendingIntent.FLAG_UPDATE_CURRENT); }</code> </pre><br>  After performing the action, we have <b>OnAddGeofencesResultListener</b> or <b>onRemoveGeofencesByRequestIdsResult triggered</b> , in which we disconnect from the <b>LocationClient</b> and stop the service: <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onAddGeofencesResult</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i, String[] strings)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (LocationStatusCodes.SUCCESS == i) { Log.d(<span class="hljs-string"><span class="hljs-string">"GEO"</span></span>, <span class="hljs-string"><span class="hljs-string">"Geofences added "</span></span> + strings); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String geofenceId : strings) Toast.makeText(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"Geofences added: "</span></span> + geofenceId, Toast.LENGTH_SHORT).show(); mLocationClient.disconnect(); stopSelf(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Log.e(<span class="hljs-string"><span class="hljs-string">"GEO"</span></span>, <span class="hljs-string"><span class="hljs-string">"Error while adding geofence: "</span></span> + strings); } } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onRemoveGeofencesByRequestIdsResult</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i, String[] strings)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (LocationStatusCodes.SUCCESS == i) { Log.d(<span class="hljs-string"><span class="hljs-string">"GEO"</span></span>, <span class="hljs-string"><span class="hljs-string">"Geofences removed"</span></span> + strings); mLocationClient.disconnect(); stopSelf(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Log.e(<span class="hljs-string"><span class="hljs-string">"GEO"</span></span>, <span class="hljs-string"><span class="hljs-string">"Error while removing geofence: "</span></span> + strings); } }</code> </pre><br>  The last part of the application is the <i>IntentService</i> , which is launched when the user of the device crosses the geofence boundary.  All actions are performed in <i>onHandleIntent</i> : <br><br><pre> <code class="java hljs"> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onHandleIntent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Intent intent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (LocationClient.hasError(intent)) { Log.e(TRANSITION_INTENT_SERVICE, <span class="hljs-string"><span class="hljs-string">"Location Services error: "</span></span> + LocationClient.getErrorCode(intent)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> transitionType = LocationClient.getGeofenceTransition(intent); List&lt;Geofence&gt; triggeredGeofences = LocationClient.getTriggeringGeofences(intent); List&lt;String&gt; triggeredIds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;String&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Geofence geofence : triggeredGeofences) { Log.d(<span class="hljs-string"><span class="hljs-string">"GEO"</span></span>, <span class="hljs-string"><span class="hljs-string">"onHandle:"</span></span> + geofence.getRequestId()); processGeofence(geofence, transitionType); triggeredIds.add(geofence.getRequestId()); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (transitionType == Geofence.GEOFENCE_TRANSITION_EXIT) removeGeofences(triggeredIds); }</code> </pre><br>  Here we mainly use the static methods of <b>LocationClient</b> .  First, we check for errors using <i>hasError</i> .  Then we get the type of movement and the list of <i>geozones</i> triggered using <i>getGeofenceTransition</i> and <i>getTriggeringGeofences,</i> respectively.  Call the processing of each geofence and save its id.  And finally, we delete geofences in case this movement was an exit from the geofence. <br>  To delete geofences, we again create a service to which we transfer the type of operation (REMOVE) and the id list for deletion: <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">removeGeofences</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;String&gt; requestIds)</span></span></span><span class="hljs-function"> </span></span>{ Intent intent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(getApplicationContext(), GeofencingService.class); String[] ids = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[<span class="hljs-number"><span class="hljs-number">0</span></span>]; intent.putExtra(GeofencingService.EXTRA_REQUEST_IDS, requestIds.toArray(ids)); intent.putExtra(GeofencingService.EXTRA_ACTION, GeofencingService.Action.REMOVE); startService(intent); }</code> </pre><br><br><h4>  That's all! </h4><br>  I hope the example is clear and interesting.  I wish you all good applications! <br><br>  <b>UPDATE:</b> <br>  The article and code are very outdated in 2 years. <br>  Thank you <a href="https://habrahabr.ru/users/vilkaman/" class="user_link">Vilkaman</a> for updating the code in the repository. <br>  More information about working with the updated Location API can be found in his <a href="https://habrahabr.ru/post/282129/">article.</a> </div><p>Source: <a href="https://habr.com/ru/post/210162/">https://habr.com/ru/post/210162/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210146/index.html">Video player for foreign language teaching sites</a></li>
<li><a href="../210148/index.html">Free software online learning center in 15 minutes, or BigButton again</a></li>
<li><a href="../210150/index.html">Transformation of threats in the information space: from technological to social. Part III</a></li>
<li><a href="../210152/index.html">New analytical project Ruward: Track</a></li>
<li><a href="../210158/index.html">Is it possible to return an expired domain through the UDRP procedure?</a></li>
<li><a href="../210166/index.html">Writing a parser on NodeJS</a></li>
<li><a href="../210170/index.html">Managerial tools: 4 principles of constructive communication, or why do we live in the mode of achievement?</a></li>
<li><a href="../210172/index.html">MS Surface vs iPad Air: on what is preferable to write mobile applications for the corporate segment?</a></li>
<li><a href="../210178/index.html">Richard Hamming: how to do a great job</a></li>
<li><a href="../210180/index.html">How to get on PHDays IV CTF? Participate in CTF Quals</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>