<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Turn Habr into "tag" using Canvas</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, dear visitors Habr. 

 I want to share with you my small script that can be used using the Bookmarklet technique on almost any site. S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Turn Habr into "tag" using Canvas</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/03a/dee/3df/03adee3dfdc59066182d66f6e291d8d4.png"><br><br>  Good afternoon, dear visitors Habr. <br><br>  I want to share with you my small script that can be used using the Bookmarklet technique on almost any site.  So‚Ä¶ 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What is it? </h4><br><br>  As you can see from the title, this is the game "tag".  A feature of this game is that it uses the current visible image of the page.  During the development, the library used <a href="http://html2canvas.hertzen.com/">html2canvas by</a> Nicholas von Herzen (Niklas von Hertzen), which allows you to take a screenshot in the browser on the user's side, and place the result on canvas.  It is this image (or part of it) that will be the source for the Fifteen game board. <br><br><a name="habracut"></a><br><br><h4>  Why is this? </h4><br><br>  As they say, just for fun.  Just because of the alteration on one of my sites, I wanted to embed some Easter egg into the site.  Initially, the idea was that the site ‚Äúcrumbled‚Äù from the screen after a certain time or click in some special place.  But then I thought that interactivity, which requires user actions, will be somewhat more interesting.  The choice fell on the tag. <br><br><h4>  How it works? </h4><br><br>  As already mentioned, the game uses the html2canvas library to create screenshots in the user's browser.  The library is written in pure JavaScript, but incorporates the jQuery plugin, which I used. <br><br>  The basic use of the library is extremely simple: <br><br> <code>$(element).html2canvas({ <br> onrendered: function(canvas) { <br> // ...   <br> } <br> }); <br></code> <br><br>  As a parameter, the newly created canvas is passed to the callback function. <br><br>  The script I created is essentially a jQuery plugin.  Calling him is very simple: <br><br> <code>$('body').puzzle15({ <br> tileCount: 4 <br> }); <br></code> <br><br>  At the same time, not only body can be a selector, but practically any element as well.  However, working with something different from the body has hardly been tested.  I would be happy to bug reports and constructive criticism.  Just in case, I will clarify that only the first element of the set is taken, so the tags on the screen will be only one, despite the selector.  In this case, the entire visible surface of the element is used to generate the playing field, no matter how large (or small) it is.  In order to not peep the original element, an additional div substrate is used. <br>  If you use body for the game, then unlike the one described above, only the part visible on the screen will be used for the playing field.  And in order that the user could not twist up or down, scrolling is turned off and a fixed position is set for the playing field.  However, any window resizing handling is missing.  The way to turn off the scrolling I spied <a href="http://stackoverflow.com/questions/3656592/programmatically-disable-scrolling%3Fanswertab%3Dvotes">here</a> . <br><br>  I don‚Äôt see much sense in describing how the "tags" are arranged, since I already had it on Habr√©, and I don‚Äôt have much to do with the subject matter.  Well, in general, the code is quite simple, contains small comments, so there should be no understanding of the problems.  Nevertheless, I am ready to answer questions and participate in constructive discussions. <br><br><h4>  I want to play already.  Where to click? </h4><br><br>  To install this game, you need to go <a href="http://5x5.cz/habr/js/bookmarklet.html">here</a> and move the link <u>html2canvas + puzzle 15</u> to the bookmarks bar.  After you have moved it, open any site (for example, habrahabr.ru) and call the bookmarklet.  In the window that appears, you will need to enter the field dimension. <br>  <i>Immediately I want to warn Opera users</i> : On long pages, Opera terribly slows down while taking a screenshot, but then it still works correctly.  I tested in FF, Chrome, Safari, IE9 and Opera, but only in the latter such a problem arose.  I think if the library could take only partial screenshots, then the hang could be avoided.  In general, if that I warned you. <br><br><h4>  Where to download the source? </h4><br><br>  The full archive, including the bookmarklet, can be downloaded from <a href="">this link</a> . <br>  The sources of the html2canvas library can be <a href="https://github.com/niklasvh/html2canvas">downloaded on github</a> . <br><br>  upd: I noticed that the script does not work on Yandex.  In order to avoid problems with this and other sites, I have disabled in the script the proxying of pictures that are not suitable for the same origin policy.  The fact is that proxying is processed by default on the developer‚Äôs side of html2canvas, and the script sometimes crashes there. <br>  upd2: Some pages that are too long may have the error NS_ERROR_OUT_OF_MEMORY: Component returned failure code: 0x8007000e (NS_ERROR_OUT_OF_MEMORY) [nsIDOMHTMLCanvasElement.height].  Alas, since there is no way to limit the area in the body, the error can not be avoided. </div><p>Source: <a href="https://habr.com/ru/post/150240/">https://habr.com/ru/post/150240/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150231/index.html">Stellarium 0.11.4 released</a></li>
<li><a href="../150233/index.html">TechCrunch Selection: Top 10 Startups from the Y Combinator S12 Day Demo</a></li>
<li><a href="../150235/index.html">Neil Alden Armstrong 1930-2012</a></li>
<li><a href="../150238/index.html">Interview with Charles Wetzerell, author of "Etudes for Programmers"</a></li>
<li><a href="../150239/index.html">How to make an exciting cyber series from mIRC, ICQ, and Firefox windows</a></li>
<li><a href="../150241/index.html">Loginza Snippet for MODX Revolution</a></li>
<li><a href="../150243/index.html">Slackware 14.0 release</a></li>
<li><a href="../150245/index.html">Fall Angry Birds</a></li>
<li><a href="../150247/index.html">In-location Alliance</a></li>
<li><a href="../150248/index.html">Dirtiest job at google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>