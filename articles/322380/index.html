<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>NSRegularExpression and NSDataDetector - Quick Start</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Working with regular expressions in iOS 10 

 Hello! In this article we will discuss how to work with NSRegularExpression and NSDataDetector, 
 all th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>NSRegularExpression and NSDataDetector - Quick Start</h1><div class="post__text post__text-html js-mediator-article">  <b>Working with regular expressions in iOS 10</b> <br><br>  Hello!  In this article we will discuss how to work with NSRegularExpression and NSDataDetector, <br>  all those who are not indifferent are invited under cat. <br><a name="habracut"></a><br><img src="https://media.licdn.com/mpr/mpr/AAEAAQAAAAAAAAP6AAAAJDExMzFmZWUzLTIxYTQtNDUxMi1hOWMyLTMxYmRmMWZkYmU3OA.png" alt="some_text"><br><br><hr><br>  <b>A regular expression</b> is a string or sequence of characters that define a pattern.  With which you can make very flexible search samples in the text. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Suppose we have some text in a line and our task is to find all the listed email addresses in it.  The best tool for this task is regular expressions. <br><br>  Writing R.V.  (Regular Expression) for checking email.  First you need to describe the basic conditions of all possible combinations of types of email addresses.  In the most minimal version, it can be the following: a@b.io <br><br><ul><li>  from 1 character to the box name - up to 64 characters </li><li>  from 1 reserved dog symbol </li><li>  from 1 character of resource name - up to 64 characters </li><li>  from 2 characters of the domain - up to 64 characters </li></ul><br>  We start to make RVs in stages: <br><br>  @ " <font color="red">([a-z0-9])</font> " <br>  - says that the name of the box can contain any letter and any number <br><br><hr><br>  @ "([a-z0-9]) <font color="red">{1.64}</font> " <br>  - says that a group of these characters can be from 1 to 64 characters long <br><br><hr><br>  @ "([a-z0-9 <font color="red">! # $% &amp; '* + - / =? ^ _` {|} ~</font> ]) {1.64} " <br>  - says that you can also specify these characters <br><br><hr><br>  @ "([a-z0-9! # $% &amp; '* + - / =? ^ _` {|} ~]) {1.64} <font color="red">@</font> " <br>  - says that the dog at this place is required <br><br><hr><br>  @ "([a-z0-9! # $% &amp; '* + - / =? ^ _` {|} ~]) {1.64} @ <font color="red">([a-z0-9! # $% &amp;' * + - / =? ^ _ `{|} ~])</font> {1.64}" <br>  - Add all the same characters, only after @ <br><br><hr><br>  @ "([a-z0-9! # $% &amp; '* + - / =? ^ _` {|} ~]) {1.64} @ ([a-z0-9! # $% &amp;' * + - / =? ^ _ `{|} ~]) {1.64} <font color="red">\\.</font> " <br>  - says that the dot character on this place is required <br><br><hr><br>  @ "([a-z0-9! # $% &amp; '* + - / =? ^ _` {|} ~]) {1.64} @ ([a-z0-9! # $% &amp;' * + - / =? ^ _ `{|} ~]) {1.64} \\. <font color="red">([A-z0-9]) {2.64}</font> " <br>  - says that the domain name can contain letters and numbers of the total amount of characters from 2 to 64 characters <br><br><hr><br><img src="https://hsto.org/files/0b1/784/0bc/0b17840bcda8468fb1e7f51796a5fb63.jpg" alt="some_text"><br><br>  We just made a full-fledged regular expression. <br><br><h3>  <b>Incomplete reference book of reserved characters for PB:</b> </h3><br><hr><br><table><tbody><tr><th>  Symbol </th><th>  Value </th></tr><tr><td>  ^ </td><td>  beginning of the line to be checked </td></tr><tr><td>  $ </td><td>  end of line to be checked </td></tr><tr><td>  . </td><td>  any character </td></tr><tr><td>  | </td><td>  logical OR </td></tr><tr><td>  ? </td><td>  preceding character or group of characters is optional </td></tr><tr><td>  + </td><td>  one or more instances of the previous item </td></tr><tr><td>  * </td><td>  any number of instances of the item (including zero </td></tr><tr><td>  \ d </td><td>  numeric character </td></tr><tr><td>  \ D </td><td>  not numbers  symbol </td></tr><tr><td>  \ s </td><td>  whitespace </td></tr><tr><td>  \ S </td><td>  not white space </td></tr><tr><td>  \ w </td><td>  matches any letter or number;  equivalent of [a-zA-Z0-9_] </td></tr><tr><td>  \ W </td><td>  on the contrary, the equivalent of [^ a-zA-Z0-9_], all characters except these </td></tr><tr><th>  Quantifiers </th><th></th></tr><tr><td>  {n} </td><td>  exactly n times </td></tr><tr><td>  {m, n} </td><td>  inclusive M to N </td></tr><tr><td>  {m,} </td><td>  at least m times </td></tr><tr><td>  {, n} </td><td>  no more than n times </td></tr><tr><td>  () </td><td>  group creation </td></tr><tr><td>  [] </td><td>  in such brackets we say, "any character of these, but only one </td></tr></tbody></table><br><h3>  <b>Creating NSRegularExpression</b> </h3><br><pre><code class="objectivec hljs"><span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.mainText = <span class="hljs-string"><span class="hljs-string">@"There's also +39(081)-552-1488 a ‚ÄúBookmark‚Äù button that allows the user to highlight any date, time or location in the text. For simplicity's sake, www.ok.ru you won't +39(081)552 2080 not cover every possible format of date, time and 2693485 location strings that can appear in your text. You'll implement the https://github.com bookmarking functionality +249-54-85 at the very end +39 333 3333333 of the tutorial. vk.com Your first step to getting the search functionality working is to turn standard strings representing regular expressions into http://app.com NSRegularExpression objects."</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span>* pattern = <span class="hljs-string"><span class="hljs-string">@"\\b(in)|(or)\\b"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    "in"  "or" NSRegularExpressionOptions regexOptions = NSRegularExpressionCaseInsensitive; //      NSError* error = NULL; //     NSRegularExpression* regex = [NSRegularExpression regularExpressionWithPattern:pattern options:regexOptions error:&amp;error]; if (error){ NSLog(@"   Regular Expression"); //   pattern    ,      }</span></span></code> </pre> <br><blockquote>  For the sake of justice, I should note that when creating a pattern, we must write in the string not easy \ w, (or any other letter or symbol that is reserved) <br>  and write backslash twice to escape NSString.  \\ w </blockquote><br><hr><br><h3>  <b>NSRegularExpression instance manipulation</b> </h3><br>  <b>Total number of all matches found</b> <br><br><pre> <code class="objectivec hljs"> <span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span> numberOfMatches = [regex numberOfMatchesInString:_mainText options:<span class="hljs-number"><span class="hljs-number">0</span></span> range:<span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, [_mainText length])];</code> </pre><br><br><hr><br>  <b>Returns the range of the first match.</b> <br><br><pre> <code class="objectivec hljs"> <span class="hljs-built_in"><span class="hljs-built_in">NSRange</span></span> rangeOfFirstMatch = [regex rangeOfFirstMatchInString:_mainText options:<span class="hljs-number"><span class="hljs-number">0</span></span> range:<span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, [_mainText length])]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-built_in"><span class="hljs-built_in">NSEqualRanges</span></span>(rangeOfFirstMatch, <span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">NSNotFound</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>))) { <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *substringForFirstMatch = [_mainText substringWithRange:rangeOfFirstMatch]; }</code> </pre><br><br><hr><br>  <b>Get an array of all matches found.</b> <br><br><pre> <code class="objectivec hljs"> <span class="hljs-built_in"><span class="hljs-built_in">NSArray</span></span> *matches = [regex matchesInString:_mainText options:<span class="hljs-number"><span class="hljs-number">0</span></span> range:<span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, [_mainText length])]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">NSTextCheckingResult</span></span> *match <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> matches) { <span class="hljs-comment"><span class="hljs-comment">//===   resultType,   //       if (match.resultType == NSTextCheckingTypeQuote) NSLog(@"!"); NSRange matchRange = [match range]; NSRange firstHalfRange = [match rangeAtIndex:1]; NSRange secondHalfRange = [match rangeAtIndex:2]; }</span></span></code> </pre><br><br><hr><br>  <b>We get the first match of the total</b> <br><br><pre> <code class="objectivec hljs"> <span class="hljs-built_in"><span class="hljs-built_in">NSTextCheckingResult</span></span> *match = [regex firstMatchInString:_mainText options:<span class="hljs-number"><span class="hljs-number">0</span></span> range:<span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, [_mainText length])]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (match) { <span class="hljs-built_in"><span class="hljs-built_in">NSRange</span></span> matchRange = [match range]; <span class="hljs-built_in"><span class="hljs-built_in">NSRange</span></span> firstHalfRange = [match rangeAtIndex:<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSRange</span></span> secondHalfRange = [match rangeAtIndex:<span class="hljs-number"><span class="hljs-number">2</span></span>]; }</code> </pre><br><br><hr><br>  <b>We iterate through the block for each match</b> <br><br><pre> <code class="objectivec hljs"> __block <span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; [regex enumerateMatchesInString:_mainText options:<span class="hljs-number"><span class="hljs-number">0</span></span> range:<span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, [_mainText length]) usingBlock:^(<span class="hljs-built_in"><span class="hljs-built_in">NSTextCheckingResult</span></span> *match, <span class="hljs-built_in"><span class="hljs-built_in">NSMatchingFlags</span></span> flags, <span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span> *stop){ <span class="hljs-built_in"><span class="hljs-built_in">NSRange</span></span> matchRange = [match range]; <span class="hljs-built_in"><span class="hljs-built_in">NSRange</span></span> firstHalfRange = [match rangeAtIndex:<span class="hljs-number"><span class="hljs-number">1</span></span>]; <span class="hljs-built_in"><span class="hljs-built_in">NSRange</span></span> secondHalfRange = [match rangeAtIndex:<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (++count &gt;= <span class="hljs-number"><span class="hljs-number">100</span></span>) *stop = <span class="hljs-literal"><span class="hljs-literal">YES</span></span>; }];</code> </pre><br><br><hr><br>  <b>Finding our pattern in the text and insert the word Sieg in its place !!!</b> <br><br><pre> <code class="objectivec hljs"> <span class="hljs-built_in"><span class="hljs-built_in">NSString</span></span> *modifiedString = [regex stringByReplacingMatchesInString:_mainText options:<span class="hljs-number"><span class="hljs-number">0</span></span> range:<span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, [_mainText length]) withTemplate:<span class="hljs-string"><span class="hljs-string">@"Sieg!!!"</span></span>];</code> </pre><br><br><hr><br><h3>  <b>NSDataDetector class overview</b> </h3><br>  <b>NSDataDetector</b> is a subclass of <b>NSRegularExpression</b> , made for easy searching (links, phone numbers, dates, etc.).  That is, this actual class under its hood contains universal regular expressions for finding the above. <br><br>  Also, the NSDataDetector can call all <b>NSRegularExpression</b> methods, also look for firstMatch / matches for all text, etc. <br><br><h3>  <b>Manipulating the NSDataDetector instance</b> </h3><br><hr><br>  <b>Creating an instance of NSDataDectector</b> <br><br><pre> <code class="objectivec hljs"> <span class="hljs-built_in"><span class="hljs-built_in">NSError</span></span>* error1 = <span class="hljs-literal"><span class="hljs-literal">nil</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">NSDataDetector</span></span>* detector=[<span class="hljs-built_in"><span class="hljs-built_in">NSDataDetector</span></span> dataDetectorWithTypes:<span class="hljs-built_in"><span class="hljs-built_in">NSTextCheckingTypeLink</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">NSTextCheckingTypePhoneNumber</span></span> error:&amp;error]; <span class="hljs-comment"><span class="hljs-comment">/*  ,     NSTextCheckingTypeOrthography NSTextCheckingTypeSpelling NSTextCheckingTypeGrammar NSTextCheckingTypeDate NSTextCheckingTypeAddress NSTextCheckingTypeLink NSTextCheckingTypeQuote NSTextCheckingTypeDash NSTextCheckingTypeReplacement NSTextCheckingTypeCorrection NSTextCheckingTypeRegularExpression NSTextCheckingTypePhoneNumber NSTextCheckingTypeTransitInformation */</span></span></code> </pre><br><br><hr><br>  <b>Number of matches found in the text</b> <br><br><pre> <code class="objectivec hljs"><span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span> numberOfMatchesFromDetect = [detector numberOfMatchesInString:_mainText options:<span class="hljs-number"><span class="hljs-number">0</span></span> range:<span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>,[_mainText length])];</code> </pre><br><br><hr><br>  <b>All matches in one array (it contains NSTextCheckingResult objects)</b> <br><br><pre> <code class="objectivec hljs"> <span class="hljs-built_in"><span class="hljs-built_in">NSArray</span></span>* matchesFromDetect =[detector matchesInString:_mainText options:<span class="hljs-number"><span class="hljs-number">0</span></span> range:<span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>,[_mainText length])]; <span class="hljs-comment"><span class="hljs-comment">// -----         for (NSTextCheckingResult* match in matchesFromDetect) { NSLog(@"------------"); NSRange matchRange = [match range]; if ([match resultType] == NSTextCheckingTypeLink) { NSURL* url = [match URL]; NSLog(@"url = %@",url.absoluteString); } else if ([match resultType] == NSTextCheckingTypePhoneNumber) { NSString *phoneNumber = [match phoneNumber]; NSLog(@"phone = %@",phoneNumber); } }</span></span></code> </pre><br><br><hr><br>  <b>We pass a block on all matches</b> <br><br><pre> <code class="objectivec hljs"> __block <span class="hljs-built_in"><span class="hljs-built_in">NSUInteger</span></span> countForDectect = <span class="hljs-number"><span class="hljs-number">0</span></span>; [detector enumerateMatchesInString:_mainText options:<span class="hljs-number"><span class="hljs-number">0</span></span> range:<span class="hljs-built_in"><span class="hljs-built_in">NSMakeRange</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, [_mainText length]) usingBlock:^(<span class="hljs-built_in"><span class="hljs-built_in">NSTextCheckingResult</span></span> * _Nullable result, <span class="hljs-built_in"><span class="hljs-built_in">NSMatchingFlags</span></span> flags, <span class="hljs-built_in"><span class="hljs-built_in">BOOL</span></span> * _Nonnull stop) { <span class="hljs-built_in"><span class="hljs-built_in">NSRange</span></span> matchRange = result.range; <span class="hljs-built_in"><span class="hljs-built_in">NSLog</span></span>(<span class="hljs-string"><span class="hljs-string">@"In Enumerate = %d, \tRange = %@\t \tText = %@"</span></span>,countForDectect, <span class="hljs-built_in"><span class="hljs-built_in">NSStringFromRange</span></span>(matchRange), [_mainText substringWithRange:matchRange]); countForDectect++; }];</code> </pre><br><br><hr><br>  <b>Brief documentation of properties</b> <br><table><tbody><tr><th>  Property instance NSRegularExpression </th><th>  Treatment </th></tr><tr><td>  var pattern: String </td><td>  Returns a regular expression pattern. </td></tr><tr><td>  var options: NSRegularExpression.Options </td><td>  Returns the search parameters for example: look for case insensitive NSRegularExpressionCaseInsensitive. </td></tr><tr><td>  var numberOfCaptureGroups: int </td><td>  Returns the number of groups from the regular expression pattern, for example: @ ¬ª^ (ab | bc) (amg | img) $" - here are two groups </td></tr></tbody></table><br>  Everyone who read to the end and put a thumbs up, I will be very grateful. <br>  The project can be found at this link: <a href="https://github.com/HackDeveloperUA/NSRegularExpression_Example/tree/master">here</a> </div><p>Source: <a href="https://habr.com/ru/post/322380/">https://habr.com/ru/post/322380/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322370/index.html">Genetic Algorithms and Turing Machine</a></li>
<li><a href="../322372/index.html">We write simple DSL on Kotlin in 2 steps</a></li>
<li><a href="../322374/index.html">Three-letter service quality</a></li>
<li><a href="../322376/index.html">Elixir and Angular 2 without Hello, world !, or Implementing work with the tree directory, part 1</a></li>
<li><a href="../322378/index.html">Warm up before the weekend: Raspberry Pi, Arduino and free evening</a></li>
<li><a href="../322384/index.html">Video of reports from Go 1.8 release party Moscow</a></li>
<li><a href="../322386/index.html">Ping and some of its parameters</a></li>
<li><a href="../322388/index.html">On the structure and scaling of complex applications for Node.JS</a></li>
<li><a href="../322390/index.html">25 Android libraries that are definitely worth using in early 2017</a></li>
<li><a href="../322392/index.html">Neural networks: practical application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>