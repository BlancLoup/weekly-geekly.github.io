<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We use MVVM in Unity3D using NData</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! In this post I would like to tell you, my favorite Habr, about the plugin, which increased my productivity in working with UI several times. Th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We use MVVM in Unity3D using NData</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/69a/4f0/b82/69a4f0b82fb64910931713b8e0f41fe6.jpg"><br><br>  Hello!  In this post I would like to tell you, my favorite Habr, about the plugin, which increased my productivity in working with UI several times.  The link with which I work is as follows: Unity3D + <a href="https://www.assetstore.unity3d.com/en/">NGUI</a> + <a href="https://www.assetstore.unity3d.com/en/">NData</a> .  Optionally, you can use IoC + DI, but the ideal option to work under iOS, Android and WinPhone, until it was found. <br><br>  You can read about the pattern <a href="http://habrahabr.ru/post/215605/">here</a> or <a href="https://ru.wikipedia.org/wiki/Model-View-ViewModel">here</a> .  One of the spikes is data binding, i.e.  linking the view with the data and automatically notifying that the data of the desired view is changed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Information about the NData plugin can be found <a href="http://tools.artofbytes.com/ndata">on the website</a> .  And yes, it costs $ 45) <br><br>  (in the picture above one of the last games that I collected using Unity3d + NGUI + NData) <br><a name="habracut"></a><br>  <b>As it was</b> <br><br>  Previously, to make a user interface, you had to create one / several classes (GUIManager, MenuView, GameViewetc.), Which contained references to the components of visual elements (UILabel, UISprite, UIGrid, etc.).  Then it was necessary to update this component in some place.  I had a change in presentation in the same classes.  But similar actions began to appear, such as: <br>  - depending on the variable of type bool show / hide element <br>  -update if string variable has changed <br>  -if some condition is met, for example, Points&gt; 5, then show / hide an element <br><br>  Those.  I had to write the same type of code all the time.  They even began to think how to simplify it.  And here‚Ä¶ <br><br>  <b>Meet NData</b> <br><br>  My friend once told me about NData.  And when he demonstrated filling and managing the list of items in the grid using two components and one property, I was amazed.  Here it is, the speed of development! <br><br>  I will quote the list of features with of.  site: <br><blockquote>  - Two-way text bindings (including multi-bindings) with native .NET formatting capabilities. <br>  - Two-way float bindings for sliders. <br>  It is also possible to make sure that it is free. <br>  - Command bindings for your buttons. <br>  It is a list of items for your code. <br>  - Code snippets for Visual Studio and Mono Develop. <br>  - Editor script for bindings validation. <br></blockquote><br>  As you can see, almost any application can be built on this list of binders.  What I, actually, am doing lately. <br><br>  Not everything is so smooth in reality.  After importing the plugin, errors are corrected and need to be corrected.  I <a href="https://www.youtube.com/playlist%3Flist%3DPLblKT4qEvf5Mj-E50lkY9vITsqKfPpPjs">recorded the vidos</a> how to install the plugin, how to work with components, etc. <br><br>  What is binding?  This is the usual MonoBehaviour script that binds this UI element to some variable in the code via reflection.  A variable is created of a special generic type (for example, Property), which adds the ability to notify you when a variable is changed. <br><br><img src="https://habrastorage.org/files/204/096/b78/204096b781fe4c03be4abb6c3854ea7e.jpg"><br>  (text binding in variable with text in UILabel) <br><br><img src="https://habrastorage.org/files/538/dfc/bfc/538dfcbfcd5a473c8815004de66b2285.jpg"><br>  (binding event of pressing the button to the method) <br><br>  Grid example: <br>  1. Create a collection of views (+ the view itself) that we want to cram into the grid / table <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> EZData.Collection&lt;ProductItemContext&gt; _privateItems = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EZData.Collection&lt;ProductItemContext&gt;(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> EZData.Collection&lt;ProductItemContext&gt; Items { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _privateItems; } }</code> </pre> <br><br>  2. We bind it to the table / grid through binding and assign a prefab to which we will bind a view of the table element: <br><img src="https://habrastorage.org/files/901/17c/ef6/90117cef6c4c4a2bb700ffa4ceb8461b.jpg"><br><br>  3. Somewhere in the code we are working with a collection (Add, Remove, Clear, GetItem (n)) and all changes will be displayed on the screen. <br><pre> <code class="cs hljs">... Items.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProductItemContext(prod)); ...</code> </pre><br><br>  Ready code can be inserted from <a href="http://tools.artofbytes.com/ndata/documentation">templates / snippets</a> <br><br>  <b>Pechalka</b> <br><br>  It would be all very nice if it did not affect the speed of the application. The same VisibilityBinding makes a passage through the entire object hierarchy and turns off the UIWidget.  Those.  GetComponents () all the time, which is sad. <br><pre> <code class="cs hljs">... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetVisible</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Transform tr, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> visible</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collider <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tr.GetComponents&lt;Collider&gt;()) { collider.enabled = visible; } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> widget <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tr.GetComponents&lt;UIWidget&gt;()) { widget.enabled = visible; } } ...</code> </pre><br><br>  This is the way to check the text changes. <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(_characterName != NewCharacterName){ _characterName = NewCharacterName; } }</code> </pre><br>  The source code is different, but the principle is the same. <br><br>  All my ‚Äúhacks‚Äù for optimization ended up with the inheritance of the NguiBaseBinding class from CachedMonoBehaviour, in which transform and gameObject are cached.  There is an idea how to optimize the constants GetComponent: make a flag for bindings, indicating that the element is static and its components can be cached + make its own implementation of GetComponent, which would take a component from the cache by the flag.  But it looks like a crutch for a crutch) <br><br>  In general, in a situation where you need to frequently change the visibility, it is easier to move an element to some outrageous coordinates, it will be much faster (for example, if we turn off the window with many elements, then simply transfer it to x: 10000 y: 10000 z: 0 and no need to go through the whole hierarchy and look for components). <br><br>  <b>Total</b> <br><br>  Now collecting UI has become much more fun and easier.  The list of bindings covers almost all requests.  If suddenly something is not there, then you can easily add your binding, and this is done very simply.  I use both for toys and for business applications. <br><br>  Of course, this is not a ‚Äúgolden bullet‚Äù, but the universality of this solution is striking.  I use it along with Uniject (IoC + DI, which doesn‚Äôt work under WinPhone), so I forgot about NullReferenceException long ago (no need to worry about creating / destroying objects, setting references to objects) and you can easily replace model / services / views. <br><br>  Habrahabrovtsy, share, please, your experience developing interfaces! <br><br>  Thanks for attention! <br><br>  PS <s>After the release of the game faced with many cries that it is a game of perverts / for perverts / the name of the worst in the world / uporoty bear, etc.</s>  <s>We did not think that everyone would associate the name exclusively with the notorious Pedobir) Do they have something in common except consonance?</s>  Change the name) </div><p>Source: <a href="https://habr.com/ru/post/240875/">https://habr.com/ru/post/240875/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../240861/index.html">Some interesting and useful things for web developer # 31</a></li>
<li><a href="../240865/index.html">FBI against encryption on smartphones</a></li>
<li><a href="../240867/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ 130 (October 12 - 19, 2014)</a></li>
<li><a href="../240869/index.html">Brick Drone - quadcopter from LEGO constructor</a></li>
<li><a href="../240871/index.html">Signature of object code with a certificate from StartSSL. Steps - paid, received, signed</a></li>
<li><a href="../240877/index.html">The role of big data in private investigations and analysis</a></li>
<li><a href="../240881/index.html">The story of how Apple taught me to make a quality product</a></li>
<li><a href="../240883/index.html">Discover the Oro Platform</a></li>
<li><a href="../240885/index.html">How to change the parameters of accelerating the movement of the mouse cursor in Mac OS</a></li>
<li><a href="../240887/index.html">Why do I need a blog on Habr√©: experience Madrobots</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>