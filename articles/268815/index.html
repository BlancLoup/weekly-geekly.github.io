<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Not all widgets are equally useful.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometimes webmasters and site owners voluntarily (of course, unknowingly) install on their site components that threaten both visitors and the site it...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Not all widgets are equally useful.</h1><div class="post__text post__text-html js-mediator-article">  Sometimes webmasters and site owners voluntarily (of course, unknowingly) install on their site components that threaten both visitors and the site itself.  This is mainly true for lovers of freebies: free premium templates, ‚Äúzeroed‚Äù commercial CMS, plugins downloaded not from the developer‚Äôs site, and other ‚Äúfreebies‚Äù.  You can safely add javascript and flash widgets for the site to this list: a calendar, an mp3 player, a calculator, a currency converter - all these elements, besides useful functional elements of the site, can bring a whole bundle of unwanted content or even distribute malicious code, infecting computers and mobile devices of site visitors. <br><br>  At first glance, such widgets only place ‚ÄúVasya Pupkin‚Äù on the pages of their personal blogs, but over the past week I have been able to analyze three commercial and fairly visited projects that also used infected widgets (one placed a calculator to calculate the amount of the order, the second - a calendar on the news site, the third - online radio). <br><br><img src="https://habrastorage.org/files/666/710/219/6667102194954635886cc0f98b473b78.png"><br><a name="habracut"></a><br>  The situation with the spread of malicious code through widgets is aggravated by the fact that the directories and aggregators of these resources are displayed in the first lines of search engines for targeted queries, which clearly increases the likelihood of their use by webmasters. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/c21/2b3/6d1/c212b36d153d45cfbd5ee74d80ae74f9.png"><br><br>  So, what problems appeared on sites where infected widgets were installed?  Redirects were always executed, but they depended on the platform and browser: <br><br>  1. When entering from <b>an android device,</b> as a result of a series of redirections, a viral .apk file was downloaded to the visitor's device under the guise of an update of system components or antivirus for mobile. <br><br>  2. When logging in from a <b>browser on Mac OS,</b> the visitor‚Äôs platform was transferred to the site, which notified that viruses were detected on the computer and that it is necessary to immediately install the application under the guise of antivirus. <br><br><img src="https://habrastorage.org/files/57d/c2f/39d/57dc2f39d2d240678c57d2ea1a0b5f93.png"><br><br>  3. When visiting pages from a <b>browser under Windows</b> , the visitor opened popander or redirected to various affiliate programs. <br><br>  The redirect was performed once a day for one IP when the Referer field was set, which made it somewhat difficult to detect problems when viewing the widget code in the browser or when re-entering the site during the day.  For illustration, here is the result of loading the widget with and without the Referer field set: <br><br><img src="https://habrastorage.org/files/984/011/f03/984011f030624f698514ab47f3c82f2e.png"><br><br>  Analyzed widgets with redirects were loaded from two aggregators: <br><br>  <b>101widgets.com</b> <br><br><img src="https://habrastorage.org/files/26d/b24/d6d/26db24d6de734ca5948d59e894725772.png"><br><br>  <b>widgetsmonster.com</b> <br><br><img src="https://habrastorage.org/files/072/004/c3f/072004c3fe384ba7997314e8b4c6c369.png"><br><br>  Further search revealed a number of sites of the same owner: <br><br>  xuxu.org.ua <br>  widgetok.com <br>  mygold.pp.ua <br>  <a href="http://www.mygold.pp.ua/">www.mygold.pp.ua</a> <br>  widgeta.net <br><br>  At one time, a similar problem was in the ‚ÄúOne Button‚Äù service, which, together with the payload in the form of a bookmark service and the ‚Äúshare‚Äù function, loaded the code of mobile and WAP affiliate programs.  It looked like this: <br><br><img src="https://habrastorage.org/files/8b2/fc4/2ff/8b2fc42ff5424bbab4ebb2359fc3277a.jpg"><br><br>  But lately, more and more webmasters have <s>been</s> using <s>pluso,</s> share.yandex.ru, widgets from VKontakte, Facebook and other major services, so I haven‚Äôt come across sites with the ‚ÄúOK‚Äù widget installed for a long time. <br><br>  Unfortunately, such problems with widgets cannot be detected by checking the site files with antivirus or specialized malware scanners, no matter how effective they are.  Since the code of the widget itself is not malicious, and redirects result from unauthorized uploading of third-party scripts along with loading of the flash code.  An effective way to detect "left" scripts when loading pages is to use traffic sniffers (Fiddler, Wireshark, Charles, etc).  Analysis of HTTP traffic will help identify the causes of redirects, advertising banners, popanders, etc. <br><br>  As a solution to problems with redirects (except, of course, deleting the source of the redirect itself from the site), you can also advise you to configure CSP rules by adding to the trusted only those sources of code and data (hosts) that you are sure of.  This will help get rid of the "left" transitions in the statistics of site visits, which is now quite a frequent occurrence. <br><br>  In conclusion, I would like to once again draw the attention of web developers and site owners to the sources from which scripts, widgets and templates are loaded.  You should not install hacked commercial components and plug-ins, or free ones, but not downloaded from the official site or the developer repository.  Such simple rules will significantly reduce the likelihood of voluntary placement of unauthorized advertising, backdoors, spam links, mobile redirects, or malicious code on your site.  And, of course, if you use widgets from one of the domains listed in the article, it is better to remove them from the site. </div><p>Source: <a href="https://habr.com/ru/post/268815/">https://habr.com/ru/post/268815/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268805/index.html">3CX Softphone got the BLF panel, import from Google and ...</a></li>
<li><a href="../268807/index.html">ZFS on CentOS: work on the bugs</a></li>
<li><a href="../268809/index.html">The task of Alexander Ivanovich Koreyko</a></li>
<li><a href="../268811/index.html">How to protect your company from zero-day attacks</a></li>
<li><a href="../268813/index.html">Engineering infrastructure as the basis of the information system</a></li>
<li><a href="../268817/index.html">Jii: Scalable comets server and client</a></li>
<li><a href="../268819/index.html">Adobe has updated its products</a></li>
<li><a href="../268821/index.html">CISCO 7942G and 7940 phones in conjunction with Asterisk 11</a></li>
<li><a href="../268823/index.html">How to install Nutanix CE under VMware ESXi</a></li>
<li><a href="../268825/index.html">Angular XSLT module</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>