<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Installing a VNC server on VDS and tuning recommendations</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This guide is focused on virtual servers (VDS / VPS), which are accessed via VNC via the Internet. This sets the main priorities - economical use of s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Installing a VNC server on VDS and tuning recommendations</h1><div class="post__text post__text-html js-mediator-article">  This guide is focused on virtual servers (VDS / VPS), which are accessed via VNC via the Internet.  This sets the main priorities - economical use of server resources and work on a fast enough channel.  As the base system on which the installation is performed, the minimal installation of Ubuntu 9.10 is used.  With minor changes, this guide applies to other Linux distributions and Unix family operating systems, as well as to configure VNC on regular dedicated servers and on servers in the local network. <br><br>  * Ways to organize the work of VNC-servers <br>  ** Embedded VNC server in hardware emulators (Xen / HVM, VMWare, Qemu) <br>  ** VNC server associated with a running X server (GNOME vino) <br>  ** VNC server with embedded X server <br>  *** Manual VNC Server <br>  *** VNC server running in daemon mode <br>  *** VNC server running via inetd <br>  * Select VNC server <br>  * Tuning server <br>  ** Tuning the desktop <br>  ** VNC server options <br><a name="habracut"></a><br><h4>  Ways to organize the work of VNC-servers </h4><br>  The main ways of organizing remote work with a graphic desktop on virtual servers: <br><br>  1. Built-in VNC server in hardware emulators (Xen / HVM, VMWare, Qemu) <br>  2. VNC server associated with a working X server (GNOME vino) <br>  3. VNC Server with Embedded X Server <br>  3.1 Manually started VNC server <br>  3.2 VNC server running in daemon mode <br>  3.3 VNC server running via inetd 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Consider these methods and evaluate their advantages and disadvantages. <br><br><h5>  1. Built-in VNC server in hardware emulators (Xen / HVM, VMWare, Qemu) </h5><br>  Many virtualization platforms that support hardware emulation (VMWare, Qemu, Xen in HVM mode) provide a virtual machine with virtual devices ‚Äî a graphics adapter, a keyboard, a mouse ‚Äî that simulate the operation of actually existing devices.  The operating system in the virtual machine treats them as with ordinary hardware, not distinguishing the difference.  The program that manages the virtual machine can link these emulated devices with the VNC server embedded in it, redirecting the information displayed on the graphics adapter of the virtual machine to the VNC client and transmitting the keystroke information received from the VNC- customer  For the operating system and the programs running in the virtual machine, the existence of the VNC server and the VNC client imperceptibly, they do not require additional drivers or settings ‚Äî only the standard drivers of the hardware that emulates the virtualization platform. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/173/873/a06/173873a06b6837f8f1dda5fe7c7f9bd2.png"></a> <br>  <i>1. VNC-client connected to the VNC-server of the Xen virtual machine in HVM mode, the moment of booting the FreeBSD OS.</i> <br><br>  In Xen, the VNC server for a virtual machine is enabled by specifying the vnc type in the <b>vfb</b> configuration parameter.  Additional options in this parameter: <b>vnclisten</b> - indicates the IP address on which the VNC server accepts connections;  <b>vncpasswd</b> is the password that the VNC client must communicate. <br><br>  For example, adding a line to the virtual machine configuration file: <br><br> <code>vfb = [ 'type=vnc,vnclisten=0.0.0.0,vncpasswd=qwerty' ]</code> <br> <br>  means the inclusion of a VNC server that accepts connections on all available IP addresses and requires authorization with the qwerty password. <br><br>  The main and exhaustive advantage of using a virtualization platform VNC server: simplicity - just enable VNC server support in the virtual machine settings. <br><br>  The main disadvantages: a very large expenditure of resources on the site of equipment emulation and a limited number of virtualization platforms that support this feature. <br><br><table><tbody><tr><th>  pros </th><th>  Minuses </th></tr><tr><td><ul><li>  Easy to turn on </li></ul><br></td><td><ul><li>  A small number of virtualization platforms </li><li>  Resource consumption for equipment emulation </li><li>  The cost of data transfer between the virtual machine and the supervisor </li><li>  Resource consumption for constantly running X-server and desktop programs </li><li>  Only one user can work with the desktop at a time. </li></ul><br></td></tr></tbody></table><br><br>  For some virtualization platforms, there is also a less resource-intensive option, in which, instead of emulating a real graphics device, a simplified abstraction is transferred to the virtual machine - the framebuffer.  Xen supports a framebuffer as a virtual machine graphics adapter; for XFree86 and X.org X servers, there are screen drivers for the framebuffer.  When using a framebuffer, processor and RAM costs for emulating real hardware are eliminated, but all other shortcomings remain. <br><br><h5>  2. VNC server associated with a working X server (GNOME vino) </h5><br>  The option is best suited for remote access to the desktop of a regular computer (desktop, home).  Accessing the desktop via VNC in GNOME is trivially included ‚Äî simply enable the options in the <b>System</b> menu in the <b>System / Preferences / Remote Desktop</b> section.  When they are turned on, the GNOME VNC server (vino) that is tied to the display of the X server and completely duplicates the information displayed on the screen for the VNC client is launched. <br><br>  But on a virtual server, everything becomes more complicated.  First, you need to start the X server in some way, for example, on the virtual machine emulated graphics adapter, and only after that it will be possible to allow VNC access to the display of this X server in the manner described above.  Compared with the VNC server on the hardware emulator, plus only one: lower emulation costs.  But the remaining disadvantages remain and a new one appears - a more time-consuming setting.  All together makes this option the worst candidate for a virtual server. <br><br><table><tbody><tr><th>  pros </th><th>  Minuses </th></tr><tr><td><ul><li>  Less emulation overhead </li></ul><br></td><td><ul><li>  A small number of virtualization platforms </li><li>  Resource consumption for equipment emulation </li><li>  The cost of data transfer between the virtual machine and the supervisor </li><li>  Resource consumption for constantly running X-server and desktop programs </li><li>  Only one user can work with the desktop at a time. </li><li>  Complication of initial setup </li><li>  The function must be supported by the desktop environment. </li></ul><br></td></tr></tbody></table><br><h5>  3. VNC Server with Embedded X Server </h5><br>  There are a number of programs - VNC-servers, which independently act as the X-server for applications.  Unlike the standard X-server that works with real devices (graphics adapter, keyboard, mouse) or emulates them in virtual machines, the X-server integrated into the VNC server, this functional part is not required - instead of hardware, only VNC- by the client.  The X-server embedded in the VNC server does not require complex configuration or computational resources for working with equipment, so this option is best suited for virtual servers. <br><br>  In Ubuntu 9.10, the <b>vnc-server</b> virtual package offers two alternatives as a VNC server: <b>vnc4server</b> (RealVNC) and <b>tightvncserver</b> (TightVNC).  There is no significant difference between them, there are only small nuances in their use, which will be described later.  Now consider the vnc4server. <br><br>  Minimum OS installations for VDS, as a rule, do not include graphical environments, so you also need to install GNOME.  To install the RealVNC server and GNOME, it‚Äôs enough to install two packages: <br><br> <code>apt-get install vnc4server gnome-core</code> <br> <br><h6>  3.1 Manually started VNC server </h6><br>  The default settings allow you to use the VNC server without additional configuration immediately after installation.  We start from the command line the VNC server that creates the X server on the zero display (and accepts the VNC connections on port 5900): <br><br> <code>vncserver :0</code> <br> <br>  and on the created null display, launch GNOME: <br><br> <code>DISPLAY=:0 gnome-session</code> <br> <br>  When you first start, <b>vncserver</b> will ask <b>you</b> to set a password that you will need to enter in the VNC client when connecting.  To change the password for the VNC server, use the <b>vncpasswd</b> command. <br><br>  But every time you log into the server via SSH and start the VNC server manually - the option is not suitable for everyday work.  It is preferable to configure the automatic start of the VNC server. <br><br><h6>  3.2 VNC server running in daemon mode </h6><br>  In order not to manually start the VNC server after each reboot, you can add it to the starting procedure.  If you wish, you can build a full-fledged set of scripts for upstart, but in practice it is enough to do by adding lines to <b>/etc/rc.local</b> : <br><br> <code>su -l $USER -c "vncserver :0"</code> <br> <br>  where as $ USER you need to specify the user login for which the desktop is started.  If necessary, you can simultaneously run multiple VNC servers for the same or different users on different displays. <br><br>  When a VNC client is disconnected, the desktop session and the running programs do not terminate, but continue to work in the same way as with a connected VNC client.  When you reconnect the VNC client to this display, the user will end up in the same desktop session as if there were no disconnects.  Several VNC clients can connect to the same VNC server (X-display) and they will work with the same desktop. <br><br><table><tbody><tr><th>  pros </th><th>  Minuses </th></tr><tr><td><ul><li>  Independent of the virtualization platform </li><li>  No emulation resources </li><li>  No resources are spent on working with hardware drivers </li><li>  Multiple users can work simultaneously </li><li>  When the VNC client is disabled, the desktop session is not interrupted </li></ul><br></td><td><ul><li>  Resource consumption for constantly running X-server and desktop programs </li></ul><br></td></tr></tbody></table><br><h6>  3.3 VNC server running via inetd </h6><br>  It is possible to start a VNC server only on demand - when a VNC client is connected.  To do this, the port of the VNC server 5900 is transferred to the inetd daemon for maintenance.  As long as there is no connected VNC client, no VNC server will be started.  When a client requests a connection, inetd starts the VNC server and associates the client with it.  The VNC server creates a display and starts a work session.  After disconnecting the client, the VNC server closes the session and terminates all programs that work with the display. <br><br>  When several clients are connected to the same port, each will run a separate VNC server with its own display.  Thus, all connected clients will have independent work sessions.  This allows using GDM authentication to easily configure the system for multi-user work - after the connection, the username and password of the virtual server user are requested, after they are entered correctly, the working session of this user will be started. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/2ed/f4a/ac3/2edf4aac3d551100421e9cc2b26527ff.jpg"></a> <br>  <i>2. User authorization via GDM when connecting to a VNC server.</i> <br><br>  In addition to the RealVNC and GNOME server already installed, we will need to install gdm and xinetd. <br><br> <code>apt-get install xinetd gdm-2.20</code> <br> <br>  First you need to configure the GDM display manager: allow receiving requests for user authentication via XDMCP and disable launching the X server from gdm.  Edit the <b>/etc/gdm/gdm.conf</b> configuration file according to the patch: <br><br> <code>--- /etc/gdm/gdm.conf.orig 2009-09-11 23:46:30.000000000 +0400 <br> +++ /etc/gdm/gdm.conf 2009-11-30 02:36:06.000000000 +0300 <br> @@ -311,3 +311,3 @@ <br> # the security of XDMCP. <br> -Enable=false <br> +Enable=true <br> # Honor indirect queries, we run a chooser for these, and then redirect the <br> @@ -604,3 +604,3 @@ <br> # <br> -0=Standard device=/dev/console <br> +#0=Standard device=/dev/console</code> <br> <br>  or save the patch to the <b>/tmp/gdm.conf.patch</b> file and use it with the command: <br><br> <code>patch /etc/gdm/gdm.conf /tmp/gdm.conf.patch</code> <br> <br>  In order for xinetd to start the VNC server, create for it the configuration file <b>/etc/xinetd.d/xvnc</b> with the following contents: <br><br><pre> <code class="hljs pgsql">service xvnc { <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> = UNLISTED <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> socket_type = stream protocol = tcp wait = <span class="hljs-keyword"><span class="hljs-keyword">no</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> = gdm <span class="hljs-keyword"><span class="hljs-keyword">server</span></span> = /usr/bin/Xvnc server_args = -inetd -query <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> -once -SecurityTypes <span class="hljs-keyword"><span class="hljs-keyword">none</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">extension</span></span> XFIXES port = <span class="hljs-number"><span class="hljs-number">5900</span></span> }</code> </pre> <br><br>  The Xvnc startup arguments must include <b>-inetd</b> , letting the VNC server know that it is started via the inetd daemon, and <b>-query 127.0.0.1</b> , meaning that when the VNC server starts, it will need to authenticate the user via the local display manager (GDM ).  The <b>-once</b> option reports that after disconnecting the client, the X server must also be disabled.  <b>-SecurityTypes</b> none disables its own VNC server authorization, as users are authenticated via gdm. <br><br>  Restart xinetd and gdm commands: <br><br> <code>service gdm restart <br> service xinetd restart</code> <br> <br>  We start the VNC client and connect to our server.  Enter the username and password of the system user, and get a standard desktop: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/396/bbb/9c3/396bbb9c38e786f26d5eb59400cebbf5.png"></a> <br>  <i>3. Ubuntu 9.10, GNOME desktop.</i> <br><br>  The main advantage of the inetd method is the lack of consumption of resources for the operation of the X server and desktop programs without VNC clients.  An additional plus is full-fledged multi-user work: everyone connects to a standard VNC port, the number of users is unlimited. <br><br><table><tbody><tr><th>  pros </th><th>  Minuses </th></tr><tr><td><ul><li>  Minimal use of resources in the absence of VNC clients </li><li>  Independent of the virtualization platform </li><li>  No emulation resources </li><li>  No resources are spent on working with hardware drivers </li><li>  Full multiplayer work </li></ul><br></td><td><ul><li>  More complex setup </li></ul><br></td></tr></tbody></table><br><h4>  VNC server selection </h4><br><br>  In Ubuntu 9.10, the standard distribution has two VNC servers: <b>vnc4server</b> (RealVNC) and <b>tightvncserver</b> (TightVNC). <br><br>  There are problems with some clients with RealVNC as a server.  For example, a number of versions of the TightVNC and UltraVNC clients cannot use compression algorithms with this server, which leads to slower work through the Internet.  The server TightVNC such problems with clients is not observed.  In addition, unlike RealVNC, the TightVNC server supports the Tight encoding algorithm, which allows you to compress data using JPEG ‚Äî when displaying photos and other complex images, this significantly reduces the amount of data transferred.  Otherwise, there are no noticeable differences between the servers. <br><br><h5>  Differences in setting up a TightVNC server </h5><br>  In the installation description of the VNC server with inetd, all settings were cited for the RealVNC server.  When used as a TightVNC server, small changes in settings will be required. <br><br>  The TightVNC server does not require the <b>-SecurityTypes none</b> and <b>-extension XFIXES arguments</b> , so the argument string in the <b>xetd</b> <b>/etc/xinetd.d/xvnc</b> configuration file should look like this: <br><br> <code>server_args = -inetd -query 127.0.0.1 -once</code> <br> <br>  You also need to disable keyboard remapping in GNOME, otherwise pressing some keys will not be transmitted correctly.  To do this, you need to set the environment variable XKL_XMODMAP_DISABLE.  The easiest way to do this is to create a file <b>/etc/X11/Xsession.d/10tightvncserver</b> with the contents: <br><br> <code>export XKL_XMODMAP_DISABLE=1</code> <br> <br>  The file will automatically run when the GNOME session starts. <br><br><h4>  Server tuning </h4><br><h5>  Tuning the desktop </h5><br>  Desktop settings can have a noticeable effect on network speed.  The task of reducing the amount of data transferred is reduced to two subtasks: minimizing changes on the screen and using well-compressible images. <br><br><h6>  Font smoothing </h6><br>  Most of the information the user works with is text: windows with text, menus, forms, etc.  The included anti-aliasing of fonts increases by 1.5-3 times the amount of data transmitted when displaying text, as the halftone areas on the borders of characters carry additional poorly compressible information. <br><br>  Anti-aliasing can be turned off in the GNOME Font Settings window, but this deactivation will not work in all programs ‚Äî for example, Firefox will still smooth the fonts.  Therefore, it is better to make settings in the system configuration file <b>/etc/fonts/fonts.conf</b> (the anti-aliasing of all fonts smaller than 14 pixels is disabled): <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"font"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">test</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"size"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compare</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"less"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">double</span></span></span><span class="hljs-tag">&gt;</span></span>14<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">double</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">test</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">edit</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"antialias"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"assign"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bool</span></span></span><span class="hljs-tag">&gt;</span></span>false<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bool</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">edit</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"font"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">test</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pixelsize"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compare</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"less"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">qual</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"any"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">double</span></span></span><span class="hljs-tag">&gt;</span></span>14<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">double</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">test</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">edit</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"assign"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"antialias"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bool</span></span></span><span class="hljs-tag">&gt;</span></span>false<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bool</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">edit</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  <i>The amount of data transmitted and the display speed on the channel 1 Mbit / s drop-down menu (color depth: 16 bits, encoding: Tight):</i> <br><table><tbody><tr><th></th><td>  Subpixel anti-aliasing enabled </td><td>  No smoothing </td></tr><tr><th></th><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/784/480/954/78448095407e63b3ef3adc87872753f0.png"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/d0b/e4c/a07/d0be4ca071ad4da65ab2010e5602ca2e.png"></a> </td></tr><tr><th>  Volume </th><td>  30 Kb </td><td>  13.8 Kb </td></tr><tr><th>  Speed </th><td>  0.24 sec </td><td>  0.11 sec </td></tr></tbody></table><br><h6>  Desktop Background </h6><br>  Desktop background can greatly slow down the work if it will be located a photograph or drawing.  Any minimization of a window or menu entails a redrawing of that part of the background that was covered by it.  And the more complex the image, the more data will be transmitted.  To minimize bandwidth costs in the background, it is recommended to use a single-color background, the best is white. <br><br><h6>  Desktop theme </h6><br>  The design of the interface elements can also affect the amount of data transferred.  To minimize traffic, choose a theme with flat colors, no gradients.  However, many topics that use vertical gradients, are compressed quite well and can be used without significant loss in speed. <br><br><h6>  Font size </h6><br>  Reducing the size of fonts for system menus and text fields entails a decrease in the geometric size of text areas, and consequently, a decrease in the amount of data transferred. <br><br><h5>  VNC server options </h5><br>  The VNC server has many options, but we are interested in the following three: <b>geometry</b> - screen size, <b>depth</b> - color depth, <b>deferupdate</b> - change transfer delay. <br><br><h6>  geometry </h6><br>  Screen size in pixels.  Format: <b>-geometry</b> <i>WIDTH</i> <b>x</b> <i>HEIGHT</i> .  For example, <b>-geometry 800x600</b> is 800 pixels wide and 600 pixels high.  The larger the screen size, the more data there needs to be transferred ‚Äî but there is no direct relationship between them.  When the information on the display changes, the client does not transmit the image of the display completely, but only the section with the changed information - an open window, an open menu item or a printed character.  Therefore, there is no significant gain when using 800x600 instead of 1024x768. <br><br><h6>  depth </h6><br>  Color depth in bits.  Format: <b>-depth</b> <i>NUMBERS</i> , NUMBERS - 8, 15, 16 or 32. The greater the depth of color, the better the semitones and shades are shown, but the more information is required to transmit.  Reducing the depth of color reduces the amount of data, and, accordingly, increases the speed.  For working via the Internet, a 16-bit color depth is quite suitable.  When using a slow channel (&lt;256 Kbps) it is recommended to use a color depth of 8 bits. <br><br>  <i>The amount of data transmitted and the display speed on the channel 1 Mbit / s drop-down menu for different color depths (coding: Tight):</i> <br><table><tbody><tr><th></th><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/f16/849/4fe/f168494febb14cde66f38e9b0854032e.png"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/d0b/e4c/a07/d0be4ca071ad4da65ab2010e5602ca2e.png"></a> </td><td> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/543/1f0/2ae/5431f02aeb1e3ab511ef620ba51a1aa4.png"></a> </td></tr><tr><th>  Color depth </th><td>  24 bits </td><td>  16 bits </td><td>  8 bit </td></tr><tr><th>  Volume </th><td>  15.2 Kb </td><td>  13.8 Kb </td><td>  9 Kb </td></tr><tr><th>  Speed </th><td>  0.12 sec </td><td>  0.11 sec </td><td>  0.07 seconds </td></tr></tbody></table><br><br>  VNC clients have the ability to enforce a reduced 8-bit color depth (256 colors), while ignoring the color depth specified on the server. <br><br><h6>  deferupdate </h6><br>  The delay in sending changes on the display, in milliseconds.  Format: <b>-deferupdate</b> <i>NUMBER_MILLISECOND</i> , the default is 40. Allows you to combine into one update a large number of small screen changes made during the time interval specified in the option.  When you merge several changes that have occurred on the same area of ‚Äã‚Äãthe screen, the total amount of data transferred decreases.  An increase in this parameter impairs interactivity - a visual response to an action is displayed on the VNC client only after the expiration of the <b>deferupdate</b> time.  Taking into account delays in data transmission over the network, the total response delays can reduce the workability. <br><br>  Most of the operations on virtual servers are drawn fairly quickly, and the <b>deferupdate</b> value can be reduced to 10 ms.  In networks with large bandwidth, the delay can be completely disabled by specifying <b>-deferupdate 0</b> . <br><br><h4>  Conclusion </h4><br>  Using the VNC server launched via inetd, along with the tuning recommendations made, allows you to work with the desktop via the Internet, even on entry-level virtual servers.  In total, tuning allows you to reduce delays by 2-5 times, compared with the standard settings.  Starting a VNC server on demand will free up memory for other tasks. <br><br>  For example, the <a href="http://www.truevds.ru/presets.view.linux_ubuntu_9_10_vnc">Ubuntu 9.10 VNC</a> preset compiled according to this scheme provides acceptable work with a desktop on a VDS with a 128 Mb RAM / 320 MHz CPU over an ADSL channel of 1 Mbps.  With an increase in connection speed up to 5-10 Mbit / s and a virtual server power up to 512 Mb RAM / 960 MHz CPU, the work on the level of comfort is close to working with a local computer.  The reaction time for most interface operations is within 0.05-0.2 seconds. <br><br>  <i>The consumption of RAM on Ubuntu 9.10 with a VNC server running via inetd:</i> <br><table><tbody><tr><th>  Running programs </th><th>  Used RAM </th></tr><tr><td>  server without VNC clients connected </td><td>  41 Mb </td></tr><tr><td>  one VNC client, GNOME desktop </td><td>  80 Mb </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> two VNC clients, two GNOME desktop sessions </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 127 Mb </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">one VNC client, GNOME desktop, Firefox launched, </font><a href="http://www.ubuntu.com/"><font style="vertical-align: inherit;">www.ubuntu.com</font></a><font style="vertical-align: inherit;"> website </font></font><a href="http://www.ubuntu.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">launched</font></font></a> </td><td>  121 Mb </td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> one VNC client, GNOME desktop, running text editor OpenOffice.org </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 112 Mb </font></font></td></tr></tbody></table><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Other articles in this series: </font></font><br> <a href="http://habrahabr.ru/blogs/linux/76237/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VNC - remote access to a computer over a network. </font><font style="vertical-align: inherit;">Introduction to VNC. </font></font></a> <br> <a href="http://habrahabr.ru/blogs/linux/76343/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connecting to a remote computer via VNC. </font><font style="vertical-align: inherit;">Work with the VNC client.</font></font></a> </div><p>Source: <a href="https://habr.com/ru/post/77159/">https://habr.com/ru/post/77159/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../77150/index.html">Linq To Twitter: Finding the words, hash tags and interlocutors themselves</a></li>
<li><a href="../77152/index.html">Keyboard for gmail</a></li>
<li><a href="../77154/index.html">C #: Etudes, part 3</a></li>
<li><a href="../77155/index.html">About Trailing Weightspace Say A Word</a></li>
<li><a href="../77156/index.html">As a trader to find an investor. The main misconceptions. Part 1</a></li>
<li><a href="../77160/index.html">Sad experience trying to work with Google AdWords</a></li>
<li><a href="../77163/index.html">Motherboard 6 x 6 cm</a></li>
<li><a href="../77166/index.html">3December - World Computer Graphics Day</a></li>
<li><a href="../77167/index.html">28th edition of Russian Full Circle Magazine</a></li>
<li><a href="../77169/index.html">Marathon with Google Wave father Lars Rasmussen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>