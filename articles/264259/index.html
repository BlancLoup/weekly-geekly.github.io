<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Banana Pi: via U-Boot to Arch Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For the fourth year in a row, since the release of the Raspberry Pi, various microcomputers have been delivered to markets around the world on non-x86...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Banana Pi: via U-Boot to Arch Linux</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/e19/d88/bf3/e19d88bf369041a08a850253983e1fcf.png" align="left" height="200">  For the fourth year in a row, since the release of the Raspberry Pi, various microcomputers have been delivered to markets around the world on non-x86 architectures that act as media centers, smart home controllers, web servers and anything else the geek wants! <br><br>  By 2014-2015, not everyone was pleased with the computing capabilities of the ‚Äúraspberry‚Äù and the release of dozens of its clones with more powerful hardware began.  Most of them have drawbacks: a fixed outdated version of the kernel and bootloader, a small selection of distributions.  Under the cut, I‚Äôll tell you how to throw off the vendor chains with the example of Banana Pi. <br><a name="habracut"></a><br><h4>  Prehistory </h4><br>  In the second half of 2014, I wanted to have a home server, the choice was between the classic x86 architecture with the Intel Atom processor and something new for me - an ARM-based microcomputer. <br><br>  After evaluating the price / performance / capability ratios, the choice fell on a Banana Pi - a baby with a dual-core Allwinner A20, 1 GB DDR3, a gigabit LAN, a SATA connector, and other amenities of similar devices.  After playing for a couple of days, I made a case from plastic parts, in which Banana was sharpened and served for a long time for all sorts of small tasks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The distribution was Bananian - this is Debian 7 Wheezy trimmed in many ways to save resources.  There is no newer Debian 8.x to this day, you can imagine how old the software is there, which receives only security patches.  All this ugliness lasted until mid-summer ... <br><br><img src="https://habrastorage.org/files/979/fba/e29/979fbae296df4009bbde2e57ad643c01.JPG" height="320"><br><br>  Finally in July it became necessary to raise the web server and related services for its pet project.  It was time to change old Debian to something less conservative and more convenient for me. <br><br><h4>  Formulation of the problem </h4><br>  There were several requirements for the distribution: there should be ‚Äúout of the box‚Äù repositories covering all needs, the programs should be closest to the latest available versions.  I follow the development of distributions and their programs, but at the same time I am too lazy to compile everything from sorts, so Arch Linux became the obvious choice. <br><br>  On the manufacturer‚Äôs website in the downloads section, I was waiting for a year overdue image with a wired non-updated kernel (3.4.100), a loader of the same old age from another device (Cubieboard 2).  On the <a href="http://archlinuxarm.org/">Arch Linux</a> site, Banana Pi support was not announced.  Proceeding from all this, there was only one thing left: to build and run the distribution kit itself. <br><br><h4>  Materiel </h4><br><img src="https://habrastorage.org/files/2af/3d2/d76/2af3d2d76d9746faa8e1228e024fd844.jpg"><br><br>  <b>Das U-Boot</b> (the origin of the name is somehow related to submarines and wordplay in German and English, <a href="https://en.wikipedia.org/wiki/U-boat">see U-boat</a> ) <br>  This is an operating system loader, device-oriented, with MIPS, PowerPC, ARM and other architectures.  He can do a lot: loads the system from NAND, NOR, SPI, MMC, SATA, USB, TFTP, NFS, can be stored in the device's ROM or external memory, has a built-in dhcp client and the shell, receives signals from the keyboard, outputs to UART, HDMI , VGA, analog video.  Naturally to support all this you need to have drivers. <br><br>  This is where the difference from x86 platforms begins - ARM does not have ACPI (advanced configuration and power management interface) and UEFI (interaction interface between the operating system and device firmware), and that is why there are no unified distributions for ARM computers, but the movement is <a href="http://ru.fedoracommunity.org/content/arm64-%25D1%2582%25D0%25B5-aarch64-%25D0%25B8-%25D0%25BD%25D0%25B5%25D0%25BF%25D1%2580%25D0%25BE%25D1%2581%25D1%2582%25D0%25BE%25D0%25B9-%25D0%25BF%25D1%2583%25D1%2582%25D1%258C-%25D0%25BF%25D0%25B5%25D1%2580%25D0%25B5%25D1%2585%25D0%25BE%25D0%25B4%25D0%25B0-arm-%25D0%25BD%25D0%25B0-%25D0%25BD%25D0%25BE%25D0%25B2%25D1%258B%25D0%25B5-%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25B4%25D0%25B0%25D1%2580%25D1%2582%25D1%258B">UEFI and ACPI</a> side has been going for several years.  In the meantime, this movement is going on, we are in a real, harsh world and the bootloader needs to be compiled independently for different hardware.  Iron is described in a data structure called <a name="DT_ANCHOR"></a>  <b>Device Tree (dt)</b> .  More about DT can be found on the site dedicated to him: <a href="http://www.devicetree.org/Main_Page">devicetree.org</a> . <br><br>  A set of boot files is supplied with the source code for the compilation, as well as a Device Tree for 1089 devices.  Google, unfortunately, does not find this list, so it is available at the link: <a name="github_gist"></a>  <a href="https://gist.github.com/evgenymarkov/6e8cf27f712d74d23b03">U-boot supported devices</a> . <br><br><img src="https://habrastorage.org/files/9e2/d1a/d78/9e2d1ad78f494782ad1f62eb525b868e.png"><br><br>  <b>Linux Kernel</b> <br><br>  A lot has been written about him, a lot has been said, and now only a few facts are useful: <br><ol><li>  The distributions I have encountered have stored the kernel in several forms: <br><ul><li>  Image is not a compressed image. </li><li>  zImage is a compressed, self-extracting image. </li><li>  uImage is an image that has a wrapper that includes some information for the U-Boot. </li></ul><br>  Previously, uImage was used extensively for devices with U-Boot, but over the past years, the developers have taught the bootloader to work with zImage, which has become a common practice of storing a kernel image in the Arch Linux ARM distribution. </li><li>  Happy news!  The core within the same architecture (ARMv5, ARMv6, ARMv7, ARMv8) is likely not to be compiled for each device.  It uses its version of the <b>Device Tree</b> , called <a name="dtb"></a>  <b>Device Tree Binary (dtb)</b> .  These are small files that tell the kernel which modules to load.  More information about dtb can be found <a href="http://www.armadeus.com/wiki/index.php%3Ftitle%3DKernel-with-device-tree">here</a> . <br></li></ol><br><h4>  From theory to practice </h4><br>  It will take: <br><ul><li>  Banana Pi or another microcomputer from the <a href="https://habr.com/ru/post/264259/">list of</a> supported U-Boot devices </li><li>  Memory card and card reader </li><li>  Linux computer </li><li>  Installed toolchain for the desired architecture <br><div class="spoiler">  <b class="spoiler_title">Where to get?</b> <div class="spoiler_text">  In the simplest way, I consider the following: <br><ol><li>  Download the ready toolchain for your platform from the <a href="https://www.linaro.org/downloads/">Linaro</a> site. <br>  Banana Pi needs <i>linaro-toolchain-binaries (little-endian)</i> . <br></li><li>  Add the bin folder to the PATH: <br><pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> PATH=~/your_toolchain_path/bin/:<span class="hljs-variable"><span class="hljs-variable">$PATH</span></span></code> </pre> <br></li></ol><br></div></div><br></li><li>  The bc and dtc utilities needed to compile the bootloader, the dosfstools and uboot-tools packages for creating the file system and compiling the bootloader scripts, respectively <br></li></ul><br>  Download and unpack the source code of the latest version of U-Boot: <br><pre> <code class="bash hljs">wget ftp://ftp.denx.de/pub/u-boot/u-boot-latest.tar.bz2 tar -jxf u-boot-latest.tar.bz2</code> </pre><br>  We find our <b>piece of hardware</b> in the <b>u-boot-2015.07 / configs</b> directory that appears and remember the name of the file.  For Banana Pi, the configuration file is called <b>Bananapi_defconfig</b> . <br><br>  Also remember that the Arch Linux ARM distribution kernel is stored in a zImage?  This should be taken care of in advance and before compiling add the ability to load self-extracting kernels.  I don‚Äôt have exact information on whether this is already enabled by default, so in the <b>u-boot-2015.07 / include / configs /</b> directory you need to find the header file for your microcomputer platform (for Banana Pi, this is <b>sun7i.h</b> ) and write inside: <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> __CONFIG_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __CONFIG_H ... #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">/* __CONFIG_H */</span></span></span></span></code> </pre><br>  the string <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CONFIG_CMD_BOOTZ</span></span></code> </pre> <br>  This will add the ability to use the <b>bootz</b> command in the bootloader to launch self-extracting compressed programs.  <a href="http://unix.stackexchange.com/questions/122526/how-to-convert-a-zimage-into-uimage-for-booting-with-u-boot"><sup>A source</sup></a> <br><br>  Now the compilation stage.  All operations occur in the directory <b>u-boot-2015.07</b> . <br><div class="spoiler">  <b class="spoiler_title">What if no cross-compilation?</b> <div class="spoiler_text">  If you compile on the same architecture (for example, on a computer with ARMv7), then make the CROSS_COMPILE flag omitted. <br></div></div><br><pre> <code class="bash hljs">make CROSS_COMPILE=arm-linux-gnueabihf- Bananapi_defconfig</code> </pre> <br>  Directly bootloader compilation: <br><pre> <code class="bash hljs">make CROSS_COMPILE=arm-linux-gnueabihf-</code> </pre> <br>  As a result, many files with the u-boot prefix should appear in our working folder.  U-boot.bin contains the executable file of the loader, but we need a file with the postfix ‚Äúwith-spl‚Äù.  SPL is a small program that is located directly in front of the bootloader and loads U-Boot itself into RAM.  For Banana Pi, this is the <b>u-boot-sunxi-with-spl.bin file</b> .  Save it, it will come in handy later. <br><br>  The next step is to prepare a flash card with which the system will boot.  What should markup look like: <br><br><img src="https://habrastorage.org/files/1a7/8c4/2b5/1a78c42b5a6b478babe457300530bf0f.png" width="70%"><br><br>  We connect the flash card through the card reader and run the fdisk utility: <br><pre> <code class="bash hljs">fdisk /dev/sdb</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">How to find out what is the name of your card?</b> <div class="spoiler_text">  A new file corresponding to the inserted map should appear in the / dev / directory.  It will be defined either as a SCSI device (sda, sdb, sdc ...), or as a block MMC memory (mmcblk0, mmcblk1 ...). <br></div></div><br>  Add MBR markup: <br><pre> <code class="hljs pgsql">Command (m <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> help): o Created a <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> DOS disklabel <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> disk identifier <span class="hljs-number"><span class="hljs-number">0xa53166ce</span></span>.</code> </pre> <br>  And be sure to at least two sections: <br><ol><li>  50-100 MB <br><div class="spoiler">  <b class="spoiler_title">fdisk markup first</b> <div class="spoiler_text"><pre> <code class="bash hljs">Command (m <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-built_in"><span class="hljs-built_in">help</span></span>): n Partition <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> p primary (0 primary, 0 extended, 4 free) e extended (container <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> logical partitions) Select (default p): p Partition number (1-4, default 1): 1 First sector (2048-7831551, default 2048): 2048 Last sector, +sectors or +size{K,M,G,T,P} (2048-7831551, default 7831551): +75M Created a new partition 1 of <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> <span class="hljs-string"><span class="hljs-string">'Linux'</span></span> and of size 75 MiB.</code> </pre><br></div></div><br></li><li>  2 GB or more <br><div class="spoiler">  <b class="spoiler_title">fdisk, markup second</b> <div class="spoiler_text"><pre> <code class="hljs sql">Command (m for <span class="hljs-keyword"><span class="hljs-keyword">help</span></span>): n <span class="hljs-keyword"><span class="hljs-keyword">Partition</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> p primary (<span class="hljs-number"><span class="hljs-number">1</span></span> primary, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extended</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span> free) e <span class="hljs-keyword"><span class="hljs-keyword">extended</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">container</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">logical</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partitions</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">default</span></span> p): p <span class="hljs-keyword"><span class="hljs-keyword">Partition</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-4</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>): <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">First</span></span> sector (<span class="hljs-number"><span class="hljs-number">155648</span></span><span class="hljs-number"><span class="hljs-number">-7831551</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">155648</span></span>): <span class="hljs-number"><span class="hljs-number">155648</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Last</span></span> sector, +sectors <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> +<span class="hljs-keyword"><span class="hljs-keyword">size</span></span>{K,M,G,T,P} (<span class="hljs-number"><span class="hljs-number">155648</span></span><span class="hljs-number"><span class="hljs-number">-7831551</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-number"><span class="hljs-number">7831551</span></span>): +<span class="hljs-number"><span class="hljs-number">3</span></span>G Created a <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">partition</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-string"><span class="hljs-string">'Linux'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">size</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> GiB.</code> </pre><br></div></div><br></li></ol><br>  After all this, enter "w", thereby writing the changes to disk. <br><br>  <b>Why such sections?</b>  U-Boot can be managed using scripts, it reads them <b>only from the first partition of the</b> drive, and this section should be with the <b>FAT</b> file system.  The Arch Linux future boot directory will be mounted in the same section for convenient access to the cores from both U-Boot scripts and for quick replacement of kernels from any computer.  The second section is for the root of the system.  The rest is optional. <br><br>  After marking you need to clear the place for the loader.  It is extremely important not to overwrite the first 512 bytes (MBR) and not to affect 1024 sectors and further (based on the table above): <br><pre> <code class="bash hljs">dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=/dev/zero of=/dev/sdb bs=1K count=1023 seek=1</code> </pre> <br>  We write the U-Boot: <br><pre> <code class="bash hljs">dd <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>=u-boot-sunxi-with-spl.bin of=/dev/sdb bs=1024 seek=8</code> </pre> <br>  Now you can insert the USB flash drive into the destination device, turn it on and see how it blinks LEDs cheerfully, picks up the ip address via dhcp, tries to reach the tftp server to boot and friendly invites you to your Shell showing it through the output or UART. <br><br>  But there is not enough one bootloader, there are still a few components left: a script for managing the U-Boot and the Arch Linux distribution. <br>  Go to <a href="http://os.archlinuxarm.org/os/">os.archlinuxarm.org</a> and download the archive with the appropriate distribution of our architecture.  For Banana, this is ArchLinuxARM-armv7-latest.tar.gz.  Unpack in a separate directory and continue to manipulate the flash card. <br><br>  Create file systems and mount them in the specified order: <br><pre> <code class="bash hljs">mkfs.vfat /dev/sdb1 mkfs.ext4 /dev/sdb2 mount /dev/sdb2 /mnt mkdir /mnt/boot mount /dev/sdb1 /mnt/boot</code> </pre><br>  Copy the entire contents of the unpacked archive into / mnt: <br><pre> <code class="bash hljs">cp -r ~/ArchLinux-generic-armv7/* /mnt</code> </pre> <br>  Let's look at the first section of the flash drive (/ mnt / boot).  Inside we are waiting for the dtbs folder and the compressed image of the kernel - zImage.  dtbs are the very Device Tree Binary discussed <a href="https://habr.com/ru/post/264259/">above</a> . <br>  For ARMv7 there are as many as 301 dtb.  The list can be seen <a href="https://gist.github.com/evgenymarkov/225f4ee293c7d5cfcb6c">here</a> or directly by opening the distribution / boot distribution directory on your computer.  If there is a dtb, then the kernel will start with almost 100% probability.  For Banana Pi, the required file is <b>sun7i-a20-bananapi.dtb</b> .  We need it for the last and final stage - writing a script for the U-Boot and, of course, running the entire system. <br><br>  Let's get started  Let's create the file boot.cmd right on the spot (in <b>/ mnt / boot</b> ) and start writing. <br><br>  First of all, let's order U-Boot to load a kernel image into RAM: <br><pre> <code class="bash hljs">fatload mmc 0 0x46000000 zImage</code> </pre> <br>  Then dtb for the desired device: <br><pre> <code class="bash hljs">fatload mmc 0 0x49000000 dtbs/sun7i-a20-bananapi.dtb</code> </pre> <br>  Set the parameters for running the kernel: <br><pre> <code class="bash hljs">setenv bootargs console=ttyS0,115200 earlyprintk root=/dev/mmcblk0p2 rw rootwait panic=10</code> </pre> <br>  And let it boot from this area of ‚Äã‚Äãmemory, thereby transferring control to the Linux kernel. <br><pre> <code class="bash hljs">bootz 0x46000000 - 0x49000000</code> </pre> <br>  <i>The memory areas available for download are different for each model, and unfortunately I don‚Äôt know how to determine them myself.</i>  <i>I would be very happy if someone tells about this in simple words in the comments.</i> <br><br>  The script we wrote can only be compiled.  To do this, the uboot-tools package has the mkimage utility, we will use it: <br><pre> <code class="bash hljs">mkimage -C none -A arm -T script -d boot.cmd boot.scr</code> </pre> <br>  boot.cmd can be removed if desired, the bootloader only needs boot.scr. <br><div class="spoiler">  <b class="spoiler_title">And is there something else like boot.scr?</b> <div class="spoiler_text">  Yes, sometimes.  U-Boot for some devices can be configured via a simple text file uEnv.txt, it depends on the vendor, but with Banana Pi this trick does not work. </div></div><br>  And the final touch - we add sections to the etc / fstab system that will be connected at startup: <br><pre> <code class="bash hljs">/dev/mmcblk0p2 / ext4 rw,relatime,data=ordered 0 1 /dev/mmcblk0p1 /boot vfat rw,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=iso8859-1,shortname=mixed,errors=remount-ro 0 2</code> </pre><br>  A flash drive can be inserted into the device and enjoy the fresh system.  The dhcpd daemon will pick up the address itself if there is a DHCP server on your network.  SSH server is added by default to autoload.  The account on the default Arch Linux ARM images is always the same: root / root.  Be sure to change the password and add a user with limited privileges. <br><br><img src="https://habrastorage.org/files/36c/b96/a9f/36cb96a9fe994d7db43410a64f3c1d60.png" width="70%"><br><br><h4>  Total </h4><br>  What did you get?  The stars so agreed that the support of my microcomputer is in the list of 1089 devices supported by U-Boot and among the 301st among the mainline-supported kernels for ARMv7.  Therefore, we got exactly what we wanted: a system with the latest software, which is stably updated from repositories, including the kernel of the system (currently 4.1.4).  The stable bootloader branch is updated once every 3 months and you only need to compile it and repeat the installation procedure, as done above. <br><br><div class="spoiler">  <b class="spoiler_title">What does not work out of the box?</b> <div class="spoiler_text">  As part of the kernel and distribution, there is neither the kernel nor the userspace of the Mali driver.  This is due to the fact that a full-featured build is possible only with the help of a proprietary SDK, which is provided only to ARM partners. </div></div><br><h4>  For the lazy </h4><br>  Prepared the image for Banana Pi: <br>  <a href="https://yadi.sk/d/GAKWSs4oiHfkP">Link</a> , <a href="https://drive.google.com/file/d/0B6u5SF2VYG5gTEhES2twMnVQcmc/view%3Fusp%3Dsharing">Mirror # 1</a> , <a href="https://cloud.mail.ru/public/2HN3/kxBWWpWqg">Mirror # 2</a> . <br>  md5 image in the archive: f36d707c4c1fd857b50d37501b4a3d7a <br>  You can write the image to the flash card using the dd utility or win32diskimager (for Windows users). <br><br><h4>  Sources </h4><br>  <a href="https://linux-sunxi.org/Mainline_U-boot">linux-sunxi.org/Mainline_U-boot</a> <br>  <a href="http://elinux.org/RPi_Hub">elinux.org/RPi_Hub</a> <br>  <a href="https://ru.wikipedia.org/wiki/Das_U-Boot">ru.wikipedia.org/wiki/Das_U-Boot</a> <br><br>  I wish good luck to those who want to repeat this at home and will be glad to fair criticism. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7f1/b0f/f01/7f1b0ff01b92400ca7df640bdaeb46a1.JPG" width="80%"></div></div><p>Source: <a href="https://habr.com/ru/post/264259/">https://habr.com/ru/post/264259/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../264249/index.html">New Hyper-V vNext features</a></li>
<li><a href="../264251/index.html">Golang to AeroFS</a></li>
<li><a href="../264253/index.html">Analysis of all tasks of the final round of Yandex. Algorithm 2015</a></li>
<li><a href="../264255/index.html">Best practices from Google to develop Android applications</a></li>
<li><a href="../264257/index.html">How site developers create the future of TV</a></li>
<li><a href="../264261/index.html">Research gaming settings</a></li>
<li><a href="../264263/index.html">Accelerate the launch of BeagleBone or runit not for dummies</a></li>
<li><a href="../264269/index.html">Your cloud hosting in 5 minutes. Part 3: Consul, Registrator, Consul-Template</a></li>
<li><a href="../264271/index.html">Preparing ASP.NET5, issue number 2 - repeat the basics for the most beginners</a></li>
<li><a href="../264273/index.html">ESET & Intel Security on Black Hat USA 2015</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>