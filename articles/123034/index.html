<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Brainfuck BAT Interpreter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The simplicity of the Brainfuck language generates many implementations of its execution. At Habr√© there were already interpreters and compilers in va...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Brainfuck BAT Interpreter</h1><div class="post__text post__text-html js-mediator-article">  The simplicity of the Brainfuck language generates many implementations of its execution.  At Habr√© there were already interpreters and compilers in various programming languages, even <i>Bash</i> .  It seemed to me that it was unfair to bypass another command processor.  Namely batch files of the WindowsNT family, they are batch files.  When writing this interpreter, the goal was set to implement everything only in the built-in ‚Äúlanguage‚Äù of the console. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/storage1/1f1237ec/79ec1295/acefad90/9bc7de18.png"></div><a name="habracut"></a><br><habracut><br><br><h2>  Brainfuck Dialect Specification </h2><br>  Windows command processor has many limitations.  Here are just some of them: <br><ol><li>  Because the characters " <b>&lt;</b> " and " <b>&gt;</b> " are used to redirect I / O to use them as commands in the brainfuck language will lead to an unnecessary complication of the code.  Therefore, replace them with similar in spelling " <b>(</b> " and " <b>)</b> ". </li><li>  The ability to display text and enter data from the keyboard is limited. </li></ol><br>  In the end, we get the specification for the language: <br><ol><li>  The memory represents a ring buffer. </li><li>  The output is limited to the first 127 characters of the code page with the exception of non-printable characters and some characters that caused an error when the batch file was running.  The latter have been replaced by the character " <b>.</b> ".  The space is replaced by the " <b>_</b> " character. </li><li>  "Key words" of the language: <ul><li>  <b>")"</b> - move to the next memory location </li><li>  <b>"("</b> - go to the previous memory location </li><li>  <b>‚Äú+‚Äù</b> - to increase the value of the cell by one </li><li>  <b>"-"</b> - reduce the value of the cell by one </li><li>  <b>‚Äú,‚Äù</b> - read the value in the cell from the standard input device.  Currently not implemented </li><li>  <b>"."</b> - print the value of the cell on the standard output device </li><li>  <b>"["</b> - start the cycle.  if the value of the current cell is not 0 and go to the next command.  Otherwise go to] considering the nesting </li><li>  <b>‚Äú]‚Äù</b> - the end of the cycle.  Continue the loop if the value of the current cell is not 0 </li></ul></li></ol><br>  I would like to thank the author of the implementation of arrays on batch file.  Without his code, writing a Brainfuck interpreter would be difficult. <br>  As well as Robo habrauser for tips on code optimization. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Interpreter description </h2><br>  The full text of the interpreter is here: <a href="http://pastebin.com/KZXUuz48">http://pastebin.com/KZXUuz48</a> <br><br>  The program uses the following global variables: <br><ul><li>  <b>mp (memory pointer)</b> - a pointer to the current memory cell </li><li>  <b>cp (command pointer)</b> - pointer to the current command being executed </li></ul><br>  After initializing the variables and filling the ‚Äúmemory‚Äù with zeros, we read the file with the program.  In the process of reading, a multi-line program is spliced ‚Äã‚Äãinto one line.  Subsequently, during the execution of the Brainfuck program, all non-‚Äúdictionary‚Äù characters will be ignored.  All characters after * to the end of the line will be ignored.  This will give an opportunity to write ‚Äúbeautifully‚Äù designed programs.  Sample program: <br><br><pre><code class="hljs perl">+++++++++[ * <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> mem[<span class="hljs-number"><span class="hljs-number">0</span></span>]&lt;=<span class="hljs-number"><span class="hljs-number">9</span></span> { )+++++ * mem[<span class="hljs-number"><span class="hljs-number">1</span></span>]+=<span class="hljs-number"><span class="hljs-number">5</span></span> (-] * } ). * <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> <span class="hljs-keyword"><span class="hljs-keyword">chr</span></span>(mem[<span class="hljs-number"><span class="hljs-number">1</span></span>])</code> </pre> <br>  All the above actions are performed with just two lines of the batch file. <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> bf_prog= <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /F "eol=c delims=*" <span class="hljs-variable"><span class="hljs-variable">%%I</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> (<span class="hljs-variable"><span class="hljs-variable">%work_file%</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> bf_prog=<span class="hljs-variable"><span class="hljs-variable">!bf_prog!</span></span><span class="hljs-variable"><span class="hljs-variable">%%I</span></span></code> </pre><br>  Those who wish can add all non-dictionary characters from the program. <br><br>  Next begins the main cycle of the interpreter.  Here everything is quite transparent. <br>  The operation code is read by the pointer <b>cp</b> .  Next, the classic <b>if ... else</b> we fall on the appropriate subroutine.  If the character is not from the ‚Äúlanguage dictionary‚Äù, then it will be ignored.  Next, increase the <b>cp</b> counter and make the transition to the beginning of the cycle. <br><br><pre> <code class="hljs sql">:work <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> cop=!bf_prog:~%cp%,<span class="hljs-number"><span class="hljs-number">1</span></span>! <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%cop%"</span></span> == <span class="hljs-string"><span class="hljs-string">"+"</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> mem %mp% tmp <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> /a tmp += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"!tmp!"</span></span> == <span class="hljs-string"><span class="hljs-string">"256"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> tmp=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> mem %mp% !tmp! ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%cop%"</span></span> == <span class="hljs-string"><span class="hljs-string">"-"</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> mem %mp% tmp <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> /a tmp -= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !tmp! LSS <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> tmp=<span class="hljs-number"><span class="hljs-number">255</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> mem %mp% !tmp! ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%cop%"</span></span> == <span class="hljs-string"><span class="hljs-string">")"</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> /a mp +=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !mp! == %maxmem% <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> mp=<span class="hljs-number"><span class="hljs-number">0</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%cop%"</span></span> == <span class="hljs-string"><span class="hljs-string">"("</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> /a mp -=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !mp! == <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> /a mp=%maxmem% - <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%cop%"</span></span> == <span class="hljs-string"><span class="hljs-string">","</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :comma ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%cop%"</span></span> == <span class="hljs-string"><span class="hljs-string">"."</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> mem %mp% tmp <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :Echochr !tmp! ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%cop%"</span></span> == <span class="hljs-string"><span class="hljs-string">"["</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> mem %mp% tmp <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"!tmp!"</span></span> == <span class="hljs-string"><span class="hljs-string">"0"</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :skip1 ) ) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"%cop%"</span></span> == <span class="hljs-string"><span class="hljs-string">"]"</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :<span class="hljs-built_in"><span class="hljs-built_in">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> mem %mp% tmp <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">"!tmp!"</span></span> NEQ <span class="hljs-string"><span class="hljs-string">"0"</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :skip2 ) ) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> /a cp += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> %cp% == %bf_len% <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">work</span></span></code> </pre> <br><br><h2>  Description of some interesting solutions </h2><br>  To emulate the <b><i>chr ()</i></b> function, it is necessary to read a symbol from the <i>char</i> variable from the position corresponding to the code of this symbol. <br><br><pre> <code class="hljs dos">:echochr <span class="hljs-built_in"><span class="hljs-built_in">rem</span></span>   . ,      <span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span>   "." <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> char=".#$...'()*+,-./<span class="hljs-number"><span class="hljs-number">0123456789</span></span>.....?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]._`abcdefghijklmnopqrstuvwxyz{.}~_" <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> %<span class="hljs-number"><span class="hljs-number">1</span></span>==<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> %<span class="hljs-number"><span class="hljs-number">1</span></span>==<span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> %<span class="hljs-number"><span class="hljs-number">1</span></span>==<span class="hljs-number"><span class="hljs-number">32</span></span> &lt;<span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /p strTemp="_" <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> %<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> ( <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a code=%<span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /f <span class="hljs-variable"><span class="hljs-variable">%%t</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ('<span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span> /c "<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%%c</span></span>har:~<span class="hljs-variable"><span class="hljs-variable">!code!</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-variable"><span class="hljs-variable">%%"</span></span>') <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> &lt;<span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /p strTemp="<span class="hljs-variable"><span class="hljs-variable">%%t</span></span>" ) <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br><br>  Directly cut the character will not succeed.  Those.  design <br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> t=<span class="hljs-variable"><span class="hljs-variable">%char:~%</span></span>code<span class="hljs-variable"><span class="hljs-variable">%,1%</span></span></code> </pre>  or <pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t=%<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>:~!code!,<span class="hljs-number"><span class="hljs-number">1</span></span>%</code> </pre>  will give an error.  The problem is that string processing functions require specifying as a number, but not as a variable.  For example: <b><i>set t =% char: ~ 5.1%</i></b> cuts a character out of line 1 starting at the 5th position.  But in no way can you directly transfer the contents of a variable (in our case, <b>code</b> ) to the set command.  You can get around this by using the execution time binding.  Which works only in the <b>if</b> or <b>for</b> commands. Therefore, you have to call a copy of the command processor with the <b><i>echo %% char</i></b> command <b><i>: ~! Code!, 1 %%</i></b> (where the contents of the <b>code are</b> transmitted as a number) and intercept the output with <b>the for / f</b> construct. <br>  There is a design <pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> t=!<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>:~%code%,<span class="hljs-number"><span class="hljs-number">1</span></span>!</code> </pre>  , but in this case it works out incorrectly.  Because  There are not so many output operations, it was decided to sacrifice execution speed for the sake of speed of development and debugging of the program. <br><br>  This function (: echochr) uses another interesting solution: <i>text output without a newline.</i> <br><br>  The echo command always adds a newline to the output.  In this case, it does not fit.  Fortunately, there is an opportunity to bypass this restriction: <br><br><pre> <code class="hljs swift">&lt;nul <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> /p strTemp=<span class="hljs-string"><span class="hljs-string">"%~1"</span></span></code> </pre><br>  That is, we use input from the <i>nul</i> device in the <i>set / p</i> command to emulate the <i>echo</i> command. <br><br>  This solution may provide some more interesting pieces that can be seen on the forum, the link to which is given below. <br><br><h2>  Conclusion </h2><br><br><pre> <code class="hljs css">++++<span class="hljs-selector-attr"><span class="hljs-selector-attr">[)++++++++)++++++++++++++++++)++++++++++++++++) ++++++++++++++++++++)+++++++++++++++++++++++++(((((-]</span></span> ))+.(.))))++++++++.+++.+++++++<span class="hljs-selector-class"><span class="hljs-selector-class">.-----------------</span></span>. ((((.)<span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span>.)+.+.)++.(<span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span>.(.).+.).</code> </pre><br><br>  <b>A warning:</b> <br><br>  Everything works <i>very slowly</i> regardless of the performance of the computer.  Microsoft took care that owners of slow computers did not envy the owners of fast computers. <br><br>  The code was tested on Windows XP, Windows Vista, Windows 7. <br><br><h2>  Links </h2><ul><li>  Post of the author of the implementation of arrays: <a href="http://habrahabr.ru/blogs/crazydev/75951/">http://habrahabr.ru/blogs/crazydev/75951/</a> </li><li>  The forum where several ideas were peeped: <a href="http://forum.script-coding.com/viewforum.php%3Fid%3D12">http://forum.script-coding.com/viewforum.php?id=12</a> </li><li>  Here the features of the solutions used in the batch file are explained: <a href="">http://rsdn.ru/article/winshell/NTCommandProcessor.xml</a> </li></ul><br><br><h2>  About optimizing the speed of the bat-files </h2><br>  <i>In my opinion, there is not enough material for a separate article, so I will post it here.</i>  <i>For it directly concerns an increase in the speed of the interpreter presented here.</i> <i><br></i> <br>  During the work on the interpreter, a constant spawning of the child processes of the command processor cmd was noticed.  And the overall speed is small.  It's all about calling the call function.  We read a help: <br> <code> CALL       . <br>   : <br> <br> CALL :  <br> <br>           <br> ,     ,    <br> .          <br>  .      ,  <br>    CALL,       . <br>  GOTO /?    GOTO :EOF,   <br>     . <br></code> <br>  Therefore, it is worth remembering that <b>cmd</b> will be launched for each subroutine <b>call</b> via <b>call</b> , which takes some time. <br>  A simple test that does the same thing.  But in the first case, directly, in the second, through a subprogram call. <br><pre> <code class="hljs dos">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">setlocal</span></span> ENABLEDELAYEDEXPANSION ENABLEEXTENSIONS <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%time%</span></span> - <span class="hljs-built_in"><span class="hljs-built_in">start</span></span> test1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> a=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /l <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /aa=<span class="hljs-variable"><span class="hljs-variable">!a!</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%a%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%time%</span></span> - end test1 <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -------------- <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%time%</span></span> - <span class="hljs-built_in"><span class="hljs-built_in">start</span></span> test2 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> a=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> /l <span class="hljs-variable"><span class="hljs-variable">%%i</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :m1 <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%a%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%time%</span></span> - end test2 <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :eof :m1 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /aa=<span class="hljs-variable"><span class="hljs-variable">%a%</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b /<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br>  As they say, comments are superfluous. <br><br>  Therefore, I refused to use the implementation of arrays through subroutines and rewrote the interpreter code.  As a result, the speed of work has increased by more than 15 times! <br>  Actually, the optimized interpreter itself <a href="http://pastebin.com/MDbVJXsE">http://pastebin.com/MDbVJXsE</a> </habracut></div><p>Source: <a href="https://habr.com/ru/post/123034/">https://habr.com/ru/post/123034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../123026/index.html">Automated testing of mobile applications</a></li>
<li><a href="../123029/index.html">Saving files directly from the network to the cloud using the Cloud Save extension</a></li>
<li><a href="../123030/index.html">How Symantec Hacked Stuxnet</a></li>
<li><a href="../123032/index.html">Dotjs: execution of local scripts on any site</a></li>
<li><a href="../123033/index.html">PageBreaker extension for MODX - pagination of texts</a></li>
<li><a href="../123035/index.html">Blurring Gaussian Images with SVG</a></li>
<li><a href="../123036/index.html">Space Odyssey 2011</a></li>
<li><a href="../123037/index.html">SMS about incoming messages Vkontakte</a></li>
<li><a href="../123039/index.html">HTML Captcha without using images</a></li>
<li><a href="../123040/index.html">How to safely go to GTD</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>