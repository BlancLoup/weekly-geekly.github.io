<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write GraphQL API server on Yii2 with a client on Polymer + Apollo. Part 4. Validation. findings</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 1. Server 
 Part 2. Client 
 Part 3. Mutations 
 Part 4. Validation. findings 
 Validation and UnionType 


 One of the interesting problems face...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write GraphQL API server on Yii2 with a client on Polymer + Apollo. Part 4. Validation. findings</h1><div class="post__text post__text-html js-mediator-article"><p>  <a href="https://habrahabr.ru/post/336758/">Part 1. Server</a> <br>  <a href="https://habrahabr.ru/post/337044/">Part 2. Client</a> <br>  <a href="https://habrahabr.ru/post/337046/">Part 3. Mutations</a> <br>  <strong>Part 4. Validation.</strong>  <strong>findings</strong> </p><br><h2 id="validaciya-i-uniontype">  Validation and UnionType </h2><br><p>  One of the interesting problems faced by the server was validation when changing data.  What if there were errors when changing the object?  In the articles you can find many solutions to this problem, but we decided to use the composite type <a href="http://graphql.org/learn/schema/">Union</a> .  In simple words, Union is when the result of the request can be not only of the type, but different, depending on the result of the execution of resolve (). </p><a name="habracut"></a><br><h3 id="pristupim">  Let's get started </h3><br><p>  For example, add the User field to our User object (see <a href="https://habrahabr.ru/post/336758/">Part 1. Server</a> ) and make it impossible to save the object with an incorrect address. </p><br><p>  (I remind you that the <a href="https://github.com/timur560/graphql-server-demo">finished draft of the article can be downloaded from github</a> ) </p><br><h4 id="shag-1-dobavim-pole-v-bd">  Step 1. Add a field to the database </h4><br><p>  Let's return to the server from <a href="https://habrahabr.ru/post/336758/">part 1</a> and add an email field to our user.  To add a field to the database, create a migration: </p><br><pre><code class="bash hljs">$&gt; yii migrate/create add_email_to_user</code> </pre> <br><p>  Open it and change the safeUp () method: </p><br><pre> <code class="php hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">safeUp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;addColumn(<span class="hljs-string"><span class="hljs-string">'user'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;string()); }</code> </pre> <br><p>  Save and run </p><br><pre> <code class="bash hljs">$&gt; yii migrate</code> </pre> <br><h4 id="shag-2-dobavim-pravilo-v-obekt-user">  Step 2. Add a rule to the User object </h4><br><p>  The only correct <a href="http://www.yiiframework.com/doc-2.0/guide-input-validation.html">way to implement validation in Yii</a> is to override the Model :: rules () method.  This mechanism provides the broadest possible implementation of arbitrarily customized validations, and detailed documentation is attached to all capabilities.  It should be avoided only in the rarest cases, in 99% everything is possible to do with the framework tools. </p><br><p>  /models/User.php: </p><br><pre> <code class="php hljs">... <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@inheritdoc</span></span></span><span class="hljs-comment"> */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ [[<span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span>], <span class="hljs-string"><span class="hljs-string">'required'</span></span>], [[<span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-string"><span class="hljs-string">'status'</span></span>], <span class="hljs-string"><span class="hljs-string">'integer'</span></span>], [[<span class="hljs-string"><span class="hljs-string">'createDate'</span></span>, <span class="hljs-string"><span class="hljs-string">'modityDate'</span></span>, <span class="hljs-string"><span class="hljs-string">'lastVisitDate'</span></span>], <span class="hljs-string"><span class="hljs-string">'safe'</span></span>], [[<span class="hljs-string"><span class="hljs-string">'firstname'</span></span>, <span class="hljs-string"><span class="hljs-string">'lastname'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span>], <span class="hljs-string"><span class="hljs-string">'string'</span></span>, <span class="hljs-string"><span class="hljs-string">'max'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">45</span></span>], [<span class="hljs-string"><span class="hljs-string">'email'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span>], ]; } ...</code> </pre> <br><p>  Thus, we added 3 rules to the rules () method: </p><br><ol><li>  field cannot be empty; </li><li>  field must be a string; </li><li>  field must contain valid email. </li></ol><br><h4 id="shag-3-obnovim-graphql-tip">  Step 3. Update the GraphQL type </h4><br><p>  In schema / UserType.php the changes are minimal: </p><br><pre> <code class="php hljs">... <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'type'</span></span> =&gt; Type::string(), ], ...</code> </pre> <br><p>  But in the mutation begins the most interesting. </p><br><h4 id="shag-4-dobavlenie-validationerrortype">  Step 4. Adding ValidationErrorType </h4><br><p>  If you are not familiar with the Yii framework, I‚Äôll clarify that if the object was not saved due to the fact that the fields were not validated, we can pull out all the errors using the $ object-&gt; getErrors () method, which returns an associative array in the format : </p><br><pre> <code class="php hljs">[ <span class="hljs-string"><span class="hljs-string">''</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'  '</span></span>, <span class="hljs-string"><span class="hljs-string">'  '</span></span>, ... ], ... ]</code> </pre> <br><p>  The format is very convenient, but not for GraphQL.  The fact is that we can not spit it out directly in JSON as it is, for the reason that the associative array is converted into an object, the attributes of which will be the fields of our object, and each object has its own.  And GraphQL, as you know, works only with a predictable result.  As an option, of course, we can create a separate type for each object, something like a UserValidationError, in which all fields will match the fields of the object itself and contain Type :: listOf (Type :: string ()).  But the manual creation of such a number of types seemed to me too suboptimal, and I went the other way. </p><br><p>  Add a single class with the universal schema / ValidationErrorType structure: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">app</span></span>\<span class="hljs-title"><span class="hljs-title">schema</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">GraphQL</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>\<span class="hljs-title"><span class="hljs-title">ObjectType</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">GraphQL</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ValidationErrorType</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObjectType</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $config = [ <span class="hljs-string"><span class="hljs-string">'fields'</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-string"><span class="hljs-string">'field'</span></span> =&gt; Type::string(), <span class="hljs-string"><span class="hljs-string">'messages'</span></span> =&gt; Type::listOf(Type::string()), ]; }, ]; <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::__construct($config); } }</code> </pre> <br><p>  This type contains validation error information for one field.  Fields of the ValidationErrorType type, as for me, are obvious and contain the name of the field in which the error occurred, and the list of messages with the content of the error.  Everything is extremely simple. </p><br><p>  Since we need to return the result of validation of all fields, and not one, create another type: schema / ValidationErrorsListType: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">app</span></span>\<span class="hljs-title"><span class="hljs-title">schema</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">GraphQL</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>\<span class="hljs-title"><span class="hljs-title">ObjectType</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">GraphQL</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ValidationErrorsListType</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObjectType</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $config = [ <span class="hljs-string"><span class="hljs-string">'fields'</span></span> =&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ <span class="hljs-string"><span class="hljs-string">'errors'</span></span> =&gt; Type::listOf(Types::validationError()), ]; }, ]; <span class="hljs-keyword"><span class="hljs-keyword">parent</span></span>::__construct($config); } }</code> </pre> <br><h4 id="shag-5-generirovanie-uniontype">  Step 5. Generate a UnionType </h4><br><p>  In GraphQL there is a <a href="http://graphql.org/learn/schema/">type Union</a> , this is when the result of a resolve () field can return not only one type, but one of several (it seems I wrote this already, but it was worth mentioning this again).  Thus, our goal now is that the result of a mutation of a change / creation of an object, without passing or vice versa, after successfully completing validation, returns either the modified object itself or an object of type ValidationErrorsListType. </p><br><p>  What does "generation" mean?  The fact is that we will not create for each mutation our return to UnionType, but will generate it on the go, based on the base type.  How exactly, now show. </p><br><p>  Let's change our schema / Types.php: </p><br><pre> <code class="php hljs">... <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">GraphQL</span></span>\<span class="hljs-title"><span class="hljs-title">Type</span></span>\<span class="hljs-title"><span class="hljs-title">Definition</span></span>\<span class="hljs-title"><span class="hljs-title">UnionType</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">yii</span></span>\<span class="hljs-title"><span class="hljs-title">base</span></span>\<span class="hljs-title"><span class="hljs-title">Model</span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> $validationError; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> $validationErrorsList; <span class="hljs-comment"><span class="hljs-comment">//       private static $valitationTypes; ... // c     public static function validationError() { return self::$validationError ?: (self::$validationError = new ValidationErrorType()); } public static function validationErrorsList() { return self::$validationErrorsList ?: (self::$validationErrorsList = new ValidationErrorsListType()); } //     ,   // ,     public static function validationErrorsUnionType(ObjectType $type) { // -     ,   //    ,    // (     ,  / //    GraphQL   ) if (!isset(self::$valitationTypes[$type-&gt;name . 'ValidationErrorsType'])) { // self::$valitationTypes    ,    self::$valitationTypes[$type-&gt;name . 'ValidationErrorsType'] = new UnionType([ //    'name' =&gt; $type-&gt;name . 'ValidationErrorsType', //      // (    ,      //     ) 'types' =&gt; [ $type, Types::validationErrorsList(), ], //    resolveType //       // / , //     //     $model-&gt;getError() //      'resolveType' =&gt; function ($value) use ($type) { if ($value instanceof Model) { //   return $type; } else { //   (    , //     , //   ) return Types::validationErrorsList(); } } ]); } return self::$valitationTypes[$type-&gt;name . 'ValidationErrorsType']; } ...</span></span></code> </pre> <br><h4 id="shag-6-mutaciya">  Step 6. Mutation </h4><br><p>  Make changes to the UserMutationType: </p><br><pre> <code class="php hljs">... <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">app</span></span>\<span class="hljs-title"><span class="hljs-title">schema</span></span>\<span class="hljs-title"><span class="hljs-title">Types</span></span>; ... <span class="hljs-comment"><span class="hljs-comment">//     update 'type' =&gt; Types::validationErrorsUnionType(Types::user()), ... //     'email' =&gt; Type::string(), ... 'resolve' =&gt; function(User $user, $args) { //      , // ..      : //     ,     //     ,   $user-&gt;setAttributes($args); if ($user-&gt;save()) { return $user; } else { //  ,      - // ,     //    foreach ($user-&gt;getErrors() as $field =&gt; $messages) { //   ValidationErrorType $errors[] = [ 'field' =&gt; $field, 'messages' =&gt; $messages, ]; } //    //    //   (   ValidationErrorsListType) return ['errors' =&gt; $errors]; } } ...</span></span></code> </pre> <br><p>  It's time to see how it works. </p><br><h3 id="testiruem">  We are testing </h3><br><p>  We open again our GraphiQL and try to do something very simple. </p><br><p>  We press in the input field Ctrl + Space, and see that we can generally return the update method: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2d4/d43/357/2d4d43357ad3119221437f0d0ae9bf27.png" alt="image"></p><br><p>  Awesome. </p><br><p>  Well, try to ask what we need, and see what happens. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/013/d3b/c14/013d3bc148c4541916234fe0d37939c5.png" alt="image"></p><br><p>  As you can see, the first rule worked, which says that the field is mandatory. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/05a/429/358/05a429358336919037b04cc7fa74a5b3.png" alt="image"></p><br><p>  Rule 2 - The email field must be in effect.  Validation worked. </p><br><p>  Well, let's finally see a successful result: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2d1/bed/c96/2d1bedc96096a4f9ca25fa43eb32c577.png" alt="image"></p><br><p>  In general, I am sure that the described approach to validation is far from being the only optimal and imperfect, it can be refined and improved for specific needs, but in general, it seemed to me very versatile, and I hope it will help someone in practice and push the solution Problems. </p><br><h2 id="vyvody">  findings </h2><br><p>  To understand exactly what we are drawing conclusions from, it was advisable for you to read all 4 parts. </p><br><h3 id="kogda-nuzhno-i-nuzhno-li-voobsche-vam-ispolzovat-graphql">  When do you need and need you use GraphQL at all? </h3><br><p>  Well, first, you need to understand whether the game is worth the candle.  If you have a task to write a couple of simple methods, of course, you don't need GraphQL.  It will be something like a nailing microscope.  IMHO, one of the main advantages of GraphQL is the convenience of scaling.  And the possibility of scaling is necessary to lay <del>  nearly </del>  in any project (and even more so in the project in which at first glance it is not at all required). </p><br><p>  If your API is "average", then, in principle, you will not feel the difference between the selected protocol.  Replace mutations in GraphQL with actions for RESTa (an hour or two in the evening after working as a beer), and op - you already have a RESTful API server. </p><br><h3 id="itak">  So... </h3><br><p>  <em>Very low entry threshold.</em>  Understand the essence of the GraphQL query language, find the necessary libraries for the backend and frontend for any language, figure out how they work - all this will take you no more than a day (or even a few hours). </p><br><p>  <em>Something new.</em>  New experience is always useful (even negative).  As you know, in the field of web technologies, bypassing the new, we are known to degrade. </p><br><p>  <em>Use for external (external) API.</em>  If your end product is an API that is used by a large number of clients (about which you do not know anything) GraphQL provides tremendous flexibility, since these clients may have completely diverse needs.  But here is a double-edged sword.  Technically, this is an advantage, but unfortunately, the client can be repelled by the fact that he will have to learn something new, and will have to look for developers with experience with the GraphQL API, because not everyone wants to hire developers with the promise to learn a new technology in a short time ( in spite of that, but in the case of GraphQL, these dates may indeed be very short). </p><br><p>  Also GraphQL will help you <em>in the case of remote work</em> , and as a result, the lack of close communication between the backend and frontend developers (daily Skype calls are not always a guarantee of "close" communications). </p><br><p>  Among the shortcomings, I would like to point out few examples on GraphQL + PHP online, since true soft buttons use either Node.js or Go (which prompted me to write this series of articles).  The same situation with the Apollo library, all the official documentation for which is written under React, and I, as a backend developer, needed to spend time to understand how this all works with Polymer, although I would not call it a big problem during the transition.  By the way, I advise you to read the very informative <a href="https://dev-blog.apollodata.com/">blog Apollo on Medium</a> .  There really are many interesting and practical articles on GraphQL. </p><br><p>  Also one of the drawbacks is the lack of a convenient documentation generator like Swagger or ApiDoc.js.  I managed to find one generator, but, unfortunately, it is very poor.  If you have experience of more advanced documentation than the description in pdf, please share in the comments. </p><br><h3 id="kto-uzhe-ispolzuet-graphql-iz-izvestnyh-kompaniy">  Who already uses GraphQL from well-known companies? </h3><br><p>  <em><a href="https://developer.github.com/v4/">Github</a></em>  In general, nothing surprising, since the target audience of the site - the developers, and no worries about whether their API could not arise.  It is worth noting that the documentation is very beautiful and thoughtful, and remarkably, contains some information about the basics of GraphQL, how to debug it, and guides to migration from REST. </p><br><p>  <em>Facebook</em>  They are the developers of the concept of GraphQL itself, and actively promote it.  There are many reports on networks about how Facebook uses GraphQL. </p><br><p>  <em>PS: Friends!</em>  <em>Never forget to implement request processing with the OPTIONS method in your API, so that for all such requests the server always returns the http-code 200, and an empty body.</em>  <em>This will save your nerve cells.</em> </p><br><p>  <em>And in general, do not forget about headers for CORS when developing any API:</em> </p><br><pre> <code class="hljs pgsql">&lt;IfModule mod_headers.c&gt; <span class="hljs-keyword"><span class="hljs-keyword">Header</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Access</span></span>-Control-Allow-Origin "*" <span class="hljs-keyword"><span class="hljs-keyword">Header</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Access</span></span>-Control-Allow-Headers "Content-Type, Authorization" <span class="hljs-keyword"><span class="hljs-keyword">Header</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Access</span></span>-Control-Allow-Methods "GET, POST, OPTIONS" &lt;/IfModule&gt;</code> </pre> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/337236/">https://habr.com/ru/post/337236/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337226/index.html">BeagleBone: support for 7 '' BB-View display on the new linux-4.4 core</a></li>
<li><a href="../337228/index.html">The practice of forming requirements in IT projects from A to Z. Part 4. Business processes automated by the system</a></li>
<li><a href="../337230/index.html">Conduct usability testing or experience cones</a></li>
<li><a href="../337232/index.html">Concurrency patterns in Rust from Java</a></li>
<li><a href="../337234/index.html">Mobile applications and their testers: all you need to know</a></li>
<li><a href="../337238/index.html">Cheat Sheet for the entrepreneur in the IT world</a></li>
<li><a href="../337240/index.html">Creating a programming language using LLVM. Part 10: Conclusion and other goodies LLVM</a></li>
<li><a href="../337242/index.html">Do you have a lot of different printers in your organization and you need to collect the number of prints from all?</a></li>
<li><a href="../337244/index.html">Powershell delivery of scripts via DNS tunnel and methods of counteraction</a></li>
<li><a href="../337246/index.html">GitLab 9.5 Released: GPG Commit Commitments and Project Templates</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>