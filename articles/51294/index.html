<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unpredictable symbolic (symbolic) links in Windows.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The reason for writing was this article Links in Windows, symbolic and not only . It can also be read to familiarize yourself with what hard and symbo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unpredictable symbolic (symbolic) links in Windows.</h1><div class="post__text post__text-html js-mediator-article">  The reason for writing was this article <a href="http://habrahabr.ru/blogs/windows/50878/">Links in Windows, symbolic and not only</a> .  It can also be read to familiarize yourself with what hard and symbolic links are in ntfs. <br>  I will continue and share some facts about the obvious behavior of these links. <br><a name="habracut"></a><br>  Immediately make a comment.  If there is no ambiguity with Hard Links, there is no confusion with soft or symbolic links.  So I will continue to talk about those symbolic links that are made by the program <a href="http://technet.microsoft.com/ru-ru/sysinternals/bb896768(en-us).aspx">Junction</a> (as well as Alax.Info NTFS Links, Link Shell Extension, etc.) <br>  The experimental programs were: Total Commander, Far, Frigate3, Servant Salamander, WinDirStat and Explorer in Windows XP. <br><br><h4>  Recursion </h4><br><br>  I first encountered reference problems a few years ago when I tried to write a ‚Äúsuper-duper‚Äù utility for finding and removing duplicates.  It turned out that the OS's presented search and directory traversal mechanisms fall into recursion when processing directories in which there is a symbolic link to itself or the parent directory.  Of course, this can be avoided if you recognize the links and process them in a special way, separately from the directories.  But the thesis project interrupted the development of the utility, and then I decided not to waste time on creating the next ‚Äúduplicate cleaner‚Äù.  Now I think that in vain. <br>  The fact is that most programs that work with files do not know about symbolic links.  And this is where it leads. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Search. </h4><br>  Create a directory <br>  X: \ 000 <br>  In it we will create a file text.txt and a symbolic link 111 to the same directory X: \ 000 <br>  This is what our experimental file managers will give out when searching for a file except Far <br>  X: \ 000 \ text.txt <br>  X: \ 000 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br>  X: \ 000 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ 111 \ text.txt <br><br>  I am glad that the recursion was interrupted so early.  But still this behavior is wrong and can lead to errors.  Here we found the same file 16 times.  Many duplicate search programs will offer to delete this file as a duplicate.  Although in fact the file is quite unique. <br>  But Far, it turns out, when searching does not follow symbolic links at all. <br><br><h4>  Catalog size </h4><br>  This behavior leads to interesting effects when determining the size of the directory.  You can make it so that this size will be many times larger than the size of the disk.  For example, on my laptop there is a 300 TB folder.  The same size trick can be done using hard links. <br><img src="http://img3.imageshack.us/img3/86/clip1hm1.jpg" alt="image"><br>  Among the experimental programs, only WinDirStat and Explorer have correctly determined the size. <br>  With the explorer, everything is clear - he and the implementation of symbolic links in the windows of the brainchild of the same company and it would be strange if they incorrectly used their own link mechanism.  But WinDirStat is so familiar with links, probably because it comes from Linux. <br><br><h4>  Copying symbolic links </h4><br>  When copying links, experimental file managers behaved differently. <br>  <b>*</b> Far - copied symbolic links as links.  Those.  made a copy of the link and not its contents. <br>  <b>*</b> Explorer for each link asked a question - copy it as a directory or as a link.  But I suspect that such a smart behavior was given to him by the installed utility Alax.Info NTFS Links.  I could not check how Explorer behaves on windows xp without any extensions, but on windows 2000 explorer leads when copying itself as far. <br>  <b>*</b> All other guides copied the links as directories. <br>  When copying links you need to understand what it is.  If the links are copied as files, for example, I will not be able to copy my ‚ÄúINTERNET‚Äù daddy in the near future.  If you copy links as links, it may turn out that a friend‚Äôs directory with movies copied to another hdd in the spotlight will not open, since there were symbolic links inside.  And then where did they refer to another hdd.  In general, when copying, Explorer behaves most correctly in the installed correct extension. <br><br>  Then I decided to check if the archivers support symbolic links.  It turned out that no.  All archivers from my collection (including 7Z, winrar) do not save symbolic links.  Unfortunately in my collection there were no ported archivers like tar.  I hope that programs from Linux will help again. <br><br>  As for hard links to a file, all programs copy, archive them as files, not recognizing the link or not.  In principle, this is expected. <br><br><h4>  Remove symbolic links. </h4><br>  When deleting symbolic links, Frigate3 and Servant Salamander excelled.  They not only deleted the link, but also carefully cleared the contents of the directory to which it referred.  The rest of the experimental deleted only the link. <br><br><h4>  Paranoid. </h4><br>  Removing hard links is not a problem.  True, I don‚Äôt understand why I can‚Äôt remove one hard link to a file if it is opened via another hard link. <br>  It must be remembered that hard links are essentially different names for the same file. <br>  When using programs that permanently overwrite a file (for example, <a href="http://technet.microsoft.com/ru-ru/sysinternals/bb897443.aspx">Sdelete</a> ), permanently deleting one hard link will result in the other hard links to the file refer to a bunch of garbage. In this case, this behavior is logical and correct.  If we already overwrite files, then for good. <br><br><h4>  Findings. </h4><br>  Probably because symbolic links were not popular in Windows, many programmers forget about them.  Or maybe links are not popular because programmers forget about them and their programs work with links as they will.  In general, be careful when using symbolic and hard links and check how your file manager handles them. <br><br>  Shl.  It turns out there is not enough karma to write to a thematic blog.  Anyway.  Maybe here someone will be useful. <br><br>  UPD: Experiments were performed in Microsoft Windows XP Home Edition 32bit SP3 <br>  Total Commander 7.04a <br>  Far 1.70 <br>  Servant Salamander 2.0 <br>  WinDirStat 1.1.2.80 (Unicode) <br>  Frigate 3.21.2.71 <br>  Explorer 6.00.2900.5512 <br><br>  I took note of <a href="https://geektimes.ru/users/busla/" class="user_link">Busla</a> and changed the translation of the Symbolic link to a more common version. <br><br>  UPD2: <br>  In order to clarify once again what it is about and remove differences in terminology sown with a light hand of MS. <br>  Having looked through msdn, I understood that in the end MS came to a common opinion.  Sort of.  And in Windows Vista, they made some symbolic link that are created by the <a href="http://msdn.microsoft.com/en-us/library/aa363866(VS.85).aspx">CreateSymbolicLink</a> function. <br>  And those symbolic == symbolic == soft links that were (and are) in earlier versions of Windows (2000, XP) are some kind of reparse point.  And they are created like this: <br>  memset (reparseInfo, 0, sizeof (* reparseInfo)); <br>  reparseInfo-&gt; ReparseTag = IO_REPARSE_TAG_MOUNT_POINT; <br>  reparseInfo-&gt; ReparseTargetLength = <br>  _tcslen (targetNativeFileName) * sizeof (WCHAR); <br>  reparseInfo-&gt; ReparseTargetMaximumLength = <br>  reparseInfo-&gt; ReparseTargetLength + sizeof (WCHAR); <br>  _tcscpy (reparseInfo-&gt; ReparseTarget, targetNativeFileName); <br>  reparseInfo-&gt; ReparseDataLength = reparseInfo-&gt; ReparseTargetLength + 12; <br><br>  DeviceIoControl ( <br>  hFile, <br>  FSCTL_SET_REPARSE_POINT, <br>  reparseInfo, <br>  reparseInfo-&gt; ReparseDataLength + REPARSE_MOUNTPOINT_HEADER_SIZE, <br>  Null <br>  0, <br>  &amp; returnedLength, <br>  NULL); <br><br>  So, since I do not have a whist, it is a question of reparse point.  Although I assume that symbolic link will also surprise the ambiguous behavior in different programs.  For the problem is mostly not in the links, but in the fact that some programmers forget about them. </div><p>Source: <a href="https://habr.com/ru/post/51294/">https://habr.com/ru/post/51294/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../51279/index.html">JS Charts - a generator of graphs and schemes.</a></li>
<li><a href="../51280/index.html">HP Open Innovation Contest</a></li>
<li><a href="../51281/index.html">Microsoft choose Postfix</a></li>
<li><a href="../51283/index.html">Malware on car windows</a></li>
<li><a href="../51292/index.html">Google Book Search archive on mobile</a></li>
<li><a href="../51295/index.html">wTorrent'a modding</a></li>
<li><a href="../51297/index.html">Unnecessary indents in lists</a></li>
<li><a href="../51302/index.html">Extending wget features</a></li>
<li><a href="../51305/index.html">Search engine optimization. Part 1 - internal factors</a></li>
<li><a href="../51313/index.html">Psd - trick with file size</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>