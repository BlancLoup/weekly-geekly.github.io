<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Friendly introduction to Dagger 2. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Use modules to specify how objects should be created. 
 In the previous article in this series, we looked at how Dagger 2 saves us from the routine of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Friendly introduction to Dagger 2. Part 2</h1><div class="post__text post__text-html js-mediator-article"><h4>  Use modules to specify how objects should be created. </h4><br>  In the <a href="https://habrahabr.ru/post/307434/">previous article in this series,</a> we looked at how Dagger 2 saves us from the routine of writing initialization code by introducing dependencies. <br><br>  If you remember, we created an interface that allows the framework to find out which class objects are required by our <i>main</i> method, and Dagger automatically generated a specific class that can initialize instances of these classes for us.  We have not indicated anywhere <i>exactly how to</i> create these objects or their dependencies.  Since all of our classes were specific and labeled with appropriate annotations, this did not create any problems: Dagger could make a conclusion from the annotations whose constructors are needed to create an instance of this class. <br><br>  However, more often than not, classes depend not on <i>concrete</i> classes, but on <i>abstract</i> classes and interfaces that do not have constructors that Dagger could call.  Sometimes changing the class source to include annotations is not an option at all.  It also happens that creating an object requires more actions than just calling the constructor.  In all these cases, Dagger doesn‚Äôt have enough automatic behavior, and the framework needs our help. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In today's article we will see how to provide Dagger with additional instructions on how to create objects using <b>modules</b> .  Modules are interchangeable and can be used in other projects.  Plus they can take arguments in runtime, which makes them even more flexible. <br><a name="habracut"></a><br><h3>  Example </h3><br>  In order to illustrate the situation described above, let's return to the first example from the previous article, where we only had 3 classes: <i>WeatherReporter</i> and 2 of its dependencies, <i>LocationManager</i> and <i>WeatherService</i> .  Both dependencies were concrete classes.  In practice, this may not happen. <br><br>  Let's assume that <i>WeatherService</i> is an interface, and we have another class, say, <i>YahooWeather</i> , which implements this interface: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WeatherService</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.inject.Inject; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">YahooWeather</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WeatherService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">YahooWeather</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre> <br>  If we again try to compile the project, Dagger will give an error and say that it cannot find a <i>provider</i> for <i>WeatherService</i> . <br><br>  When a class is concrete and it has an annotated constructor, Dagger can automatically generate a <i>provider</i> for this class.  However, since <i>WeatherService</i> is an interface, we need to provide Dagger with more information. <br><br><h3>  What are modules? </h3><br>  <b>Modules</b> are classes that can create instances of specific classes.  For example, the following module is able to create <i>WeatherService</i> objects upon request, creating an instance of the <i>YahooWeather</i> class. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">YahooWeatherModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-function">WeatherService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideWeatherService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> YahooWeather(); } }</code> </pre> <br>  Modules must be annotated with <i>@Module</i> .  Some of their methods, also known as <b>provider-methods</b> , are annotated with <i>Provides</i> to indicate that they can provide instances of a particular class upon request.  Method names don't matter: Dagger looks only at signatures. <br><br>  Using modules, we are improving Dagger's ability to create objects and resolve dependencies.  Previously, only specific classes with annotated constructors could be used as dependencies, and now, with a module, any class can depend on the <i>WeatherService</i> interface.  It only remains for us to connect this module to the component that is used at the entry point of our application: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span>(modules = {YahooWeatherModule.class}) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">WeatherReporter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getWeatherReporter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br>  The project is compiled again.  Each <i>WeatherReporter</i> instance created by the <i>getWeatherReporter</i> method creates an instance of <i>YahooWeather</i> . <br><br>  We can create one large module that knows how to create any abstract class or interface in an application, or many small modules that are involved in creating classes directly related to each other.  In this series of articles we will use the second approach. <br><br><h3>  How to replace modules </h3><br>  One of the most interesting properties of the module is that it can easily be replaced by any other.  This allows us to have multiple interface implementations in the project and easily switch between them. <br><br>  Suppose we have another class, <i>WeatherChannel</i> , also implementing <i>WeatherService</i> .  If we want to use this class in <i>WeatherReporter</i> instead of <i>YahooWeather</i> , we can write a new module <i>WeatherChannelModule</i> and substitute it in the component. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WeatherChannelModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-function">WeatherService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideWeatherService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WeatherChannel(); } }</code> </pre><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span>(modules = {WeatherChannelModule.class}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">WeatherReporter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getWeatherReporter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br>  Replacing modules is useful, for example, when writing integration and functional tests.  You can define another component, almost identical to the first, but using several other modules.  We will return in more detail to this issue in the next article. <br><br>  If we try to connect to the component two different modules that return the same type, Dagger will generate a compilation error, saying that the <i>type is bound many times</i> ( <i>type is bound multiple times</i> ).  For example, this will not work: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Component</span></span>(modules = {WeatherChannelModule.class, YahooWeatherModule.class}) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-function">WeatherReporter </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getWeatherReporter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br>  In addition, since Dagger 2 generates components during compilation, modules cannot be replaced in runtime.  However, our entry point can have several components at its disposal and decide from which of them to receive objects based on specific conditions at run time. <br><br><h3>  Creating more complex objects </h3><br>  Now that we know how to write a simple module and what it is all about, let's start writing modules that create more complex objects.  For example, instances of classes defined by a third party (which cannot be changed), having dependencies or requiring configuration. <br><br><h4>  Creating instances of third-party classes </h4><br>  Sometimes it is impossible to change the class and add annotation to it.  For example, a class is part of a framework or a third-party library.  Also quite often, third-party classes have a dubious design and do not facilitate the use of DI frameworks. <br><br>  Suppose our <i>LocationManager is</i> dependent on <i>GpsSensor</i> .  And this class is provided by the company "Horns and hoofs" and can not be changed.  Let's complicate the situation even more: the class constructor initializes it not completely.  After creating an instance of a class, before using it, we must also call methods such as <i>calibrate</i> .  Below are the sources of <i>LocationManager</i> and <i>GpsSensor</i> . <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GpsSensor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GpsSensor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calibrate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LocationManager</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> GpsSensor gps; <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LocationManager</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GpsSensor gps)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.gps = gps; } }</code> </pre> <br>  Please note that there are no annotations in <i>GpsSensor</i> .  Since the products of a well-known company <i>simply work</i> , they do not need dependency injection or tests. <br><br>  We would like to avoid calling the <i>calibrate</i> method in the <i>LocationManager</i> constructor, since setting up <i>GpsSensor</i> 'a is not its responsibility.  Ideally, all accepted dependencies should already be <i>ready to use</i> .  In addition, this instance of <i>GpsSensor</i> can be used in many places, and Horns and Hooves warn that a <i>calibrate</i> multiple call will result in crash. <br><br>  To continue using <i>GpsSensor</i> without fear of consequences, we can write a module whose sole responsibility is to create and configure this object upon request.  Thus, any class can depend on <i>GpsSensor</i> , without worrying about its initialization. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GpsSensorModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-function">GpsSensor </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideGpsSensor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ GpsSensor gps = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GpsSensor(); gps.calibrate(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> gps; } }</code> </pre><br><h4>  Creating objects with dependencies </h4><br>  Sometimes our modules need to create objects with dependencies.  Creating these dependencies or searching for them is clearly not the responsibility of the module.  Like any other class, he expects the dependencies to be provided to him in a finished form. <br><br>  Suppose, for example, that the <i>YahooWeather</i> class requires <i>WebSocket</i> to work.  Take a look at the code. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebSocket</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WebSocket</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } }</code> </pre> <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">YahooWeather</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WeatherService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> WebSocket socket; <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">YahooWeather</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WebSocket socket)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.socket = socket; } }</code> </pre> <br>  Since the <i>YahooWeather</i> constructor now requires passing a parameter, we need to change the <i>YahooWeatherModule</i> .  You must somehow get an instance of <i>WebSocket</i> to call the constructor. <br><br>  Instead of creating dependencies right inside the module, which would nullify all the benefits of DI, we can simply change the provider signature.  And Dagger already takes care of creating an instance of <i>WebSocket</i> . <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">YahooWeatherModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-function">WeatherService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideWeatherService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WebSocket socket)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> YahooWeather(socket); } }</code> </pre> <br><h4>  Creating objects that require configuration </h4><br>  Sometimes a module needs to create an object that needs to be somehow configured, and this configuration requires information that is available only in runtime. <br><br>  Let's imagine that the <i>YahooWeather</i> designer also needs an API key. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">YahooWeather</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WeatherService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> WebSocket socket; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String key; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">YahooWeather</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String key, WebSocket socket)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.key = key; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.socket = socket; } }</code> </pre> <br>  As you can see, we have removed the <i>Inject</i> annotation.  Since our module is now responsible for creating <i>YahooWeather</i> , Dagger does not need to know about the constructor.  Likewise, he does not know how to automatically inject the <i>String</i> parameter (although this is easy to do, as we will see in a future article). <br><br>  If the API key is a constant available after compilation, for example, in the <i>BuildConfig</i> class, this solution is possible: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">YahooWeatherModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-function">WeatherService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideWeatherService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WebSocket socket)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> YahooWeather(BuildConfig.YAHOO_API_KEY, socket); } }</code> </pre> <br>  Note, however, that the API key is available only in runtime.  For example, it can be a command line argument.  This information can be provided to the module, like any other dependency, through the constructor. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Module</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">YahooWeatherModule</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String key; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">YahooWeatherModule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String key)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.key = key; } <span class="hljs-meta"><span class="hljs-meta">@Provides</span></span> <span class="hljs-function"><span class="hljs-function">WeatherService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">provideWeatherService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(WebSocket socket)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> YahooWeather(key, socket); } }</code> </pre><br>  This makes life a little more difficult for Dagger, since he no longer knows how to create such a module.  When modules have constructors with no arguments, Dagger can easily initialize and use them.  In our case, we must initialize our module ourselves and transfer it to Dagger for use.  This can be done at the entry point to our application: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Application</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String args[])</span></span></span><span class="hljs-function"> </span></span>{ String apiKey = args[<span class="hljs-number"><span class="hljs-number">0</span></span>]; YahooWeatherModule yahoo = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> YahooWeatherModule(apiKey); AppComponent component = DaggerAppComponent.builder() .yahooWeatherModule(yahoo) .build(); WeatherReporter reporter = component.getWeatherReporter(); reporter.report(); } }</code> </pre> <br>  In lines 3-4, we get the API key from the command line arguments and create an instance of the module ourselves.  In lines 5-7, we ask Dagger to create a new component using the newly created module instance.  Instead of calling the <i>create</i> method, we call the <i>builder</i> 'y, pass in our module instance, and finally call <i>build</i> . <br><br>  If there were more similar modules, we would have to initialize them in a similar way before calling <i>build</i> . <br><br><h3>  Conclusion </h3><br>  In today's article, we looked at how you can control the creation of objects through modules.  Source codes for the article are available on <a href="https://github.com/iSoron/dagger2-examples/tree/master/part-2">Github</a> . <br><br>  In the next article, we will look at how to indicate that certain dependencies can be used by a set of objects. <br><br>  <i>Note</i>  <i>from the translator.</i>  <i>While the author has not written a sequel, I‚Äôm inviting all interested to continue their acquaintance with Dagger for a wonderful series of posts from <a href="https://habrahabr.ru/users/xoxol_89/" class="user_link">xoxol_89</a> ( <a href="https://habrahabr.ru/post/279125/">part 1</a> , <a href="https://habrahabr.ru/post/279641/">part 2</a> )</i> </div><p>Source: <a href="https://habr.com/ru/post/308040/">https://habr.com/ru/post/308040/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../308030/index.html">A critical vulnerability has been discovered in the encryption library Libgcrypt for 18 years.</a></li>
<li><a href="../308032/index.html">We use Secure Boot in Linux to the fullest</a></li>
<li><a href="../308034/index.html">Three-position checkbox (aka tristate) without scripts and SMS</a></li>
<li><a href="../308036/index.html">Multiprotocol bot via Microsoft Bot Connector REST API v3.0</a></li>
<li><a href="../308038/index.html">Flash revolution</a></li>
<li><a href="../308042/index.html">We found 10,000 bugs in various open source projects.</a></li>
<li><a href="../308044/index.html">How does the MTS Mobile Network Operations Center work?</a></li>
<li><a href="../308050/index.html">Questions Heilmeyer, Pierce and our developers answers</a></li>
<li><a href="../308054/index.html">Planning usability testing. Part 2</a></li>
<li><a href="../308056/index.html">Trello Clone on Phoenix and React. Parts 1-3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>