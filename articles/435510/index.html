<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Microelectronics, neurophysiology and machine learning, shake up, but do not mix</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the middle of 2018, work on the electrophysiology of the brain of rats was published , with which one unique data set was made publicly available. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Microelectronics, neurophysiology and machine learning, shake up, but do not mix</h1><div class="post__text post__text-html js-mediator-article">  In the middle of 2018, <a href="https://www.biorxiv.org/content/early/2018/07/23/370080">work</a> on the electrophysiology of the brain of rats was <a href="https://www.biorxiv.org/content/early/2018/07/23/370080">published</a> , with which one <a href="https://drive.google.com/drive/folders/13GCOuWN4QMW6vQmlNIolUrxPy-4Wv1BC">unique data set</a> was made publicly available.  The dataset is unique in that it contains simultaneous recordings of the local field potential with the help of a new high-density <a href="https://www.nature.com/articles/nature24636">Neuropixels</a> electrode (sample or probe) and a patch electrode from a cell located near the sample.  Interest in such records is not only fundamental, but also applied, because it allows validating models for the analysis of neuronal activity recorded by modern samples.  And this, in turn, directly concerns the development of new neuroprostheses.  What is the principal novelty, and why this dataset is so important - I will tell under the cut. <br><br><img src="https://habrastorage.org/webt/ek/vd/lk/ekvdlk6ahdscvkddqqdtetarkc0.png"><br>  <i>KDPV: the result of modeling the extracellular potential near one neuron in the generation of action potential ( <a href="http://www.jneurosci.org/content/32/34/11798">source</a> ).</i>  <i>The color indicates the amplitude of the potential.</i>  <i>This illustration will be important for further understanding.</i> <br><a name="habracut"></a><br>  <a href="https://en.wikipedia.org/wiki/Electrophysiology">Electrophysiological methods for studying the</a> brain are based on recording the electrical potential of the brain.  They can be divided into non-invasive - mainly electroencephalography (EEG), and invasive, for example, electrocorticography (ECOG, ECoG), patch clamp (patch-clamp) or registration of local field potential (BOB = local field potentials, LFP) .  For the latter, a small electrode with a size of 10-100 Œºm is injected directly into the brain and its potential is recorded.  In order to investigate the mammalian brain activity at the cellular level, i.e., to measure the activity of individual cells, the available non-invasive methods cannot be applied, because the potential from one cell decays in space very quickly, literally over 100 microns (see KDPV).  Therefore, in any animal model, as in humans, non-invasive methods provide information only about the collective activity of neurons and work, rather, at the level of tissue, but not at all individual neurons. <br><br>  But with invasive methods is not so simple.  To record the activity of a neuron, it is necessary to bring the electrode very close to the neuron, ideally place it inside the cell, as is done in the patch clamp, or using <a href="https://en.wikipedia.org/wiki/Electrophysiology">sharp electrodes</a> , which is difficult in practice, very difficult.  On the other hand, any extracellular electrode with a size of ~ 10 Œºm will register action potentials from 5-10 cells around due to high density of neurons and high ionic conductivity of the extracellular solution.  Therefore, the task of registering individual cells is technically resolved by increasing the density of electrodes in the vicinity of the cell.  In this regard, modern electrophysiology is moving in the direction of increasing the density of the electrodes, increasing their number and reducing the size.  Even among the requirements, there is a need to amplify the signal closer to the registration site, in order to reduce noise, and place a multiplexer to reduce its size.  So, in 2016 it was announced in preprint, and published in Nature in 2017, and in 2018 a new high-density Neuropixels test, made using CMOS technology, on 960 electrodes, of which any 384 are available for simultaneous recording, has already appeared <a href="https://www.neuropixels.org/">on the market</a> .  The size of one registration site is 12 microns.  The sample thickness is 24 microns.  Moreover, with high-density electrodes, as well as with active amplification, people began to work a long time ago, but Neuropixels was the first to reach production and sales, therefore, in the near future, this test will be encountered more and more often in articles. <br><img src="https://habrastorage.org/webt/fw/tn/d8/fwtnd8atgkatepli9y4cyfm11sg.png"><br>  <i>Fig.</i>  <i>Neuropixels scheme.</i>  <i>960 sites are located on a monolithic silicon substrate, as well as a full-fledged multiplexer and an AD interface with 384 channels.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Data structure </h2><br>  In addition to the classic <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D1%2585%25D1%2580%25D0%25BE%25D0%25BD%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F_(%25D0%25BD%25D0%25B5%25D0%25B9%25D1%2580%25D0%25BE%25D0%25B1%25D0%25B8%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25B8%25D1%258F)">activity rhythms</a> (alpha, beta, gamma, etc.) responsible for group synchronization, the data obtained using similar samples also contain the action potentials of individual cells (PD = action potentials, AP, spikes, spikes) , which on the record look like short peaks with a duration of ~ 1 ms. <br><br><img width="50%" src="https://habrastorage.org/webt/ta/4m/qs/ta4mqsgrrgv-zd9fkquz86h_os8.png"><br>  <i>Fig.</i>  <i>Signals Neuropixels.</i>  <i>Two parts of the signal are distinguished: local field potential (LFP, up to ~ 300 Hz) and cellular activity (AP, from 300 Hz).</i> <br><br>  Moreover, if the low-frequency local field potential is usually analyzed within the framework of oscillations and spectral or wavelet analysis is used as in the EEG, then the cellular activity contains the action potentials of individual cells, it consists of discrete events against the background of noise.  The task of isolating the activity of individual cells is formally reduced to the cocktail party problem, when it is necessary to select a separate speaker from a multitude of speakers.  Big data appears when we evaluate the data stream from one such sample.  For the analysis of spikes, sampling is carried out at 30‚Äì40 kHz with digitization from 16 bits per point (uint16), thus, recording already 100 electrodes for 1 second will weigh from 8 MB.  At the same time, experiments usually last hours, which amounts to hundreds of gigabytes from only one working day, and for a full-fledged study it is necessary, say, from 10 such records.  Therefore, the potential of this sample also strongly depends on the machine learning algorithms that are used for data analysis. <br><br><h2>  Machine learning and cellular activity </h2><br>  A typical pipeline for analyzing cellular activity consists of preprocessing, segmentation of spikes and clustering.  This part of the research is usually referred to as cluster analysis or spike sorting.  Low frequency filtering (&gt; 300 Hz) is usually used as preprocessing, because it is considered that there are no other physiological rhythms above 300 Hz, and only information about individual cellular activity remains.  Also during preprocessing in dense samples, it is possible to reduce correlated noise, for example, 50 Hz interference.  Segmentation is often taken as a simple threshold, for example, everything above 5 standard deviations of noise can be considered an event.  It happens that two-threshold segmentation is used, with a soft and hard threshold, to highlight related events in space and time, as in the watershed <a href="https://www.pyimagesearch.com/2015/11/02/watershed-opencv/">segmentation</a> algorithm, only in the clustering of spikes does the distribution of markers take into account the sample topology.  After segmentation, a window with a duration of 1-2 ms is taken near the center of each event, and the signal in this window, collected from all channels, becomes a sample for further clustering.  This sample is called a spike waveform.  Different cells and their different distances from the registration site lead to the fact that their waveforms will differ (see CDRV).  As the waveform clustering algorithm itself, EM is used, template matching (template match), deep learning and many variations ( <a href="https://github.com/topics/spike-sorting">topic on github</a> ).  The only requirement is learning without a teacher.  But there is one problem.  No one knows for sure what parameters you need to take for your pipeline to make the analysis most effective.  Usually, after clustering, the analyst manually passes through the results and makes changes at discretion.  Thus, the analysis results can include both algorithm errors and human errors.  And they may not be, therefore the question of objective validation remains open. <br><br>  Validating pipeline can be in several ways.  First, changing the external conditions for the object of study.  For example, during the experiment, if you study the visual cortex, then you can change the texture, color, brightness of the image.  If there is a cell in the analysis that changes its activity depending on the stimulus, then you are lucky.  Secondly, you can pharmacologically enhance or reduce the activity of a particular cell type, for example, using blockers of certain channels.  Then the activity of your cell will increase / decrease, and you will see the difference in clustering.  However, this modulation of activity will also lead to changes in waveforms, because the profile of the action potential over time is completely determined by the kinetics of ion channels.  Thirdly, you can optogenetically or with a patch pipette, as in this dataset, measure or induce the activity of certain cells.  Due to the large signal-to-noise ratio and the stability of the patch electrode, you will be completely confident in the activity of a single cell.  Conceptually, the publication was devoted to assembling a validating dataset using a patch clamp. <br><br><img width="50%" src="https://habrastorage.org/webt/_m/32/tn/_m32tnqxsugrn1z__-v6gyf-zsc.png"><br>  <i>Fig.</i>  <i>Schematic representation of the relative position of the sample (line AB) and the patch pipette (line C'CT) in the area of ‚Äã‚Äãthe rat cortex responsible for processing sensory information from the front paw (S1FL = sensory cortex 1 forelimb.</i> <br><br>  Needless to say, methodologically, the work is extremely difficult, because experimenters had to develop a method for the mutual arrangement of two electrodes in the cerebral cortex without visual inspection with an accuracy of ~ 10 microns. <br><br><h2>  The effect of electrode density on spike clustering </h2><br>  Why is it so important to increase the density of registration sites?  For analogy, let us take the fact known among EEG researchers that, from a certain threshold, an increase in the number of electrodes in a cap does not lead to a noticeable increase in the information received, that is, the signal from the electrode is slightly different from linear interpolation of signals from neighboring electrodes.  Someone says that this threshold is reached already at 30, someone - at 50, someone - at 100 electrodes.  Who works in detail with the EEG can correct.  But in the case of cellular activity, the threshold of density of registration sites on one sample is not yet known, therefore the race of high-density samples continues.  For this, the Kampff Lab team continues to work with the sample with a 5x5 micron <sup>2</sup> site, and for this we have laid out <a href="http://www.kampff-lab.org/ultra-dense-survey/">preliminary data</a> .  Specialists working with dense electrodes share experience that, unexpectedly, the specific number of individual cells that can be isolated from samples of the same area is higher where the density of registration sites is higher.  This effect is well illustrated in <a href="https://www.mitpressjournals.org/doi/abs/10.1162/neco_a_01097">another study</a> by the same coauthors, where only part of the sites with dense samples were artificially selected and the quality of the obtained clusters after tSNE conversion on PCA values ‚Äã‚Äãfrom waveforms of spikes was visually assessed.  This is not a canon for clustering, but it is good for illustrating dependencies.  As a test, the work was performed by the Neuroseeker on 128 channels with a total size of 700x70 ¬µm <sup>2</sup> with a site of 20x20 ¬µm <sup>2</sup> . <br><br><img width="75%" src="https://habrastorage.org/webt/ry/kg/ae/rykgaeqfywupcclc5kudqjsriyk.png"><br>  <i>Fig.</i>  <i>Diagrams tSNE over PCA on wet waveforms with artificial decrease of site density on the sample.</i>  <i>Work sites are shown schematically on top of each chart.</i>  <i>It is clearly shown how exactly the number of segregated clusters grows with an increase in the density of sites, A is the best, F is the worst.</i> <br><br><h2>  What is the essence of work </h2><br>  In the data, Marques-Smith et al.  There are simultaneous recordings of patch clamp and samples.  Using data from a patch clamp, scientists found moments of action potentials and used these moments to segment and average the waveforms already in the sample.  As a result, they were able to build very high-quality distributions of the action potential in time and space over the entire sample area. <br><br><img src="https://habrastorage.org/webt/3u/ln/xh/3ulnxhcmyqqy-t49armyz5iofno.png"><br>  <i>Fig.</i>  <i>On the left are traces of cell activity simultaneously in the patch clamp (black) and on the nearest of the Neuropixels channels (blue).</i>  <i>In the middle - 500 individual samples and their averaging.</i>  <i>On the right is the distribution of the action potential in space over the sample area and in time.</i> <br><br>  Further on, the question of the variation of extracellular waveform from spike to spike is raised - yes, it is tangible and should be taken into account.  Then they show that it is fundamentally possible to track the spread of the action potential across the cell membrane with the help of its dense electrodes, but this has already been shown earlier in the works of other groups.  In conclusion, they offer potential collaborators some fundamental questions from neurophysiology that can be tried to be answered using their datasets, and also suggest using datasets to validate the pipelines for clustering cellular activity.  The latter sounds like a bold challenge, because now there is a lot of clustering algorithms, and the competition among the methods is very large.  Not every method, firstly, works with such a large number of channels, and, secondly, not everyone can give objectively high-quality clustering. <br><br><h2>  What's next </h2><br>  First, a new version of <a href="https://www.biorxiv.org/content/early/2018/03/07/275818">Neuroseeker</a> for 1300 channels is also on the way, also on CMOS technologies, preliminary data are <a href="http://www.kampff-lab.org/cmos-scanning/">already available</a> . <br><br>  Secondly, we are waiting for another datasset, already from the Allen Institute for Brain Science, which was announced at the FENS conference in 2018.  It will simultaneously use 4 (!) Neuropixels samples to study the visual cortex of mice with various visual stimuli.  They promised to publish at the end of 2018 <a href="http://observatory.brain-map.org/visualcoding">here</a> , next to the data on the biphoton (also very powerful dataset), but so far nothing. <br><br>  Third, the task of clustering cells from recording extracellular potential seems to me aesthetically beautiful.  It converges methods of microelectronics, neurophysiology and machine learning.  In addition, it has great fundamental and applied value.  I suppose that the audience of Habr will be interested to learn about the technical kitchen of electrophysiology, namely about the clustering algorithms, because in this area has developed its own zoo.  I, in turn, have accumulated several questions to these algorithms, but this one cannot be missed.  Therefore, in the next part, we will proceed to the analysis of some algorithms, starting with the canonical Klustakwik, continuing with the standard Kilosort or Spyking Circus methods, and then YASS, which <a href="https://www.biorxiv.org/content/early/2017/06/19/151928">declares itself</a> extremely strongly that it works faster and better than all the others, because DL and because it can.  A github topic with a list of some clusterers <a href="https://github.com/topics/spike-sorting">here</a> .  Anticipating some issues, I do not see the point in developing my own algorithm, because the competition is already very large, and a lot of ideas have already been implemented and tested by others.  But if there are brave souls, I will gladly contribute. <br><br>  Suggestions and suggestions are accepted.  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/435510/">https://habr.com/ru/post/435510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435500/index.html">Biometric Gloves in Motorsport</a></li>
<li><a href="../435502/index.html">The study revealed the pros and cons of makeovers</a></li>
<li><a href="../435504/index.html">Hand monsters in the fight for cleanliness: the choice of hand-held vacuum cleaner Xiaomi</a></li>
<li><a href="../435506/index.html">Gameboy based supercomputer</a></li>
<li><a href="../435508/index.html">How to make the best computers in Russia? Interview with Artyom Smirnov from HYPERPC</a></li>
<li><a href="../435512/index.html">Developers from Royole showed a folding flexible smartphone</a></li>
<li><a href="../435514/index.html">Russia is developing a processor to accelerate neural networks</a></li>
<li><a href="../435518/index.html">Paying customs duty for online purchase will be much easier.</a></li>
<li><a href="../435520/index.html">We write our programming language, part 3: Translator Architecture. Parsing language structures and mathematical expressions</a></li>
<li><a href="../435522/index.html">Snapshots of events in Axonframework 3, improving performance</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>