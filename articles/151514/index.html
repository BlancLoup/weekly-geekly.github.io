<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lighting model for two-dimensional horror games</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The most impatient: lagging demo , written in chrome . My machine boots for about 20 seconds. 

 This idea came to me about 2 years ago. I drew attent...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lighting model for two-dimensional horror games</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/069/e38/773/069e38773bf210d0beab92a40b776680.jpg" alt="image"><br>  The most impatient: <a href="https://dl.dropbox.com/u/10932081/shadows/stencil/shadows2.html">lagging demo</a> , <i>written in chrome</i> .  My machine boots for about 20 seconds. <br><br>  This idea came to me about 2 years ago.  I drew attention to the fact that, in conditions of insufficient lighting, I perceive visible objects mainly in bluish tones and with a slight loss of sharpness.  Perhaps this is a purely psychological perception, but this is not what we are talking about right now.  I was curious how a 2D game with such lighting features would look like.  In order to find out, I, without having understood the shaders, sketched a demo in the most convenient language for me - javascript.  Since the effect is applied to dimly lit areas, it is not the most noticeable of what is happening on the screen, but it adds quite tangible charm. <a name="habracut"></a><br><br>  The result is obtained from three buffers: <br>  On the first buffer, a picture is formed to which the post effect will be applied; <br>  The second buffer is used for motion-blur of the light map.  According to the meaning, it realizes ‚Äúmemory‚Äù - after the plot is lit, it will still be visible for a while, even if no light source is already directed at it. <br>  The third one draws the light map itself - lighting with geometric shadows for the current frame. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Each frame of the second buffer is shaded and blurred, the third buffer is displayed on top of it.  The result is used as information for the post-effect: at relatively high values ‚Äã‚Äãof illumination, the pixel is shaded by the standard algorithm, and at low values, a faint blur and a gradual attenuation of the red and green channels begin. <br><br>  In my implementation, the blur from the post-effect is calculated for 255 radii even before launch, and it takes 20-30 seconds. <br><br>  The older version, more nimble, without geometric shadows and with an abundance of bydlokod can poke <a href="https://dl.dropbox.com/u/10932081/shadows/shadows.html">here</a> . <br>  Fresh, with shadows - <a href="https://dl.dropbox.com/u/10932081/shadows/stencil/shadows2.html">here</a> . <br>  Both versions were written in chrome.  My Firefox also seems to be trying to draw everything, but it perceives the mouse coordinates incorrectly (I will be grateful if someone tells you how to fix it), and the FPS will be lower (probably, just the old version).  I have no operas. <br><br>  Management in the latest version: <br>  LKM - create <i>convex</i> objects from which the shadow will be cast.  The direction of creation (clockwise or counterclockwise) has a difference. <br>  PKM - cancel creation / delete object under the arm. <br>  SCM - turn on / off the second light source. <br><br>  The blur algorithm was taken <a href="http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html">from here</a> . <br>  Background picture from the recently released game <a href="http://www.theybleedpixels.com/">They bleed pixels</a> . </div><p>Source: <a href="https://habr.com/ru/post/151514/">https://habr.com/ru/post/151514/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151506/index.html">Black Isle comers again on Kickstarter</a></li>
<li><a href="../151508/index.html">Solving the problem of "empty admin" MODX Revo</a></li>
<li><a href="../151510/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ22 (September 8 - 14, 2012)</a></li>
<li><a href="../151511/index.html">Once again about the unbearable ease of testing</a></li>
<li><a href="../151512/index.html">Terminal Keynote - we show presentations in the terminal</a></li>
<li><a href="../151517/index.html">Googlebot strange behavior</a></li>
<li><a href="../151518/index.html">IPv4 agony beginning: last / 8</a></li>
<li><a href="../151520/index.html">Hewlett-Packard Company again thought about the release of a smartphone</a></li>
<li><a href="../151521/index.html">Intel plans to do away with passwords "by the wave of the hand"</a></li>
<li><a href="../151522/index.html">A torrent client whose users cannot be blamed for downloading, storing and distributing content</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>