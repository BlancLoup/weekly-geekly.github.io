<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HP P2000 MSA G3 Performance Testing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In one of our past articles on the performance of server disk systems, we talked about testing methodology and tool selection. 

 Now, we decided to c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HP P2000 MSA G3 Performance Testing</h1><div class="post__text post__text-html js-mediator-article"><br>  In <a href="http://habrahabr.ru/company/westcomp/blog/267435/">one of our past articles</a> on the performance of server disk systems, we talked about testing methodology and tool selection. <br><br>  Now, we decided to compare the performance of the entry-level storage system and the array on the P410 controller.  Let me remind you that the parameters we are interested in are: IOPS - the number of disk operations per second (the more, the better) and latency - the processing time of the operation (the less, the better). <br><br><div class="spoiler">  <b class="spoiler_title">Stand configuration:</b> <div class="spoiler_text">  <a href="http://www.westcomp.ru/catalog/servery_hp_hp_blade_polki_i_optsii/hp_bladesystem_c7000_with_2_power_supplies_4_fans_onboard_administrator_507014_b21_681840_b21_/">HP C7000</a> Chassis <br>  Blade <a href="http://www.westcomp.ru/catalog/servery_hp_hp_blade_bleyd_servery/hp_proliant_bl460s_g6_server_blade_2xxeon_quad_core_l5520_16gb_2x8_pc3_10600_ddr3_no_hdd_sa_p410i/">BL460C G6</a> <br>  <a href="http://westcomp.ru/catalog/servery_hp_proliant_dl360_1u/hp_proliant_dl360g7_2x2_8_ggts_xeon_six_core_kh5660_32gb_4x8_pc3_10600r_no_hdd_sas_sa_p410_2_pws/">HP Proliant DL360 Gen7 Server</a> <br>  <a href="http://www.westcomp.ru/catalog/servery_hp_hp_blade_interkonnekt/hp_brocade_4gb_san_switch_ae372a/">AE372A</a> pair of switches <br>  <a href="http://www.westcomp.ru/catalog/sistemy_khraneniya_sata_sas/sistema_khraneniya_hp_storageworks_p2000_g3_ap846a_ap846b/">HP StorageWorks P2000 G3 MSA</a> Shelf <br>  A pair of <a href="http://www.westcomp.ru/catalog/sistemy_khraneniya_komplektuyushchie_dlya_sistem_khraneniya/kontroller_diskovogo_massiva_hp_p2000_g3_msa_fc_iscsi_combo_modular_smart_array_controller_ap837a_/">AP837B</a> controllers <br>  Disks <a href="http://westcomp.ru/catalog/servernye_komplektuyushchie_zhyestkie_diski_hp_diski_sas_sata/2_5_hp_146gb_sas_15k_6g_hdd_512547_b21_proizvodstvo_nr/">2.5 "HP 146Gb SAS 15k 6G HDD (512547-B21, 512544-001)</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href=""><img src="https://habrastorage.org/files/fbc/304/a55/fbc304a552994a9396f87d8c45cf5cbf.jpg"></a> <br></div></div><br><a name="habracut"></a><br>  We tested the same <a href="http://freecode.com/projects/fio">fio</a> utility under Debian GNU / Linux according to the technique described in the <a href="http://habrahabr.ru/company/westcomp/blog/267435/">previous article</a> using the same toolkit.  Still refer to the raw-device via libaio. <br><br><pre><code class="hljs ruby">$cat ~<span class="hljs-regexp"><span class="hljs-regexp">/fio/oltp</span></span>.conf [oltp-db] blocksize=<span class="hljs-number"><span class="hljs-number">8</span></span>k rwmixread=<span class="hljs-number"><span class="hljs-number">70</span></span> rwmixwrite=<span class="hljs-number"><span class="hljs-number">30</span></span> rw=randrw percentage_random=<span class="hljs-number"><span class="hljs-number">100</span></span> ioengine=libaio direct=<span class="hljs-number"><span class="hljs-number">1</span></span> buffered=<span class="hljs-number"><span class="hljs-number">0</span></span> time_based runtime=<span class="hljs-number"><span class="hljs-number">2400</span></span></code> </pre> <br><br>  The configuration is as follows: the volume of LUNs is equal to the volume of Vdisk and in all configurations RAID10 is used, multipathing is enabled, connection via the Fiber Channel. <br><br><pre> <code class="hljs lua">#multipath -ll <span class="hljs-number"><span class="hljs-number">3600</span></span>c0ff000199b069319335601000000 dm<span class="hljs-number"><span class="hljs-number">-1</span></span> HP,P2000G3 FC/iSCSI size=<span class="hljs-number"><span class="hljs-number">956</span></span>G features=<span class="hljs-string"><span class="hljs-string">'1 queue_if_no_path'</span></span> hwhandler=<span class="hljs-string"><span class="hljs-string">'0'</span></span> wp=rw |-+- policy=<span class="hljs-string"><span class="hljs-string">'service-time 0'</span></span> prio=<span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-built_in"><span class="hljs-built_in">status</span></span>=active | |- <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span> sdc <span class="hljs-number"><span class="hljs-number">8</span></span>:<span class="hljs-number"><span class="hljs-number">32</span></span> active ready <span class="hljs-built_in"><span class="hljs-built_in">running</span></span> | `- <span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span> sdg <span class="hljs-number"><span class="hljs-number">8</span></span>:<span class="hljs-number"><span class="hljs-number">96</span></span> active ready <span class="hljs-built_in"><span class="hljs-built_in">running</span></span> `-+- policy=<span class="hljs-string"><span class="hljs-string">'service-time 0'</span></span> prio=<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-built_in"><span class="hljs-built_in">status</span></span>=enabled |- <span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span> sde <span class="hljs-number"><span class="hljs-number">8</span></span>:<span class="hljs-number"><span class="hljs-number">64</span></span> active ready <span class="hljs-built_in"><span class="hljs-built_in">running</span></span> `- <span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">8</span></span> sdi <span class="hljs-number"><span class="hljs-number">8</span></span>:<span class="hljs-number"><span class="hljs-number">128</span></span> active ready <span class="hljs-built_in"><span class="hljs-built_in">running</span></span></code> </pre><br><br>  Tested with increasing the number of threads from 16 to 256, in order to catch where the lack of performance begins.  The duration of each test is 40 minutes. <br><br>  So, let's look at the results on the example of the OLTP-DB profile, illustrating the dependence of IOPS and the responsiveness of the system on the number of threads: <br><br><h3>  Block size 4KB, 70% / 30% read / write, 100% random access </h3><br> <a href=""><img src="https://habrastorage.org/files/7bd/394/47d/7bd39447dcf44ae58ffb62de42c0503c.png"></a> <br> <a href=""><img src="https://habrastorage.org/files/b7b/f8e/957/b7bf8e957fd94e81af552fdf1291e019.png"></a> <br><br>  Looking at the upper graph, it becomes clear how to evaluate the system performance in isolation from the latency: as soon as the increase in the number of IOPS stalled, we got the result and only the latency will continue to grow. <br><br>  Unexpectedly, an array of eight disks shows much higher performance than storage systems with the same number of carriers, and this is especially noticeable with increasing load.  MSA P2000 stalled on 64 threads, while the increase in the number of IOPS on the P410 controller stopped at 128. <br><br>  Also clearly visible is the dependence of system performance on the number of hard drives in the array.  I think there are no comments here. <br><br>  And the conclusion from this can be done as follows: it makes sense to use this storage system when you need more flexibility in allocating disk space between virtual or physical servers and you need the ability to connect a large number of hard drives, including through expansion shelves.  However, there is no hope that all this will work faster than the local disk array of the server with the same number of disks. <br><br>  And, as always, we post a detailed <a href="https://yadi.sk/d/Ucp6dUCLmCKZi">file with the results</a> . </div><p>Source: <a href="https://habr.com/ru/post/271229/">https://habr.com/ru/post/271229/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271219/index.html">Dedicated servers in the Netherlands for Habrahabr readers without a pro-rate for November + additional 10% discount</a></li>
<li><a href="../271221/index.html">How to make the test environment as close as possible to the combat</a></li>
<li><a href="../271223/index.html">We connect GNS3 topology to Cisco dCloud</a></li>
<li><a href="../271225/index.html">Your Joomla site incorrectly gives page 404</a></li>
<li><a href="../271227/index.html">PaaS vs Licenses. Four noble truths of IT infrastructure</a></li>
<li><a href="../271231/index.html">Downloading tracks from Autotravel.ru</a></li>
<li><a href="../271233/index.html">We pick up an audio stream from Twilio via SIP and send it to RTMP CDN for further distribution</a></li>
<li><a href="../271235/index.html">How we tested the Russian workflow system on the Scala-R convergent platform</a></li>
<li><a href="../271237/index.html">Features of creating a turnkey web project from Startup Makers</a></li>
<li><a href="../271239/index.html">Testing a web service on Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>