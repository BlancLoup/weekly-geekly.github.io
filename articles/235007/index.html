<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Skype bot for deployment without Skype API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="You are probably familiar with using chat bots to manage anything. For example, it is very convenient to run an assembly or layout by simply writing a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Skype bot for deployment without Skype API</h1><div class="post__text post__text-html js-mediator-article">  You are probably familiar with using chat bots to manage anything.  For example, it is very convenient to run an assembly or layout by simply writing a message to one of your contacts in IM. <br><br>  For Skype, there are various ready bots, one of the representatives - <a href="https://github.com/opensourcehacker/sevabot">Sevabot</a> .  They all use the Skype API, which Microsoft is going to kill, so the work of all these bots may soon become impossible.  And I would not want this - in some places I use them to launch deployment. <a name="habracut"></a><br><br><h4>  How to be? </h4><br>  All living bots now work on the side of the desktop version of skype.  I organize everything in the same way, but crawling to skype is not through the API. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For one-sided submission of a ‚Äúgo-ahead‚Äù to launch something, one can get away with the creaking only by extracting messages from Skype.  Skype stores its messages inside the sqlite3 database in its data directory.  I'll just sit in wait. <br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> signal <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sleep <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sqlite3 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(sys.argv) != <span class="hljs-number"><span class="hljs-number">3</span></span>: sys.stderr.write(<span class="hljs-string"><span class="hljs-string">"Usage: %s &lt;path to skype `main.db` file&gt; &lt;watch interval in seconds&gt;\n"</span></span> % sys.argv[<span class="hljs-number"><span class="hljs-number">0</span></span>]) sys.exit(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">int_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(signum, frame)</span></span></span><span class="hljs-function">:</span></span> sys.exit(<span class="hljs-number"><span class="hljs-number">0</span></span>) signal.signal(signal.SIGINT, int_handler) dbfilename = sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>] interval = float(sys.argv[<span class="hljs-number"><span class="hljs-number">2</span></span>]) conn = sqlite3.connect(dbfilename) c = conn.cursor() c.execute(<span class="hljs-string"><span class="hljs-string">"select id from Messages where id = (select max(id) from Messages);"</span></span>) (last_msg_id,) = c.fetchone() <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: sleep(interval) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> id, body <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> c.execute(<span class="hljs-string"><span class="hljs-string">"select id, body_xml from Messages where id &gt; ?;"</span></span>, (last_msg_id,)): last_msg_id = max(id, last_msg_id) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> body</code> </pre> <br>  Run: <code>./skype-watch.py ~/.Skype/skype_login/main.db 1</code> <br><br>  With stdout, the messages received and sent by the client run with some delay.  By changing the request, you can add filtering by sender, changing the processing code - the reaction.  The idea, I think, is understandable. <br><br><h4>  So what? </h4><br>  I would like to hear ideas on how to make it two-way.  It only comes to mind that only ‚Äúunsent‚Äù messages are put into the database, which Skype itself would send - after all, if the client failed to send and shut down, Skype remembers what needs to be sent. <br>  Pros: <br><ul><li>  No API needed. </li><li>  Just like an ax, few dependencies. </li></ul><br>  Minuses: <br><ul><li>  Works only on reception. </li><li>  Does not use sqlite3 hooks. </li></ul><br><br>  <a href="https://github.com/Snawoot/skype-watch/">Rep on githaba</a> </div><p>Source: <a href="https://habr.com/ru/post/235007/">https://habr.com/ru/post/235007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234993/index.html">Let's talk for Hadoop</a></li>
<li><a href="../234997/index.html">Getting RSS feeds from twitter after updating API 1.1</a></li>
<li><a href="../234999/index.html">New media consoles on Rockchip RK3288 from the company Tronsmart already on sale</a></li>
<li><a href="../235001/index.html">Google accepted Ice Bucket Challenge from Rambler & Co</a></li>
<li><a href="../235003/index.html">Rendering 3D illustrations for IKEA</a></li>
<li><a href="../235009/index.html">Git Live service displays real-time activity on GitHub</a></li>
<li><a href="../235011/index.html">Making the game right before your eyes - part 7: 2D animations in Unity (‚Äúas in a flash‚Äù)</a></li>
<li><a href="../235017/index.html">Refreshment of the gloomy MantisBT interface</a></li>
<li><a href="../235021/index.html">YUI developers have announced the termination of further library development.</a></li>
<li><a href="../235023/index.html">Intel introduced its first 8-core processor for desktop computers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>