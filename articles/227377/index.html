<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New REST API Yandex.Disk and Polygon. And also why is Disk another API and how we did it</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many people know that Disk already has a WebDAV API for quite some time. It is quite narrowly tailored to work with the file structure, and its implem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New REST API Yandex.Disk and Polygon. And also why is Disk another API and how we did it</h1><div class="post__text post__text-html js-mediator-article">  Many people know that Disk already has a WebDAV API for quite some time.  It is quite narrowly tailored to work with the file structure, and its implementation on different platforms often has non-critical, but not very pleasant flaws.  Therefore, in addition to WebDAV, we run the REST API, which will allow developers to do the same and a little more. <br><br>  For example, when using a new API, all applications that just need to store their files in the Disk will be able to access only their folder in the Users folder in the Applications folder.  In the WebDAV API, the service will have to get the user permission to write / read the entire Disk, and not just a specific folder. <br><br> <a href="http://habrahabr.ru/company/yandex/blog/227377/"><img src="https://habrastorage.org/getpro/habr/post_images/d72/577/4b8/d725774b8569795c8f4fc0c9c18ee9da.jpg" width="800"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this post, I want to talk not about the structure or operations that our API can perform - everything is pretty obvious - but I‚Äôll go straight to interesting things: what is Hypermedia and Machine-readable and Self-describing API, and how we all implemented it . <br><a name="habracut"></a><br><h4>  Hypermedia API </h4><br>  We have provided our API with hyperlinks that link its resources to each other.  They allow you to turn the client's work from jerking hard-coded URLs into navigating the links that the API provides in the body of the returned objects.  We took the <a href="http://stateless.co/hal_specification.html">HAL</a> standard as one of the simplest and most mature standards in this area.  Currently, HAL has a draft RFC standard, and it can already be found in the API of some large companies. <br><br>  Thanks to the support of the HAL, the client understands what can be done with each object, knows the prepared or template-based <a href="http://tools.ietf.org/html/rfc6570">RFC 6570</a> URL and the HTTP action method.  In turn, client application developers can write less code, spending less time on it, and this code becomes easier and easier to read.  For example, a code that performs basic operations with folders in a disk that does not use hyperlinks would look something like this: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- import urllib import httplib import json import uritemplate headers = {'Authorization': '&lt;OAuth &gt;'} connection = httplib.HTTPSConnection('cloud-api.yandex.net') resource_url = '/v1/disk/resources' def request(method, url, query=None): if query: qs = urllib.urlencode(query) url = '%s?%s' % (url, qs) connection.request(method, url, headers=headers) resp = connection.getresponse() content = resp.read() obj = json.loads(content) if content else None status = resp.status if status == 201: #    obj = request(obj['method'], obj['href']) return obj if __name__ == '__main__': #   path = '/foo' folder = request('PUT', resource_url, {'path': path}) #      new_path = '/bar' folder = request('POST', '%s/move' % resource_url, {'path': new_path, 'from': path}) #       copy_path = '/foobar' folder_copy = request('POST', '%s/copy' % resource_url, {'path': copy_path, 'from': new_path}) #   request('DELETE', resource_url, {'path': new_path}) request('DELETE', resource_url, {'path': copy_path})</span></span></code> </pre> </div></div><br>  When using hyperlinks, there is no need to manually collect URLs and worry about query parameters already known to the object on which the operation is performed: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- import urllib import httplib import json import uritemplate headers = {'Authorization': '&lt;OAuth &gt;', 'Accept': 'application/hal+json'} connection = httplib.HTTPSConnection('cloud-api.yandex.net') resource_url = '/v1/disk/resources?path={path}' def request(method, url, params=None): url = uritemplate.expand(url, params or {}) connection.request(method, url, headers=headers) resp = connection.getresponse() content = resp.read() obj = json.loads(content) if content else None status = resp.status if status == 201: #    status, obj = request(obj['method'], obj['href']) return status, obj def do(resource, action, params=None): link = resource['_links'][action] _, obj = request(link['method'], link['href'], params) return obj if __name__ == '__main__': #   _, folder = request('PUT', uritemplate.expand(resource_url, {'path': '/foo'})) #      folder = do(folder, 'move', {'path': '/bar'}) #       folder_copy = do(folder, 'copy', {'path': '/foobar'}) #   do(folder, 'delete') do(folder_copy, 'delete')</span></span></code> </pre></div></div><br><br><h4>  Machine-readable &amp; Self-describing API </h4><br>  In addition to hypermedia, we decided to make our API self-describing and machine-readable.  In the process of preparation, we studied various standards for describing REST APIs, such as RAML, WADL, JSON Schema + JSON HyperSchema, IO Docs, Apiary Blueprints, but the final choice fell on Swagger.  One of the main advantages of Swagger is that it is being developed as a standard (the Yandex.Disk API supports version 1.2 of the specification, but the standard version 2.0 is being developed).  It describes the REST API using JSON, is fairly simple to understand, and has a nice ecosystem of tools for working with API descriptions. <br><br>  Swagger documentation covers all resources available in the API and methods for invoking them.  For each resource method, there is a description of the parameters it takes and the structure of the returned objects. <br><br>  This description can be used as a starting point for universal Swagger clients, as well as for autogenerating parts of the code of native SDKs for various languages. <br><br><h4>  Polygon </h4><br>  Thanks to the Swagger API documentation, we launched the <a href="http://tech.yandex.ru/disk/poligon/">Polygon</a> project, which gives developers the opportunity, without writing a single line of code, to send combat requests to the API.  In addition, Polygon can serve as an example of a universal client for any API that supports the Swagger description.  Our developer Roma Akinfeev prepared a <a href="http://www.youtube.com/watch%3Fv%3DmXdSz0pYVPs">screencast</a> in which he talked a little about the possibilities of Polygon. <br><br><h4>  More apps are good and different! </h4><br>  Now, the Disk API functionality is more than enough to develop applications that work with user content, for example, photo editors, slide show generators, media players, etc. <br><br>  Using our API, you can store and synchronize application data between user devices, for example, save progress in games or store user favorites and bookmarks created in your application. <br><br>  We tried to make the new API of the Disk such that it was easy and pleasant for you to use it, studying the documentation less and more intuitively learning it in practice.  Therefore, without further ado, we suggest using the Site and discover the new REST API of Yandex.Disk yourself. </div><p>Source: <a href="https://habr.com/ru/post/227377/">https://habr.com/ru/post/227377/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../227367/index.html">Satellite router Globalstar Sat-Fi distributes the Internet to ordinary gadgets</a></li>
<li><a href="../227369/index.html">The first Evernote beta for Mac 5.6 is available for installation.</a></li>
<li><a href="../227371/index.html">3D models of human viruses. Part Two: Molecular Modeling and Bioinformatics</a></li>
<li><a href="../227373/index.html">Microsoft gives a discount of up to $ 650 for the exchange of MacBook Air to Surface Pro 3</a></li>
<li><a href="../227375/index.html">Remote work with a view of the sea and mountains: personal experience in Montenegro</a></li>
<li><a href="../227379/index.html">Updating iOS version of mobile application Habrahabr</a></li>
<li><a href="../227381/index.html">‚ÄúSmart‚Äù spoon LiftWare will help people with disorders of the nervous system (hand tremor)</a></li>
<li><a href="../227383/index.html">What is an IPO and why it is needed</a></li>
<li><a href="../227385/index.html">World Programming Championship: mortal boredom (video)</a></li>
<li><a href="../227387/index.html">Martian Jubilee Curiosity: A Whole Year on the Red Planet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>