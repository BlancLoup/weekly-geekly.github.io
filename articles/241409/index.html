<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>STM32 Nucleo. We connect TFT LCD based on ILI9341 chip</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On Habr√© there are already two publications about the STM32 Nucleo platform and development in the mbed.org environment. This is a ‚Äúplatform overview‚Äù...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>STM32 Nucleo. We connect TFT LCD based on ILI9341 chip</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/ab9/2c3/5ab/ab92c35abd60aef36ed3b15c307f9e6b.jpg" alt="image"><br>  On Habr√© there are already two publications about the <a href="http://www.st.com/web/catalog/tools/FM116/SC959/SS1532/LN1847%3Fsc%3Dstm32nucleo">STM32 Nucleo</a> platform and development in the <a href="http://mbed.org/">mbed.org</a> environment.  This is a <a href="http://habrahabr.ru/post/230651/">‚Äúplatform overview‚Äù</a> and <a href="http://habrahabr.ru/post/230931/">‚Äúquick start‚Äù</a> .  I will tell you in this publication how to quickly connect an inexpensive TFT LCD module based on the ILI9341 chip.  The article will be useful and Arduino lovers who want to go to a more modern and powerful microcontrollers, using the already gained knowledge. <br><a name="habracut"></a><br>  You can get acquainted with the prices on the display, for example, on <a href="http://www.ebay.com/sch/i.html%3F_from%3DR40%26_trksid%3Dp2050601.m570.l1313.TR2.TRC1.A0.H0.Xili9341%26_nkw%3Dili9341%26_sacat%3D0">Ebay</a> . <br>  I will use the <a href="http://www.st.com/web/catalog/tools/FM116/SC959/SS1532/LN1847/PF260000">NUCLEO-F401RE board</a> , you can use any of this line. <br><br>  So, you have already read the two previous articles, so get down to business right away. <br><br>  Open our <a href="https://developer.mbed.org/compiler/">on-line compiler</a> .  Create a new program. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/e67/33d/acb/e6733dacbca043f4a784b0423df49e6e.png"><br><br>  Let's call it, for example, ili9341_display_test. <br><br><img src="https://habrastorage.org/files/c0b/68c/605/c0b68c605a9a4f23a558da7d414eb0a6.png"><br><br>  We import the <a href="http://developer.mbed.org/users/mbed_official/code/mbed/">official mbed library</a> into our project. <br><br><img src="https://habrastorage.org/files/ee9/d2c/782/ee9d2c78258f4c4caeb85e665e454b4a.png"><br><br>  We find and import. <br><br><img src="https://habrastorage.org/files/ed9/286/2d3/ed92862d30ea4370b32aefc2fd9cdd9b.png"><br><br>  Checking what is imported to our project. <br><br><img src="https://habrastorage.org/files/812/ca5/10a/812ca510a46b4631a76d06c37bad072f.png"><br><br>  In the same way we import the graphic library for our display. <br><br>  In the search for "ili9341" we find the <a href="http://developer.mbed.org/users/dreschpe/code/SPI_TFT_ILI9341/">library</a> from Peter Drescher. <br><br><img src="https://habrastorage.org/files/fd3/58e/2d7/fd358e2d76ed40e783457ad251a7ce3a.png"><br><br>  We also need fonts, importing the same, on request in the search for "TFT_fonts". <br><br><img src="https://habrastorage.org/files/e9f/bfb/f8b/e9fbfbf8b1884d2b86f79840224fd3e9.png"><br><br>  Those who want to use any other font or develop their own, there is a program to help <a href="http://www.mikroe.com/glcd-font-creator/">GLCD font creator</a> .  The program is free, but for correct import you have to shaman, and this is another topic. <br><br>  Now we will create the main file, which will be our program. <br><br><img src="https://habrastorage.org/files/eb1/89c/6e8/eb189c6e8a544a38994ccf9bd38a7424.png"><br><br>  Let's call it main.cpp. <br><br><img src="https://habrastorage.org/files/034/e8d/781/034e8d78166b4f75a6ed51c29fbccfcf.png"><br><br>  Now we have a project with two libraries, a set of fonts and the main file of the program. <br>  Click the mouse on main.cpp and <s>write</s> and paste our code. <br><br><img src="https://habrastorage.org/files/1aa/7d1/247/1aa7d1247a624c23b75b0f38738ec187.png"><br><br>  And here is the code. <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"mbed.h"</span></span></span><span class="hljs-meta"> </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   mbed #include "SPI_TFT_ILI9341.h" //      ili9341 #include "Arial28x28.h" //   SPI_TFT_ILI9341 TFT(D11, D12, D13, D8, D9, D10,"TFT"); // (mosi, miso, sck, cs, reset, dc) int main() { TFT.set_orientation(3); //    TFT.background(Blue); //    ( ) TFT.foreground(0xFFFF); //    (   rgb565) TFT.cls(); //     TFT.set_font((unsigned char*) Arial28x28); //    TFT.locate(30, 100); //    (, ) TFT.printf("Hello habrahabr.ru"); //    }</span></span></span></span></code> </pre> <br><br>  How to connect the display?  Yes, very simple! <br>  Go to the page of our board (I have this <a href="http://developer.mbed.org/platforms/ST-Nucleo-F401RE/">ST-Nucleo-F401RE</a> ). <br>  Find a picture of Arduino-compatible Headers. <br><br><img src="https://habrastorage.org/files/0c4/029/48c/0c402948c4bd4a088d9fe142080f39ac.png"><br><br>  This is pinout of our board with the pin names so familiar to all Arduino-lovers. <br>  Find the SPI interface pins. <br>  SCK - D13 <br>  MISO - D12 <br>  MOSI - D11 <br>  We also need contacts CS, reset, DC, I used respectively D8, D9, D10. <br>  In our program, this is indicated as a string: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">SPI_TFT_ILI9341 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TFT</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(D11, D12, D13, D8, D9, D10,</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"TFT"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">// (mosi, miso, sck, cs, reset, dc)</span></span></code> </pre><br>  We connect them to the corresponding contacts on our display. <br>  Also, the display must be connected to the power supply. <br>  I used VCC - + 5v (there is a 3.3 volt stabilizer on the display board, if you close it with the provided jumper, you can use 3.3 volts). <br>  GND - GND <br>  LED - backlight, designed for 3.3 volts, so connect to the contact + 3.3v. <br>  The display logic works from 3.3 volts, like our microcontroller, so we will not need to use a logic level converter, as is the case with the arduino uno. <br><br>  Now you can compile our program. To do this, click the Compile button in the online compiler and save the resulting file directly to our board (when the board is connected, we have ‚ÄúNUCLEO‚Äù removable media). <br>  If everything is done correctly, then we will see on the screen the inscription ‚ÄúHello habrahabr.ru‚Äù. <br><br><h5>  useful links </h5><br>  <a href="http://developer.mbed.org/users/dreschpe/code/SPI_TFT_ILI9341/">Here</a> you will find examples of code and usage, this is the official page of the SPI_TFT_ILI9341 library. <br>  <a href="http://developer.mbed.org/users/dreschpe/code/SPI_TFT_ILI9341/docs/b2b3e5430f81/classSPI__TFT__ILI9341.html">Here</a> functions of work with this library, such as construction of lines, squares and other <a href="http://developer.mbed.org/users/dreschpe/code/SPI_TFT_ILI9341/docs/b2b3e5430f81/classSPI__TFT__ILI9341.html">are</a> described. <br>  <a href="https://developer.mbed.org/handbook/Homepage">There is a</a> lot of useful information on mbed. <br><br>  Have fun! </div><p>Source: <a href="https://habr.com/ru/post/241409/">https://habr.com/ru/post/241409/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../241391/index.html">A little story about BlackHat Europe 2014</a></li>
<li><a href="../241393/index.html">Money, goods and some statistics. Addition</a></li>
<li><a href="../241395/index.html">First look at System Center Virtual Machine Manager Technical Preview</a></li>
<li><a href="../241399/index.html">Textolite - a static site management system</a></li>
<li><a href="../241407/index.html">System for "My game"</a></li>
<li><a href="../241411/index.html">Watch Translation in Russia October 26 and Java</a></li>
<li><a href="../241413/index.html">How does safe payment acceptance in the online store</a></li>
<li><a href="../241415/index.html">Droidutils - a set of solutions that accelerate the development of applications for Android</a></li>
<li><a href="../241419/index.html">My little story of the development and publication of mobile games</a></li>
<li><a href="../241421/index.html">Endorphin flow mechanics on the example of three space games</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>