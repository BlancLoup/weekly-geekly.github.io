<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Key Distribution Protocols on Symmetric Ciphers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This text will be one of the rewritten chapters for a textbook on the protection of information of the Department of Radio Engineering and Control Sys...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Key Distribution Protocols on Symmetric Ciphers</h1><div class="post__text post__text-html js-mediator-article">  <i>This text will be one of the rewritten chapters for a textbook on the protection of information of the Department of Radio Engineering and Control Systems MIPT (MG).</i>  <i>The full tutorial is available on <a href="https://github.com/vlsergey/infosec">github</a> (see also <a href="https://github.com/vlsergey/infosec/releases">draft releases</a> ).</i>  <i>On Habr√©, I also plan to post new ‚Äúbig‚Äù pieces, first, to collect useful comments and observations, and second, to give the community more overview material on useful and interesting topics.</i> <br><br>  The key distribution task is one of the many tasks of building a reliable communication network for many subscribers.  The task is to obtain at the right time by two legal subscribers of the network a secret session encryption key (and message authentication).  A good solution to this problem is a key distribution protocol that satisfies the following conditions. <br><br><ul><li>  As a result of the protocol operation, a secret session key must be formed between two subscribers. </li><li>  Successful completion of the protocol key distribution should mean successful mutual authentication of subscribers.  There should not be such that the protocol was successfully completed from the point of view of one of the parties, while the other party is represented by the attacker. </li><li>  Only legal users of the network should be allowed to participate in the work of the protocol.  An external user should not be able to get a common session key with any of the subscribers. </li><li>  Adding a new subscriber to the network (or exclusion from it) should not require notification of all network members. </li></ul><a name="habracut"></a><br>  The last requirement immediately excludes such variants of protocols in which each of the subscribers would know some master key of communication with any other participant.  These options are bad because with the growth of the system the number of pairs of master keys "subscriber-subscriber" grows as a square of the number of participants.  Therefore, a large part of the solutions under consideration consists in the fact that one or several T trusted centers ( <i>Trent</i> , from English <i>trust</i> ) are allocated in the network, which exactly have information about all legal participants of the network and their keys.  They will explicitly or implicitly be one of the participants in the session key generation protocols. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/un/bh/j2/unbhj2b6jvdx-uhxynvs2oefaaw.png"></div><br>  Variants of networks without a dedicated trusted center and with a dedicated trusted center T <br><br>  An important point in the analysis of solutions to this problem is that the session keys generated at a particular point in time are less reliable than the master keys used to generate session keys.  In particular, it must be assumed that although an attacker cannot obtain a session key during the communication of subscribers, he can do it after some time (days, weeks, months).  And although the knowledge of this session key will help the attacker to decrypt old messages, he should not be able to organize a new session using the session key already known to him. <br><br><h2>  Symmetric protocols </h2><br>  Symmetric will include protocols that use primitives only classical cryptography on secret keys.  These include already known block ciphers, cryptographically secure pseudo-random number generators (CRCGN) and hash functions. <br><br>  When considering the protocols will use the following notation. <br><br><ul><li>  <i>Alice</i> , <i>Bob</i> are legal network subscribers for whom a common session key is generated.  Alice is the initiator. </li><li>  <i>Trent</i> is a trusted network hub. </li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-41" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> A </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-42" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> B </script>  - Some identifiers of legal subscribers of Alice and Bob, respectively. </li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>A</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.18ex" height="2.419ex" viewBox="0 -780.1 1369.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-41" x="1044" y="-230"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>A</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-3"> E_A </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>B</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.195ex" height="2.298ex" viewBox="0 -780.1 1375.5 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-42" x="1044" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>B</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4"> E_B </script>  - the result of encrypting some data block using the secret keys of legal subscribers of the network of Alice and Bob, respectively.  This encryption can be done either by the legal subscribers themselves or by a trusted center who knows all the secret keys. </li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>a</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.866ex" height="2.419ex" viewBox="0 -780.1 1233.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-61" x="1074" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>a</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5"> R_a </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>b</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.702ex" height="2.419ex" viewBox="0 -780.1 1163.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-62" x="1074" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>b</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6"> R_b </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>t</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.59ex" height="2.419ex" viewBox="0 -780.1 1115.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-74" x="1074" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7"> R_t </script>  - random numbers generated by Alice, Bob, and Trent, respectively. </li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>A</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.822ex" height="2.419ex" viewBox="0 -780.1 1215.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-41" x="826" y="-230"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>A</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8"> T_A </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>b</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.295ex" height="2.419ex" viewBox="0 -780.1 988.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-62" x="826" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>b</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-9"> T_b </script>  , <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>T</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.747ex" height="2.298ex" viewBox="0 -780.1 1182.7 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="826" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>T</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-10"> T_T </script>  - time stamps generated by Alice, Bob and Trent respectively. </li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> K </script>  - a secret session key, the receipt of which is one of the goals of the protocols. </li></ul><br><h3>  Wide-Mouth Frog Protocol </h3><br>  The Wide-Mouth Frog protocol is perhaps the simplest center-trusted protocol.  Its author is Michael Burrows (1989, Eng. <i>Michael Burrows</i> ).  The protocol consists of the following steps. <br><br><ol><li>  Alice generates a new session key. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> K </script>  and sends it along with a timestamp, a bob id and his unencrypted id to a trusted center: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{A,&amp;#xA0;E_A&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_A,&amp;#xA0;B,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Trent</mtext></merror></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> Alice \ rightarrow \ {A, E_A \ left (T_A, B, K \ right) \} \ rightarrow Trent </script></p></li><li>  Trusted center using received unencrypted identifier <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.057ex" viewBox="0 -780.1 750.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-41" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> A </script>  , finds Alice‚Äôs secret key in Alice‚Äôs database of legal subscribers and decrypts the data packet for them.  Checks the timestamp (that the packet is not very old).  Next, it sends a similar data packet to Bob, encrypted with his private key: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_T,&amp;#xA0;A,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><merror><mtext>Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> Trent \ rightarrow \ {E_B \ left (T_T, A, K \ right) \} \ rightarrow Bob </script></p><br>  Bob, in addition to decrypting the package, also checks the time stamp of the trusted center. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/za/ce/w6/zacew6iaz7jf58_7ahdvhm3n3fo.png"></div><br>  The scheme of interaction between subscribers and trusted center in the protocol Wide-Mouth Frog <br><br>  At the end of the protocol, Alice and Bob have a common session key. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-16"> K </script>  . <br><br>  This protocol has many flaws. <br><br><ul><li>  The key generator is the initiator.  If we assume that Bob is a server providing some service, and Alice is a thin client requesting this service, it turns out that the task of generating a reliable session key falls on the shoulders of the subscriber with the lowest capacity. </li><li>  In the protocol, communication with the called subscriber occurs through a trusted center.  As a result, the second subscriber can become a target for a DDOS attack with a reflection (eng. <i>Distributed denial-of-service attack</i> ), when an attacker sends packets to a trusted center, and then creates new packets and sends them to the subscriber.  If the subscriber is connected to several networks (with several trusted centers), this will allow the attacker to disable the subscriber.  Although it is quite simple to defend against such an attack by adjusting the trusted center accordingly. </li></ul><br>  However, the most serious problem of the protocol is the possibility of using the following attacks. <br><br>  In 1995, Ros Anderson and Roger Needham (Eng. <i>Ross Anderson, Roger Needham</i> ) proposed an attack on the protocol, in which an attacker (Eve) can indefinitely extend the validity of a specific session key.  The idea of ‚Äã‚Äãthe attack is that after the end of the protocol, the attacker will send his packets back to the trusted center, complementing them with identifiers of the allegedly initiating subscriber. <br><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{A,&amp;#xA0;E_A&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_A,&amp;#xA0;B,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-17"> Alice \ rightarrow \ {A, E_A \ left (T_A, B, K \ right) \} \ rightarrow Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_T,&amp;#xA0;A,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-18"> Trent \ rightarrow \ {E_B \ left (T_T, A, K \ right) \} \ rightarrow Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Eva&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{B,&amp;#xA0;E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_A,&amp;#xA0;A,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Eva&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{B,&nbsp;E_B&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Eva&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{B,&nbsp;E_B&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-19"> Eva \ rightarrow \ {B, E_B \ left (T_A, A, K \ right) \} \ rightarrow Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_A&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T'_T,&amp;#xA0;B,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_A&nbsp;\&nbsp;left&nbsp;(T'_T,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_A&nbsp;\&nbsp;left&nbsp;(T'_T,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-20"> Trent \ rightarrow \ {E_A \ left (T'_T, B, K \ right) \} \ rightarrow Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Eva&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{A,&amp;#xA0;E_A&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T'_T,&amp;#xA0;B,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Eva&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T'_T,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Eva&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T'_T,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-21"> Eva \ rightarrow \ {A, E_A \ left (T'_T, B, K \ right) \} \ rightarrow Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T&amp;#xA0;'_&amp;#xA0;T,&amp;#xA0;A,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T&nbsp;'_&nbsp;T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T&nbsp;'_&nbsp;T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-22"> Trent \ rightarrow \ {E_B \ left (T '_ T, A, K \ right) \} \ rightarrow Bob </script></li><li>  Repeat steps 3 and 5 until the time required to decrypt <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-23"> K </script>  . </li></ol><br><br>  From the point of view of the trusted center, steps 1, 3, and 5 are valid packets, initiating the communication between subscribers.  The time stamps in them are correct (if Eve keeps up with the time to send these packets).  From the point of view of legal subscribers, each of the packages is an invitation to the other subscriber to begin communication.  As a result, two things will happen: <br><br><ul><li>  Each subscriber will be sure that the protocol for creating a new session key has ended, that the second subscriber has successfully authenticated himself to the trusted center.  And that to establish the next communication session, the new (in fact, the old) key will be used <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-24"> K </script>  . </li><li>  After the time elapsed for the attacker Eve to break the session key <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-25"> K </script>  Eva will be able to read all the correspondence between the subscribers and successfully impersonate both of the subscribers. </li></ul><br>  The second attack in 1997, Gavin Lowe (born <i>Gavin Lowe</i> ) is easier to implement.  As a result of this attack, Bob is sure that Alice has authenticated herself in front of the trusted center and wants to start a second communication session.  Which, of course, is not true, since the second session was initiated by the attacker. <br><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{A,&amp;#xA0;E_A&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_A,&amp;#xA0;B,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-26"> Alice \ rightarrow \ {A, E_A \ left (T_A, B, K \ right) \} \ rightarrow Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_T,&amp;#xA0;A,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-27"> Trent \ rightarrow \ {E_B \ left (T_T, A, K \ right) \} \ rightarrow Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Eva&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_T,&amp;#xA0;A,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Eva&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Eva&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-28"> Eva \ rightarrow \ {E_B \ left (T_T, A, K \ right) \} \ rightarrow Bob </script></li></ol><br>  In the same paper, Low proposed a protocol modification introducing explicit mutual authentication of subscribers using a random tag. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>b</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.702ex" height="2.419ex" viewBox="0 -780.1 1163.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-62" x="1074" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>b</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-29"> R_b </script>  and checking that Alice can decrypt a packet with a label encrypted with the shared session key of subscribers <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-30"> K </script>  .  However, this modification leads to the fact that the protocol loses its most important advantage over other protocols - simplicity. <br><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{A,&amp;#xA0;E_A&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_A,&amp;#xA0;B,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;E_A&nbsp;\&nbsp;left&nbsp;(T_A,&nbsp;B,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-31"> Alice \ rightarrow \ {A, E_A \ left (T_A, B, K \ right) \} \ rightarrow Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_T,&amp;#xA0;A,&amp;#xA0;K&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;A,&nbsp;K&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-32"> Trent \ rightarrow \ {E_B \ left (T_T, A, K \ right) \} \ rightarrow Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_B&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-33"> Bob \ rightarrow \ {E_K \ left (R_B \ right) \} \ rightarrow Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_B&amp;#xA0;+&amp;#xA0;1&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;+&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;+&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-34"> Alice \ rightarrow \ {E_K \ left (R_B + 1 \ right) \} \ rightarrow Bob </script></li></ol><br><h3>  Protocol Needham ‚Äî Schroeder </h3><br>  The <i>Nidham</i> ‚Äì <i>Schroder</i> protocol (born <i>Roger Needham, Michael Shroeder</i> , 1979) is similar to the modified Wide-Mouth Frog protocol, but differs in that the trusted center (Trent) does not communicate with the second subscriber while the main part of the protocol is running.  The first subscriber receives from the trusted center a special package, which he sends to the second subscriber without any modification. <br><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{A,&amp;#xA0;B,&amp;#xA0;R_A&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;B,&nbsp;R_A&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;B,&nbsp;R_A&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-35"> Alice \ rightarrow \ {A, B, R_A \} \ rightarrow Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_A&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_A,&amp;#xA0;B,&amp;#xA0;K,&amp;#xA0;E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(K,&amp;#xA0;A&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_A&nbsp;\&nbsp;left&nbsp;(R_A,&nbsp;B,&nbsp;K,&nbsp;E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_A&nbsp;\&nbsp;left&nbsp;(R_A,&nbsp;B,&nbsp;K,&nbsp;E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-36"> Trent \ rightarrow \ {E_A \ left (R_A, B, K, E_B \ left (K, A \ right) \ right) \} \ rightarrow Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(K,&amp;#xA0;A&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-37"> Alice \ rightarrow \ {E_B \ left (K, A \ right) \} \ rightarrow Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_B&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-38"> Bob \ rightarrow \ {E_K \ left (R_B \ right) \} \ rightarrow Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_B&amp;#xA0;-&amp;#xA0;1&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;-&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;-&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-39"> Alice \ rightarrow \ {E_K \ left (R_B - 1 \ right) \} \ rightarrow Bob </script></li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v3/6h/0l/v36h0lesc8m8u1z4rcv-o11gpfs.png"></div><br>  The scheme of interaction between subscribers and the trusted center in the Needham-Schr√∂der protocol <br><br><br>  The protocol provides two-way authentication of the parties, and, it would seem, protection against <i>replay</i> attacks (English <i>replay attack</i> ).  The latter is done by introducing random labels already known from the Wide-Mouth From protocol. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>a</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.866ex" height="2.419ex" viewBox="0 -780.1 1233.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-61" x="1074" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>a</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-40"> R_a </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>b</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.702ex" height="2.419ex" viewBox="0 -780.1 1163.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-62" x="1074" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>b</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-41"> R_b </script>  .  Indeed, without knowing the key, the attacker will not be able to impersonate Alice in front of Bob (since he will not be able to decrypt the packet with the encrypted tag <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>b</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.702ex" height="2.419ex" viewBox="0 -780.1 1163.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-62" x="1074" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>b</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-42"> R_b </script>  ).  However, as we agreed earlier in the introduction to this chapter, the session key itself cannot be considered reliable for a long time.  If an attacker succeeds at some point in time to obtain a previously used session key <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-43"> K </script>  , he will be able to convince Bob that he is Alice, and that this is a new session key.  To do this, he will need a packet transmitted earlier via an open channel from point 3 of the protocol. <br><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Eva&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{A,&amp;#xA0;B,&amp;#xA0;R_A&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Eva&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;B,&nbsp;R_A&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Eva&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;B,&nbsp;R_A&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-44"> Eva \ rightarrow \ {A, B, R_A \} \ rightarrow Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_A&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_A,&amp;#xA0;B,&amp;#xA0;K,&amp;#xA0;E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(K,&amp;#xA0;A&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_A&nbsp;\&nbsp;left&nbsp;(R_A,&nbsp;B,&nbsp;K,&nbsp;E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_A&nbsp;\&nbsp;left&nbsp;(R_A,&nbsp;B,&nbsp;K,&nbsp;E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-45"> Trent \ rightarrow \ {E_A \ left (R_A, B, K, E_B \ left (K, A \ right) \ right) \} \ rightarrow Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(K,&amp;#xA0;A&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-46"> Alice \ rightarrow \ {E_B \ left (K, A \ right) \} \ rightarrow Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_B&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-47"> Bob \ rightarrow \ {E_K \ left (R_B \ right) \} \ rightarrow Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_B&amp;#xA0;-&amp;#xA0;1&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;-&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;-&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-48"> Alice \ rightarrow \ {E_K \ left (R_B - 1 \ right) \} \ rightarrow Bob </script><br><br>  ... after some time ... </li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Eva&amp;#xA0;~&amp;#xA0;(Alice)&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(K,&amp;#xA0;A&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Eva&nbsp;~&nbsp;(Alice)&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Eva&nbsp;~&nbsp;(Alice)&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-49"> Eva ~ (Alice) \ rightarrow \ {E_B \ left (K, A \ right) \} \ rightarrow Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_B&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Eva&amp;#xA0;~&amp;#xA0;(Alice)</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Eva&nbsp;~&nbsp;(Alice)</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Eva&nbsp;~&nbsp;(Alice)</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-50"> Bob \ rightarrow \ {E_K \ left (R_B \ right) \} \ rightarrow Eva ~ (Alice) </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Eva&amp;#xA0;(Alice)&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(R_B&amp;#xA0;-&amp;#xA0;1&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Eva&nbsp;(Alice)&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;-&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Eva&nbsp;(Alice)&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(R_B&nbsp;-&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-51"> Eva (Alice) \ rightarrow \ {E_K \ left (R_B - 1 \ right) \} \ rightarrow Bob </script></li></ol><br>  A relatively minor flaw in the protocol is that in the second packet, the trusted center in encrypted form transmits that in the third step it is sent over an open channel ( <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>B</mi></msub><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>K</mi><mo>,</mo><mi>A</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.049ex" height="2.66ex" viewBox="0 -832 8632.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-42" x="1044" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-6C" x="1625" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-65" x="1924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-66" x="2390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-74" x="2941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-28" x="3302" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="3692" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-2C" x="4581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-41" x="5026" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-72" x="6027" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-69" x="6478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-67" x="6824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-68" x="7304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-74" x="7881" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-29" x="8242" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>B</mi></msub><mtext>&nbsp;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><mi>K</mi><mo>,</mo><mi>A</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-52"> E_B \ left (K, A \ right) </script>  ). <br><br>  If you add time stamps to the protocol, thereby limiting the time that a session key can be used, as well as fix a minor flaw with double encryption, you can get the protocol that underlies the widely used Kerberos authentication method for local networks. <br><br><h3>  Kerberos protocol </h3><br>  This section will describe the authentication protocol of the parties with a single trusted center.  The network protocol "Kerberos" uses these ideas when combining several trusted centers into a single network to ensure reliability and resiliency.  For more information about the Kerberos network protocol, see section 12.1.  "Kerberos system for LAN". <br><br>  As in the Needham-Schr√∂der protocol, the initiating subscriber (Alice) only communicates with a dedicated trusted center, receiving from it two packets with an encrypted session key ‚Äî one for itself and the other for the called subscriber (Bob).  However, unlike Needham-Schr√∂der, in the protocol under consideration, encrypted packets also contain a timestamp. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>T</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.747ex" height="2.298ex" viewBox="0 -780.1 1182.7 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="826" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>T</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-53"> T_T </script>  and session key expiration date <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-54"> L </script>  (from the English. <i>lifetime</i> - the term of life).  That allows, firstly, to protect against the replay of the attack described in the previous section.  And, secondly, it allows the trusted center to manage subscribers in a certain sense, forcing them to receive new session keys after a predetermined time has elapsed. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-55"> L </script>  . <br><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{A,&amp;#xA0;B&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;B&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{A,&nbsp;B&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-56"> Alice \ rightarrow \ {A, B \} \ rightarrow Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_A&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_T,&amp;#xA0;L,&amp;#xA0;K,&amp;#xA0;B&amp;#xA0;\&amp;#xA0;right),&amp;#xA0;E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_T,&amp;#xA0;L,&amp;#xA0;K,&amp;#xA0;A&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_A&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;L,&nbsp;K,&nbsp;B&nbsp;\&nbsp;right),&nbsp;E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;L,&nbsp;K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_A&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;L,&nbsp;K,&nbsp;B&nbsp;\&nbsp;right),&nbsp;E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;L,&nbsp;K,&nbsp;A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-57"> Trent \ rightarrow \ {E_A \ left (T_T, L, K, B \ right), E_B \ left (T_T, L, K, A \ right) \} \ rightarrow Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Alice&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_B&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_T,&amp;#xA0;L,&amp;#xA0;K,&amp;#xA0;A&amp;#xA0;\&amp;#xA0;right),&amp;#xA0;E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(A,&amp;#xA0;T_A&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;L,&nbsp;K,&nbsp;A&nbsp;\&nbsp;right),&nbsp;E_K&nbsp;\&nbsp;left&nbsp;(A,&nbsp;T_A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Alice&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_B&nbsp;\&nbsp;left&nbsp;(T_T,&nbsp;L,&nbsp;K,&nbsp;A&nbsp;\&nbsp;right),&nbsp;E_K&nbsp;\&nbsp;left&nbsp;(A,&nbsp;T_A&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-58"> Alice \ rightarrow \ {E_B \ left (T_T, L, K, A \ right), E_K \ left (A, T_A \ right) \} \ rightarrow Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#xA0;left&amp;#xA0;(T_T&amp;#xA0;+&amp;#xA0;1&amp;#xA0;\&amp;#xA0;right)&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;rightarrow&amp;#xA0;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(T_T&nbsp;+&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\&nbsp;rightarrow&nbsp;\&nbsp;{E_K&nbsp;\&nbsp;left&nbsp;(T_T&nbsp;+&nbsp;1&nbsp;\&nbsp;right)&nbsp;\}&nbsp;\&nbsp;rightarrow&nbsp;Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-59"> Bob \ rightarrow \ {E_K \ left (T_T + 1 \ right) \} \ rightarrow Alice </script></li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mq/sr/ta/mqsrtatu68qa4gfedvofubd38d8.png"></div><br>  The scheme of interaction between subscribers and trusted center in the protocol "Kerberos" <br><br><br>  Please note that the third step, by using the timestamp from the trusted center <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>T</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.747ex" height="2.298ex" viewBox="0 -780.1 1182.7 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="826" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>T</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-60"> T_T </script>  instead of a random tag from bob <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>b</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.702ex" height="2.419ex" viewBox="0 -780.1 1163.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-62" x="1074" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>b</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-61"> R_b </script>  allows you to reduce the protocol by one step compared with the Needham-Schroeder protocol.  Also, the presence of a timestamp makes it unnecessary to pre-generate a random label by Alice and transfer it in the first step. <br><br>  It is interesting to note that the packages <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>A</mi></msub><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>T</mi><mi>T</mi></msub><mo>,</mo><mi>L</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>B</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.453ex" height="2.66ex" viewBox="0 -832 11389.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-41" x="1044" y="-230"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-6C" x="1619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-65" x="1917" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-66" x="2384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-74" x="2934" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-28" x="3296" y="0"></use><g transform="translate(3685,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="826" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-2C" x="4868" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4C" x="5313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-2C" x="5995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="6440" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-2C" x="7329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-42" x="7774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-72" x="8784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-69" x="9235" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-67" x="9581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-68" x="10061" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-74" x="10638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-29" x="10999" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>A</mi></msub><mtext>&nbsp;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>T</mi></msub><mo>,</mo><mi>L</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>B</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62"> E_A \ left (T_T, L, K, B \ right) </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>B</mi></msub><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>T</mi><mi>T</mi></msub><mo>,</mo><mi>L</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>A</mi><mtext>&amp;#xA0;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.447ex" height="2.66ex" viewBox="0 -832 11386.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-42" x="1044" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-6C" x="1625" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-65" x="1924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-66" x="2390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-74" x="2941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-28" x="3302" y="0"></use><g transform="translate(3692,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="826" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-2C" x="4874" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4C" x="5319" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-2C" x="6001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-4B" x="6446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-2C" x="7336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-41" x="7781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-72" x="8781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-69" x="9233" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-67" x="9578" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-68" x="10059" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-74" x="10635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-29" x="10997" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>B</mi></msub><mtext>&nbsp;</mtext><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>T</mi></msub><mo>,</mo><mi>L</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>A</mi><mtext>&nbsp;</mtext><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-63"> E_B \ left (T_T, L, K, A \ right) </script>  identical in format.  In a sense, they can be called session key certificates for Alice and Bob.  Moreover, all such pairs of packages can be generated in advance (for example, at the beginning of the day), put on a shared resource, provided for free use and turned off the trusted center (he has already done his job by generating these packages).  And up to the point in time <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>T</mi><mi>t</mi></msub><mo>+</mo><mi>l</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.717ex" height="2.419ex" viewBox="0 -780.1 2461.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-74" x="826" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMAIN-2B" x="1162" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/342814/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgqEmDQreq7ptRdOFtbX_EJ6Mv8oQ#MJMATHI-6C" x="2163" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>T</mi><mi>t</mi></msub><mo>+</mo><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-64"> T_t + l </script>  these "certificates" can be used.  But only if you are one of the allowed pairs of subscribers.  Of course, this idea is impractical - because the number of such pairs grows as a square of the number of subscribers.  However, it is interesting that such packages can be generated in advance.  This idea will come in handy when we consider the <i>public key infrastructure (PKI <i>).</i></i> <i><i><br><br></i></i>  <i><i><i>(the following is a discussion of protocols using asymmetric encryption)</i></i></i> <i><i><br><br></i></i>  <i><i><i>Afterword for those who read Schneier and Wikipedia.</i></i></i>  <i><i><i>This section is mainly based on the third chapter of the book ‚ÄúApplied Cryptography‚Äù (2002 edition), the information from which was framed in the form of a lecture that was read to students, who prepared the articles in the Russian section following the presentation (and the book, and other sources). Wikipedia.</i></i></i>  <i><i><i>Information from articles (for example, about attacks) was further used in lectures and in the manual.</i></i></i>  <i><i><i>Interestingly, Schneier did not trace the connection between the individual protocols, although from a methodological point of view it is always interesting to trace the evolution from a simple solution (Wide-Mouth Frog) to a complex one (Kerberos).</i></i></i>  <i><i><i>For the same purpose, punctured <a href="https://ru.wikipedia.org/wiki/Yahalom">Yaholom was</a> excluded from consideration.</i></i></i>  <i><i><i>He is good - just does not fit into the "evolutionary" chain.</i></i></i>  <i><i><i>And to give it to students just for the sake of ‚Äúone more protocol,‚Äù it seems to me, is wrong.</i></i></i> </div><p>Source: <a href="https://habr.com/ru/post/342814/">https://habr.com/ru/post/342814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342802/index.html">How to cook blockchain</a></li>
<li><a href="../342804/index.html">Postgres Pro Quiz Task at Highload ++ 2017</a></li>
<li><a href="../342806/index.html">JARVIS for (not) iron man: how Perf will become an assistant for each Delivery manager</a></li>
<li><a href="../342810/index.html">Cutting hippo. Again about design and refactoring from Sandy Metz</a></li>
<li><a href="../342812/index.html">Selection of useful materials: Microservices on .NET Core</a></li>
<li><a href="../342818/index.html">Use DevOps to turn IT into a strategic weapon.</a></li>
<li><a href="../342820/index.html">How we built the software-defined data center in the drawer</a></li>
<li><a href="../342822/index.html">What happens in Kubernetes when starting the kubectl run? Part 2</a></li>
<li><a href="../342824/index.html">Log4j2 log aggregation by ELK</a></li>
<li><a href="../342826/index.html">Linux operating systems for different tasks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>