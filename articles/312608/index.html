<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ESP8266 bath control, 2 years - normal flight</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I would like to share the results of the 2-year development work (the end of 2014 - the beginning of 2015 production) - one of the fir...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ESP8266 bath control, 2 years - normal flight</h1><div class="post__text post__text-html js-mediator-article">  In this article I would like to share the results of the 2-year development work (the end of 2014 - the beginning of 2015 production) - one of the first is the bath management system.  Development was done ‚Äúon the knee‚Äù, in a single copy, using LUT technology (therefore not so beautiful). <br><br>  I haven‚Äôt written about new developments for a long time and in two years the development vector has changed - now there is something to boast about as piecework as well as serial ones for the same esp - more than 300 pieces (at the moment).  But more about that later. <br><a name="habracut"></a><br><h3>  Description of the complex </h3><br>  To more clearly imagine why the bath management system, I will describe its design and technical characteristics (they are unique, I have permission to publish from the customer. As for commercial copying, I can give you contacts). <br><br>  Bath - is a frame building of 2 rooms - steam rooms and lounges. <br>  The frame is insulated with 200 mm of wool (which I don‚Äôt remember exactly), the roof also.  Sheathed with metal siding.  Independent ventilation in both rooms. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The floor in both rooms - concrete slabs, on a thick layer of extruded polystyrene foam, do not have a rigid connection with the foundation - that is,  the plates are not connected with the building - floor tiles are laid. <br><br>  The rest room is 2.7 x 2.6 meters clapboard, the room has: <br><br><ul><li>  2 tanks of 200 liters of water, in each heater 2 kW, total 4 kW </li><li>  Shield with RCDs, automatons, power switching, bath control system, power supply - 3 phases </li><li>  Shower cabin </li><li>  Pump to increase the water pressure in the shower </li><li>  Electric heater 0.7 kW </li></ul><br>  Furniture does not describe, because  has nothing to do with the article. <br><br>  The steam room has dimensions of 2.4 x 2.4 x 2.4 meters, brick walls of 88 mm, tiles on the walls and on the floor, the ceiling is a rabbeted board of 35 mm in 2 layers at 90 degrees.  The room has: <br><br><ul><li>  Oven 12 kW (used for heating stones, parasitic heat is spent on additional heating of the steam room) Fully located indoors, has its own foundation </li><li>  On the 3rd wall 3 electric heaters in the amount of 3.7 kW </li><li>  Under the canopy on the 4th wall 2 heaters in the amount of 1.4 kW </li><li>  Drainage pump, 12v </li></ul><br><h3>  Work algorithm </h3><br>  When the bath is not in use, it maintains the established temperature of the standby (around 13 degrees or how much they will expose).  For this involved: the only heater in the rest room and 1 of the heaters in the steam room. <br><br>  At the time when visiting the bath is planned, a command is sent to activate the operating mode (you can specify the activation time).  The heating of the sauna is turned on (5.1 kW heaters).  Inside the steam room on the surface of the wall and on the other side of the wall there are 2 temperature sensors that monitor the indoor temperature and the warming of the wall masonry. <br><br>  The heating takes place until the set temperature of the wall masonry is heated (about 65 degrees), the temperature limit on the inner wall surface is around 90 degrees - all settings, of course, change in the browser interface. <br><br>  Upon reaching the specified values, the system maintains the set temperature until the start of operation of the steam room. <br><br>  At the moment when the thermostat of the steam room switched to the temperature maintenance mode, the inclusion of the heaters of the steam room is extremely rare due to the large heat capacity of the walls (the room as a whole).  When the heaters are turned off, the water in the tanks is heated to the set temperatures. <br><br>  The simultaneous activation of the heating of water tanks and steam rooms is excluded by software and at the circuit level.  Those.  heating in tanks is possible only when heaters are not used in the steam room. <br><br>  If you intend to use the steam room in the traditional Russian bath mode, then an hour before the steam room starts operating or when it is already set to work, 1 stove is used to heat the stones (this is enough for 2-3 trips with good superheated steam - transparent, then 2 -3 visits - for girls =)). <br><br>  For safety reasons, when turning on the light in the steam room, all the heaters in the steam room are de-energized.  It remains only 12v, on the lighting and pump. <br><br>  The complex can be enabled either via SMS, manually - from the buttons in the bath itself, or via the web interface. <br><br><h3>  Electronic filling </h3><br>  Actually the main part of the article will be even less than the description above.  The hero of the whole design <b>esp8266 in the form of esp-01</b> =) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/121/78d/a7b/12178da7be4baac12dcef8d7849dcfc5.jpg" alt="image"><br><br>  He had to pull out the GPIO4 and GPIO5 legs with the wires - at that time I did not have another esp. <br><br>  [image will come later] <br><br>  And so, what services this device: <br><br><ul><li>  5 temperature sensors (ds18b20) are connected in parallel to each other (one leg ESP): <br><br><ul><li>  Masonry exterior sensor </li><li>  Sensor inside the steam room </li><li>  Cold water sensor </li><li>  Hot water sensor </li><li>  Room temperature sensor </li></ul><br></li><li>  The button of inclusion / permission of heating of water (one leg of ESP) </li><li>  Button for activating the steam heating program (one leg ESP) </li><li>  Switching control switch 7 relay through shift register (2 legs ESP) </li></ul><br><h3>  The result of the work without outside intervention </h3><br>  The current time of continuous operating time is 2 years.  Operation - 3..6 times a month, year-round, even more often use a thermostat on the water.  The main launch method is sms, less often web interface, even less often with buttons.  The main method of monitoring the state is a web interface.  For the masonry to fully warm up to 65 degrees in the winter, it takes about 10 hours; in summer, about the same figure. <br><br>  The customer is delighted throughout the operation time - he can do different modes of operation (traditional bath, sauna, hammam). <br><br>  The main mode that is currently in use is to activate the warming up of the masonry up to 50 degrees (the switch is set approximately 6 hours before arriving at the cottage), in the steam room it is 90 degrees.  As they arrived they stoked the stove to heat the stones - 1 hour and you can use it. <br><br>  At the same time, to raise the required level of humidity in the ‚ÄúRussian bath‚Äù mode, the walls are moistened with a broom 10 minutes before use.  The initial moisture level is 20%. <br><br>  Here is a miracle.  Unfortunately, the photo of the final device did not, although I was there in September 2016, I decided to write an article spontaneously (although it didn‚Äôt turn out to be beautiful - but I‚Äôll definitely do it, and I will update the article) <br><br>  <strong>UPD.</strong>  I pulled out a web-interface from the code, I substituted figures for an example <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8f/692/7ec/e8f6927ec6089f4dcbdc5d4831b18f4d.png" alt="image"><br><br>  <strong>UPD2.</strong>  Answers to questions from comments: <br><ul><li>  I program in eclipse </li><li>  web-interface is formed on esp </li><li>  http server borrowed from the project esp-httpd </li><li>  In this device, the firmware is written in SDK 1.0.0 from the manufacturer esp </li><li>  ds18b20 - power is supplied directly from the unit (i.e., to the MC only the ‚Äúdata‚Äù pin).  All are connected in parallel to each other - between the "data" and "+" one for all 4.7 kOhm resistor. </li><li>  The sms is handled by a netbook in the house - it checks the white list of numbers, parses the sms and gives the command to turn the bath on or off, notifies the return sms about the execution </li><li>  The house has a router through which the netbook and bath interact.  The house and the bath are located at a distance of 15 meters from each other.  Taking into account the fact that esp is closed in an iron box, and the finishing of the bath is metal siding - the connection with the house is stable. </li><li>  Problems in work since 2015 - not seen </li></ul></div><p>Source: <a href="https://habr.com/ru/post/312608/">https://habr.com/ru/post/312608/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312594/index.html">Comparison of the performance of the 1C system under Linux and Windows</a></li>
<li><a href="../312596/index.html">Thematic modeling of repositories on GitHub</a></li>
<li><a href="../312600/index.html">NSCO algorithm (Ho-Kashyap algorithm)</a></li>
<li><a href="../312602/index.html">Open a set of free courses on programming and development for FPGA</a></li>
<li><a href="../312604/index.html">Crossover: High-paying, full-time teleworking for IT professionals</a></li>
<li><a href="../312616/index.html">New PowerShell Features in Windows Server 2016</a></li>
<li><a href="../312620/index.html">As we all sent to yukh (well, or continuation of the story about the template engine)</a></li>
<li><a href="../312624/index.html">Presentation of DriverPack Cloud</a></li>
<li><a href="../312626/index.html">How to make friends Bagri and MongoDB</a></li>
<li><a href="../312628/index.html">Using CSS Flexbox to position blocks on page</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>