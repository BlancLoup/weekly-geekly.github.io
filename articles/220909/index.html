<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>About seven cylinders</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After reading the article about seven contiguous cylinders , I wondered: is this really such a difficult task? Or was she just not seriously engaged b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>About seven cylinders</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/158/823/4e7/1588234e741ce92b3e43724367e872f2.jpg" align="right">  After reading the <a href="http://habrahabr.ru/post/218403/">article about seven contiguous cylinders</a> , I wondered: is this really such a difficult task?  Or was she just not seriously engaged before? <br>  The position of the infinite cylinder of a known radius in space is given by four independent quantities (it has 4 degrees of freedom).  For seven cylinders in general position, 28 values ‚Äã‚Äãare required.  Each condition ‚Äútwo cylinders touch‚Äù gives one restriction, only 7 degrees of freedom remain.  Six of them - moving space, the latter remains on the configuration itself.  That is, we should have one or several one-parameter families of configurations, unless topology interferes (due to which there can be no solutions at all). <br>  Instead of cylinders, it is more convenient for us to work with straight lines.  If the diameters of the two cylinders are the same and equal, say, to one, then they touch (externally) if and only if the distance between their axes is one.  Consider this fact, and let's go look for seven <s>red perpendicular</s> straight lines ... <br><a name="habracut"></a><br>  Our first task is to reduce the number of variables that describe the system, if possible.  To begin with, we will get rid of the movements of space.  We say that the first straight line is the Oz axis.  Suppose we have another straight line B, the distance from which to Oz is 1. Let the point on B, which is closest to Oz, have coordinates <i>(x, y, z)</i> .  Then, as you can see, the condition <img src="https://habrastorage.org/getpro/habr/post_images/070/05f/56d/07005f56da506dc65699c7373484e2ba.gif">  , and the directing vector of the straight line B can be specified in the form <i>(-y, x, d)</i> for some <i>d</i> .  Thus, the straight line is given by 4 numbers <i>x, y, z, d</i> with one additional condition. <br>  We still have two degrees of freedom of movement of space: a shift along the Oz axis and a turn around it.  Fix them by choosing <i>x = 1, y = z = 0</i> for the second straight line.  The remaining 20 unknowns (parameters of the remaining 5 lines) are not limited further. <br>  The condition that the distance between two straight lines with parameters <i>(x <sub>1</sub> , y <sub>1</sub> , z <sub>1</sub> , d <sub>1</sub></i> and <i>(x <sub>2</sub> , y <sub>2</sub> , z <sub>2</sub> , d <sub>2</sub></i> is 1) can be written as <br><img src="https://habrastorage.org/getpro/habr/post_images/7e6/a3d/e95/7e6a3de9532a22877afec2fa8800d3ee.gif"><br>  This is the 6th degree equation, connecting 8 unknowns.  The degree can be reduced to the fourth, if we take a slightly different parametrization of the line (to say that it passes through the point <i>(x, y, 0)</i> and has a direction vector <i>(u, v, 1)</i> ), but then we lose lines that are perpendicular to Oz. <br>  So, we have a polynomial equation.  It remains to compile a system of 20 such equations with 21 unknowns, and think about what to do with it.  Remember this, and look for another way. <br>  Let's say that <img src="https://habrastorage.org/getpro/habr/post_images/798/d7b/b9f/798d7bb9f5c80093210e124453215faf.gif">  for some angle <img src="https://habrastorage.org/getpro/habr/post_images/171/69a/674/17169a6741a1bb27b86a1280ebc0586a.gif">  .  Then the straight line will have three parameters <img src="https://habrastorage.org/getpro/habr/post_images/ce6/4f1/4f5/ce64f14f545ea9cdcde77f5a9777c49e.gif">  for the second line we will have <img src="https://habrastorage.org/getpro/habr/post_images/22e/aa5/37b/22eaa537bf4a4a3f5e57f785a376812e.gif">  , and the equation fixing the distance between two straight lines will look like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/8f2/0bf/61c/8f20bf61c86aee4e81961a4939e59e4a.gif"><br>  Where <img src="https://habrastorage.org/getpro/habr/post_images/d02/f54/0b2/d02f540b237302b22f49139e73a8bb78.gif">  .  This is a quadratic equation for <i>z <sub>2</sub> -z <sub>1</sub></i> , that is, knowing the magnitudes <img src="https://habrastorage.org/getpro/habr/post_images/86b/a8c/02d/86ba8c02dcd125131240e8d16e66448b.gif">  we can easily get two possible values ‚Äã‚Äãof <i>z <sub>2</sub> -z <sub>1</sub></i> . <br><h2>  The action plan will be like this. </h2><br>  1. Let's try a random search.  Generate a random set <img src="https://habrastorage.org/getpro/habr/post_images/c50/a03/fa0/c50a03fa05973c1f8ad866f6988fdeb6.gif">  .  For each straight line from the 3rd to the 7th, we write the condition at a distance of up to the 2nd straight line - it will give us two possible values ‚Äã‚Äãof the unknowns <i>z <sub>3</sub> , ... z <sub>7</sub></i> .  For each of the 32 possible combinations of these values, check how much the distance between the remaining pairs of lines will differ from 1, and choose the best combination.  We will try to drive all distances by 1 with some optimization method. If we succeed, we win.  If not, repeat a million times. <br>  2. If the search did not return any results, we expand the search.  We will go from all possible combinations of <i>z <sub>3</sub> , ... z <sub>7</sub></i> . <br>  3. Note that if we have four contacting cylinders, then the number of cylinders relating to all of them, of course.  Let's build the first 4 cylinders in some way (we have 4 degrees of freedom), then we will look (by random search) for as many cylinders that are in contact with them, choose three of them, pairwise distances between the axes of which are as close as possible to 1, and try optimize the resulting set. <br>  4. The same, but first, we look for <i>all</i> touching cylinders, solving a system of 4 polynomial equations (it has 32 roots in a complex field), and then we iterate over all the triples of their axes. <br>  5. If you are unlucky again, we start thinking about what these configurations are and how you can use them. <br>  Unfortunately, nothing came of this plan.  Why? <br><br><h2>  Random Search and Optimization </h2><br>  To optimize a random solution, I used the most tried and tested method - the Newton method.  True, for his work, he needs the number of equations to be equal to the number of unknowns, so it was decided to fix the unknown <i>d <sub>2</sub></i> (that is, the angle between the first and second straight lines).  Find the partial derivatives of <i>z <sub>k</sub> -z <sub>m</sub></i> by <img src="https://habrastorage.org/getpro/habr/post_images/7be/f8f/dfe/7bef8fdfeba69f63adf60496c986b1dc.gif">  - a matter of technology, and we easily build the matrix of the Jacobian of our system of size 10 * 10.  True, instead of the usual formula <i>x: = xJ <sup>-1</sup> f (x),</i> I used the slower movement <i>x: = xc * J <sup>-1</sup> f (x)</i> , where c changed from 0.1 to 0.001 (because the terrain on which you wander, very uneven and with a lot of local minima).  Then it turned out that this method loves to glue straight lines, after which it tries to divide by 0 - I had to explain to him that if <img src="https://habrastorage.org/getpro/habr/post_images/c0d/d94/b5e/c0dd94b5e83ebaf7f4c34f40cb210723.gif">  for any pair of straight lines is close to zero, then in this attempt we suffered a setback. <br>  Write such a search was easy.  After correcting all the unrecorded moments, I launched it - and the first solution was found after a few seconds, at about the 9000th attempt.  Over the next 30 minutes, the program found 500 configurations, then on average one of 7500 attempts was successful. <br>  An independent check showed that the solutions were correct - the distances between pairs of straight lines differed from 1 by no more than 10 <sup>-9</sup> .  But, after reviewing the built pictures, I found that many of them are somewhat similar ... So the next question was: which configurations are the same and in what sense? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/118/e96/458/118e96458c646dd054456793d0ab1e66.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/264/3f0/b55/2643f0b55f7c1b1b1124fd6e1a16a821.jpg"><br><br>  There were no ideas how to approach this issue.  Therefore, I remembered the remaining degree of freedom, and decided to see how the cylinders can move without interrupting each other.  It turned out that, for example, like this: <br><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://video.yandex.ru/iframe/astr73/k5769bjv45.5447/&amp;xid=17259,15700022,15700186,15700191,15700253&amp;usg=ALkJrhhONhd5XfpSl6LHPPCw8AwO50o9HA" width="419" height="315" frameborder="0" scrolling="no" allowfullscreen="1"></iframe><br>  Considering the minimum required cylinder length for each configuration (i.e., the maximum distance between the touch points on each cylinder measured along the axis), and plotting graphs, I came to the conclusion that most of the configurations found give the same trajectory.  It was easy to build such a trajectory with a small step and count for each configuration a set of invariants.  Then for each of the 500 solutions I found, I found the point closest to it on this trajectory.  480 configurations hit right on the path, but the other 20 were new.  They behaved like this: <br><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://video.yandex.ru/iframe/astr73/1aymi8aq3j.1334/&amp;xid=17259,15700022,15700186,15700191,15700253&amp;usg=ALkJrhj3mg6esnBuXi0n9JMAfoSVvqDKOA" width="419" height="315" frameborder="0" scrolling="no" allowfullscreen="1"></iframe><br>  For some reason, this trajectory, although it ends in infinity, but begins in a kind of impasse, to continue through which it fails.  I have not solved this riddle yet.  In addition, there are signs that two trajectories in some place do not either intersect, or they converge very closely. <br>  In any case, 2-5 points of the plan are not needed. <br><br>  After going through another 70 million points and finding more than 10,000 solutions, the program did not discover anything new.  So only the first minute of the account was spent with benefit ... <br><br>  UPD: The situation was somewhat worse than I thought.  The second family of configurations turned out to be just one of the branches of the first family, but with a different choice of the first two cylinders.  And with one end this branch rests not on the point, not on another impassable zigzag - and I have not yet managed to find its continuation. <br>  A random search only gives points from an already found family.  It is possible that there are no other configurations (and connected components of the solution set).  It will be necessary to check whether the configurations that the Hungarians have found differ in reality. <br><br>  UPD2: In general, there was an error in the program - some matrix coefficients were wrong (but despite this, the iterations somehow converged :)).  After correction, convergence improved markedly, and 100 million start points were processed in about an hour.  All the solutions found (about 9 thousand) lay on the main trajectory ... Apparently, there are no more solutions. <br>  By the way, if you solve a system of polynomial equations, then the correct solution is difficult to find.  Any polynomial describing the condition that the distance between the lines is 1 will vanish for any pair of parallel lines, so that there will be a lot of parasitic components in the solution set. </div><p>Source: <a href="https://habr.com/ru/post/220909/">https://habr.com/ru/post/220909/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220897/index.html">TI-84 +</a></li>
<li><a href="../220899/index.html">Solar batteries - 60 years</a></li>
<li><a href="../220901/index.html">Dell Desktop Virtualization Forum 2014</a></li>
<li><a href="../220903/index.html">Eversync - now with iOS and Windows Phone support</a></li>
<li><a href="../220905/index.html">IBM's nanofrezer has created the world's smallest magazine cover</a></li>
<li><a href="../220911/index.html">Consoles games: like falling in love with video games turned into an interesting game dev</a></li>
<li><a href="../220913/index.html">Nimbus Note - now on Android</a></li>
<li><a href="../220917/index.html">How is the musical search. Lecture in Yandex</a></li>
<li><a href="../220919/index.html">Ilon Musk officially confirmed the successful landing of the first stage of the Falcon-9</a></li>
<li><a href="../220921/index.html">Is the string operator + simple?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>