<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parallel data sorting in GPU</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will introduce you to the concept of parallel sorting . We will discuss the theory and implementation of a pixel shader. 

 Gif 
 In...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parallel data sorting in GPU</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/0t/go/cu/0tgocuz0jmus-tn-7tayej3m8xu.png"></div><br><br>  In this article I will introduce you to the concept of <strong>parallel sorting</strong> .  We will discuss the theory and implementation of a pixel shader. <br><br><div class="spoiler">  <b class="spoiler_title">Gif</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/458/e1d/c10/458e1dc1050ae5aa134f55b051d3ffe2.gif"></div></div></div><br><h4>  Introduction </h4><br>  If you studied computer theory in the 80s or 90s, chances are that you tried hard to understand what some developers find delightful in <strong>sorting algorithms</strong> .  What initially seems an insignificant task turns out to be the cornerstone of Computer Science. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But what is the "sorting algorithm"?  Imagine that you have a list of numbers.  The sorting algorithm is a program that gets this list and changes the order of the numbers in it.  The concept of sorting algorithms is often introduced in the study of <strong>computational complexity</strong> - another extensive area of ‚Äã‚Äãknowledge, which I will discuss in detail in future articles.  There are an infinite number of ways to sort the list of items, and each strategy provides its own unique compromise between cost and speed. <br><a name="habracut"></a><br>  Most of the complexity of sorting algorithms arises from how we define the problem, and how we approach its solution.  To decide how to reorder elements, the algorithm must compare numbers.  Scientifically, each comparison made increases the complexity of the algorithm.  Complexity is measured by the number of comparisons performed. <br><br>  However, not everything is so simple: the number of comparisons and replacement of elements depends on the list itself.  That is why in the theory of computers there are more effective ways to evaluate the performance of the algorithm.  What is the worst case scenario?  What is the maximum number of steps he will take to sort the most unsorted list that he can work with?  This way of looking at a problem is known as <strong>worst case</strong> analysis.  We can ask the same question in the best possible scenario.  What is the minimum number of comparisons the algorithm must perform to sort the array?  If simplified, the latter task often refers to the <strong>designation ‚ÄúO‚Äù large</strong> , which measures complexity as a function of the number of elements to be sorted. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> n </script>  .  It is proved that under such conditions no algorithm can run faster than <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.051ex" height="2.66ex" viewBox="0 -832 12508 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="3559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-4F" x="3857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="4871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-65" x="5169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-66" x="5636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="6186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-28" x="6548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="6937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="7788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6F" x="8086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="8572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="9052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-72" x="9903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="10354" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="10700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="11180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="11757" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-29" x="12118" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ mathcal {O} \ left (n \ log n \ right) </script>  .  This means that there can be no algorithm that always sorts any incoming array of length <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> n </script>  by performing less than <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.419ex" viewBox="0 -780.1 2715.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6F" x="1149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="1634" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="2115" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> n \ log n </script>  comparisons. <br><br><div class="spoiler">  <b class="spoiler_title">But O (n log n) means something else!</b> <div class="spoiler_text">  If you are familiar with the designation ‚ÄúO‚Äù large, you can understand that in the previous paragraph we have very simplified the explanation. <br><br>  One can imagine ‚ÄúO‚Äù large as a way of expressing a ‚Äú <em>order of magnitude</em> ‚Äù function.  I.e <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.051ex" height="2.762ex" viewBox="0 -831.5 12508 1189" role="img" focusable="false" style="vertical-align: -0.83ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="3559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-4F" x="3857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="4871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-65" x="5169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-66" x="5636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="6186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-28" x="6548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="6937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="7788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6F" x="8086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="8572" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="9052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-72" x="9903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="10354" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="10700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="11180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="11757" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-29" x="12118" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> \ mathcal {O} \ left (n \ log n \ right) </script>  with <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.074ex" viewBox="0 -772.3 1001 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-30" x="500" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> 10 </script>  elements doesn't really mean that there will be <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.074ex" viewBox="0 -772.3 1001 892.8" role="img" focusable="false" style="vertical-align: -0.28ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-33" x="500" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> 33 </script>  comparisons.  There may be 10, or even 100 times more.  For a superficial understanding, it is important that the number of comparisons needed to sort an array grows in proportion to <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.307ex" height="2.486ex" viewBox="0 -772.3 2715.5 1070.5" role="img" focusable="false" style="vertical-align: -0.693ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6F" x="1149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="1634" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="2115" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> n \ log n </script>  . <br><br>  In future articles I will discuss the topic of computational complexity from a purely mathematical point of view. </div></div><br><h4>  Video processor limitations </h4><br>  Traditional sorting algorithms are created based on two main concepts: <br><br><ul><li>  <strong>Comparison</strong> : an operation that compares two list items and determines which one is larger; </li><li>  <strong>Replace</strong> : relocation of two items to bring the list closer to the desired state. </li></ul><br>  The list that needs to be sorted is often specified as an array.  Access to arbitrary elements of the array is extremely efficient, and in it without any restrictions you can swap any two elements. <br><br>  If we want to use a shader for sorting, then we will first have to deal with the inherent limitations of the new environment.  Although the list of numbers can be passed to the shader, this will not be the best way to use its parallelism.  Conceptually, you can imagine that the GPU executes the same shader code simultaneously for each pixel.  Usually this does not happen, because the video processor probably does not have enough computing power to parallelize the calculations for each pixel.  Some parts of the image <em>will be</em> processed in parallel, but we should not make assumptions about which parts it is.  Therefore, the shader code should be executed under the same restrictions of <em>true</em> parallelism, even if in fact it is not always executed this way. <br><br>  However, a more serious limitation is that the shader code is localized.  If the GPU executes part of the code for a pixel in the coordinate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.015ex" height="2.66ex" viewBox="0 -832 6464.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-65" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-66" x="1015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="1565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-5B" x="1927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-78" x="2205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-2C" x="2778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-79" x="3223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-72" x="3970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="4422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="4767" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="5248" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="5824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-5D" x="6186" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> \ left [x, y \ right] </script>  , we cannot write to any other pixel, except <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.015ex" height="2.66ex" viewBox="0 -832 6464.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-65" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-66" x="1015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="1565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-5B" x="1927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-78" x="2205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-2C" x="2778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-79" x="3223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-72" x="3970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="4422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="4767" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="5248" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="5824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-5D" x="6186" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> \ left [x, y \ right] </script>  .  In the shader, the replace operation requires synchronization of both pixels. <br><br><h4>  Sorting in the video processor </h4><br>  The concept of the approach presented in this article is simple. <br><br><ul><li>  Sorted data is transmitted as a texture; </li><li>  If we have an array <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> n </script>  elements, we create texture by size <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.994ex" height="1.937ex" viewBox="0 -728.2 3872.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="1212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6D" x="1557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-65" x="2436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-73" x="2902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-31" x="3372" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> n \ times 1 </script>  pixels; </li><li>  The value of the red channel of each pixel contains the number to be sorted; </li><li>  Each rendering pass will <em>bring the</em> array <em>closer</em> to its final state. </li></ul><br>  For example, let's imagine that we have to sort a list of four numbers: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.247ex" height="2.66ex" viewBox="0 -832 8287 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-65" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-66" x="1015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="1565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-5B" x="1927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-34" x="2205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-2C" x="2706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-33" x="3151" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-2C" x="3651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-32" x="4096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-2C" x="4597" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-31" x="5042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-72" x="5793" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="6244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="6590" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="7070" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="7647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-5D" x="8008" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> \ left [4,3,2,1 \ right] </script>  .  We can pass it to the shader by creating a texture from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.762ex" height="2.057ex" viewBox="0 -780.1 3772.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-34" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6D" x="1457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-65" x="2336" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-73" x="2802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-31" x="3272" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> 4 \ times 1 </script>  pixels, keeping the values ‚Äã‚Äãin the red channel: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/920/689/4a9/9206894a9d5c7f062dcaf795ef43ab60.png"></div><br>  As mentioned above, the operation of changing places when executed in a shader is much more complicated, because it must be performed in parallel by two independent pixels.  The easiest way to work with such a restriction is to swap adjacent pairs of pixels: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/48e/657/cc8/48e657cc81d7c8c25a6d389ae597012e.png"></div><br>  It is important to add that, compared with the execution in the CPU, the process is performed in almost the opposite order.  The first pixel samples its previous value. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.057ex" viewBox="0 -780.1 500.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-34" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> 4 </script>  and the value on the right <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.937ex" viewBox="0 -728.2 500.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-33" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> 3 </script> .  Since it is left in the <strong>replacement pair</strong> , it must accept the smaller of the values.  The second pixel must perform the opposite operation. <br><br>  Since these calculations are performed independently of each other, both parts of the code must "agree" without any communication, which of the values ‚Äã‚Äãshould be dropped down.  This is the difficulty of parallel sorting.  If we are not careful, both pixels of the replacement pairs will take the same number, thus duplicating it. <br><br>  If we repeat the replacement process, nothing will change.  Each pair can be sorted in one step.  Reproduction of this process will not lead to any changes.  To cope with this, you need to change the replacement pairs.  We can see this in the following diagram: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/794/c8b/21b/794c8b21b59841e4ac3b55f1b59087f2.png"></div><br><br><div class="spoiler">  <b class="spoiler_title">What about pixels around the edges?</b> <div class="spoiler_text">  There are several solutions that can be used to extend this solution to work with the first and last pixels. <br><br>  The first approach is to consider these two pixels as part of one replacement pair.  This approach will work, but will require the creation of additional conditions, which in the shader code will inevitably lead to a decrease in performance. <br><br>  A simpler solution is to simply trim the texture.  The two outermost pixels will perform replacements with themselves: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/af9/c76/b75/af9c76b758013545764c7d63d8787947.png"></div></div></div><br>  We can alternately use these two steps until the entire image is sorted: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/27a/ab8/013/27aab801323ac4b4784e8fb8e39293eb.png"></div><br>  This technique has existed for quite some time, and is implemented in a variety of styles and variations.  Often it is called <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BE%25D1%2580%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B0_%25D1%2587%25D1%2591%25D1%2582-%25D0%25BD%25D0%25B5%25D1%2587%25D0%25B5%25D1%2582" rel="noopener"><strong>odd-even sorting</strong></a> , because replacement pairs have odd / even and even / odd indices.  This working mechanism is deeply connected with bubble sorting, so it is not surprising that the algorithm is often called <strong>parallel bubble sorting</strong> . <br><br><h4>  Complexity </h4><br>  When working with a video processor, we must assume that the same shader code is simultaneously executed for each pixel.  In a traditional CPU, we must consider each comparison / replacement as a separate operation.  The shader pass will be considered <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> n </script>  operations.  If we assume that we can calculate them all in parallel, then the execution time of one and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> n </script>  will be the same.  Therefore, the parallel complexity of each pass of the shader is <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.937ex" viewBox="0 -728.2 500.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-31" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> 1 </script>  . <br><br>  What will be the worst case complexity?  We see that each step moves a pixel to its final position.  Maximum pixel displacement is <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20"> n </script>  that is, to sort the list we need no more <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-21"> n </script>  steps. <br><br>  If you look at this task from a more traditional perspective, everything becomes more complicated.  Each pass of the shader analyzes each pixel at least once, that is, adds complexity <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22"> n </script>  .  Combined with the number of passes <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23"> n </script>  it provides complexity <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.193ex" height="2.901ex" viewBox="0 -935.7 10846.9 1249" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="3559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-4F" x="3857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="4871" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-65" x="5169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-66" x="5636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="6186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-28" x="6548" y="0"></use><g transform="translate(6937,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-32" x="849" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-72" x="8241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="8693" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="9038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="9519" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="10095" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-29" x="10457" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-24"> \ mathcal {O} \ left (n ^ 2 \ right) </script>  .  This shows us how ineffective even-odd sorting is when performing sequentially. <br><br><h2>  Part 2. Shader implementation. </h2><br><h4>  Shaders for simulation </h4><br>  Shaders are usually used to process the textures they pass.  The results of their work are visualized on the screen, and the textures themselves do not change.  In this article we want to do something different, because we want the shader to work iteratively with one texture.  We discussed in detail how this is done in the previous series of posts <a href="https://www.alanzucconi.com/%3Fp%3D4539" rel="noopener">How to Use Shaders for Simulations</a> . <br><br>  The idea is to create two <strong>render textures</strong> - special textures that can be changed in the shader.  The diagram below shows how this process works. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a7a/99d/082/a7a99d08230973818ca7c4df3a7fc165.png"></div><br>  Two render textures are cyclically reversed so that the shader pass uses the previous one as input, and the second as output. <br><br>  In this article we will use the implementation presented in the post <a href="https://www.alanzucconi.com/%3Fp%3D4539" rel="noopener">How to Use Shaders for Simulations</a> .  If you have not read it yet, then do not worry.  We will focus only on the algorithm itself, you just need to know the following: <br><br><pre><code class="hljs bash">float4 frag(vertOutput i) : COLOR { //  X, Y  [0, _Pixels-1] float2 xy = (int2)(i.uv * _Pixels); <span class="hljs-built_in"><span class="hljs-built_in">float</span></span> x = xy.x; <span class="hljs-built_in"><span class="hljs-built_in">float</span></span> y = xy.y; // UV-  [0,1] float2 uv = xy / _Pixels; // UV-   <span class="hljs-built_in"><span class="hljs-built_in">float</span></span> s = 1.0 / _Pixels; ... }</code> </pre> <br>  The <strong>fragmentary function of the</strong> shader will contain the sort code.  The variable <code>uv</code> denotes the UV coordinates of the current pixel being drawn, and <code>s</code> represents the size of a pixel in UV space. <br><br><h4>  Reorder in pair replacement </h4><br>  In the previous section, we introduced the concept of a <strong>substitution pair</strong> .  Pixels are grouped into pairs, which are then sorted in a single shader pass.  Let's imagine two adjacent pixels whose colors <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-25"> x </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-26"> y </script>  represent two numbers.  A shader pass must sample these two pixels and change their order accordingly. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/468/9ac/665/4689ac665c3610b24116bfdcc1d2ceb8.png"></div><br>  To do this, the pixel from the left side of the replacement pair samples two pixels above and selects as its final color. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.768ex" height="2.66ex" viewBox="0 -832 8511.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6E" x="1224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-6C" x="2074" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-65" x="2373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-66" x="2839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="3390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-28" x="3751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-78" x="4141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-2C" x="4713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-79" x="5158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-72" x="5906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-69" x="6357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-67" x="6703" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-68" x="7183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMATHI-74" x="7760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/345824/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjSelQ1ieoTEcSXrJGfyihXo7gSbQ#MJMAIN-29" x="8121" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-27"> min \ left (x, y \ right) </script>  .  The pixel on the right does the opposite: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fba/39a/66c/fba39a66c8c097ea9789716799b3d750.png"></div><br>  The position of a pixel determines not only the operations that need to be done, but also the sampled pixels.  <strong>Min pixels</strong> should sample pixels in the current position and to the right of it.  <strong>Max pixels</strong> should sample the pixel on the left. <br><br><pre> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">/  max float3 C = tex2D(_MainTex, uv).rgb; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   float3 L = tex2D(_MainTex, uv + fixed2(-s, 0)).rgb; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   result = max(L, C); /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  min float3 C = tex2D(_MainTex, uv).rgb; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   float3 R = tex2D(_MainTex, uv + fixed2(+s, 0)).rgb; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  result = max(C, R);</span></span></code> </pre> <br>  In addition, the min and max pixels are swapped after each operation.  The diagram below shows which pixels perform the operation min (blue), and which ones - operation max (red): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/854/e2c/1ed/854e2c1edc5db3c98e8e7c5091e658c9.png"></div><br>  The two determining factors in the choice of the operation being performed are <strong>the iteration number</strong> <code>_Iteration</code> and the <strong>index of the element</strong> <code>x</code> (or <code>y</code> , if we sort not the rows, but the columns). <br><br>  Looking at the above scheme, we can derive the last condition, which allows to determine which operation should be performed - min or max: <br><br><pre> <code class="hljs lua">//  / #define EVEN(x) (<span class="hljs-built_in"><span class="hljs-built_in">fmod</span></span>((x),<span class="hljs-number"><span class="hljs-number">2</span></span>)==<span class="hljs-number"><span class="hljs-number">0</span></span>) #define ODD(x) (<span class="hljs-built_in"><span class="hljs-built_in">fmod</span></span>((x),<span class="hljs-number"><span class="hljs-number">2</span></span>)!=<span class="hljs-number"><span class="hljs-number">0</span></span>) float3 C = tex2D(_MainTex, uv).rgb; //  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( ( EVEN(_Iteration) &amp;&amp; EVEN(x) ) || ( ODD (_Iteration) &amp;&amp; ODD (x) ) ) { //  <span class="hljs-built_in"><span class="hljs-built_in">max</span></span> float3 L = tex2D(_MainTex, uv + fixed2(-s, <span class="hljs-number"><span class="hljs-number">0</span></span>)).rgb; //  result = <span class="hljs-built_in"><span class="hljs-built_in">max</span></span>(L, C); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //  <span class="hljs-built_in"><span class="hljs-built_in">min</span></span> float3 R = tex2D(_MainTex, uv + fixed2(+s, <span class="hljs-number"><span class="hljs-number">0</span></span>)).rgb; //  result = <span class="hljs-built_in"><span class="hljs-built_in">min</span></span>(C, R); }</code> </pre> <br>  This condition ensures that during even iterations (second, fourth, ...) the pixels in the even position will perform the operation max, and the pixels in the odd position will perform the operation min.  In the odd iterations (first, third, ...) the opposite happens. <br><br>  In order for this effect to work, both the render textures need to be set to <strong>Clamp</strong> , because the shader code has no boundary conditions that prevent access to pixels outside the texture. <br><br><h4>  Conclusion </h4><br>  Other sorting animations can be found in this gallery: <br><br><div class="spoiler">  <b class="spoiler_title">Animations</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed//a/n5OYx/embed?pub=true&amp;ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br>  <i>[Approx.</i>  <i>Lane: on the author's page in Patreon you can download the <a href="https://www.patreon.com/posts/15861954">Standard</a> and <a href="https://www.patreon.com/posts/15862102">Premium</a> versions of the shader for a fee.</i> </div><p>Source: <a href="https://habr.com/ru/post/345824/">https://habr.com/ru/post/345824/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345814/index.html">Dynamic loading of the template Vue component</a></li>
<li><a href="../345816/index.html">WD Red drives - a balanced solution for use in small and medium NAS</a></li>
<li><a href="../345818/index.html">Visualization of the development of SEMrush.com 2017</a></li>
<li><a href="../345820/index.html">Backup Mikrotik with SSH and SCP</a></li>
<li><a href="../345822/index.html">Defining a file format with Python</a></li>
<li><a href="../345826/index.html">ThreeFlow branch strategy</a></li>
<li><a href="../345830/index.html"># Acceleration4X. Principle number 0/1. Variable environment</a></li>
<li><a href="../345832/index.html">Issue # 5: IT training - current issues and challenges from leading companies</a></li>
<li><a href="../345834/index.html">"Hello Christmas - New Year!" Or program NanoCAD with Visual Basic .NET</a></li>
<li><a href="../345836/index.html">Richard Hamming: The Basics of the Digital (Discrete) Revolution</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>