<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Visualize attacks, anomalies, and information security breaches using OpenGraphiti</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Those who visit our headquarters from San Jose are always struck by a large video wall that displays a real-time attack pattern with the ability to dr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Visualize attacks, anomalies, and information security breaches using OpenGraphiti</h1><div class="post__text post__text-html js-mediator-article">  Those who visit our headquarters from San Jose are always struck by a large video wall that displays a real-time attack pattern with the ability to drill down after touching certain areas of the screen. <br><br><img src="https://habrastorage.org/files/0e3/08e/326/0e308e3269014556bbf4c934cbb57b21.png" alt="Cisco Interactive Security Wall"><br><br>  However, like any attack map, and I already have 34 in my <a href="http://lukatsky.blogspot.ru/2014/07/blog-post.html">collection</a> , any such visualization is ineffective in real life.  Show bosses, show reporters, include in any video ... It's all useful, but in practice it is applicable a little.  Usually you have your own data sets that are generated by your security tools.  And you are interested in what is happening in your network or directed at your network, but certainly not beautiful cards with ‚Äúballistic missile strikes‚Äù, which are drawn by an absolute majority of companies providing attack visualization services. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/51a/6d7/d3e/51a6d7d3e9f641aebece00c874de9a2b.png" alt="Cisco Malware Activity Map"><br><br>  One of the solutions to the problem that has arisen is the open source toolkit <a href="http://www.opengraphiti.com/">OpenGraphiti</a> , developed by <a href="https://www.opendns.com/">OpenDNS</a> , which is now part of <a href="http://cisco.com/security/">Cisco</a> .  OpenGraphiti is a free 3D data visualization engine that analysts can use to display and analyze semantic networks.  Having your own API allows you to effectively use OpenGraphiti for your own purposes, which, in the case of information security, include: <br><br><ul><li>  botnet visualization </li><li>  DDoS Attack Visualization </li><li>  spamming visualization </li><li>  visualization of hacker campaigns </li><li>  visualization of the movement of the malware / hacker over the network </li><li>  vulnerability visualization </li><li>  visualization of wireless devices, incl.  and unauthorized </li><li>  visualization of IoT devices </li><li>  visualization of information flows within the corporate or departmental network, including in the analysis of e-mail </li><li>  visualization of connections in social networks </li><li>  etc. </li></ul><br>  Here's how, for example, the part of the Dark Hotel spy campaign network built with OpenGraphiti looks like: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/174/149/fd8/174149fd85cc8629aacb83ab8c40c2c3.jpg" alt="Dark Hotel Campaign Visualization"><br><br>  It is necessary to give some explanations to the color legend of this semantic network.  Red shows the domains to which the initial request was directed, and the blue - the final point, to which the request was redirected through intermediate nodes marked in white.  It is worth paying attention to these differences, since they once again demonstrate that banal ‚Äúblack‚Äù lists in the proxy, access control systems to the Internet or even in ITU, are focused on fighting the ‚Äúred‚Äù nodes, completely ignoring the complex chain of interaction in the malicious infrastructure. <br><br>  And this is what the ZeuS semantic network looks like: <br><br><img src="https://habrastorage.org/files/1ed/e5c/ad1/1ede5cad134345b899a5ab03bef67ae5.jpeg" alt="ZeuS Infrastructure Visualization"><br><br>  Finally, this is how the Shellshock vulnerability spreads: <br><br><img src="https://habrastorage.org/files/308/1dd/8e8/3081dd8e85c34ee6aeb9fa44646fa6f3.jpeg" alt="Shellshock vulnerability spread"><br><br>  Of course, the essence of the semantic network is best displayed not by a static picture, but by a dynamic changing map, which can change its scale and detail depending on the tasks facing analysts.  For example, this is how WikiLeaks sees the site and interacts with it: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/JsEm-CDj4qM%3Ffeature%3Doembed&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhi-FQNlM3caaSzjRNCz8_jqRHivkA" frameborder="0" allowfullscreen=""></iframe><br><br><h3>  What is a semantic network? </h3><br>  The semantic network is, as <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D0%25BC%25D0%25B0%25D0%25BD%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B5%25D1%2582%25D1%258C">Wikipedia</a> says, an information model of the domain that has the form of a directed graph.  This graph consists of vertices (nodes), which are the studied entities.  Here's how, for example, the semantic map of concepts of domestic GOST R ISO / IEC 15408, also known as ‚ÄúGeneral criteria‚Äù, looks. <br><br><img src="https://habrastorage.org/files/aa8/2a8/b56/aa82a8b5638246a0a4d56e4ad9fc46a5.jpeg" alt="Semantic network on the example of GOST R ISO / IEC 15408"><br><br>  If it is more practical to apply the semantic network to the visualization of attacks and other anomalies, then different characteristics of servers and nodes in the network ‚Äî Web, email, NTP, SSH, etc. ‚Äî can be considered as entities or vertices of the graph.  Another example is social media accounts or email inboxes.  The edges or arcs of such a graph (connections between nodes) describe relationships between entities.  Examples of such edges are bandwidth, time, number of connections / messages, etc. <br><br>  In the process of creating our own semantic network, we will need to create our own set of entities of interest to us, depending on the goals of the analysis.  For example, when analyzing social networks, both individuals and companies that interest us can be used as entities (graph vertices).  At the same time as the edges of the graph can be considered: <br><br><ul><li>  Place of work </li><li>  Account creation date (allows bots to be calculated) </li><li>  Account activity </li><li>  Religion </li><li>  Groups in which subjects of interest are involved </li><li>  Etc. </li></ul><br>  It is very easy to analyze internal and external communications using a semantic network.  You can take e-mail addresses as entities, and you can take many different attributes as relationships between entities: <br><br><ul><li>  time of writing letters (or sending messages using instant messengers) </li><li>  communication method (e-mail, skype, Jabber, etc.) </li><li>  device (personal or service) </li><li>  etc. </li></ul><br><img src="https://habrastorage.org/files/3f3/cf3/886/3f3cf388641740cbbe5ccfd0c7d1842b.png" alt="Semantic network of intracorporate communications"><br><br>  If we want to analyze network interaction, then we can take IP addresses, servers, hosts, ITUs, routers, proxies, autonomous systems, etc., as the entities under study.  And as relations (edges of the graph) we can analyze the ports used in the network interaction, the host name (hostname), the country (geo-binding), the autonomous system (AS), the domain.  Note that the autonomous system is mentioned twice - both as an entity and as a relationship.  Why is that?  It all depends on what we want to analyze.  If we are interested in how traffic flows between different autonomous systems, then they will interest us precisely as entities, that is, nodes of the semantic network.  And if we are interested in from where we are most often attacked, then the autonomous system turns into a relation for us, that is, the edges of the graph. <br><br>  The benefits enjoyed by OpenGraphiti include: <br><br><ul><li>  provision of context for searching various interrelations between entities of interest, including various anomalies </li><li>  ‚ÄúStory‚Äù of the history of your security on the basis of Big Data </li><li>  the ability to compare different attacks and campaigns </li><li>  assistance in the attribution of intruders and finding out the entry points for various infringements of information security </li><li>  show ‚Äúshow‚Äù in real time, which allows you to correlate an attack or other violation with various news from the world of security (publishing information about vulnerabilities, new attacks, etc.). </li></ul><br>  If a little more attention is paid to the first advantage, then with the help of visualization we can identify the use of DGA (Domain Generation Algorithms), which are used not only for marketing purposes, but also by malware.  One-day sites whose domains are created automatically and in large numbers in order to bypass the blacklist mechanism. <br><br><img src="https://habrastorage.org/files/b16/17e/17b/b1617e17b09a4b41a905cb16f7a01184.png" alt="Examples of semantic maps for DGA sites"><br><br>  Once again, OpenGraphiti is a free open source tool, the requirements for which are quite simple: <br><br><ul><li>  MacOS or Linux </li><li>  Clang ++ or g ++ </li><li>  Python 2.7.x </li></ul><br>  Instructions for installing and configuring OpenGraphiti are available at <a href="http://www.opengraphiti.com/">www.opengraphiti.com</a> .  The construction itself is customizable and can be integrated into its own monitoring centers (SOC), tying it with your own data.  So, for example, OpenGraphiti runs on <a href="https://labs.opendns.com/global-network/">the OpenDNS site</a> (Chrome is required): <br><br><img src="https://habrastorage.org/files/29e/3c8/72b/29e3c872b1704fcd96896f83f2da186b.png" alt="Using OpenGraphiti on the OpenDNS site"><br><br>  Obviously, as the data grows, so does the complexity of the map.  It can be managed using entity grouping or selection.  For example, I can visualize not the entire network for millions of IP addresses (as in the Cisco network), but the sets of nodes grouped by different criteria ‚Äî geolocation, departmental membership, node importance, etc.  This allows us not to immediately immerse in the details, but to embrace the picture from a bird's-eye view and then dive into the region we need at the given moment in time. <br><br>  Here's how, for example, the Zbot botnet map looks like: <br><br><img src="https://habrastorage.org/files/0cb/ca1/a84/0cbca1a842b446caad7864fd42f41e7f.jpeg" alt="Zbot botnet map"><br><br>  Using the scaling function for various parameters, we can change the level of detail of the same map: <br><br><img src="https://habrastorage.org/files/098/ce9/a7f/098ce9a7f1aa4c40a3342d3dd30c57e9.jpeg" alt="Zbot botnet map"><br><br>  Why do we need visualization and why can we not get along with plain text or tabular presentation of the data that the existing defenses generate to us?  There is a good analogy.  If we imagine that the human eye can transmit visual data to the brain at the speed of Ethernet, then reading the text allows you to interact with the brain at dial-up speed.  It is obvious that working with textual information, namely, it is mainly used by most of the means of protection, today has a number of shortcomings, among which the main thing is precisely the speed of perception and the detection of implicit interdependencies.  This is especially important when we are dealing with monitoring large amounts of frequently changing data.  To achieve the desired effect with textual data is difficult and visualization, which by no means cancels the already existing types of analysis, is a good help (provided that we know what to look for and where). <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/TE9qsYBu8MM%3Ffeature%3Doembed&amp;xid=17259,15700002,15700021,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjhptyeC_zAYi_ROTl1Q6f88wZm6A" frameborder="0" allowfullscreen=""></iframe><br><br>  In conclusion, I would like to note that today, in an environment where IS analysts are overloaded, it is very important to choose the right toolkit for visualizing large amounts of data, allowing you to <b>see the</b> protected system, which allows us to ask the right questions and get the right answers, which is the key building the right information security strategy in the enterprise.  And OpenGraphiti helps in solving this problem. </div><p>Source: <a href="https://habr.com/ru/post/308774/">https://habr.com/ru/post/308774/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../308762/index.html">Application Performance Management. HPE Recipe</a></li>
<li><a href="../308764/index.html">DDoS: IT Maniacs on the Point of Attack</a></li>
<li><a href="../308766/index.html">Horizon - realtime javascript backend</a></li>
<li><a href="../308768/index.html">Oracle Specialization: MUK Learning Center presents authorized training at Oracle University</a></li>
<li><a href="../308772/index.html">DisType: a simple application for communication</a></li>
<li><a href="../308776/index.html">The future of computer technology: an overview of current trends</a></li>
<li><a href="../308778/index.html">Windows Server 2012, 2008 and 2003: Tests of Available System Performance</a></li>
<li><a href="../308780/index.html">By 2020, the development of the Internet of Things will invest $ 6 trillion</a></li>
<li><a href="../308782/index.html">Select the composition of isomorphic React applications for the next 12 months.</a></li>
<li><a href="../308788/index.html">PHP: the wrong way</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>