<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating programs for Mac OS X. Part 3: Apple Script</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this part, I will talk about another interesting application development tool for Mac OS X - the Apple Script scripting language. 

 Apple Script w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating programs for Mac OS X. Part 3: Apple Script</h1><div class="post__text post__text-html js-mediator-article">  In this part, I will talk about another interesting application development tool for Mac OS X - the Apple Script scripting language. <br><br>  Apple Script was designed to be used by end users, not programmers, and to allow them to control the applications and documents they work with.  For example, using Apple Script, you can open a photo in the image editor, crop it to the desired size, write a link to the photo in a text file, etc. <br><a name="habracut"></a><br><br>  Unlike how the user interacts with the application through the GUI, for example, typing information into the application text fields for working with databases, AppleScript works quite differently, the script uses the internal object model of the application, thereby adding values ‚Äã‚Äãto the database itself.  This means that while the script is running, the application does not even need to be shown.  Naturally, such a model of work requires that your application be written with support for Apple Script. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Every application that understands Apple Script publishes supported commands to the Apple Event dictionary, which is used to identify valid commands. <br><br><h1>  A language very similar to natural </h1><br>  In the <a href="http://radio-t.com/">Radio-T</a> podcast, the host <a href="http://habrahabr.ru/users/bobuk/" class="user_link">bobuk</a> said that the script written in Apple Script is read like ordinary English text.  In principle, he is right, because  this is one of the fundamental features of Apple Script. <br><br>  The Apple Script engine combines verbs and nouns to perform actions.  For example, to print a document, a page from a document or a specific fragment, instead of calling the functions printPage, printDocument, printRange, we take the verb print and add the required noun: <br><blockquote>  print page 1 <br>  print document 2 <br>  print pages 1 thru 5 of document 2 </blockquote><br>  To work with a specific application, the word ‚Äútell‚Äù is used. <br><blockquote>  tell application "iTunes" <br>  playpause <br>  end tell </blockquote><br>  The previous expression can be written in one line. <br><blockquote>  tell application "Microsoft Word" to quit </blockquote><br>  For events from the "Core Suite" (activate, open, re-open, close, print, exit) you can use the following instructions: <br><blockquote>  quit application "iPhoto" </blockquote><br>  Constructs can be nested: <br><blockquote>  tell application "QuarkXPress" <br>  tell document 1 <br>  tell page 2 <br>  tell text box 1 <br>  set word 5 to "Apple" <br>  end tell <br>  end tell <br>  end tell <br>  end tell </blockquote><br><br>  You can use hierarchy as follows: <br><blockquote>  pixel 7 of row 3 of TIFF image "my bitmap" </blockquote><br>  But Apple‚Äôs capabilities are not limited to managing other applications.  With it, you can create a normal Cocoa application with a graphical interface, etc.  For example, the following code: <br><blockquote>  set pix to 72 <br>  set answer to text returned for display dialog "Enter in the number of inches" default answer "1") <br>  display dialog answer &amp; "in =" &amp; (answer * pix) &amp; "px" </blockquote><br>  when executed, it will show a dialog box asking for the input of a count of inches, then this value is converted into pixels and the result is shown in the next window. <br><br>  Also, the script can be saved to continue to use as a full application.  A trigger event handler must be inside the following construct: <br><blockquote>  on run <br>  - handler code <br>  end run </blockquote><br>  In principle, it is possible not to write it, then at the start script processing will start from the first line in the file. <br><br>  If you throw a couple of other files on a script file, the following handler will be used at startup: <br><blockquote>  on open theItems <br>  - do something with these theItems <br>  end open </blockquote><br><br>  Scentav for writing scripts are in / Applications / AppleScript <br><img src="https://habrastorage.org/getpro/habr/olpictures/ff4/68b/233/ff468b2337cd8279c7f216c39ad106c0.png" width="450" height="317" hspace="10" vspace="10"><br>  As an editor / interpreter, use ScriptEditor.app <br><img src="https://habrastorage.org/getpro/habr/olpictures/5f0/2e0/465/5f02e046589bf92b9c311b9ff716406a.png" width="450" height="290" hspace="10" vspace="10"><br>  To open the Apple Event dictionary, in the Script Editor menu, click File =&gt; Open Dictionary, a window opens with a list of applications <img src="https://habrastorage.org/getpro/habr/olpictures/fb4/74c/5a5/fb474c5a5b36d74146c77a168bb4cf01.png" width="450" height="245" hspace="10" vspace="10"><br>  Select the right one (for example, iTunes) and click OK.  A window opens with a description of the commands for the application we need. <img src="https://habrastorage.org/getpro/habr/olpictures/16b/a92/7ba/16ba927ba6ff5ddfa380b10343f61b92.png" width="450" height="267" hspace="10" vspace="10"><br><br>  And now let's write a simple Cocoa application with which you can control iTunes. <br>  Open XCode, File =&gt; New Project, Cocoa Application =&gt; in the Project Name write iTunes_Controller.  Add a new Objective-C class "controller".  In the file controller.h we write <br><blockquote>  #import &lt;Cocoa / Cocoa.h&gt; <br><br>  <a href="http://habrahabr.ru/users/interface/" class="user_link">interface</a> controller: NSObject { <br>  } <br>  - (IBAction) nextClick: (id) sender; <br>  - (IBAction) prevClick: (id) sender; <br>  - (IBAction) pauseClick: (id) sender; <br>  - (IBAction) playClick: (id) sender; <br>  - (void) executeAppleScript: (NSString *) sctript; <br>  <a href="http://habrahabr.ru/users/end/" class="user_link">end</a> </blockquote><br>  In principle, there is nothing secret military in this code.  Just write a class with which we will control iTunes.  * Click functions are handlers for clicking the corresponding buttons on the form.  And executeAppleScript: (NSString *) sctript is a function that will execute the script in the script parameter. <br><br>  And now we click on MainMenu.nib and get into InterfaceBuilder.  Add a new NSObject to the MainMenu.nib window and assign the controller class to it: <br><img src="https://habrastorage.org/getpro/habr/olpictures/f79/c26/925/f79c269254d77d6cc53beccf2d0f6a0c.png" width="450" height="192" hspace="10" vspace="10"><br>  Then we place on the form four buttons labeled ‚Äúnext‚Äù, ‚Äúplay‚Äù, ‚Äúpause‚Äù, ‚Äúprevious‚Äù and connect them with the corresponding.  handlers from the controller class: <br><img src="https://habrastorage.org/getpro/habr/olpictures/1b0/524/218/1b05242185221f30a3111b4568e6c476.png" width="450" height="236" hspace="10" vspace="10"><br>  Save everything and return to Xcode.  In the file controller.m we write the following: <br><blockquote>  - (void) executeAppleScript: (NSString *) script { <br>  <a href="http://habrahabr.ru/users/try/" class="user_link">try</a> { <br>  NSAppleScript * ascript = [[NSAppleScript alloc] initWithSource: script]; <br>  [ascript executeAndReturnError: nil]; <br>  [ascript release]; <br>  } <br>  <a href="http://habrahabr.ru/users/catch/" class="user_link">catch</a> (NSException * e) { <br>  NSLog (@ "exception:% @", e); <br>  } <br>  } <br>  - (void) nextClick: (id) sender { <br>  [self executeAppleScript: @ "tell application \" iTunes \ "\ n next track \ n end tell"]; <br>  } <br>  - (void) prevClick: (id) sender { <br>  [self executeAppleScript: @ "tell application \" iTunes \ "\ n previous track \ n end tell"]; <br>  } <br>  - (void) playClick: (id) sender { <br>  [self executeAppleScript: @ "tell application \" iTunes \ "\ n play \ n end tell"]; <br>  } <br>  - (void) pauseClick: (id) sender { <br>  [self executeAppleScript: @ "tell application \" iTunes \ "\ n pause \ n end tell"]; <br>  } </blockquote><br>  In principle, there is nothing complicated in this code either.  The only interesting thing is the NSAppleScript class, with the help of which object we execute the script.  You can read more about NSAppleScript <a href="http://developer.apple.com/documentation/Cocoa/Reference/Foundation/Classes/NSAppleScript_Class/Reference/Reference.html">here</a> . <br><br>  Basically, I think this is enough to get a general idea of ‚Äã‚ÄãApple Script and add something to it. <br><br>  PS: what else would be interesting to read in terms of creating applications? <br>  PPS: I noticed that my articles are copied on other resources (thank God, at least the link to Habr is left).  I certainly do not mind, but if copy-paste, then please, inform me about it (by email, habraposht or write in kamentah) </div><p>Source: <a href="https://habr.com/ru/post/23312/">https://habr.com/ru/post/23312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../23306/index.html">Saturated API</a></li>
<li><a href="../23308/index.html">Mad BTL by Agent Provocateur - Hard day at the office</a></li>
<li><a href="../23309/index.html">Revealed the mystery of the portal Top4top</a></li>
<li><a href="../23310/index.html">A little continue to memory J3QQ4-H7H2V ...</a></li>
<li><a href="../23311/index.html">Mail service MailPicker.com</a></li>
<li><a href="../23313/index.html">Is there life on Mars? Ugh! Under Linux?</a></li>
<li><a href="../23314/index.html">Apple and Steve Jobs - is it God or the Devil?</a></li>
<li><a href="../23316/index.html">Let's start working on a business plan</a></li>
<li><a href="../23321/index.html">Super gab is coming</a></li>
<li><a href="../23323/index.html">Photoshop - in places of military glory</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>