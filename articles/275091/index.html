<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple pool of objects in Unity3D</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="During the development process, I faced the need to create a pool of objects. After reading this and other articles, I decided to write a simpler pool...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple pool of objects in Unity3D</h1><div class="post__text post__text-html js-mediator-article">  During the development process, I faced the need to create a pool of objects.  After reading <a href="http://habrahabr.ru/post/255499/">this</a> and other articles, I decided to write a simpler pool for my needs with access to the object by line (prefab name). <br><br>  So, let's begin.  The pool consists of four scripts.  The on / off state on an object in a pool is determined by its Unity activeInHierarchy property, so as not to fence additional variables. <br><a name="habracut"></a><br><h4>  1. Pool Object </h4><br>  The Pool Object component must reside on any object used in the pool.  Its main purpose is to return the object back to the pool. <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; [AddComponentMenu("Pool/PoolObject")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> PoolObject : MonoBehaviour { #region Interface <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> ReturnToPool () { gameObject.SetActive (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } #endregion }</code> </pre> <br>  The class has only one method.  In fact, one could do without it, but in this way we separate the objects intended for the pool and not (destroyed in the usual way). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  2. Object Pooling </h4><br>  Go ahead.  The Object Pooling class is the pool itself, which gives free objects on demand and creates new ones when there is a shortage. <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; [AddComponentMenu(<span class="hljs-string"><span class="hljs-string">"Pool/ObjectPooling"</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ObjectPooling</span></span> { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">region</span></span></span><span class="hljs-meta"> Data List&lt;PoolObject&gt; objects; Transform objectsParent; #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endregion</span></span></span></span></code> </pre> <br>  Here objects are all objects contained in the pool, objectsParent is used only as their parent in the hierarchy on the scene (so that there is no sheet of objects). <br><br>  Adding is done using the AddObject method, which takes a sample that needs to be added and a parent in the hierarchy on the scene. <br><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">void</span></span> AddObject(PoolObject sample, <span class="hljs-keyword"><span class="hljs-keyword">Transform</span></span> objects_parent) { GameObject <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span> = GameObject.Instantiate(sample.gameObject); <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.name = sample.name; <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.SetParent (objects_parent); objects.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.GetComponent&lt;PoolObject&gt; ()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.GetComponent&lt;Animator&gt; ()) <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.GetComponent&lt;Animator&gt; ().StartPlayback (); <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.SetActive(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); }</code> </pre><br>  A Gameobject temp is created, a sample name is assigned to it, after which it is added to our List.  The object is then turned off until it is ‚Äúrequired‚Äù outside. <br><br>  Separately about the lines: <br><br><pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.GetComponent&lt;Animator&gt; ()) <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.GetComponent&lt;Animator&gt; ().StartPlayback ();</code> </pre><br>  They were introduced, because  when creating an object without them, the animator did not start (the update did not have time to call).  As a result, when at the start of the scene it was created, for example, 100 bullets and immediately turned off, when 50 bullets were requested, the animator started at all at the same time and the FPS subsidence began (on many objects the animation is constantly playing).  If the project does not involve the use of a large number of objects with animators, this code is not needed. <br><br>  Consider initialization: <br><br><pre> <code class="hljs pgsql"> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Initialize (<span class="hljs-type"><span class="hljs-type">int</span></span> count, PoolObject sample, <span class="hljs-keyword"><span class="hljs-keyword">Transform</span></span> objects_parent) { objects = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;PoolObject&gt; (); // List objectsParent = objects_parent; //      <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;count; i++) { AddObject(sample, objects_parent); //     } }</code> </pre><br>  The second method of this class is GetObject (), which returns a Gameobject: <br><br><pre> <code class="hljs matlab"> public PoolObject GetObject () { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (int <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>&lt;objects.Count; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (objects[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>].gameObject.activeInHierarchy==<span class="hljs-built_in"><span class="hljs-built_in">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> objects[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]; } } AddObject(objects[<span class="hljs-number"><span class="hljs-number">0</span></span>], objectsParent); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> objects[objects.Count<span class="hljs-number"><span class="hljs-number">-1</span></span>]; }</code> </pre><br>  The logic is simple - we pass through the sheet, if any of the objects in the pool is turned off (i.e., free) - we return it, otherwise we add a new one. <br><br><h4>  3. PoolManager </h4><br>  The following PoolManager class manages pools of various objects.  Class static to simplify access to objects, i.e.  no need to create singletons, instances and so on. <br><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PoolManager</span></span></span><span class="hljs-class">{</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> PoolPart[] pools; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> GameObject objectsParent; [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PoolPart</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> name; <span class="hljs-comment"><span class="hljs-comment">//  public PoolObject prefab; // ,   public int count; //     public ObjectPooling ferula; //  }</span></span></code> </pre><br>  All information is stored in the PoolPart structure. <br><br>  Initialization is performed by an array of these structures: (ferula, perhaps not a very good name, but it allows you not to get lost in the pool): <br><br><pre> <code class="hljs pgsql"> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> Initialize(PoolPart[] newPools) { pools = newPools; //  objectsParent = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> GameObject (); objectsParent.name = "Pool"; //    Pool,     <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;pools.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(pools[i].prefab!=<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { pools[i].ferula = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ObjectPooling(); //      pools[i].ferula.Initialize(pools[i].count, pools[i].prefab, objectsParent.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>); //     } } }</code> </pre><br>  The second method of this static class is GetObject, an analogue of the standard Instantiate, but by the name of the object.  It checks all existing pools, and if it finds the correct one, it pulls its GetObject () method from the ObjectPooling class: <br><br><pre> <code class="hljs pgsql"> <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static GameObject GetObject (string <span class="hljs-type"><span class="hljs-type">name</span></span>, Vector3 position, Quaternion rotation) { GameObject result = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pools != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; pools.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (string.Compare (pools [i].name, <span class="hljs-type"><span class="hljs-type">name</span></span>) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { //       result = pools[i].ferula.GetObject ().gameObject; //    result.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.position = position; result.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.rotation = rotation; result.SetActive (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); //    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; //     ,  <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> }</code> </pre><br><h4>  4. PoolSetup </h4><br>  However, you must edit the objects intended for use in the pool, and their number, in the Unity inspector.  To do this, you have to write a wrapper class, the heir of MonoBehaviour, which hangs on objects: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections; [AddComponentMenu("Pool/PoolSetup")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> PoolSetup : MonoBehaviour {//     PoolManager #region Unity scene settings [SerializeField] private PoolManager.PoolPart[] pools; //,            #endregion #region Methods <span class="hljs-type"><span class="hljs-type">void</span></span> OnValidate() { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; pools.Length; i++) { pools[i].name = pools[i].prefab.name; //  ,   } } <span class="hljs-type"><span class="hljs-type">void</span></span> Awake() { Initialize (); } <span class="hljs-type"><span class="hljs-type">void</span></span> Initialize () { PoolManager.Initialize(pools); //   } #endregion }</code> </pre><br>  This class must be one on stage, otherwise one of them will overwrite the pools of the other. <br><br>  <b>Using</b> <br>  Now we can call objects from the pool like this: <br><br><pre> <code class="hljs pgsql">Gameobject bullet = PoolManager.GetObject (bulletPrefab.name, shotPoint.position, myTransform.rotation);</code> </pre><br>  We return: <br><br><pre> <code class="hljs xml">GetComponent<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PoolObject</span></span></span><span class="hljs-tag">&gt;</span></span>().ReturnToPool ();</code> </pre><br>  As a result, the pool works and is fairly simple to use.  A couple of screenshots: <br><br>  Management in the editor: <br><br><img src="https://habrastorage.org/files/835/2bb/8d1/8352bb8d153d48369fd1d803c125105c.png"><br><br>  Spawn bullets and ships: <br><br><img src="https://habrastorage.org/files/695/525/93c/69552593c1db4aac98b120bea127476a.png"><br><br><h4>  Afterword </h4><br>  Of course, this implementation has many drawbacks.  I will list the main ones: <br><br>  1) Access by string can be replaced by access by, for example, an integer key identifier, which would speed up the work; <br>  2) There is no error handling and exceptions (the methods will simply return null), almost no checks; <br>  3) The need for a PoolSetup singleton on stage, although no one refers to it. <br><br>  Update: <a href="https://github.com/alexdebur/UnityNightPool">GitHub repository</a> <br><br><h4>  Full code </h4><br><div class="spoiler">  <b class="spoiler_title">PoolObject</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; [AddComponentMenu("Pool/PoolObject")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> PoolObject : MonoBehaviour { #region Interface <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> ReturnToPool () { gameObject.SetActive (<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } #endregion }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Object pooling</b> <div class="spoiler_text"><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections.Generic; [AddComponentMenu("Pool/ObjectPooling")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ObjectPooling { #region Data List&lt;PoolObject&gt; objects; <span class="hljs-keyword"><span class="hljs-keyword">Transform</span></span> objectsParent; #endregion #region Interface <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Initialize (<span class="hljs-type"><span class="hljs-type">int</span></span> count, PoolObject sample, <span class="hljs-keyword"><span class="hljs-keyword">Transform</span></span> objects_parent) { objects = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> List&lt;PoolObject&gt; (); objectsParent = objects_parent; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;count; i++) { AddObject(sample, objects_parent); } } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> PoolObject GetObject () { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;objects.Count; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (objects[i].gameObject.activeInHierarchy==<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> objects[i]; } } AddObject(objects[<span class="hljs-number"><span class="hljs-number">0</span></span>], objectsParent); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> objects[objects.Count<span class="hljs-number"><span class="hljs-number">-1</span></span>]; } #endregion #region Methods <span class="hljs-type"><span class="hljs-type">void</span></span> AddObject(PoolObject sample, <span class="hljs-keyword"><span class="hljs-keyword">Transform</span></span> objects_parent) { GameObject <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span> = GameObject.Instantiate(sample.gameObject); <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.name = sample.name; <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">transform</span></span>.SetParent (objects_parent); objects.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.GetComponent&lt;PoolObject&gt; ()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.GetComponent&lt;Animator&gt; ()) <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.GetComponent&lt;Animator&gt; ().StartPlayback (); <span class="hljs-keyword"><span class="hljs-keyword">temp</span></span>.SetActive(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); } #endregion }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Poolmanager</b> <div class="spoiler_text"><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">PoolManager</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> PoolPart[] pools; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> GameObject objectsParent; [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> PoolPart { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> name; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> PoolObject prefab; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ObjectPooling ferula; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Initialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">PoolPart[] newPools</span></span></span><span class="hljs-function">)</span></span> { pools = newPools; objectsParent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameObject (); objectsParent.name = <span class="hljs-string"><span class="hljs-string">"Pool"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;pools.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(pools[i].prefab!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>) { pools[i].ferula = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObjectPooling(); pools[i].ferula.Initialize(pools[i].count, pools[i].prefab, objectsParent.transform); } } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> GameObject </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetObject</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> name, Vector3 position, Quaternion rotation</span></span></span><span class="hljs-function">)</span></span> { GameObject result = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pools != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; pools.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Compare (pools [i].name, name) == <span class="hljs-number"><span class="hljs-number">0</span></span>) { result = pools[i].ferula.GetObject ().gameObject; result.transform.position = position; result.transform.rotation = rotation; result.SetActive (<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Poolsetup</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Collections; [AddComponentMenu("Pool/PoolSetup")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> PoolSetup : MonoBehaviour {//     PoolManager #region Unity scene settings [SerializeField] private PoolManager.PoolPart[] pools; #endregion #region Methods <span class="hljs-type"><span class="hljs-type">void</span></span> OnValidate() { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; pools.Length; i++) { pools[i].name = pools[i].prefab.name; } } <span class="hljs-type"><span class="hljs-type">void</span></span> Awake() { Initialize (); } <span class="hljs-type"><span class="hljs-type">void</span></span> Initialize () { PoolManager.Initialize(pools); } #endregion }</code> </pre><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/275091/">https://habr.com/ru/post/275091/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275081/index.html">What's going on in the development of corporate mobile applications</a></li>
<li><a href="../275083/index.html">Building and using Mosquitto MQTT on Intel Edison</a></li>
<li><a href="../275085/index.html">What to choose: PaaS and IaaS</a></li>
<li><a href="../275087/index.html">DevCon Secrets # 2. How the conference grid is formed</a></li>
<li><a href="../275089/index.html">WhatsApp will allow users to check messages using a QR code</a></li>
<li><a href="../275093/index.html">The recently adopted Wi-Fi standard 802.11ah can bring back forgotten security problems.</a></li>
<li><a href="../275095/index.html">User story splitting - hamburger method</a></li>
<li><a href="../275097/index.html">Implementation of the list of used libraries in the Android application. Attempt # 2</a></li>
<li><a href="../275099/index.html">Designing simple applications in Flask</a></li>
<li><a href="../275101/index.html">9 secrets of online payments. Part 1: Configure 3-D Secure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>