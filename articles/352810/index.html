<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mutual transformations of JSON, YAML, XML</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="JSON, YAML are now popular, and XML technologies are considered a relic of the past. 


 Let's try to use "retro technology" to work with data in JSON...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mutual transformations of JSON, YAML, XML</h1><div class="post__text post__text-html js-mediator-article">  JSON, YAML are now popular, and XML technologies are considered a relic of the past. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5j/y1/iu/5jy1iumpoueja_audbs7tose_9a.jpeg"></div><br>  Let's try to use "retro technology" to work with data in JSON and YAML.  And speculate on the reasons for applying them in our days. <br><a name="habracut"></a><br>  There is a task - to transfer the logic of data transformation to the application configuration, preferably in a declarative style and unified for different formats.  The data can be in various textual serialization formats json, yaml, xml, java properties, ini file.  But at the same time, Data Lake is too heavy artillery for this.  Putting data into a document-oriented or object-relational database and trying to perform queries on the data loaded there is also over engineering for the first stage of the ETL transformation. <br><br>  <a href="http://goessner.net/articles/JsonPath/">JsonPath</a> repeats a subset of XPath, but only to JSON format.  And to write a declarative query without programming will not work - there is no equivalent XQuery.  As an option, it would be possible to use some kind of embedded database in jvm with its declarative query language, but this is a topic for a separate publication and the original data model in json, yaml is not relational. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Approach to data requests from JSON / YAML </h2><br>  XQuery can be performed on data in the Document Object Model.  How to convert data from a JSON / YAML to a DOM object ... You can use <a href="http://camel.apache.org/xmljson.html">camel-xmljson</a> or <a href="https://github.com/lukas-krecan/json2xml">json2xml</a> .  In these libraries, the data source is only json.  Therefore, let's rush to our <a href="https://github.com/igor-suhorukov/dom-transformation">dom-transformation</a> bike.  This library is able to accept as input Map &lt;String, Object&gt; and turn it into org.w3c.dom.Node, and there is also an inverse transformation. <br><br>  It remains to learn how to turn JSON and YAML into Map &lt;String, Object&gt;.  For example, this can be done using the com.fasterxml.jackson.databind.ObjectMapper class from <a href="https://github.com/FasterXML/jackson">jackson</a> . <br><br>  Turn JSON into a Map: <br><br><pre><code class="java hljs">ObjectMapper mapper = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObjectMapper(); Map&lt;String, Object&gt; objectTree = mapper.readValue(yaml, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TypeReference&lt;Map&lt;String, Object&gt;&gt;() {});</code> </pre> <br>  Turn YAML into a Map: <br><br><pre> <code class="java hljs">ObjectMapper mapper = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObjectMapper(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> YAMLFactory()); Map&lt;String, Object&gt; objectTree = mapper.readValue(yaml, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TypeReference&lt;Map&lt;String, Object&gt;&gt;() {});</code> </pre><br>  We turn Map into Document Object Model, having connected <a href="">library</a> to the project: <br><br><pre> <code class="java hljs">DomTransformer toDom = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DomTransformer(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TypeAutoDetect()).transform(objectTree.size() == <span class="hljs-number"><span class="hljs-number">1</span></span> ? objectTree : Collections.singletonMap(<span class="hljs-string"><span class="hljs-string">"root"</span></span>, objectTree)); Node document = toDom.translate(objectTree);</code> </pre><br>  You can use any XQuery implementation to execute queries.  I like <a href="http://basex.org/">basex</a> as a still developing open source project.  We connect the dependency <a href="">org.basex: basex: jar: 9.0</a> to the project and execute the declarative query: <br><br><pre> <code class="java hljs">String yaml = IOUtils.toString(TranslateTest.class.getResource(<span class="hljs-string"><span class="hljs-string">"/pipeline.yml"</span></span>).toURI(), StandardCharsets.UTF_8); ObjectMapper mapper = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ObjectMapper(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> YAMLFactory()); Map&lt;String, Object&gt; objectGraph = mapper.readValue(yaml, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TypeReference&lt;Map&lt;String, Object&gt;&gt;() {}); Node document = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DomTransformer(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TypeAutoDetect()).transform( objectGraph.size() == <span class="hljs-number"><span class="hljs-number">1</span></span> ? objectGraph : Collections.singletonMap(<span class="hljs-string"><span class="hljs-string">"root"</span></span>, objectGraph)); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>(QueryProcessor proc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> QueryProcessor(<span class="hljs-string"><span class="hljs-string">"declare variable $extDataset external; "</span></span> + <span class="hljs-string"><span class="hljs-string">" $extDataset//*[text()='git-repo']"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Context())) { proc.bind(<span class="hljs-string"><span class="hljs-string">"extDataset"</span></span>, document); Value queryResult = proc.value(); <span class="hljs-comment"><span class="hljs-comment">// execute the query queryResult.iter().forEach(System.out::println); }</span></span></code> </pre><br>  Work results for data from <a href="">pipeline.yml</a> <br><br><img src="https://habrastorage.org/webt/i4/dy/lv/i4dylvccuvhzjcobkbevj29x9cc.png"><br><br>  If you need to convert DOM / XML to JSON / YAML using jackson, then <a href="">transform (Node currentNode)</a> can help with this. <br><br><h2>  findings </h2><br>  With XQuery, you can query not only XML data.  This query language is still successfully coped with and this ‚Äúold man‚Äù will still live in java data transformation projects even in JSON and YAML formats. <br><br>  Of course, semi-structured data is not only JSON, YAML and XML.  And it's still too early to put an end to the processing of everything ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7-/jc/8s/7-jc8szna_uo2udpxliv-wt4fpu.png"></div><br><br>  I hope that the approach from the publication will help you to perform declarative queries on heterogeneous data in the application.  Or did you encounter a similar task in the JVM and you have better ideas, share in the comments! <br><br><div class="spoiler">  <b class="spoiler_title">On April 26, my colleague and I hold an open java meetup in the Moscow office.</b>  <b class="spoiler_title">We will welcome guests!</b> <div class="spoiler_text">  You can relax after a working day, learn something new, debate, have a snack on pizza and chat with developers. <br><br>  The meeting will be held on April 26, 2018 19: 00-21: 00 at the Moscow office of Aligh Technology at 9, Warsaw Street., P. 4. Register here: <a href="https://align-technology.timepad.ru/event/698367/">Amazon Web Services and JVM for server side projects.</a> <br><br>  The program has three reports. <br><br><h2>  Emulate Amazon web services in the JVM process: accelerating development, testing, and saving money. </h2>  Speaker: <a href="https://github.com/igor-suhorukov">Igor Sukhorukov</a> <br><br>  How to effectively develop Big Data applications on Amazon Web Services infrastructure.  We will try to locally develop a solution was easy, and integration tests worked quickly and as cheaply as possible for us.  We remember the savings, while Amazon‚Äôs CEO Jeff Bezos launches rockets in Blue Origin and walks with the SpotMini robot from Boston Dynamics.  In the report I will tell how it turned out to emulate the S3 filesystem, the Redshift data warehouse, the SQS queues, the PostgreSQL RDS service in the JVM process based on open source projects.  The report will also be a comparison of popular Big Data solutions for BI analytics. <br><br><h2>  Code for production. </h2>  Speaker: <a href="https://github.com/wilem82">Yuri Geinish</a> <br><br>  Simple but not obvious tips for developers on building resilient and diagnosable server applications.  The report will focus on the basic principles, so it may be useful to developers in different programming languages ‚Äã‚Äãand platforms. <br><br><h2>  Meldonium for Groovy: soaring in the "clouds" or diving into the "bloody enterprise" </h2>  Speaker: <a href="https://github.com/igor-suhorukov">Igor Sukhorukov</a> <br><br>  In the "clouds" with Groovy on steroids can be done more and more convenient.  Let's talk about dynamic loading of classes from maven artifacts and how convenient it is to run scripts in Amazon Web Services and Docker containers.  How to survive scripts in an isolated corporate environment.  And of course, let's talk about the topic why Groovy is needed, when there is Kotlin. <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/352810/">https://habr.com/ru/post/352810/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352800/index.html">Release Rust 1.25</a></li>
<li><a href="../352802/index.html">Intel Summer School 0x7E2 - there is a reason to learn</a></li>
<li><a href="../352804/index.html">MobileNet: smaller, faster, more accurate</a></li>
<li><a href="../352806/index.html">Arduino for beginners. Part 1</a></li>
<li><a href="../352808/index.html">As we did backups in the ISPsystem. Part two</a></li>
<li><a href="../352812/index.html">Data Analysis - Basics and Terminology</a></li>
<li><a href="../352814/index.html">Tutorial: toon-contours in Unreal Engine 4</a></li>
<li><a href="../352820/index.html">Avito at GopherCon Russia 2018</a></li>
<li><a href="../352822/index.html">How to expand the functionality of Zabbix and not pay for licenses</a></li>
<li><a href="../352824/index.html">Data Center for Technopark: from ‚ÄúConcrete‚Äù to Tier Facility Certification</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>