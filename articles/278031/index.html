<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Problems of access control based on the access list in ECM systems (part 2)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my debut article, we step by step designed a model for delineating access to the subject area, taking as an example a fictitious ECM system, which ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Problems of access control based on the access list in ECM systems (part 2)</h1><div class="post__text post__text-html js-mediator-article"><img height="150" align="left" src="https://habrastorage.org/files/2ee/675/499/2ee6754999cd4655a3277688b4fa2dcf.jpg">  In my <a href="https://habrahabr.ru/post/277111">debut article,</a> we step by step designed a model for delineating access to the subject area, taking as an example a fictitious <abbr title="Enterprise content management">ECM</abbr> system, which from the simple gradually became not very simple.  We faced problems that could not be easily and simply solved within the framework of the model that we had as a result.  In this article we will try to correct the situation. <br><a name="habracut"></a><br><br><h2>  Let me remind you the list of problems, with the short we are faced </h2><br><ul><li>  Problem 1 - Dependent access lists </li><li>  Problem 2 - Delegation of Authority </li><li>  Problem 3 - Providing access to a large number of objects </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">A small theoretical retreat</b> <div class="spoiler_text">  ‚ÄúThere,‚Äù as well as ‚Äúhere,‚Äù is very fond of inventing bicycles.  But "there" for those who like to reinvent the wheel are those who like to count money.  Therefore, instead of inventing bicycles "there", they do classification and standardization. <br>  With regard to access control, various access control models are classified according to two ‚Äúparallel classifications‚Äù. <br><ul><li>  By who controls access to objects </li><li>  Based on what controls access to objects </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  According to the first classification, the model can be called </h3><br>  <b>MAC (Mandatory Access Control)</b> - if access to objects is configured by the administrator declaratively, but not by the end user of the system. <br>  <b>DAC (Discretionary Access Control)</b> - in that case, if the user himself sets up access to the objects (to those objects of which he is the ‚Äúowner‚Äù) <br><br><h3>  According to the second classification, the model can be called </h3><br>  <b>Multilevel</b> - if the access is configured in relation to a certain ‚Äúaccess level‚Äù, and the objects are already marked with some sign that determines the necessary access level for working with this object. <br>  <b>Access Matrix</b> - if the access is configured directly between the object and the security subject.  A particular case of this model is the subject of our suffering, i.e.  access model based on Access Control List (access list).  And there is another special case - the access model based on Capabilities.  They differ in that the ACL is a list of those who have rights in relation to a single object, and Capabilities (or C-List) is a list of objects with access rights to them in relation to some security subject.  <a href="http://slideplayer.com/slide/5738389/">comparison 1 (eng)</a> , <a href="http://www.eros-os.org/essays/ACLSvCaps.html">comparison 2 (eng)</a> <br>  <b>Role-Based Access Control (RBAC)</b> - if the access is configured in relation to user roles, combining the ability to perform various functions of the system with the rights to security objects.  There is a <a href="http://csrc.nist.gov/groups/SNS/rbac/">standard for</a> this model. <br>  <b>Attribute-Based Access Control (ABAC)</b> - if the access is configured in relation to ... no, not to the attributes of the objects.  And in relation to objects with some kind of sign.  A typical example of access control on the basis of ABAC: the manager Petrov automatically gets access to any contracts, but only if their Amount is less than 100k. <br><br>  Against the background of all this, a term such as <b>Access Control Session</b> , which periodically smears RBAC, ABAC, and which, <i>in its free interpretation,</i> means that the security subject <b>may</b> have several privileges, but to perform a specific operation, is still hanging out. only <b>one</b> set is allowed, for which this operation is performed as part of a security session with which it is set and associated. <br><br>  Now let's see what kind of security models are used for our simple ECM system involved in (reminding) the organization‚Äôs workflow (well, you already understand that they will not be there alone). <br><br>  So: <br><ul><li>  The user can customize access to documents, especially if he creates them.  Therefore, our access model clearly refers to the <b>DAC.</b> </li><li>  The administrator declaratively configures access to documents (recall the default access list), because the user MUST NOT set up access by himself in 99% of use cases (I wrote about this in the <a href="https://habrahabr.ru/post/277111">first</a> article).  Therefore, our access model clearly applies to <b>MAC</b> </li><li>  Access is configured based on the access list, so our model refers to the Access Matrix, in particular to the <b>Access Control List</b> </li><li>  Such attributes of documents as the ‚Äúaccess stamp‚Äù, ‚Äúconfidentiality‚Äù, which also affect access, climb from the subject area - as a result, our model will also apply to <b>Multilevel</b> .  And the distribution of access through the ObjectKind classifying attribute from the first article is of the same type. </li><li>  And of course, the role.  Where do without them and where are they not?  And there will be in our system too and therefore the security model will also apply to <b>RBAC</b> </li><li>  And do not forget about the delegation of authority.  Because this script requires consideration in our model and <b>Access Control Session</b> </li></ul><br><br>  In general, the hodgepodge. <br>  From all this, I have only two thoughts: <br><ul><li>  The architect <b>simply has to</b> do everything to minimize the number of access control patterns that the specific system model will support. </li><li>  How can I not write bikes, I personally do not understand ... </li></ul><br><br></div></div><br><br><h3>  Basic layout </h3><br>  To correctly solve our above mentioned problems, let us go back a little, to the very first picture <br><img src="https://habrastorage.org/files/dfa/c04/c3c/dfac04c3cebb481b8686486e1d7a610c.JPG"><br>  The current schema contains an access list for each domain object. <br>  From the theoretical part, we have already understood approximately what patterns of access control should be supported by our security model. <br>  Therefore, we will increase the degree of abstraction.  In an ACL, we will not specify a list of security subjects with their rights, but a <b>list of access models</b> applicable to this object.  In this case, the primacy of the ACL model over all others will be supported by the observance of the axiom - <i>we must always be able to access the object calculated solely on the basis of its ACL</i> . <br><br>  So, we change the scheme as follows. <br><img src="https://habrastorage.org/files/c05/6ef/05d/c056ef05dba24950be77f73cbfb166e5.JPG"><br>  <font color="#A4A4A4">Hereinafter is the class schema, not the database schema.</font>  <font color="#A4A4A4">We will deal with the issues of mapping class classes on the database later ( <i>in the next article</i> ).</font>  <font color="#A4A4A4">White closed arrow is inheritance.</font>  <font color="#A4A4A4">An open arrow is an association.</font> <br><br>  As you already understood, the list of access to documents has degenerated into a hierarchical list of supported by the <b>SecurityAspect</b> object ‚Äî abstract access granting mechanisms.  <b>SecurityAspect</b> implemented by us using the <a href="https://en.wikipedia.org/wiki/Composite_pattern">Composite</a> pattern. <br><br>  <font color="#A4A4A4">Please note that I did not specify an intermediate entity for the Composite pattern for many-to-many connections between SecurityAspectComposite and SecurityAspect.</font>  <font color="#A4A4A4">In other cases (not related to the Composite pattern) I will indicate such intermediate entities.</font> <br><br>  I also draw attention to the fact that <b>SecurityAspect</b> does not refer to <b>Object</b> .  On the contrary, <b>Object</b> contains a reference to the root SecurityAspect, which will (along with its hierarchy) determine access to this object. <br><br>  In the future, the root SecurityAspect object (along with its hierarchy) I will call <b>ACL</b> in the old manner. <br><br><h3>  Users </h3><br>  From the theoretical part (and from our requirements set forth in <i>Problem 2</i> ), we realized that a system user may have several sets of privileges, and only one set should be active at a time. <br><br>  <font color="#A4A4A4">A simple example is if a system user can work on his own behalf, on behalf of a boss and on behalf of a very large boss (typical secretary‚Äôs work scenario) - the business logic of the system will quickly come up kirdyk, if at any given moment it is not clear on behalf of whom the user is doing other action in the system.</font> <br><br>  Reflect all this on the diagram. <br><img src="https://habrastorage.org/files/2b9/7c0/fff/2b97c0fffb14447885b66ec5744652bf.JPG"><br>  As we see, each user can have a set of associated <b>Principal</b> , which can form hierarchies (also with the help of the <a href="https://en.wikipedia.org/wiki/Composite_pattern">Composite</a> pattern).  For clarity, we have introduced specific implementations - Principal for org.  organizational structures. <br>  In addition, <b>Session</b> is also present on the diagram, which, in addition to the reference to the user, also refers to the Principal on whose behalf the user <b>is currently</b> working. <br>  Access in the future we will provide <b>not to users</b> , but <b>Principal</b> 's.  This makes it easy to implement <i>replacement scenarios (problem 2)</i> . <br><br><h3>  Direct access to objects </h3><br>  Now let's cross these two schemes and implement direct access to the objects through <b>Principal‚Äôs</b> . <br><img src="https://habrastorage.org/files/68b/de4/0d5/68bde40d5a894a28bc210683af472211.JPG"><br>  We have created a descendant of our SecurityAspect with the name <b>DirectAccess</b> , which has both a list of rights in relation to the object, and a link to the <b>Principal</b> , for which these rights are actually available. <br>  Note that, unlike the data model in the <a href="https://habrahabr.ru/post/277111">previous article</a> , the rights in this model are not attributes, but are separated into a separate <b>Right</b> entity that is associated with DirectAccess through <b>DirectAccessRights</b> .  This will allow us to expand this set of rights in the future without serious consequences. <br><br><h3>  Roles </h3><br>  As I promised earlier, there will be roles in our system too.  We realize <br><img src="https://habrastorage.org/files/f37/306/0f5/f373060f52d54955982c120fa8889a67.jpg"><br>  As we can see, a new SecurityAspect has been created with the name <b>Role</b> , which can combine hierarchically other SecurityAspect's (as inherited from <b>SecurityAspectComposite</b> ). <br>  Since roles are most often used for declarative assignment of rights and will not be indicated in the ACL of objects (although our model does not prohibit this), we need to ensure communication between roles and principals.  We do this with <b>PrincipalSecurityAspects</b> . <br><br>  In more detail about the use of roles: <br><ul><li>  They can be used both to provide access to <i>system functions</i> and to provide access to <i>system objects.</i> </li><li>  <i>In the first case,</i> in our model, the necessary roles will be simply created with the necessary set of rights, not equal to those rights that will be used to access the objects, and these roles will be assigned to Pricipal in PrincipalSecurityAspects </li><li>  <i>In the second case,</i> in our model, the roles will also be entered, the PrincipalSecurityAspects will also be assigned to the Principal and, in <b>addition</b> , in the ACL of those objects for which these roles are applicable.  The set of rights used in roles in this case can be equal to that used in DirectAccess </li></ul><br><br>  The most important: <br><ul><li>  In the classic <b>RBAC,</b> in the essence of <b>Role there</b> should be a connection between it and <b>Object</b> through <b>RoleRights</b> </li><li>  Since we do not have RBAC, but <b>ACL dominates</b> - this connection is absent and therefore, if necessary, provide access to objects through roles - they must be registered in the <b>ACL of the corresponding objects</b> </li></ul><br><br><h3>  Default access </h3><br>  Let's implement the <b>Multilevel</b> security model, i.e.  distribution of rights on the basis of any feature of the object.  Let it be <b>ObjectKind</b> . <br><img src="https://habrastorage.org/files/fe6/314/41d/fe631441d45a4ead99e4ed7c528fdaaa.jpg"><br>  As you can see, ObjectKind has started to have objects that have a classification feature and a new successor from SecurityAspectLeaf (which hints that it cannot contain a hierarchy of other SecurityAspect) has appeared with the name <b>ObjectKindAccess</b> .  The connection between it and the Principal is also provided as in the case of Role through <b>PrincipalSecurityAspect</b> . <br><br>  The most important: <br><ul><li>  In the classic <b>Multilevel, the</b> Object entity must be marked with a classifying attribute to distribute rights to it, and that‚Äôs <u>all</u> </li><li>  Since the <b>ACL is primary</b> for us, for those objects for which the Multilevel model must work, the corresponding SecurityAspect must be registered in the ACL </li></ul><br><br><h3>  Dependent access lists </h3><br>  And finally, we still have <i>problem 1 with dependent access lists</i> . <br>  Let me remind you that the objects, each with its own access list, participating in one business process, should often be available to all participants in this process.  Those.  if a user has access to object A, then he must also have access to object B (usually with a limited set of rights). <br><br>  We realize <br><img src="https://habrastorage.org/files/98f/833/f51/98f833f512bf4ed09e06b1f0af19d6f9.jpg"><br>  As usual, we created a new successor from SecurityAspectComposite named <b>LinkedAccess</b> . <br><br>  The trick is that this SecurityAspect will <i>‚Äúwrap‚Äù the</i> root SecurityAspect of the <b>associated object</b> , thus giving access to all those who have access to it, and to the current object.  The rights defined on LinkedAccess through <b>LinkedAccessRights</b> will either <u>restrict</u> the rights of having access to the associated object, or <u>expand</u> their set of rights (depending on the requirements of the business logic). <br><br><h3>  What's next </h3><br>  In the next article we will deal with <b>mapping of all this on the database,</b> given the mandatory requirement of the <a href="https://habrahabr.ru/post/277111">first article.</a> <br>  <i>‚ÄúThe architectural solutions behind the solution of the above problems should definitely not affect the filtering speed of objects during searches and should have minimal impact on the speed of performing operations on objects and on lists of objects (including large ones).‚Äù</i> <br><br><h3>  What to read </h3><br>  <a href="http://ceur-ws.org/Vol-180/paper05.pdf">Design Patterns for Role-Based Access Control</a> <br>  <a href="http://secpat.de/fileadmin/user_upload/Publikationen/Trustbus_114.pdf">Patterns and Pattern Diagrams for Access Control</a> <br>  <a href="https://core.ac.uk/download/files/370/11536459.pdf">Patterns for Session-Based Access Control</a> </div><p>Source: <a href="https://habr.com/ru/post/278031/">https://habr.com/ru/post/278031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278017/index.html">Node.js. Design and development patterns</a></li>
<li><a href="../278019/index.html">Table as parameter in postgresql</a></li>
<li><a href="../278021/index.html">DevTips: Web Developer Tips (49-64)</a></li>
<li><a href="../278023/index.html">Experiment: the creation of an algorithm for predicting the behavior of stock indices</a></li>
<li><a href="../278025/index.html">Security Week 08: Mice theft through a whistle, Blockbuster operation, Linux Mint with backdoor</a></li>
<li><a href="../278033/index.html">TOM.js is a special library for special cases.</a></li>
<li><a href="../278037/index.html">Handlersocket protocol in detail</a></li>
<li><a href="../278039/index.html">Again about STL</a></li>
<li><a href="../278041/index.html">Personalize IMGUI and Unity Editor. Part one</a></li>
<li><a href="../278043/index.html">The story of the endless city. On Three.js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>