<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Machine search for anomalies in the behavior of online stores and buyers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago we connected a machine learning module to a system that protects payments and transfers in Yandex.Money from fraud. Now she understands ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Machine search for anomalies in the behavior of online stores and buyers</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/web/ceb/315/899/ceb315899c344023b98115f504db2203.png" alt="image alt text"></p><br><p>  Some time ago we connected a machine learning module to a system that protects payments and transfers in Yandex.Money from fraud.  Now she understands when something suspicious happens, even without explicit instructions in the settings. </p><br><p>  In the article I will talk about the techniques and difficulties of finding anomalies in the behavior of customers and stores, as well as how to use machine learning models to make it all take off. <a name="habracut"></a></p><br><h1 id="zachem-platezham-esche-odna-proverka">  Why payments another check </h1><br><p>  Regardless of the type of authorization, any payment operation through Yandex.Money is tested by the antifraud system.  This procedure allows you to protect all participants in the transaction: </p><br><ol><li><p>  the buyer - from direct losses due to the actions of fraudsters; </p><br></li><li><p>  the seller and his acquiring bank - from making unauthorized payment, after which the funds will have to be returned; </p><br></li><li>  Yandex.Money - from fines and user dissatisfaction. <br><img src="https://habrastorage.org/files/57f/2c1/06a/57f2c106a25947db9fdd0fdf45c4ef21.jpg" alt="image alt text"></li></ol><br><p>  <em>The general scheme of the payment process for the online store.</em> </p><br><p>  Antifraud is installed in the core of the Yandex.Money payment infrastructure, and any payment or transfer transactions come to the test for verification.  If there are any suspicions, the anti-fraud may recommend additional authentication or mark the risk as high. <br><img src="https://habrastorage.org/files/6d7/00b/c0e/6d700bc0e0f842cdb6b3b6890b4981ad.jpg" alt="image alt text"></p><br><p>  Initially, antifraud worked only on the basis of static rules (a transaction with some parameters is good, and with others it is bad), but static rules alone do not allow maintaining a consistently low level of false positives.  They are difficult to take into account, for example, sudden sales surges or organic changes in user behavior.  That is why a machine learning module was connected to the antifogue, which works in conjunction with static rules for more accurate risk assessment. </p><br><h1 id="kak-roboty-prinimayut-resheniya">  How robots make decisions </h1><br><p>  To work with machine learning methods, Yandex.Money uses one of the popular analysis systems in which machine learning models are built - let's call it ML.  Let us take an example of how it all works. </p><br><p>  In principle, the process is divided into two phases: </p><br><ol><li><p>  Training.  During the training, the model parameters and significant features are identified; </p><br></li><li>  Application of the results, that is, the classification of new operations.  In this phase, the class to which each new transaction belongs is determined - risky, fraudulent or secure. </li></ol><br><p>  When working out static rules, the anti-fraud algorithm sends a request with certain transaction attributes to the machine learning module for classification.  The machine learning model analyzes them and gives a verdict with the likelihood that the fraudster is conducting the operation.  Here the most subtle point is to select and form such attributes, but more on that later. </p><br><p><img src="https://habrastorage.org/files/af1/bba/91a/af1bba91aca74cf8afd4336d524a71ae.jpg" alt="image alt text"></p><br><p>  <em>This is a diagram of the machine learning process in ML.</em> </p><br><p>  Let‚Äôs say, on behalf of Innocent‚Äôs user, a game currency is purchased for World of Tanks on Friday evening: </p><br><ul><li><p>  transaction amount - 15,000 rubles; </p><br></li><li><p>  purchases are made from Australia; </p><br></li><li><p>  the user works with the Safari browser on MacOS; </p><br></li><li><p>  on the clock 15:23; </p><br></li><li>  another ten attributes. </li></ul><br><p>  Separately, these attributes do not cause any suspicion, because no one bothers Russians to travel and play games, as well as to use systems other than Windows. </p><br><p>  But we have already met with Innocent before and we know that in the past months he bought mostly small household appliances and clothes in Russia with an average check of 7,000 rubles.  Only this morning, he replenished the travel card in Moscow, so there should be no fundamental changes in his behavior. </p><br><p>  Of course, some conclusions can be drawn already on the basis of a simple comparison of attributes from two neighboring operations.  It is unlikely that our hero invented a way to get from Moscow to Australia faster than an airplane.  Such a significant difference in geography in itself attracts attention. </p><br><p>  But a simple comparison with a neighboring transaction in the case of amounts will already be ineffective.  In principle, nothing prevents you from purchasing something larger after purchasing a travel card.  And here the following approach is applied.  Based on the available history data, a forecast is generated for each of the attributes of a new transaction with an indication of the range of possible values.  If several attributes suddenly go beyond these boundaries, there is an anomaly that needs to be closely considered. </p><br><p>  In addition, sometimes not specific values ‚Äã‚Äãof any attributes are interesting, but some quality characteristics based on them.  Therefore, in addition to using the data already in the transaction, the system can generate additional attributes of the operation.  For example, such an attribute may be a sign ‚ÄúAmount greater than N rubles‚Äù instead of just a numeric value of the amount, or the difference between the actual value of some basic attribute and its prediction - this issue will be discussed in more detail later. </p><br><blockquote>  The result of the work of machine learning is not necessarily decisive - in the rules of antifraud there are many static criteria by which a decision is made.  However, the results of this additional test can significantly improve the accuracy of fraud detection. </blockquote><p>  If in many ways the reality is <strong>too</strong> different from the forecast, this is a reason for suspicion and, for example, additional verification. </p><br><h1 id="oblast-poiska-anomaliy">  Anomaly search area </h1><br><p>  When buying from an online store, the greatest risk, as a rule, is assumed by the store, which in case of problems will have to work with protest and returns.  Therefore, the most attention is paid to the search for anomalies in user behavior in antifraud systems. </p><br><p>  But the behavior of the store can also be abnormal, which, like ordinary users, can also become the object of a scam attack or go to the side of evil.  Therefore, it is important to detect in time when something is wrong with the store.  You can notice such changes with the help of the same change in the nature of operations and the attributes associated with them. </p><br><h1 id="slozhnosti-analiza">  Complexity of the analysis </h1><br><p>  From a set of known operation data, a set of attributes is compiled, which is useless without understanding which values ‚Äã‚Äãare ‚Äúgood‚Äù and which are ‚Äúbad.‚Äù  That is, it is necessary to draw a line, at the exit of which the parameters of the operation will become suspicious for the antifraud system - these will be abnormal values ‚Äã‚Äãfor each attribute (in some cases, their combinations).  This is where one of the biggest difficulties lies. </p><br><p>  To build a confidence interval for the values ‚Äã‚Äãof a bona fide transaction, you need to extrapolate data from the history of a particular user or store.  The anomaly will be visible if we compare the current value of the parameters of the operation with the boundaries of the interval.  Sometimes you need to compare not absolute, but normalized values.  Yandex.Money analysts deal with such issues during the preparation and training of models. </p><br><p>  In the learning process, the following methods are used: </p><br><ul><li><p>  <strong>probabilistic</strong> - building all sorts of distributions for class objects; </p><br></li><li><p>  <strong>metric</strong> - calculation of distances between objects; </p><br></li><li>  <strong>Correlation</strong> - determination of quantitative relationships between several parameters of the system under study. </li></ul><br><p>  In addition, basic attributes such as the product group and the amount of the order is not enough to find patterns.  Therefore, from the available data, analysts form additional complex attributes. </p><br><p>  Any anomaly is an event out of the general range.  It may seem that it is sufficient to simply rationalize data from the history of operations (discarding too low and too high values) in order to get an approximate spread of "good" transactions.  But this does not work, as there are daily sales surges, promotions, sales. </p><br><p>  Therefore, Yandex.Money uses, for example, the following algorithm for detecting anomalous attribute values: </p><br><ol><li><p>  extrapolation of time series values ‚Äã‚Äãfor each of the signs; </p><br></li><li><p>  calculation of the difference between the actual value of the feature and the predicted machine; </p><br></li><li>  if the difference is too large and such anomalous events are united by something in common (IP, BIN card, browser) - most likely, the matter is unclean with a specific transaction. </li></ol><br><p><img src="https://habrastorage.org/files/99f/3bb/329/99f3bb32918942d18359868f4dc90469.jpg" alt="image alt text"><br>  <em>The graph shows the dependence of the event anomaly on a linear combination of signs.</em>  <em>Anomaly is determined by the distance between events.</em> </p><br><p>  In order not to block the majority of normal payments, it is necessary to choose the right response threshold for a new sign of the anomaly, that is, a deviation from the normal picture, which we will consider essential and at which we will be ready to take action.  There is no universal advice on choosing a specific value, because this threshold can be considered the price of a mistake for a business.  For someone, a completely normal price will be the rejection of ten good transactions per day, and someone is not ready to lose even one. </p><br><p>  The good news is that for each machine learning model you can set your threshold. </p><br><h1 id="vo-vseh-etih-tehnologiyah-i-slozhnoy-matematike-vazhno-pomnit-o-polzovatele">  In all these technologies and complex math it is important to remember the user. </h1><br><p>  Users tend to be sympathetic to the inconvenience when it comes to the extra security of their money.  For example, the outdated one-time codes on a scratch card can hardly be called convenient, but many users calmly refer to this small evil in exchange for protection from the great evil ‚Äî fraudulent transactions on its own behalf.  It is important to maintain a balance of convenience / speed and reliability, avoiding kinks. </p><br><p>  For any modifications in the Yandex.Money "brains", we are especially careful to monitor the change in the processing time of each operation.  Even an ideal defense will not find understanding with the user if he has to wait for confirmation for several minutes.  Now transactions are executed almost instantly, given the work of the antifraud in real time. </p><br><p> The anti-fraud system has always influenced online payment, evaluating each transaction according to static rules.  It is of utmost importance to us that adding risk assessment using machine learning does not increase processing time.  It was for this purpose that a mechanism was developed which made it possible to carry out the classification by ML methods simultaneously with static rules. </p><br><p>  But here we are faced with a new complexity - sometimes static rules and machine learning can give different answers, and from them you will need to choose the most suitable in a particular situation.  For these purposes, a special module was developed that makes the final decision. </p><br><p><img src="https://habrastorage.org/files/ccb/352/b95/ccb352b9513e49cc800de06fef2bfd35.jpg" alt="image alt text"></p><br><p>  <em>Antifraud connection scheme, in which the test is performed in real time for all operations.</em> </p><br><p>  The results of each test under the new scheme are: </p><br><ul><li><p>  synchronous response to the payment component of the system of rules and machine learning models; </p><br></li><li>  sending a scoring score and transaction data to a historical information base for use in verifying future operations. </li></ul><br><p>  Now the antifraud system has the opportunity to further evaluate the danger of a transaction based on statistics, and not to press the "red button" only if it coincides with static rules.  For the user, this means an additional level of protection and a more flexible reaction of the system, even in cases where the purchase is knocked out by its attributes from the general mass. </p><br><p>  Machine learning technologies involve working with vast amounts of data to make accurate predictions, so their point-of-implementation cannot be called a simple task.  In our case, there was an ideal candidate ‚Äî an antifraud, for whom an additional level of intelligence is crucial, and the volume of data passing through opens up wide possibilities for analysis. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/321490/">https://habr.com/ru/post/321490/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321480/index.html">Looking for anonymous email</a></li>
<li><a href="../321482/index.html">The book "Software Engineering. Textbook for universities. 5th edition updated and enlarged ¬ª</a></li>
<li><a href="../321484/index.html">Protection of intellectual property in the PRC</a></li>
<li><a href="../321486/index.html">To myself a tunnel broker or native IPv6 on a computer using OpenVPN</a></li>
<li><a href="../321488/index.html">Analysis of the effectiveness of the factorization method on elliptic curves. Practice</a></li>
<li><a href="../321492/index.html">New formula for role-playing games</a></li>
<li><a href="../321494/index.html">Cognitive Services & LUIS: An Introduction to Natural Language Recognition</a></li>
<li><a href="../321498/index.html">How to "pump" the designer: tips and useful links from Russian experts</a></li>
<li><a href="../321500/index.html">In preparation for an IPO, Snapchat protects its code and reputation from Facebook's ‚Äúharassment‚Äù</a></li>
<li><a href="../321502/index.html">How to run the background process in Asp.net</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>