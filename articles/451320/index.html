<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why open firmware is important for safety</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I recently gave a lecture on this topic at GoTo Chicago and thought it would be nice to write an article with conclusions. This post is about why open...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why open firmware is important for safety</h1><div class="post__text post__text-html js-mediator-article">  I recently gave a lecture on this topic at GoTo Chicago and thought it would be nice to write an article with conclusions.  This post is about why open source firmware is important to security. <br><br><h2>  Privilege levels </h2><br>  In a typical stack, you have different levels of privileges. <br><br><ul><li>  <b>Ring 3. Applications:</b> minimal privileges, with the exception of the sandbox in user space, which is even more limited. <br></li><li>  <b>Ring 0. Kernel: the</b> kernel of the operating system, in the case of an open source operating system, you see its code. <br></li><li>  <b>Ring ‚àí1.</b>  <b>Hypervisor:</b> monitoring virtual machines (VMM), creates and starts virtual machines.  In open source hypervisors such as Xen, KVM, bhyve and others, you see the code. <br></li><li>  <b>Ring ‚àí2.</b>  <b>System Management Mode (SMM), UEFI Core:</b> proprietary code, more on this below. <br></li><li>  <b>Ring ‚àí3.</b>  <b>Control engine:</b> proprietary code, more on this below. </li></ul><br>  Negative rings indicate levels with privileges greater than zero. <br><a name="habracut"></a><br>  From the foregoing it is clear that in the rings from ‚àí1 to 3 we have the opportunity to use open source software, to largely see and control it.  For levels below the ‚àí1 ring, we have less control, but the situation is improving thanks to the development of open source firmware and the community. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>This is a controversial situation: the most closed code has the most privileges in our system.</b>  <b>This paradox should fix open source firmware.</b> <br><br><h4>  Ring ‚àí2.  SMM, UEFI core </h4><br>  This ring controls all CPU resources. <br><br>  <b>System Management Mode (SMM) is</b> invisible to the rest of the stack on top of it.  He has half the core.  Originally used for power management and hardware system management.  It contains a lot of proprietary code and is where vendors add new proprietary functions.  It handles system events, such as memory or chipset errors, as well as a bunch of other logic. <br><br>  <b>The core of UEFI is</b> extremely complex, with millions of lines of code.  UEFI applications are active after download.  The kernel was developed on the principle of "security through obscurity."  <a href="https://uefi.org/specifications">The specification is</a> absolutely insane if you want to rummage. <br><br><h4>  Ring ‚àí3.  Control engine </h4><br>  The most privileged ring.  In the case of Intel (x86), this is the Intel Management Engine.  This system can silently turn on nodes and overwrite disks, the kernel starts <a href="https://itsfoss.com/fact-intel-minix-case/">Minix 3</a> , as well as the web server and the entire network stack.  It turns out that thanks to this Minix is ‚Äã‚Äãthe most popular operating system on desktops.  In the engine control a lot of functions.  It will probably take me a whole day to list them.  If you want, there are <a href="https://www.intel.com/content/www/us/en/support/articles/000008927/software/chipset-software.html">many</a> <a href="https://files.bitkeks.eu/docs/intelme-report.pdf">resources</a> for more detailed study. <br><br>  Between the ring ‚àí2 and the ring ‚àí3 in our stack are at least two and a half other cores, as well as a bunch of proprietary and unnecessary complexity.  Each of these cores has its own network stacks and web servers.  The code can change itself, remaining after power off and reinstallations.  <b>We have very little information about what the code in these rings actually does, which is terrible, given that these rings have the most privileges.</b> <br><br><h4>  They all have exploits. </h4><br>  It should not surprise anyone that there are vulnerabilities in the ‚àí2 and ‚àí3 rings.  When they are found, it is really terrible.  Just for example, although you can search for other examples on your own, there <a href="https://www.wired.com/2017/05/hack-brief-intel-fixes-critical-bug-lingered-7-dang-years/">was a bug in the Intel Management Engine web server, which the developer has not known for seven years</a> . <br><br><h2>  How can you improve the situation? </h2><br><h4>  NERF: non-expandable reduced firmware </h4><br>  NERF is what the community is working on.  The goal is to make the firmware less likely to cause harm and make its actions more visible.  They seek to remove all the components of the runtime environment, but for now the Intel Management Engine is hard to do.  But you can remove the web server and IP stack from there.  Developers also want to remove the UEFI IP stack, other drivers and remove the Intel Management / UEFI self-firmware feature. <br><br><h4>  me_cleaner </h4><br>  A project to clean the Intel Management Engine to the minimum necessary functionality ( <a href="https://github.com/corna/me_cleaner">on GitHub</a> ). <br><br><h4>  u-boot and coreboot </h4><br>  <a href="https://www.chromium.org/developers/u-boot">u-boot</a> and <a href="https://www.coreboot.org/">coreboot</a> are open source firmware.  They handle chip initialization and DRAM.  Chromebooks use both, coreboot on x86, and u-boot on the rest.  This is one of the steps they <a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/42038.pdf">check for downloads</a> . <br><br>  The coreboot design philosophy is to <a href="https://doc.coreboot.org/">"make the minimum necessary to use the equipment, and then transfer control to another program called the <i>payload</i></a> . <a href="https://doc.coreboot.org/">"</a>  In this case, it is linuxboot. <br><br><h4>  linuxboot </h4><br>  <a href="https://www.linuxboot.org/">Linuxboot</a> handles device drivers, network stack and provides multi-user multitasking environment.  It is built on Linux, so one core can run on multiple boards.  Linux is already sufficiently tested and many people are watching the code, since it is quite widely used.  It is better to use an open core with a larger number of ‚Äúcontrollers‚Äù than two and a half other cores, different and closed.  This means that we reduce the attack surface due to fewer code variants and rely on open source.  Linux improves boot reliability by replacing poorly tested firmware drivers with Linux drivers with enhanced protection. <br><br>  Using the kernel, we already have the tools for the firmware: developers can use familiar tools when they need to write logic to verify the signature, encrypt the disk, and so on.  All this in a modern, proven, supported and easily readable language. <br><br><h4>  u-root </h4><br>  <a href="https://github.com/u-root/u-root">u-root</a> is the golang userspace toolkit and bootloader.  It is used as the initramfs for the linux kernel in linuxboot. <br><br>  It is said that the NERF stack reduced the load time by 20 times.  But this is a security article, so let's get back to security ... <br><br>  The NERF stack improves the visibility of many components that were previously entirely proprietary.  However, devices still have many other firmware. <br><br><h2>  What about other firmware? </h2><br>  We need open source firmware for the network interface controller (NIC), solid state drives (SSD) and basic control controller (BMC). <br><br>  In the Open Compute project, there is some work being done on the <a href="https://www.opencompute.org/documents/ocp-nic-3-0-draft-0v85b-20181213b-tn-temp-no-cb-pdf">NIC 3.0</a> firmware.  It will be interesting to see what they will do. <br><br>  For BMC, there are both <a href="https://github.com/openbmc/openbmc">OpenBMC</a> and <a href="https://github.com/u-root/u-bmc">u-bmc</a> .  I wrote a little about them in the <a href="https://blog.jessfraz.com/post/the-firmware-rabbit-hole/">previous article</a> . <br><br>  We need to have all the open source firmware to provide full visibility on the stack and actually check the status of the software on the machine. <br><br><h2>  Trust roots </h2><br>  The purpose of the trust root is to verify that the appropriate software is installed in each piece of hardware.  You can be guaranteed to make sure that the equipment is not hacked.  Since we now have a lot of closed code in many areas of equipment, this is difficult to do.  How to really find out that there are no vulnerabilities or backdoors in the component firmware?  No  Another thing with open source. <br><br>  It seems that each cloud and each vendor offer their own root of trust.  Microsoft has <a href="https://github.com/opencomputeproject/Project_Olympus/tree/master/Project_Cerberus">Cerberus</a> , Google has <a href="https://cloud.google.com/blog/products/gcp/titan-in-depth-security-in-plaintext">Titan</a> , and Amazon has <a href="https://perspectives.mvdirona.com/2019/02/aws-nitro-system/">Nitro</a> .  It seems that they imply a clear confidence in the proprietary code (code that we do not see).  This leaves a strange sensation.  <b>Wouldn't it have been better to use fully open source?</b>  <b>Then we can check without a doubt that the code collected from the source is the same one that works on the equipment wherever the firmware is installed.</b>  <b>Then we can verify that the machine is in the correct condition, without a doubt that it is vulnerable or with a backdoor.</b> <br><br>  It makes you wonder what small cloud providers, such as DigitalOcean or Packet, use as a root of trust.  I asked about it on Twitter, but did not get a decent answer ... <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1126131424095100929"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  There is a big lecture by <a href="https://twitter.com/PaulM">Paul McMillan</a> and Matt King <a href="https://www.youtube.com/watch%3Fv%3DPEVVRkd-wPM">about the safety of equipment when scaling</a> .  The authors describe in detail how to protect the hardware, while at the same time giving customers access to it.  When they get the equipment back from customers, they need to consistently and reliably make sure that everything remains unchanged and no surprises are hidden in any component. <br><br>  All cloud providers must ensure that the equipment is not compromised after the client has performed calculations on it. <br><br><h2>  Fault tolerance platform firmware </h2><br>  However, chip manufacturers seem to have a special look.  Intel has the resiliency technology <a href="https://www.intel.com/content/dam/www/public/us/en/documents/solution-briefs/firmware-resilience-blocks-solution-brief.pdf">Platform Firmware Resilience</a> , and Lattice has <a href="http://www.latticesemi.com/en/Solutions/Solutions/SolutionsDetails02/PFR">Platform Firmware Resiliency</a> .  They seem to be more focused on the NIST guidelines for the <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-193.pdf">resiliency of the platform firmware</a> . <br><br>  I tried to ask on the Internet who used it, but received little feedback, so if you use devices with Platform Firmware Resiliency technology, let me know! <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-1" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1126121264819712000"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  From the <a href="https://www.opencompute.org/files/Intel-System-Firmware-InnovationsMohanKumar-OCP18.pdf">OCP lecture</a> on innovations in Intel firmware, it seems that Platform Firmware Resilience (PFR) from Intel and Cerberus go hand in hand.  Intel uses PFR to implement Cerberus certification guidelines.  Thank you <a href="https://twitter.com/_msw_">@msw</a> for the clarification. <br><br>  It would be nice to reduce a variety of tools to do this work.  I would also like to see the source code to see with my own eyes that it is safe. <br><br><h2>  How to help </h2><br>  I hope you got some idea of ‚Äã‚Äãwhat projects exist for the development of open source firmware and how important it is!  If you want to help, please tell others.  Try using platforms with open components.  Hrombuki is a great example, as well as <a href="https://puri.sm/">Purism</a> computers.  You can ask your suppliers what they are doing to release open source firmware and ensure equipment security with roots of trust.  Happy nerd!  :) </div><p>Source: <a href="https://habr.com/ru/post/451320/">https://habr.com/ru/post/451320/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451306/index.html">QEMU.js: now in earnest and with WASM</a></li>
<li><a href="../451310/index.html">Did you miss the CCP?</a></li>
<li><a href="../451314/index.html">Production of printed circuit boards LUT'om from A to Z</a></li>
<li><a href="../451316/index.html">About one faculty of physics</a></li>
<li><a href="../451318/index.html">Announced Dart 2.3: optimized for user interface development</a></li>
<li><a href="../451322/index.html">Is the book ‚ÄúJava Concurrency in Practice‚Äù relevant at the time of Java 8 and 11?</a></li>
<li><a href="../451324/index.html">"Factory method" and "Abstract factory" in the universe "Swift" and "iOS"</a></li>
<li><a href="../451326/index.html">3CX V16 Update 1 Beta - new chat features and Call Flow Service for software call control</a></li>
<li><a href="../451330/index.html">What is heard on the radio? Part 3, ham radio</a></li>
<li><a href="../451332/index.html">Hepatitis C: "Affectionate Killer"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>