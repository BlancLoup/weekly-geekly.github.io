<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ASLR bypass methods in the newest Zero-Day exploits</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ASLR (Address Space Layout Randomization) is one of the most effective protection mechanisms in modern operating systems. But this method is not perfe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ASLR bypass methods in the newest Zero-Day exploits</h1><div class="post__text post__text-html js-mediator-article">  ASLR (Address Space Layout Randomization) is one of the most effective protection mechanisms in modern operating systems.  But this method is not perfect.  Many modern APT (advanced persistent threat) have already learned how to use innovative technologies to circumvent ASLR. <br><br>  Consider the most well-known bypass methods that were discovered over the last year: <br><ul><li>  Using non-ASLR modules </li><li>  Change BSTR Length / Zero End </li><li>  Modifying Array Objects </li></ul><br>  Below will be discussed in detail each of the techniques. <br><a name="habracut"></a><br><h3>  Non-ASLR modules </h3><br>  This method is the most popular and easy to use.  Two popular non-ASLR modules that are used in IE are not protected by ASLR: MSVCR71.DLL and HXDS.DLL. <br><br>  MSVCR71.DLL is used by JRE 1.6.x and comes from the Microsoft Visual C Runtime Library, which was compiled without the / DYNAMICBASE option.  The library is loaded into the IE process space and has a permanent address in the following combinations of OS / browsers: <br><ul><li>  Windows 7 and Internet Explorer 8 </li><li>  Windows 7 and Internet Explorer 9 </li></ul><br>  HXDS.DLL comes from MS Office 2010/2007, and is built without ASLR support.  This vector was first described <a href="http://www.greyhathacker.net/%3Fp%3D585">here</a> , and is currently the main ASLR bypass method for IE 8/9 on Windows 7. This library is loaded when the browser contacts the address starting with ‚Äúms-help: //‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This method has been used at least once in the following exploits: <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/09/operation-deputydog-zero-day-cve-2013-3893-attack-against-japanese-targets.html">CVE-2013-3893</a> , CVE2013-1347, <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/05/ie-zero-day-is-used-in-dol-watering-hole-attack.html">CVE-2012-4969</a> , <a href="http://www.fireeye.com/blog/technical/targeted-attack/2012/12/council-foreign-relations-water-hole-attack-details.html">CVE-2012-4792</a> . <br><br><h6>  disadvantages </h6><br>  The non-ASLR system requires modules that come with older versions of JRE 1.6 and Office 2007/2010, and are loaded only in IE8 and IE9.  Updating programs to the latest versions makes this attack vector impossible. <br><br><h3>  BSTR modification </h3><br>  For the first time this technique <a href="http://www.exploit-db.com/wp-content/themes/exploit/docs/11921.pdf">was covered in</a> 2010 by Peter Vreudenhilom.  It is applicable only to specific types of vulnerabilities associated with the possibility of memory rewriting: buffer overflow, random writing to memory, or the possibility of pointer manipulation make the attack possible. <br><br>  When writing to memory there is no full control of EIP.  Most of the time, the exploit overwrites critical program data, such as function pointers to execute arbitrary code.  The main purpose of the attackers is damage to the length of the BSTR, which leads to an exit beyond the initial bounds of the allocated memory.  In case of success, we can determine the addresses of other libraries and use them as a ROP repository.  This can result in memory corruption and taking control of EIP. <br>  Multiple vulnerabilities can be used to change the length of a BSTR.  For example, some vulnerabilities allow modifying memory for one or two bytes.  In this case, the attacker can change the null character in the BSTR to merge the string with the next object.  With subsequent access to the modified BSTR there are chances to get information about the base addresses of the loaded libraries. <br><br><h5>  CVE-2013-0640 </h5><br>  <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/in-turn-its-pdf-time.html">Adobe XFA zero-day</a> exploit uses this technique to find the base address of AcroForm.api, after which the ROP chain is built and the ASLR and DEP traversal is possible.  With this vulnerability, an exploit can monitor memory before calling a function from vftable: <br><img src="https://habrastorage.org/getpro/habr/post_images/f46/598/efc/f46598efcaca1e928fc40bbb676bfa91.jpg" alt="image"><br>  Consider the memory allocation before the DEC operation: <br> <code>[string][null][non-null data][object]</code> <br>  After the DEC operation, the memory looks like this: <br> <code>[string][\xfe][non-null data][object]</code> <br>  For more information, refer to the <a href="http://immunityproducts.blogspot.com/2013/06/adobe-xfa-exploits-for-all-first-part.html">immunityinc's</a> blog entry. <br><br><h6>  disadvantages </h6><br>  This method usually requires multiple manipulations of the memory for the disclosure of addresses, and for the operation a careful analysis of the heap is necessary to ensure that the part of the memory that is responsible for the separation of lines, and not other objects is damaged.  Since Microsoft, when creating IE9, used <a href="http://research.microsoft.com/pubs/81085/usenixsec09b.pdf">Nozzle</a> to prevent spraying / fengshui, sometimes an attacker has to use VBArray techniques to properly handle the heap. <br><br><h3>  Modifying an Array Object </h3><br>  Modifying the length of an array is similar to changing the length of a BSTR: they both require a certain class of ‚Äúconvenient‚Äù vulnerabilities.  After some change in length, an attacker can achieve an arbitrary read or write to memory, or, as happens in most cases, full control over the program flow and the execution of arbitrary code. <br>  Here is a list of known zirodeas using this technique: <br><br><h6>  CVE-2013-0634 </h6><br>  This exploit is aimed at the Adobe Flash Player, in which the buffer overflow occurs during the processing of regular expressions.  The attacker overwrites the length of the object's vector, and then reads the adjacent memory regions to search for the base address flash.ocx. <br>  The exploit‚Äôs work is shown here: <br>  <i>Setting infinite memory allocation for new objects:</i> <br><img src="https://habrastorage.org/getpro/habr/post_images/ca0/40f/f90/ca040ff905dea30d7b89fcf8d8ad8437.jpg" alt="image"><br>  Release the <code><code>   1: <br> obj[1] = null; <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> <i>-        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <code><a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <code><code><a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code></code> <code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> <i>-        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <code><a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <code><code><a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> <h5> <code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> <i>-        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <code><a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <code><code><a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> </h5> <code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> <i>-        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <code><a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <code><code><a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> <h6> <code><i><code><code><code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> -        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> </h6> <code><i><code><code><code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> -        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> <h6> <code><i><code><code><code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> -        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> </h6> <code><i><code><code><code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> -        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> <h3> <code><i><code><code><code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> -        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> </h3> <code><i><code><code><code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> -        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> <h3> <code><i><code><code><code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> -        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> </h3> <code><i><code><code><code><code>   1: <br> obj[1] = null;</code> <br>   RegExp ,          : <br> <code>boom = "(?i)()()(?-i)||||||||||||||||||||||||"; <br> var trigger = new RegExp(boom, "");</code> <br> <br> ,       ,  obj[2].   ,    obj[2]         ,     flash.ocx   vftable    . <br> <br> CVE-2013-3163 <br>  use-after-free    CBlockContainerBlock,    IE.     CVE-2013-0634,    . <br>         OR.   : <br> <code>or dword ptr [esi+8],20000h</code> <br>    : <br> -        <code>:</code> <br> <img src="https://habrastorage.org/getpro/habr/post_images/390/5ff/7f9/3905ff7f9e6c36ca504567f74c399ff2.jpg" alt="image"> <br> <i>  ,        . :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/9e5/d27/263/9e5d27263b8452de55829874957f444a.jpg" alt="image"> <br>  DWORD, 0x03f0,    ,           . <br> <i>   ESI + 8   0x03f0,     OR  0x0203f0,   ,    .</i> <br> <i>        0x3FFFFFF0.</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/b88/1dd/ab6/b881ddab6a0894bbe887d25d5874cf55.jpg" alt="image"> <br> <i>          IE. ASLR ,        DLL  kernel32/NTDLL   . <br>  ZwProtectVirtualMemory    API    ROP ,      DEP  :</i> <br> <img src="https://habrastorage.org/getpro/habr/post_images/ed4/a31/945/ed4a31945594e80f25ef1aa26c45d6e4.jpg" alt="image"> <br>      ,   <a href="http://www.fireeye.com/blog/technical/cyber-exploits/2013/02/yaj0-yet-another-java-zero-day-2.html"></a> <a href="http://www.semantiscope.com/research/BHDC2010/BHDC-2010-Paper.pdf"></a> <a href="http://cansecwest.com/slides/2013/DEP-ASLR%2520bypass%2520without%2520ROP-JIT.pdf"></a>  flash.Media.Sound().      vftable   ROP  . <br> <br> CVE-2013-1690 <br>  use-after-free   DocumentViewerImpl   Firefox     0√ó0001     ,  : <br> <img src="https://habrastorage.org/getpro/habr/post_images/e85/0e5/d48/e850e5d482ac7cde0689c1bed80b670b.jpg" alt="image"> <br> <br>    ,  ,    ""     .          "IF",    setImageAnimationMode(),    .  setImageAnimationMode()    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/79b/9bd/6cc/79b9bd6ccd8036aa92ed3f13a403e9cd.jpg" alt="image"> <br>       ArrayBuffer,   .       ArrayBuffer  var2    0xff004. <br> <img src="https://habrastorage.org/getpro/habr/post_images/cad/6d0/cce/cad6d0cce922d8adfb9186317fc157c7.jpg" alt="image"> <br>   ,      0x010ff004.      ArrayBuffer   byteLength  JavaScript.           ArrayBuffer.         NTDLL  SharedUserData (0x7ffe0300)       ROP . <br> <br> CVE-2013-1493 <br>        JAVA CMM,         . <br>         0x7fffffff,      SecurityManager      .     ,     . <br>    Array       .        ,     . <br> <br>   <br>      APT 0day    ,    : <br> <img src="https://habrastorage.org/getpro/habr/post_images/043/cf7/91b/043cf791b48c8ccc5f90cc8fd97d9f1e.png" alt="image"> <br> <br>  <br>    ASLR       0day .      IE   non-ASLR    Microsoft Office,            Microsoft      non-ASLR .    ,             .            ,       . <br>   ,        ,    ,   . <br> <br>       ASLR,  Dion Blazakis's JIT   Yuyang's LdrHotPatchRoutine technique.               .    ,           ASLR,  ,     . <br> <br>       .     ,     0day ,         . <br> <br>    Dan Caselden and Yichong Lin     .</code></code></code></i></code> </div><p>Source: <a href="https://habr.com/ru/post/201768/">https://habr.com/ru/post/201768/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201752/index.html">Turn a static website into a mobile application using jQuery Mobile and PhoneGap</a></li>
<li><a href="../201754/index.html">Short version of the Social Network</a></li>
<li><a href="../201756/index.html">Save us from Google. Insanity was strong, ideas descended from the tops. Google</a></li>
<li><a href="../201758/index.html">What to look for when choosing an Electronic Document Management on MS Sharepoint 2013 platform in the first place. Part 1</a></li>
<li><a href="../201762/index.html">Why is the future behind remote work (part 1)</a></li>
<li><a href="../201772/index.html">Whiteboarding (write code on the board for interviews)</a></li>
<li><a href="../201774/index.html">Papa Carlo and incremental compilers</a></li>
<li><a href="../201776/index.html">Overflow effect in CorelDRAW</a></li>
<li><a href="../201778/index.html">Profiling and debugging Python, go to practice</a></li>
<li><a href="../201782/index.html">Ways to combat bookmarks in compilers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>