<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New features of the product SCAT DPI 6.0 ‚ÄúSevastopol‚Äù from VAS Experts</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At VAS Experts, we are creating services for analyzing and controlling traffic and present a new version of SCAT DPI 6.0 ‚ÄúSevastopol‚Äù solution . The s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New features of the product SCAT DPI 6.0 ‚ÄúSevastopol‚Äù from VAS Experts</h1><div class="post__text post__text-html js-mediator-article">  At VAS Experts, we are creating services for analyzing and controlling traffic and present a new version of SCAT DPI 6.0 ‚ÄúSevastopol‚Äù <a href="http://vasexperts.ru/product-skat.php">solution</a> .  The system received several corrections based on the experience of developing previous versions of the product, and also acquired new features, which will be discussed below. <br><br> <a href="https://habrahabr.ru/company/vasexperts/blog/319636/"><img src="https://habrastorage.org/files/b52/d59/69b/b52d5969babb41d4865f800fbb97496a.jpg"></a> <a name="habracut"></a>  <i>/ Flickr / <a href="https://www.flickr.com/photos/alexxx-malev/8545681368/in/photostream/">Alexxx Malev</a> / <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC</a></i> <br><br><h2>  Development of NAT and IPFIX </h2><br>  In the new version of the product, the ability to connect NAT for users who simultaneously use white and gray addresses has been added.  To do this, several IP addresses are combined on one login, and then policies are assigned to it and services are connected.  This feature is convenient for corporate customers who buy blocks of addresses from an operator. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Here is an example of a command to combine addresses into one login: <br><br><pre><code class="hljs pgsql">fdpi_ctrl <span class="hljs-keyword"><span class="hljs-keyword">load</span></span> ‚Äìbind_multi ‚Äì<span class="hljs-keyword"><span class="hljs-keyword">user</span></span> _: ip___</code> </pre> <br>  In this case, I would like to note that the CG-NAT function requires the inclusion of a backup device in the scheme.  This is due to the fact that by installing the SCAT system ‚Äúinto the gap‚Äù the bypass card does not help, therefore, the platform‚Äôs failure stops issuing addresses.  Thus, the recommended wiring diagram looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e02/a9a/d21/e02a9ad2140247aba93b87ba2839daaa.png" width="500"></div>  <i>Installation scheme SCAT with CGNAT function (Source: <a href="https://www.youtube.com/watch%3Fv%3Dpo7hphbohAY">webinar</a> )</i> <br><br>  As for the IPFIX protocol, it allows transferring analytical data from SCAT to both the internal storage system of the server and external aggregators.  In its new incarnation, IPFIX received two new features.  The first is the export of the resource blocking flag: for example, if the resource is blocked by blacklists, then the corresponding value will appear in the LOCKED field.  The second is the export of the host name for the HTTPS and QUIC protocols. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8fe/a1b/48c/8fea1b48c62b425f94bae0ee7d67fc1a.png" width="500"></div>  <i>IPFIX development (Source: <a href="https://www.youtube.com/watch%3Fv%3Dpo7hphbohAY">webinar</a> )</i> <br><br>  Note that one of the most popular ways to analyze information from the DPI platform <a href="http://blog.vasexperts.ru/%3Fp%3D311">is a</a> bunch of nfcapd daemon collector, nfdump dump and NfSen visualizer, which is a graphical interface for nfdump data.  To collect information in the IPFIX format, any universal IPFIX collector that understands patterns or the IPFIX Receiver utility is suitable.  After accumulating data at least in one day, NfSen builds graphs by protocols, traffic volume, etc. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/42b/ce1/63a/42bce163ac2c44518ac72eac1bb449f0.png" width="500"></div><br>  In addition to graphs, using NfSen, you can build reports for arbitrary periods by protocols and directions.  At the same time, we would like to note that the visualizer is not recommended to be installed on the server where the DPI solution is deployed - the preparation of reports loads the CPU heavily, and this may adversely affect the performance of the DPI platform. <br><br><h2>  Feature Set to work as a L3 BRAS </h2><br>  The BRAS service gateway is a new feature of the SCAT traffic monitoring and analysis system.  Part of its capabilities were presented in SCAT 5.0.  In the new version, the authorization of IPoE sessions on radius appeared, which expanded the range of operator's possibilities in the area of ‚Äã‚Äãcontrolling subscriber access to the Internet, as well as when working with additional tariff options (L3 operation and client identification by IP or Q-in-Q tag). <br><br>  Note that SCAT with the BRAS function is embedded in the operator‚Äôs network ‚Äúinto the gap‚Äù, however with the use of additional components: SCAT PCRF, radius server and billing server.  How to configure the function L3 BRAS read in one of our materials, which you will find on the <a href="http://blog.vasexperts.ru/%3Fp%3D576">link</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/bb4/6ca/265/bb46ca265bda4f41bb6662b20f563048.png" width="500"></div>  <i>SCAT L3 BRAS location in the operator‚Äôs network (Source: <a href="https://www.youtube.com/watch%3Fv%3Dpo7hphbohAY">webinar</a> )</i> <br><br>  The SCAT system with the BRAS function has several applications, among which it is worth highlighting the subscriber access control at zero balance, so that the user can go to the payment system page and replenish the account, manage the total channel bandwidth (tariff plans, QoS), and also <a href="http://blog.vasexperts.ru/%3Fp%3D553">identify</a> subscribers in Wi-Fi-network (for example, by phone number). <br><br>  As for the last point, the work on identification of the user takes place on the equipment of the telecom operator.  To do this, the operator must have a standard set of devices (switches, routers, etc.), as well as a DPI system, a DHCP server for arranging the issuance of addresses to subscribers, VMs with an Apache web server, and NAT with a broadcast log entry. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dd6/39f/cc2/dd639fcc2adb44bda9a9e404c741e4ae.jpg" width="500"></div>  <i>Access to the Internet through a point of access</i> <br><br>  The system works as follows.  The subscriber's device connects to a Wi-Fi router, which, in turn, ‚Äúasks‚Äù a new IP from a DHCP server.  The latter sends data back to the router and calls a shell script that activates a tariff with access restrictions in SCAT DPI. <br><br>  Then, when the user enters the URL he needs, the web server receives a request for an identification page, where the user enters a phone number followed by a request for an access code.  The server generates a random sequence of numbers and sends it to the user via SMS.  When the code is confirmed, the new shell script sets the Wi-Fi access rate and forwards the client to the requested URL. <br><br>  To implement the above scheme, it is necessary to configure the operator‚Äôs equipment: a DPI system, a DHCP server, a web server.  Instructions for setting up you can find in one of our <a href="http://blog.vasexperts.ru/%3Fp%3D553">materials</a> . <br><br><h2>  PCRF Policy Management Server Support </h2><br>  The PCRF server can be <a href="http://blog.vasexperts.ru/%3Fp%3D55">located</a> on a separate device and manage multiple PCEFs or be part of the SCAT DPI system.  The fdpi_pcrf service performs the BRAS role for fastdpi ‚Äî for outgoing client traffic, fdpi_pcrf requests authorization from the radius server, the tariff plan profile and the list of services provided.  To ensure the fault tolerance of the system, it is possible to implement a master-slave redundancy scheme. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/77e/3e5/1d9/77e3e51d920444caa043ab58a1251ff2.png" width="500"></div>  <i>Policy Management Server Operation (Source: <a href="https://www.youtube.com/watch%3Fv%3Dpo7hphbohAY">webinar</a> )</i> <br><br>  The fdpi_pcrf server itself is integrated with fastdpi and has three components.  The first is the fastdpi authorization module, which analyzes outgoing traffic from local clients.  If there is no client authorization, the module sends a TCP request to fdpi_pcrf.  The second is the fdpi_pcrf server, which accepts authorization requests from fastdpi using an internal protocol and processes them.  Well, the third is the fastdpi control module, which receives the results of fdpi_pcrf using the fdpi_ctrl protocol and writes them to the client database. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/po7hphbohAY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  You can learn more about the SCAT DPI 6.0 ‚ÄúSevastopol‚Äù system from our presentation presented above.  Part of the video is devoted to the Q &amp; A section - questions were asked by the participants of the webinar online. <br><br>  PS Other materials from our blog: <br><br><ul><li>  <a href="http://blog.vasexperts.ru/%3Fp%3D553">Subscriber identification in a Wi-Fi network by phone number</a> </li><li>  <a href="http://blog.vasexperts.ru/%3Fp%3D482">DPI for satellite Internet assistance - experience on ANADYR.NET communication network</a> </li><li>  <a href="http://blog.vasexperts.ru/%3Fp%3D576">DPI system SCAT as L3 BRAS</a> </li><li>  <a href="http://blog.vasexperts.ru/%3Fp%3D501">Fighting DDoS - CAPTCHA and its history</a> </li><li>  <a href="http://blog.vasexperts.ru/%3Fp%3D472">Internet resources rating - traffic analysis using DPI</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/319636/">https://habr.com/ru/post/319636/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319624/index.html">DPI pays for itself: Current Business Cases</a></li>
<li><a href="../319626/index.html">Researchers Will Introduce 1.44-Petabit Fiber Optic Cable</a></li>
<li><a href="../319628/index.html">Deep Packet Inspection Material Digest</a></li>
<li><a href="../319630/index.html">Exploit Russian: Can our IT infrastructure solutions compete with Western</a></li>
<li><a href="../319632/index.html">AT & T is preparing to launch the Internet via power lines</a></li>
<li><a href="../319638/index.html">"Battle for a place": Scientists hope to reduce the number of wires in the data center</a></li>
<li><a href="../319640/index.html">Begin End: IPv4 addresses really end</a></li>
<li><a href="../319642/index.html">The way to go to gain invaluable experience in mobile development</a></li>
<li><a href="../319644/index.html">Creating Hexagon Grid</a></li>
<li><a href="../319646/index.html">Competition GraphHPC-2017 for the fastest implementation of the task of Betweenness Centrality</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>