<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Libgdx Practical questions and answers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habr! 

 The contest from VKontakte and my 2-week marathon on the Internet for finding the necessary information ended. I want to share some experi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Libgdx Practical questions and answers</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/web/0b6/1f8/dac/0b61f8dac9974bcd8558b67289285550.jpg" width="400" alt="image" align="left">  Hi Habr! <br><br>  The contest from VKontakte and my 2-week marathon on the Internet for finding the necessary information ended.  I want to share some experience with the graphics engine LibGDX.  There are plenty of examples on the Internet, but most of them are far from practice (a drawn sprite is far from a game) or outdated. <br><a name="habracut"></a><br>  Honestly, I liked it, because it easily integrates with android studio, it is written in a convenient language, it perfectly performs its graphical task.  <s>It's scary to think about using android graphics to solve this problem.</s> <br><br>  Questions that I had to solve: <br><cut></cut><br><div class="spoiler">  <b class="spoiler_title">Use option of the built-in logger</b> <div class="spoiler_text">  I often use <a href="https://github.com/JakeWharton/timber">Timber</a> for convenience.  It is not available in the core module, so I wrote a simple auxiliary class using the logger available in LibGDX, with which the application will stop writing logs in the release version 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.badlogic.gdx.Gdx; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GdxLog</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> DEBUG; <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>(<span class="hljs-string"><span class="hljs-string">"all"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String tag, String message)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DEBUG) { Gdx.app.log(tag, message); } } <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>(<span class="hljs-string"><span class="hljs-string">"all"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">d</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String tag, String message, Integer...values)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DEBUG) { Gdx.app.log(tag, String.format(message, values)); } } <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>(<span class="hljs-string"><span class="hljs-string">"all"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String tag, String message, Float...values)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DEBUG) { Gdx.app.log(tag, String.format(message.replaceAll(<span class="hljs-string"><span class="hljs-string">"%f"</span></span>, <span class="hljs-string"><span class="hljs-string">"%.0f"</span></span>), values)); } } } <span class="hljs-comment"><span class="hljs-comment">//...  GdxLog.d(TAG, "worldWidth: %d", worldWidth);</span></span></code> </pre> <br>  Plus, for convenience, different float values ‚Äã‚Äãof 1.23456789 are rounded <br></div></div><br><div class="spoiler">  <b class="spoiler_title">E / libEGL: call to OpenGL ES API with no current context (logged once per thread)</b> <div class="spoiler_text">  At first I was very upset by such a mistake, I could not understand anything.  It happens because the GLSurfaceView graphics are rendered in their own separate stream when an outside attempt to interfere with this process occurs.  How to fix: <br><br><pre> <code class="java hljs">Gdx.app.postRunnable(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//      } });</span></span></code> </pre><br>  The principle is the same as in the case view.postInvalidate () <br><br>  I am not a fan of anonymous classes, so I wrote such a simple method to shorten the code (otherwise it just became unreadable).  Although with java 8 this is no longer such a problem, but of the additional advantages that InvocationTargetException is handled, when, for example, the file is not found, the application will not fall due to such a minor error. <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// null may be only String params public void postRunnable(final String name, final Object...params) { Gdx.app.postRunnable(new Runnable() { @Override public void run() { Method method = null; Class[] classes = new Class[params.length]; for (int i = 0; i &lt; params.length; i++) { classes[i] = params[i] == null ? String.class : params[i].getClass(); } try { method = World.class.getMethod(name, classes); } catch (SecurityException e) { GdxLog.print(TAG, e.toString()); } catch (NoSuchMethodException e) { GdxLog.print(TAG, e.toString()); } if (method == null) { return; } try { method.invoke(WorldAdapter.this, params); } catch (IllegalArgumentException e) { GdxLog.print(TAG, e.toString()); } catch (IllegalAccessException e) { GdxLog.print(TAG, e.toString()); } catch (InvocationTargetException e) { GdxLog.print(TAG, e.toString()); } } }); }</span></span></code> </pre><br>  It is important that the parameters are not primitives, and inherit Object.  And plus here is a simplification with a null parameter (only from the String class) <br></div></div><br><div class="spoiler">  <b class="spoiler_title">How to use LibGDX with other widgets</b> <div class="spoiler_text">  Through the fragment.  More information <a href="https://github.com/libgdx/libgdx/wiki/Starter-classes-%26-configuration">on the wiki</a> <br><br>  Example: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActivityMain</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AndroidFragmentApplication</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Callbacks</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> FragmentWorld fragmentWorld; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); <span class="hljs-comment"><span class="hljs-comment">// ... getSupportFragmentManager() .beginTransaction() .add(R.id.world, fragmentWorld, FragmentWorld.class.getSimpleName()) .commitAllowingStateLoss(); } @Override public void exit() {}</span></span></code> </pre><br>  And the fragment itself: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FragmentWorld</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AndroidFragmentApplication</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> World world; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> View </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> worldWidth = getResources().getDimensionPixelSize(R.dimen.world_width); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> worldHeight = getResources().getDimensionPixelSize(R.dimen.world_height); world = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> World(BuildConfig.DEBUG, worldWidth, worldHeight); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> initializeForView(world); } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">How to pull the render world or Pixmap in Bitmap</b> <div class="spoiler_text">  I did not want to save the pixmap to a file and then use Android tools to pull out a Bitmap <br>  Therefore, I came up with such a life hacking with an OutputStream class.  Works great and does not require slow r / w operations. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Pixmap pixmap = getScreenshot(); Observable.fromCallable(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Callable &lt;Boolean&gt; () { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Boolean </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ PixmapIO.PNG writer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PixmapIO.PNG((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)(pixmap.getWidth() * pixmap.getHeight() * <span class="hljs-number"><span class="hljs-number">1.5</span></span> f)); writer.setFlipY(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); ByteArrayOutputStream output = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ByteArrayOutputStream(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { writer.write(output, pixmap); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { StreamUtils.closeQuietly(output); writer.dispose(); pixmap.dispose(); } <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes = output.toByteArray(); Bitmap bitmap = BitmapFactory.decodeByteArray(bytes, <span class="hljs-number"><span class="hljs-number">0</span></span>, bytes.length); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } }).subscribeOn(Schedulers.io()).subscribe();</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">How to work with colors with Android</b> <div class="spoiler_text">  Actually, you can int, probably (the Color class in LibGDX is quite specific as the entire graphics, in my opinion, that is, you need to understand at the bit level), but for simplicity, I preferred to store and transfer the hex to String <br><br>  Appropriately needed a parser: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Color </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseColor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String hex)</span></span></span><span class="hljs-function"> </span></span>{ String s1 = hex.substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v1 = Integer.parseInt(s1, <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> f1 = <span class="hljs-number"><span class="hljs-number">1</span></span> f * v1 / <span class="hljs-number"><span class="hljs-number">255</span></span> f; String s2 = hex.substring(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v2 = Integer.parseInt(s2, <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> f2 = <span class="hljs-number"><span class="hljs-number">1</span></span> f * v2 / <span class="hljs-number"><span class="hljs-number">255</span></span> f; String s3 = hex.substring(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v3 = Integer.parseInt(s3, <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> f3 = <span class="hljs-number"><span class="hljs-number">1</span></span> f * v3 / <span class="hljs-number"><span class="hljs-number">255</span></span> f; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(f1, f2, f3, <span class="hljs-number"><span class="hljs-number">1</span></span> f); }</code> </pre><br>  Example of the "ffffff" parameter <br></div></div><br><div class="spoiler">  <b class="spoiler_title">How to determine the click on actor</b> <div class="spoiler_text">  <s>sticker.addListener ()</s> Everything is easier.  There is a hit method at the scene. <br><br><pre> <code class="java hljs">Sticker sticker = (Sticker) stickersStage.hit(coordinates.x, coordinates.y, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Math scale and rotation for pinch event (two fingers)</b> <div class="spoiler_text">  Perhaps this is not the best solution, but it works well.  Rotate without sudden jumps, smooth zoom <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pinch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Vector2 initialPointer1, Vector2 initialPointer2, Vector2 pointer1, Vector2 pointer2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// initialPointer doesn't change // all vectors contains device coordinates Sticker sticker = getCurrentSticker(); if (sticker == null) { return false; } Vector2 startVector = new Vector2(initialPointer1).sub(initialPointer2); Vector2 currentVector = new Vector2(pointer1).sub(pointer2); sticker.setScale(sticker.startScale * currentVector.len() / startVector.len()); float startAngle = (float) Math.toDegrees(Math.atan2(startVector.x, startVector.y)); float endAngle = (float) Math.toDegrees(Math.atan2(currentVector.x, currentVector.y)); sticker.setRotation(sticker.startRotation + endAngle - startAngle); return false; }</span></span></code> </pre><br>  The only thing necessary before this event is to memorize the current zoom and rotation. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">touchDown</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> pointer, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> button)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pointer == FIRST_FINGER) { Vector2 coordinates = stickersStage.screenToStageCoordinates(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector2(x, y)); Sticker sticker = (Sticker) stickersStage.hit(coordinates.x, coordinates.y, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sticker != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  sticker.setPinchStarts(); currentSticker = sticker.index; } } return false; } @Override public void pinchStop() { Sticker sticker = getCurrentSticker(); if (sticker != null) { //  sticker.setPinchStarts(); } }</span></span></code> </pre><br>  And at the time of the pinch event, the actor is still in this case <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Why does not the animation, but the action to the actor added</b> <div class="spoiler_text">  The key act method is in the scene.  The pain when you do not know) <br><br><pre> <code class="java hljs">spriteBatch.begin(); stickersStage.act(); stickersStage.getRoot().draw(spriteBatch, <span class="hljs-number"><span class="hljs-number">1</span></span>); spriteBatch.end();</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Gradient in libgdx</b> <div class="spoiler_text">  As I understand it, you can only set the left upper and lower right colors.  If there is no setting of the rest (transparent), then there will be a space between them.  Those.  the rest are defined as the sum of these two colors at a given distance, in the case of a linear gradient.  To say that is peculiar, to say nothing <br><br><pre> <code class="java hljs">gradientTopLeftColor = parseColor(topLeftColor); gradientBottomRightColor = parseColor(bottomRightColor); gradientBlendedColor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Color(gradientTopLeftColor).add(gradientBottomRightColor);</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">The tricks of handling the movement of an actor (event pan)</b> <div class="spoiler_text">  Here is the handler <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pan</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> deltaY)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentSticker != Sticker.INDEX_NONE) { Sticker sticker = getCurrentSticker(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sticker != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { sticker.moveBy(deltaX * worldDensity, -deltaY * worldDensity); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> </pre><br>  worldDensity is the difference between moving the finger in screen coordinates and the actor in the game.  Without this parameter, the actor will break away from the finger. <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (height &gt; width) { worldDensity = <span class="hljs-number"><span class="hljs-number">1f</span></span> * worldWidth / width; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { worldDensity = <span class="hljs-number"><span class="hljs-number">1f</span></span> * worldHeight / height; } viewport.update(width, height, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); }</code> </pre><br>  And if you bind the touch input through the sticker.addListener, then the incoming coordinates will be relative to the actor itself to the current position of the finger.  It‚Äôs better not to do that, because with a small actor‚Äôs size (zoom), he will twitch and fly out of the scene (as I did) <br></div></div><br><div class="spoiler">  <b class="spoiler_title">How best to work with animations of actors (Action)</b> <div class="spoiler_text">  Use the <a href="https://github.com/libgdx/libgdx/wiki/Memory-management">Pool class</a> .  In my project there is an example of more detailed implementation of additional <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onAppear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ ScaleToAction scaleToAction = scaleToPool.obtain(); scaleToAction.setPool(scaleToPool); scaleToAction.setScale(startScale); scaleToAction.setDuration(ANIMATION_TIME_APPEAR); addAction(scaleToAction); }</code> </pre><br></div></div><br>  Probably all that interesting.  I myself have not found a solution to the problem of increasing the viewport.  The zoom camera helps only with the approach of the scene, and it turns out that the scene is reduced more than necessary (the scope is unchanged). <br><br>  Another issue is the preservation of the rendering world.  At the exit, it matches the screen size, but I need a certain size.  I tried it with framebuffer, but I couldn‚Äôt get a pixmap from it (there are some bugs with the initialization of the Texture class) <br><br>  Another drawback in the engine, which does not allow, for example, to completely disable keyboard input.  It turned out that he intercepted the focus from another widget (but he wasn‚Äôt designed for this, although it would be nice. Go pull request, in one word) <br><br>  But in general, everything is very good.  Grow on LibGDX) <br><br>  ‚Üí <a href="https://github.com/androidovshchik/VKAdvancedPosting">Link to project</a> </div><p>Source: <a href="https://habr.com/ru/post/338398/">https://habr.com/ru/post/338398/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../338388/index.html">Kotlin in production, what did we get, and what did we lose?</a></li>
<li><a href="../338390/index.html">Is there an OpenVPN GUI for Linux?</a></li>
<li><a href="../338392/index.html">Visiting a fairy tale: patent trolls</a></li>
<li><a href="../338394/index.html">Hidden costs in the implementation of CRM-systems. Field experience</a></li>
<li><a href="../338396/index.html">We connect Swagger module in Play Framework</a></li>
<li><a href="../338402/index.html">Choosing a help desk system. 9 typical misconceptions</a></li>
<li><a href="../338404/index.html">We write for UEFI BIOS in Visual Studio. Part 2 - we create our first driver and speed debugging</a></li>
<li><a href="../338406/index.html">PostgreSQL Power</a></li>
<li><a href="../338408/index.html">Sale of electronic signatures and related services</a></li>
<li><a href="../338410/index.html">IT vs AI: will cars be taken away from their creators?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>