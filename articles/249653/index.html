<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Isomorphic BEM</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When node.js appeared, many web developers began to think about the possibility of using the same code both on the client and on the server. Now there...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Isomorphic BEM</h1><div class="post__text post__text-html js-mediator-article">  When node.js appeared, many web developers began to think about the possibility of using the same code both on the client and on the server.  Now there are several frameworks that put the ‚Äúwrite code once, use everywhere‚Äù approach at the center, from time to time new ones appear.  So I could not pass by, writing a similar micro-framework - <a href="https://github.com/apsavin/bnsf">bnsf</a> .  It is intended for those who prefer to create the front-end of their applications using the BEM methodology, using the appropriate set of technologies and tools. <br><br>  Let's try to start writing a front-end for a simple one-page web application using bnsf.  In order not to be distracted by the creation of a back-end part, we will use vk.com API as a back-end.  Our application will consist of only two pages, the main one - with the user search form by identifier - and the secondary one, we will display information about the selected user. <br><a name="habracut"></a><br>  To get started, you need node.js, yeoman and gulp.  I recommend using * nix OS, as the code was not tested under Windows, although, theoretically, it should work.  I proceed from the assumption that you already have node.js installed.  If not, I advise you to use <a href="https://github.com/creationix/nvm">nvm</a> . <br><br>  Install gulp, yeoman and the corresponding generator: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">npm install -g gulp yo generator-bnsf</code> </pre> <br>  We create our project: <br><br><pre> <code class="bash hljs">yo bnsf vk-test-app <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> vk-test-app</code> </pre><br>  You can see which files and folders were generated: <br><br><pre> <code class="bash hljs">ls</code> </pre><br>  It will output approximately the following set of files (the order may differ on different operating systems): <br><br><pre> <code class="bash hljs">README.md desktop.blocks gulpfile.js node_modules bower.json desktop.bundles libs package.json</code> </pre><br>  The project is already possible to try to collect: <br><br><pre> <code class="bash hljs">gulp</code> </pre><br>  gulp will not only build the project, but also start the server, begin to monitor changes in the project and, if necessary, rebuild it. <br><br>  Check that everything works.  We try to open in the browser <a href="http://localhost:3000/">http: // localhost: 3000</a> - we should see a page with the text page-index and the title of the main page. <br><br>  We already have one page, let's create a second one to output entries from the user's wall.  To do this, we again need a generator.  Since it works from the command line, you will need another terminal session in order not to interrupt the gulp.  At this stage, you can simply agree with everything that yeoman will ask about.  It will warn about conflicts - this is standard practice, when a file is not created new, but an existing one is being edited, so just press ‚Äúenter‚Äù in response to all yo questions.  So, let's execute from the project root: <br><br><pre> <code class="bash hljs">yo bnsf:page user</code> </pre><br>  Once again I will remind you that we answer all questions by agreement - that is, we press the input. <br><br>  gulp should notice the appearance of a new page and rebuild the project.  Checking: the request for <a href="http://localhost:3000/user">http: // localhost: 3000 / user</a> should give a page with the text page-user. <br><br>  Let's now place a search form on the main page by editing the file <code>desktop.blocks/page-index/page-index.bemtree</code> as follows: <br><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'page-index'</span></span>)( content()(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'search-form'</span></span>, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'input'</span></span>, <span class="hljs-attr"><span class="hljs-attr">mods</span></span>: { <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: <span class="hljs-string"><span class="hljs-string">'simple'</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'button'</span></span>, <span class="hljs-attr"><span class="hljs-attr">mods</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'submit'</span></span>, <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: <span class="hljs-string"><span class="hljs-string">'simple'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: <span class="hljs-string"><span class="hljs-string">'search'</span></span> } ] }, { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'search-results'</span></span> } ]; }) ); block(<span class="hljs-string"><span class="hljs-string">'page-index'</span></span>).elem(<span class="hljs-string"><span class="hljs-string">'title'</span></span>).content()(<span class="hljs-string"><span class="hljs-string">'main page'</span></span>);</code> </pre><br>  And change the dependencies in <code>page-index.deps.js:</code> <br><br><pre> <code class="javascript hljs">({ <span class="hljs-attr"><span class="hljs-attr">mustDeps</span></span>: [<span class="hljs-string"><span class="hljs-string">'i-page'</span></span>], <span class="hljs-attr"><span class="hljs-attr">shouldDeps</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'title'</span></span> }, <span class="hljs-string"><span class="hljs-string">'search-form'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'input'</span></span>, <span class="hljs-attr"><span class="hljs-attr">mods</span></span>: { <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: <span class="hljs-string"><span class="hljs-string">'simple'</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'button'</span></span>, <span class="hljs-attr"><span class="hljs-attr">mods</span></span>: { <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: <span class="hljs-string"><span class="hljs-string">'simple'</span></span> } }, <span class="hljs-string"><span class="hljs-string">'search-results'</span></span> ] })</code> </pre><br>  Now the form is already displayed (you can check again by going to <a href="http://localhost:3000/">http: // localhost: 3000</a> ), only the tag is not a <code>form</code> , but a <code>div</code> .  To fix this, create the appropriate template file, <code>desktop.blocks/search-form/search-form.bemhtml</code> : <br><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'search-form'</span></span>).tag()(<span class="hljs-string"><span class="hljs-string">'form'</span></span>);</code> </pre><br>  Now it may seem redundant to create a separate directory with a file that stores only one line of code.  But in a real project, this is almost impossible to meet: either a file with styles appears, or with JavaScript, or the block template itself is more complicated.  Often - all of the above at once. <br><br>  Great, we have a form, but she still does not know how to look for anything.  Let ‚Äúsearch‚Äù from the point of view of the form is redirect to the current page with the query parameter.  For the form to start doing this, you need the following JS in the file <code>desktop.blocks/search-form/search-form.browser.js</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/**@module search-form*/</span></span> modules.define(<span class="hljs-string"><span class="hljs-string">'search-form'</span></span>, [<span class="hljs-string"><span class="hljs-string">'i-bem__dom'</span></span>, <span class="hljs-string"><span class="hljs-string">'app-navigation'</span></span>], <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">provide, BEMDOM, navigation</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-string"><span class="hljs-string">"use strict"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** * @class SearchForm * @extends BEM.DOM * @exports */</span></span> provide(BEMDOM.decl(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name, <span class="hljs-comment"><span class="hljs-comment">/**@lends SearchForm#*/</span></span>{ <span class="hljs-attr"><span class="hljs-attr">onSetMod</span></span>: { <span class="hljs-attr"><span class="hljs-attr">js</span></span>: { <span class="hljs-comment"><span class="hljs-comment">/** * @constructs * @this SearchForm */</span></span> inited: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._input = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.findBlockInside(<span class="hljs-string"><span class="hljs-string">'input'</span></span>); } } }, <span class="hljs-comment"><span class="hljs-comment">/** * @param {Event} e * @private */</span></span> _onSubmit: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ e.preventDefault(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> query = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._input.getVal(), params = query ? {<span class="hljs-attr"><span class="hljs-attr">query</span></span>: query} : <span class="hljs-literal"><span class="hljs-literal">null</span></span>; navigation.navigate(<span class="hljs-string"><span class="hljs-string">'page-index'</span></span>, params); } }, <span class="hljs-comment"><span class="hljs-comment">/**@lends SearchForm*/</span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * @static */</span></span> live: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> init = { <span class="hljs-attr"><span class="hljs-attr">modName</span></span>: <span class="hljs-string"><span class="hljs-string">'js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">modVal</span></span>: <span class="hljs-string"><span class="hljs-string">'inited'</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> .liveInitOnBlockInsideEvent(init, <span class="hljs-string"><span class="hljs-string">'button'</span></span>) .liveInitOnBlockInsideEvent(init, <span class="hljs-string"><span class="hljs-string">'input'</span></span>) .liveBindTo(<span class="hljs-string"><span class="hljs-string">'submit'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._onSubmit(e) }); } })); });</code> </pre><br>  We will also have to complicate the template a bit by adding the information that the block has logic, the file <code>desktop.blocks/search-form/search-form.bemhtml</code> : <br><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'search-form'</span></span>)( tag()(<span class="hljs-string"><span class="hljs-string">'form'</span></span>), js()(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) );</code> </pre><br>  So now we have a form that can change the get parameter of the page.  You can verify this by typing, say, ‚Äú1‚Äù into the text input and pressing enter.  It's time to get some data on this parameter.  I do not want to use an API that requires authentication, so I will use the method available to anyone via url <code><a href=""></a> api.vk.com/method/users.get</code>  <code><a href=""></a> api.vk.com/method/users.get</code> .  Let the form accept the user ID, and the link to its page (to the user page we created above) and to the pages of another 4 users with identifiers obtained by a simple increment will be displayed.  As the text of links we will use user names. <br><br>  The first thing we need to do is add a route to the API route configuration file.  This is the file <code>desktop.bundles/index/index.api.routing.yml</code> , and this is how its contents should turn out: <br><br><pre> <code class="hljs pgsql">- host: api.vk.com routes: - id: users <span class="hljs-type"><span class="hljs-type">path</span></span>: /<span class="hljs-keyword"><span class="hljs-keyword">method</span></span>/users.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span></code> </pre><br>  Second - Create a file <code>desktop.blocks/search-results/search-results.bemtree</code> .  The basic idea is this: to whom the data should be displayed, the one behind them goes.  In our case, the data is needed by the search-results block, it‚Äôs for the data and go: <br><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'search-results'</span></span>).content()(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.route.parameters.query) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">''</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id = <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.route.parameters.query, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> id ? <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.get(<span class="hljs-string"><span class="hljs-string">'users'</span></span>, { <span class="hljs-comment"><span class="hljs-comment">//      API   user user_ids: [id, id + 1, id + 2, id + 3, id + 4] }, function (data) { //       return data.body.response.map(function (dataItem) { return { block: 'search-results', elem: 'item', content: { block: 'link', url: path('page-user', { id: dataItem.uid }), //  url     page-user content: dataItem.first_name + ' ' + dataItem.last_name } }; }); }) : 'Something goes wrong'; });</span></span></code> </pre><br>  In this data template, we look at whether the id came to us, if it did, we request data along the API route with the user identifier and the user_ids parameter using the get method.  If id is not a number, give the string 'Something goes wrong'.  Since the output will need a list, and we love the semantics, we will create <code>desktop.blocks/search-results/search-results.bemhtml</code> : <br><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'search-results'</span></span>) .tag()(<span class="hljs-string"><span class="hljs-string">'ul'</span></span>) .elem(<span class="hljs-string"><span class="hljs-string">'item'</span></span>).tag()(<span class="hljs-string"><span class="hljs-string">'li'</span></span>);</code> </pre><br>  In addition, we will need a file for the block dependency declaration, <code>desktop.blocks/search-results/search-results.deps.js</code> : <br><br><pre> <code class="javascript hljs">({ <span class="hljs-attr"><span class="hljs-attr">shouldDeps</span></span>: [<span class="hljs-string"><span class="hljs-string">'link'</span></span>] })</code> </pre><br>  Now the page is already able to search for users and display the results.  Try it, just do not forget to refresh the page.  If you enter "1" - in the delivery of the results must find Pavel Durov.  But the trouble is - every time the whole page is redrawn.  It is easy to fix by teaching it to update only what is necessary.  <code>page-index.bemtree</code> add <code>page-index.bemtree</code> to make it look like this: <br><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'page-index'</span></span>)( content()(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'search-form'</span></span>, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'input'</span></span>, <span class="hljs-attr"><span class="hljs-attr">mods</span></span>: { <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: <span class="hljs-string"><span class="hljs-string">'simple'</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'button'</span></span>, <span class="hljs-attr"><span class="hljs-attr">mods</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'submit'</span></span>, <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: <span class="hljs-string"><span class="hljs-string">'simple'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: <span class="hljs-string"><span class="hljs-string">'search'</span></span> } ] }, { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'search-results'</span></span> } ]; }), js()({ <span class="hljs-attr"><span class="hljs-attr">update</span></span>: <span class="hljs-string"><span class="hljs-string">'search-results'</span></span> <span class="hljs-comment"><span class="hljs-comment">//      JavaScript:  ,    }) ); block('page-index').elem('title').content()('main page');</span></span></code> </pre><br>  Now, by opening the inspector in the browser, you can make sure that with new requests to the API only the search-results block is updated. <br><br>  Well, it's time to come to the second page, not for nothing that we created it. <br>  Let's start with <code>desktop.blocks/page-user/page-user.bemtree</code> : <br><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'page-user'</span></span>).content()(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [ { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'menu'</span></span>, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-attr"><span class="hljs-attr">url</span></span>: path(<span class="hljs-string"><span class="hljs-string">'page-index'</span></span>), <span class="hljs-attr"><span class="hljs-attr">content</span></span>: <span class="hljs-string"><span class="hljs-string">'main page'</span></span> } }, { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'user-card'</span></span> } ]; }); block(<span class="hljs-string"><span class="hljs-string">'page-user'</span></span>).elem(<span class="hljs-string"><span class="hljs-string">'title'</span></span>).content()(<span class="hljs-string"><span class="hljs-string">'user'</span></span>);</code> </pre><br>  We added a fake menu block - just like a wrapper for a link to the main page, the link itself, and a user-card block that will display information about the user. <br>  Do not forget to update the dependencies in <code>desktop.blocks/page-user/page-user.deps.js</code> : <br><br><pre> <code class="javascript hljs">({ <span class="hljs-attr"><span class="hljs-attr">mustDeps</span></span>: [<span class="hljs-string"><span class="hljs-string">'i-page'</span></span>], <span class="hljs-attr"><span class="hljs-attr">shouldDeps</span></span>: [<span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'user-card'</span></span>] })</code> </pre><br>  I did not add a menu block depending on it, because I am not going to implement it. <br><br>  To display a user card, create a file <code>desktop.blocks/user-card/user-card.bemtree</code> : <br><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'user-card'</span></span>).content()(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.get(<span class="hljs-string"><span class="hljs-string">'users'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">user_ids</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.route.parameters.id }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.body.response.map(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dataItem</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> output = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dataItem) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dataItem.hasOwnProperty(key)) { output.push({ <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'row'</span></span>, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'key'</span></span>, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: key }, { <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'value'</span></span>, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(dataItem[key]) } ] }); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> output; }); }); });</code> </pre><br>  In this form will already work.  You can try to click on the link in the search results, just do not forget to refresh the page before this, to pull up the new code.  But let's make the user card a table by defining <code>desktop.blocks/user-card/user-card.bemhtml</code> : <br><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'user-card'</span></span>)( tag()(<span class="hljs-string"><span class="hljs-string">'table'</span></span>), elem(<span class="hljs-string"><span class="hljs-string">'row'</span></span>).tag()(<span class="hljs-string"><span class="hljs-string">'tr'</span></span>), elem(<span class="hljs-string"><span class="hljs-string">'key'</span></span>).tag()(<span class="hljs-string"><span class="hljs-string">'td'</span></span>), elem(<span class="hljs-string"><span class="hljs-string">'value'</span></span>).tag()(<span class="hljs-string"><span class="hljs-string">'td'</span></span>) );</code> </pre><br>  Now, so much better. <br><br>  I think this is the time to finish, although one could still add at least the validation of user input, more accurate url, showing the download process, return to the last search ... I will leave this on homework to those who are interested.  Well, or the next article, if interested will ask for such. <br><br>  Useful links: <br>  <a href="https://github.com/apsavin/bnsf">bnsf</a> is the framework discussed in the article.  In fact, just a library of blocks in the terminology of BEM. <br>  <a href="https://github.com/bem/bem-core">bem-core</a> - block library on which bnsf depends <br>  <a href="https://github.com/bem/bem-components">bem-components</a> - library of blocks, which is used in the project created above <br>  <a href="http://bem.info/">bem.info</a> - a site about bem with documentation, in particular, you can read about there: <br>  <a href="http://ru.bem.info/technology/bemtree/v2/bemtree/">bemtree</a> is a technology for building input data for a template engine from API data and <br>  <a href="http://ru.bem.info/technology/bemhtml/v2/reference/">bemhtml</a> - declarative template engine <br>  <a href="http://www.nczonline.net/blog/2013/10/07/node-js-and-the-new-web-front-end/">An article</a> in the topic by Nickolas Zackas.  There is a <a href="http://habrahabr.ru/post/197358/">translation</a> . </div><p>Source: <a href="https://habr.com/ru/post/249653/">https://habr.com/ru/post/249653/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../249643/index.html">New Year star with Wi-Fi based on ESP8266</a></li>
<li><a href="../249645/index.html">Kernel .Net (GC, JIT, interop, ...) in Open Source</a></li>
<li><a href="../249647/index.html">Making a queue of incoming calls with the callback function</a></li>
<li><a href="../249649/index.html">Configuring Kerio Control Firewall for 3CX Phone System</a></li>
<li><a href="../249651/index.html">1987 - Exhibition "Computer Science in the Life of the United States"</a></li>
<li><a href="../249655/index.html">Simple techniques of reverse engineering UEFI PEI-modules on a useful example</a></li>
<li><a href="../249657/index.html">Let's reinvent the wheel</a></li>
<li><a href="../249659/index.html">Weekly build Vivaldi 1.0.94.2</a></li>
<li><a href="../249661/index.html">To recognize the pictures, you do not need to recognize the pictures.</a></li>
<li><a href="../249663/index.html">Attempt to reincarnation and stuffing in Open-Source Yandex.Following</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>