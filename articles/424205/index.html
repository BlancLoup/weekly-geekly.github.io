<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A1: 2017 - Injections (Part 2)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the last article, I assumed that the reader knows how the SQL query language works in detail, as well as the mechanism of the HTTP protocol. But th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A1: 2017 - Injections (Part 2)</h1><div class="post__text post__text-html js-mediator-article">  In the last article, I assumed that the reader knows how the SQL query language works in detail, as well as the mechanism of the HTTP protocol.  But this is usually not the case.  And I immediately remembered the story described in one of my favorite books, Robert Brotherton's ‚ÄúDistrusting Minds‚Äù.  It describes the following experiment.  Psychologist Rebecca Lawson asked a group of subjects if they had ever ridden a bicycle in their lives?  Most responded affirmatively.  She then asked if they knew how a bicycle was made?  Affirmative answers were already smaller, but still the vast majority.  And then she suggested the following image and asked to add it so that you could ride this bike. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x1/dj/r-/x1djr-cxjabh15wic2gaimmvkkg.png"></div><br>  And then the most interesting thing happened - more than half of the people could not do it.  This deceptively simple task shows that most people simply cannot imagine how a bicycle works.  But the most interesting thing is that they do not understand that they do not know this, but begin to understand this only at the moment when they are to demonstrate this knowledge. <br><br>  C HTTP and SQL happens about the same.  90% of IT professionals wrote SQL queries, at least in laboratories in their schools, people work with HTTP every day as users, and the same IT specialists from time to time set up web servers that actually work with HTTP.  But when you have to answer a specific question, a stupor regularly occurs. <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bp/ju/xh/bpjuxh6ykspocbergmj0gudlzck.jpeg"></div><br>  An information security analyst should master the technology in detail, knowing the nuances and subtleties.  If we don‚Äôt know how this or that technology should work, how can we figure out what‚Äôs wrong with it? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Also "injection" </h3><br>  I mentioned that validation of the input data should occur on the server, but not on the client.  Periodically, you can find input forms where individual elements are inactive.  And it is assumed that they will become active after certain conditions are met.  Or, for example, the username input field has a length of 7 characters, thus limiting the maximum username length.  All this is a very bad practice and this is why: elements on the page that have already been received can be arbitrarily edited before being sent, and without any special technical means.  In OWASP Mutillidae II, this can be seen in the example ‚ÄúOthers‚Äù&gt; ‚ÄúClient-side‚Äú security ‚ÄùControls‚Äù. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sx/_6/bx/sx_6bxtvnyzgw5ue6ypxbufje3a.png"></div><br>  Before us is a form, in the fields of which you need to enter a random number, this time it is 2056694312. The ‚Äúdifficulty‚Äù here is that the fields have limitations.  There is a ‚ÄúRead-only‚Äù field, where the number 42 cannot be replaced, there is a too short ‚ÄúShort text box‚Äù field, where our number simply does not fit, there is a disabled ‚ÄúDisabled Text Box‚Äù field that is inactive, and so on. <br><br>  In fact, the problem is solved very simply.  In the browser (in my case, this is Mozilla Firefox), go to the developer console (F12) and begin to inspect the form elements. <br><br>  For example, a read only field looks like this: <br><br><pre><code class="sql hljs">&lt;input HTMLandXSSInjectionPoint="1" type="text" name="readonly_textbox" id="id_readonly_textbox" size="15" maxlength="15" required="required" autofocus="autofocus" readonly="readonly" value="42" /&gt;</code> </pre> <br>  Delete readonly = ‚Äùreadonly‚Äù and voila: the form is writable, we can enter our number. <br>  In the next field, our value just does not fit, look at this element: <br><br><pre> <code class="sql hljs">&lt;input HTMLandXSSInjectionPoint="1" type="text" name="short_textbox" id="id_short_textbox" size="3" maxlength="3" required="required" /&gt;</code> </pre> <br>  Here we notice maxlength = ‚Äù3 ‚Ä≥.  Replace 3 by 333, now we can enter our number without fear that it will not fit. <br><br>  And this, by the way, is not only about input fields.  Similarly, you can change any items, such as check-boxes.  Page code looks like this: <br><br><pre> <code class="sql hljs">&lt;input type="checkbox" name="checkbox" id="id_checkbox" value="2056694312" required="required" disabled="disabled" /&gt;</code> </pre> <br>  It's quite simple here, let's replace the value values ‚Äã‚Äãwith our number, and now it will be sent when the user presses the button. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fb/kj/re/fbkjre3fzxictdcpq0g_xc3qvn4.jpeg"></div><br>  So, if you know how HTML is arranged, then it will not be difficult for you to fix this form so that you can enter all the necessary data there.  Just re-read the section about bike syndrome =) <br><br><h3>  Not just SQL </h3><br>  Injections are not always about databases.  By and large, from any form that does not filter incoming data, you can get some additional information.  In the example ‚ÄúApplication Log Injection‚Äù&gt; ‚ÄúDNS Lookup‚Äù there is a convenient form for DNS queries: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lk/hp/l3/lkhpl3ihhodx7dekynlqvgwgxxo.png"></div><br>  And indeed, if you enter an address there, for example, google.com, you will get all the necessary information: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fg/ym/kr/fgymkrbodw3u9blcwyyiulsjgby.png"></div><br>  However, the vulnerability is that in addition to the first valid command, we can enter something else.  For example, specify: <br><br><pre> <code class="sql hljs">google.com &amp;&amp; dir</code> </pre> <br>  and now the command output is much more interesting: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/39/1s/1p/391s1phcspuzjn-7wy0vvy5ykcc.png"></div><br>  We executed the query to the DNS server, but besides that, we executed the dir command and looked at what lies in the folder with our site.  It will not be difficult, combining different commands, to wander around the hard disk of the web server and look for what lies badly. <br><br>  Next time we will examine some more examples, and also see how you can automate your work. <br><br>  Read the blog of the author of the article at <a href="https://belowzero273.blog/">this link</a> . </div><p>Source: <a href="https://habr.com/ru/post/424205/">https://habr.com/ru/post/424205/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../424193/index.html">International Astronautical Congress - as it was in Australia</a></li>
<li><a href="../424197/index.html">Into the MVPs furnace, we introduce MVPr (minimum viable prototype)</a></li>
<li><a href="../424199/index.html">We build simple GraphQL API server on express and nodeJS</a></li>
<li><a href="../424201/index.html">How machine learning has helped me understand some aspects of early child development.</a></li>
<li><a href="../424203/index.html">Procedural building</a></li>
<li><a href="../424207/index.html">Reading with a pencil in hand</a></li>
<li><a href="../424209/index.html">Wireless Finesse: Snom A170 Headset Overview</a></li>
<li><a href="../424211/index.html">Understand the Container Storage Interface (in Kubernetes and not only)</a></li>
<li><a href="../424215/index.html">Elm. Comfortable and awkward</a></li>
<li><a href="../424217/index.html">Discourse on holy wars, and prayer for peace</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>