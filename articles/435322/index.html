<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Another Redux Boilerplate Reduction Guide (NGRX)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What are we talking about? 


 Let's talk about a few (five, to be specific) ways, tricks, bloody sacrifices to the god of enterprise, which are suppo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Another Redux Boilerplate Reduction Guide (NGRX)</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/n7/ws/br/n7wsbrphgkyoghehxfoydlcf5zq.jpeg"></p><br><h2 id="o-chem-poydet-rech">  What are we talking about? </h2><br><p>  Let's talk about a few (five, to be specific) ways, tricks, bloody sacrifices to the god of enterprise, which are supposed to help us write more concise and expressive code in our Redux (and NGRX!) Applications.  Ways suffered through coffee and sweat.  Please strongly kick and criticize.  We will learn to code better together. </p><a name="habracut"></a><br><p>  Honestly, I first just wanted to tell the world about my new micro-library (35 lines of code!) <a href="https://github.com/keenondrums/flux-action-class">Flux-action-class</a> , but looking at the ever-increasing number of exclamations that Habr will soon become Twitter, and for the most part agreeing with them, I decided to try to do some more capacious reading.  So, we meet 5 ways to pump your Redux app! </p><br><h2 id="boylerpleyt-vyhodi">  Boilerplate, come out </h2><br><p>  Consider a typical example of how to send an AJAX request to Redux.  Let's imagine that we really need a list of cats from the server. </p><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createSelector } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'reselect'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeCatsGetInit = <span class="hljs-string"><span class="hljs-string">'CATS_GET_INIT'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeCatsGetSuccess = <span class="hljs-string"><span class="hljs-string">'CATS_GET_SUCCESS'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeCatsGetError = <span class="hljs-string"><span class="hljs-string">'CATS_GET_ERROR'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionCatsGetInit = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: actionTypeCatsGetInit }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionCatsGetSuccess = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">payload</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: actionTypeCatsGetSuccess, payload, }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionCatsGetError = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: actionTypeCatsGetError, <span class="hljs-attr"><span class="hljs-attr">payload</span></span>: error, }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsInitialState = { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = reducerCatsInitialState, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> actionTypeCatsGetInit: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> actionCatsGetSuccess: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> actionCatsGetError: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...data, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeSelectorCatsData = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> createSelector( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.data, (cats) =&gt; cats, ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeSelectorCatsLoading = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> createSelector( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.loading, (loading) =&gt; loading, ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeSelectorCatsError = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> createSelector( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.error, (error) =&gt; error, )</code> </pre> <br><p>  <em>If you don‚Äôt really understand why you need factories for selectors, you can read about it <a href="https://redux.js.org/recipes/computing-derived-data">here.</a></em> </p><br><p>  <em>I deliberately do not consider side effects here.</em>  <em>This is a topic for a separate article full of teenage anger and criticism of the existing ecosystem: D</em> </p><br><p>  This code has several weak points: </p><br><ul><li>  Action factories are unique in their own right, but we still use action types. </li><li>  As we add new entities, we continue to duplicate the same logic for setting the <code>loading</code> flag.  The data that we store in <code>data</code> and their form can vary significantly from request to request, but the loading indicator ( <code>loading</code> flag) will be the same. </li><li>  The <code>switch</code> execution time is O (n) (well, <a href="https://stackoverflow.com/questions/4442835/what-is-the-runtime-complexity-of-a-switch-statement">almost</a> ).  By itself, this is not a very strong argument, because Redux, in principle, is not about performance.  It infuriates me more that for each <code>case</code> it is necessary to write a couple of extra lines of serving code, and that one <code>switch</code> cannot easily and beautifully be broken into several. </li><li>  Do we really need to store the error state for each entity separately? </li><li>  Selectors are cool.  Memoizirovanny selectors - cool double.  They give us an abstraction over our story, so that later we do not have to redo half of the application when changing the form thereof.  We will simply change the selector itself.  What does not please the eye is a set of primitive factories, which are needed only because of the peculiarities of the work of memoization in <a href="https://github.com/reduxjs/reselect">reselct</a> . </li></ul><br><h2 id="sposob-1-izbavlyaemsya-ot-ekshn-tipov">  Method 1: Getting rid of action types </h2><br><p>  Well, not quite.  Simply we will force JS to create them for us. </p><br><p>  Let us think for a second about why we need action types in general.  Well, obviously, in order to launch the necessary branch of logic in our reducer and change the application state accordingly.  The real question is, does a type necessarily have to be a string?  And what if we used classes and did <code>switch</code> on type? </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetInit</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetSuccess</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(responseData) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.payload = responseData } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetError</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(error) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.payload = error <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.error = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsInitialState = { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = reducerCatsInitialState, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.constructor) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetInit: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetSuccess: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetError: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...data, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } }</code> </pre> <br><p>  Everything seems to be cool, but there is one problem: we have lost the serialization of our action games.  These are no longer simple objects that we can convert to and from a string.  Now we rely on the fact that each action has its own unique prototype, which, in fact, allows such a construction, like a <code>switch</code> by <code>action.constructor</code> , to work.  You know, I really like the idea of ‚Äã‚Äãserializing my action games into a string and sending them along with a bug report, and I'm not ready to refuse it. </p><br><p>  So, every action should have a <code>type</code> field ( <a href="https://github.com/redux-utilities/flux-standard-action">here</a> you can see what else every action respecting action should have).  Fortunately, each class has a name that seems to be a string.  Let's add to each class a getter <code>type</code> that will return the name of this class. </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetInit</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.type = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.constructor.name } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetInit.name: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, } <span class="hljs-comment"><span class="hljs-comment">//... } }</span></span></code> </pre> <br><p>  It even works, but I would also like each type to stick a prefix, as Mr. Eric suggests in <a href="https://github.com/erikras/ducks-modular-redux">ducks-modular-redux</a> (I recommend looking at the fork <a href="https://github.com/alexnm/re-ducks">re-ducks</a> , which is even cooler, as for me).  In order to add a prefix, we have to stop using the name of the class directly, and add another getter.  Now static. </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetInit</span></span></span><span class="hljs-class"> </span></span>{ get <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> type () { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`prefix/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.name}</span></span></span><span class="hljs-string">`</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span> () { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.type = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.constructor.type } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetInit.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, } <span class="hljs-comment"><span class="hljs-comment">//... } }</span></span></code> </pre> <br><p>  Let's get the whole thing together a bit.  Minimize copy-paste and add one more condition: if the action is an error, then its <code>payload</code> should be of type <code>Error</code> . </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{ get <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> type () { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`prefix/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.name}</span></span></span><span class="hljs-string">`</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(payload) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.type = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.constructor.type <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.payload = payload <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.error = payload <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span> } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetInit</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetSuccess</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsInitialState = { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = reducerCatsInitialState, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetInit.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetSuccess.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetError.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...data, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } }</code> </pre> <br><p>  At this stage, this code works fine with NGRX, but Redux is not capable of chewing.  He swears that the action should be simple objects.  Fortunately, JS allows us to return almost anything from the constructor, and we really don‚Äôt really need a prototype chain after creating an action. </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{ get <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> type () { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">`prefix/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.name}</span></span></span><span class="hljs-string">`</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(payload) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.constructor.type, payload, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: payload <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span> } } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetInit</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetSuccess</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsInitialState = { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = reducerCatsInitialState, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetInit.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetSuccess.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetError.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...data, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } }</code> </pre> <br><p>  On the basis of the above considerations, a <a href="https://github.com/keenondrums/flux-action-class">micro-library flux-action-class</a> was written.  There are tests, 100% code coverage with tests and almost the same <code>ActionStandard</code> class seasoned with generics for TypeScript needs.  Works with both TypeScript and JavaScript. </p><br><h2 id="sposob-2-ne-boimsya-ispolzovat-combinereducers">  Method 2: We are not afraid to use combineReducers </h2><br><p>  The idea is simple to disgrace: use <a href="https://redux.js.org/api/combinereducers">combineReducers</a> not only for top-level reducers, but also to further partition the logic and create a separate reduction gear for <code>loading</code> . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerLoading = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">actionInit, actionSuccess, actionError</span></span></span><span class="hljs-function">) =&gt;</span></span> ( state = <span class="hljs-literal"><span class="hljs-literal">false</span></span>, action, ) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> actionInit.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> actionSuccess.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> actionError.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetInit</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetSuccess</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsData = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">undefined</span></span></span></span><span class="hljs-function"><span class="hljs-params">, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetSuccess.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> action.payload <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsError = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">undefined</span></span></span></span><span class="hljs-function"><span class="hljs-params">, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> CatsGetError.type: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> action.payload <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = combineReducers({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: reducerCatsData, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: reducerLoading(CatsGetInit, CatsGetSuccess, CatsGetError), <span class="hljs-attr"><span class="hljs-attr">error</span></span>: reducerCatsError, })</code> </pre> <br><h2 id="sposob-3-izbavimsya-ot-switch">  Method 3: Get rid of the switch </h2><br><p>  And again, an extremely simple idea: instead of <code>switch-case</code> use an object from which to select the desired field by key.  Access to an object's field by key is O (1), and it looks cleaner in my humble opinion. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> createReducer = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialState, reducerMap</span></span></span><span class="hljs-function">) =&gt;</span></span> ( state = initialState, action, ) =&gt; { <span class="hljs-comment"><span class="hljs-comment">//       const reducer = state[action.type] if (!reducer) { return state } //  ,    return reducer(state, action) } const reducerLoading = (actionInit, actionSuccess, actionError) =&gt; createReducer(false, { [actionInit.type]: () =&gt; true, [actionSuccess.type]: () =&gt; false, [actionError.type]: () =&gt; false, }) class CatsGetInit extends ActionStandard {} class CatsGetSuccess extends ActionStandard {} class CatsGetError extends ActionStandard {} const reducerCatsData = createReducer(undefined, { [CatsGetSuccess.type]: () =&gt; action.payload, }) const reducerCatsError = createReducer(undefined, { [CatsGetError.type]: () =&gt; action.payload, }) const reducerCats = combineReducers({ data: reducerCatsData, loading: reducerLoading(CatsGetInit, CatsGetSuccess, CatsGetError), error: reducerCatsError, })</span></span></code> </pre> <br><p>  Let's <code>reducerLoading</code> .  Now, knowing about the mapy (objects) for reducer, we can return this same map from <code>reducerLoading</code> , instead of returning a whole reducer.  Potentially, this opens up unlimited scope for expanding the functional. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> createReducer = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">initialState, reducerMap</span></span></span><span class="hljs-function">) =&gt;</span></span> ( state = initialState, action, ) =&gt; { <span class="hljs-comment"><span class="hljs-comment">//       const reducer = state[action.type] if (!reducer) { return state } //  ,    return reducer(state, action) } const reducerLoadingMap = (actionInit, actionSuccess, actionError) =&gt; ({ [actionInit.type]: () =&gt; true, [actionSuccess.type]: () =&gt; false, [actionError.type]: () =&gt; false, }) class CatsGetInit extends ActionStandard {} class CatsGetSuccess extends ActionStandard {} class CatsGetError extends ActionStandard {} const reducerCatsLoading = createReducer( false, reducerLoadingMap(CatsGetInit, CatsGetSuccess, CatsGetError), ) /*       reducerCatsLoading: const reducerCatsLoading = createReducer( false, { ...reducerLoadingMap(CatsGetInit, CatsGetSuccess, CatsGetError), ... some custom stuff } ) */ const reducerCatsData = createReducer(undefined, { [CatsGetSuccess.type]: () =&gt; action.payload, }) const reducerCatsError = createReducer(undefined, { [CatsGetError.type]: () =&gt; action.payload, }) const reducerCats = combineReducers({ data: reducerCatsData, loading: reducerCatsLoading), error: reducerCatsError, })</span></span></code> </pre> <br><p>  <a href="https://redux.js.org/recipes/reducing-boilerplate">The official documentation on Redux also talks about this approach</a> , however, for some unknown reason, I continue to see many projects using <code>switch-case</code> .  Based on the code from the official documentation, Mr. Moshe wrote down the library for <code>createReducer</code> for us. </p><br><h2 id="sposob-4-ispolzuem-globalnyy-obrabotchik-oshibok">  Method 4: Use the global error handler </h2><br><p>  We absolutely do not need to keep a mistake for each entity separately.  In most cases, we just want to show the dialogue.  The same dialog with dynamic text for all entities. </p><br><p>  Create a global error handler.  In the simplest case, it might look like this: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GlobalErrorInit</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GlobalErrorClear</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerError = createReducer(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, { [GlobalErrorInit.type]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> action.payload, [GlobalErrorClear.type]: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state, action</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, })</code> </pre> <br><p>  Then in our side effect we will send the <code>ErrorInit</code> action in a <code>catch</code> .  This might look something like this when using <a href="https://github.com/reduxjs/redux-thunk">redux-thunk</a> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> catsGetAsync = <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (dispatch) =&gt; { dispatch(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CatsGetInit()) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> res = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">'https://cats.com/api/v1/cats'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> body = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> res.json() dispatch(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CatsGetSuccess(body)) } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { dispatch(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CatsGetError(error)) dispatch(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GlobalErrorInit(error)) } }</code> </pre> <br><p>  Now we can get rid of the <code>error</code> field in our kitty store and use <code>CatsGetError</code> only to switch the <code>loading</code> flag. </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetInit</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetSuccess</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsLoading = createReducer( <span class="hljs-literal"><span class="hljs-literal">false</span></span>, reducerLoadingMap(CatsGetInit, CatsGetSuccess, CatsGetError), ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsData = createReducer(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, { [CatsGetSuccess.type]: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> action.payload, }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = combineReducers({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: reducerCatsData, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: reducerCatsLoading) })</code> </pre> <br><h2 id="sposob-5-dumaem-pered-memoizaciey">  Method 5: We Think Before Memoization </h2><br><p>  Let's look at the pile of factories for selectors again. </p><br><p>  <em>I threw out <code>makeSelectorCatsError</code> because it is no longer needed, as we found out in the previous chapter.</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeSelectorCatsData = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> createSelector( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.data, (cats) =&gt; cats, ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeSelectorCatsLoading = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> createSelector( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.loading, (loading) =&gt; loading, )</code> </pre> <br><p>  And why do we need memorized selectors here?  What exactly are we trying to memorize?  Accessing an object's field by key, which is what happens here, is O (1).  We can use ordinary non-memoisized functions.  Use memoization only when you want to change the data from the store before giving it to the component. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> selectorCatsData = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.data <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> selectorCatsLoading = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.loading</code> </pre> <br><p>  Memoization makes sense if you calculate the result on the fly.  For the example below, let's imagine that each cat is an object with a <code>name</code> field, and we want to get a string containing the names of all cats. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeSelectorCatNames = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> createSelector( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.data, (cats) =&gt; cats.data.reduce(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">accum, { name }</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${accum}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${name}</span></span></span><span class="hljs-string">`</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>), )</code> </pre> <br><h2 id="vyvod">  Conclusion </h2><br><p>  Let's look at what we started again: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createSelector } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'reselect'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeCatsGetInit = <span class="hljs-string"><span class="hljs-string">'CATS_GET_INIT'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeCatsGetSuccess = <span class="hljs-string"><span class="hljs-string">'CATS_GET_SUCCESS'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionTypeCatsGetError = <span class="hljs-string"><span class="hljs-string">'CATS_GET_ERROR'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionCatsGetInit = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: actionTypeCatsGetInit }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionCatsGetSuccess = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: actionTypeCatsGetSuccess }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> actionCatsGetError = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">type</span></span>: actionTypeCatsGetError }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsInitialState = { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = reducerCatsInitialState, action</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> actionTypeCatsGetInit: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...state, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> actionCatsGetSuccess: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">error</span></span>: <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, <span class="hljs-attr"><span class="hljs-attr">data</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> actionCatsGetError: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...data, <span class="hljs-attr"><span class="hljs-attr">error</span></span>: action.payload, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeSelectorCatsData = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> createSelector( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.data, (cats) =&gt; cats, ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeSelectorCatsLoading = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> createSelector( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.loading, (loading) =&gt; loading, ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> makeSelectorCatsError = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> createSelector( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.error, (error) =&gt; error, )</code> </pre> <br><p>  And what came to: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetInit</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetSuccess</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CatsGetError</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionStandard</span></span></span><span class="hljs-class"> </span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsLoading = createReducer( <span class="hljs-literal"><span class="hljs-literal">false</span></span>, reducerLoadingMap(CatsGetInit, CatsGetSuccess, CatsGetError), ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCatsData = createReducer(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>, { [CatsGetSuccess.type]: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> action.payload, }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> reducerCats = combineReducers({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: reducerCatsData, <span class="hljs-attr"><span class="hljs-attr">loading</span></span>: reducerCatsLoading) }) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> selectorCatsData = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.data <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> selectorCatsLoading = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> state.cats.loading</code> </pre> <br><p>  I hope you did not waste your time, and the article was just a little useful to you.  As I said at the very beginning, please strongly kick and criticize.  We will learn to code better together. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/435322/">https://habr.com/ru/post/435322/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435310/index.html">Widevine L3 DRM protection hacked</a></li>
<li><a href="../435312/index.html">Electric Polestar 2 - the first electric car with native Android Android OS</a></li>
<li><a href="../435314/index.html">‚ÄúYou know what's best ‚Äî do it better‚Äù: a new podcast about the mix of work and the hobby of an editor / marketer</a></li>
<li><a href="../435316/index.html">Korean scientists have created a system for tracking road traffic from two laptops</a></li>
<li><a href="../435320/index.html">Faster and more accurate: a hybrid system of heterogeneous qubits</a></li>
<li><a href="../435324/index.html">Tesla starts building a factory in Shanghai, but the situation in the company is complicated</a></li>
<li><a href="../435326/index.html">Videoconferencing systems market overview</a></li>
<li><a href="../435328/index.html">How to work with Shader Graph in Unity3D</a></li>
<li><a href="../435330/index.html">Cisco DevNet as a learning platform, opportunities for developers and engineers</a></li>
<li><a href="../435332/index.html">I hate the keyboard</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>