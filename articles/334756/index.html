<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Python Click Generator for Data Engineer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The process of developing an educational program is very similar to the process of developing a new product. And there, and there you try first to und...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Python Click Generator for Data Engineer</h1><div class="post__text post__text-html js-mediator-article">  The process of developing an educational program is very similar to the process of developing a new product.  And there, and there you try first to understand, and is there a demand for what you are going to produce?  Is there really a problem you want to solve? <br><br><h3>  Prehistory </h3><br>  This time it was pretty easy for us.  Several graduates of our Big Data Specialist program for probably a year asked for: <br><blockquote>  Make for us another program where we could learn to work with Kafka, Elasticsearch, and various Hadoop ecosystem tools to collect data pipelines. </blockquote><br>  Then the employers began to ‚Äúfly in‚Äù requests, which can be collectively described as: <br><blockquote>  Data Engineers are very hot jobs! <br>  In reality, we have not been able to close them for half a year. <br>  It's great that you paid attention to this specialty.  Now the market has a very large bias towards Data Scientists, and more than half of the project work is engineering. </blockquote><br>  From this moment it became clear that there is demand, and the problem exists.  We must rush into the development of the program! <br><a name="habracut"></a><br>  An interesting point in the development of an educational program is that you do not validate it with a direct potential client.  Well, imagine, we approach a person who would like to learn from us, and ask: ‚ÄúIs this what you need?‚Äù And he has no idea at all, because he doesn‚Äôt understand it yet. <br><br>  Therefore, the program should be validated, firstly, for those who understand this - real data engineers;  secondly, employers - after all, they are the final consumers of our product. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After talking with six engineers, some of whom are involved in hiring employees in a team, it became very quickly clear what the main essence of such a person‚Äôs work is, and what tasks such a person should be able to solve. <br><br><h3>  Program </h3><br>  The essence of the work of the engineer‚Äôs date is to be able to create pipelines from data, monitor them and troubleshoot, as well as solve one-time ad-hoc tasks on uploading and transforming data. <br><br>  Specifying, it turned out that he should be able to: <br><br><ol><li>  Collect raw data </li><li>  Work with queues and configure them </li><li>  Run Jobs with data processing (including ML) on a schedule </li><li>  Configure BI </li><li>  Work with relational databases </li><li>  Work with noSQL </li><li>  Work with tools for real-time processing </li><li>  Use command-line tools </li><li>  Work competently with the environment </li></ol><br>  In each of these points you can write a number of different tools.  There is even a <a href="http://xyz.insightdataengineering.com/blog/pipeline_map/">beautiful visualization</a> on this topic.  It was impossible and necessary to cover all of them in the program, so we decided that it was enough for a person to get experience in creating one batch and one real-time pipeline.  The rest, if necessary, he will independently master in the future. <br><br>  But it is important that he learn how to do the ‚Äúfrom and to‚Äù pipeline so that there is not a single white spot in the process.  And then there was a problem for us, as the organizers. <br><br><h3>  Click Generator </h3><br>  We stopped at the fact that our participants will analyze the clickstream.  And we have to figure out how we will generate it directly to them on the sites.  The prerequisites for such a decision are as follows: <br><br><ol><li>  Since one of the pipelines must be real-time, static ready datasets are not suitable for us, we need to somehow generate data also in real-time, </li><li>  Since we decided that participants should build a ‚Äúfrom and to‚Äù pipeline, this means that they should collect data directly from the site, as they would in real life. </li></ol><br>  Great, it remains to think of how.  Part of the date engineers suggested that you can look towards the tools for testing the site - for example, <a href="https://habrahabr.ru/post/248559/">Selenium</a> .  The part even made a clarification that it is better to use <a href="https://en.wikipedia.org/wiki/PhantomJS">PhantomJS</a> inside it, since it is ‚Äúheadless‚Äù, which means it will be faster. <br><br>  We took their advice and wrote their own user emulator for our member sites.  The very not-so-what-code below (important: we will give the same site to everyone, so we can use specific search parameters in the code, knowing the structure of this site): <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> webdriver <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium.webdriver.common.keys <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Keys <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> selenium.webdriver.common.desired_capabilities <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DesiredCapabilities <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> numpy.random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> choice <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np dcap = dict(DesiredCapabilities.PHANTOMJS) dcap[<span class="hljs-string"><span class="hljs-string">"phantomjs.page.settings.userAgent"</span></span>] = (<span class="hljs-string"><span class="hljs-string">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 YaBrowser/17.6.1.745 Yowser/2.5 Safari/537.36"</span></span>) driver = webdriver.PhantomJS(desired_capabilities=dcap) driver.set_window_size(<span class="hljs-number"><span class="hljs-number">1024</span></span>, <span class="hljs-number"><span class="hljs-number">768</span></span>) hosts = [<span class="hljs-string"><span class="hljs-string">"35.190.***.***"</span></span>] keywords = {<span class="hljs-string"><span class="hljs-string">"music"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"grammar"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>} conformity = <span class="hljs-number"><span class="hljs-number">0.9</span></span> condition = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">user_journey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(host, journey_length, keywords, user_type, conformity)</span></span></span><span class="hljs-function">:</span></span> driver.get(<span class="hljs-string"><span class="hljs-string">"http://"</span></span> + host) el = driver.find_element_by_link_text(<span class="hljs-string"><span class="hljs-string">""</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   journey   el.click() print driver.current_url for i in xrange(journey_length): try: links = [] the_links = [] p = 0 P = [] links = driver.find_elements_by_class_name("b-ff-articles-shortlist__a") #    url   if len(links) == 0: links = driver.find_elements_by_class_name("b-ff-mobile-shortlist__a") #    ,    if len(links) == 0: links = driver.find_elements_by_class_name("b-ff-articles-tags__a") #     ,    links[0].click driver.current_url the_links = driver.find_elements_by_partial_link_text(keywords.get(user_type)) #   url,   the_link = choice(the_links, 1)[0] #      url links.append(the_link) #        p = (1-conformity)/float(len(links)-1) #      url,  ,        conformity P = [p]*len(links) #         P[-1] = conformity #    'the link'    conformity l = choice(links, 1, p=P) #         time.sleep(np.random.poisson(5)) #      l[0].click() print driver.current_url except: driver.close #  ,  -    while condition == 1: for host in hosts: journey_length = np.random.poisson(5) user_type = choice(keywords.keys(), 1)[0] print user_type user_journey(host, journey_length, keywords, user_type, conformity)</span></span></code> </pre> <br>  What have we done?  We generate users of different types.  Here are two (in fact, more of them): a music lover and a person who wants to understand the grammar.  Type selection is randomly selected. <br><br>  Inside the type, we also implemented an element of randomness: a user of the same type will not follow the same links that we would directly use, and the link will be selected randomly from a subset of the ‚Äúcorrect‚Äù links + there is also an element of randomness when the user gets to ‚Äú wrong links.  This was done because in the future, participants will analyze this data and try to somehow segment these users. <br><br>  In addition, to make it look straightforward like real user behavior, we implemented random timeout on the page.  And this gun shoots until we stop it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/8da/b4f/9c7/8dab4f9c702746be9e88b0d71446986f.gif"></div><br>  The only thing that a group of 20-30 people with such a gun can not be quickly processed, so we decided to run this script through <a href="https://www.gnu.org/software/parallel/">gnu parallel</a> .  This line allows you to run our script in parallel on all available kernels: <br><br><pre> <code class="bash hljs">$ parallel -j0 python ::: cannon.py</code> </pre> <br><h3>  Total </h3><br><ol><li>  Each participant raises the site we have issued using nginx. </li><li>  Sends us the ip-address of your server. </li><li>  Implements on all pages of your site javascript to collect clicks. </li><li>  Collects data arriving from our gun on his website. </li><li>  Sends to Kafka. </li><li>  Well, then on the pipeline ... </li></ol><br>  So the project begins, on which he will work for 6 weeks on <a href="https://goo.gl/2zxBzW">the Data Engineer program</a> . </div><p>Source: <a href="https://habr.com/ru/post/334756/">https://habr.com/ru/post/334756/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334744/index.html">As we multiplayer for NFS MW wrote</a></li>
<li><a href="../334748/index.html">6 reasons why real estate automation requires breaking stereotypes</a></li>
<li><a href="../334750/index.html">5 easy ways to mess up a font</a></li>
<li><a href="../334752/index.html">Contra, Battledods and Mortal Kombat in one box. The story of how I made a slot machine and put it in the office</a></li>
<li><a href="../334754/index.html">Series of webinars on the SAP Cloud Platform and PaaS Market</a></li>
<li><a href="../334760/index.html">Javascript as a phenomenon</a></li>
<li><a href="../334762/index.html">Business of Software Europe - conference about IT business (almost) without Growth Hacks</a></li>
<li><a href="../334764/index.html">The fate of programmers in the Russian Federation or how to leave the city of Ensk</a></li>
<li><a href="../334766/index.html">About "Elegant Objects" and Evangelicals</a></li>
<li><a href="../334770/index.html">Kubernetes success stories in production. Part 2: Concur and SAP</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>