<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Engineer's Philosophy or Fighting Computer Viruses</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The gift of invention affected many people. And the "cocktail" inventiveness + talent + education in the person of one person, in general, can shift h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Engineer's Philosophy or Fighting Computer Viruses</h1><div class="post__text post__text-html js-mediator-article">  The gift of invention affected many people.  And the "cocktail" inventiveness + talent + education in the person of one person, in general, can shift human activity to a completely new level.  And if this person still has leadership qualities and charisma ... Damn, something was unrealized. <br><br>  In short, for the engineer-inventor from a philosophical point of view there are only two ways: <ol><li>  Constructive; </li><li>  Destructive. </li></ol>  Both ways imply the creation of something new, but in the first case, the result of inventive activity is beneficial, in the second - for the purpose of destruction. <br><br>  Programmers are also inventors, possessing certain knowledge, as well as talent, they can single-handedly move the information sphere of humankind to a qualitatively new level.  There is no need to go far for examples.  Only one person, the well-known Mark Zuckerberg, changed the way people communicate on computer networks, creating a solution that we know as <a href="http://www.facebook.com/">Facebook</a> .  His success spawned many clones, including in the Russian segment of the Internet. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  For myself, I chose a constructive path of development.  My crossroads was, in my opinion, in the second year.  Before that, I was engaged in all sorts of hacks, I read Hacker magazine.  At the university, in computer labs, I didn‚Äôt give rest to the teachers with my antics, and as I was having fun in the SWAMP network [MIET computer hostel network] is a separate song.  Once I was even imposed some sanctions on me, so I met common admins. <br><br>  Now I am only developing and improving software for various purposes, both at work and in the form of a hobby.  Recently, I have been helping to "cure" computers from various viruses and give recommendations to ALL my friends about computer security, although I am not an expert in security. <br><br>  So, virus writers are the same programmers, only the development path they chose was destructive, in my opinion.  Although if you look at their activities from a different angle, you can say that they are like software ‚Äúorderlies‚Äù: they find ‚Äúholes‚Äù, ‚Äúbugs‚Äù and use them for their own purposes.  It is also worth noting some kind of wrestling between the two "camps".  Some people laugh at the fact that the software is "full of holes", others without any problems create patches and continue to improve their creation. <br><br>  I have a biased attitude towards virus writers, I imagined them as zadro students who accidentally discovered a ‚Äúhole‚Äù and somehow tried to use it.  A month ago, I changed my mind about them.  Then, late in the evening a good acquaintance called me and just asked for help.  Her computer was locked, and a message appeared on the screen about the need to send an SMS to a number.  The WinLock virus, the first thing that occurred to me and when I arrived - I was not mistaken.  But I confess, I have a good brain sweat to clean the system, because the antivirus did not recognize the infection that my friend picked up on the Internet. <br><br>  On Sunday, I went again, to another friend, and also cleaned her computer from viruses.  Her complaint was that the speed on the Internet has plummeted.  She did not have antivirus, but she was always neat on the network.  I came, I was amazed at what I found.  I have already brought with me a "set" for the extraction of infection.  Below is my humble research system and it is clean by hand: <br><br>  <b>1.</b> It was necessary to find the source of intense network activity.  To do this, I put the Firewall and I immediately hung up the system.  The standard explorer.exe process was modified, and immediately opened about 5,000 connections to remote computers.  Firewall, analyzing the number of connections, just hung up the operating system.  To find out with which remote computers the infected had established connections, I had to go another way. <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/51a/dc8/079/51adc8079c30727411e3c6903e4d8eff.jpg"></a> <br>  <b>2.</b> <a href="http://technet.microsoft.com/en-us/sysinternals/bb896653">Process Explorer</a> is a small utility for programmers, but really helps in the analysis of running processes.  On the tab, with the analysis of TCP / IP connections, I found that the process opens UDP port 21810 and waits for a connection from any remote computer that is also infected.  That is why our Firewall has detected almost 5,000 connections. <br><img src="https://habrastorage.org/getpro/habr/post_images/8ad/9d5/998/8ad9d59984ac6c3084572dd6e40ced83.jpg"><br>  <b>3.</b> Further easier.  We ask Google what network activity is.  Google knows everything and 4 entries in the search - information from the database Dr.  Web about Trojan: <br><img src="https://habrastorage.org/getpro/habr/post_images/056/d61/5fc/056d615fc82f5c1af4a808cc6af50f29.jpg"><br>  <b>4.</b> Follow the <a href="http://vms.drweb.com/virus/%3Fi%3D1488477">link</a> to the Dr.Web anti-virus library.  After seeing the full information about the alleged infection, I can safely say that the guys who write antiviruses do not just eat their bread.  From the library we take out the following data: <br>  * A new virus has been added to the antivirus library. 2011-10-07 <br>  * All potential virus activity and traces <br>  <b>5.</b> It would be worthwhile to install an antivirus and, perhaps, it would remove the virus, but I noticed, having opened the corresponding key in the registry editor, another arrangement of the traces of the virus program: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/8ae/68b/b6d/8ae68bb6d5272cc4bf1b43e99a87b483.jpg"></a> <br>  <b>6.</b> To find this place on the hard disk, I decided to use Far, and not the infected application explorer.exe itself (in the Russian version of Explorer).  Suspicions were on the topic of self-safety of the virus program.  For example, as soon as I would open the directory where the traces of the virus program lie, the virus program would quietly copy to another directory on the hard disk or something like that.  Here it is, the directory with the contents: <br><img src="https://habrastorage.org/getpro/habr/post_images/281/a76/bdc/281a76bdca1d918f76b124dc4a380c50.jpg"><br>  <b>7.</b> Further analysis showed the absence of entries in the registry of services: <br><br><ul><li>  [&lt;HKLM&gt; \ SYSTEM \ ControlSet001 \ Services \ a72a1ac3] 'ImagePath' = '% WINDIR% \ 3273271975: 1490412860.exe' </li><li>  [&lt;HKLM&gt; \ SYSTEM \ ControlSet001 \ Services \ .i8042prt] 'ImagePath' = '\?' </li></ul>  and disk files: <ul><li>  % WINDIR% \ $ NtUninstallKB16918 $ \ 2804554435 \ L \ acbrwqkz </li><li>  % WINDIR% \ $ NtUninstallKB16918 $ \ 2804554435 \ @ </li><li>  % WINDIR% \ 3273271975: 1490412860.exe </li></ul>  I concluded that the virus program was not fully installed, or seriously modified. <br>  <b>8.</b> Trying to remove Far'om traces of infection.  It does not work, some kind of running application blocks access to the directory for us: <br><img src="https://habrastorage.org/getpro/habr/post_images/a3e/f75/8b3/a3ef758b3cc7863f6cf0392be0dbc00a.jpg"><br>  <b>9.</b> We begin to study the processes of the <a href="http://technet.microsoft.com/en-us/sysinternals/bb896645">Process Monitor</a> utility in order to determine which of them "keeps" access to the directory with the infection.  We start our monitor, the activity is very large, so you need to create a filter to display only the activity that blocks access to our directory with infection: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/575/aee/d75/575aeed75689f14a596670125902cd13.jpg"></a> <br>  <b>10.</b> It can be seen that all activity comes from the "infected" process <i><b>explorer.exe</b></i> with PID 29.2, and pay attention to the lines from the Dr.Web library: <br><br>  <b>Malicious functions:</b> Implements code in the following system processes: <br><ul><li>  &lt;SYSTEM32&gt; \ winlogon.exe </li><li>  % WINDIR% \ Explorer.EXE </li></ul>  This tells us that the original files from the distribution of the operating system have been modified. <br>  <b>11. We</b> kill the <i><b>explorer.exe</b></i> process and delete the infected files, replacing them from the distribution with the original ones.  Then we delete our catalog with traces of infection. <br>  <b>12.</b> As a final touch, we restore the registry entry, which is responsible for loading the explorer into <i><b>Winlogon</b></i> <br>  Modify the following registry key: <ul><li>  [&lt;HKCU&gt; \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Winlogon] 'Shell' = '&lt;LS_APPDATA&gt; \ f7f5d2a7 \ X' </li></ul>  same value as: <ul><li>  [&lt; <b>HKLM</b> &gt; \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Winlogon] 'Shell' key values </li></ul>  Or delete it if value <ul><li>  [&lt; <b>HKLM</b> &gt; \ Software \ Microsoft \ Windows NT \ CurrentVersion \ Winlogon] key values ‚Äã‚Äã'Shell' = "explorer.exe" </li></ul><br>  <b>13.</b> Everything!  Reboot and check network activity with Firewall and make sure everything is calm. <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/f81/26d/175/f8126d175f2b365f531bc22b0c4f39c4.jpg"></a> <br>  And there are no open connections from our explorer.exe <br><img src="https://habrastorage.org/getpro/habr/post_images/06c/cf9/71b/06ccf971b788760d063402bedd9d5929.jpg"><br>  <b>14.</b> System cleared <br><br>  For those who are particularly inquisitive, it would be possible to analyze the traffic exchanged between the virus explorer.exe and remote computers using tcpdump and the <a href="http://en.wikipedia.org/wiki/Wireshark">wireshar</a> application. <br><br>  So, back to the header.  Philosophical ways: creation is a constructive way, and destruction - destructive ways - these are at the heart of even radically different ways of development of engineers.  How to choose - everyone's business! </div><p>Source: <a href="https://habr.com/ru/post/130628/">https://habr.com/ru/post/130628/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../130618/index.html">Video review of Android applications and games - kedDroid</a></li>
<li><a href="../130620/index.html">Wallet One in Kazakhstan</a></li>
<li><a href="../130621/index.html">What architecture MK do you use / plan to use in work / training / for a hobby?</a></li>
<li><a href="../130623/index.html">5 reasons to upgrade to Subversion 1.7</a></li>
<li><a href="../130625/index.html">Did you cancel the Alpha-Check service from the ended cards in Alfa-Bank?</a></li>
<li><a href="../130629/index.html">Cancel the transition to "winter" time</a></li>
<li><a href="../130630/index.html">Happiness, Farmer!</a></li>
<li><a href="../130634/index.html">At windows.php.net/download, PHP 5.3 assemblies are made VC9, and Apache from apache.org needs VC6</a></li>
<li><a href="../130635/index.html">"Cryptocurrency" is rapidly becoming cheaper</a></li>
<li><a href="../130636/index.html">Logitech M525 wireless mouse can run for three years with a pair of batteries</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>