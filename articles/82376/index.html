<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>HTML5, Theora and everything all everything ... (practice)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I saw a lot of articles here about HTML5, Theora and the video tag, but for the most part they revolve around theory. Recently on my site MJV-ART.ORG ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>HTML5, Theora and everything all everything ... (practice)</h1><div class="post__text post__text-html js-mediator-article">  I saw a lot of articles here about HTML5, Theora and the video tag, but for the most part they revolve around theory.  Recently on my site <a href="http://mjv-art.org/%3Flang%3Dru">MJV-ART.ORG - Anime Wallpaper</a> I opened the section <a href="http://mjv-art.org/jvvideo/view_posts/0%3Flang%3Dru">JV-Video</a> which is a small video hosting ala Youtube on anime theme based on HTML5 / Theora.  Actually, I now want to talk about the problems that I have. <br><a name="habracut"></a><br><h4>  Browsers </h4><br>  Although the main browsers seem to support HTML5 and Theora, but usually with a fair amount of curvature.  The most normal browser is still FireFox, but it also has enough glitches and oddities and therefore we will start with it. <br><br><h6>  Firefox </h6><br><ul><li>  In the first versions of the 3.5 branch, I did not perceive Aspect exposed in the ogg container, in recent versions of 3.5 this was fixed.  Because of this, the picture dispersed especially when transcoding mpg files. </li><li>  FireFox 3.5. * Does not accept in the video / audio tags an indication of the display of the control menu via controls = "controls" (as written in the standard), you must use controls = "true".  In branch 3.6, this has already been fixed. </li><li>  FireFox 3.5. * Refused to play a little ‚Äúnot correct‚Äù files which had ‚Äú[theora @ 0xac90c0] Missing extradata!‚Äù.  In 3.6, this problem was solved. </li><li>  In some videos, the sound is completely strange.  This is both in 3.5 and in 3.6. </li><li>  Often the sound is late and the audio / video goes separately.  And often such a rassinhron reaches 20 seconds, sometimes immediately, and sometimes in the middle of the track. </li><li> Only in version 3.6 there was an opportunity to watch in full screen.  Before that, you need to use the JS hack (the code is very simple and stupid): <br> <code>document.getElementById('video_post').style.position='absolute'; <br> document.getElementById('video_post').style.left=0; <br> document.getElementById('video_post').width=window.innerWidth; <br> return false; <br></code> <br></li></ul><br><br><h6>  Chrome </h6><br>  I will say right away, everything is fine in Chrome3 under Windows, in any case we didn‚Äôt find any problems, but we didn‚Äôt test it so much.  All the main claims are against Chromium from 4 branches which is now available for all major OS. <br><ul><li>  The main problem of Chromium 4 and 5 (Linux) is that the control menu (controls) does not work with it, the video sticks to the middle and goes into an endless loop.  If anyone is interested in this bug: <a href="http://code.google.com/p/chromium/issues/detail%3Fid%3D26036">code.google.com/p/chromium/issues/detail?id=26036</a> .  It is possible in Windows or MacOSX versions of this bug no.  On my website, I define version 4 of chrome and disable controls, and instead insert the following code: <br> <code>document.getElementById('video_post').play();return false;</code>  To play. <br> <code>document.getElementById('video_post').pause();return false;</code>  For pause. <br> <code>document.getElementById('video_post').controls='true';return false;</code>  To enable contorls. <br>  These pieces can be inserted into onlick for a, img and other tags.  The use of such "pieces" makes it possible to watch videos with minimal control and check the controls at the next sync with SVN. <br></li><li>  Sometimes the video does not work completely or only the sound works. </li><li>  There is no full screen mode, you must also use the JS code, which I quoted above. </li><li>  There is no bilinear or similar filtering with resize because of this, pixels are visible. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Safari </h6><br>  Theora turns on only after you install <a href="http://xiph.org/quicktime/">the QuickTime plugin,</a> but after that everything works perfectly, this is the most problematic browser, although Theora is not built into it.  Fullscreen is not present and as usual JS helps. <br><br><h6>  Opera </h6><br>  All stable versions do not see the video tag, but before alpha version 0.50_pre6177 (linux) already plays a video but with its own problems: <br><ul><li>  The slider does not work in controls.  Play and Pause work. </li><li>  The video periodically jerks as if it is slowing down (at the same time the processor is not loaded) it is very similar that they do not use double buffer. </li></ul><br><br><h6>  QtWebkit </h6><br>  Browsers based on QtWebkit can play audio poorly (without video) if Gstreamer is enabled in Phonone under Linux, everything is bad enough with Xine. <br><br><h6>  Gtkwebkit </h6><br>  Did not check if anyone can then share!  Very interesting. <br><br><h4>  Coding </h4><br>  I did not go very far and used ffmpeg2theora.  After quite a long experiment, we found the most appropriate encoding parameters that produced no worse quality than youtube: <code>ffmpeg2theora --speedlevel 0 --optimize -S 0 -v 6 -a 3 -x 480 -H 44100</code> . <br>  For coding purposes, Gstreamer could still be used, but I plan to perform such experiments in the future. <br>  So what were the problems with this: <br><ul><li>  In versions prior to 0.25, Aspect was often not quite rightly torn out (or, more precisely, simply ignored), and this problem exists regardless of the problems with Aspect from FireFox. </li><li>  MP4!  Tolley container absolutely stupid whether the programs that make it stupid.  But in the end, .mp4 is recorded for video by one FPS (which honestly takes ffmpeg2theora), and in the video stream itself another one is used.  Because of this, there is a video / audio rassinhron.  It helps to treat such videos (but not always!) .Mp4 parsing and rebuilding using standard Linux utilities.  A player like mplayer uses the information from mp4 for the first seconds of playing a ‚Äúbroken‚Äù mp4 file, but then it is quickly synchronized according to the information from the video stream. </li><li>  I did not want to load the server yet with coding in Theora and therefore I created a very simple system of distributed coding.  A folder is created on the server with a directory structure (pre_buf, pre, proc, err, out) and is mounted on NFS by those computers that must encode the video.  When the video is uploaded to the server, it will be made in a separate folder in pre_buf after the final upload, transferred to the pre in one fell swoop.  On processing machines, there is a script that works according to the ‚Äúkrone‚Äù which finds the first folder in the pre folder and transfers (if it works and it is not late) to the proc folder and then the processing begins.  The result is placed in the out folder or err (for errors).  On the server, the ‚Äúout‚Äù and ‚Äúerr‚Äù folders are also viewed in ‚Äúcrown‚Äù and the database is being edited, and the out of the folders are transferred to their public place.  Thus, it is possible to easily unload the main server. </li></ul><br><br><h4>  Web server. </h4><br>  As it turned out, not every bundle allows you to normally provide video for viewing.  At first, I used lighttpd-scgi-python / Pylons and the video was practically not played (there were jerks, artifacts, etc.) as a result I rendered all static files into a separate domain and implemented access directly through lighttpd.  Here with Lighttpd (which also uses Youtube) directly everything turned out as it should.  In addition, there is still the possibility that ogv, oga, ogg are not in mime-types of lighttpd - then they need to be added there. <br><br>  It seems I have not forgotten anything :) and I hope this article will help you navigate the current problems of HTML5-video / Theora. </div><p>Source: <a href="https://habr.com/ru/post/82376/">https://habr.com/ru/post/82376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../82370/index.html">New version of the editor of interactive video iVideo Editor</a></li>
<li><a href="../82371/index.html">IFPI lost the case against Baidu search engine</a></li>
<li><a href="../82372/index.html">Print: moving along the Z axis</a></li>
<li><a href="../82374/index.html">Lookalike.me - service for people like you or your friends</a></li>
<li><a href="../82375/index.html">Catalog of online stores in Belarus</a></li>
<li><a href="../82380/index.html">Add Javascript to XSLT</a></li>
<li><a href="../82381/index.html">Render on a remote machine using the Dropbox & Mail bundle</a></li>
<li><a href="../82383/index.html">IR remote control</a></li>
<li><a href="../82384/index.html">MSI WIND U90 3G</a></li>
<li><a href="../82385/index.html">In the depths of yourself ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>