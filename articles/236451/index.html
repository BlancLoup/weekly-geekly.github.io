<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Scripts for the editor in Unity3D</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we will talk about how to write scripts for Unity Editor. The article is intended for those who are already familiar with Unity3D, managed to do...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Scripts for the editor in Unity3D</h1><div class="post__text post__text-html js-mediator-article">  Today we will talk about how to write scripts for Unity Editor.  The article is intended for those who are already familiar with Unity3D, managed to do something, but had not yet decided to try writing scripts for the editor. <br><br>  In short, in the editor mode, scripts can do absolutely everything the same as in the game mode. <br><br>  Let's start with the simple.  Suppose we want to create 10 cubes in editorial mode and arrange them in a line.  First, let's simplify the task and forget about the editor, let's make these cubes be created when the application starts. <br><a name="habracut"></a><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CreateCubes</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Use this for initialization void Start () { Create10Cubes(); } private void Create10Cubes() { Vector3 position = new Vector3(0, 0, 0); for (int i = 0; i &lt; 10; i++) { GameObject cube = GameObject.CreatePrimitive(PrimitiveType.Cube); cube.transform.position = position; position += new Vector3(5, 0, 0); } } }</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now we will try to execute this code in editor mode. To do this, add just one magic attribute [ContextMenu ()] to the Create10Cubes () function: <br><br>  so that the code looks like this: <br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">ContextMenu(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CreateCubes"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Create10Cubes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Vector3 position = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>; i++) { GameObject cube = GameObject.CreatePrimitive(PrimitiveType.Cube); cube.transform.position = position; position += <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Vector3(<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } }</code> </pre><br><br><img src="//habrastorage.org/files/a3d/1b3/e08/a3d1b3e08f544f7fbacfbd7d46caccb8.png"><br><br>  Now, if we right-click on the script header, the CreateCubes item will appear there, when clicked, the function will also be executed exactly. <br><br>  Important note: the function marked with the ContextMenu attribute should not have parameters, or rather, if it has parameters, you cannot call it this way. <br><br>  Personally, I use this method when you need to do something with a group of objects, for example, to turn off the casting of shadows for all children of an object who have ‚Äúwithoutshadow‚Äù in the name: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">ContextMenu(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"DisableCastShadows"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DisabeCastShadows</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Renderer[] renderers = GetComponentsInChildren&lt;Renderer&gt;() .Where(x =&gt; x.name.Contains(<span class="hljs-string"><span class="hljs-string">"withoutshadow"</span></span>)) .ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> renderers) { r.castShadows = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre><br>  In general, the method is good for one-time actions on a bunch of objects - quickly threw the necessary code in a separate class, threw it on the desired object and immediately removed this class to the edren fen. <br><br>  Now let's solve the following problem: we want to bake occlusion culling.  To do this, we need to tick Occluder Static with all objects that block other objects, and with Occludee Static tick all that will be hidden behind Occluder `s.  That is, we need to isolate all static objects, put both daws (actually everything) to opaque scopes, only Occludee should be transparent, and Occluder to turn off. <br><br>  It would seem, well, such a thing, ran around the scene with handles - put up someone who needs ticks - that's all.  But the problem is that there can be a lot of objects in the scene and in the course of the project development the scene is likely to change.  Watch yourself for all these checkmarks - you can go crazy.  Therefore, we will write a little scriptic that does it for us. <br><br>  To begin with, we will write a useful code that does our work, and then we arrange it into a separate wizard: <br><br><img src="//habrastorage.org/files/7c7/006/dfa/7c7006dfab3040ce9221446f33a7cb9d.png"><br><br>  There are two tasks here: <br><br>  1) Find objects of interest to us in the scene; <br>  2) Place the necessary checkboxes. <br><br>  Let's make the code in the form of a separate command, so that it can be called from any place and it does not depend on which wizard you call it.  Attention: the file containing the following code must be placed in a folder called Editor, this is necessary so that this code does not fall into the main build: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEditor; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SetStaticOclluderFlagsCmd</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> TransparentQueue = <span class="hljs-number"><span class="hljs-number">3000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> OverlayQueue = <span class="hljs-number"><span class="hljs-number">4000</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Execute</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> scene =Object.FindObjectsOfType(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(GameObject)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> transparents = scene.Where(o =&gt;IsStatic(o) &amp;&amp; IsTransparent(o)).ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> occluders = scene.Where(o =&gt; IsStatic(o) &amp;&amp; !IsTransparent(o)).ToArray(); SceneModeUtility.SetStaticFlags(transparents, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)StaticEditorFlags.OccluderStatic, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); SceneModeUtility.SetStaticFlags(transparents, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)StaticEditorFlags.OccludeeStatic, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); SceneModeUtility.SetStaticFlags(occluders, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)StaticEditorFlags.OccluderStatic, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); SceneModeUtility.SetStaticFlags(occluders, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)StaticEditorFlags.OccludeeStatic, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); Debug.Log(<span class="hljs-string"><span class="hljs-string">"SetStaticOclluderFlagsCmd done"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsStatic</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Object obj</span></span></span><span class="hljs-function">)</span></span> { GameObject gameObject = obj <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GameObject; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gameObject == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GameObjectUtility.AreStaticEditorFlagsSet(gameObject, StaticEditorFlags.BatchingStatic); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsTransparent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Object obj</span></span></span><span class="hljs-function">)</span></span> { GameObject gameObject = obj <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GameObject; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gameObject == <span class="hljs-literal"><span class="hljs-literal">null</span></span> ||gameObject.renderer == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> obj.renderer.sharedMaterials.Any(x =&gt; x.renderQueue &gt;= TransparentQueue &amp;&amp; x.renderQueue &lt; OverlayQueue);; } }</code> </pre><br><br>  Here we assume that static objects have already been somehow found (most likely with pens) and ticked them with a Static, which means including BatchingStatic. <br><br><div class="spoiler">  <b class="spoiler_title">Regarding the implementation of the IsTransparent () method.</b> <div class="spoiler_text">  I am not good at writing shaders and I cannot guarantee that such an implementation is correct, I can only say that it works on standard shaders.  If someone tells you a more correct way of implementation, I will definitely replace him. <br></div></div><br><br>  Now let's create a separate wizard so that you can conveniently call this command: <br><br>  This is where the EditorWindow class comes in handy. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEditor; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">OcclusionCullingUtilites</span></span> : <span class="hljs-title"><span class="hljs-title">EditorWindow</span></span> { [MenuItem(<span class="hljs-string"><span class="hljs-string">"Window/OcclusionCullingUtilites"</span></span>)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { GetWindow&lt;OcclusionCullingUtilites&gt;(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnGUI</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(GUILayout.Button(<span class="hljs-string"><span class="hljs-string">"SetStaticFlags"</span></span>)) { SetStaticOclluderFlagsCmd cmd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SetStaticOclluderFlagsCmd(); cmd.Execute(); } } }</code> </pre><br><br>  On this, while we finish our review, it turned out far from complete. <br><br>  In the following articles, I plan to describe how to create custom inspectors for your classes, how to interfere with the process of importing assets, how to bake shadows at 20 levels in turn and get screenshots of the result to your email. </div><p>Source: <a href="https://habr.com/ru/post/236451/">https://habr.com/ru/post/236451/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../236437/index.html">Windows Phone + WinJS. Learning Pivot</a></li>
<li><a href="../236439/index.html">How to use color psychology to increase conversion</a></li>
<li><a href="../236441/index.html">Choosing a static site generator</a></li>
<li><a href="../236447/index.html">Problems finding memory leaks in a web app using Chrome DevTools</a></li>
<li><a href="../236449/index.html">Legacy phobia</a></li>
<li><a href="../236453/index.html">Billing in SaaS applications on Ruby on Rails</a></li>
<li><a href="../236455/index.html">Hours on Bezier curves</a></li>
<li><a href="../236459/index.html">How is it? Leapmotion</a></li>
<li><a href="../236461/index.html">Retro gadget of the late 80s helped parents to force children to learn</a></li>
<li><a href="../236465/index.html">Innovation, security and personal computer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>