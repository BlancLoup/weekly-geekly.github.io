<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Jabber-to-Evernote Gateway from the inside</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some time ago, I launched a bot for posting to Evernote via jabber and promised to open the source code to show examples of working with Evernote API ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Jabber-to-Evernote Gateway from the inside</h1><div class="post__text post__text-html js-mediator-article">  Some time ago, I launched a <a href="http://habrahabr.ru/blogs/jabber/63483">bot for posting to Evernote via jabber</a> and promised to open the source code to show examples of working with Evernote API and OAuth. <br><br>  The code is at the end of the article, and for starters, I will talk about some of the features of working with Evernote. <br><a name="habracut"></a><br><h4>  Evernote </h4><br>  In order to use the Evernote API, you need to send a request to the support service and get a consumer key.  Surprises start here already - it is not written about anywhere, but there are two types of keys: for client applications (with access by login and password) and for access via web authorization - OAuth.  In the letter, be sure to specify exactly what you need. <br><br>  <i>Important: all OAuth access parameters (rights, lifetime of the token) are set on the server side, so it‚Äôs better to write about them immediately.</i>  <i>The maximum lifespan is 365 days, tokens (alas) are not issued indefinitely.</i>  <i>Permissions - standard create / read / update / delete set plus viewing user information and changing it.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      After a while, the answer will come with a pair of keys (consumer key and consumer secret) for access to the sandbox server - <a href="http://sandbox.evernote.com/">sandbox.evernote.com</a> .  After the application is ready, you need to send another request to the support - so that the keys work for the main server - in the meantime, you can freely use the sandbox without fear of breaking something. <br><br><h4>  Oauth </h4><br>  The next surprise I encountered was the lack of examples of OAuth authorization in the API documentation.  Of course, there is documentation on oauth.net, and on other services that use OAuth (twitter, for example), but it‚Äôs pretty hard to figure out without being tied to a specific service. <br><br>  So, the authorization scheme: <br><br>  1. <b>Request token request by application</b> <br>  The full request url looks like this: <br>  <a href="https://www.evernote.com/oauth%3Foauth_consumer_key%3D%253Cconsumer">www.evernote.com/oauth?oauth_consumer_key=&lt;consumer</a> key&gt; &amp; oauth_signature = &lt;consumer secret&gt;% 26 &amp; oauth_signature_method = plaintext <br>  This link gives the application the token used to generate the link that will need to be given to the user for authorization. <br><br>  2. <b>User authorization</b> <br>  The user must follow the generated link and confirm that it gives your application access to your account. <br>  Link issued to the user: <br>  <a href="https://www.evernote.com/OAuth.action%3Foauth_callback%3D%253Ccallback">www.evernote.com/OAuth.action?oauth_callback=&lt;callback</a> url&gt; &amp; oauth_token = &lt;request token received at the first stage&gt; <br>  <i>Another surprise: the oauth_callback parameter (the url where the user will be redirected after confirming access) is specified as optional in the oauth specifications, but it is required when requesting Evernote.</i>  <i>However, it is enough to substitute a slash there for redirecting to the EN main page.</i> <br><br>  3. <b>Request authorization token by application</b> <br>  After the user has confirmed access, the application requests a constant token, which will later be used for authorization: <br>  <a href="https://www.evernote.com/oauth%3Foauth_consumer_key%3D%253Cconsumer">www.evernote.com/oauth?oauth_consumer_key=&lt;consumer</a> key&gt; &amp; oauth_signature = &lt;consumer secret&gt;% 26 &amp; oauth_signature_method = plaintext &amp; oauth_token = &lt;request token received in the first step&gt; <br><br>  After that, you will receive an authorization token and a pointer to the shard (of a particular Evernote server), which will be needed later on when working with the API. <br><br>  In python, there is a library for working with OAuth, but I refused to use it: I didn‚Äôt complicate the process, which boils down to generating links and processing results, especially since the usual OAuth scheme looks more complicated than that used in Evernote Thanks - almost all the excess was removed). <br><br><h4>  Python and libraries </h4><br>  Of the libraries that are not in the standard python build, the bot requires sqlite3, <a href="http://xmpppy.sourceforge.net/">xmpp-py</a> and, of course, the <a href="http://www.evernote.com/about/developer/api/">Evernote API</a> (which also includes <a href="http://incubator.apache.org/thrift/">thrift</a> ). <br><br>  Python 2.6 is required for operation (due to using <a href="http://docs.python.org/reference/compound_stmts.html">‚Äúwith‚Äù statements</a> ) or python 2.5 with the with_statements import from the __future__ module. <br><br><h4>  Source </h4><br>  Habr did not let me insert half a thousand lines of code with a highlight, so I <a href="http://snipt.org/knlp">put all the code on snipt.org</a> .  The programmer from me is not so hot, but it works.  :) Use, habra people! </div><p>Source: <a href="https://habr.com/ru/post/63586/">https://habr.com/ru/post/63586/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../63577/index.html">Spotify Linux Icon</a></li>
<li><a href="../63579/index.html">Secrets of Google Electronics, Part 2</a></li>
<li><a href="../63581/index.html">Walkman `s turned 30 years old!</a></li>
<li><a href="../63582/index.html">eRepublik eUkraine HabraPartia</a></li>
<li><a href="../63585/index.html">Version control database structure</a></li>
<li><a href="../63589/index.html">The first success of Russia in the final of the Imagine Cup 2009!</a></li>
<li><a href="../63590/index.html">My bugtracker is:</a></li>
<li><a href="../63591/index.html">Vadim Dymov (brainstream)</a></li>
<li><a href="../63596/index.html">Joel's test</a></li>
<li><a href="../63597/index.html">Application structure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>