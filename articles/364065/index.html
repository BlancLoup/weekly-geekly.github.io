<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple interface to smart home with nooLite</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some months ago, I put in my home a ‚Äúsmart home‚Äù based on the components of the Belarusian ‚ÄúNootechnics‚Äù, which were written many times over in Habr√© ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple interface to smart home with nooLite</h1><div class="post__text post__text-html js-mediator-article">  Some months ago, I put in my home a ‚Äúsmart home‚Äù based on the components of the Belarusian ‚ÄúNootechnics‚Äù, which <a href="http://geektimes.ru/search/%3Fq%3Dnoolite%26target_type%3Dposts">were written many times</a> over in Habr√© and Hiktaims.  Strictly speaking, I didn‚Äôt see it as a <i>smart</i> home - and first of all as a convenient one: it began with the desire to get control of lamps from different places of the apartment without wiring overhaul, and at the same time make sectional switching on for those lamps to which one pair of wires is now connected . <br><br>  If you look through the publications on this topic, they basically boil down to three things: ‚Äúhow I installed the first switch‚Äù, ‚Äúhow I write a super-rich interface with plug-ins and my own scripting language‚Äù and ‚Äúhow I set up full automation so that more switches cannot be seen ". <br><br>  Alas, none of them gave me practically nothing of value: besides the fact that the last two categories are usually in an eternal state of work-in-progress, I don‚Äôt believe in meaningful automation of light in a city apartment (there‚Äôs really nothing more to automate) I also don't want my own scripting language.  I want a system that, once installed, would allow both me and other people to conveniently control the light in the apartment, if possible without lifting the ass from the chair and without requiring any special knowledge.  And not only enable and disable, but also, for example, change the function of a particular button. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/84a/d7a/8f2/84ad7a8f2e58422898b0175787bd9b5a.jpg"><br><br>  In general, I did it. <br><br>  But first things first. <br><a name="habracut"></a><br>  The reasons for choosing exactly nooLite are quite typical: relatively inexpensive, simple, with a guarantee and, in general, support - if required - no problems should arise.  The rather inconspicuous design of the switches does not frighten me at all - it is more important for me that they are comfortable than beautiful, and here nooLite showed a couple of advantages, which are discussed below.  An unambiguous advantage with respect to even cheaper Chinese is the presence of wall switches in and of themselves - I do not really know how to use the lost key fob in the apartment instead of wall switches. <br><br>  But the main drawback - and not only present at nooLite - turned out to be that for any change in the functioning of the system it is necessary to climb to the ceiling.  For example, I wanted to change the function of the button on the switch - remove the chandelier, pick out the power block from under the stretch ceiling, start it in the snap mode, change the function. <br><br>  The second drawback is that the buttons on the switches quickly run out, although nooLite has three of them on each.  Here, for example, a room.  In her desk lamp, sconces, chandelier with two sections.  These are already four buttons.  Oops. <br><br>  Fortunately, nooLite has such beautiful, albeit very expensive things like a USB receiver and a USB transmitter.  When looking at this couple is simple, but at the same time, a wise thought did not keep itself waiting: after all, you can also wrap all the communication of switches with power units through a server, which will determine what to do when receiving a signal from a button.  We want to change the function of this button - we climb to the server and change it programmatically.  We want to make some complicated logic for the button - we climb onto the server and write it.  We want blackjack and women of easy virtue - well, you understand. <br><br>  It should be noted here that nooLite has its own device called ‚ÄúEthernet gateway‚Äù, but it can do a little more than nothing - show the temperature from the sensors (thanks, I have three weather stations) and turn the power units on and off via the web. <br><br>  Theoretically, the above-mentioned systems with plug-ins and scripts solve this, but in practice they are excessively sophisticated and, without installation, it is usually impossible to understand whether they will help to do simple, but desirable things for me.  In general, I sat down and did exactly what I needed.  No claims on extensibility, customizability, and so on. <br><br>  It turned out like this: <br><ul><li>  Work on x86 under Linux and on routers with OpenWRT </li><li>  Work with a standard nooLite receiver and transmitter </li><li>  Binding-uncoupling power units and switches through the web interface </li><li>  The ability to hang on a single switch as many lamps </li><li>  Standard features - turning on, turning off and switching lamps </li><li>  Additional functions: sequential switching on of several lamps with consecutive pressing of one button (convenient for multi-section chandeliers), switching on by chain (the previous lamp goes out), controlling a group of lamps (if all are off - turn on all, if at least one is turned on - turn off all), turning off all lamps in the house at once </li><li>  Separate functions for short and long pressing of the switch button </li><li>  Configure all lamps, switches and interaction between them from the web interface </li><li>  Display in the web interface of the current state of the lamps (see the picture at the beginning of the note) </li><li>  Android application </li></ul><br><br>  As a result, for example, setting a specific chandelier looks like this for me: the first click of a button - 2 lamps of 5 turn on;  second press - the remaining 3 lamps turn on;  third press - all the lights go out.  Long press with all lamps turned off - all 5 are switched on at once;  long press with 2 or 5 turned on - all the lights go out.  That is, the full control of a two-piece chandelier with just one button on the console. <br><br>  Disclaimer: <br><ul><li>  I was not going to make this system supported, expandable, and so on - I absolutely do not need it.  It is a self-contained system that solves a specific problem. </li><li>  I am not a programmer.  Neither in C, nor in Javascript, nor in Java, nor in PHP (all four will be found later) </li><li>  The system did not make those things that I did not need (there are only the beginnings of working with dimmers, there is nothing about schedules, there is nothing about Noolight sensors).  Most likely, I will never make them, so if you need them, it will be faster to do it yourself </li><li>  All code is licensed under <a href="http://en.wikipedia.org/wiki/WTFPL">WTFPL</a> </li></ul><br><br>  Theoretically, at the time of my purchase of the nooLite set, there already existed unofficial drivers for it, which I hoped to use: when receiving a command, the PHP script driver kicks, and the transmitter driver kicks, consistent with its internal logic. <br><br>  These hopes did not last long - before the first personal acquaintance with the drivers: they turned out to be not so much drivers as technological demonstrations that, in principle, nooLite under Linux can work.  Inside there was a lot of things, from direct typos and errors (for example, an attempt to untie a receiver‚Äôs channel banged all its configuration) to things like the wget call that was supposed to be kicked in a PHP script that was hammered into it.  It was possible to use them, but it is unlikely to love yourself for it. <br><br>  As a result, a set of software for Linux was rewritten ( <a href="https://github.com/olegart/noolite">GitHub</a> ) and got the following: <br><br><ul><li>  Receiver nooliterx: the command being executed is set in the configuration file or the command line, there is a daemon mode, there is a UNIX socket through which the daemon listens to the remote-binding commands </li><li>  Transmitter noolitepc: combed commands, fixed bugs </li><li>  Transmitter noolitepcd: if noolitepc is a console utility, then this is a daemon that accepts commands through a UNIX socket.  This not only works faster, but also allows you to build an elementary command queue with an automatic delay between them, since the nooLite transmitter sticks into the commands faster than once every 400 ms </li><li>  Nooliterxcfg transmitter configurator: console utility for binding and unlinking of consoles.  In fact, no longer needed - this can be done through the web interface and nooliterx with its socket </li></ul><br><br>  From nooliterx and noolitepcd, a skeleton is assembled into which it remains only to add logic connecting the output of the first with the input of the second.  This logic is made in PHP ( <a href="https://github.com/olegart/noolite-php">GitHub</a> ) - for two reasons: first, the ease of upgrading on a live patient, and second, the ease of screwing the web interface.  Though I don‚Äôt see the latter as the main means of controlling the light in the house (it‚Äôs usually easier to reach the switch than the smartphone), but it‚Äôs convenient to have it. <br><br>  Finally, a smartphone application.  It seemed to me ugly to just keep a link to the IP of the router where all this good lives (especially since IP can be a fickle thing), so I launched avahi-daemon on the router, screaming ‚Äúthey rule here!‚Äù On the entire network, and on a smartphone riveted the application from WebView and Network Service Discovery ( <a href="https://github.com/olegart/hmlight-android">GitHub</a> ), which by these screams determines the desired IP and shows it.  For smartphones, a separate compact web interface is made, of course, without beautiful images. <br><br><img src="https://habrastorage.org/files/d07/088/42a/d0708842a21f4d0e86b054fcda1d7e75.png"><br><br>  So, which of the languages ‚Äã‚Äãwe have not yet considered?  And yes, Javascript.  The configuration of lamps and switches in the web is made on Javascript. <br><br><img src="https://habrastorage.org/files/44e/4fc/c89/44e4fcc89c694922bbc8245e489c57e1.png"><br><br>  You can do everything in it: add a switch (according to the channel number of the receiver to which it is attached), hang lamps on it, determine what it can do with them.  Everything is stored in the switch.xml file, which, if desired, can be ruled by hands (and in the first version something like this was done, but somehow I didn‚Äôt look good with this). <br><br><img src="https://habrastorage.org/files/c40/872/483/c408724835214e14bd63ca7953aa0452.png"><br><br>  In the next tab, you can register the existing light bulbs (according to the numbers of the transmitter channels) and drag them out according to the scheme of your apartment, putting them in the right places (to remove the light bulb from the apartment scheme - pull it out of the picture).  In addition to light bulbs, there is the ‚ÄúOther‚Äù device type - it differs only in the icon.  Lamps are stored in lamps.xml. <br><br><img src="https://habrastorage.org/files/660/280/bce/660280bce5c7472dbb31d32c632e22c9.png"><br><br>  The binding of power units and switches to the receiver and transmitter is done right there.  Of course, it requires physical access to the blocks - but this binding is done once before installing a new block and never starts moving again: it does not affect which switches the block can control. <br><br>  Since all lamp control passes through the server, then theoretically - except for the case when, due to interference, the team did not reach the lamp - he knows the current state of all controlled lamps in the apartment.  It is stored in SQLite-base lamps.db, when you first start the interface will offer you to create it, filling it with zeros. <br><br>  In case of communication failures - nooLite from them, unfortunately, is not insured, since it does not have feedback and confirm acceptance of the command - it is enough to click the cycle with the switch button until the base and the real lamp are ‚Äúsynchronized‚Äù (in the simplest case, the ‚Äúswitching‚Äù command : 1) the lamp is on, the shutdown command has not reached it, the lamp remains to work, it appears in the database as off;  2) second press - the lamp received a command to turn on, continued to shine, while in the base it also appears as turned on). <br><br><h2>  Installation </h2><br>  To build under OpenWRT (the link to the finished package for AR71xx and OpenWRT 12.09 will be lower), you need an OpenWRT toolchain deployed somewhere on a large PC.  In it, <a href="http://wiki.openwrt.org/ru/doc/howto/build">after the standard preparation,</a> you need <a href="https://github.com/olegart/noolite/tree/master/openwrt">to take the Makefile from here</a> and put it in the <i>package / noolite /</i> folder inside the toolchain, then make <i>make package / noolite / compile</i> .  If today is your day, and GitHub is not banned by Roskomnadzor, then everything will come together and be in the <i>bin / &lt;arch&gt; / packages /</i> folder as a ready-to-install package. <br><br>  From third-party not-too-standard packages, libusb1 is needed for operation and libusb1-dev for building. <br><br>  Install it on the router (opkg install &lt;package&gt;), then copy the <a href="https://github.com/olegart/noolite/tree/master/openwrt">noolite file</a> to <i>/etc/init.d/ of</i> this router and do <i>/etc/init.d/noolite enable</i> - now the utilities will start when the router is loaded.  In / etc / create the file noolite.conf and write to it: <br><br><pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">command</span></span> = wget -q -T 5 <span class="hljs-string"><span class="hljs-string">"http://localhost/lampcontrol.php?channel=%ch&amp;command=%cm"</span></span> -O /dev/null &amp; timeout = 250</code> </pre> <br><br>  The first is the command that the receiver daemon will call when it receives something;  in this case, it transmits the channel number and the command number from the received one (it is different for different types of buttons on the remotes and short or long press), but in principle can transmit anything from the standard nooLite information in any order.  Codes are in the documentation in / doc project.  The second is the timeout during which the program waits for something after a request to the receiver;  does not play an important role in society. <br><br>  If you do not create a config or specify the -i parameter on the command line, then the nooliterx utility will output the data it received to the console in a format that is readable by a human being ‚Äî this is convenient for debugging. <br><br>  If you install the system under x86, then the assembly is ./configure &amp;&amp; make &amp;&amp; make install. <br><br>  For a web-muzzle you need a web server with PHP support, for example, under OpenWRT (with all the necessary set) this is <i>opkg install lighttpd lighttpd-mod-cgi php5 php5-cgi php5-mod-simplexml php5-mod-xml php5-mod-sqlite3 coreutils-timeout</i> .  If the memory of the router allows you to leave your native packages in place, it is convenient to reconfigure its original web server to some port such as 8080, and hang the light control to standard: 80 to save LuCI and not interfere with the cutlets with flies. <br><br>  Then it remains to deploy the archive with the web interface in the right place, if you wish - open the admin / index.php file and change the login and password from admin / admin to something else (or disable authorization altogether).  Authorization is done at a very primitive level and only on the admin panel - so that your relatives and friends, by pressing the button, do not accidentally bang the lights in the apartment. <br><br>  Yes, if after all you bang something - each time you save the XML files, the old version is copied to a file with the .bak extension.  So you can roll back one step back changes, but now only from the console - by renaming the file back. <br><br>  When you first enter the web-muzzle, the system will offer you to create an empty database - do not refuse it.  There are already XML files in it, for example of how the ready configuration looks like - after looking, erase all the lights and switches from it and set your own.  Do the same with the flat picture. <br><br>  The final touch is the Android app.  To make it find where the lights are on, put the avahi-daemon package on OpenWRT, go to / etc / avahi / services and create the http.service file of such content (the application will find the IP router by the service name): <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" standalone='no'?&gt;</span></span><span class="hljs-comment"><span class="hljs-comment">&lt;!--*-nxml-*--&gt;</span></span> <span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE service-group SYSTEM "avahi-service.dtd"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service-group</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">replace-wildcards</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yes"</span></span></span><span class="hljs-tag">&gt;</span></span>Homelight server<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span>_http._tcp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">type</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span>80<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">txt-record</span></span></span><span class="hljs-tag">&gt;</span></span>path=/<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">txt-record</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service-group</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  If further Avahi rests on startup and swears at the absence of DBus, then in /etc/avahi/avahi-daemon.conf you can add the line enable-dbus = no to the [server] section. <br><br><h2>  Lyrical digression about nooLite </h2><br>  After months of using nooLite, I can‚Äôt, of course, not share the painful ones.  First, of course, the lack of feedback: yes, it happens that the team left the switch and did not go anywhere.  Infrequently, but it happens.  Secondly, in addition to the lack of protection of the transmitted one, noolite is not very good at checking the integrity of the data: it happens that one team left and another one came and the wrong lamp was turned on.  Very rare, but it happens.  Finally, for certainty, the switch sends several copies of the command to the air - and sometimes the receiver manages to accept them as two consecutive commands (to combat this, a restriction is introduced in nooliterx: the command is ignored if it arrived less than 300 ms after the previous one). <br><br>  Unfortunately, I haven‚Äôt yet seen a system that satisfies me in price and aesthetics and is devoid of these shortcomings.  Yes, the classic on Z-Wave is good, but the cost of Z-Wave equipment for the entire apartment, even with a dollar of 35 rubles, drove into a shiver. <br><br>  From the pros: it was found that the inconspicuousness of the nooLite switches is redeemed by their functionality.  You can do, for example, like this: <br><br><img src="https://habrastorage.org/files/405/f85/933/405f859331a84b8a9ce1a79f08f04ff6.jpg"><br><br>  The remote control here is inserted into the standard frame of the W59 Schneider Electric series sockets (there is no actual socket under the remote control, there is a wall right there), and the remote control itself has a laminated own print inserted instead of the native gray substrate, which indicates which button turns off. <br><br>  Tips: <br><ul><li>  The reliability of the operation of power units strongly depends on the antennas.  The antenna should ideally be flattened and directed perpendicular to the direction of the transmitter.  Native antennas are made of soft wire, the easiest way is to provide them with sufficient rigidity by wearing a cocktail straw. </li><li>  Do not place antennas closer than 5-10 cm from CFL caps and LED lamps - their pulse power supplies give noticeable pickups.  A characteristic symptom is that the block is turned on from the first, and turned off from the fifth to tenth time. </li><li>  I changed the antennas on the USB receiver and transmitter with hard pins of copper wire 165 mm long. </li><li>  The signal level at the USB transmitter is higher than that of the wall-mounted consoles, therefore, where it was triggered two times from the wall-mounted console, it can work steadily with a USB transmitter. </li><li>  The router is a single point of failure of light in your house (well, besides the dashboard on the stairs and the transformer in the next block).  Buy two or three spare remotes and tie the main power blocks directly to them so that you can turn on the required minimum of light without a router. </li></ul><br><br><h2>  Links </h2><br><ul><li>  <a href="http://olegart.ru/light/">Demo web interface</a> </li><li>  <a href="https://github.com/olegart/noolite">Sources of utilities for working with the receiver and transmitter nooLite</a> </li><li>  <a href="https://github.com/olegart/noolite-php">Web Interface Files</a> </li><li>  <a href="https://github.com/olegart/hmlight-android">Android application sources</a> </li><li>  <a href="">Bundled package with utilities for OpenWRT 12.09, architecture AR71xx</a> </li><li>  <a href="">Compiled Android Application</a> </li><li>  <a href="http://olegart.ru/files/noolite/noolite-labels.pptx">Label templates for nooLite remote controls in PPTX</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/364065/">https://habr.com/ru/post/364065/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../364055/index.html">Levenhuk DTX90 USB Digital Microscope Review</a></li>
<li><a href="../364057/index.html">A film with ‚Äúnanopouches‚Äù turns almost any surface into a touchscreen</a></li>
<li><a href="../364059/index.html">Thingsee One: the omnipotent Internet of Things from Former Nokia Engineers</a></li>
<li><a href="../364061/index.html">The second stage of the sale of Bitcoin from Silk Road is completed: the rate remains the same</a></li>
<li><a href="../364063/index.html">Chinese space program: own rover, space station by the end of the next five-year plan + heavy launch vehicle</a></li>
<li><a href="../364067/index.html">How to save eyesight and develop imagination, working with a voice recorder</a></li>
<li><a href="../364069/index.html">British provider BT encourages users to challenge the court decision to block sites</a></li>
<li><a href="../364073/index.html">TOEFL test structure</a></li>
<li><a href="../364075/index.html">Combat quadcopters, psychophysiology laboratory and brain training</a></li>
<li><a href="../364077/index.html">StarWars do-it-yourself snowflakes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>