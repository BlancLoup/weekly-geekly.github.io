<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The course of the young fighter: defended by the router. Continued: NBAR</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On many routers, even in basic IOS, there is a rather convenient and clear tsiskin technology: Network-Based Application Recognition (NBAR). With it, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The course of the young fighter: defended by the router. Continued: NBAR</h1><div class="post__text post__text-html js-mediator-article">  On many routers, even in basic IOS, there is a rather convenient and clear tsiskin technology: Network-Based Application Recognition (NBAR).  With it, the router can recognize various protocols and applications and, if necessary, use this knowledge to implement Quality of Service (QoS) <br><br>  So how can a router allocate various protocols from traffic? <br><a name="habracut"></a><br>  1. Analyzing the TCP / UDP header and sorting by known numbers.  This is the most simple and affordable in all iOS <br>  2. Analyzing the header of the protocol of the level 7. For example, by parsing the HTTP header and isolating from there the type of data transferred (for example, the HTTP protocol itself, citrix and some other Web-enabled applications), URL, attachments. <br>  3. Analyzing the service protocol of complex (multichannel) applications and taking into account dynamic, agreed on the service channel session. <br>  4. Analyzing RTP headers. <br>  5. By analyzing the header of protocols other than TCP / UDP <br><br>  The third and fourth algorithm requires the inclusion of inspection protocols (ip inspect), discussed a little earlier. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Inspection requires IOS with a firewall feature set. <br><br>  There are two ways to enable NBAR technology: <br><br>  1. Just turn on the study of all known protocols. <br><br>  <i>Ro (config) # int f0 / 0</i> <i><br></i>  <i>Ro (config-if) # ip nbar protocol-discovery</i> <i><br></i> <br>  After enabling the study on the interface, statistics on known protocols will be collected and can be viewed with the command <br><br>  <i>Ro # show ip nbar protocol discovery</i> <i><br></i> <br><br>  2. Take advantage of the MQC architecture (Modular QoS CLI) <br><br>  Create a traffic class specifying the required protocol <br><br>  <i>Ro (config) # class-map [CLASSNAME]</i> <i><br></i>  <i>Ro (config-cmap) # match protocol [protocol]</i> <i><br></i> <br>  For example: <br><br>  <i>Ro (config) # class-map PD</i> <i><br></i>  <i>Ro (config-cmap) # match protocol citrix ica-tag 2</i> <i><br></i> <br><br>  Create a policy and specify an action for the class. <br><br>  <i>Ro (config) # policy-map [POLICY]</i> <i><br></i>  <i>Ro (config-pmap) # class [CLASSNAME]</i> <i><br></i>  <i>Ro (config-pmap-c) # {action}</i> <i><br></i> <br><br>  For example: <br><br>  <i>Ro (config) POL policy # map</i> <i><br></i>  <i>Ro (config-pmap) # class PD</i> <i><br></i>  <i>Ro (config-pmap-c) # {shape | police | priority | service-policy}</i> <i><br></i> <br><br>  It remains to hang the policy on the interface to activate it. <br><br>  <i>Ro (config) # int f0 / 0</i> <i><br></i>  <i>Ro (config-if) # service-policy {input | output} [POLICY]</i> <i><br></i> <br><br>  For example, let's hang a policy at the interface input. <br><br>  <i>Ro (config) # int f0 / 0</i> <i><br></i>  <i>Ro (config-if) # service-policy input POL</i> <i><br></i> <br><br>  Specifying match protocol keywords in the traffic class means enabling NBAR technology. <br>  You can see the statistics for class hits <br><br>  <i>Ro # sh policy-map interface f0 / 0</i> <i><br></i> <br><br>  It remains only to recall that any process of analyzing the traffic is made by the processor and pretty annoying.  Under the link - an article with a performance test without trying NBAR, using basic and advanced analysis technologies. <br><br>  <a href="http://www.cisco.com/en/US/technologies/tk543/tk759/technologies_white_paper0900aecd8031b712_ps6616_Products_White_Paper.html">article on tsisko.kom</a> <br><br>  The results of traffic processing technology NBAR can be collected via SNMP and analyze.  From the point of view of perimeter protection, the closest attention should be paid to a sharp increase in the amount of traffic over some protocol.  This may indicate the presence of worms in the network, as well as other problems, such as botnets, spam proxies, etc. <br><br>  (Continued follows) </div><p>Source: <a href="https://habr.com/ru/post/61183/">https://habr.com/ru/post/61183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../61172/index.html">NVIDIA demonstrated 21 products based on the Ion platform</a></li>
<li><a href="../61178/index.html">Updating animal preserving prescriptions</a></li>
<li><a href="../61179/index.html">Declassified next-generation iPod and iPhone designs?</a></li>
<li><a href="../61180/index.html">An interesting presentation of the song (more precisely, the "clip")</a></li>
<li><a href="../61182/index.html">PSP Go Announcement at E3</a></li>
<li><a href="../61185/index.html">Reactive websites. Table of contents</a></li>
<li><a href="../61186/index.html">A new version of the IDEA-android plugin (0.5) with SDK 1.5 support has been released.</a></li>
<li><a href="../61188/index.html">First impressions of using HTC MAX 4G</a></li>
<li><a href="../61191/index.html">How to disassemble iMac</a></li>
<li><a href="../61192/index.html">The official release of Windows 7 is scheduled for October 22</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>