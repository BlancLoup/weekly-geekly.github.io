<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to legally "open" QIWI Wallet and pump it in full</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, Visa QIWI Wallet users have access to new API methods. Under the cut: what is the API, why we opened it and why you should start using it no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to legally "open" QIWI Wallet and pump it in full</h1><div class="post__text post__text-html js-mediator-article">  Recently, Visa QIWI Wallet users have access to new API methods.  Under the cut: what is the API, why we opened it and why you should start using it now. <br><br><img src="https://habrastorage.org/web/e60/873/c53/e60873c532d94cffa5728f73147a277f.png"><br><a name="habracut"></a><br><h2>  API history </h2><br>  Formally, the history of our API began in April of this year, although some of its member methods were available long before that. <br><br>  The QIWI Wallet mass user service is gradually moving to microservice architecture, so components inside our system interact with each other through some kind of API.  Any user can go to the site, open the debugger and see what requests the browser sends to the server.  The minimum programming skills are enough to pull out the queries sent and use them in your own solutions to bypass the site. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There were quite a few people who wanted to cheat like this.  These are enthusiastic students who are interested in digging into the details of the Wallet, and professional developers who want to integrate certain functions of the QIWI Wallet site into their solutions.  As a result, in parallel with the development of the site, a whole ecosystem of third-party solutions began to develop in a ‚Äúgray‚Äù mode, not legalized in the user agreement and not supported by our support. <br><br>  Here are just the scripts built on the results of independent research of the site, working for users is unstable.  Developers use different methods of extracting information, including outdated methods that create additional load on our servers. <br><br>  In order to streamline the uploading of data from the site, we decided to legalize it, as we did in Citibank, Wargaming and Vkontakte.  We have described the most modern and stable of the existing ways of obtaining information, creating the first version of the user API. <br><br>  With the advent of <a href="https://developer.qiwi.com/qiwiwallet/qiwicom_ru.html">developer documentation,</a> users no longer need to parse our site in pieces, risking to stumble upon old protocols.  By attendance of the documentation section, we tracked how much the API is in demand.  We also posted <a href="">an email address</a> for feedback and questions and monitored publications on the topic in social networks and forums.  At that time, we were not faced with the task of somehow promoting the API - we wanted to restore order and offer third-party developers a free, secure, proven access method. <br><br>  Publication of API documentation itself did not affect the work of third-party tools for accessing Wallet functions.  We did not plan to regulate "samostroy", but watched the situation, because the solutions were built by developers at their own risk and risk based on undocumented features of the service.  And as long as they do not affect the data of our users, we do not fight with them at all, but we try to get in touch with their creators and recommend switching to using the documented API. <br><br>  Since the requests went through site parsing, it is obvious that solutions using methods that go beyond the API will work as long as the corresponding schemes work on the site.  But we hope that after the appearance of a better way, the undocumented decisions will gradually die off. <br><br><h2>  Problems of the first version </h2><br>  Unfortunately, at the time of creating the first version of the API, we did not yet have a separate authentication system.  Therefore, at that stage we used the authentication scheme from our site (CAS), it was disassembled into separate teams and published on <a href="http://developer.qiwi.com/">developer.qiwi.com</a> . <br><br>  Authentication has become a key issue in the first API.  If, from the site‚Äôs point of view, the mechanism was correct (this is how the authentication is organized on most web pages, based on the principle of two tokens with different lifetime), then the user was quite difficult to go through the procedure.  This method was not originally focused on users, but served the internal tasks of our site.  As a result, various difficulties arose, for example, the captcha ‚Äúprove that you are not a robot‚Äù popped up, which was a surprise for users, since the API implies access using automatic systems. <br><br>  Although we did not publicize the publication of the open API, several articles appeared on the network, including those with negative reviews.  We received over a hundred letters to the feedback address <a href="">api_help@qiwi.com</a> , the meaning of which was that the API itself was good, but authentication was no good.  Not all users understood why connecting to a financial service requires such an intricate procedure, while with Instagram or Vkontakte everything is much easier.  We explained that the difficulties were due to the financial component, because the method used (both in site authentication and API) should not jeopardize customer accounts. <br><br>  Analyzing the feedback, we saw that the API is in demand, and the criticism is mainly aimed at the authentication system, and decided to develop the API further. <br><br><h2>  Updated API </h2><br>  The development of new methods within the framework of the API was entrusted to a team of experts who make the backend for the site and the QIWI Wallet mobile application.  The API is their core competency; it is this team that translates the main site into microservice architecture.  And the API here serves for the interaction of the main site and individual entities through requests that we pass to our users. <br><br>  To refine the existing API and add new methods to it, we carefully analyzed user feedback. <br><br>  Although there are a lot of enthusiastic enthusiasts among our clients who are inclined to try something new, the main part of API users is professional developers who integrate QIWI Wallet into their business processes (and this is not online shopping - we have a separate API for legal entities ).  Basically, it‚Äôs about optimizing the Wallet for your own needs: setting up notifications, automating payment for services and exchanging digital goods between users, as well as other tasks not related to the usual e-commerce. <br><br>  Based on the reviews, we proposed a new user authentication through the API, added new functions for interacting with the Wallet.  In the first version, we had a balance request, payment history and transfer transfer.  Now they have been supplemented by a request for a user profile, payment for cellular communication, transfers to banks and to cards using card, account and contract numbers instead of full details. <br><br><h3>  New authentication </h3><br>  To build an API-oriented authentication system, we used the RFC 6749 standard using the open OAuth 2.0 protocol.  In order for the authentication to meet the requirements of the financial service, we provided two-factor access - by password to the Wallet and SMS code.  To complete the procedure, the user needs to issue a token valid for <s>one month</s> 180 days (the issue is confirmed by an SMS message).  At the request of users in the new version of OAuth 2.0, we also opened the choice of access rights for the token.  For example, if you want to request a balance or get a payment history, the token is given read only rights.  There are four groups of access rights available: <br><br><ul><li>  access to user profile information; <br></li><li>  access to the Wallet balance; <br></li><li>  access to payment history; <br></li><li>  full access to payments. <br></li></ul><br><img src="https://habrastorage.org/web/505/52b/719/50552b7190514dc4be22b2a16a5834cd.png"><br><br>  The function turned out to be very popular, less than half of tokens are issued with full rights (making payments), many only need to receive information. <br><br><h3>  User Profile </h3><br>  One of the new features that were born within our team, and not from the wishes of customers - request a user profile.  It allows you to receive various information about the Wallet: the date of registration, the associated email address, the level of identification of the Wallet.  The latter is especially important for financial services, since the level of identification determines the limits on operations for the wallet.  Previously, this information could be found in the Wallet settings on the <a href="http://qiwi.com/">qiwi.com</a> website; now it is also available through the API. <br><br>  Note that the personal data of the user through the profile request is not available - this is a security requirement. <br><br><h3>  Commission rates </h3><br>  Following the wishes of users, we added to the API the ability to request a fee when conducting transactions on any of the available service providers.  This method is open and does not require authentication. <br><br><h3>  Cellular payment </h3><br>  Another innovation, initiated by our users, is a tool for automating cellular payments, for example, for courier phones. <br><br>  In fact, the method consists of two stages: <br><br><ul><li>  automatic identification of the operator by phone number and service provider ID in the system (works even for numbers that were transferred from one operator to another (MNP); </li><li>  transfer of money to the operator‚Äôs account. </li></ul><br><br><h3>  Transfers to banks and bank cards </h3><br>  By analogy with the payment of cellular communication, this group of API methods allows you to automate transfers to bank cards of VISA, MasterCard systems and the national payment system MIR in Russia and the CIS.  The transfer is carried out according to the card number, which determines the payment system. <br><br>  Bank transfer is a separate method used to send money to some banks with which we have implemented an online protocol for instant money transfers.  Unlike conventional money transfers by bank details, for these banks you can use a greater number of customer identifiers (card number, agreement, account, etc.). <br><br><h2>  The legal side of the issue </h2><br>  Until recently, API access was formally denied.  Everything that was done using the API was done at your own peril and risk.  If a user broke the site, pulled out some commands from him, conducted operations with the wallet, and he lost money, he was fully responsible for the consequences of his actions.  Technical support was not involved in solving such problems. <br><br>  To prevent such situations from happening again, we made the appropriate changes to the user agreement.  Now API has official status on a par with the site and the mobile application. <br><br><h2>  What will happen next? </h2><br>  The listed data access methods are already working, and the documentation on them is published on the <a href="http://developer.qiwi.com/">developer.qiwi.com</a> website. <br><br>  Internal testing has been completed, and, having published the API, we have moved to the second stage - testing the functionality of the ‚Äúuser + documentation + API‚Äù bundle.  This stage should answer questions about how clear the documentation is, whether any additional explanations are needed, etc. Therefore, we suggest that users send feedback to our address: <a href="">api_help@qiwi.com</a> . <br><br>  In the near future, we plan to expand the API's capabilities by providing third-party services with methods for registering new users and authenticating existing users in the system, as well as conducting financial transactions on their behalf.  This is a slightly different model of interaction between us, the user and a third party - a third-party service. <br><br>  If you are interested in the details of developing a new version of the API, write and ask questions in the comments - we will try to answer them in our next publications. <br><br><h2>  Attention! Competition </h2><br>  To interest developers in using the new API, we are conducting the All-Russian QIWI API Contest.  This is the first competition within the QIWI Open Platform, aimed at promoting the company's API. <br><br>  To participate in the contest, you need to create Mobile First solutions - chat bots, mobile applications and web-products using the QIWI Wallet API.  Our experts will select the most developed solutions and invite up to 15 participants to the final of the competition, which will be held in Moscow on September 23. <br><br>  Contestants from other cities can participate remotely.  Registration of projects is open and will run until September 15.  You can apply for participation in the <a href="https://apimarket.qiwi.com/">QIWI API Contest</a> via Timepad or send it to <a href="">apimarket@qiwi.com</a> .  For all questions we created a special <a href="https://t.me/qiwiapicontest">chat in Telegram</a> . <br><br>  08.25.2017 update: <br><br><ul><li>  now tokens live not 30, but 180 days; </li><li>  launched the <a href="https://apimarket.qiwi.com/">QIWI API Contest</a> website. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/335742/">https://habr.com/ru/post/335742/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../335730/index.html">To whom life with ISDEF is good</a></li>
<li><a href="../335732/index.html">Social Organism - as a form of effective team interaction. Part 3</a></li>
<li><a href="../335734/index.html">Blockchain as an academic discipline: ITMO University Master's Program</a></li>
<li><a href="../335736/index.html">We intercept the launch of any application in Windows and try not to break anything.</a></li>
<li><a href="../335738/index.html">The most interesting ICO of summer 2017: national cryptocurrency, blockchain-social network and streaming service</a></li>
<li><a href="../335746/index.html">Forwarding a real video card in a VM with ReactOS</a></li>
<li><a href="../335748/index.html">As we increased the application load by 14% with the help of the new icon design</a></li>
<li><a href="../335750/index.html">Binary search in javascript. Practical example</a></li>
<li><a href="../335754/index.html">Design and Mathematics of Clicker Games</a></li>
<li><a href="../335756/index.html">Concurrency in Swift 3 and 4. Operation and OperationQueue</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>