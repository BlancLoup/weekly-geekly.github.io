<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Slight discrepancy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This picture shows a mesh table top on a patio, photographed after a heavy rain. In some of the mesh holes lingered water drops. What can be said abou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Slight discrepancy</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/edd/f32/810/eddf328101f58bbc4dc79a549c2c57b6.jpg"></div><br><br>  This picture shows a mesh table top on a patio, photographed after a heavy rain.  In some of the mesh holes lingered water drops.  What can be said about the distribution of these drops?  Are they scattered randomly on the surface?  The process of falling rain, which has arranged them, seems to be quite random, but in my opinion, the pattern of places occupied in the grid looks suspiciously even and monotonous. <br><br>  To simplify the analysis, I selected the square part of the photograph with the table top (removing the hole for the umbrella), and selected the coordinates of all the drops in this square.  There are 394 drops in it, which I marked with blue dots: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7b7/feb/4b4/7b7feb4b4907826ca9bc60356f27a500.png" alt="positions of 394 raindrops on a tabletop"></div><br><br>  I will repeat the question: does this pattern look like a result of a random process? <br><a name="habracut"></a><br>  I came to this question after writing an <a href="https://www.americanscientist.org/issues/pub/2011/4/quasirandom-ramblings">article for <em>American Scientist</em></a> , in which two variants of simulated randomness are studied: <em>pseudo</em> and <em>quasi</em> .  Pseudo-randomness needs no introduction.  A pseudo-random algorithm for selecting points in a square tends to ensure that all points have the same probability of choice, and that all choices are independent of each other.  Here is an array of 394 pseudo-random points bounded by belonging to a beveled and rotated grid, similar to a mesh table top: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/adc/ae5/c77/adcae5c771d00ed223a53521df0b560f.png" alt="394 pseudorandom dots on a skewed 60-by-60 grid"></div><br><br>  Quasi-randomness is a less well-known concept.  When choosing quasi-random points, the goal is not equiprobability or independence, but the uniformity of the distribution: the scatter of the points as evenly as possible over the surface of the square.  However, it is not too obvious how to achieve this goal.  For the 394 quasi-random points shown below, the <em>x</em> coordinates form a simple arithmetic progression, but the <em>y</em> coordinates are altered by the process of mixing numbers.  (The corresponding algorithm was invented in the 1930s by the Dutch mathematician Johannes van der Korput, who worked on one-dimensional rows, and in the 1950s was transferred to two dimensions by Klaus Friedrich Roth. For more details, see my article for <em>American Scientist</em> on page 286 or in an amazing <a href="http://www.worldcat.org/title/geometric-discrepancy-an-illustrated-guide/oclc/41315340">book Jiri Matusek</a> .) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/034/492/c0d/034492c0d7b8950554ac146cfd4c5c47.png" alt="394 dots scattered over a square by the Vandercorput algorithm"></div><br><br>  Which of these sets of points, <em>pseudo</em> or <em>quasi</em> , best fits raindrops?  We can compare all three patterns in a reduced form: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/29d/6cd/3f1/29d6cd3f14acbca768462e3314affdd8.png" alt="pseudorandom, quasirandom and raindrop patterns"></div><br><br>  Each of the patterns has its own texture.  In a pseudo-random, there are both concentrated clusters and large spaces.  Quasi-random points are located more evenly (although there are several close pairs of points), but they also create distinct small-scale repeating patterns, the most prominent of which is the hexagonal structure, repeated with almost crystalline uniformity.  As for the drops, it looks like they are distributed over the area with almost uniform density (in this resembling a quasi-random pattern), but in the texture there are hints of bends rather than lattices (in this case it looks more like a pseudo-random example). <br><br>  Instead of studying patterns "by eye", you can try a quantitative approach to their description and classification.  For this purpose, there are many tools: radial distribution functions, statistics of nearest neighbors, Fourier methods, but the main reason for solving this issue for me was first of all the opportunity to play with a new toy, which I learned in the process of studying quasi-randomness.  This quality, called <em>discrepancy,</em> <i>could not find the correct term in Russian, so write to me if you know it</i> , estimates the deviation of the set of points from the uniform distribution in space. <br><br>  There are many variations in the concept of discrepancy, but I want to consider only one measurement scheme.  The idea is to overlay on a pattern of rectangles of various shapes and sizes, the sides of which are parallel to the <em>x</em> and <em>y</em> axes.  Here are three examples of rectangles superimposed on a droplet pattern: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/07d/736/616/07d7366161191a6bef4b039f819e017b.png" alt="raindrop pattern with three axis-parallel rectangles"></div><br><br>  Now we calculate the number of points enclosed in each rectangle, and compare them with the number of points that <em>should</em> be enclosed in it with a corresponding area, if the distribution of points was perfectly uniform over the whole square.  The absolute value of the difference is the difference <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D </font></font></font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></font></font></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.782ex" height="2.66ex" viewBox="0 -832 2059 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMAIN-28" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-72" x="1218" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMAIN-29" x="1669" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> D (r) </script>  associated with a rectangle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R</font></font></font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-52" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> R </script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-8"><span class="noError" id="MJXp-Span-9" style="display: inline-block;">D&nbsp;\&nbsp;left&nbsp;(R&nbsp;\&nbsp;right)&nbsp;=&nbsp;\&nbsp;left&nbsp;|&nbsp;N&nbsp;\&nbsp;cdot&nbsp;area&nbsp;(R)&nbsp;-&nbsp;\&nbsp;#&nbsp;\&nbsp;left&nbsp;(P&nbsp;\&nbsp;cap&nbsp;R&nbsp;\&nbsp;right)&nbsp;\&nbsp;right&nbsp;|</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">D&nbsp;\&nbsp;left&nbsp;(R&nbsp;\&nbsp;right)&nbsp;=&nbsp;\&nbsp;left&nbsp;|&nbsp;N&nbsp;\&nbsp;cdot&nbsp;area&nbsp;(R)&nbsp;-&nbsp;\&nbsp;#&nbsp;\&nbsp;left&nbsp;(P&nbsp;\&nbsp;cap&nbsp;R&nbsp;\&nbsp;right)&nbsp;\&nbsp;right&nbsp;|</span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> D \ left (R \ right) = \ left | N \ cdot area (R) - \ # \ left (P \ cap R \ right) \ right | </script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> N </script>  - the total number of points, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-12"><span class="noError" id="MJXp-Span-13" style="display: inline-block;">\&nbsp;#&nbsp;\&nbsp;left&nbsp;(P&nbsp;\&nbsp;cap&nbsp;R&nbsp;\&nbsp;right)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">\&nbsp;#&nbsp;\&nbsp;left&nbsp;(P&nbsp;\&nbsp;cap&nbsp;R&nbsp;\&nbsp;right)</span></span><script type="math/tex" id="MathJax-Element-5"> \ # \ left (P \ cap R \ right) </script>  - amount of points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-14"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">P</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.057ex" viewBox="0 -780.1 751.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-50" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> P </script>  in a rectangle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17">R</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-52" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> R </script>  .  For example, the rectangle in the upper left corner covers 10 percent of the square, that is, its ‚Äúfair‚Äù share of points should be 0.1 √ó 394 = 39.4 points.  In fact, the rectangle contains only 37 points, that is, the discrepancy associated with the rectangle is | 39.4 - 37 |  = 2.4.  The density of points in a rectangle can be more or less than the general average;  in both cases, the absolute value will give us a positive discrepancy. <br><br>  For the pattern as a whole, we can set the total discrepancy <em>D</em> as the worst value of its change, or in other words, the maximum discrepancy taken for all possible rectangles superimposed on a square.  Van der Korput wondered if the sets of points could be created with an arbitrarily low divergence, so that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> N </script>  tending to infinity <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.924ex" height="2.057ex" viewBox="0 -780.1 828.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-44" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> D </script>  has always been below some fixed boundary.  The answer is no, in at least one and two dimensions;  minimum growth rate is <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">O</span><span class="MJXp-mtext" id="MJXp-Span-24">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">t</span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-30">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">N</span><span class="MJXp-mtext" id="MJXp-Span-35">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">t</span><span class="MJXp-mo" id="MJXp-Span-41" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.366ex" height="2.66ex" viewBox="0 -832 8338 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-6C" x="1013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-65" x="1312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-66" x="1778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-74" x="2329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMAIN-28" x="2690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-6C" x="3330" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-6F" x="3628" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-67" x="4114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-4E" x="4594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-72" x="5733" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-69" x="6184" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-67" x="6530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-68" x="7010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-74" x="7587" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMAIN-29" x="7948" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> O \ left (\ log N \ right) </script>  .  Pseudo-random patterns generally have a higher discrepancy <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-42"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">O</span><span class="MJXp-mtext" id="MJXp-Span-44">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">t</span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-50">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">t</span><span class="MJXp-mrow" id="MJXp-Span-55"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">N</span></span><span class="MJXp-mtext" id="MJXp-Span-57">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">t</span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.477ex" height="2.66ex" viewBox="0 -832 8816.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-6C" x="1013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-65" x="1312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-66" x="1778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-74" x="2329" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMAIN-28" x="2690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-73" x="3330" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-71" x="3799" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-72" x="4260" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-74" x="4711" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-4E" x="5073" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-72" x="6211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-69" x="6663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-67" x="7008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-68" x="7489" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-74" x="8065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMAIN-29" x="8427" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> O \ left (\ sqrt {N} \ right) </script>  . <br><br>  How to find a rectangle with the maximum divergence for a given set of points?  When I first read the definition of discrepancy, I thought that it would be impossible to calculate it precisely, because there are an infinite number of rectangles in question.  But upon reflection, I realized that there was only a finite set of candidate rectangles that could maximize the divergence.  These are rectangles in which each of the four sides passes through at least one point.  (Exception: candidate rectangles may also have sides lying on the edges of a square.) <br><br>  Suppose we meet the following rectangle: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc0/6ea/f17/fc06eaf17ba54d435c9e54c0e5460e79.png" alt="reactangle with three sides anchored by points"></div><br><br>  The left, upper and lower sides pass through the point ,, but the right side lies in ‚Äúempty space‚Äù.  Such a configuration cannot be a rectangle with a maximum divergence.  We can move the right edge to the left until it intersects with a point: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d09/afb/c8b/d09afbc8b0dad5f47aff151f133a5961.png" alt="ractangle reshaped to maximize density of points"></div><br><br>  This change in shape reduces the area of ‚Äã‚Äãthe rectangle without changing the number of points enclosed in it, and therefore increases the density of points.  We can also move the edge in the other direction: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ff/393/752/5ff39375204405a0ae752b092a4a145a.png" alt="rectangle stretched to maximize area"></div><br><br>  Now we have <em>increased the</em> area, again without changing the number of points enclosed in it, which means we have reduced the density.  At least one of these actions will increase <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">D</span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">r</span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.782ex" height="2.66ex" viewBox="0 -832 2059 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMAIN-28" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-72" x="1218" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMAIN-29" x="1669" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> D (r) </script>  compared to the original configuration.  Therefore, each rectangle, all four sides of which touch points or edges of a square, is a local maximum of the divergence function;  by listing all the rectangles in this finite set, we can find the global maximum. <br><br>  There is also another annoying question: should a rectangle be considered ‚Äúclosed‚Äù (that is, points on the border are included in the area) or ‚Äúopen‚Äù (points on the borders are excluded).  I avoided this task by presenting in the form of a table the results for both closed and open borders.  The closed form gives the greatest discrepancy for rectangles with a dense arrangement of points, and the open form maximizes the divergence at a low density of points. <br><br>  Considering only the extremes of the divergence function, we make the calculation task finite - but everything is not so simple!  How many rectangles need to be considered in the square with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-69"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> N </script>  points (each of which has its own distinct coordinates <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> x </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> y </script>  )?  This turns out to be a very interesting little task with a simple combinatorial solution.  I will not explain the answer here, but if you don‚Äôt think you can do it yourself, you can watch it in <a href="http://oeis.org/A000537">OEIS</a> or read the short article by <a href="http://www.math.hmc.edu/~benjamin/papers/rectangles.pdf">Benjamin, Quinn and Wurtz</a> .  What I <em>can</em> say is that for <em>N</em> = 394 the number of rectangles is 6,055,174,225 ‚Äî or two times more, if we separately take into account open and closed rectangles.  For each rectangle, you need to find out how many of the 394 points are inside and how many are outside.  Quite a lot of work. <br><br>  One way to reduce computational overhead is to return to a simpler measurement of the discrepancy.  In different literature on quasi-random patterns in two or more dimensions, a quality called ‚Äústar discrepancy‚Äù, or <em>D *, is used</em> .  The idea is to consider only rectangles ‚Äúattached‚Äù to the lower left corner of the square (which successfully coincides with the origin point of the <em>xy</em> plane).  In this case, the number of rectangles is equal to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-75"><span class="MJXp-msubsup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-78" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-79">2</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.177ex" height="2.419ex" viewBox="0 -935.7 1368 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMAIN-32" x="1292" y="513"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> N ^ {2} </script>  , or about 150,000 for <em>N</em> = 394. <br><br>  Here is a rectangle defining the global divergence-star of the raindrop pattern: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f2/3fe/85c/0f23fe85cb840bb23186d9166f53f016.png" alt="maximal star-discrepancy pattern for the raindrop pattern"></div><br><br>  The dark green box at the bottom covers about 55 percent of the square and should contain 216.9 dots with a completely even distribution.  In fact, it includes (assuming that this is a ‚Äúclosed‚Äù rectangle) 238 points, that is, the discrepancy is 21.1.  No other rectangle tied to a corner (0,0) will have more divergence.  (Note: due to the limitations of the graphic resolution, it seems that the rectangle <em>D *</em> stretches to the bounds of the square, in fact the right edge lies on <em>x</em> = 0.999395.) <br><br>  What does this result tell us about the nature of the raindrop pattern?  Well, for starters, the discrepancy is pretty close to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-80"><span class="MJXp-mtext" id="MJXp-Span-81">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">t</span><span class="MJXp-mrow" id="MJXp-Span-86"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.693ex" height="2.419ex" viewBox="0 -780.1 2881.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-71" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-72" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-74" x="1631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/343014/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgrQfkcLx3N0vmW9XK7d5pLwj1GvA#MJMATHI-4E" x="1993" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> \ sqrt {N} </script>  (equivalent to 19.8 with N = 394) and not particularly close to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-mtext" id="MJXp-Span-89">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> \ log N </script>  (equal to 6.0 for natural logarithms).  That is, we do not find evidence that the droplet pattern is more quasi-random than pseudo-random.  The values ‚Äã‚Äãof <em>D *</em> for the other patterns shown above are in the expected interval: 25.9 for pseudo-random and 4.4 for quasi-random.  In contrast to the external impression, the distribution of raindrops seems to have more in common with a pseudo-random set of points than with a quasi-random - at least according to the criterion <em>D *</em> . <br><br>  But what about the calculation of the unlimited divergence <em>D</em> , that is, the study of <em>all</em> rectangles, and not just fixed rectangles <em>D *</em> ?  Upon reflection, it can be concluded that a comprehensive enumeration of rectangles cannot in this case change the main conclusion;  <em>D can</em> never be less than <em>D *</em> , and therefore we cannot hope to approach from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-94"><span class="MJXp-mtext" id="MJXp-Span-95">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">t</span><span class="MJXp-mrow" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ sqrt {N} </script>  to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-102"><span class="MJXp-mtext" id="MJXp-Span-103">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> \ log N </script>  .  But I was still interested in calculations.  Which of all these six billion rectangles will have the largest discrepancy?  Is it possible to answer this question without heroic feats? <br><br>  The obvious and simple algorithm for <em>D</em> generates in turn all the candidate rectangles, measures their area, counts points inside and tracks the marginal differences found in the process.  I found out that a program that implements this algorithm can determine the exact discrepancy of 100 pseudo-random or quasi-random points in a few minutes.  This result may motivate us to take large <em>N</em> values;  however, the execution time almost doubles each time <em>N is</em> increased by 10, and this hints to us that for <em>N</em> = 394 calculations will take a couple of centuries. <br><br>  I spent a few days trying to speed up the calculations.  Most of the execution time is spent on a procedure that counts points in each rectangle.  Determining whether a given point is inside, outside or on the border takes eight arithmetic comparisons;  that is, when <em>N</em> = 394, more than 3,000 are executed for each of the six billion rectangles.  The most effective method of saving time I discovered was the preliminary calculation of all comparisons.  For each point that may become the lower left corner of the rectangle, I first calculate the list of all points of the pattern that are above and to the right.  For each potential upper right corner of the rectangle, I compile a similar list of points below and to the left.  These lists are stored in a hash table indexed by angle coordinates.  For each triangle, I can calculate the number of interior points by simply taking the intersection of the sets of two lists. <br><br>  Thanks to this trick, the expected execution time with <em>N</em> = 394 decreases from two centuries to about two weeks.  This great optimization encouraged me to spend another day on further improvements.  The situation of replacing the hash table with an <em>N</em> √ó <em>N</em> array slightly improved the situation.  And then I found a way to ignore all the smallest triangles that are not likely to be rectangles with maximum <em>D</em> , because they contain too few points, or they have too small an area.  This improvement has finally reduced the lead time to one night.  It took six hours to calculate an illustration showing a rectangle with a maximum divergence <em>D</em> for a raindrop pattern. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/91d/785/8d2/91d7858d27cbe3b4a7b1edb2fe49d394.png" alt="rectangle yielding the largest exact discrepancy for the raindrop pattern"></div><br><br>  The rectangle with max- <em>D</em> obviously became a small refinement of the rectangle <em>D *</em> for the same set of points.  The rectangle <em>D</em> ‚Äúmust‚Äù contain 204.3 points, but in fact contains 229, which gives us the difference <em>D</em> = 24.7.  Of course, the knowledge that the exact discrepancy is 24.7, not 21.1, does not tell us anything about the nature of the raindrop pattern itself.  In fact, it seems to me that by doing more and more calculations, I find out less and less about it. <br><br>  When I started working on this project, I had my own theory about what could happen in the table top to smooth out the distribution of drops and what makes the pattern more quasi- than pseudo-random.  For a start, I thought about the drops lying on the smooth surface of the glass, and not the metal grid.  If two small drops are close enough to touch, they will merge into one large drop, because this configuration has less energy associated with surface tension.  If two adjacent cells of the grid are filled with water, and if the metal between them is wet, then water can flow freely from one drop to another.  A larger drop will almost certainly grow at the expense of a smaller one, and the latter will eventually disappear.  Therefore, compared to a purely random distribution, we can expect a lack of droplets in neighboring cells. <br><br>  And this thought still seems to me very good.  The only problem is that it explains the phenomenon, which may not exist.  I don‚Äôt know if my calculations revealed something important about these three patterns, but at least it was not possible to prove by measurements that the distribution of drops differs from the pseudo-random.  In fact, the patterns <em>look</em> different, but how much can we trust our organs of perception in such cases?  If you ask people to draw dots at random, the majority will handle this badly, usually the distribution will be too smooth and even.  Perhaps the brain is experiencing similar difficulties in <em>recognizing</em> chance. <br><br>  However, I believe that <em>there</em> is some mathematical property that allows you to more effectively separate these patterns.  If someone else decides to spend their time searching, the <em>xy</em> coordinates for the three sets of points are in the <a href="http://bit-player.org/wp-content/uploads/2011/06/discrepancy-coordinates.txt">text file</a> . <br><br>  <strong>Update</strong> : this is just a brief recommendation - if you have read this far, then continue reading the <a href="http://bit-player.org/2011/a-slight-discrepancy">comments</a> .  They have a lot of value.  I want to thank all those who have spent their time to offer alternative explanations or algorithms and to point out weak points in my analysis.  Special thanks to themathsgeek, who 40 minutes after publishing the post wrote a much better program for calculating discrepancies.  I also thank Iain, who checked my improvised reasoning about the perception of random patterns with real experiments. </div><p>Source: <a href="https://habr.com/ru/post/343014/">https://habr.com/ru/post/343014/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343004/index.html">The second wave that covered us. The standard that was waiting</a></li>
<li><a href="../343006/index.html">Russian AI Cup: Participant's Toolkit</a></li>
<li><a href="../343008/index.html">Development of sustainability strategies</a></li>
<li><a href="../343010/index.html">Renga BIM API</a></li>
<li><a href="../343012/index.html">Scrum is not only in development - we use a flexible methodology in organizing an IT festival for children and parents</a></li>
<li><a href="../343016/index.html">Ray casting in the web world today</a></li>
<li><a href="../343018/index.html">13 conclusions that I made, after 4 years of using Ext JS</a></li>
<li><a href="../343020/index.html">Heisenbug 2017 Moscow Program Review: How many testers are needed to run tests at a nuclear power plant?</a></li>
<li><a href="../343022/index.html">Basics of React: everything you need to know to get started</a></li>
<li><a href="../343024/index.html">Seminar "Clouds for Critical Systems", November 30, St. Petersburg</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>