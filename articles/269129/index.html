<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parsing Java programs using java programs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Understood with the theory in the publication "Modification of the program and what better to change: the executable code or AST program?" . Let's go ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parsing Java programs using java programs</h1><div class="post__text post__text-html js-mediator-article">  Understood with the theory in the publication <a href="http://habrahabr.ru/post/269037/">"Modification of the program and what better to change: the executable code or AST program?"</a> .  Let's go to practice using the Eclipse java compiler API. <br><br><img src="https://habrastorage.org/files/a24/d35/d88/a24d35d88a8d48b1834172661d8255c2.jpg"><br><br>  A Java program that digests a java program begins with working on an abstract syntax tree (AST) ... <br><a name="habracut"></a><br>  Before transforming a program, it would be good to learn how to work with its <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25B1%25D1%2581%25D1%2582%25D1%2580%25D0%25B0%25D0%25BA%25D1%2582%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2581%25D0%25B8%25D0%25BD%25D1%2582%25D0%25B0%25D0%25BA%25D1%2581%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25BE%25D0%25B5_%25D0%25B4%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B2%25D0%25BE">intermediate representation</a> in the computer's memory.  With this, let's begin. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I will repeat the conclusions from my previous publication that there is no public and universal API for analyzing the source texts on java for working with the abstract syntax tree of the program.  You will have to work with either <a href="http://docs.oracle.com/javase/8/docs/jdk/api/javac/tree/index.html">com.sun.source.tree. *</a> Or org.eclipse.jdt.core.dom. * <br><br>  The choice for an example in this article is the Eclipse java compiler (ejc) and its AST model <a href="http://help.eclipse.org/mars/index.jsp%3Ftopic%3D%252Forg.eclipse.jdt.doc.isv%252Freference%252Fapi%252Forg%252Feclipse%252Fjdt%252Fcore%252Fdom%252FExpression.html">org.eclipse.jdt.core.dom. *</a> <br><br>  I‚Äôll give a few reasons in favor of ejc: <br><ul><li>  available in the <a href="">maven repository</a> and no need to hope for the availability of tools.jar </li><li>  implements the JavaCompiler API </li><li>  supports java 8 </li><li>  works in the Eclipse Java IDE and therefore ejc is quite a popular compiler </li></ul><br><br>  The program that I wrote for the example of working with the AST java program will bypass all classes from the jar file and analyze the calls of the methods of the logging classes org.slf4j.Logger, org.apache.commons.logging.Log, org.springframework.boot that interest us. .cli.util.Log <br><br>  The task of finding the source text for a class is easily solved if the project was published in the maven repository together with an artifact of type source and in the jar with classes there are files pom.properties or pom.xml.  With the extraction of this information, at the time of program execution, we will be helped by the MavenCoordHelper class from the io.fabric8.insight artifact: insight-log4j and the class loader from the Maven MavenClassLoader repository from the com.github.smreed: dropship artifact. <br><br>  MavenCoordHelper allows you to find for a given class the coordinates of a groupId: artifactId: version from the pom.properties file in this jar file <br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMavenSourcesId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String className)</span></span></span><span class="hljs-function"> </span></span>{ String mavenCoordinates = io.fabric8.insight.log.log4j.MavenCoordHelper.getMavenCoordinates(className); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(mavenCoordinates==<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; DefaultArtifact artifact = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultArtifact(mavenCoordinates); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> String.format(<span class="hljs-string"><span class="hljs-string">"%s:%s:%s:sources:%s"</span></span>, artifact.getGroupId(), artifact.getArtifactId(), artifact.getExtension(), artifact.getVersion()); }</code> </pre> <br><br>  MavenClassLoader allows you to load source text on these coordinates for analysis and create a classpath (including transitive dependencies) to define types in the program.  Download from the maven repository: <br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> LoadingCache&lt;String, URLClassLoader&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createMavenClassloaderCache</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CacheBuilder.newBuilder() .maximumSize(MAX_CACHE_SIZE) .build(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CacheLoader&lt;String, URLClassLoader&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> URLClassLoader </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String mavenId)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> com.github.smreed.dropship.MavenClassLoader.forMavenCoordinates(mavenId); } }); }</code> </pre><br><br>  The initialization of the EJC compiler itself and working with AST are quite simple: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.github.igorsuhorukov.java.ast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.common.cache.LoadingCache; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.jdt.core.JavaCore; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.jdt.core.dom.AST; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.jdt.core.dom.ASTParser; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.jdt.core.dom.CompilationUnit; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.URLClassLoader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Set; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> com.github.igorsuhorukov.java.ast.ParserUtils.*; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Parser</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String[] SOURCE_PATH = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{System.getProperty(<span class="hljs-string"><span class="hljs-string">"java.io.tmpdir"</span></span>)}; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String[] SOURCE_ENCODING = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(args.length!=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IllegalArgumentException(<span class="hljs-string"><span class="hljs-string">"Class name should be specified"</span></span>); String file = getJarFileByClass(Class.forName(args[<span class="hljs-number"><span class="hljs-number">0</span></span>])); Set&lt;String&gt; classes = getClasses(file); LoadingCache&lt;String, URLClassLoader&gt; classLoaderCache = createMavenClassloaderCache(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String currentClassName : classes) { String mavenSourcesId = getMavenSourcesId(currentClassName); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mavenSourcesId == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IllegalArgumentException(<span class="hljs-string"><span class="hljs-string">"Maven group:artifact:version not found for class "</span></span> + currentClassName); URLClassLoader urlClassLoader = classLoaderCache.get(mavenSourcesId); ASTParser parser = ASTParser.newParser(AST.JLS8); parser.setResolveBindings(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); parser.setKind(ASTParser.K_COMPILATION_UNIT); parser.setCompilerOptions(JavaCore.getOptions()); parser.setEnvironment(prepareClasspath(urlClassLoader), SOURCE_PATH, SOURCE_ENCODING, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); parser.setUnitName(currentClassName + <span class="hljs-string"><span class="hljs-string">".java"</span></span>); String sourceText = getClassSourceCode(currentClassName, urlClassLoader); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(sourceText == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; parser.setSource(sourceText.toCharArray()); CompilationUnit cu = (CompilationUnit) parser.createAST(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); cu.accept(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LoggingVisitor(cu, currentClassName)); } } }</code> </pre><br>  Having created a parser, we indicate that the source code will correspond to the Java 8 language specification <br><blockquote>  ASTParser parser = ASTParser.newParser (AST.JLS8); </blockquote><br>  And that after parsing, it is necessary to resolve identifier types based on the classpath, which we passed to the compiler <br><blockquote>  parser.setResolveBindings (true); </blockquote><br>  The source code of the class is passed to the parser by calling <br><blockquote>  parser.setSource (sourceText.toCharArray ()); </blockquote><br>  Create an AST tree of this class. <br><blockquote>  CompilationUnit cu = (CompilationUnit) parser.createAST (null); </blockquote><br>  And we get events when traversing AST using our Visitor class <br><blockquote>  cu.accept (new LoggingVisitor (cu, currentClassName)); </blockquote><br><br>  By extending the <b>ASTVisitor</b> class and overloading the <b>public boolean visit (MethodInvocation node)</b> method in it, we pass it to the ejc compiler.  In this handler, we analyze that this is exactly the methods of those classes that we are interested in and after that we analyze the arguments of the method being called. <br><br>  When traversing the AST program tree, which also contains additional information about types, our visit method will be called.  In it, we get information about the location of the token in the source file, parameters, expressions, etc. <br><br>  The main stuffing with analysis of the places of interest for calling logger methods in the analyzed program is encapsulated in LoggingVisitor: <br><div class="spoiler">  <b class="spoiler_title">LoggingVisitor.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.github.igorsuhorukov.java.ast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.eclipse.jdt.core.dom.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.HashSet; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.List; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Set; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoggingVisitor</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ASTVisitor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Set&lt;String&gt; LOGGER_CLASS = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashSet&lt;String&gt;() {{ add(<span class="hljs-string"><span class="hljs-string">"org.slf4j.Logger"</span></span>); add(<span class="hljs-string"><span class="hljs-string">"org.apache.commons.logging.Log"</span></span>); add(<span class="hljs-string"><span class="hljs-string">"org.springframework.boot.cli.util.Log"</span></span>); }}; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Set&lt;String&gt; LOGGER_METHOD = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashSet&lt;String&gt;() {{ add(<span class="hljs-string"><span class="hljs-string">"fatal"</span></span>); add(<span class="hljs-string"><span class="hljs-string">"error"</span></span>); add(<span class="hljs-string"><span class="hljs-string">"warn"</span></span>); add(<span class="hljs-string"><span class="hljs-string">"info"</span></span>); add(<span class="hljs-string"><span class="hljs-string">"debug"</span></span>); add(<span class="hljs-string"><span class="hljs-string">"trace"</span></span>); }}; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String LITERAL = <span class="hljs-string"><span class="hljs-string">"Literal"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String FORMAT_METHOD = <span class="hljs-string"><span class="hljs-string">"format"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> CompilationUnit cu; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String currentClassName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoggingVisitor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CompilationUnit cu, String currentClassName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.cu = cu; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.currentClassName = currentClassName; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">visit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(MethodInvocation node)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (LOGGER_METHOD.contains(node.getName().getIdentifier())) { ITypeBinding objType = node.getExpression() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ? node.getExpression().resolveTypeBinding() : <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (objType != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; LOGGER_CLASS.contains(objType.getBinaryName())) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> lineNumber = cu.getLineNumber(node.getStartPosition()); <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> isFormat = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> isConcat = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> isLiteral1 = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> isLiteral2 = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> isMethod = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> withException = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; node.arguments().size(); i++) { ASTNode innerNode = (ASTNode) node.arguments().get(i); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i == node.arguments().size() - <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> SimpleName &amp;&amp; ((SimpleName) innerNode).resolveTypeBinding() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { ITypeBinding typeBinding = ((SimpleName) innerNode).resolveTypeBinding(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (typeBinding != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; Object.class.getName().equals(typeBinding.getBinaryName())) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Throwable.class.getName().equals(typeBinding.getBinaryName())) { withException = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } typeBinding = typeBinding.getSuperclass(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (withException) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> MethodInvocation) { MethodInvocation methodInvocation = (MethodInvocation) innerNode; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (FORMAT_METHOD.equals(methodInvocation.getName().getIdentifier()) &amp;&amp; methodInvocation.getExpression() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; methodInvocation.getExpression().resolveTypeBinding() != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; String.class.getName().equals(methodInvocation.getExpression().resolveTypeBinding().getBinaryName())) { isFormat = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { isMethod = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> InfixExpression) { InfixExpression infixExpression = (InfixExpression) innerNode; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (InfixExpression.Operator.PLUS.equals(infixExpression.getOperator())) { List expressions = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList(); expressions.add(infixExpression.getLeftOperand()); expressions.add(infixExpression.getRightOperand()); expressions.addAll(infixExpression.extendedOperands()); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> stringLiteralCount = expressions.stream().filter(item -&gt; item <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> StringLiteral).count(); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> notLiteralCount = expressions.stream().filter(item -&gt; item.getClass().getName().contains(LITERAL)).count(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (notLiteralCount &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; stringLiteralCount &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { isConcat = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> Expression &amp;&amp; innerNode.getClass().getName().contains(LITERAL)) { isLiteral1 = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> SimpleName || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> QualifiedName || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> ConditionalExpression || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> ThisExpression || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> ParenthesizedExpression || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> PrefixExpression || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> PostfixExpression || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> ArrayCreation || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> ArrayAccess || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> FieldAccess || innerNode <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> ClassInstanceCreation) { isLiteral2 = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } String type = loggerInvocationType(node, isFormat, isConcat, isLiteral1 || isLiteral2, isMethod); System.out.println(currentClassName + <span class="hljs-string"><span class="hljs-string">":"</span></span> + lineNumber + <span class="hljs-string"><span class="hljs-string">"\t\t\t"</span></span> + node+<span class="hljs-string"><span class="hljs-string">"\t\ttype "</span></span>+type); <span class="hljs-comment"><span class="hljs-comment">//node.getStartPosition() } } return true; } private String loggerInvocationType(MethodInvocation node, boolean isFormat, boolean isConcat, boolean isLiteral, boolean isMethod) { if (!isConcat &amp;&amp; !isFormat &amp;&amp; isLiteral) { return "literal"; } else { if (isFormat &amp;&amp; isConcat) { return "format concat"; } else if (isFormat &amp;&amp; !isLiteral) { return "format"; } else if (isConcat &amp;&amp; !isLiteral) { return "concat"; } else { if (isConcat || isFormat || isLiteral) { if (node.arguments().size() == 1) { return "single argument"; } else { return "mixed logging"; } } } if(isMethod){ return "method"; } } return "unknown"; } }</span></span></code> </pre></div></div><br><br>  The dependencies of the analyzer program required for compilation and operation are described in <br><div class="spoiler">  <b class="spoiler_title">pom.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">parent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.sonatype.oss<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>oss-parent<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>7<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">parent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.github.igor-suhorukov<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>java-ast<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span>jar<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0-SNAPSHOT<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven.compiler.source</span></span></span><span class="hljs-tag">&gt;</span></span>1.8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven.compiler.source</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven.compiler.target</span></span></span><span class="hljs-tag">&gt;</span></span>1.8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven.compiler.target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">insight.version</span></span></span><span class="hljs-tag">&gt;</span></span>1.2.0.redhat-133<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">insight.version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- EJC --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.eclipse.tycho<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>org.eclipse.jdt.core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.11.0.v20150602-1242<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.eclipse.core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>runtime<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.9.100-v20131218-1515<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.eclipse.birt.runtime<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>org.eclipse.core.resources<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>3.8.101.v20130717-0806<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- MAVEN --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>io.fabric8.insight<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>insight-log4j<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${insight.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exclusions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exclusion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exclusion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">exclusions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>io.fabric8.insight<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>insight-log-core<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${insight.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>io.fabric8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>common-util<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${insight.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.github.igor-suhorukov<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>aspectj-scripting<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">classifier</span></span></span><span class="hljs-tag">&gt;</span></span>agent<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">classifier</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.google.guava<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>guava<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>19.0-rc2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- Dependency to analyze --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.googlecode.log4jdbc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>log4jdbc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></div></div><br>  Part of the "street magic", which helps with parsing, is hidden in the class ParserUtils, implemented at the expense of third-party libraries and discussed above. <br><br><div class="spoiler">  <b class="spoiler_title">ParserUtils.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.github.igorsuhorukov.java.ast; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.common.cache.CacheBuilder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.common.cache.CacheLoader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.common.cache.LoadingCache; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.common.io.CharStreams; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.sonatype.aether.util.artifact.DefaultArtifact; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.InputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.InputStreamReader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.URL; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.URLClassLoader; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.security.CodeSource; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Arrays; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Collections; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Set; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.function.Function; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.jar.JarEntry; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.jar.JarFile; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.stream.Collectors; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ParserUtils</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> MAX_CACHE_SIZE = <span class="hljs-number"><span class="hljs-number">1000</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> Set&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getClasses</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String file)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Collections.list(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JarFile(file).entries()).stream() .filter(jar -&gt; jar.getName().endsWith(<span class="hljs-string"><span class="hljs-string">"class"</span></span>) &amp;&amp; !jar.getName().contains(<span class="hljs-string"><span class="hljs-string">"$"</span></span>)) .map(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Function&lt;JarEntry, String&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">apply</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JarEntry jarEntry)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> jarEntry.getName().replace(<span class="hljs-string"><span class="hljs-string">".class"</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).replace(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-string"><span class="hljs-string">'.'</span></span>); } }).collect(Collectors.toSet()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMavenSourcesId</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String className)</span></span></span><span class="hljs-function"> </span></span>{ String mavenCoordinates = io.fabric8.insight.log.log4j.MavenCoordHelper.getMavenCoordinates(className); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(mavenCoordinates==<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; DefaultArtifact artifact = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultArtifact(mavenCoordinates); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> String.format(<span class="hljs-string"><span class="hljs-string">"%s:%s:%s:sources:%s"</span></span>, artifact.getGroupId(), artifact.getArtifactId(), artifact.getExtension(), artifact.getVersion()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> LoadingCache&lt;String, URLClassLoader&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createMavenClassloaderCache</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CacheBuilder.newBuilder() .maximumSize(MAX_CACHE_SIZE) .build(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CacheLoader&lt;String, URLClassLoader&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> URLClassLoader </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String mavenId)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> com.github.smreed.dropship.MavenClassLoader.forMavenCoordinates(mavenId); } }); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String[] prepareClasspath(URLClassLoader urlClassLoader) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Arrays.stream(urlClassLoader.getURLs()).map(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Function&lt;URL, String&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">apply</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(URL url)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> url.getFile(); } }).toArray(String[]::<span class="hljs-keyword"><span class="hljs-keyword">new</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getJarFileByClass</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Class&lt;?&gt; clazz)</span></span></span><span class="hljs-function"> </span></span>{ CodeSource source = clazz.getProtectionDomain().getCodeSource(); String file = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (source != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { URL locationURL = source.getLocation(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">"file"</span></span>.equals(locationURL.getProtocol())) { file = locationURL.getPath(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { file = locationURL.toString(); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> file; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getClassSourceCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String className, URLClassLoader urlClassLoader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ String sourceText = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (InputStream javaSource = urlClassLoader.getResourceAsStream(className.replace(<span class="hljs-string"><span class="hljs-string">"."</span></span>, <span class="hljs-string"><span class="hljs-string">"/"</span></span>) + <span class="hljs-string"><span class="hljs-string">".java"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (javaSource != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (InputStreamReader sourceReader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(javaSource)){ sourceText = CharStreams.toString(sourceReader); } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sourceText; } }</code> </pre></div></div><br>  Running com.github.igorsuhorukov.java.ast.Parser for execution and passing, as a parameter for analysis, the name of the class net.sf.log4jdbc.ConnectionSpy <br><br>  Get the output in the console, from which you can understand which parameters are passed to the methods: <div class="spoiler">  <b class="spoiler_title">Application console</b> <div class="spoiler_text"><blockquote>  [Dropship WARN] No dropship.properties found!  Using .dropship-prefixed system properties (-D) <br>  [Dropship INFO] Collecting maven metadata. <br>  [Dropship INFO] Resolving dependencies. <br>  [Dropship INFO] Building classpath for com.googlecode.log4jdbc: log4jdbc: jar: sources: 1.2 from 2 URLs. <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 104 jdbcLogger.error (header, e) type literal <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 105 sqlOnlyLogger.error (header, e) type literal <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 106 sqlTimingLogger.error (header, e) type literal <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 111 jdbcLogger.error (header + "" + sql, e) type mixed logging <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 116 sqlOnlyLogger.error (getDebugInfo () + nl + spyNo + "." + sql, e) type mixed logging <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 120 sqlOnlyLogger.error (header + "" + sql, e) type mixed logging <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 126 sqlTimingLogger.error (getDebugInfo () + nl + spyNo + "." + sql + "{FAILED after" + execTime + "msec}", e) type mixed logging <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 130 sqlTimingLogger.error (header + "FAILED!" + sql + "{FAILED after" + execTime + "msec}", e) type mixed logging <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 158 logger.debug (header + "" + getDebugInfo ()) type concat <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 162 logger.info (header) type literal <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 221 sqlOnlyLogger.debug (getDebugInfo () + nl + spy.getConnectionNumber () + "." + processSql (sql)) type concat <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 226 sqlOnlyLogger.info (processSql (sql)) type method <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 352 sqlTimingLogger.error (buildSqlTimingDump (spy, execTime, methodCall, sql, sqlTimingLogger.isDebugEnabled ())) type method <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 360 sqlTimingLogger.warn (buildSqlTimingDump (spy, execTime, methodCall, sql, sqlTimingLogger.isDebugEnabled ())) type method <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 365 sqlTimingLogger.debug (buildSqlTimingDump (spy, execTime, methodCall, sql, true)) type method <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 370 sqlTimingLogger.info (buildSqlTimingDump (spy, execTime, methodCall, sql, false)) type method <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 519 debugLogger.debug (msg) type literal <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 531 connectionLogger.info (spy.getConnectionNumber () + ". Connection opened" + getDebugInfo ()) type concat <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 533 connectionLogger.debug (ConnectionSpy.getOpenConnectionsDump ()) type method <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 537 connectionLogger.info (spy.getConnectionNumber () + ". Connection opened") type concat <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 550 connectionLogger.info (spy.getConnectionNumber () + ". Connection closed" + getDebugInfo ()) type concat <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 552 connectionLogger.debug (ConnectionSpy.getOpenConnectionsDump ()) type method <br>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 556 connectionLogger.info (spy.getConnectionNumber () + ". Connection closed") type concat <br></blockquote><br></div></div><br><br>  For example, if when you call the info method, concatenation of the spy.getConnectionNumber () method call, the string ". Connection opened" and the getDebugInfo () method call to the string occurs, we get the message that this is a <b>concat</b> <br><blockquote>  net.sf.log4jdbc.Slf4jSpyLogDelegator: 531 connectionLogger.info (spy.getConnectionNumber () + ". Connection opened" + getDebugInfo ()) type concat <br></blockquote><br>  And after that we could transform the source text in such a way as to replace the concatenation operation in the parameters of this method, calling the method with the pattern "{}. Connection opened {}" and the parameters spy.getConnectionNumber (), getDebugInfo ().  And then this more machine-readable call and information from it can be sent immediately to Elasticsearch, which I already mentioned in the article <a href="http://habrahabr.ru/post/267009/">‚ÄúPublishing logs to Elasticsearch - life without regular expressions and without logstash‚Äù</a> . <br><br>  As you can see, parsing and analyzing java programs is easy to implement in java code using the ejc compiler and it is also easy to programmatically obtain source codes for classes of interest from the Maven repository.  An example from the article is available on <a href="https://github.com/igor-suhorukov/java-ast-example">github</a> <br><br>  Ahead of us is the Java agent, modification and compilation into runtime is the task. <div class="spoiler">  <b class="spoiler_title">bigger and harder than just digesting AST ...</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/142/98e/b52/14298eb52cba4f2aa3774934333844a0.jpg"></div></div><br><br>  See you soon! </div><p>Source: <a href="https://habr.com/ru/post/269129/">https://habr.com/ru/post/269129/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269119/index.html">Balancing 70 thousand requests per second on HighLoad ++</a></li>
<li><a href="../269121/index.html">Proper migration from MyISAM to InnoDB</a></li>
<li><a href="../269123/index.html">Ansible and reverse-proxy servers</a></li>
<li><a href="../269125/index.html">The acquisition of Zend still does not mean anything</a></li>
<li><a href="../269127/index.html">Quantum communications: from research to technology business</a></li>
<li><a href="../269135/index.html">A simple client server on Android (Internet messenger)</a></li>
<li><a href="../269137/index.html">Mobility Express - a new approach to small Wi-Fi networks</a></li>
<li><a href="../269139/index.html">The critical difference between compiling the expression tree in Visual Studio 2015</a></li>
<li><a href="../269141/index.html">The book "Java EE. Design patterns for professionals ¬ª</a></li>
<li><a href="../269147/index.html">Algorithms: theory and practice. Methods</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>