<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We work with relational data using Backend-as-a-Service</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi habra people 

 Today we will launch a JavaScript application that writes out an invoice directly from the server using the interaction with the AP...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We work with relational data using Backend-as-a-Service</h1><div class="post__text post__text-html js-mediator-article">  Hi habra people <br><br>  Today we will launch a JavaScript application that writes out an invoice directly from the server using the interaction with the API of the BaaS platform.  To develop the application, it was necessary to write 0 lines of code on the server side, despite the fact that the application has a remote (and full) data storage, the ability to register a user and support login.  Source code is available on github. <br><br><img src="https://habrastorage.org/storage2/661/cef/fe4/661ceffe4a7de269e3fa605c3b57ccea.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Under the cut are the details showing the simplicity of the BaaS approach in working with complex objects using Backendless. <br><a name="habracut"></a><br>  The framework for this application ‚ÄúThe Editable Invoice‚Äù (hereinafter ‚Äúeditable invoice‚Äù) was developed by <a href="http://nobackend.org/">noBackend.org</a> , which helps developers to learn about the benefits of the BaaS approach.  Their vision is to provide examples of recommended implementations on various backends.  This application has recently been ported to the <a href="http://backendless.com/">Backendless</a> platform.  The source code of the project can be downloaded from <a href="https://github.com/Backendless/JS-Examples/tree/master/editable-invoice">github</a> . <br><br><img src="https://habrastorage.org/storage2/047/7a0/b68/0477a0b68fb571b72d0a7c22e8c755f0.png"><br><br>  (Who missed the first post of the Russian-language review of all API of our platform, can find it <a href="http://habrahabr.ru/company/backendless/blog/180367/">here</a> .) <br><br>  The application is an ‚Äúeditable invoice‚Äù that automatically saves data, including lists of items, the buyer's address, your own address, account number, etc.  This is a good example that demonstrates how to work with relational data, which means that it is possible to save a hierarchy or objects containing other objects (the ‚ÄúInvoice‚Äù object containing the ‚ÄúName Lists‚Äù collection).  The application also demonstrates the functionality of the services for user registration and login, although we stopped at linking accounts with user accounts (in principle, it is fairly easy to add). <br><br><div class="spoiler">  <b class="spoiler_title">Description Date of Service</b> <div class="spoiler_text">  <b>Data Service API</b> (relational data) - provides storage of user data.  Applications can store, update, delete data and carry out search queries. <br><br>  <i>Explanation: it is possible to work with the service without having any knowledge about the databases.</i>  <i>The platform allows you to create your own tables and links between them using the API.</i>  <i>On the client, it is enough to create a data structure, when calling the KFK method, the server will create the necessary tables and link them together.</i>  <i>Or it can be done using an intuitive user interface via the web console.</i> <br><br>  Additional information and the algorithm of the date of service can be found in the <a href="http://backendless.com/documentation/data/js/data_overview.htm">documentation</a> . <br></div></div><br>  So, you need to perform the following steps to configure and see the application in action: <br><br>  1. We <a href="https://backendless.com/develop">register or go</a> to the developer‚Äôs web console via FB authentication.  The application is created during the registration process or you can create it later at any time. <br><br>  2. After logging in to the console, select the application. <br><br>  3. Click the ‚ÄúManage‚Äù icon.  The application settings window opens.  The window contains many useful settings and properties, but for now only the Application ID and Secret Key for JavaScript clients will be needed. <br><br><img src="https://habrastorage.org/storage2/fb5/f66/370/fb5f6637044bd188dabd1b1f3c884a54.png"><br><br>  4. Leave the browser window open (you will need to copy / paste the ID and Key from this window) and open /editable-invoice/backendless/applogic.js in a text editor. <br><br>  5. Copy / paste the Application ID and Secret Key into the code in line 1: <br><br><pre><code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> Backendless.initApp(<span class="hljs-string"><span class="hljs-string">"PUT-YOUR-APP-ID-HERE"</span></span>, <span class="hljs-string"><span class="hljs-string">"PUT-YOUR-JS-SECRET-KEY-HERE"</span></span>, <span class="hljs-string"><span class="hljs-string">"v1"</span></span>);</code> </pre> <br>  6. One additional configuration step is required before launching the application.  Click the ‚ÄúUsers‚Äù icon in the Backendless console.  The ‚ÄúUser Properties‚Äù opens by default.  Using this window you can use the user properties to be used in the Editable Invoice application.  Click the ‚ÄúAdd Custom Property‚Äù button and add ‚Äúlogin‚Äù. <br><br><img src="https://habrastorage.org/storage2/88d/c00/eb0/88dc00eb05d5101cfbaae432f730aa69.jpeg"><br><br>  7. Click ‚ÄúSave‚Äù.  Make sure to select the ‚Äúlogin‚Äù property as ‚ÄúIdentity‚Äù by selecting the radio button for this property.  The ‚ÄúUser Properties‚Äù window should look like the one below: <br><br><img src="https://habrastorage.org/storage2/95b/ede/8a0/95bede8a058a135f5bb9cbf4ed48ea5d.jpeg"><br><br>  8. Run the example.  You can open editable-invoice / index.html in the browser directly from the file system.  Alternatively, you can launch the entire application on a web server and download editable-invoice / index.html via a URL. <br><br>  <b>Try the following actions after running the application:</b> <br><br><ul><li>  Change the name of the account by changing the main title at the top. </li><li>  Change the ‚ÄúYour Address‚Äù field. </li><li>  Change the ‚ÄúYour client's address‚Äù field. </li><li>  Add a new name in the invoice - enter the article number, description, unit price and quantity.  Click the ‚ÄúAdd item‚Äù button. </li><li>  Reload the application - you should see an account with the changes you made. </li><li>  Check out the ‚ÄúSign Up / Sign In‚Äù form. </li><li>  Login to the Backendless console and check the registered users in Data&gt; Users, as well as the data saved by the application in the ‚Äúinvoice‚Äù and ‚Äúitem‚Äù tables - the tables will be created automatically as soon as you start using the example. </li></ul><br>  <b>Review Code</b> <br>  <i>Below are some examples of using the Backendless API in an application:</i> <br><br>  <b>Download all invoices when the application starts</b> <br>  (/backendless/applogic.js, lines 3-15) <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> $(<span class="hljs-string"><span class="hljs-string">'document'</span></span>).ready( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) 2 </span></span>{ <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-comment"><span class="hljs-comment">// bootstrap &amp; render App 4 App.store = {}; 5 App.store.invoices = Backendless.Persistence.of(function invoice(){}); 6 try 7 { 8 renderApp(App.store.invoices.find( 9 { 10 options: 11 { 12 related: ["items"] 13 } 14 }).data ); 15 } 16 catch(e) 17 { 18 renderApp( [] ); 19 } 20 ...</span></span></code> </pre> <br>  Line 5 contains the ‚Äúinvoices‚Äù link to the saved data in Backendless.  The returned object provides access to CRUD (Create, Retrieve, Update, Delete) operations for this table. <br><br>  Line 8 (find) sends a request to load all previously saved invoice objects. <br><br>  Lines 10‚Äì13 request that the invoice objects returned by the platform include references to the corresponding ‚Äúitems‚Äù objects (the invoice contains lower case names or simply ‚Äúitems‚Äù). <br><br>  <b>Save / Update Invoice</b> <br>  (/backendless/applogic.js, lines 39-62) <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handleInvoiceSave = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">properties</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = App.store.invoices.find({ <span class="hljs-number"><span class="hljs-number">4</span></span> options:{ <span class="hljs-number"><span class="hljs-number">5</span></span> related: [<span class="hljs-string"><span class="hljs-string">"items"</span></span>] <span class="hljs-number"><span class="hljs-number">6</span></span> }, <span class="hljs-number"><span class="hljs-number">7</span></span> condition: <span class="hljs-string"><span class="hljs-string">"id='"</span></span> + properties.id +<span class="hljs-string"><span class="hljs-string">"'"</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> }).data[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(obj){ <span class="hljs-number"><span class="hljs-number">11</span></span> properties.objectId = obj[<span class="hljs-string"><span class="hljs-string">"__updated__objectId"</span></span>] || obj.objectId; <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; obj.items.length; i++){ <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; properties.items.length; j++){ <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(properties.items[j].id == obj.items[i].id){ <span class="hljs-number"><span class="hljs-number">15</span></span> properties.items[j].objectId = obj.items[i].objectId; <span class="hljs-number"><span class="hljs-number">16</span></span> } <span class="hljs-number"><span class="hljs-number">17</span></span> } <span class="hljs-number"><span class="hljs-number">18</span></span> } <span class="hljs-number"><span class="hljs-number">19</span></span> } <span class="hljs-number"><span class="hljs-number">20</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(e){ <span class="hljs-number"><span class="hljs-number">21</span></span> }<span class="hljs-keyword"><span class="hljs-keyword">finally</span></span>{ <span class="hljs-number"><span class="hljs-number">22</span></span> App.store.invoices.save(properties); <span class="hljs-number"><span class="hljs-number">23</span></span> } <span class="hljs-number"><span class="hljs-number">24</span></span> }</code> </pre> <br>  Lines 3-7: Verify that the invoice was previously saved.  The parameter ‚Äúcondition‚Äù is used where the search by invoice is specified by the parameter ‚Äúid‚Äù. <br><br>  Lines 10-19: if an account is found (i.e., it has been previously saved), it iterates over the names and is assigned the ‚ÄúobjectId‚Äù name.  In this example, each item has an id, which is assigned on the client side (/shared/js/invoice.js, lines 14 and 28).  On top of this, Backendless assigns a unique ID to each saved object.  This ID is stored in the ‚ÄúobjectId‚Äù parameters.  It is important to maintain consistency between objects by verifying ID parameters.  This code block performs this action for the save operation. <br><br>  Line 22: As soon as IDs are assigned, the entire invoice (with all names) is saved. <br><br>  <b>Deleting Invoice</b> <br>  (/backendless/applogic.js, lines 64-68) <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handleInvoiceDelete = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">properties</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"delete invoice"</span></span>); <span class="hljs-number"><span class="hljs-number">3</span></span> App.store.invoices.remove( properties, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Backendless.Async(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-number"><span class="hljs-number">4</span></span> })); <span class="hljs-number"><span class="hljs-number">5</span></span> }</code> </pre> <br>  <b>User Registration</b> <br>  (/backendless/applogic.js, lines 82-93) <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handleSignUp = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">inputs</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> user = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Backendless.User(); <span class="hljs-number"><span class="hljs-number">3</span></span> user.login = inputs.username; <span class="hljs-number"><span class="hljs-number">4</span></span> user.email = inputs.email; <span class="hljs-number"><span class="hljs-number">5</span></span> user.password = inputs.password; <span class="hljs-number"><span class="hljs-number">6</span></span> Backendless.UserService.register( user, <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Backendless.Async( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-number"><span class="hljs-number">8</span></span> App.hideModalForm() <span class="hljs-number"><span class="hljs-number">9</span></span> }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-number"><span class="hljs-number">10</span></span> App.renderModalFormError({<span class="hljs-attr"><span class="hljs-attr">error</span></span>: data.message}); <span class="hljs-number"><span class="hljs-number">11</span></span> })); <span class="hljs-number"><span class="hljs-number">12</span></span> };</code> </pre> <br>  Lines 2-5: A Backendless.User object is created that contains values ‚Äã‚Äãfor all user parameters defined in clause 7 above. <br><br>  Lines 6-11: A request is sent to Backendless to register a user.  The request is asynchronous with a Backendless.Async object that conducts callbacks for success and error functions. <br><br>  <b>User Login</b> <br>  (/backendless/applogic.js, lines 94-104) <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> handleSignIn = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">inputs</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-number"><span class="hljs-number">2</span></span> Backendless.UserService.login( inputs.username, inputs.password, <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Backendless.Async( <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-number"><span class="hljs-number">4</span></span> App.user = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Backendless.User(data); <span class="hljs-number"><span class="hljs-number">5</span></span> App.hideModalForm(); <span class="hljs-number"><span class="hljs-number">6</span></span> App.renderUserSignedIn(data); <span class="hljs-number"><span class="hljs-number">7</span></span> },<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-number"><span class="hljs-number">8</span></span> App.renderUserAuthenticationError(); <span class="hljs-number"><span class="hljs-number">9</span></span> App.renderModalFormError({<span class="hljs-attr"><span class="hljs-attr">error</span></span>: data.message}); <span class="hljs-number"><span class="hljs-number">10</span></span> }) ); <span class="hljs-number"><span class="hljs-number">11</span></span> };</code> </pre> <br>  Line 2: A login request is sent to Backendless.  The first argument should be the value for the ‚ÄúIdentity‚Äù parameter (see item 7 above). <br><br>  The End.  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/184598/">https://habr.com/ru/post/184598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../184580/index.html">Scientists have created the most detailed 3D model of the human brain</a></li>
<li><a href="../184584/index.html">The quadcopter on the radio has received sufficient funding on Kickstarter</a></li>
<li><a href="../184590/index.html">The influence of buns on the choice of the company: Student Edition</a></li>
<li><a href="../184594/index.html">Distribution of servers from the orange dude</a></li>
<li><a href="../184596/index.html">About the features of the location of controls in mobile applications</a></li>
<li><a href="../184600/index.html">Mr. Big - Xperia Z Ultra Announcement</a></li>
<li><a href="../184602/index.html">SmartWatch 2 - even smarter!</a></li>
<li><a href="../184606/index.html">Overview of the new features of C ++ 14: Part 1</a></li>
<li><a href="../184610/index.html">Computer vision allows you to see the pulse of a person, even if he wears a mask</a></li>
<li><a href="../184612/index.html">Portal under Linux came out</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>