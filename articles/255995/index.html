<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Develop a simple game in the game maker. Episode 0. First lines</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you like games, no doubt wondered how they are made. If you have (or will) a desire to make games, but no experience, in this article I will tell y...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Develop a simple game in the game maker. Episode 0. First lines</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/8f2/eb1/617/8f2eb16176224f68867634de67ad1f31.png" width="720"></div><br><br>  If you like games, no doubt wondered how they are made.  If you have (or will) a desire to make games, but no experience, in this article I will tell you how to get started. <br><br>  I would like to talk about the Game Maker game engine and post several posts in which we will write a clone of a non-complicated game, for example, Plants vs Zombies.  Perhaps we will add support for the gamepad and make, for example, the Android version. <br><a name="habracut"></a><br>  The source codes will be open, but the graphics, if there is no one who wants to draw it for free and share it with the community, will be bought on GraphicRiver and will not be distributed for obvious reasons with the game.  Well, the game will not have an abundance of animations either. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Introduction </h4><br>  Game Maker is an incredibly simple game engine that allows you to create games for a large number of platforms - Windows, Mac OS X, Ubuntu, Android, iOS, Tizen, Windows Phone, Windows 8, PlayStation 3, PS 4, PS Vita, Xbox One and HTML 5. There is support for SteamWorks.  If your game succeeds, porting to another platform will not be a difficult task. <br><br>  The speed of development, even with modest knowledge and minimal motivation, is subjectively faster than on other engines.  Installation and setup for beginners is as simple as possible and does not require special knowledge.  Compiling for other platforms does not require changing the game code and is done with one click (well, almost). <br><br>  YoYoGames - the company that created Game Maker, was recently acquired by Playtech, which makes sure that Game Maker will continue to evolve.  The announced Game Maker 2.0 will probably be even more friendly and simple, and it is also logical to assume that it will have even more features.  As they say in a press release, GM 2.0 is one of the reasons for buying the company. <br><br>  In this article I will briefly talk about Game Maker and we will make a simple sketch of the future project. <br><br>  For whom is this engine and for what purpose can it be used? <br>  For all.  The goal is any 2D game.  However, for those for whom programming is not a native element, as well as for rapid prototyping and creating a game with minimal effort for anyone who wants to make games and / or make money on them, Game Maker is ideal. <br><br><h4>  Pros Game Maker </h4><br>  - simple entry; <br>  - familiar to all in Java / C / C # ... syntax; <br>  - the possibility of easy compilation on different platforms; <br>  - active community, which for many years has already solved many problems and wrote the code for you; <br>  - standard functionality, thanks to which you do not need to write a large amount of code yourself; <br>  - extensibility through extensions; <br>  - Help (F1) is very simple and convenient with excellent explanations and examples. <br><br><h4>  Cons of game maker </h4><br>  - paid (when you grow up to the publication of the game, you have to buy a license); <br>  - there is no auto substitution of user variables, only for standard and scripts; <br>  - the high cost of the maximum license (however, not all need all the modules directly); <br>  - technical support (twice applied to technical support, they did not answer me faster than in 2 weeks); <br>  - there is no possibility of autoreflection. <br><br>  Now to the creation of the game.  I think installing Game Maker and creating an empty project is not a problem.  In general, for the beginning it would be good to think over all the functionality, draw the schematics, think over the monetization, etc., but this is not the purpose of the article, so I will show you a way to create a project for a novice game developer. <br><br>  Let's briefly go over the project structure: <br><ul><li>  Sprites - folder with sprites (images, animations); </li><li>  Objects - objects with their own prepared events (for example, creation, drawing, clicking, etc.); </li><li>  Rooms - game rooms (screens).  For each screen you need to make your room.  Very comfortably; </li><li>  Background - backgrounds that can fill the room.  Also used as tile set. </li></ul><br>  The rest does not interest us yet. <br><br><h4>  What is a sprite in Game Maker? </h4><br>  This is the image / animation used in the game.  They have their own mask, the shape and size of which can be changed.  A mask is an image area that responds to object collision events (if this sprite is assigned to an object), and clicks on it.  You can set the draw point (Origin) - for example, from the center, corner or any other point. <br><br>  You can also set a texture group for the sprite.  It is necessary to optimize the rendering (for example, there is no need to keep in memory the texture pages with images that are used on the menu screen when we now have a game screen).  For each Texture Group, you can specify the platform on which they will act.  For example, for Android, you can have less detailed images than for Windows 8 tablets. <br><br><h4>  What is an object in Game Maker? </h4><br>  This is a description of an entity with its own methods (functions).  Each object draws itself (unless otherwise specified), reacts to standard events - keystrokes, clicks on sprites, etc ... By analogy with OOP, this is a class (class). <br><br><h4>  What is an instance in Game Maker? </h4><br>  If an object is just a description of an entity, then an instance is an instance of an object, its implementation in the game itself.  Having created an instance, you give it life and now all the events that are described in the object will begin to react. <br>  By analogy with OOP, this is an object. <br><br>  The first thing to do is create a new room (in the left pane, right click on Rooms - Create Room).  Let's call it rm_game.  Set the window size in the Settings tab - Width - 800, Height - 480, Speed ‚Äã‚Äã- 60. Ie  our game will take place in a 800x480 window, fps will not exceed and aim for 60 frames.  Save, close. <br><br>  Add some sprites.  Right-click on the folder Sprites -&gt; Create Sprite.  Let's call it spr_unit_shooter, load the image (available on the githaba at the end of the article), for example, size 54x54 and center it (the Center button).  The ‚ÄúOK‚Äù button and data are saved. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/87c/31a/f39/87c31af39c9f47f5b539c88b2a8c116c.png"></div><br><br>  Now we need the first unit.  Let it be a classic shooting plant.  But before that we want to create an object that will be the parent for all user units (yes, about the same as inheritance in OOP).  So you can avoid duplicate logic for all units, and as you will see below, it will be possible to apply to all types created by the game ‚Äúchildren‚Äù of this object. <br><br>  By the principle similar to sprites and rooms, we create an empty object.  Let's call it o_unit_parent and don't do anything with it anymore.  Now we will create o_unit_shooter and in the Parent column we select o_unit_parent.  Let him sprite - spr_unit_shooter.  To do this, use the button, which is under the name. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7a5/be6/2c1/7a5be62c1589441f9b69230e732b4d5c.png"></div><br><br>  Call sprites, objects, rooms, etc.  you can as you like, but in order not to get confused, it is better to immediately call things with their names, for example, sprites with the prefix spr_, obj_ or o_ objects, scripts - scr_, etc. <br><br>  Now, every time you create an o_unit_shooter object in a room, it will draw the sprite of your choice (of course, if you don‚Äôt redefine this with the code). <br><br>  Sprite can also be set programmatically, but in this case it will not be displayed in the Project Structure left preview.  Now we add an event that will be triggered when an object instance is created.  In this event, you must specify the initial initialization of variables, if any.  Click Add Event.  As you can see, Game Maker allows each object to catch a large number of events.  We are interested in - Create. <br><br>  As you can see on the right in the Actions container in several tabs there is a huge amount of drag'n'drop elements, with the help of which, in theory, you can create a completely full-fledged game without writing a single line of code.  But this is for perverts and probably in Game Maker 2.0 this unnecessary functionality will finally be removed. <br><br>  Go to the Control tab by dragging or right-click on the Execute code icon.  A text editor will open in which you can place the game logic. <br><br>  As you remember, units must shoot with a certain period.  This can be done very easily.  In the Create event, write this code: alarm [0] = room_speed * 2; <br>  This means that we start alarm at number 0, which will work through room_speed * 2 steps (frames).  room_speed is 60, which is approximately equal to a second.  So alarm [0] will fire after 120 frames (2 seconds).  Alarm is a function, or rather an object event, it fires as soon as the step counter reaches 0. Like all other events, it is added via the Add event.  Now we need to register the logic that we add to alarm [0], but first let's create what our plant will shoot. <br><br>  Create a new sprite spr_bullet, size 16x16 and center.  Now we create a new o_bullet object and ask it with the newly created sprite.  In the Create event, add the code hspeed = 7;  just like with the previous object.  With this line we specify that the object will move at a speed of 7 horizontally (hspeed = horizontal speed, if someone does not understand).  This is a built-in property of each object.  Assigning a non-zero value to it, this object will start moving for a given number of pixels (in our case, 7 to the right) each step (Step).  If we set hspeed = -7;  - the object will move by -7 pixels every step, i.e.  will move from right to left. <br><br>  That's all, let's go back to the o_unit_shooter object and create a new event - Alarm 0. The code that we write in this event will trigger when the counter that we created in the Create event is running.  In the event of Alarm 0 we will create ‚Äúbullets‚Äù (in the original - peas), which the plant shoots.  Add this code: <br><br><pre><code class="cs hljs"><span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> shoot var b = instance_create(x + sprite_width/2, y, o_bullet); b.depth = depth + 1; alarm[0] = room_speed * 2;</span></span></code> </pre> <br>  Let's sort this code. <br><br>  /// shoot is just a comment that will be displayed when switching to an event.  The default is ‚ÄúExecute piece of code‚Äù, which is not very informative.  So it is recommended to write such comments in order not to waste time on transition to the code editor. <br>  var b = instance_create (x + sprite_width / 2, y, o_bullet); <br>  var b - we declare a local variable that will be available exclusively in this event.  After the event is completed, the memory will be freed and you will not be able to access this variable. <br>  instance_create (x + sprite_width / 2, y, o_bullet);  - so we create a new instance of the object and put it in the coordinates x: x + sprite_width / 2, y - y.  In this case, x and y are the coordinates of the parent object - o_unit_shooter.  o_bullet is the object that we create. <br>  b.depth = depth + 1;  - this line means that the newly created instance of o_bullet will be 1 layer lower than o_unit_shooter. <br>  The last line means that we start alarm [0] again - the plant must constantly shoot. <br><br>  As you remember, in the original you can arrange vegetation only in certain cells.  To visually understand the extent to which the plant can be placed, create a background and fill our room with it.  Right-click on Backgrounds - Create Background - Load Background, select the desired image, say, 64x64 pixels, call bg_grass.  Go to our room (rm_game), the Backgrounds tab, select the background created a second ago.  We put a tick, if you do not stand on the image. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/021/8ca/58f/0218ca58f73f4ed6ae9a7a733a11d14f.png"></div><br><br>  Now we need some kind of starting object that will do the initial initialization.  Create a new object and call it, for example, o_game.  Let this object reacts to a click on the field.  To do this, add an event - Mouse -&gt; Global mouse -&gt; Global left released.  A normal mouse-event means a direct click on an object, but since o_game does not have its own sprite + mask and since  we need the player to click on any point on the playing field to catch all the events of the click.  This is what Global Mouse does.  Global left released means that somewhere inside the game window a mouse click was made or a touch on the touch screen (the event is triggered when the finger is released). <br><br>  Add this code to this event: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tBgWidth = background_get_width(bg_grass); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tBgHeight = background_get_height(bg_grass); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> iX = mouse_x - mouse_x % tBgWidth + tBgWidth; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> iX = mouse_x - mouse_x % tBgWidth + tBgWidth/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> iY = mouse_y - mouse_y % tBgHeight + tBgHeight/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instance_position(iX, iY, o_unit_parent) != noone){ exit; } instance_create(iX, iY, o_unit_shooter);</code> </pre><br><br>  A semicolon after the operation can not be set, the code logic does not change from this and will not cause errors.  But if you can bet, why not do it.  Yes, and familiar. <br><br>  In the first four lines, we declare local variables.  background_get_width, background_get_height are built-in functions that return the width and height of our background.  As you can see, we need this data in order to calculate iX and iY.  iX and iY - these will be the coordinates in which we will create an instance of the o_unit_shooter object.  mouse_x, mouse_y are global variables embedded in Game Maker (i.e., those we can access from anywhere) that hold the current coordinates of the mouse cursor (finger).  Since  We are working in the Global left released event, they store the latest coordinates where the user released the left mouse button (released the finger).  Mathematical operations, the results of which are assigned to variables iX, iY are needed to calculate the coordinates in which an instance of the o_unit_shooter object will be located exactly in the middle of the background cell of the bg_grass.  Those.  Remember that in Plants Vs Zombies a plant cannot be placed anywhere, only at a certain point, but you can click anywhere and the plant will be placed just in the right place.  This is what the whole code above does. <br><br>  Checking instance_position (iX, iY, o_unit_parent)! = Noone means that we are looking at the iX, iY coordinates for any instance (object instance) whose parent object is o_unit_parent.  Since now we have only one inherited unit - o_unit_shooter, we check if there are no o_unit_shooter instances on the playing field, but we write o_unit_parent in the check in order for the code to work even when we add new user units.  noone (from "no one") is an analogue of null in other languages. <br><br>  exit - a code that terminates the execution of the event.  Those.  if some unit already exists in iX, iY coordinates, exit is triggered and the o_unit_shooter instance is not created, since  we interrupt the execution of all subsequent code.  It is necessary for us that in one cell there could not be 2 user units. <br><br>  Well, it's time to add the first enemy.  Create a new object and again create a base parent object.  Let's call o_enemy_zombie and o_enemy_parent, which will be his parent.  Create a sprite spr_enemy_zombie, center it and assign it to o_enemy_zombie. <br><br>  According to how much the property of all enemies is the movement towards the plants, then we will create this code in the o_enemy_parent event in the Create event: <br><br><pre> <code class="cs hljs">cHspeed = <span class="hljs-number"><span class="hljs-number">-4</span></span>; hspeed = cHspeed; HP = <span class="hljs-number"><span class="hljs-number">10</span></span>; canAttack = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre><br>  cHspeed is a user variable, the value of which we assign to hspeed, which we have already met.  Why not just write hspeed = -4;  - see later. <br><br>  We previously declared user variables through the var construct, but we are not doing this here.  What is the difference between cHspeed = -4;  and var cHspeed = -4 ;? <br>  Everything is simple - in the first case the variable will be accessible from any point of the code of this object and it will be possible to access it from any other object, but just not forgetting to mention which object we are accessing.  Now it is not necessary to delve into it.  Remember that this variable exists for the entire lifetime of an object instance since it is declared.  In the case of var cHspeed = -4;  it will be available only for the duration of the event in which it was created. <br><br>  In fact, it can also be accessed from another object, but if you access it from another object at the moment when the event in which it was created has already ended, it will cause an error ‚Äî a familiar null pointer, because from memory it already unloaded. <br><br>  If you don‚Äôt like the hspeed functions yourself, you can implement wspeed yourself by changing the x or y value in the Step event.  These functions just do it for you. <br><br>  HP is another variable in which we will store the number of enemies' life points.  Each instance will ‚Äúown‚Äù this variable, but the maximum number of life points for different types of enemies is different, i.e.  need to somehow redefine / override this value.  Or you can set all enemies the same number of lives, say, 100 and introduce the concept of defense on which the damage received by the enemy will depend, but now there is no sense to complicate, right?  So let's do only one variable - HP. <br><br>  Remember, gml - the language used in Game Maker case-sensitive, HP, hP, Hp and hp - will be different variables. <br><br>  canAttack is just a variable, with which we assign the value true.  For now, just write and forget about it. <br><br>  Once we have a different HP value for each enemy, we need to somehow redefine this value.  It is very, very simple.  Go to the o_enemy_zombie object, create a reaction to the Create event and write the code: <br><br><pre> <code class="cs hljs">event_inherited(); HP = <span class="hljs-number"><span class="hljs-number">20</span></span>;</code> </pre><br>  The event_inherited () function;  and is engaged in inheritance.  Those.  now o_enemy_zombie will execute the code: <br><br><pre> <code class="cs hljs">cHspeed = <span class="hljs-number"><span class="hljs-number">-4</span></span>; hspeed = cHspeed; HP = <span class="hljs-number"><span class="hljs-number">10</span></span>;</code> </pre><br>  Which "imports" this function, and then the value is executed the line - HP = 20; <br>  Those.  in fact, at the end of the Create event, the o_enemy_zombie object will have the following properties: <br><br><pre> <code class="cs hljs">cHspeed = <span class="hljs-number"><span class="hljs-number">-4</span></span>; hspeed = cHspeed; HP = <span class="hljs-number"><span class="hljs-number">20</span></span>;</code> </pre><br>  If we forget about the event_inherited () function;  or we will forget to specify the parent object to the o_enemy_zombie object, the enemy will not move, an error will appear when trying to access the cHspeed variable of this object. <br><br>  Great, if we want to create another type of enemy, in the Create event we will write the same thing, changing to the number of HP needed: <br><br><pre> <code class="cs hljs">event_inherited(); HP = <span class="hljs-number"><span class="hljs-number">100</span></span>;</code> </pre><br><br>  Once a zombie has hit points, it must be a plant.  Add the object o_unit_parent code HP = 20;  and the string event_inherited ();  in the Create event of the o_unit_shooter object. <br><br><h4>  Do you know? </h4><br>  If you do not need to override and add anything to the Create event, add the code event_inherited ();  no other logic in the event is needed - we will do it for you by Game Maker itself.  The same applies to any other events, not just Create. <br><br>  Great, our zombie is now going, but bullets do not take him and the plants do not slow him down.  We first solve the first problem.  Go to o_bullet and create a new reaction to the event - Add Event -&gt; Collision -&gt; o_enemy_zombie.  This event will be triggered when o_bullet and o_enemy_zombie hit each other.  Collision is checked by the mask, which you read at the beginning of the article.  Add the code: <br><br><pre> <code class="cs hljs">with(other){ HP -= <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (HP &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>){ instance_destroy(); } } instance_destroy();</code> </pre><br>  This is a very interesting point.  The other is the instance of the object with which a collision occurs at this point in the event.  Naturally, because  Since this code is in a collision event with an instance of the o_enemy_zombie object, then in the other one there will only be an instance of o_enemy_zombie. <br><br>  Using the with () {} construct, we refer to this other element.  Everything that happens inside {} refers exclusively to this instance of the object.  Thus, HP is = 5;  - This is the subtraction of 5 points of life from the enemy.  In if (hp &lt;= 0) {} we compare the number of life points also with this object.  Remember I talked a little bit higher about the difference between a regular variable declaration and a variable with var.  This example should clarify the situation for you.  Since  HP variable is not declared by var, it is available at any time.  So with the help of the with construct we can access it.  An alternative way to refer to a variable of another object would look like this: <br><br><pre> <code class="cs hljs">other.HP -= <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(other.HP &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>){ with(other){ instance_destroy(); } } } instance_destroy();</code> </pre><br>  But it is less convenient to access variables in this way, especially if there is more logic, but nevertheless it is applicable in some cases. <br><br>  Don't forget, if you declared a variable not in the Create event, but in the code you access it before it is declared, this will cause an error if you try to read some data from it. <br><br>  You do not need to have a great knowledge of English to understand that the function instance_destroy ();  deletes this instance of an object (instance). <br><br>  Thus, all this code means that in the event of a collision, we take away 5 points of life from a zombie, and if it gets them 0 or less, then we destroy it.  Regardless of the result at the end, we remove our bullet.  There is simply no place.  In general, probably, it would be better to make the zombies independently monitor their health, but so far we are not interested.  But that's <s>another story</s> optimization question. <br><br>  It would be wrong if our zombies could only take damage.  It is necessary to add the ability to cause damage.  First, add a new variable to the Create event of the o_enemy_parent object. <br><br><pre> <code class="cs hljs">isActive = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre><br>  It's time to get acquainted with the Step event, which I mentioned earlier.  This event is triggered every frame.  It's simple.  If room_speed is 60, then this event will fire approximately 60 times per second.  Add this code to the Step event -&gt; Step of the o_enemy_zombie object. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isActive) exit; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tBgWidth = background_get_width(bg_grass); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> leftCellCenterX = x - x % tBgWidth - tBgWidth/<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> frontEnemy = instance_position(leftCellCenterX, y, o_unit_parent); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (frontEnemy != noone){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> frontEnemySprtWidth; with(frontEnemy){ frontEnemySprtWidth = sprite_width; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x - sprite_width/<span class="hljs-number"><span class="hljs-number">2</span></span> - frontEnemy.x - frontEnemySprtWidth/<span class="hljs-number"><span class="hljs-number">2</span></span> &lt;= <span class="hljs-number"><span class="hljs-number">12</span></span>){ hspeed = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!canAttack){ exit; } canAttack = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; alarm[<span class="hljs-number"><span class="hljs-number">0</span></span>] = room_speed * <span class="hljs-number"><span class="hljs-number">1.2</span></span>; <span class="hljs-comment"><span class="hljs-comment">// cantAttack -&gt; true; with(frontEnemy){ HP -= 5; if (HP &lt;= 0){ instance_destroy(); } } } }else{ hspeed = cHspeed; }</span></span></code> </pre><br><br>  Nothing wrong with it, almost all the designs you already know. <br>  if (! isActive) exit;  - if the object is not active, that is, say, resting / recharging / swinging, this event will not be executed.  In the next two lines we get the coordinates of the center of the cell to the left of the one on which the center of our instance is now (remember that x returns the coordinates of the Origin point, and we have it just in the center of the sprite).  Next we look whether the user unit is located on the coordinates (leftCellCenterX, y).  If there is something there is a subsequent logic, but about it in a second, if there is nothing there, we assign the hspeed value to the variable cHspeed, which we remember to create in the Create event.  This is where it came in handy.  The meaning behind this lies like this - if our zombie stopped in order to attack and destroy the plant, it is necessary that he continue on his way.  You can, of course, not enter the variable cHspeed, but then you will need to remember where you set the speed of movement, and this is forgotten. <br><br>  This is the case if there is nothing on the way of the zombie, now we return to the moment when we have to fight.  The first lines are very interesting, with a trick.  The fact is that by declaring the local variable frontEnemySprtWidth, we assign the value to it in the frontEnemy instance.  Those who are familiar with programming will say, but in this case, we are accessing the variable frontEnemySprtWidth not of our zombie, but of a variable with the same name, but of the frontEnemy instance.  So yes not so, the fact is that local variables (declared through var) become visible inside this event everywhere, even from inside the frontEnemy instance.  Thus, there is no error in the code, we really refer to the variable that was declared local inside the zombie.  If you do not understand this point, experiment or read the certificate, everything is perfectly explained there, and we go further. <br>  We assigned the frontEnemySprtWidth value of the length (width) of the sprite unit of the user (plant), which is located on the cell to the left of our zombie.  You will say, why do we need to build such a difficult for the first understanding construction, if you can do var var frontEnemySprtWidth = sprite_get_width (spr_unit_shooter) ;.  The answer is simple - now we have one plant and we know which sprite to turn to, but when adding new types of units (sunflowers, etc.), we will have to fence the cumbersome switch construction to find out what kind of object is ahead of us, and so pretty just solved this poser. <br><br>  Next we check if the distance between the rightmost point of the user unit and the leftmost point of our zombie is less than 12 pixels, then we stop our zombie, check whether our zombie can attack (check the value of the previously created in the Create event of the o_enemy_parent variable canAttack), continues to run the code in which we say that it is no longer possible to attack and that the next time it can be done through room_speed * 1.2 frames (after 60 * 1.2) - this is what we do in alarm [0] (add it yourself to the corresponding event (Alarm 0 ) o_ene object  my_parent, where write the code canAttack = true;).  If you can attack, we take 5 life points from the plant instance and check if it is still alive, if not - we destroy it. <br><br>  Well, that's fine, the enemy is ready - he moves, attacks and continues to move, if he destroyed a plant, but he has one drawback - he does not exist.  We have created only a description of our enemy; now we need to place zombies on the playing field.  We return to the Create event of the o_game object.  Add code <br>  alarm [0] = room_speed;  // generate enemies <br><br>  Those.  60 frames will trigger Alarm 0 and a zombie will be created, right?  Not.  We have not created the logic for this Alarm.  And the code here is also simple: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tBgHeight = background_get_height(bg_grass); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> eY = irandom(room_height - room_height % tBgHeight); eY = eY - eY % tBgHeight + tBgHeight/<span class="hljs-number"><span class="hljs-number">2</span></span>; instance_create(room_width + sprite_get_width(spr_enemy_zombie)/<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>, eY, o_enemy_zombie); alarm[<span class="hljs-number"><span class="hljs-number">0</span></span>] = room_speed * <span class="hljs-number"><span class="hljs-number">3</span></span>;</code> </pre><br>  Everything is simple - we will not complicate it and just every 3 seconds (60 frames * 3) create an instance of o_enemy_zombie on the X coordinates: room_width + sprite_get_width (spr_enemy_zombie) / 2 + 1  one pixel more to the right than the screen border, i.e.       Y ‚Äî  . room_width  room_height,    ,  width  height  .  Those. 800  480 . <br><br>   ,    o_game  -        .       ‚Äî    rm_game -&gt; Objects -&gt;    o_game       .     ‚Äî  Settings -&gt; Creation Code( ‚Äî  ,         ).   instance_create(0,0, o_game); <br><br>   .     ,   Game Maker ,     rm_game  ¬´       ,   Game Maker ?¬ª.     ‚Äî     (     ).           . <br><br>      - : <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Y3u6LQfsenU%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjTfqJb5aTC1FchNBmkhN-L5U5cgA" frameborder="0" allowfullscreen=""></iframe><br><br>     . ,    .    ‚Äî     ,      . <br><br>         Game Maker,     .      ,     ,    .    ,  ,      . <br><br>    ,      Game Maker  ,     ,   Game Maker    .    . <br><br>  <a href="https://github.com/uraddo/pvzhabr">Source</a> <br><br>   : <br><br> ‚Äî //  <br> ‚Äî //  <br> ‚Äî //   <br> ‚Äî // () <br> ‚Äî //    <br> ‚Äî //  <br> ‚Äî //      <br> ‚Äî / + /   <br><br>  ,              , , ,             . </div><p>Source: <a href="https://habr.com/ru/post/255995/">https://habr.com/ru/post/255995/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../255983/index.html">Introduction to ASP.NET 5</a></li>
<li><a href="../255985/index.html">Building signs and comparing images: local signs. Lectures from Yandex</a></li>
<li><a href="../255987/index.html">SkillsWiki Conference: .NET-developer through the eyes of employers in Russia and abroad</a></li>
<li><a href="../255989/index.html">RubyMine 7.1: improved work with Puppet, JavaScript, CoffeeScript, and more</a></li>
<li><a href="../255991/index.html">Overview of the software development process</a></li>
<li><a href="../255997/index.html">About the performance of Android applications</a></li>
<li><a href="../255999/index.html">Arduino vs Arduino</a></li>
<li><a href="../256001/index.html">Work with error messages - git</a></li>
<li><a href="../256005/index.html">Big Data Week Moscow 2015: learn about the big data industry from the inside</a></li>
<li><a href="../256009/index.html">New life shooting gallery</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>