<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tutorial: create a simple application for watchOS 4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this tutorial, we will create a simple, but full-featured application under watchOS 4. More specifically, we will work on an application created by...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tutorial: create a simple application for watchOS 4</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c21/27b/701/c2127b7014c9108c3de4cb2ebc7a9908.png" alt="image"></div><br>  In this tutorial, we will create a simple, but full-featured application under watchOS 4. More specifically, we will work on an application created by Air Aber for Apple Watch. <br><br>  From this tutorial you will learn: <br><br><ul><li>  How to add a watchOS 4 target assembly to an iOS application. </li><li>  How to exchange data between two target assemblies. </li><li>  How to add a watchOS interface controller to Storyboard and arrange interface objects. </li><li> How to create a subclass of <code>WKInterfaceController</code> and put everything together. </li><li>  How to add a new interface controller, add a table to it and create a prototype of the rows. </li><li>  How to create a subclass of the <code>WKInterfaceController</code> class to populate a table, customize rows, and handle choices. </li><li>  How to make an interface controller modal and pass it data for display. </li><li>  How to create animations based on images. </li><li>  How to use watchOS 4 animation animation. </li></ul><a name="habracut"></a><br><h2>  Part 1: getting started </h2><br>  From this part you will learn: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  How to add a watchOS 4 target assembly to an iOS application. </li><li>  How to exchange data between two target assemblies. </li><li>  How to add a watchOS interface controller to Storyboard and arrange interface objects. </li><li>  How to create a subclass of <code>WKInterfaceController</code> and put everything together. </li></ul><br><h2>  Getting started </h2><br>  We'll start by downloading the <a href="">initial project</a> for this tutorial. <br><br>  Open it in Xcode, build and run.  You should see a blank white screen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/407/60f/8b0/40760f8b0f86240c7317b19c63225e16.png"></div><br><br>  As you can see, so far there is quite a few things in this project: there are several necessary auxiliary files in it, and that's it.  We will solve this problem soon! <br><br><h2>  Add the WatchKit app </h2><br><p>  Select <em>File \ New \ Target ....</em>  In the dialog that opens, select <em>watchOS \ Application \ WatchKit App</em> , then click <em>Next</em> : <br><br></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/457/5ec/436/4575ec4369a810089af2774bec9c715c.png"></div><br>  On the next screen, enter the word <em>Watch</em> as the <em>Product Name</em> , make sure that <em>Swift is</em> selected in the <em>Language</em> field and uncheck all the checked boxes.  Click <em>Finish</em> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c14/5d5/17c/c145d517c3a3ff919dda265aa98295ca.png"></div><br>  The system will ask if you need to activate the ‚Äúwatch‚Äù scheme - we will need it, so select <em>Activate</em> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b2a/926/c34/b2a926c34c668e2950626ce78d646535.png"></div><br>  Congratulations, you have just created your first Watch!  Everything is really that simple. <br><br>  You may notice that this action actually created two target assemblies, rather than one, and two corresponding groups in the Project navigator.  This happened because the Watch app code is actually executed as the Extension enclosed within the Watch app, much like the Today Extension works in iOS. <br><br>  Expand the <em>Watch</em> and <em>Watch Extension</em> groups in the Project navigator, and you will see that the storyboard is in the <em>Watch</em> group, and the classes created by the target assembly template are in the <em>Watch Extension</em> group: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ac/ec2/606/7acec260618ba3061b9f1354255959e8.png"></div><br>  This is what order we will follow in our work: any added code must be stored within <em>the Watch Extension group</em> , and added to the <em>Watch Watch</em> target assembly, while any resources or storyboard should be added to the <em>Watch</em> group. <br><br><h2>  Tidy up a bit </h2><br>  Before proceeding, we need to remove a couple of elements added by the target assembly template that we are going to replace. <br><br>  Right-click on <em>InterfaceController.swift</em> in the Project navigator and select <em>Delete</em> .  In the dialog box, select <em>Move to Trash</em> so that the file is actually removed from the project: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f17/116/c65/f17116c65b3b58ee0503e8b5352088e5.png"></div><br>  Next, open <em>Interface.storyboard</em> , select the only interface controller there and click <em>delete</em> .  As a result, you should have an empty storyboard, or, as I prefer to perceive it, an empty canvas. <br><br><h2>  General data and code </h2><br>  In the initial project, there is a JSON file containing all information about Air Aber flights, and a model class representing this data.  This is what should be common between target assemblies, because there is a high probability that the iOS application and the Watch application will use the same class of models and data - remember the <a href="https://ru.wikipedia.org/wiki/Don%25E2%2580%2599t_repeat_yourself">DRY</a> principle? <br><br>  Expand the <em>Shared</em> group in the Project navigator and select <em>Flights.json</em> .  Then find the <em>Target Membership</em> section in <em>File inspector</em> and check the <em>Watch Extension</em> box: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/315/4f2/243/3154f22430019f97f21f0c5cb11f258f.png"></div><br>  The file will now be included in <em>both AirAber</em> and <em>Watch Extension</em> . <br><br>  Repeat the process for another file in the <em>Shared</em> group - <em>Flight.swift</em> . <br><br>  And having finished with this, we can finally start creating the flight information interface! <br><br><h2>  Interface creation </h2><br>  Open <em>Watch \ Interface.storyboard</em> and drag the <em>interface controller</em> from the Object Library onto the storyboard canvas.  With the interface controller selected, open Attributes inspector, set the <em>Identifier</em> to <em>Flight</em> and select the <em>Is Initial Controller</em> check box.  Deselect the <em>Activity Indicator On Load</em> check box: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/14a/d3b/55e/14ad3b55e8232e81ad72c418a5f1b386.png"></div><br><br>  So we set the identifier so that you can access the interface controller in the code.  By ticking the <em>Is Initial Controller</em> checkbox, we just let WatchKit know that this interface controller needs to be displayed when the Watch application is launched for the first time.  This interface does not download any data, so it does not need to show an activity indicator. <br><br>  To simplify this tutorial, we will create an interface circuit only for 42 mm watches.  In your own applications you will need to check whether it is displayed correctly on all sizes of watches.  In the lower left corner of the storyboard panel should be selected <em>View as: Apple Watch 42mm</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/42a/295/be5/42a295be57bb46cc56da8408bfdaa86c.png"></div><br><br>  The layout of the Watch app is completely different from the iOS layout.  The first thing you'll notice: you can move or modify UI objects by dragging and dropping them in the interface controller.  When you drag an object to the controller, it is located under the previous objects and the screen fills up pretty quickly.  To arrange objects in a row, you need to use <em>groups</em> that are in many ways similar to the Stack View in iOS and macOS. <br><br>  So, first, drag the <em>group</em> from the Object Library to the interface controller: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c6/9f1/3aa/5c69f13aa7016018852b36c23548671c.png"></div><br>  Although this does not look very impressive so far, this group will contain the Air Aber logo, flight number and flight route in the future. <br><br>  Select a new group, go to Attributes inspector and change <em>Insets</em> to <em>Custom</em> .  Four text fields appear in which you can manually set the indents of the group. <br><br>  Change the <em>Top</em> value to <em>6</em> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9d5/b4e/6af/9d5b4e6af628a746e0bbd70cdb20f5fd.png"></div><br>  So we just add a little more padding from the top. <br><br>  Next, drag to the <em>image</em> group.  If the group responds to changing the top indent by folding ( <i>thanks, Xcode!</i> ), Then drag the image directly into the Document Outline and make sure that it becomes a child of the group, not the next: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d60/ce6/04a/d60ce604a4de03415416954649aa1e26.png"></div><br>  Now we need a displayed image.  Download <a href="">this logo</a> and drag it into <em>Watch \ Assets.xcassets</em> .  In this case, a new set of images will be created, in which our picture will occupy the 2x slot: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c3/e93/3ad/1c3e933ad9c66474b67466c9c896c7c6.png"></div><br>  I want to give this image a tint of Air Aber's corporate color, so we‚Äôll select an image, then change the <em>Render As</em> value to <em>Template Image</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ff/322/e27/2ff322e27065a928463611bce6809ac1.png"></div><br>  Open <em>Watch \ Interface.storyboard</em> again and select <em>image</em> .  Using the Attributes inspector, make the following changes: <br><br><ul><li>  Change the <em>Image</em> value to <em>Logo</em> - if it is not displayed in the drop-down menu, just type it from the keyboard. </li><li>  Change the <em>Tint</em> value to <em># FA114F</em> (you can enter it in the Color RGB Sliders panel). </li><li>  Change the <em>Width</em> parameter to <em>Fixed</em> with a value of <em>40</em> . </li><li>  Change the <em>Height</em> parameter to <em>Fixed</em> with a value of <em>40</em> . </li></ul><br>  Attributes inspector should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/db1/f0b/6a7/db1f0b6a765fd041fe0ad88eba5fe1b7.png"></div><br><br>  Don't worry if you don‚Äôt see the logo: it looks like Xcode doesn‚Äôt change the hue of the image templates during development!  Believe me, it will be bright pink after building and running the application. <br><br>  Next, drag another <em>group</em> to the created <em>group</em> and check that it appears to the right of the image, and then use the Attributes inspector to change its <em>Layout</em> to <em>Vertical</em> .  Also, change <em>Spacing</em> to <em>Custom \ 0</em> , and <em>Width</em> to <em>Size to Fit Content</em> . <br><br>  Then drag two <em>labels</em> to the new group.  We set the vertical position, so the labels will appear one above the other: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/407/067/c4a/407067c4a5f7c838f28d4c1bf4aeb3b5.png"></div><br>  Select the top label and use Attributes inspector to enter the <em>Flight 123</em> value in the <em>Text</em> field and change the <em>Text Color</em> to <em># FA114F</em> (instead of re-entering the RGB panel, you can choose a pink color from the <em>Recently Used Colors</em> list of the Color menu). <br><br>  Then select the bottom label and enter the text <em>MEL to SFO</em> in the <em>Text</em> field.  Now the interface controller should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ef/665/691/3ef6656917cebbb37e75833bb2803f2a.png"></div><br><br>  This text is temporary, it will be replaced when we connect the interface to the controller class. <br><br>  Next, drag another <em>group</em> onto the interface controller, but this time make sure to add it as a neighboring element of the very first group.  If you are unable to correctly arrange the group in the hierarchy, then use Document outline. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e14/4a3/014/e144a3014ac234d8fde0fa0b74634a0d.png"></div><br>  By selecting this new group, set the <em>Layout</em> to <em>Vertical</em> , and the <em>Spacing</em> to <em>Custom \ 0</em> . <br><br>  Then drag three <em>labels</em> to this new group: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/938/bec/4fe/938bec4fe965956d69090e8c8295f8f2.png"></div><br>  Check in Document outline that all three labels are <i>inside the</i> group, not next to it! <br><br>  Select the top label and change the <em>Text</em> value in the Attributes inspector to <em>AA123 Boards</em> . <br><br>  Then select the middle label and replace it with <em>Text</em> at <em>15:06</em> .  Next, change the <em>Text Color</em> to <em># FA114F</em> , and <em>Font</em> - to <em>System</em> , setting the <em>Style</em> to <em>Regular</em> , and selecting <em>Size</em> equal to <em>54</em> .  Finally, change <em>Height</em> to <em>Fixed</em> with a value of <em>44</em> . <br><br>  Select the bottom label and replace it with <em>Text</em> for <em>On time</em> , and <em>Text Color</em> with <em># 04DE71</em> . <br><br>  Now the interface controller should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/351/2e2/861/3512e2861d405a541e9fcbf898dd0435.png"></div><br>  Now we just need to add another group, and then proceed to create the Outlet class fields so that this interface displays real data. <br><br>  Drag the new <em>group</em> from the Object Library to the lower group, this time it should be a child and be at the very bottom of the containing group.  Next, add two <em>labels to it</em> .  Now the complete hierarchy of interface objects should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/823/b56/f01/823b56f012c348a3fb9db463bdd281e6.png"></div><br>  In the Attributes inspector for the <em>Text of the</em> left label, set the value to <em>Gate 1A</em> .  For the right label, set <em>Text</em> to <em>Seat 64A</em> and select the <em>Right</em> option for <em>Horizontal Alignment</em> . <br><br>  Now the finished interface should look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e0d/482/e59/e0d482e592b51ca393c311548711f3dc.png"></div><br>  Congratulations, you‚Äôve finished creating the interface layout for your first Watch!  Now you need to fill it with real data and run the application in the simulator. <br><br><h2>  Creating a controller </h2><br>  Right-click on the <em>Watch Extension</em> group in the Project navigator and select <em>New File ....</em>  In the dialog that opens, select <em>watchOS \ Source \ WatchKit Class</em> and click <em>Next</em> .  Name the new class <em>FlightInterfaceController</em> and check that it is a subclass of <code>WKInterfaceController</code> , and <em>Language</em> is set to <em>Swift</em> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fb5/5a3/f44/fb55a3f44d5981f4b36d00d351ab95fb.png"></div><br>  Click <em>Next</em> and then <em>Create</em> . <br><br>  When the new file opens in the code editor, remove the three empty method stubs, and all you need is the import statement and the class definition. <br><br>  Add the following Outlet fields to the <code>FlightInterfaceController</code> above: <br><br><pre> <code class="hljs swift"><span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> flightLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> routeLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> boardingLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> boardTimeLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statusLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gateLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> seatLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span></code> </pre> <br>  Here we just added an outlet for each label we previously placed on the interface.  Soon we will connect them. <br><br>  Then add the following property and Property observer under the outlet fields: <br><br><pre> <code class="hljs bash">// 1 var flight: Flight? { // 2 didSet { // 3 guard <span class="hljs-built_in"><span class="hljs-built_in">let</span></span> flight = flight <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> } // 4 flightLabel.setText(<span class="hljs-string"><span class="hljs-string">"Flight \(flight.shortNumber)"</span></span>) routeLabel.setText(flight.route) boardingLabel.setText(<span class="hljs-string"><span class="hljs-string">"\(flight.number) Boards"</span></span>) boardTimeLabel.setText(flight.boardsAt) // 5 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> flight.onSchedule { statusLabel.setText(<span class="hljs-string"><span class="hljs-string">"On Time"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { statusLabel.setText(<span class="hljs-string"><span class="hljs-string">"Delayed"</span></span>) statusLabel.setTextColor(.red) } gateLabel.setText(<span class="hljs-string"><span class="hljs-string">"Gate \(flight.gate)"</span></span>) seatLabel.setText(<span class="hljs-string"><span class="hljs-string">"Seat \(flight.seat)"</span></span>) } }</code> </pre> <br>  Here is what happens at each stage: <br><br><ol><li>  We declared a helper property of type <code>Flight</code> .  This class is declared in <em>Flight.swift</em> , which is part of a common code previously added to the Watch Watch target configuration. </li><li>  We added Property observer, which is performed when setting the property. </li><li>  We verify that the auxiliary property actually contains the flight, not <code>nil</code> .  We can continue to configure labels only if we know that we have the correct instance of <code>Flight</code> . </li><li>  We configure tags using the appropriate <code>flight</code> properties. </li><li>  If the flight is delayed, then we change the text color in the label to red. </li></ol><br>  Now we need to set the <code>flight</code> when the controller is first displayed.  Add the following lines below the declaration of the <code>flight</code> : <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">awake</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(withContext context: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.awake(withContext: context) flight = <span class="hljs-type"><span class="hljs-type">Flight</span></span>.allFlights().first }</code> </pre> <br>  In the next section, we will modify this implementation to use the context passed to it, but for now we just load all the flights from the common JSON file, and then take the first one from the array. <br><br>  <em>Note</em> : <code>awake(withContext:)</code> is called after the controller is loaded from the storyboard and all its Outlet fields are configured, so this is a great place to set the <code>flight</code> . <br><br>  There is only one last step left before we can build and run the application, and this step is connecting the Outlet fields. <br><br><h2>  Connecting Outlet Fields </h2><br>  Open <em>Watch \ Interface.storyboard</em> and select an interface controller.  Using the Identity inspector, set the <em>Custom Class \ Class</em> value to <em>FlightInterfaceController</em> . <br><br>  Then connect the Outlet fields according to the list below: <br><br><ul><li>  <code>flightLabel</code> : Flight 123 </li><li>  <code>routeLabel</code> : MEL to SFO </li><li>  <code>boardingLabel</code> : AA123 Boards </li><li>  <code>boardTimeLabel</code> : 15:06 </li><li>  <code>statusLabel</code> : On time </li><li>  <code>gateLabel</code> : Gate 1A </li><li>  <code>seatLabel</code> : Seat 64A </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fe3/373/d2c/fe3373d2c6a79ee76cc21e0f1ea81efe.png"></div><br><br>  Before you start the application, we have only one thing left to do.  An example of the application that we developed in this tutorial was created for the 42-millimeter Apple Watch, so you need to make sure that the correct simulator is configured, otherwise the interface may look a bit distorted.  In these applications, developers test the operation of the interfaces on all sizes of clocks, but this does not apply to the topic of this tutorial. <br><br>  Open the Watch schematic menu and select one of the simulators of the 42-millimeter clock: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/97a/841/393/97a8413937f733598eff208205ac78e7.png"></div><br>  Build and run the application.  After the simulator download is completed, you should see the correct location of the interface and the pink Air Aber logo.  The <code>Flight</code> object generates random values ‚Äã‚Äãfor landing times and seat numbers, so here you will see other values: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9b1/a1f/0cb/9b1a1f0cb1d291a5f133f0cf1d182bbb.png"></div><br>  <em>Note</em> : If you receive a message about the installation failure, you can either try to repeat the process in Xcode, or manually install the application in the clock simulator.  To do this, open the Watch app in the iOS simulator, touch <em>AirAber</em> , and then switch <em>Show App on Apple Watch</em> to <em>On</em> .  After that, you can return to the clock simulator, touch the <em>Digital Crown</em> to go to the main screen, and then touch the AirAber icon to launch the application. <br><br>  Congratulations!  You have completed the implementation of your first WatchKit interface, and it works with real data in the clock simulator - great job! <br><br>  Here is a <a href="">ready-made example</a> of what we did in this part of the tutorial. <br><br><h2>  Part 2: Tables </h2><br>  In the first part of the tutorial, we learned about the fundamentals of development for watchOS 4, creating our first interface controller. <br><br>  In the second part of the series, we will add a table so that the application can display the list of flights. <br><br>  In the process, you will learn: <br><br><ul><li>  How to add a new interface controller, add a table to it and create a prototype of the rows. </li><li>  How to create a subclass of the <code>WKInterfaceController</code> class to populate a table, customize rows, and handle choices. </li><li>  How to make an interface controller modal and pass it data for display. </li></ul><br><h2>  Getting Started </h2><br>  Open <em>Watch \ Interface.storyboard</em> and drag another <em>interface controller</em> from the Object Library onto the storyboard, to the left of the Flight controller that is already in place. <br><br>  With the new interface controller selected, open the Attributes inspector and make the following changes: <br><br><ul><li>  Set the <em>Identifier</em> to <em>Schedule</em> . </li><li>  In <em>Title,</em> enter <em>Air Aber</em> . </li><li>  Check the <em>Is Initial Controller</em> checkbox. </li><li>  Make sure the checkbox for <em>Activity Indicator On Load is</em> checked. </li></ul><br>  As in the Flight controller, we specify an identifier so that you can access this interface controller in code.  This is the real starting controller for the Watch application, so you need to set a title for it and check the box.  This controller loads a table from some data source, so we show an activity indicator. <br><br>  Now go to the interface: drag the <em>table</em> from the Object Library to the new interface controller: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1cf/0a8/1ec/1cf0a81ecb5a6071ae71d6edbc7f831a.png"></div><br>  Select <em>Table Row Controller</em> in Document outline: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/204/286/ae4/204286ae439aca3296cacef68a0ee158.png"></div><br>  Use the Attributes inspector to set the <em>Identifier to a</em> <em>FlightRow</em> value.  The identifier is also the type of the string, when we inform the table which instances of the rows need to be created, so it is important to give it a name. <br><br><h2>  Creating a string interface </h2><br>  The row of the table is actually a group, so you can give it a configuration of any complexity. <br><br>  Our first task is to make two changes to the default configuration group.  In Document outline, select a group within the table row, then use the Attributes inspector to set <em>Spacing to</em> <em>6</em> , and <em>Height</em> to <em>Size To Fit Content</em> . <br><br>  By default, table rows have a standard fixed height.  However, most often we need the strings to display all the interface objects added to them, so you should always change the <em>Height</em> attribute this way. <br><br>  Then drag <em>separator</em> from the Object Library into the group row of the table.  In fact, we will not <i>divide</i> anything, but simply give the row to the table a small visual touch.  With the separator selected, use the Attributes inspector to make the following changes: <br><br><ul><li>  Set the <em>Color</em> value to <em># FA114F</em> (the previously used pink color Air Aber). </li><li>  Set the <em>Vertical Alignment</em> to <em>Center</em> . </li><li>  Set the <em>Height</em> to <em>Relative to Container</em> . </li><li>  Set the <em>Adjustment</em> to <em>‚Äì4</em> . </li></ul><br>  The inspector should now look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f7/2ba/51d/7f72ba51d7f11d7cb28f0358334cacd2.png"></div><br><br>  The row of the table suddenly grew and filled the entire screen!  But we will fix this in the configuration process of the string. <br><br>  Drag the <em>group</em> from the Object Library onto the table row to the right of the separator.  With the group selected, change the following attributes in the Attributes inspector: <br><br><ul><li>  Set the <em>Layout</em> value to <em>Vertical</em> . </li><li>  Set <em>Spacing</em> to <em>0</em> . </li><li>  Set the <em>Width</em> to <em>Size To Fit Content</em> . </li></ul><br>  You may have noticed that we often manipulate the Spacing attribute;  it simply narrows the space between the group's interface objects, and makes everything a little clearer on a small screen. <br><br>  Drag another <em>group</em> to the newly added group and make the following changes: <br><br><ul><li>  Set <em>Spacing</em> to 4. </li><li>  Select for <em>Height the</em> option <em>Fixed</em> with value <em>32</em> . </li></ul><br>  Now the table line has returned to normal height! <br><br>  Then add <em>label</em> and <em>image</em> to this new group.  We will configure the label, and then copy and update it to display the starting and ending points of each flight. <br><br>  Now we need to put something in the image.  Download <a href="">this image</a> and add it to <em>Watch \ Assets.xcassets</em> .  This will create a new set of <em>Plane</em> images in which the current image will occupy the <em>2x</em> slot: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/660/072/297/66007229756da3381bbd745cdf872a17.png"></div><br>  We want to give this image a pink Air Aber hue, so we‚Äôll select an image, then use the Attributes inspector to set the <em>Render As</em> value to <em>Template Image</em> . <br><br>  Re-open the <em>Watch \ Interface.storyboard</em> and select the image in the Document outline.  With the Attributes inspector we will make the following changes: <br><br><ul><li>  Set the <em>Image</em> value to <em>Plane</em> . </li><li>  Set the <em>Tint</em> value to <em># FA114F</em> . </li><li>  Set the <em>Horizontal</em> and <em>Vertical Alignment</em> values ‚Äã‚Äãto <em>Center</em> . </li><li>  For the <em>Width,</em> select the <em>Fixed</em> option with a value of <em>24</em> . </li><li>  For <em>Height,</em> select the option <em>Fixed</em> with a value of <em>20</em> . </li></ul><br>  Select the label and set its <em>Text</em> field to the value <em>MEL</em> .  Then change its <em>Font</em> to <em>System</em> with a <em>Semibold</em> style and size of <em>20</em> .  Finally, set the <em>Vertical Alignment</em> to <em>Center</em> . <br><br>  Copy the label, and then paste it to the right of the image.  Change its text to <em>SFO</em> , and <em>Horizontal Alignment</em> to <em>Right</em> .  The table row should now look like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bf1/d27/c75/bf1d27c75bf9dd6e070231d251203d7e.png"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : when inserting a copy of a label, it can stubbornly stick to the left side of the image, regardless of its position in the Document outline. </font><font style="vertical-align: inherit;">But if you set the horizontal alignment to the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">right</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , it will move into place. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The hierarchy of interface objects should now be like this:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a87/801/62f/a8780162ff6d62541d857b93114b7df3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are almost done with the interface of the table row, it remains to add only the number and status of the flight. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drag another </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the Object Library into the row of the table so that it is next to the group containing the departure and arrival labels:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8aa/8d7/c77/8aa8d7c77e00f7c65ad2a03032a4592a.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Continuing to create this interface, you will see other examples of how you can use the built-in groups with mixed configurations to create complex configurations. </font><font style="vertical-align: inherit;">Who needs this Auto Layout ?! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drag two labels to this new horizontal group. </font><font style="vertical-align: inherit;">Use the Attributes inspector to make changes to the left label:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AA123</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text Color</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Light Gray Color</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Font</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caption 2</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertical Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bottom</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Next, make changes to the right label: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On time</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text Color</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># 04DE71</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Font</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caption 2</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horizontal Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Right</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertical Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bottom</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> After making these last changes, the complete table row should look like this: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2a9/12f/599/2a912f599f141780a04a2459c629c9e6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Having set up the table in Interface Builder, we can start filling it with some data. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Filling the table </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first thing to do is create a subclass of the class </font></font><code>WKInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to manage the table. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Right-click the group </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watch Extension</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the Project navigator and select </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the New ... the File</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In the dialog box that appears, select </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">watchOS \ Source \ WatchKit Class</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and click </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Name the new class </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScheduleInterfaceController</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ensure that it is a subclass of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WKInterfaceController</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and that </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Language</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is set to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swift</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fcd/3be/ca0/fcd3beca0fbcdca030ce14d753b46946.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Click </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When the new file opens in the code editor, remove the three empty method blanks so that only the import statements and the class definition remain. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reopen </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watch \ Interface.storyboard</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and select the new interface controller. </font><font style="vertical-align: inherit;">In the Identity inspector, replace the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Custom Class \ Class</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScheduleInterfaceController</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b2/469/e2f/0b2469e2faa3089fd931655d1e473035.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leaving the interface controller selected, open the Assistant editor and verify that it appears there </font></font><code>ScheduleInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Next, hold down Control and drag from </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Table</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to Document outline inside the class definition </font></font><code>ScheduleInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to create the Outlet field:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/656/0f1/101/6560f110182f8dbfcc37c49e93b8b448.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Call Outlet </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flightsTable</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , make sure it is set to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WKInterfaceTable</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and click </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Connect</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now that we have set our own class and created an Outlet into the table, it is time to fill it in! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Close the Assistant editor, open </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScheduleInterfaceController.swift</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add the following line right after the Outlet:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> flights = <span class="hljs-type"><span class="hljs-type">Flight</span></span>.allFlights()</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we simply add a property containing all flight information as an array of instances </font></font><code>Flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then add the following implementation </font></font><code>awake(withContext:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">awake</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(withContext context: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.awake(withContext: context) flightsTable.setNumberOfRows(flights.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>, withRowType: <span class="hljs-string"><span class="hljs-string">"FlightRow"</span></span>) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we tell the table to create an instance of the string we just created in Interface Builder for each flight in </font></font><code>flights</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">The number of lines is equal to the size of the array, and the type of the line is the identifier that we specified in the storyboard. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Build the application and run it. </font><font style="vertical-align: inherit;">You will see a table filled with several lines, next to each of which is a pink image of an Air Aber aircraft:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6f5/f91/8cb/6f5f918cb0892d0c63a418dcb80362e9.png"></div><br>  But wait!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The heading has a dark gray color instead of hot pink corporate color Air Aber. </font><font style="vertical-align: inherit;">Now we fix it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watch \ Interface.storyboard</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , select the controller interface </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Air Aber</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In the File inspector, change the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Global Tint</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># FA114F</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9d1/52a/687/9d152a687740e82d6c314455c5733e43.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Build and run the application. </font><font style="vertical-align: inherit;">That's much better!</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c2/320/893/5c2320893259781f8cac9188258aeedf.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But now you will notice that all the lines display the placeholder text that we specified in Interface Builder. </font><font style="vertical-align: inherit;">Now we will fix this by adding a row controller that customizes labels for each row.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add row controller </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WatchKit tables are much simpler than iOS tables: there are no data sources and delegate! Simply create a string controller class which, despite its name, is a subclass of the class </font></font><code>NSObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Right-click the group </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watch Extension</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the Project navigator and select </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the New ... the File</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In the dialog that opens, select </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">watchOS \ Source \ WatchKit Class</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and click </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Name the new class </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlightRowController</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Make sure that it is a subclass of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NSObject</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - and </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">not </font></font></em> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WKInterfaceController</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ! - and that </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Language</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> has a </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Swift</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value </font><font style="vertical-align: inherit;">:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f64/367/d51/f64367d514d3581788f1c5a29a621c59.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Click </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and then </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When a new file opens in the code editor, add the following lines on top of the class:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> separator: <span class="hljs-type"><span class="hljs-type">WKInterfaceSeparator!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> originLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> destinationLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> flightNumberLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> statusLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> planeImage: <span class="hljs-type"><span class="hljs-type">WKInterfaceImage!</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we simply add an Outlet for each of the tags added to the table row. </font><font style="vertical-align: inherit;">Soon we will connect them. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then add the following property and Property observer, right below the Outlet fields:</font></font><br><br><pre> <code class="hljs bash">// 1 var flight: Flight? { // 2 didSet { // 3 guard <span class="hljs-built_in"><span class="hljs-built_in">let</span></span> flight = flight <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> } // 4 originLabel.setText(flight.origin) destinationLabel.setText(flight.destination) flightNumberLabel.setText(flight.number) // 5 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> flight.onSchedule { statusLabel.setText(<span class="hljs-string"><span class="hljs-string">"On Time"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { statusLabel.setText(<span class="hljs-string"><span class="hljs-string">"Delayed"</span></span>) statusLabel.setTextColor(.red) } } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here is what happens at each of the stages: </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We declare an auxiliary type property </font></font><code>Flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Remember that this class is declared in </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flight.swift</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is part of the general code added to Watch Extension in the previous part of the tutorial.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add the Property observer, which is performed when setting the property. </font></font></li><li>  ,  <code>flight</code>   <code>nil</code> :   ,              <code>Flight</code> . </li><li>       <code>flight</code> . </li><li>   ,             . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Having completed the setting of the row controller, we need to update the row of the table to use it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watch \ Interface.storyboard</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and select </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlightRow</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the Document outline. Using the Identity inspector, set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Custom Class \ Class</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlightRowController</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In Document outline, open all groups in </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlightRow</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then right-click on </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlightRow</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to bring up the Outlet fields and actions pop-up window:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3cf/7a3/aa6/3cf7a3aa68ed51e0fe420b2e69652e40.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can drag this pop-up window to the right to see all the objects in the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlightRow</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">First we connect </font></font><code>planeImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the image in the row of the table, and </font></font><code>separator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the separator. </font><font style="vertical-align: inherit;">Then we connect the remaining Outlet fields in accordance with the following list:</font></font><br><br><ul><li> <code>destinationLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : SFO </font></font></li><li> <code>flightNumberLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : AA123 </font></font></li><li> <code>originLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : MEL </font></font></li><li> <code>statusLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : On time </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The last step is an update </font></font><code>ScheduleInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">so that it passes the instance to </font></font><code>Flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">each row controller in the table. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScheduleInterfaceController.swift</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add the following lines below </font></font><code>awakeWithContext(_:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span>.&lt;flightsTable.numberOfRows { guard let controller = flightsTable.rowController(at: <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? FlightRowController <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } controller.flight = flights[<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>] }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we loop </font></font><code>for</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">through each row in the table and request the row controller with the corresponding index from the table. If we request the controller correctly, we get an instance </font></font><code>FlightRowController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Then we set the </font></font><code>controller.flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corresponding element </font></font><code>flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the array </font></font><code>flights</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This leads to the implementation of the observer </font></font><code>didSet</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in </font></font><code>FlightRowController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and configures all the labels in a table row. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is time to see the results of our labors: run the build and run the application. You will see that the rows of the tables are now filled with the correct flight details:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c21/27b/701/c2127b7014c9108c3de4cb2ebc7a9908.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And now the last task in this part of the tutorial: when the user taps the table row, he </font></font><code>ScheduleInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">must transfer the corresponding flight as context to the flight information interface that we created in the previous part of the tutorial and display it.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Match selected string </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first thing to do is to override the method </font></font><code>WKInterfaceTable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that performs the selection processing of a row in a table. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add to the </font></font><code>ScheduleInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">following lines:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">table</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> table: WKInterfaceTable, didSelectRowAt rowIndex: Int)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> flight = flights[rowIndex] presentController(withName: <span class="hljs-string"><span class="hljs-string">"Flight"</span></span>, context: flight) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we get the </font></font><code>flights</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corresponding flight using the string index passed to this method. </font><font style="vertical-align: inherit;">Then we display the flight information interface, as </font></font><code>context</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">passing </font></font><code>flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Remember that the name passed to </font></font><code>presentController(withName:context:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the identifier we specified in the storyboard in the previous part of the tutorial. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now, as promised in the first part, we will change </font></font><code>FlightInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it to use </font></font><code>context</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to customize its interface. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlightInterfaceController.swift</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and find </font></font><code>awake(withContext:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Find this line:</font></font><br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">flight</span></span> = Flight.allFlights().first</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Replace it with the following lines: </font></font><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> flight = context <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">Flight</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.flight = flight }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we are trying to convert </font></font><code>context</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as an instance </font></font><code>Flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If this succeeds, we use it for the task </font></font><code>self.flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which in turn leads to the execution of Property observer and configures the interface. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For the last time in this part we will run the build and run the application. </font><font style="vertical-align: inherit;">Touch the row of the table and you will see how the flight information interface modally displays information about the selected flight:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f63/cd0/f4b/f63cd0f4bb6b2fd83660b3eeef04d18d.gif"></div><br>  Congratulations!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> You have completed the implementation of your first table and filled it with real data. </font></font> Great job! <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is a </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">complete example of a project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that we have done so far in this tutorial.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Part 3: Animations </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the third part of the tutorial, we will learn how to use watchOS 4 animations using the example of a new flight check-in interface in our application. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the process, you will learn:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> How to create animations based on images. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> How to use watchOS 4 animation animation. </font></font></li></ul><br><h2>  Getting Started </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watch \ Interface.storyboard</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and drag the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">interface controller</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the Object Library onto the storyboard canvas. </font><font style="vertical-align: inherit;">After selecting the controller interface, open the Attributes inspector and enter for the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Identifier</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CheckIn</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">We did this in order to be able to define an interface controller from </font></font><code>ScheduleInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then drag from the Object Library </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the new interface controller. </font><font style="vertical-align: inherit;">In the Attributes inspector, make the following changes:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Layout</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertical</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mode</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horizontal Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Height</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Relative to Container</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now the interface controller should look like this: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c4e/67a/0b4/c4e67a0b491d7ad735900dde14e70575.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we will create the same group from the label-image-label that we created for the row of the table. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drag another </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> onto the created group and make the following changes to the Attributes inspector:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spacing</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horizontal Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Width</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Size To Fit Content</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Height</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> option </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fixed</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with a value of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">30</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (slightly shorter than the row of the table).</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Add </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">label</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to this new group </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">We will configure the label, and then copy and update it to display the starting and ending point of each flight. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select an image, either in the storyboard, or in the Document outline. </font><font style="vertical-align: inherit;">In the Attributes inspector, make the following changes:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Image</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plane</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tint</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># FA114F</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (our pink color again!).</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertical Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Width</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> option </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fixed</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with a value of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">24</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li>  <em>Height</em>  <em>Fixed</em>   <em>20</em> . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As before, the image does not change the shade, so it is not visible on the black background of the interface controller. But we know that it is there. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select a label and set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MEL</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Then change its </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Font</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with a </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semibold</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> style </font><font style="vertical-align: inherit;">and size of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">20</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Finally, set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertical alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and check that </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Width</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Height</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> are </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Size To Fit Content</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copy the label and paste it next to the image. Change its text to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SFO</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and its </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horizontal Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Right</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Now the interface controller should look like this:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c11/83b/bdc/c1183bbdcf448d7a818a9398ba145a07.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now it's time to add a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">huge</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> registration button!</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Add registration button </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drag a </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">button</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the Object Library onto the interface controller and make sure that it is a neighbor with a group containing the labels of the starting and ending points of the voyage:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/38d/334/294/38d3342940025849ea3c515bf992add2.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The buttons in WatchKit are incredibly flexible: you can use them with the default appearance (such as the one added by us now looks), or turn them into a layout group and add other interface objects to customize their appearance. </font><font style="vertical-align: inherit;">This is what we are going to do. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select the button and make the following changes to the Attributes inspector:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Group</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horizontal Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertical Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now the interface controller should look like this: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5f7/c17/b5d/5f7c17b5d13726847ec0803ee1b3bda2.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You probably noticed that when we changed the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Content</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> attribute of the </font><font style="vertical-align: inherit;">button, a new </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">group</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> appeared in the Document outline </font><font style="vertical-align: inherit;">:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0e/3cd/6c5/f0e3cd6c59b9d2f2be7115de55d71f63.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That is what we will use as the background of our own registration button. </font><font style="vertical-align: inherit;">Select this group and make the following changes to the Attributes inspector:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Color</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># FA114F</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Radius</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">39</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Width</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> option </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fixed</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with a value of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">78</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Choose a </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Height</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fixed</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with a value of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">78</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The interface controller should now look like this: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/523/5a2/037/5235a20377740722873ca5f19208fdc6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our registration button is already beginning to take its form. </font><font style="vertical-align: inherit;">What is missing is a label, so now we will add it. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drag the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">label</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the Object Library into the button group, and then select it. </font><font style="vertical-align: inherit;">Again, make the Attributes inspector in the following changes:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Text </font></font></em><font style="vertical-align: inherit;"></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Check In</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value </font><font style="vertical-align: inherit;">.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Font</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">System</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Semibold</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> style </font><font style="vertical-align: inherit;">and size </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Horizontal Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Set the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vertical Alignment</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Center</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A ready registration interface controller should look like this: </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/10a/602/008/10a6020081de7f4fbd81aa1a19ae3151.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Having finished with the interface, we can go on to create a subclass </font></font><code>WKInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that controls this controller and change </font></font><code>ScheduleInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it to display it.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Creating a controller </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Right-click the group </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watch Extension</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the Project navigator and select </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the New ... the File</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">In the dialog box that appears, select </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">watchOS \ Source \ WatchKit Class</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and click </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Name the new class </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CheckInInterterController</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and make sure that it is a subclass of </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WKInterfaceController</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and that </font><em><font style="vertical-align: inherit;">Swift is</font></em><font style="vertical-align: inherit;"> selected </font><font style="vertical-align: inherit;">for </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Language</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><em><font style="vertical-align: inherit;"></font></em><font style="vertical-align: inherit;"></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c19/89b/035/c1989b035372bdf12f3a33b082001226.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Click </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and then </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Create</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When a new file opens in the code editor, remove the three empty method stubs so that you only have the import statements and the class definition. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then add the following lines on top of the class:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> backgroundGroup: <span class="hljs-type"><span class="hljs-type">WKInterfaceGroup!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> originLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span> <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> destinationLabel: <span class="hljs-type"><span class="hljs-type">WKInterfaceLabel!</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we simply add the Outlet fields for the outermost group and the two interface labels we just created. </font><font style="vertical-align: inherit;">Soon we will connect them all. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then add the following under the Outlet fields:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> flight: <span class="hljs-type"><span class="hljs-type">Flight?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">didSet</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> flight = flight <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } originLabel.setText(flight.origin) destinationLabel.setText(flight.destination) } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we added an auxiliary type property </font></font><code>Flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that includes the Property observer. </font><font style="vertical-align: inherit;">When performing an observer, he tries to remove the wrapper from </font></font><code>flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and if it succeeds, he uses </font></font><code>flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">two tags to tune. </font><font style="vertical-align: inherit;">All this is already familiar to us. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we just need to set </font></font><code>flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if there is a controller. </font><font style="vertical-align: inherit;">Add to the </font></font><code>CheckInInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">following lines:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">awake</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(withContext context: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.awake(withContext: context) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> flight = context <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">Flight</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.flight = flight } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You are also familiar with this. </font><font style="vertical-align: inherit;">We are trying to remove the wrapper and convert it </font></font><code>context</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to an instance </font></font><code>Flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">If this succeeds, then we use it for the task </font></font><code>self.flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which in turn is performed by the Property observer, the tuning interface. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally, add directly under the </font></font><code>awake(withContext:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">following action:</font></font><br><br><pre> <code class="hljs pgsql">@IBAction func checkInButtonTapped() { // <span class="hljs-number"><span class="hljs-number">1</span></span> let duration = <span class="hljs-number"><span class="hljs-number">0.35</span></span> let delay = DispatchTime.now() + (duration + <span class="hljs-number"><span class="hljs-number">0.15</span></span>) // <span class="hljs-number"><span class="hljs-number">2</span></span> backgroundGroup.setBackgroundImageNamed("Progress") // <span class="hljs-number"><span class="hljs-number">3</span></span> backgroundGroup.startAnimatingWithImages(<span class="hljs-keyword"><span class="hljs-keyword">in</span></span>: NSRange(<span class="hljs-keyword"><span class="hljs-keyword">location</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, length: <span class="hljs-number"><span class="hljs-number">10</span></span>), duration: duration, repeatCount: <span class="hljs-number"><span class="hljs-number">1</span></span>) // <span class="hljs-number"><span class="hljs-number">4</span></span> DispatchQueue.main.asyncAfter(deadline: delay) { [weak self] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> // <span class="hljs-number"><span class="hljs-number">5</span></span> self?.flight?.checkedIn = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> self?.dismiss() } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here is what happens at each stage: </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We create two constants: one for the duration of the animation, the other for the delay, after which the controller will be disabled. </font></font><code>delay</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- this is not </font></font><code>Double</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but an instance </font></font><code>DispatchTime</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, because we will use it with the Grand Central Dispatch.</font></font></li><li>       <i>Progress</i>        <code>backgroundGroup</code> .    <code>WKImageAnimatable</code> ,          . </li><li>     .     ,   <code>repeatCount</code> ,  1, ,       . </li><li>  WatchKit   ,     Grand Central Dispatch      . </li><li>    ,    <code>flight</code>  ,    . </li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we just need to add images to the project and connect the Outlet and one action. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this zip file</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , unzip it and drag the folder to </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watch \ Assets.xcassets</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Drag the folder, not its contents. </font><font style="vertical-align: inherit;">This will create a group in the resource directory called </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Progress</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , containing several sets of images:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/da6/133/c42/da6133c422d195a2802f5c45142f68f3.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By adding images, we can assign Outlet fields and button actions. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Watch \ Interface.storyboard</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and select our new interface controller. </font><font style="vertical-align: inherit;">In the Identity inspector, replace the </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Custom Class \ Class</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CheckInInterfaceController</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff8/87e/470/ff887e470863c247142c8cf9522528b0.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then in Document outline, right-click on </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CheckIn</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for a pop-up window of the Outlet fields and actions. </font><font style="vertical-align: inherit;">Connect </font></font><code>backgroundGroup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the outermost group in the interface controller:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f7a/20a/3cf/f7a20a3cfbc2b01b2fe7fad3414444aa.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On the storyboard canvas, connect </font></font><code>destinationLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the label containing </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SFO</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and connect </font></font><code>originLabel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the label containing </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MEL</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then connect </font></font><code>checkInButtonTapped</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to the big round pink button:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4cb/88f/1ff/4cb88f1ffd7b132dd8fb5273159dd650.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Before you build and run the application, we need to make the last change - to display the interface controller. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Controller mapping </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScheduleInterfaceController.swift</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , find </font></font><code>table(_:didSelectRowAt:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and replace its contents with the following lines:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> flight = flights[rowIndex] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> controllers = [<span class="hljs-string"><span class="hljs-string">"Flight"</span></span>, <span class="hljs-string"><span class="hljs-string">"CheckIn"</span></span>] presentController(withNames: controllers, contexts: [flight, flight])</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we get the corresponding flight from </font></font><code>flights</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with the index </font></font><code>rowIndex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, create an array containing the identifiers of the two interface controllers that we want to display, and then display them, passing both </font></font><code>flight</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">as </font></font><code>context</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Build and run the application. </font><font style="vertical-align: inherit;">Touch the flight and you will see a pair of interface controllers displayed. </font><font style="vertical-align: inherit;">Swipe left to open the registration controller, and then touch the button to start the animation and pass the registration:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b93/58b/c89/b9358bc8984dc196b505c04e909d60e3.gif"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It looks great in itself, but it is better that flights that are checked in are highlighted in the controller of the schedule interface. </font><font style="vertical-align: inherit;">This we will do in the next, last section.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Flight highlighting </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Open </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlightRowController.swift</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add the following method to it:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateForCheckIn</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> color = <span class="hljs-type"><span class="hljs-type">UIColor</span></span>(red: <span class="hljs-number"><span class="hljs-number">90</span></span>/<span class="hljs-number"><span class="hljs-number">255</span></span>, green: <span class="hljs-number"><span class="hljs-number">200</span></span>/<span class="hljs-number"><span class="hljs-number">255</span></span>, blue: <span class="hljs-number"><span class="hljs-number">250</span></span>/<span class="hljs-number"><span class="hljs-number">255</span></span>, alpha: <span class="hljs-number"><span class="hljs-number">1</span></span>) planeImage.setTintColor(color) separator.setColor(color) }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here we create an instance </font></font><code>UIColor</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then use it to set the hue color and color, respectively, </font></font><code>planeImage</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>separator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This method will be called when closing the animation, so the color change will be beautifully animated. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Then open </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ScheduleInterfaceController.swift</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add under the </font></font><code>flights</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">following property:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> selectedIndex = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We use it to remember which row of the table is selected when displaying two interface controllers. </font><font style="vertical-align: inherit;">Now it is enough to set it when selecting the row of the table. </font><font style="vertical-align: inherit;">Add the following line just above the call </font></font><code>presentController(withNames:contexts:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to </font></font><code>table(_:didSelectRowAt:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">selectedIndex</span></span> = rowIndex</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This row sets </font></font><code>selectedIndex</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the index value of the selected row in the table. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally, add the following lines in </font></font><code>ScheduleInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, right below </font></font><code>awake(withContext:)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">didAppear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.didAppear() <span class="hljs-comment"><span class="hljs-comment">// 1 guard flights[selectedIndex].checkedIn, let controller = flightsTable.rowController(at: selectedIndex) as? FlightRowController else { return } // 2 animate(withDuration: 0.35) { // 3 controller.updateForCheckIn() } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here is what happens at each stage: </font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We check whether the registration for the selected flight. </font><font style="vertical-align: inherit;">If so, then we are trying to convert the controller row with the corresponding index in the table into an instance </font></font><code>FlightRowController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If this succeeds, we use the animation API </font></font><code>WKInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to perform the closure after 0.35 seconds.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When closing, we call the method that was just added to </font></font><code>FlightRowController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which changes the color of the image and the separator in this row of the table, and provides users with visual feedback indicating that the registration has been completed.</font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Build and run the application. </font><font style="vertical-align: inherit;">Perform the same steps as before to check-in, and you will see that you returned to the time schedule interface controller, and the colors of the image and the separator in the corresponding row of the table gradually changed to a new color:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa7/0ef/8dd/fa70ef8dd700105e0247dcf752c4deba.gif"></div><br>  Congratulations!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You have completed the implementation of your very first set of WatchKit animations. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is a </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">complete example of a project</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that we did in this tutorial. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this section, we learned how to create two different types of WatchKit animations. </font><font style="vertical-align: inherit;">The first used an animated image sequence, and the second </font></font><code>WKInterfaceController</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">used an animation API.</font></font></div><p>Source: <a href="https://habr.com/ru/post/343432/">https://habr.com/ru/post/343432/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../343414/index.html">How Discord changes the size of 150 million images every day with Go and C ++</a></li>
<li><a href="../343416/index.html">Nontrivial cases of working with servers</a></li>
<li><a href="../343418/index.html">We invite you to the exhibition-conference on the gaming industry on December 9 at VSBI</a></li>
<li><a href="../343420/index.html">Analysis of Cisco CDR and Microsoft Exchange Server Logs with Splunk</a></li>
<li><a href="../343430/index.html">To box or not to box? That is the question</a></li>
<li><a href="../343434/index.html">10 Things Newbie Android Developers Face</a></li>
<li><a href="../343438/index.html">Model-View-Presenter - a compromise and universal recipe</a></li>
<li><a href="../343440/index.html">Definitions Axioms</a></li>
<li><a href="../343442/index.html">Developing a web designer tool based on a web application (Figma). Transfer</a></li>
<li><a href="../343444/index.html">Ecowaterair - another scam or something worse? Smells like burnt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>