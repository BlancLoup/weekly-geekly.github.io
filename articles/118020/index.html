<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Setup of the screw web server without RDP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Just recently it took to set up a regular web server. Just at this time, I had a Spring aggravation of PowerShell. In general, as a small warm-up, I d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Setup of the screw web server without RDP</h1><div class="post__text post__text-html js-mediator-article">  Just recently it took to set up a regular web server.  Just at this time, I had a Spring aggravation of PowerShell.  In general, as a small warm-up, I decided to set up a web server without RDP. <br><a name="habracut"></a><br>  So the task: there is a machine with Windows 2008 R2, which is somewhere in England, you need to install IIS, .NET 4.0 and configure a couple of websites.  There are several options for how to do this remotely and from the command line, but today the sponsor will be PowerShell Remoting.  In order for reality to become a reality, you need to enable PowerShell Remoting quite a bit. <br><br><h4>  Configuring PowerShell Remoting on the server </h4><br>  That's just here the first fail.  It is difficult to turn on remote access when there is no remote access.  In general, there will have to use RDP.  In the PowerShell console (hereinafter simply the console), under the administrator, you need to run: <br><br> <code>Enable-PsRemoting -Confirm</code> <br> <br>  If everything is good, now there will always be PowerShell Remoting on the machine.  At this point, RDP can be turned off.  This rudiment of graphical interfaces is no longer needed.  The next step is to configure the client. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Configuring PowerShell Remoting on Client </h4><br>  As for me, PowerShell wrote paranoids.  Prohibited all that is possible and not possible.  So it is also forbidden to connect to servers.  This I am exaggerating a little bit  If everything is in the same domain, then everything will be transparent.  But in my situation, the machine is out of the domain and not even on the same network.  In general, I decided that I would be careful and allow any extra-marital affairs. <br><br> <code>set-item wsman:localhost\client\trustedhosts -value * -force <br> restart-service WinRm</code> <br> <br>  That came to the most interesting.  Connect to the server. <br><br> <code>enter-pssession -ComputerName 192.0.32.10 -Credential "WS0114\Administrator"</code> <br> <br>  You can not imagine how I was waiting for this moment.  Nervous, did not sleep the night.  And then bang, and without drumming, I'm already on the command line on a machine somewhere on the other side of the earth.  In general, yes.  The most nervous stage we passed.  We are on a remote machine.  And very little is left. <br><br><h4>  IIS installation </h4><br>  Everything is simple: <br><br> <code>Import-Module ServerManager <br> Add-WindowsFeature Web-Server</code> <br> <br>  This will really put a lot of unnecessary stuff, so I would advise you to run Get-WindowsFeature, and install only the necessary features. <br><br><h4>  Installing .NET 4.0 </h4><br>  And here is the file number two.  There are no simple commands to install .NET 4.0.  But there are some difficult.  I will describe my version a little lower, and for reporting, I will briefly tell you about probably more correct.  Microsoft has about a dozen of any "central" repositories.  So for web servers there is a <a href="http://www.microsoft.com/web/downloads/platform.aspx">Web Platform Installer</a> .  And this thing has a <a href="http://blogs.iis.net/satishl/archive/2011/01/26/webpi-command-line.aspx">Command Line</a> interface.  If you don‚Äôt ask yourself a question about installing WebPi Command Line, then installing .NET 4.0 would look like: <br><br> <code>WebpiCmdline /Products: NETFX4RTM /AcceptEula</code> <br> <br>  But back better to my version.  If you solve the problem in the forehead, then these are two simple steps.  Download the installer and run it from the command line.  The main problem with the first step.  There are no normal tools for downloading files in PowerShell.  So I wrote a <a href="https://github.com/chaliy/psurl/">little module</a> that wraps the .NET WebClient.  True, I was waiting for a new problem.  In order to install PsUrl, you need to download it.  The circle is closed.  But I was already unstoppable (aggravation).  Feeling the strength to create another bike, I decided that it would be nice to have an installer of modules.  Bums and the Internet have replenished with one more <a href="https://github.com/chaliy/psget/">project</a> . <br><br>  Now the download issue is solved like this: <br><br><pre> <code class="hljs pgsql">#  PsGet (<span class="hljs-built_in"><span class="hljs-built_in">new</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> Net.WebClient).DownloadString("https://github.com/chaliy/psget/raw/master/GetPsGet.ps1") | Invoke-Expression #  PsUrl install-module https://github.com/chaliy/psurl/raw/master/PsUrl/PsUrl.psm1 #  .NET <span class="hljs-number"><span class="hljs-number">4.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>-url http://download.microsoft.com/download/<span class="hljs-number"><span class="hljs-number">9</span></span>/<span class="hljs-number"><span class="hljs-number">5</span></span>/A/<span class="hljs-number"><span class="hljs-number">95</span></span>A9616B<span class="hljs-number"><span class="hljs-number">-7</span></span>A37<span class="hljs-number"><span class="hljs-number">-4</span></span>AF6-BC36-D6EA96C8DAAE/dotNetFx40_Full_x86_x64.exe -ToFile dotNetFx40_Full_x86_x64.exe #  .NET <span class="hljs-number"><span class="hljs-number">4.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>-process .\dotNetFx40_Full_x86_x64.exe -ArgumentList "/q /norestart" -Wait</code> </pre> <br><br>  Here it should be noted that PsGet and PsUrl are now in your modules, but they are not imported at the start of the profile. <br><br><h4>  Customize sites </h4><br>  Import all you need: <br> <code>Import-Module WebAdministration</code> <br>  On this server, all applications will be under .NET 4.0, therefore: <br><br> <code>Set-WebConfigurationProperty /system.applicationHost/applicationPools/applicationPoolDefaults -name managedRuntimeVersion -value v4.0</code> <br> <br>  We will raise the test site: <br><br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">New</span></span>-Item "C:\inetpub\example" -ItemType Directory <span class="hljs-built_in"><span class="hljs-built_in">New</span></span>-WebSite Example -Port:<span class="hljs-number"><span class="hljs-number">8080</span></span> -PhysicalPath:"C:\inetpub\example" <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Url http://example.com -ToFile "C:\inetpub\example\index.html" <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Url http://localhost:<span class="hljs-number"><span class="hljs-number">8080</span></span>/</code> </pre><br><br>  That's all. <br><br> <code>Exit-PsSession</code> <br> <br>  If anything, you can all <a href="https://gist.github.com/938538">one script</a> .  In general, I was more or less satisfied with the process.  Fails are not so much.  "Pitfalls" managed to get around.  By the way, about the "pitfalls".  There are many of them, I did not describe them in this topic, but if you have any problems, ask. <br><br>  PS Spring aggravation continues. <br><br>  <b>[Upadate]</b> <br><br>  It turned out that I lied a little.  Sorry.  Downloading files in PowerShell is.  And with the buns: download, asynchronous download, manager downloads and so on.  Actually uses the Windows component - BITS.  Microsoft traditionally lazhanul with the name therefore the module is called BitsTransfer. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Import</span></span>-Module BitsTransfer #  .NET <span class="hljs-number"><span class="hljs-number">4.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Start</span></span>-BitsTransfer http://download.microsoft.com/download/<span class="hljs-number"><span class="hljs-number">9</span></span>/<span class="hljs-number"><span class="hljs-number">5</span></span>/A/<span class="hljs-number"><span class="hljs-number">95</span></span>A9616B<span class="hljs-number"><span class="hljs-number">-7</span></span>A37<span class="hljs-number"><span class="hljs-number">-4</span></span>AF6-BC36-D6EA96C8DAAE/dotNetFx40_Full_x86_x64.exe #  .NET <span class="hljs-number"><span class="hljs-number">4.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">start</span></span>-process .\dotNetFx40_Full_x86_x64.exe -ArgumentList "/q /norestart" -Wait</code> </pre> </div><p>Source: <a href="https://habr.com/ru/post/118020/">https://habr.com/ru/post/118020/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../118010/index.html">Translation of the article ‚ÄúPimp My Pimpl‚Äù, part 1</a></li>
<li><a href="../118011/index.html">Silex - microfreemv from the creators of symfony2</a></li>
<li><a href="../118017/index.html">CNET's investigation revealed what information Android phones send to Google, and why it cannot be considered anonymous</a></li>
<li><a href="../118018/index.html">Apple is close to launching its music cloud service.</a></li>
<li><a href="../118019/index.html">Large Hadron Collider set a new world record</a></li>
<li><a href="../118022/index.html">Motorola Xoom tablet video review</a></li>
<li><a href="../118023/index.html">Poetic about translation</a></li>
<li><a href="../118024/index.html">Formatting on the comments page</a></li>
<li><a href="../118026/index.html">Visual comparison of JPEG and PNG</a></li>
<li><a href="../118027/index.html">JNI, loading native libraries. Change java.library.path on the fly</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>