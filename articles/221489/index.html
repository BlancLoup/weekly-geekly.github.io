<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Can Apple read your iMessage?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Translation of an article by Matthew Green. In cryptography is not strong, therefore I will be extremely grateful for all corrections of inaccuracies ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Can Apple read your iMessage?</h1><div class="post__text post__text-html js-mediator-article">  <i>Translation of an <a href="http://blog.cryptographyengineering.com/2013/06/can-apple-read-your-imessages.html">article by</a> Matthew Green.</i>  <i>In cryptography is not strong, therefore I will be extremely grateful for all corrections of inaccuracies and clarifications in drugs.</i>  <i>Thank you</i> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/de0/b7d/409/de0b7d40905d48ff9d46212f6efec95d.png" alt="image" align="right">  About a year ago, I wrote a short <a href="http://blog.cryptographyengineering.com/2012/08/dear-apple-please-set-imessage-free.html">post</a> calling for Apple to publish technical details of encryption to iMessage.  I wish I could say that Apple saw my powerful cryptoblog and showed specifications.  But no, iMessage is the same black box it always was. <br><a name="habracut"></a><br>  What really changed was that people <a href="http://www.slashgear.com/apple-denies-prism-backdoor-imessage-end-to-end-encrypted-17286661/">began to</a> worry.  This is partly due to Apple‚Äôs supposed friendship with the <abbr title="National Security Agency"><a href="http://www.washingtonpost.com/blogs/wonkblog/wp/2013/06/25/heres-everything-weve-learned-about-how-the-nsas-secret-programs-work/">NSA</a></abbr> .  In part, this is <a href="http://money.cnn.com/2013/04/07/technology/security/imessage-iphone-dea/index.html">not the</a> fault of <a href="http://money.cnn.com/2013/04/07/technology/security/imessage-iphone-dea/index.html">such friendly relations with <abbr title="Drug Enforcement Administration">OBN</abbr></a> .  In any case, people want to know how much of their information Apple owns and with whom it is shared. <br><br>  And that brings us back to the issue of encryption in iMessage.  Apple launched one of the most popular encrypted communication services on the planet: over <a href="http://www.bizreport.com/2013/01/imessage-takes-2-billion-messages-from-carriers-each-day.html">2 billion</a> messages in iMessage every day.  Each of them contains personal information that the NSA and the DEA would like to have in their hands.  But, in fact, <a href="http://www.apple.com/apples-commitment-to-customer-privacy/">even Apple cannot read them</a> : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote>  There are several categories of information that we do not pass on to any law enforcement authorities or to any other groups, since we have decided not to keep them. </blockquote><br>  <b>For example, conversations via iMessage or FaceTime use <a href="http://en.wikipedia.org/wiki/End-to-end_encryption">end-to-end encryption</a> , so that no one except the sender and the recipient can read them.</b>  <b>Apple cannot decrypt this data.</b> <br><br>  It looks believable, and my experience says that it is quite likely.  My point of view is due to the ‚ÄúGreen Law on Applied Cryptography,‚Äù which says that basically applied cryptography sucks.  Cryptography never gives unconditional guarantees, as you would like, and this is what <a href="http://www.gaudior.net/alma/johnny.pdf">users suffer from</a> . <br><br>  And this is the problem with iMessage: users do not suffer enough!  The service is incredibly easy to use, which means that Apple compromised, or rather found a balance between usability and security.  And as long as there is nothing wrong with compromises, their decisions are of great importance when it comes to your personal information.  By engaging in these details on its own, Apple frees its users from unnecessary actions to protect themselves. <br><br>  The details of these trade-offs are exactly what I want to talk about in this post.  The post that I swear will be the last post I write about iMessage.  From this point on, there will be only ciphers and no evidence. <br><br><h5>  <b>Apple saves copies of i Messages in iCloud</b> </h5><br>  The biggest problem with Apple‚Äôs position is that it‚Äôs not true.  If you use the <a href="http://support.apple.com/kb/PH12520%3Fviewlocale%3Den_US">iCloud backup</a> service to save your iDevice data, then there is a rather high probability that Apple may receive the last few days of correspondence in iMessage. <br><br>  For those who are not aware of the Apple ecosystem: iCloud is an optional data storage service provided by Apple for free.  Backups are amazing, but if iMessages get backed up, then the question arises of their security.  Believing in the word of the company (that they cannot receive our messages) leaves us with only two options: <br><br><ol><li>  IMessage backups are encrypted with a key that <a href="http://mashable.com/2013/06/18/apple-encrypted-imessages/">never leaves your device</a> </li><li>  IMessage backups are encrypted with a key that is associated with your password </li></ol><br><br>  Unfortunately, none of these options is true, and to prove it is quite simple.  All you need to do is make an <a href="http://blog.cryptographyengineering.com/2012/04/icloud-who-holds-key.html">easy experiment</a> : first, lose your iPhone.  Then, change the password using the Epplow password recovery service (you will need to answer a few questions, or enter a spare e-mail).  Now we go to the Apple store and lay out a fortune for a new phone. <br><br>  If you can restore your lost messages on the new iPhone (as I <a href="http://blog.cryptographyengineering.com/p/a-note-on-icloud-experiment.html">did</a> it right in the Apple store this afternoon), then Apple does not protect your iMessages with any keys and passwords.  Sadly (Ashkan Soltani (Ashkan Soltani) made some <a href="http://arstechnica.com/security/2013/06/can-apple-read-your-imessages-ars-deciphers-end-to-end-crypto-claims/">screenshots</a> from the same test). <br><a name="ex3"></a><br>  The bad thing is that there is no any cryptography in which to understand.  The simple and obvious fact is this: if you could do it, then someone at Apple can do it too.  Perhaps when requesting services of the law.  All they need is your Secret Questions, something Apple is sure to keep <a href="https://habr.com/ru/post/221489/">*</a> . <br><br><h5>  Apple distributes iMessage encryption keys </h5><br>  You may not be using backups.  In this case, all of the above is not about you and Apple honestly says that the message uses end-to-end encryption.  The question you should ask yourself in this case: the messages are encrypted for whom? <br><a name="ex4"></a><br>  The problem is that encryption works if I have your encryption key.  This means that if I want to talk to you, I must first get the key.  Apple found a solution to this problem: they have <a href="http://imfreedom.org/wiki/IMessage">a</a> directory that iMessage can use to find the key associated with an email address or phone number.  This is great, but this is another ‚Äúcompromise‚Äù: now you are completely dependent on giving Apple the <i>right key</i> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/401/86c/f61/40186cf61860cab2bab2b6bc48d7e3b2.jpg" alt="image" width="500" height="500" align="right" title="The HTTPS request contains the message ID key associated with the iPhone number. These keys were sent via SSL"><br><br>  The danger is that Apple (or the hacker who attacked the server with the Apple key directories) must first give you your key.  From now on, you will not know that you are sending messages to this person, and not to your friend.  <a href="https://habr.com/ru/post/221489/">**</a> <br><br>  Moreover, iMessage allows you to link multiple keys from multiple devices.  For example, you can add your Mac to receive copies of all messages sent to your phone.  Also, iMessage does not give the user information about how many keys are associated with one account and does not notify you when new keys are added. <br><br>  In fact, the integrity of iMessage depends on how well Apple distributes the keys.  If Apple makes a mistake (or a hacker attacks the iMessage server), then a mediator attack ( <a href="https://ru.wikipedia.org/wiki/%25D0%25A7%25D0%25B5%25D0%25BB%25D0%25BE%25D0%25B2%25D0%25B5%25D0%25BA_%25D0%25BF%25D0%25BE%25D1%2581%25D0%25B5%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25BD%25D0%25B5">man-in-the-middle attack</a> ) becomes possible and intercepting iMessage data will not cause any particular difficulties. <br><br>  Today it is obvious for some, for the rest it doesn‚Äôt matter much.  And everyone is happy.  But people should at least understand the strengths and weaknesses of Apple‚Äôs chosen concept.  With this knowledge, they can determine on their own how trust Apple should be. <br><br><h5>  Apple can store metadata </h5><br>  Although Apple can encrypt the content of your messages, their rules do not exclude the possibility of storing the data of who you are communicating with.  These are well-known metadata that the NSA immediately dismisses and (as I <a href="http://blog.cryptographyengineering.com/2013/06/how-to-backdoor-encryption-app.html">said before</a> ) cannot at least not collect this information, especially given the fact that Apple delivers your messages through its servers. <br><br>  This data can be as valuable as the rest.  And while Apple does not store the content of your messages, their agreement says nothing about all this metadata. <br><br><h5>  Apple does not use <a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning" title="a procedure in which the hierarchy of certificate signatures is ignored, and telling the browser: ‚Äútrust this certificate unconditionally‚Äù - comment on">Certificate Pinning</a> </h5><br><br>  And the last (not very serious) point is that iMessage clients (for iPhone and Mac) are connected to the Apple distribution directory using the <a href="http://ru.wikipedia.org/wiki/HTTPS">HTTPS protocol</a> (note that this applies to search in message history, current iMessages are encrypted separately and travel using the <s><a href="http://ru.wikipedia.org/wiki/XMPP">XMPP</a></s> <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BB%25D1%2583%25D0%25B6%25D0%25B1%25D0%25B0_Push_%25D1%2583%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25BE%25D0%25BC%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B9_Apple">push Apple notifications</a> ). <br><br>  Using HTTPS is a good idea and, basically, it provides good protection against interception.  But so do not defend against all attacks.  There is still a real <a href="http://www.digitaltrends.com/web/forged-security-certificate-targets-gmail-users/">possibility</a> for an attacker <a href="http://www.digitaltrends.com/web/forged-security-certificate-targets-gmail-users/">to</a> obtain a fake certificate (possibly with damage to the certificate authority) and thus intercept or change the connection with Apple. <br><br>  <i>Here I don‚Äôt really understand why an attacker should get a fake certificate, and not a genuine one.</i>  <i>Maybe it meant the introduction of a fake certificate by a hacker?</i> <br><br>  This kind of thing is not as crazy as we think.  This <a href="http://www.digitaltrends.com/web/forged-security-certificate-targets-gmail-users/">happened</a> to hundreds of Iranian Gmail users and is likely to repeat in the future.  The standard solution to this problem is <a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning">certificate pinning</a> (it tells the application not to trust unknown certificates).  A lot of apps like Twitter did it.  But not Apple, as I found out during testing and writing this post. <br><br><h5>  Finally </h5><br>  I did not write this post because I do not like Apple.  On the contrary, I really like their products and would even swim with them if (unfortunately) this did not nullify the warranty. <br><br>  But the reverse side of my admiration is simple: I trust their devices and want to know how protected they are.  I do not see any flaws in Apple in explaining this, at least to high-level specialists, even with the backlog of details.  The explanation should include the type and principle of encryption algorithms, the details of the directory service and the key agreement protocol. <br>  Apple may think outside the box, but information security rules apply to them.  Sooner or later, someone will break or rewrite the iMessage system.  And then it all comes out. <br><br><h5>  Notes: </h5><br><a name="ex1"></a>  * Of course, it is possible that Apple uses your secret questions to get the encryption key.  However, this is unlikely.  First, because Apple probably stores your question / answer in a separate file.  And if not, then most of the answers to the questions are unlikely to store enough <a href="http://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D1%2584%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%258D%25D0%25BD%25D1%2582%25D1%2580%25D0%25BE%25D0%25BF%25D0%25B8%25D1%258F">entropy</a> to decrypt.  After all, there are so many birthdays and car brands in the world.  <a href="http://support.apple.com/kb/HT5570">Two-step authentication</a> can improve the situation if you use it.  <i><a href="https://habr.com/ru/post/221489/">Back to top</a></i> <br><a name="ex2"></a>  ** In practice, it is not entirely clear whether Apple devices generate the key themselves or arrange an <a href="http://ru.wikipedia.org/wiki/Off-the-Record_Messaging">OTR</a> <a href="http://en.wikipedia.org/wiki/Key_exchange">-like key exchange</a> .  It is clear that iMessage does not contain a ‚Äúkey fingerprint‚Äù or something similar for users to verify the authenticity of the key, which implies Apple‚Äôs full confidence in encryption issues.  In addition, iMessage allows you to send messages offline.  It's not entirely clear how this should work with OTR. </div><p>Source: <a href="https://habr.com/ru/post/221489/">https://habr.com/ru/post/221489/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221477/index.html">Using Yandex MapKit with Pivot and Panorama controls</a></li>
<li><a href="../221479/index.html">Happy Star Wars Day! May the force be with you</a></li>
<li><a href="../221483/index.html">Writing a plugin for GStreamer on MS Visual Studio</a></li>
<li><a href="../221485/index.html">Breaking Vigenera cipher using frequency cryptanalysis</a></li>
<li><a href="../221487/index.html">Stephen Wolfram: ‚ÄúImplementing calculations everywhere‚Äù</a></li>
<li><a href="../221495/index.html">Comparative overview of BPM systems</a></li>
<li><a href="../221497/index.html">Control through wine</a></li>
<li><a href="../221501/index.html">Free software for design - to authors of innovative and useful projects.</a></li>
<li><a href="../221503/index.html">Web Security Summary</a></li>
<li><a href="../221505/index.html">How I bought the camera</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>