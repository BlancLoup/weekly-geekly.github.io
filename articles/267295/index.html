<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RC5 encryption algorithm and its implementation in python</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="RC5 algorithm 
 In my post, I would like to talk about the RC5 symmetric encryption algorithm and my version of its implementation in python. This alg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>RC5 encryption algorithm and its implementation in python</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/post/267295/"><img src="https://habrastorage.org/files/6ba/a47/468/6baa474684cf46b9a5cdb8df9256d1ff.png" align="left"></a> <br><h4>  <font color="DarkOrchid">RC5 algorithm</font> </h4><br>  In my post, I would like to talk about the RC5 symmetric encryption algorithm and my version of its implementation in python.  This algorithm was developed by the most famous cryptologist Ronald <s>Macdonald</s> Rivest - one of the developers of the RSA system and the founders of the eponymous company.  By the number of users, RC5 ranks with such well-known algorithms as IDEA and Blowfish.  RC stands for, according to various sources, either Rivest Cipher or Ron's Code, which together gives us the ‚ÄúRon Rivest cipher‚Äù.  Interested please under the cat. <br><a name="habracut"></a><br><h5>  <font color="DarkOrchid">Introduction</font> </h5><br>  In the description of the algorithm we will use the following notation: <br><ul><li>  Word size <img src="https://habrastorage.org/files/7c1/26b/714/7c126b714976467f91143fd8cd0896e1.gif" title="w">  <u>in bits</u> .  RC5 encrypts in two word blocks;  valid values ‚Äã‚Äãare 16, 32, and 64. This value is recommended to be taken equal to the machine word.  For example for 32-bit machines <img src="https://habrastorage.org/files/7c1/26b/714/7c126b714976467f91143fd8cd0896e1.gif" title="w">  = 32 and therefore the block size will be 64 bits </li><li>  The number of rounds of the algorithm <img src="https://habrastorage.org/files/db6/2af/3df/db62af3df14d400d9a6fcb90aba772ec.gif" title="R">  - integer from 0 to 255 inclusive.  If set to 0, encryption will not be performed. </li><li>  Secret key size <img src="https://habrastorage.org/files/689/67a/db5/68967adb55484926a0baa4235f81008b.gif" title="b">  <u>in bytes</u> - an integer from 0 to 255 inclusive </li></ul><br>  To clarify the parameters used in a particular case, the notation RC5- is used. <img src="https://habrastorage.org/files/dd4/f15/5a0/dd4f155a07ab41e7897c736673315d4b.gif" title="w / r / b">  ; <br>  for example, RC5-32 / 12/16 denotes the RC5 algorithm with a 64-bit block, 12 rounds of encryption and a 16-byte key (this combination is recommended by Rivest as the main option). <br><br>  The work of the algorithm consists of two stages: <br><ul><li>  Key Expansion Procedure </li><li>  Encryption itself </li></ul><br>  Create a class and constructor initializing the necessary starting variables. <br><div class="spoiler">  <b class="spoiler_title">Python listing</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, w, R, key)</span></span></span><span class="hljs-function">:</span></span> self.w = w self.R = R self.key = key self.T = <span class="hljs-number"><span class="hljs-number">2</span></span> * (R + <span class="hljs-number"><span class="hljs-number">1</span></span>) self.w4 = w // <span class="hljs-number"><span class="hljs-number">4</span></span> self.w8 = w // <span class="hljs-number"><span class="hljs-number">8</span></span> self.mod = <span class="hljs-number"><span class="hljs-number">2</span></span> ** self.w self.mask = self.mod - <span class="hljs-number"><span class="hljs-number">1</span></span> self.b = len(key) self.__keyAlign() self.__keyExtend() self.__shuffle()</code> </pre> <br></div></div><br><h5>  <font color="DarkOrchid">Key Expansion Procedure</font> </h5><br>  I propose to start with a stage that is a little more complicated, namely, with the key expansion procedure.  For this we need to write 3 simple functions: <br><ul><li>  Key alignment </li><li>  Extended key array initialization </li><li>  Shuffle arrays of keys </li></ul><br><h6>  <font color="Crimson">Key alignment</font> </h6><br>  If the key size (in bytes) is not a multiple <img src="https://habrastorage.org/files/841/f89/820/841f898209ed4e65982fa3507c3d61b4.gif" title="w / 8">  , we supplement it with zero bytes to the nearest multiple <img src="https://habrastorage.org/files/841/f89/820/841f898209ed4e65982fa3507c3d61b4.gif" title="w / 8">  .  After that, the key is copied to the array. <img src="https://habrastorage.org/files/3d2/fae/eae/3d2faeeae4234504a669f0e335f87a0a.gif" title="L [0] .. L [c]">  where <img src="https://habrastorage.org/files/297/0ce/6da/2970ce6daa7a46839defe962f142c1ee.gif" title="c = w / 8">  .  Simply put, we copy the key in blocks of <img src="https://habrastorage.org/files/841/f89/820/841f898209ed4e65982fa3507c3d61b4.gif" title="w / 8">  bytes (2, 4, 8 for values <img src="https://habrastorage.org/files/7c1/26b/714/7c126b714976467f91143fd8cd0896e1.gif" title="w">  16, 32, 64 respectively) into an array <img src="https://habrastorage.org/files/95d/fc1/2ab/95dfc12ab992442d8e0baa9b59dbb76a.gif" title="L">  . <br>  For example, with parameters <img src="https://habrastorage.org/files/59a/ae5/40e/59aae540e7d14fb88a64e2ec6527e91e.gif" title="w = 32, R = 12, b = 7">  and key value <img src="https://habrastorage.org/files/977/272/06a/97727206a58c42b39aab7b1af18eb75b.gif" title="key = b'testkey '">  we'll get <img src="https://habrastorage.org/files/45c/8f0/f76/45c8f0f7688347c0b903e4077dffa2a9.gif" title="L [0] = b'test">  and <img src="https://habrastorage.org/files/62b/7c5/44c/62b7c544cee84108952cda1d41c449ef.gif" title="L [1] = b'key \ x00">  (0 means zero byte). <br><br>  We describe the necessary function <br><div class="spoiler">  <b class="spoiler_title">Python listing</b> <div class="spoiler_text"><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__keyAlign</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.b == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-comment"><span class="hljs-comment">#   self.c = 1 elif self.b % self.w8: #    w / 8 self.key += b'\x00' * (self.w8 - self.b % self.w8) #    \x00 self.b = len(self.key) self.c = self.b // self.w8 else: self.c = self.b // self.w8 L = [0] * self.c for i in range(self.b - 1, -1, -1): #   L L[i // self.w8] = (L[i // self.w8] &lt;&lt; 8) + self.key[i] self.L = L</span></span></code> </pre><br></div></div><br><h6>  <font color="Crimson">Initialization of the extended key array</font> </h6><br>  In this step, we need to generate pseudo-random constants. <img src="https://habrastorage.org/files/221/729/299/22172929927c44e78492510919530986.gif" title="Pw">  and <img src="https://habrastorage.org/files/87d/7bd/447/87d7bd4478a14e95b4018b58f8cbde70.gif" title="Qw">  according to the following formulas: <br><img src="https://habrastorage.org/files/401/dff/ab7/401dffab738f4136ac0d7e8f754c5cb4.gif" title="Pw = Odd ((f-1) * 2 ^ w)"><br><img src="https://habrastorage.org/files/12e/daf/229/12edaf22966f4423934930647dab1197.gif" title="Qw = Odd ((e-2) * 2 ^ w">  , <br>  Where <br><img src="https://habrastorage.org/files/c59/d36/b94/c59d36b94cee44c6bee5d4cac3dc7bbf.gif" title="Odd">  - rounding function to the nearest inappropriate <br><img src="https://habrastorage.org/files/ce9/9c0/021/ce99c0021628462caec8c946ede58d23.gif" title="exp">  - <a href="https://ru.wikipedia.org/w/index.php%3Ftitle%3DE_(%25D1%2587%25D0%25B8%25D1%2581%25D0%25BB%25D0%25BE)%26oldid%3D72813151">Euler number</a> <br><img src="https://habrastorage.org/files/2be/c16/22a/2bec1622a29549f7848bd142880bf544.gif" title="f">  - <a href="https://ru.wikipedia.org/w/index.php%3Ftitle%3D%25D0%2597%25D0%25BE%25D0%25BB%25D0%25BE%25D1%2582%25D0%25BE%25D0%25B5_%25D1%2581%25D0%25B5%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5%26oldid%3D73115047">golden ratio</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Also in the specification of the algorithm are already calculated constants for all possible values. <img src="https://habrastorage.org/files/7c1/26b/714/7c126b714976467f91143fd8cd0896e1.gif" title="w">  : <br><img src="https://habrastorage.org/files/c8d/571/691/c8d5716915f243f2835f285b7d66e779.gif" title="P16 = B7E1"><br><img src="https://habrastorage.org/files/546/575/7ca/5465757ca0074b39b3c28c4e1b5fb4ce.gif"><br><img src="https://habrastorage.org/files/18a/0ed/b20/18a0edb205c049dc981bdbed9504298d.gif" title="P32 = B7E15163"><br><img src="https://habrastorage.org/files/c9c/5ac/713/c9c5ac7130734277b6d2b1b95d23b6b6.gif" title="Q32 = 9E3779B9"><br><img src="https://habrastorage.org/files/b7c/4d8/3ed/b7c4d83ed96049ba9bbbc4f260808593.gif" title="P64 = B7E151628AED2A6B"><br><img src="https://habrastorage.org/files/4bf/d25/3c2/4bfd253c201047af81fc02579b8f360a.gif" title="Q64 = 9E3779B97F4A7C15">  , <br>  all constants are represented in hexadecimal. <br><br>  Having got everything we need, we initialize the array. <img src="https://habrastorage.org/files/14c/031/840/14c0318409954c5299dfb5d47f23963f.gif" title="S [0] .. S [2 * r + 1]">  where <br><img src="https://habrastorage.org/files/412/214/c3b/412214c3bc3346a2a1a93a62eb4257ed.gif" title="S [0] = Pw"><br><img src="https://habrastorage.org/files/8ba/b2a/76e/8bab2a76ef2c417f8f640af2c57e0180.gif" title="S [i + 1] = S [i] + Qw"><br><br>  Feature Description <br><div class="spoiler">  <b class="spoiler_title">Python listing</b> <div class="spoiler_text"><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__const</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    if self.W == 16: return (0xB7E1, 0x9E37) #   P  Q  elif self.W == 32: return (0xB7E15163, 0x9E3779B9) elif self.W == 64: return (0xB7E151628AED2A6B, 0x9E3779B97F4A7C15) def __keyExtend(self): #   S P, Q = self.__const() self.S = [(P + i * Q) % self.mod for i in range(self.T)]</span></span></code> </pre><br></div></div><br><h6>  <font color="Crimson">Stirring</font> </h6><br>  Now, before proceeding to encryption, we need only mix the elements of the arrays L and S by executing the following cycle: <br><img src="https://habrastorage.org/files/2c3/679/2ab/2c36792abd0643d0993a70bbbecba30c.gif" title="A = S [i] = (S [i] + A + A) <<< 3"><br><img src="https://habrastorage.org/files/5eb/110/1f6/5eb1101f6b844bd689f89e7b59b6796d.gif" title="B = L [j] = (L [j] + A + B) <<< (A + B)"><br><img src="https://habrastorage.org/files/d5c/802/7d5/d5c8027d5b354704b4ae8a96a409bfac.gif" title="i = (i + 1) mod (2 * R + 1)"><br><img src="https://habrastorage.org/files/7c3/ee2/617/7c3ee2617e9d4618908d2b489af696f7.gif" title="j = (j + 1) mod (c)">  where <br><img src="https://habrastorage.org/files/ee8/f29/e84/ee8f29e843cf42afb91e4c5a56b5a497.gif" title="i, j, A, B">  - temporary variables, initial values ‚Äã‚Äãare 0 <br><img src="https://habrastorage.org/files/910/e20/582/910e20582dbf4209948fc6736599cb3c.gif" title="L, S">  - arrays obtained in the previous steps <br>  Number of iterations <img src="https://habrastorage.org/files/06e/d7a/f42/06ed7af42295476eaa99fad335d5ed77.gif" title="N">  defined as <img src="https://habrastorage.org/files/a88/735/712/a8873571264b43b4b2626caca9b6dd5d.gif" title="N = 3 * max (c, 2 * R + 1)"><br><br><div class="spoiler">  <b class="spoiler_title">Python listing</b> <div class="spoiler_text"><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__shuffle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> i, j, A, B = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">3</span></span> * max(self.c, self.T)): A = self.S[i] = self.__lshift((self.S[i] + A + B), <span class="hljs-number"><span class="hljs-number">3</span></span>) B = self.L[j] = self.__lshift((self.L[j] + A + B), A + B) i = (i + <span class="hljs-number"><span class="hljs-number">1</span></span>) % self.T j = (j + <span class="hljs-number"><span class="hljs-number">1</span></span>) % self.c</code> </pre><br>  Lshift and rshift (which we will meet below) are logical left and right operations, respectively. <br>  I think that their comments will be redundant, and the code can be viewed on github (link at the end) <br></div></div><br><br><h5>  <font color="DarkOrchid">Algorithm structure</font> </h5><br><h6>  <font color="Crimson">Encryption</font> </h6><br>  The algorithm is a network of its Feistel, in each round of which (with the exception of zero) the following operations are performed: <br><img src="https://habrastorage.org/files/062/12e/cda/06212ecda1674f018670146136481463.gif" title="A = ((A + B) <<< B) + S [2 * r] mod2 ^ w"><br><img src="https://habrastorage.org/files/ae2/6e6/f33/ae26e6f3304b4f8dbe25893894c14473.gif" title="B = ((A + B) <<< A) + S [2 * r + 1] mod2 ^ w">  , <br>  Where <br><img src="https://habrastorage.org/files/030/a67/91f/030a6791f03a498ea4e3a868477e2147" title="r">  - number of the current round, starting with 1 <br><img src="https://habrastorage.org/files/8f9/c29/383/8f9c29383c5a48c58346a52f3f20b533.gif" title="S [n]">  - extended key fragment <br><img src="https://habrastorage.org/files/213/8f7/ed1/2138f7ed1bdd46eeb7393549f5661cd7.gif" title="<<< n">  - cyclic shift operation on <img src="https://habrastorage.org/files/805/dd5/53f/805dd553f8a541069d6eb5c511a49c25.gif" title="n">  bits left <br><br>  In the zero round, the operations of imposing the first two fragments of the extended key on the encrypted data are performed: <br><img src="https://habrastorage.org/files/3ef/39f/3d0/3ef39f3d0e98473da28752fd8850aa44.gif" title="A = (A + S [0]) mod2 ^ w"><br><img src="https://habrastorage.org/files/57f/7b1/a8f/57f7b1a8f3e8495ea9de91b0467b94ff.gif" title="B = (B + S [1]) mod2 ^ w"><br><br>  It is worth noting that a round means transformations, corresponding to two rounds of conventional algorithms designed on the basis of Feistel networks.  For a round, RC5 processes the block as a whole, in contrast to the round of the Feistel network processing one sub-block - most often half of the block. <br><br>  Corresponding code: <br><div class="spoiler">  <b class="spoiler_title">Python listing</b> <div class="spoiler_text"><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">encryptBlock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, data)</span></span></span><span class="hljs-function">:</span></span> A = int.from_bytes(data[:self.w8], byteorder=<span class="hljs-string"><span class="hljs-string">'little'</span></span>) B = int.from_bytes(data[self.w8:], byteorder=<span class="hljs-string"><span class="hljs-string">'little'</span></span>) A = (A + self.S[<span class="hljs-number"><span class="hljs-number">0</span></span>]) % self.mod B = (B + self.S[<span class="hljs-number"><span class="hljs-number">1</span></span>]) % self.mod <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, self.R + <span class="hljs-number"><span class="hljs-number">1</span></span>): A = (self.__lshift((A ^ B), B) + self.S[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) % self.mod B = (self.__lshift((A ^ B), A) + self.S[<span class="hljs-number"><span class="hljs-number">2</span></span> * i + <span class="hljs-number"><span class="hljs-number">1</span></span>]) % self.mod <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (A.to_bytes(self.w8, byteorder=<span class="hljs-string"><span class="hljs-string">'little'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">encryptFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, inpFileName, outFileName)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#              with open(inpFileName, 'rb') as inp, open(outFileName, 'wb') as out: run = True while run: text = inp.read(self.w4) if not text: break if len(text) != self.w4: text = text.ljust(self.w4, b'\x00') #        ,     ,       run = False text = self.encryptBlock(text) out.write(text)</span></span></code> </pre><br></div></div><br><h6>  <font color="Crimson">Decryption</font> </h6><br>  Data decryption is performed by applying the inverse operation in reverse order  We first perform the following cycle: <br><img src="https://habrastorage.org/files/255/df6/edb/255df6edbdd24c7ab507969c618719d2.gif" title="B = (((B-S [2 * r + 1]) mod2 ^ w) >>> A) + A"><br><img src="https://habrastorage.org/files/e50/a47/9e5/e50a479e53de4dffaaefaa941f9f629f.gif" title="A = (((A-S [2 * r]) mod2 ^ w) >>> B) + B">  , <br>  Where <br><img src="https://habrastorage.org/files/951/d3f/197/951d3f197a2f4ab993d02776d74edde6.gif" title=">>> n">  - cyclic right shift operation <br><img src="https://habrastorage.org/files/030/a67/91f/030a6791f03a498ea4e3a868477e2147" title="r">  - the round number in the reverse order, i.e.  beginning with <img src="https://habrastorage.org/files/db6/2af/3df/db62af3df14d400d9a6fcb90aba772ec.gif" title="R">  and ending with a unit. <br><br>  After this, the operations are reverse for the zero round, namely: <br><img src="https://habrastorage.org/files/b57/61d/ab0/b5761dab08b54b67b8e1cad5c2432b4c.gif" title="B = (B-S [1]) mod2 ^ w"><br><img src="https://habrastorage.org/files/2b2/755/9df/2b27559df7cf4e839ab3200800381b59.gif" title="A = (A-S [0]) mod2 ^ w"><br><br>  Code here: <br><div class="spoiler">  <b class="spoiler_title">Python listing</b> <div class="spoiler_text"><pre> <code class="python hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decryptBlock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, data)</span></span></span><span class="hljs-function">:</span></span> A = int.from_bytes(data[:self.w8], byteorder=<span class="hljs-string"><span class="hljs-string">'little'</span></span>) B = int.from_bytes(data[self.w8:], byteorder=<span class="hljs-string"><span class="hljs-string">'little'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(self.R, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>): B = self.__rshift(B - self.S[<span class="hljs-number"><span class="hljs-number">2</span></span> * i + <span class="hljs-number"><span class="hljs-number">1</span></span>], A) ^ A A = self.__rshift(A - self.S[<span class="hljs-number"><span class="hljs-number">2</span></span> * i], B) ^ B B = (B - self.S[<span class="hljs-number"><span class="hljs-number">1</span></span>]) % self.mod A = (A - self.S[<span class="hljs-number"><span class="hljs-number">0</span></span>]) % self.mod <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (A.to_bytes(self.w8, byteorder=<span class="hljs-string"><span class="hljs-string">'little'</span></span>) + B.to_bytes(self.w8, byteorder=<span class="hljs-string"><span class="hljs-string">'little'</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decryptFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, inpFileName, outFileName)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(inpFileName, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> inp, open(outFileName, <span class="hljs-string"><span class="hljs-string">'wb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> out: run = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> run: text = inp.read(self.w4) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> text: <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(text) != self.w4: run = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> text = self.decryptBlock(text) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> run: text = text.rstrip(<span class="hljs-string"><span class="hljs-string">b'\x00'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#      b'\x00' out.write(text)</span></span></code> </pre><br></div></div><br>  The algorithm is strikingly simple - it uses only modulo 2 and modulo addition operations. <img src="https://habrastorage.org/files/788/48d/443/78848d443f704e81b1a2b1e2a402aec7.gif" title="2 ^ w">  as well as shifts by a variable number of bits.  The last of the operations is presented by the author of the algorithm as a revolutionary solution that was not used in earlier encryption algorithms (prior to the RC5 algorithm, these were used only in the Madryga algorithm, which was not widely used) - a shift by a variable number of bits is a very simple operation, but significantly complicates the differential and linear cryptanalysis of the algorithm.  The simplicity of the algorithm can be considered as its important advantage - a simple algorithm is easier to implement and easier to analyze for possible vulnerabilities. <br><br>  The whole code can be viewed on <a href="https://github.com/tbb/pyRC5/blob/master/RC5.py">github</a> . <br><h6>  <font color="Crimson">Bit of cryptanalysis</font> </h6><br><ul><li>  There is a class of keys using which the algorithm can be opened by linear cryptanalysis.  In other cases it is almost impossible. </li><li>  Differential cryptanalysis is more effective when attacking this algorithm.  For example, for the algorithm RC5-32-12-16, at best, it is required <img src="https://habrastorage.org/files/400/ce4/8ad/400ce48adc824d56a0f2134c94e0e3ff.gif" title="2 ^ 44">  selected clear texts for a successful attack.  When using 18-20 (and more) rounds instead of 12, it is almost impossible to open the algorithm using differential cryptanalysis. </li></ul><br>  Thus, the most realistic method of cracking the RC5 algorithm (not counting the options with a small number of rounds and with a short key) is a complete search through the possible options for the encryption key.  Which means that the RC5 algorithm has practically no flaws in terms of its durability.  On this and I would like to finish.  Thank you all for your attention. <br><br>  UPD: Changed operation lshift, rshift.  Added constants to the class constructor.  Added tests. <br>  Thank you <a href="http://habrahabr.ru/users/mas/" class="user_link">mas</a> for advice and help. </div><p>Source: <a href="https://habr.com/ru/post/267295/">https://habr.com/ru/post/267295/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267281/index.html">PHP Digest number 70 - interesting news, materials and tools (September 6 - 20, 2015)</a></li>
<li><a href="../267283/index.html">We count working days from Moment.js</a></li>
<li><a href="../267289/index.html">Overview of opportunities for working with Microsoft for startups</a></li>
<li><a href="../267291/index.html">Router reservation using VRRP protocol</a></li>
<li><a href="../267293/index.html">Mikrotik RouterOS + PHP script on the site. Empowerment</a></li>
<li><a href="../267297/index.html">Free Firebird large database seminar</a></li>
<li><a href="../267301/index.html">Automate Java EE Testing Web Services with SoapUI and Arquillian</a></li>
<li><a href="../267305/index.html">Modifiers private and private [this] in Scala</a></li>
<li><a href="../267307/index.html">Backups of Hyper-V virtual machines and regular computers</a></li>
<li><a href="../267311/index.html">We carry the general functionality of applications and configurations of Gradle into separate modules</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>