<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ACPI fine tuning on the example of the Thinkpad X220</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lyrics 
 Over the past couple of months, I often had to enter into discussions about all sorts of laptop computers: breaking the spears in disputes wh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ACPI fine tuning on the example of the Thinkpad X220</h1><div class="post__text post__text-html js-mediator-article"><h2>  Lyrics </h2><br>  Over the past couple of months, I often had to enter into discussions about all sorts of laptop computers: breaking the spears in disputes which manufacturer is better and why, discuss compatibility with GNU / Linux and how to configure this or that function in this system and, periodically, me asked to share configs.  Under the influence of these very discussions, this article was born. <br><br>  Most of my computer experience I use so-called ‚Äúbusiness series‚Äù laptops: IBM ThinkPad 600, HP-Compaq nc2400, Lenovo ThinkPad X61T, Lenovo ThinkPad X220. <br><br> <a href=""><img src="https://habrastorage.org/files/ff6/b0b/473/ff6b0b4739004dacb72e366781358f33.jpg"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There were short breaks, when you had to have a hard time anyhow, I mean computers of the consumer segment: Apple ibook G4 and Acer aspire 5112, and it was at these moments that an understanding of how much obvious and familiar things like trackpoint and docking station came. <br><br><a name="habracut"></a><br><br>  What it is?  Support for a laptop with a power connector and all sorts of additional ports.  In some models, you can install an additional hard drive or battery.  The docking station eliminates the need to connect the entire set of cables every time, coming to the workplace and disconnecting when leaving. <br><br>  This configuration is especially convenient under GNU / Linux (in my case, Debian stable), where you can describe the behavior of a computer in several scripts. <br><br><h2>  Description of the scenario </h2><br>  At work, I use a configuration with an external monitor and a bluetooth Lenovo ThinkPad kt1255 keyboard.  The laptop almost never turns off, instead it uses suspend to ram.  I will describe handler scripts: <br><br>  - Wake-up in the dock with the lid closed: turn on the external monitor, activate bluetooth and connect the keyboard, cpu performance <br>  - Opening the lid in the dock: extinguish the external monitor and transfer the image to the internal <br>  - Removing with the lid open: additionally disable the keyboard and bt, cpu on-demand <br>  - Removing with the lid closed: lock the screen, transfer the image to the internal screen by turning off the external one, cut down the keyboard and bt-module, cpu in on-demand, switch to pm-suspend <br>  - Closing the lid off the dock: screen lock, pm-suspend <br><br><h2>  Directly setting </h2><br>  I don‚Äôt use any DE, and I don‚Äôt see any reason to assign the function of power management to them.  Therefore, we will configure by means of acpid. <br><br>  We start the setup, as usual, with the installation of the necessary programs: <br><pre><code class="hljs vala"><span class="hljs-meta"><span class="hljs-meta">#apt-get install acpid acpi-support cpufrequtils</span></span></code> </pre> <br><br>  Next, we look at what events we have generated when disconnecting a laptop: <br><pre> <code class="hljs mel">#acpi_listen ac_adapter ACPI0003:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00000000</span></span> ibm/<span class="hljs-keyword"><span class="hljs-keyword">hotkey</span></span> LEN0068:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00006030</span></span> thermal_zone LNXTHERM:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000081</span></span> <span class="hljs-number"><span class="hljs-number">00000000</span></span> battery PNP0C0A:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00000001</span></span> ibm/<span class="hljs-keyword"><span class="hljs-keyword">hotkey</span></span> LEN0068:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00004011</span></span></code> </pre><br><br>  When docked: <br><pre> <code class="hljs mel">#acpi_listen ibm/<span class="hljs-keyword"><span class="hljs-keyword">hotkey</span></span> LEN0068:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00004010</span></span> ac_adapter ACPI0003:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00000001</span></span> ibm/<span class="hljs-keyword"><span class="hljs-keyword">hotkey</span></span> LEN0068:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00006030</span></span> thermal_zone LNXTHERM:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000081</span></span> <span class="hljs-number"><span class="hljs-number">00000000</span></span> battery PNP0C0A:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00000001</span></span> <span class="hljs-keyword"><span class="hljs-keyword">button</span></span>/lid LID close</code> </pre><br><br>  It is worth noting that the ThinkPad Mini Dock Series 3 does not provide a proc interface. <br><br>  Let's write the rules for events: <br><pre> <code class="hljs mel">#vim /etc/acpi/events/thinkpad-dock <span class="hljs-keyword"><span class="hljs-keyword">event</span></span>=ibm/<span class="hljs-keyword"><span class="hljs-keyword">hotkey</span></span> LEN0068:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00004010</span></span> action=/etc/acpi/thinkpad-dock.sh #vim /etc/acpi/events/thinkpad-undock <span class="hljs-keyword"><span class="hljs-keyword">event</span></span>=ibm/<span class="hljs-keyword"><span class="hljs-keyword">hotkey</span></span> LEN0068:<span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00000080</span></span> <span class="hljs-number"><span class="hljs-number">00004011</span></span> action=/etc/acpi/thinkpad-undock.sh</code> </pre><br><br>  The rule for closing the cover comes with the acpi-support package.  We will bring it to the proper form, indicating the path to the script handler: <br><pre> <code class="hljs mel">#vim /etc/acpi/events/lidbtn <span class="hljs-keyword"><span class="hljs-keyword">event</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">button</span></span>[ /]lid action=/etc/acpi/lid.sh</code> </pre><br><br>  And now we come to the most interesting: scripts that describe the reaction to events under the conditions described above. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#vim /etc/acpi/lid.sh #!/bin/bash #,     - grep -q on /etc/tp_dock_state; if [ $? = 0 ] then # ,     grep -q open /proc/acpi/button/lid/*/state if [ $? = 0 ] then # ,   ,   DISPLAY=:0.0 su user -c 'xrandr --output LVDS1 --auto' DISPLAY=:0.0 su user -c 'xrandr --output HDMI3 --off' else # ,  ,   DISPLAY=:0.0 su user -c 'xrandr --output HDMI3 --auto' DISPLAY=:0.0 su user -c 'xrandr --output LVDS1 --off' # bluetooth-    echo enabled&gt; /proc/acpi/ibm/bluetooth /etc/init.d/bluetooth start # bluetooth . echo 'connect 90:7F:61:10:A3:BC'|bluetoothctl #    alt_gr,    DISPLAY=:0.0 su user -c 'setxkbmap -option grp:toggle us,ru' DISPLAY=:0.0 su user -c 'xmodmap ~/.xmodmaprc' fi else #   grep -q closed /proc/acpi/button/lid/*/state if [ $? = 0 ] then #  ,     bt- echo 'disconnect 90:7F:61:10:A3:BC'|bluetoothctl /etc/init.d/bluetooth stop echo disabled&gt; /proc/acpi/ibm/bluetooth #    user   DISPLAY=:0.0 su user -c /home/user/bin/lock #     DISPLAY=:0.0 su user -c 'xrandr --output LVDS1 --auto' #  DISPLAY=:0.0 su user -c 'xrandr --output HDMI3 --off' #   pm-suspend #  ,    thinkpad: grep -q closed /proc/acpi/button/lid/*/state if [ $? = 0 ] then # , ,   : echo on &gt;/etc/tp_dock_state #      DISPLAY=:0.0 su user -c 'xrandr --output HDMI3 --auto' DISPLAY=:0.0 su user -c 'xrandr --output LVDS1 --off' # bt-,  ,  bt- echo enabled&gt; /proc/acpi/ibm/bluetooth /etc/init.d/bluetooth start echo 'connect 90:7F:61:10:A3:BC'|bluetoothctl #    DISPLAY=:0.0 su user -c 'setxkbmap -option grp:toggle us,ru' DISPLAY=:0.0 su user -c 'xmodmap ~/.xmodmaprc &amp;' fi else # ,      DISPLAY=:0.0 su user -c 'xrandr --output LVDS1 --auto' fi</span></span></code> </pre><br><br>  Let me explain, just in case, that 90: 7F: 61: 10: A3: BC is the address of my keyboard.  Bluetooth devices are configured quite simply: <br><pre> <code class="hljs css"><span class="hljs-selector-id"><span class="hljs-selector-id">#apt-get</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">install</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">bluez</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#bluetoothctl</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[NEW]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Controller</span></span> 40<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:2C</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:F4</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:BB</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:3C</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:FC</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nethack</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[default]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[bluetooth]</span></span># <span class="hljs-selector-tag"><span class="hljs-selector-tag">agent</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Agent</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">registered</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[bluetooth]</span></span># <span class="hljs-selector-tag"><span class="hljs-selector-tag">default-agent</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Default</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">agent</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">request</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">successful</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[bluetooth]</span></span># <span class="hljs-selector-tag"><span class="hljs-selector-tag">scan</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Discovery</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">started</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[CHG]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Controller</span></span> 40<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:2C</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:F4</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:BB</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:3C</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:FC</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">nethack</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[default]</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[NEW]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Device</span></span> 90<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:7F</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:61</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:10</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:A3</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:BC</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ThinkPad</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Compact</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Bluetooth</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Keyboard</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">with</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TrackPoint</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[bluetooth]</span></span># <span class="hljs-selector-tag"><span class="hljs-selector-tag">pair</span></span> 90<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:7F</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:61</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:10</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:A3</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:BC</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Attempting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">to</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">pair</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">with</span></span> 90<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:7F</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:61</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:10</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:A3</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:BC</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[CHG]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Device</span></span> 90<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:7F</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:61</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:10</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:A3</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:BC</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Connected</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">yes</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[agent]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">PIN</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">code</span></span>: 12345 #   <span class="hljs-selector-tag"><span class="hljs-selector-tag">PIN</span></span> <span class="hljs-selector-attr"><span class="hljs-selector-attr">[bluetooth]</span></span># <span class="hljs-selector-tag"><span class="hljs-selector-tag">connect</span></span> 90<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:7F</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:61</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:10</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:A3</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:BC</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Attempting</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">to</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">connect</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">to</span></span> 90<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:7F</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:61</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:10</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:A3</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:BC</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Connection</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">successful</span></span></code> </pre><br><br>  Further, when the devices are connected, it is enough to transmit <br><pre> <code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#echo</span></span> <span class="hljs-string"><span class="hljs-string">'connect 90:7F:61:10:A3:BC'</span></span>| bluetoothctl</code> </pre><br>  What we use in scripts. <br><br>  We describe the docking handler: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#vim /etc/acpi/thinkpad-dock.sh #!/bin/sh #   echo on &gt;/etc/tp_dock_state #    performance cpufreq-set -c 0 -g performance cpufreq-set -c 1 -g performance cpufreq-set -c 2 -g performance cpufreq-set -c 3 -g performance # ,  ,   -   echo 'connect 90:7F:61:10:A3:BC'|bluetoothctl</span></span></code> </pre><br><br>  And undock: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#vim /etc/acpi/thinkpad-undock.sh #!/bin/bash #   echo off &gt;/etc/tp_dock_state #     cpufreq-set -c 0 -g powersave cpufreq-set -c 1 -g powersave cpufreq-set -c 2 -g powersave cpufreq-set -c 3 -g powersave #,   : grep -q closed /proc/acpi/button/lid/*/state if [ $? = 0 ] then # ,    DISPLAY=:0.0 su user -c /home/user/bin/lock # bt-,  ,   echo 'disconnect 90:7F:61:10:A3:BC'|bluetoothctl /etc/init.d/bluetooth stop echo disabled&gt; /proc/acpi/ibm/bluetooth #     DISPLAY=:0.0 su user -c 'xrandr --output LVDS1 --auto' DISPLAY=:0.0 su user -c 'xrandr --output HDMI3 --off' #  pm-suspend #   ,    grep -q closed /proc/acpi/button/lid/*/state if [ $? = 0 ] then # ,        DISPLAY=:0.0 su user -c 'xrandr --output HDMI3 --auto' DISPLAY=:0.0 su user -c 'xrandr --output LVDS1 --off' # bt-,  ,   echo enabled&gt; /proc/acpi/ibm/bluetooth /etc/init.d/bluetooth start echo 'connect 90:7F:61:10:A3:BC'|bluetoothctl #   echo on &gt;/etc/tp_dock_state fi fi</span></span></code> </pre><br><br><h2>  Underwater rocks </h2><br>  After upgrading to debian 8, where systemd appeared in the system, I encountered the following problem: when closing the lid, pm-suspend somehow worked twice.  That is, the lid.sh script was executed, but in parallel with it, the pm-suspend action was performed without any script bindings. <br><br>  The main suspect, of course, was the new initialization harvester.  And for good reason: after ten minutes of googling, it turned out that, it turns out, systemd is trying, until the heap, to take over the acpi event management function, but it is not doing so well for the time being: at the moment it cannot handle the connection events of the power adapter and battery . <br><br>  There was also no desire to rewrite the scripts for new fashion trends, therefore the following was done: <br><pre> <code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#sed</span></span> -i <span class="hljs-string"><span class="hljs-string">'s/HandleLidSwitch=yes/HandleLidSwitch=ignore/'</span></span> /etc/systemd/logind.conf</code> </pre><br>  Thus, we have disaccustomed systemd to do what is not being asked and everything fell into place.  In principle, the same should be done with HandleSuspendKey, HandleHibernateKey and HandlePowerKey, if there is a desire to handle clicks via acpid. <br><br><h2>  Conclusion </h2><br>  Thus, we get a convenient configuration that does not require any extra routine manipulations.  Coming to work in the morning, I take the laptop out of my backpack, insert it into the docking station and press the power button on this docking station, after which I work as with a stationary computer.  Leaving, just press the undock button and put the computer in the backpack. <br><br>  The disadvantage of this approach is exactly one: it is highly addictive. </div><p>Source: <a href="https://habr.com/ru/post/272167/">https://habr.com/ru/post/272167/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272155/index.html">Sublime text for PL / SQL developer</a></li>
<li><a href="../272157/index.html">Depth Enabled Photography - Double Bottom Photo</a></li>
<li><a href="../272161/index.html">Creating a scene system for the game engine</a></li>
<li><a href="../272163/index.html">The feature of creating installation media for Windows 10 edition "Home for one language"</a></li>
<li><a href="../272165/index.html">PHP history: infographics</a></li>
<li><a href="../272173/index.html">Air Datepicker, easy and beautiful date selection</a></li>
<li><a href="../272175/index.html">Critically dangerous vulnerabilities in popular 3G and 4G modems or how to build Big Brother</a></li>
<li><a href="../272177/index.html">Business processes: how not to automate mess</a></li>
<li><a href="../272179/index.html">Rational approximation to pi</a></li>
<li><a href="../272181/index.html">Mail.Ru Group educational projects: 4 years, 1206 students, 101 teachers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>