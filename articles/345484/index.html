<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Linear Regression with Go</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For a long time I was interested in the topic of machine learning. I wondered how machines could learn and predict without any programming - amazing! ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Linear Regression with Go</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/va/nc/ji/vancjilao5d1cbs_mexymfb7kh0.jpeg"></div><br><p>  For a long time I was interested in the topic of machine learning.  I wondered how machines could learn and predict without any programming - amazing!  I was always fascinated by this, but I never studied the topic in detail.  Time is a scarce resource, and every time I tried to read about machine learning, I was flooded with information.  Mastering all of this seemed difficult and time consuming.  I also convinced myself that I did not have the necessary mathematical knowledge even to begin to delve into machine learning. </p><br><p>  But in the end I decided to approach this differently.  Little by little, I will try to recreate different concepts in the code, starting with the basics and gradually moving to more complex ones, trying to cover as many basic things as possible.  I chose Go as the language, this is one of my favorite languages, and besides, I am not familiar with machine learning languages ‚Äã‚Äãlike R or Python. </p><a name="habracut"></a><br><h2 id="nachinaem">  Getting started </h2><br><p>  Let's start by creating a simple model to understand what stages the main learning process is. </p><br><p>  Suppose you need to forecast house prices in King County, Washington. </p><br><p>  First you need to find datasets with real statistics.  Based on it, we will create a model. </p><br><p>  Let's use <a href="https://www.kaggle.com/harlfoxem/housesalesprediction">dataset</a> with <a href="https://www.kaggle.com/">kaggle</a> . </p><br><p>  It comes in the form of a csv-file with the following structure: </p><br><p>  <em>kc_house_data.csv</em> </p><br><pre><code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">id</span></span>,date,price,bedrooms,bathrooms,sqft_living,sqft_lot,floors,waterfront,view,condition,grade,sqft_above,sqft_basement,yr_built,yr_renovated,zipcode,lat,<span class="hljs-keyword"><span class="hljs-keyword">long</span></span>,sqft_living15,sqft_lot15 <span class="hljs-string"><span class="hljs-string">"7129300520"</span></span>,<span class="hljs-string"><span class="hljs-string">"20141013T000000"</span></span>,<span class="hljs-number"><span class="hljs-number">221900</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1180</span></span>,<span class="hljs-number"><span class="hljs-number">5650</span></span>,<span class="hljs-string"><span class="hljs-string">"1"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">1180</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1955</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">"98178"</span></span>,<span class="hljs-number"><span class="hljs-number">47.5112</span></span>,<span class="hljs-number"><span class="hljs-number">-122.257</span></span>,<span class="hljs-number"><span class="hljs-number">1340</span></span>,<span class="hljs-number"><span class="hljs-number">5650</span></span> <span class="hljs-string"><span class="hljs-string">"6414100192"</span></span>,<span class="hljs-string"><span class="hljs-string">"20141209T000000"</span></span>,<span class="hljs-number"><span class="hljs-number">538000</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">2.25</span></span>,<span class="hljs-number"><span class="hljs-number">2570</span></span>,<span class="hljs-number"><span class="hljs-number">7242</span></span>,<span class="hljs-string"><span class="hljs-string">"2"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">2170</span></span>,<span class="hljs-number"><span class="hljs-number">400</span></span>,<span class="hljs-number"><span class="hljs-number">1951</span></span>,<span class="hljs-number"><span class="hljs-number">1991</span></span>,<span class="hljs-string"><span class="hljs-string">"98125"</span></span>,<span class="hljs-number"><span class="hljs-number">47.721</span></span>,<span class="hljs-number"><span class="hljs-number">-122.319</span></span>,<span class="hljs-number"><span class="hljs-number">1690</span></span>,<span class="hljs-number"><span class="hljs-number">7639</span></span> <span class="hljs-string"><span class="hljs-string">"5631500400"</span></span>,<span class="hljs-string"><span class="hljs-string">"20150225T000000"</span></span>,<span class="hljs-number"><span class="hljs-number">180000</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">770</span></span>,<span class="hljs-number"><span class="hljs-number">10000</span></span>,<span class="hljs-string"><span class="hljs-string">"1"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">770</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1933</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-string"><span class="hljs-string">"98028"</span></span>,<span class="hljs-number"><span class="hljs-number">47.7379</span></span>,<span class="hljs-number"><span class="hljs-number">-122.233</span></span>,<span class="hljs-number"><span class="hljs-number">2720</span></span>,<span class="hljs-number"><span class="hljs-number">8062</span></span></code> </pre> <br><p>  Inside the file there is everything you need.  Each row contains a lot of information, and you have to figure out what exactly will help us to predict prices for houses. <br>  We need: </p><br><ol><li>  Choose a model. </li><li>  Understand the data. </li><li>  Prepare data for work. </li><li>  To train a model. </li><li>  Test the model. </li><li>  Visualize the model. </li></ol><br><h3 id="1-vybor-modeli">  1. Model selection </h3><br><p>  Let's use one of the simplest popular models - <a href="https://ru.wikipedia.org/wiki/%25D0%259B%25D0%25B8%25D0%25BD%25D0%25B5%25D0%25B9%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2580%25D0%25B5%25D0%25B3%25D1%2580%25D0%25B5%25D1%2581%25D1%2581%25D0%25B8%25D1%258F">linear regression</a> . </p><br><p>  This model underlies many others, and it‚Äôs good to start a new data analysis with it.  If the resulting model will predict well enough, then you will not have to move to a more complex one. </p><br><p>  Let's take a closer look at linear regression: </p><br><p><img src="https://habrastorage.org/webt/q7/1h/fk/q71hfkorkollozksiulk6ntwxzc.png"></p><br><p>  This graph shows the relationship between the two variables. </p><br><p>  The vertical axis (Y) reflects the dependent variable ‚Äî in our case, house prices.  The horizontal axis (X) reflects the so-called independent variable - in our case it can be any other data from the dataset, for example, <em>bedrooms, bathrooms, sqft_living</em> ... </p><br><p>  Circles in the graph are the <em>y-values</em> for a given <em>x-value</em> (y <strong><em>depends</em></strong> on <em>x</em> ).  Red line - linear regression.  This line goes through all the values ‚Äã‚Äãand can be used to predict the possible values ‚Äã‚Äãof y for a given <em>x</em> . </p><br><p>  Our goal is to train the model to build the red line for our task. </p><br><p>  Recall that a linear function has the form <code>y = ax + b</code> .  We need to find her.  More precisely, we need to find values <code>a</code> and <code>b</code> that best suit our data. </p><br><h3 id="2-razbiraemsya-s-dannymi">  2. We understand the data </h3><br><p>  We know which model we need and which approach we will use.  It remains to analyze the data and understand whether they are suitable for our task. </p><br><p>  Data for the linear regression model should be <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25BE%25D1%2580%25D0%25BC%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">normally distributed</a> .  That is, the data <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D0%25B8%25D1%2581%25D1%2582%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B0">histogram</a> should be in the form of a bell. </p><br><p>  Let's build a graph based on our data and see if they are properly distributed.  For this we finally write the code! </p><br><p>  Useful packages: </p><br><ul><li>  <a href="https://golang.org/pkg/encoding/csv/">The encoding / csv</a> from the standard library will help us load dataset and parse its contents. </li><li>  <a href="https://github.com/gonum/plot">github.com/gonum/plot</a> helps build a graph. </li></ul><br><p>  <a href="">This code</a> opens our CSV and draws histograms for all columns, except for ID and Date.  So we can choose which columns to use to train the model: </p><br><pre> <code class="hljs pgsql"> // we <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> the csv file <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> the disk f, err := os.<span class="hljs-keyword"><span class="hljs-keyword">Open</span></span>("./datasets/kc_house_data.csv") <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } defer f.<span class="hljs-keyword"><span class="hljs-keyword">Close</span></span>() // we <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> a <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> csv reader specifying // the number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> it has salesData := csv.NewReader(f) salesData.FieldsPerRecord = <span class="hljs-number"><span class="hljs-number">21</span></span> // we <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> the records records, err := salesData.ReadAll() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } // <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> slicing the records we skip the <span class="hljs-keyword"><span class="hljs-keyword">header</span></span> records = records[<span class="hljs-number"><span class="hljs-number">1</span></span>:] // we iterate <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> the records // <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> keep track <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> the gathered <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> // <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> columnsValues := map[<span class="hljs-type"><span class="hljs-type">int</span></span>]plotter.<span class="hljs-keyword"><span class="hljs-keyword">Values</span></span>{} <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, <span class="hljs-type"><span class="hljs-type">record</span></span> := range records { // we want one histogram per <span class="hljs-keyword"><span class="hljs-keyword">column</span></span>, // so we will iterate <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> we have // <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> gather the <span class="hljs-type"><span class="hljs-type">date</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a separate <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> // <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> columnsValues // we are skipping the ID <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> the <span class="hljs-type"><span class="hljs-type">Date</span></span>, // so we <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c := <span class="hljs-number"><span class="hljs-number">2</span></span>; c &lt; salesData.FieldsPerRecord; c++ { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> _, <span class="hljs-built_in"><span class="hljs-built_in">found</span></span> := columnsValues[c]; !<span class="hljs-built_in"><span class="hljs-built_in">found</span></span> { columnsValues[c] = make(plotter.<span class="hljs-keyword"><span class="hljs-keyword">Values</span></span>, len(records)) } // we parse <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> <span class="hljs-keyword"><span class="hljs-keyword">close</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> it <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> our <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> floatVal, err := strconv.ParseFloat(<span class="hljs-type"><span class="hljs-type">record</span></span>[c], <span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } columnsValues[c][i] = floatVal } } // once we have <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> the data, we draw <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> graph <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> c, <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> := range columnsValues { // <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> a <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> plot p, err := plot.<span class="hljs-built_in"><span class="hljs-built_in">New</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } p.Title.Text = fmt.Sprintf("Histogram of %s", records[<span class="hljs-number"><span class="hljs-number">0</span></span>][c]) // <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> a <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> normalized histogram // <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> it <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the plot h, err := plotter.NewHist(<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } h.Normalize(<span class="hljs-number"><span class="hljs-number">1</span></span>) p.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(h) // save the plot <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> a PNG file. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := p.Save( <span class="hljs-number"><span class="hljs-number">10</span></span>*vg.Centimeter, <span class="hljs-number"><span class="hljs-number">10</span></span>*vg.Centimeter, fmt.Sprintf("./graphs/%s_hist.png", records[<span class="hljs-number"><span class="hljs-number">0</span></span>][c]), ); err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } }</code> </pre> <br><p>  This code generates a set of graphs.  Of these, you need to choose one that best meets the conditions of a normal distribution (bell-shaped curve). </p><br><p>  Here is the graph I chose ( <a href="https://gitlab.com/devthoughts/code/tree/master/linear-regression-with-go/graphs">all histograms</a> ): </p><br><p><img src="https://habrastorage.org/webt/y4/zz/ep/y4zzep8cpwhlyh1mfczfzft64bw.png"></p><br><p>  This is the graph for the Grade column  It is not perfect in terms of normal distribution, but for now this is enough.  If you look at all the histograms, you will find a few more that can also be used.  If the resulting model is poorly predicted, then we choose another dataset column as a basis. </p><br><p>  If that: Grad is an assessment of the quality level of a building.  You can read more about the quality levels of buildings <a href="http://info.kingcounty.gov/assessor/esales/Glossary.aspx%3Ftype%3Dr">here</a> , in the <code>BUILDING GRADE</code> section. </p><br><h3 id="3-podgotavlivaem-dannye">  3. Prepare the data </h3><br><p>  So, for training the model we will use the downloaded dataset.  But how do you know if our model is accurate enough? </p><br><p>  Let's <strong>test it</strong> , and for this we will use the same dataset.  In order for one dataset to be useful for teaching and testing, we divide it into two parts: one for training, the second for testing.  This is a normal approach. </p><br><p>  We will train on 80% of the data, and take the remaining 20% ‚Äã‚Äãfor the test.  There are other established relationships, but to select the appropriate option, you will most likely have to act by trial and error. </p><br><p>  We need to find a balance between the adequacy of data for correct training and testing, so as not to <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B5%25D1%2580%25D0%25B5%25D0%25BE%25D0%25B1%25D1%2583%25D1%2587%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">retrain the</a> model. </p><br><pre> <code class="hljs markdown"> // we open the csv file from the disk f, err := os.Open("./datasets/kc<span class="hljs-emphasis"><span class="hljs-emphasis">_house_</span></span>data.csv") if err != nil { log.Fatal(err) } defer f.Close() // we create a new csv reader specifying // the number of columns it has salesData := csv.NewReader(f) salesData.FieldsPerRecord = 21 // we read all the records records, err := salesData.ReadAll() if err != nil { log.Fatal(err) } // save the header header := records[<span class="hljs-string"><span class="hljs-string">0</span></span>] // we have to shuffle the dataset before splitting // to avoid having ordered data // if the data is ordered, the data in the train set // and the one in the test set, can have different // behavior shuffled := make([<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>]string, len(records)-1) perm := rand.Perm(len(records) - 1) for i, v := range perm { shuffled[<span class="hljs-string"><span class="hljs-string">v</span></span>] = records[<span class="hljs-string"><span class="hljs-string">i+1</span></span>] } // split the training set trainingIdx := (len(shuffled)) * 4 / 5 trainingSet := shuffled[<span class="hljs-string"><span class="hljs-string">1 : trainingIdx+1</span></span>] // split the testing set testingSet := shuffled[<span class="hljs-string"><span class="hljs-string">trainingIdx+1:</span></span>] // we write the splitted sets in separate files sets := map[<span class="hljs-string"><span class="hljs-string">string</span></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>][<span class="hljs-string"></span><span class="hljs-string"></span>]string{ "./datasets/training.csv": trainingSet, "./datasets/testing.csv": testingSet, } for fn, dataset := range sets { f, err := os.Create(fn) if err != nil { log.Fatal(err) } defer f.Close() out := csv.NewWriter(f) if err := out.Write(header); err != nil { log.Fatal(err) } if err := out.WriteAll(dataset); err != nil { log.Fatal(err) } out.Flush() }</code> </pre> <br><p>  <a href="">The code above</a> generates two files: </p><br><ul><li>  <em>training.csv</em> - contains entries for training the model. </li><li>  <em>testing.csv</em> - contains entries for testing. </li></ul><br><h3 id="4-obuchaem-model">  4. We train model </h3><br><p>  Now we will start learning.  Different packages are suitable for this, we will take <a href="https://github.com/sajari/regression">github.com/sajari/regression</a> , everything necessary is implemented in it. </p><br><p>  Of course, you can write everything from scratch, but for now let's not complicate things. </p><br><p>  First, download the records from <code>training.csv</code> , go through them and put in the model data from the columns <code>Price</code> and <code>Grade</code> . </p><br><p>  Now we will train the model to find our linear function. </p><br><p>  <a href="">This will deal with the code</a> : </p><br><pre> <code class="hljs pgsql"> // we <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> the csv file <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> the disk f, err := os.<span class="hljs-keyword"><span class="hljs-keyword">Open</span></span>("./datasets/training.csv") <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } defer f.<span class="hljs-keyword"><span class="hljs-keyword">Close</span></span>() // we <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> a <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> csv reader specifying // the number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> it has salesData := csv.NewReader(f) salesData.FieldsPerRecord = <span class="hljs-number"><span class="hljs-number">21</span></span> // we <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> the records records, err := salesData.ReadAll() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } // <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> this <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> we are going <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> try <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> model our house price (y) // <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> the grade feature. var r regression.Regression r.SetObserved("Price") r.SetVar(<span class="hljs-number"><span class="hljs-number">0</span></span>, "Grade") // <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> records <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the CSV, adding the training data <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the regression <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, <span class="hljs-type"><span class="hljs-type">record</span></span> := range records { // Skip the <span class="hljs-keyword"><span class="hljs-keyword">header</span></span>. <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i == <span class="hljs-number"><span class="hljs-number">0</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } // Parse the house price, "y". price, err := strconv.ParseFloat(records[i][<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } // Parse the grade <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>. grade, err := strconv.ParseFloat(<span class="hljs-type"><span class="hljs-type">record</span></span>[<span class="hljs-number"><span class="hljs-number">11</span></span>], <span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } // <span class="hljs-keyword"><span class="hljs-keyword">Add</span></span> these points <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the regression <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>. r.Train(regression.DataPoint(price, []float64{grade})) } // Train/fit the regression model. r.Run() // Output the trained model parameters. fmt.Printf("\nRegression Formula:\n%v\n\n", r.Formula)</code> </pre> <br><p>  After completing the execution, we get the formula: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Regression</span></span> Formula: Predicted = -<span class="hljs-number"><span class="hljs-number">1065201</span></span>.<span class="hljs-number"><span class="hljs-number">67</span></span> + Grade*<span class="hljs-number"><span class="hljs-number">209786</span></span>.<span class="hljs-number"><span class="hljs-number">29</span></span></code> </pre> <br><h3 id="5-testiruem-model">  5. Testing the model </h3><br><p>  It is assumed that the generated formula allows you to predict sales prices based on the column Grade. </p><br><p>  Test the formula.  To do this, we take the <code>testing.csv</code> file created earlier. </p><br><p>  Although we have test data, we still need some data on the output, by which we understand how accurate the formula is.  For this we use the value of the <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D1%258D%25D1%2584%25D1%2584%25D0%25B8%25D1%2586%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582_%25D0%25B4%25D0%25B5%25D1%2582%25D0%25B5%25D1%2580%25D0%25BC%25D0%25B8%25D0%25BD%25D0%25B0%25D1%2586%25D0%25B8%25D0%25B8">coefficient of determination</a> . </p><br><p>  The coefficient of determination tells us at what proportion of dependent variables we can predict independent variables.  In our case - how much house prices can be predicted based on data from the Grade column. </p><br><p>  The generated value of the coefficient will be in the range from 0 to 1 (the higher the better). </p><br><p>  <a href="">Here is the code</a> that generates the coefficient of determination: </p><br><pre> <code class="hljs markdown">func main() { // we open the csv file from the disk f, err := os.Open("./datasets/testing.csv") if err != nil { log.Fatal(err) } defer f.Close() // we create a new csv reader specifying // the number of columns it has salesData := csv.NewReader(f) salesData.FieldsPerRecord = 21 // we read all the records records, err := salesData.ReadAll() if err != nil { log.Fatal(err) } // by slicing the records we skip the header records = records[<span class="hljs-string"><span class="hljs-string">1:</span></span>] // Loop over the test data predicting y observed := make([<span class="hljs-string"></span><span class="hljs-string"></span>]float64, len(records)) predicted := make([<span class="hljs-string"></span><span class="hljs-string"></span>]float64, len(records)) var sumObserved float64 for i, record := range records { // Parse the house price, "y". price, err := strconv.ParseFloat(records[<span class="hljs-string"><span class="hljs-string">i</span></span>][<span class="hljs-symbol"><span class="hljs-symbol">2</span></span>], 64) if err != nil { log.Fatal(err) } observed[i] = price sumObserved += price // Parse the grade value. grade, err := strconv.ParseFloat(record[11], 64) if err != nil { log.Fatal(err) } // Predict y with our trained model. predicted[i] = predict(grade) } mean := sumObserved / float64(len(observed)) var observedCoefficient, predictedCoefficient float64 for i := 0; i <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">len</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">observed</span></span></span></span><span class="xml"><span class="hljs-tag">); </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">++ { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">observedCoefficient</span></span></span></span><span class="xml"><span class="hljs-tag"> += </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">math.Pow((observed[i]</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mean</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">predictedCoefficient</span></span></span></span><span class="xml"><span class="hljs-tag"> += </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">math.Pow((predicted[i]</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mean</span></span></span></span><span class="xml"><span class="hljs-tag">), </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span></span><span class="xml"><span class="hljs-tag">) } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rsquared</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:</span></span></span></span><span class="xml"><span class="hljs-tag">= </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">predictedCoefficient</span></span></span></span><span class="xml"><span class="hljs-tag"> / </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">observedCoefficient</span></span></span></span><span class="xml"><span class="hljs-tag"> // </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Output</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">the</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">R-squared</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">to</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">standard</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">out.</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">fmt.Printf</span></span></span></span><span class="xml"><span class="hljs-tag">("</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">R-squared</span></span></span></span><span class="xml"><span class="hljs-tag"> = </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">%0.2f\n\n</span></span></span></span><span class="xml"><span class="hljs-tag">", </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rsquared</span></span></span></span><span class="xml"><span class="hljs-tag">) } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">func</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">predict</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">grade</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">float64</span></span></span></span><span class="xml"><span class="hljs-tag">) </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">float64</span></span></span></span><span class="xml"><span class="hljs-tag"> { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">return</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">-1065201.67</span></span></span></span><span class="xml"><span class="hljs-tag"> + </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">grade</span></span></span></span><span class="xml"><span class="hljs-tag">*</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">209786.29</span></span></span></span><span class="xml"><span class="hljs-tag"> }</span></span></span></span></code> </pre> <br><p>  Please note that the <code>predict</code> function is a linear equation that we generated using a test dataset. </p><br><p>  Here's what we got: </p><br><pre> <code class="hljs">R-squared = 0.46</code> </pre> <br><p>  Not ideal. </p><br><p>  Let's try to visualize our regression and try to improve it. </p><br><h3 id="6-vizualiziruem-model">  6. Visualize the model. </h3><br><p>  For visualization, we will write some more <a href="">code</a> : </p><br><pre> <code class="hljs pgsql"> // we <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> the csv file <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> the disk f, err := os.<span class="hljs-keyword"><span class="hljs-keyword">Open</span></span>("kc_house_data.csv") <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } defer f.<span class="hljs-keyword"><span class="hljs-keyword">Close</span></span>() df := dataframe.ReadCSV(f) // pts will hold the <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> plotting. pts := make(plotter.XYs, df.Nrow()) // ptsPred will hold the predicted <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> plotting. ptsPred := make(plotter.XYs, df.Nrow()) yVals := df.Col("price").Float() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, floatVal := range df.Col("grade").Float() { pts[i].X = floatVal pts[i].Y = yVals[i] ptsPred[i].X = floatVal ptsPred[i].Y = predict(floatVal) } // <span class="hljs-keyword"><span class="hljs-keyword">Create</span></span> the plot. p, err := plot.<span class="hljs-built_in"><span class="hljs-built_in">New</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } pXLabel.Text = "grade" pYLabel.Text = "house price" p.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(plotter.NewGrid()) // <span class="hljs-keyword"><span class="hljs-keyword">Add</span></span> the scatter plot points <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the observations. s, err := plotter.NewScatter(pts) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } s.GlyphStyle.Radius = vg.Points(<span class="hljs-number"><span class="hljs-number">2</span></span>) s.GlyphStyle.Color = color.RGBA{R: <span class="hljs-number"><span class="hljs-number">0</span></span>, G: <span class="hljs-number"><span class="hljs-number">0</span></span>, B: <span class="hljs-number"><span class="hljs-number">255</span></span>, A: <span class="hljs-number"><span class="hljs-number">255</span></span>} // <span class="hljs-keyword"><span class="hljs-keyword">Add</span></span> the <span class="hljs-type"><span class="hljs-type">line</span></span> plot points <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the predictions. l, err := plotter.NewLine(ptsPred) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) } l.LineStyle.Width = vg.Points(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) l.LineStyle.Dashes = []vg.Length{vg.Points(<span class="hljs-number"><span class="hljs-number">2</span></span>), vg.Points(<span class="hljs-number"><span class="hljs-number">2</span></span>)} l.LineStyle.Color = color.RGBA{R: <span class="hljs-number"><span class="hljs-number">255</span></span>, G: <span class="hljs-number"><span class="hljs-number">0</span></span>, B: <span class="hljs-number"><span class="hljs-number">0</span></span>, A: <span class="hljs-number"><span class="hljs-number">255</span></span>} // Save the plot <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> a PNG file. p.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(s, l) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := p.Save(<span class="hljs-number"><span class="hljs-number">10</span></span>*vg.Centimeter, <span class="hljs-number"><span class="hljs-number">10</span></span>*vg.Centimeter, "./graphs/first_regression.png"); err != nil { <span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.Fatal(err) }</code> </pre> <br><p>  Finally, we got our first linear regression: </p><br><p><img src="https://habrastorage.org/webt/uu/vf/h1/uuvfh1okbakrbo_1ztb06hmvsgm.png"></p><br><p>  If you look closely, it will become clear that the blue circles best fit on a curved line, rather than a straight line. </p><br><p>  To improve the result, you can try to replace the current linear parabolic formula: <code>y = ax + bx^2 + c</code> . </p><br><p>  And again, use the Grade column to represent the <em>x-variable</em> , and the new formula will look like this: </p><br><pre> <code class="hljs swift">price = a * grade + b * grade^<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">c</span></span></code> </pre> <br><p>  <a href="">Update the code of the</a> training function: </p><br><pre> <code class="hljs objectivec"> <span class="hljs-comment"><span class="hljs-comment">// ... everything is the same up to here r.SetVar(1, "Grade2") // now we add one more variable, Grade^2 // ... everything is the same also here // except we are now addin the new variable r.Train(regression.DataPoint(price, []float64{grade, math.Pow(grade, 2)})) // ...</span></span></code> </pre> <br><p>  Get a new formula: </p><br><pre> <code class="hljs markdown">Regression Formula: Predicted = 1639674.31 + Grade<span class="hljs-emphasis"><span class="hljs-emphasis">*-473161.41 + Grade2*</span></span>42070.46</code> </pre> <br><p>  Now you can <a href="">again calculate the coefficient of determination</a> : </p><br><pre> <code class="hljs">R-squared = 0.52</code> </pre> <br><p>  It got better!  Remember, you need to get the value as close as possible to 1. </p><br><p>  Now <a href="">update the</a> chart drawing <a href="">code</a> : </p><br><pre> <code class="hljs lua"> // ... we <span class="hljs-built_in"><span class="hljs-built_in">open</span></span> the file etc // pts will hold the values <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> plotting. pts := make(plotter.XYs, df.Nrow()) yVals := df.Col(<span class="hljs-string"><span class="hljs-string">"price"</span></span>).Float() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, floatVal := range df.Col(<span class="hljs-string"><span class="hljs-string">"grade"</span></span>).Float() { pts[i].X = floatVal pts[i].Y = yVals[i] } // Create the plot. p, err := plot.New() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.Fatal(err) } pXLabel.Text = <span class="hljs-string"><span class="hljs-string">"grade"</span></span> pYLabel.Text = <span class="hljs-string"><span class="hljs-string">"house price"</span></span> p.Add(plotter.NewGrid()) // Add the scatter plot points <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the observations. s, err := plotter.NewScatter(pts) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.Fatal(err) } s.GlyphStyle.Radius = vg.Points(<span class="hljs-number"><span class="hljs-number">2</span></span>) s.GlyphStyle.Color = color.RGBA{R: <span class="hljs-number"><span class="hljs-number">0</span></span>, G: <span class="hljs-number"><span class="hljs-number">0</span></span>, B: <span class="hljs-number"><span class="hljs-number">255</span></span>, A: <span class="hljs-number"><span class="hljs-number">255</span></span>} curve := plotter.NewFunction(predict) curve.LineStyle.Width = vg.Points(<span class="hljs-number"><span class="hljs-number">3</span></span>) curve.LineStyle.Dashes = []vg.Length{vg.Points(<span class="hljs-number"><span class="hljs-number">3</span></span>), vg.Points(<span class="hljs-number"><span class="hljs-number">3</span></span>)} curve.LineStyle.Color = color.RGBA{R: <span class="hljs-number"><span class="hljs-number">255</span></span>, G: <span class="hljs-number"><span class="hljs-number">0</span></span>, B: <span class="hljs-number"><span class="hljs-number">0</span></span>, A: <span class="hljs-number"><span class="hljs-number">255</span></span>} // Save the plot to a PNG file. p.Add(s, curve) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> err := p.Save(<span class="hljs-number"><span class="hljs-number">10</span></span>*vg.Centimeter, <span class="hljs-number"><span class="hljs-number">10</span></span>*vg.Centimeter, <span class="hljs-string"><span class="hljs-string">"./graphs/second_regression.png"</span></span>); err != <span class="hljs-literal"><span class="hljs-literal">nil</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>.Fatal(err) }</code> </pre> <br><p>  Updated schedule: </p><br><p><img src="https://habrastorage.org/webt/mq/rm/uk/mqrmukkl80ibc0jwh_rgflena3o.png"></p><br><p>  It turned out better. </p><br><p>  You can make a number of improvements to get the value of the coefficient of determination closer to 1, if you want - experiment.  You can also try to improve the model by changing or combining different variables. </p><br><p>  Let's say we are satisfied with the prediction formula, let's start using it.  Let's say we want to find out how much money you can earn on selling a house in the <strong>Grade 3</strong> category in King County.  Insert the Grade value into the formula and get the price: </p><br><pre> <code class="hljs css">598824<span class="hljs-selector-class"><span class="hljs-selector-class">.2200000001</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">USD</span></span></code> </pre> <br><p>  I hope you found this introduction to using the linear regression model and Go packages helpful, and you can now begin to learn machine learning. </p><br><p>  All code from the article is in the <a href="https://gitlab.com/devthoughts/code/tree/master/linear-regression-with-go">repository</a> . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/345484/">https://habr.com/ru/post/345484/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345474/index.html">Security in modern corporations</a></li>
<li><a href="../345476/index.html">Configuring VPN (PPTP) in Ubuntu 17.10 with authorization by JaCarta smart card</a></li>
<li><a href="../345478/index.html">All professions are important: why should a tester be valued as much as a programmer?</a></li>
<li><a href="../345480/index.html">How to save on spot EC2 instances with Scylla</a></li>
<li><a href="../345482/index.html">Key-value for storing metadata in storage. We test the selected databases</a></li>
<li><a href="../345486/index.html">20 hits of world cinema that translated from English otherwise</a></li>
<li><a href="../345488/index.html">What is the difference between React and Vue?</a></li>
<li><a href="../345490/index.html">We are launching a new online course ‚ÄúWeb Services Development on Go‚Äù</a></li>
<li><a href="../345492/index.html">Non convolutional networks</a></li>
<li><a href="../345494/index.html">xss vulnerability</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>