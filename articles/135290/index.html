<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Handling errors and crashes proprietary programs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you were engaged in batch processing in Adobe Photoshop using the Automate - Batch tool (batch processing of a very large number of graphic files w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Handling errors and crashes proprietary programs</h1><div class="post__text post__text-html js-mediator-article"> If you were engaged in batch processing in Adobe Photoshop using the Automate - Batch tool (batch processing of a very large number of graphic files with filters applied from the program in automatic mode), you probably encountered this type of program departures, for reasons which are not clear to me: <br><br><img src="https://habrastorage.org/storage2/254/e04/b52/254e04b5273613e4c8db131d10ee4583.png"><br><img src="https://habrastorage.org/storage2/0b1/1f7/30e/0b11f730ebef79bb4e921b337cc146b4.png"><br><img src="https://habrastorage.org/storage2/7e2/db4/ac5/7e2db4ac555792b73c61490b98714cf2.png"><br><br>  Of course, you can wait for the appearance of these errors, which can occur after an hour of processing or after a few hours, you can start an alarm clock to wake up at night <s>(like a robot)</s> and watch: ‚ÄúDidn't Photoshop fly out‚Äù with an error?  Then <s>nervously</s> re-run the processing, sorting the already processed files into another folder. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In short, here's the problem!  (Similarly, you can handle errors from other software).  Decision? <br><a name="habracut"></a><br><br><img src="https://habrastorage.org/storage2/f54/11b/ad5/f5411bad5a3379dae4146bd22e594199.png"><br><img src="https://habrastorage.org/storage2/57e/c1c/056/57ec1c056700fcb0c290d949e3c32ce4.png"><br><img src="https://habrastorage.org/storage2/eca/7e1/d75/eca7e1d75bdaee17814e7850c0676603.png"><br><br>  How did these errors occur? <br><img src="https://habrastorage.org/storage2/f5f/133/a61/f5f133a619e367a56e6c61934f96f6c8.png"><br>  I decided to process the video using Photoshop filters.  I imported Mov into VirtualDub using plugins.  Made a storyboard File - Export - Image Sequence, ordered the file name, file type, number of digits, folder.  Exported mov to a huge amount of bmp files and started batch processing in Photoshop.  The result of the processing was then planned to export via VirtualDub into the finished avi file, also using the Deshaker filter, which will eliminate camera shake.  But here Photoshop crashes started, for example, when simply saving a png error to the file ‚ÄúBecause the file-format module cannot parse the file‚Äù (does the photoshop error that it cannot parse in the file-format module?) <br><br>  We will handle Photoshop errors using the <a href="http://www.autoitscript.com/">AutoIt</a> scripting language.  To do this, we need to stock up on <s>coffee with</s> patience: expect errors, describe the response to them, test, assemble a ready-made solution in the form of an exe file with ready-made and automated computer actions. <br><br>  Error windows will be explored using an AutoIt tool called AutoIt Windows Info.  Surprisingly, Adobe Photoshop windows do not use standard windows Api windows, but the program sees error messages without problems: <br><br><img src="https://habrastorage.org/storage2/b70/8f8/db7/b708f8db74b38ddc41730c191877665d.png"><br><br> <code>if WinExists("Adobe Photoshop CS3 Extended","OK") then <br> WinWait("Adobe Photoshop CS3 Extended","OK") <br> ;  30      OK     <br> sleep(3000) <br> WinActivate("Adobe Photoshop CS3 Extended","OK") <br> sleep(3000) <br> ;ControlClick("Adobe Photoshop CS3 Extended","OK","[CLASS:Static; INSTANCE:2]") <br> ;WinClose("Adobe Photoshop CS3 Extended","OK") <br> sleep(3000) <br> ;msgbox(1,"1","1") <br> ;  ,    <br> ;     ,   Adobe Photoshop <br> ProcessClose("Photoshop.exe") <br> endif</code> <br> <br>  Similarly, you can close the error with the text Microsoft Visual C ++ Runtime Library: <br><br> <code>if WinExists("Microsoft Visual C++ Runtime Library","") Then <br> winwait("Microsoft Visual C++ Runtime Library","") <br> WinActivate("Microsoft Visual C++ Runtime Library","") <br> winclose("Microsoft Visual C++ Runtime Library","") <br> ;msgbox(0,"First","1") <br> EndIf <br> <br> sleep(10000) <br> <br> if WinExists("Photoshop.exe - Application Error","OK") Then <br> winwait("Photoshop.exe - Application Error","OK") <br> WinActivate("Photoshop.exe - Application Error","OK") <br> controlclick("Photoshop.exe - Application Error","OK","[CLASS:Button; INSTANCE:1]") <br> EndIf <br> <br> sleep(10000) <br> <br> if WinExists("Photoshop.exe - Application Error","OK") Then <br> WinActivate("Photoshop.exe - Application Error","OK") <br> winwait("Photoshop.exe - Application Error","OK") <br> controlclick("Photoshop.exe - Application Error","OK","[CLASS:Button; INSTANCE:1]") <br> EndIf <br> <br> sleep(10000) <br></code> <br><br>  Errors are processed, the program closes.  You must start it again.  Hot keys for launching batch processing AdobePhotoshop in the English version Alt + f (File) - u (aUtomate) - Alt + a (Action) - to select our profile for processing - we will use the down arrow keys ("on the keyboard" - via the script, respectively ), or if you do not want to use hot keys - using the keyboard up-up, enter, etc ... <br><br><img src="https://habrastorage.org/storage2/b53/753/0b0/b537530b0206242e61a9a42d52f6bff6.png"><br><br> <code>ShellExecute("C:\Program Files\Adobe\Adobe Photoshop CS3\Photoshop.exe","","C:\Program Files\Adobe\Adobe Photoshop CS3\") <br> sleep(30000) <br> ; ,         ! <br> IF WinExists("Adobe Photoshop CS3 Extended","") Then <br> WinActivate("Adobe Photoshop CS3 Extended","") <br> Send("!f") <br> ;File <br> sleep(5000) <br> Send("u") <br> ;aUtomate <br> sleep(5000) <br> Send("b") <br> ;Batch <br> sleep(5000) <br> ;  -       <br> ;send("{UP}") <br> ;sleep(10000) <br> ;send("{UP}") <br> ;sleep(10000) <br> ;send("{UP}") <br> ;sleep(10000) <br> ;send("{UP}") <br> ;sleep(1000) <br> ;send("{UP}") <br> ;sleep(10000) <br> ;send("{UP}") <br> ;sleep(10000) <br> ;send("{UP}") <br> ;sleep(10000) <br> ;send("{ENTER}") <br> ;sleep(10000) <br> ;send("{ENTER}") <br> ;sleep(10000) <br> ;Set -  -     .       ,   __ 2        <br> send("!t") <br> sleep(10000) <br> send("{DOWN}") <br> sleep(10000) <br> send("{DOWN}") <br> sleep(10000) <br> send("{ENTER}") <br> EndIf <br></code> <br><br>  What have we taught the computer?  Close errors that occur, run Photoshop processing.  But on closer examination, the computer starts processing in the same folder and does not understand whether the file is processed or not, the ‚Äúsecondary‚Äù processing of the files that have been previously processed occurs, and then it goes to the files that need to be processed.  What to do? <br><br>  We will save the processed files to another format, for example png (a raster format for storing graphic information using lossless compression using the Deflate algorithm).  By the names of the saved * .png files we will delete our original * .jpeg or * .bmp files.  After reviewing the documentation and examples of AutoIt, the following script turned out (looking for * .png files - by their names erases the source * .bmp files) .: <br><br> <code>#include &lt;file.au3&gt; <br> #include &lt;array.au3&gt; <br> <br> Dim $szDrive, $szDir, $szFName, $szExt <br> <br> sleep(10000) <br> <br> $flagvixod = 0 <br> <br> ; Shows the filenames of all files in the current directory. <br> $search = FileFindFirstFile("*.png") <br> <br> ; Check if the search was successful <br> If $search = -1 Then <br> MsgBox(0, "Error", "No files/directories matched the search pattern") <br> ;    - ..     png <br> Exit <br> EndIf <br> <br> While 1 <br> $file = FileFindNextFile($search) <br> If @error Then ExitLoop <br> <br> $TestPath = _PathSplit(@ScriptDir &amp; "\" &amp; $file, $szDrive, $szDir, $szFName, $szExt) <br> ;3 = name , 4 = extension <br> ;   png     bmp  ! <br> DelMyFile($TestPath[3] &amp; ".bmp") <br> <br> WEnd <br> <br> Func DelMyFile($value) <br> ;msgbox (0,"0",$value) <br> ;return $value <br> If FileExists($value) Then <br> filedelete($value) <br> Else <br> Return $value <br> endif <br> EndFunc <br> <br></code> <br>  Do not forget to add the action File - Save As ... to save the file on saving the png. <br><br>  It remains to collect all this into a single file, "loop processing" to search for errors.  Or add a task to the windows task scheduler (Scheduled Task), which will automatically once every few minutes, <s>check</s> for an error on the computer screen and make decisions for us to close them, close the program, delete the original unprocessed files (according to the list of saved and already processed) files. ), restart Photoshop for processing.  The pauses in the script for 10-30 seconds are added for reliability, because  sometimes after the occurrence of errors, the computer is not quite correctly and quickly responds to keystrokes. </div><p>Source: <a href="https://habr.com/ru/post/135290/">https://habr.com/ru/post/135290/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../135284/index.html">ActionScript as a language for developing JS applications with jQuery and debager</a></li>
<li><a href="../135286/index.html">Microsoft Lync goes to mobile platforms, client review, server setup</a></li>
<li><a href="../135287/index.html">Algorithm winner AI Challenge 2011 (Ants)</a></li>
<li><a href="../135288/index.html">ICQ office</a></li>
<li><a href="../135289/index.html">Qt Creator Extension System</a></li>
<li><a href="../135291/index.html">Centralized backup of Windows and * nix servers using Bacula</a></li>
<li><a href="../135292/index.html">How to develop a personal business automation system for 1 day</a></li>
<li><a href="../135293/index.html">Students from the University of Amsterdam (VU) play Tetris with an optical tweaser</a></li>
<li><a href="../135295/index.html">Member of the project Kickstarter is going to release triangular tablets</a></li>
<li><a href="../135297/index.html">Changes in the Criminal Code, which may affect many</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>