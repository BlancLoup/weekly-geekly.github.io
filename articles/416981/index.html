<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How eight people scale a highload project. Unsplash experience</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Photo: Alex Smith | Unsplash 

 Good day! 

 My name is Victor Pryazhnikov, I work in the Features section of Badoo . The main task of our department ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How eight people scale a highload project. Unsplash experience</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/b3/pz/ic/b3pzichu4xzzncl5rp8dkbiypwo.jpeg" height="500"></div><br>  <i>Photo: <a href="https://unsplash.com/photos/sRTLpqB5haw%3Futm_source%3Dunsplash%26utm_medium%3Dreferral%26utm_content%3DcreditCopyText">Alex Smith</a> |</i>  <i><a href="https://unsplash.com/%3Futm_source%3Dunsplash%26utm_medium%3Dreferral%26utm_content%3DcreditCopyText">Unsplash</a></i> <br><br>  <i>Good day!</i> <i><br><br></i>  <i>My name is Victor Pryazhnikov, I work in the Features section of <a href="https://tech.badoo.com/ru/">Badoo</a> .</i>  <i>The main task of our department is to develop the functionality that users of our site and applications see.</i>  <i>When I caught sight of an article by Unsplash co-founder Luke Chesser, she intrigued me by the fact that they manage to develop a relatively large project with a very small team.</i>  <i>The author‚Äôs approach appeals to me with his pragmatism and with something reminded ‚Äú <a href="https://habr.com/company/infopulse/blog/330708/">You are not Google</a> ‚Äù, so I decided to translate it.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      One of the funniest things about developing Unsplash is the large scale and popularity of the product. <br><br>  On a typical day, our API processes more than <b>10 million requests</b> from <a href="https://unsplash.com/">unsplash.com</a> and thousands of third-party applications, <b>millions of events</b> go through our pipeline data processing, <b>60 million updates</b> are added to our feeds, and we serve <b>60 million images.</b> <br><br>  At the same time, our team is relatively small: two designers, three people working with the front-end, two with a backend, and one data engineer.  We do not have a separate DevOps engineer, and each team member spends most of his time experimenting and developing new features to ensure further product development. <br><a name="habracut"></a><br>  Although we have already achieved a lot with Unsplash, we are still at the very beginning of its path as a product and a business.  We still have something to prove, and this means that the whole team needs to focus on solving problems that are unique to Unsplash, and not those of any other company, such as organization of calculations, network security, infrastructure building, management dependencies, etc. <br><br>  Over the past three years, we have developed a set of principles that allow us to focus on growth and avoid scaling problems.  Unfortunately for those who are looking for a silver bullet, it will not be here: it is just common sense and a set of principles that we borrowed from others. <br><br><h2>  1. Use boring obvious solutions. </h2><br>  Or be pragmatic. <br><br>  Before embarking on a new tool, a database (RethinkDB, RocksDB, etc.), a new pattern (‚Äúfunctional all!‚Äù) Or a new architecture (‚Äúmicroservices, help!‚Äù), Try all the obvious options. <br><br>  On the backend side, there are quite a few problems that cannot be solved quite effectively using standard, well-known tools and proven patterns like caching, batch processing, asynchronous processing, and preliminary preparation of the necessary data. <br><br><h2>  2. Focus on solving user problems, not technology. </h2><br>  Unsplash is a grocery, not a technology company.  We received a lot of money from investors to focus on solving the problems of our product and the market, rather than trying to achieve a three percent reduction in operating costs for the use of common technologies. <br>  We spend our time on the use of ready-made technologies in a way that will help solve the problems of our users and increase the Unsplash community.  These are tasks unique to Unsplash, and if we succeed in creating something new and valuable, we can postpone optimization to a later date, when these 3% optimization can become the main source of growth. <br><br>  Our potential colleagues who have heard about the scale of Unsplash and a small team, the use of images and artificial intelligence, future features, can be confused by the fact that we use a lot of out-of-the-box technologies, services and frameworks.  It makes us pay a little more right now, but it allows us to postpone the internal development of these technologies for a while and place it on the shoulders of our future colleagues. <br><br>  The code layout process, server configuration, system dependencies, data processing and analysis, image processing and personalization are examples of areas that we chose <b>not to</b> focus our engineering resources on them, but use ready-made third-party services for each of them instead. <br><br><h2>  3. Spend money on solving technological problems. </h2><br>  The reverse side of the focus on product problems lies in the additional costs of access to ready-made technologies and third-party services. <br><br>  It became a bit of a joke inside our team.  They say that my first reaction to any problem will be the question: ‚ÄúHave you tried to solve it with money?‚Äù.  But this is not a joke, but one of my favorite approaches to solving problems. <br><br>  Optimizing infrastructure and technology costs is such a common problem with simple and repetitive solutions that no single product company with investors should take care of it until it feels that the growth of the main metric is no longer its priority. <br><br>  When we spend money on solving technological problems, we untie the hands of the team, allowing it to focus on non-recurring complex problems like finding a way to increase the size of the user base by 40% in the current quarter. <br><hr><br>  So these are three fairly simple but abstract principles that we follow. <br><br>  But how do they look in practice? <br><br>  If you look at the Unsplash architecture, you will see that it is very simple and almost boring (at least according to 2017 standards). <br><br> <a href=""><img src="https://habrastorage.org/webt/uo/5o/3g/uo5o3glpuuetrd8lriothnscgtq.png"></a> <br>  <i>Simplified diagram of the main parts of which Unsplash consists</i> <br><br>  We use <a href="https://heroku.com/">Heroku</a> wherever possible in order to simplify the layout, configuration, testing, support and scaling of our core applications.  Heroku is some kind of magic that separates the parts of the application and the development process so that our team members do not need to be familiar with it in order to develop and share experiments. <br><br>  We aggressively minimize the amount of code that we write for the business logic of the application (the purple areas in the picture).  When writing it, we actively use frameworks created by other people who, being experts in their fields, have developed solutions that successfully work in 95% of our usage scenarios. <br><br>  We are actively using in production Redis, Elasticsearch and Postgres.  In the past, we tried other databases, but always returned to these three, because we are sure that we understand how they behave under load. <br><br>  We also actively use task queues, asynchronously processing many operations, such as updating, aggregating and synchronizing data between different sources. <br><br>  For data processing, we use <a href="http://snowplowanalytics.com/">Snowplow</a> , an open integrated framework written in Scala, which saves our team from having to think about the organization of entry and exit, and not about the processing itself. <br><br>  We also use a whole set of cloud services for monitoring, such as <a href="https://datadoghq.com/">Datadog</a> , <a href="https://newrelic.com/">New Relic</a> , <a href="https://sentry.io/">Sentry</a> and <a href="https://logentries.com/">Logentries</a> , instead of deploying and maintaining our own StatsD or ELK stack. <br><br>  We transferred the hosting and infrastructure for the return of our images to outsource to <a href="https://imgix.com/">imgix</a> , a leading company working with dynamic images.  If they add some kind of new functionality, then our team makes one change to the URL - and our users also get access to this functionality. <br><br>  We record all the actions of our users in the <a href="https://getstream.io/">Stream</a> service, using their experience in building and optimizing high-loaded personal tapes.  Stream makes it easier for us to process billions of actions and provides a simple API for entering and exiting that works with such performance that our team would have spent months or even years to create. <br><br>  We do not train image recognition algorithms ourselves, but instead use <a href="https://www.tineye.com/">TinEye</a> for reverse image search and <a href="https://cloud.google.com/vision/">Google Vision</a> to recognize and classify images. <br><br>  We record all the behavioral events in <a href="https://getvero.com/">Vero</a> , a platform for working with notifications and mailings, which allows you to transfer the work with them into the hands of our non-developer colleagues.  They themselves can create letters with a high level of personalization based on the complex use of existing data on user behavior. <br><hr><br><br>  At the same time, we focus on those parts of Unsplash that can provide an improvement in our core competencies. <br><br>  Over the past year, we have <a href="https://medium.com/unsplash-unfiltered/product-update-single-page-app-mobile-navigation-more-d991c8eb8adf">divided our single application, written in Ruby on Rails</a> , into the Rails API, the web application on Node.js + React, and created a separate data application that collects and processes all of our internal and product metrics. <br><br>  This allowed our team to create functionality that seemed almost impossible on our old stack consisting only of Rails.  Dividing the problems and technologies of our applications, our team also had the opportunity to use the best tools in each of the areas: <br><br><ul><li>  On the front end, we use React and Webpack along with a small server on Express to support server rendering and proxying API requests.  We deliberately did not tie the tools of our front end team to the backend by temporary hacks like <a href="https://github.com/reactjs/react-rails">react-rails</a> or <a href="https://github.com/rails/webpacker">webpacker</a> .  The JavaScript community, without a doubt, releases the best tools for working with the front-end, so working directly with JavaScript allows our team to quickly deliver high-quality functionality to users. <br></li><li>  On the backend, our team continues to use the best framework for developing simple web applications: Rails.  The Ruby on Rails ecosystem provides the best tools for backend functionality, and since this framework is widely used, any problem with it has already been found, documented, and with a high degree of probability there is already a solution for it. <br></li><li>  On the data side, our team uses a small server on Express to collect and organize data processing.  The processing itself takes place in Snowplow, which works in an AWS cluster, where there are ready-made images for it that simplify configuration and deployment.  This allows our only data engineer, <a href="https://twitter.com/TimmyCarbone">Tim, to</a> spend most of his time transferring data to Snowplow and getting results from there in a way that makes it easy for the rest of the team to understand and get insights. <br></li></ul><br>  We are actively <a href="https://twitter.com/lukechesser/status/835548678836338689">engaged in writing tests</a> , measuring performance using tools such as <a href="https://github.com/github/scientist">Scientist</a> and Datadog, unfolding changes in the form of experiments and <a href="https://twitter.com/lukechesser/status/823307862600515585">automating the work with our infrastructure</a> as much as possible. <br><br>  We are developing a <a href="https://twitter.com/lukechesser/status/846935855285489664">new internal API based on GraphQL</a> to speed up independent iterations of experiments, new features and products, since we realized that our REST-based API breaks down without a high level of coordination between data, design, frontend and backend teams - better we will spend this time on features, not JSON changes. <br><br>  Although it is interesting to work on these changes, we do them not because we want to satisfy our programmer's itch, but because it solves our real problems that prevent us from quickly delivering functionality to users and developing. <br><br>  I think that most people who have read this far have one of three conclusions in their head: <br><br><ol><li> Unsplash is very simple, so <i>you</i> can use this approach.  What I do is much more complicated, so <i>we have</i> to do everything differently. <br></li><li>  I am a developer.  It sounds very boring - I want to create a new system of recognition of images with high loads! <br></li><li>  Cool!  I don't care, just give me <a href="https://unsplash.com/new">beautiful free photos</a> that I can use. <br></li></ol><br><br>  People with conclusion No. 1, you are right: there are companies that do much more complicated things than we do.  But they are not so many.  We all create the same systems, but focused on a few other things, and this is the reason why the solutions used can be abstracted as frameworks and reused in different projects (therefore most hiring posts are so similar to each other). <br><br>  People with conclusion number 2, it depends on what you find interesting.  If you want to push the boundaries of technology, then go to work for a company whose mission is to do it.  There are not many of them, but most other companies simply do not do this. <br><br>  To people with conclusion No. 3, I will say: ‚ÄúYes, quite right!‚Äù In the end, this is what we are doing all this for. <br><br><blockquote>  We are close to the principles in Badoo, about which the author tells.  The main difference is that our project is much larger and using external services for us is often very expensive.  At the same time, many of our solutions are very simple and we try to carefully approach their changes by comparing the cost of introducing and operating a new technology with the benefits we get from it.  Some of our solutions are rather old-fashioned, since they were created quite a long time ago, but switching to similar new ones just for the sake of fashion will not pay for the resources spent on it.  At the same time, we are ready to introduce new technologies if we understand that they can bring real benefits (for example, <a href="https://habr.com/company/badoo/blog/279047/">PHP 7</a> , <a href="https://www.youtube.com/watch%3Fv%3DuO268voCGwA">Go</a> , <a href="https://habr.com/company/badoo/blog/324510/">Cassandra</a> , <a href="https://tech.badoo.com/ru/presentation/67/tarantool-v-badoo-xranenie-istorii/">Tarantool</a> , <a href="https://habr.com/company/badoo/blog/271753/">Exasol</a> ). </blockquote></div><p>Source: <a href="https://habr.com/ru/post/416981/">https://habr.com/ru/post/416981/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../411151/index.html">iMX6ULL. Transition to processor modules</a></li>
<li><a href="../411153/index.html">Nine circles of bureaucracy: how the airport in Denver is trying to get a license to the spaceport</a></li>
<li><a href="../416969/index.html">Pythagorean mathematical substantiation of the musical scale</a></li>
<li><a href="../416977/index.html">Smart Home Software # 2</a></li>
<li><a href="../416979/index.html">Scrum to big teams: LeSS Day 2018</a></li>
<li><a href="../416983/index.html">Creating a cartoon water shader for the web. Part 2</a></li>
<li><a href="../416985/index.html">Up to a hundredth: top 10 reports SmartData 2017</a></li>
<li><a href="../416987/index.html">Gartner: Highlights on the IaaS Market in 2018</a></li>
<li><a href="../416989/index.html">Festo bionic robots: spiders and octopuses in the factories of the future?</a></li>
<li><a href="../416991/index.html">Recording video from your screen is not so secret. Burger King and Appsee Versions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>