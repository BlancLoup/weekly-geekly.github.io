<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>When to make a PDF document</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you are faced with the task of creating unpretentious (or not quite) pdf documents in your application - these may be reports and recipes, well, or...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>When to make a PDF document</h1><div class="post__text post__text-html js-mediator-article">  If you are faced with the task of creating unpretentious (or not quite) pdf documents in your application - these may be reports and recipes, well, or you will want to print information about your objects in this way, then you can use, for example, the installed OpenOffice and its capabilities (it's <a href="http://sourceforge.net/projects/itextsharp/">hard</a> ), and you can use the <a href="http://sourceforge.net/projects/itextsharp/">iTextSharp</a> library (Free C # -PDF library), that's what I want to give you a small example, with which I will create such a document: <br> <a href="http://pics.livejournal.com/outcoldman/pic/0000efqe/"><img width="320" height="227" src="https://habrastorage.org/getpro/geektimes/post_images/eb1/64d/60e/eb164d60ee9a858b2926a803bc6c818f.jpg"></a> <br><a name="habracut"></a><br>  There are many ways to create pdf documents using this library.  I liked the way I described it most with the <a href="http://itextsharp.sourceforge.net/tutorial/ch07.html">xml document</a> .  I decided to create such xml with xslt conversion, and send the data with an xml document. <br><br>  Our data will look like this: <br><blockquote><code><font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Profile</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">FirstName</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">FirstName</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">SecondName</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">SecondName</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">LastName</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">LastName</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Subtexts</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font>    .    .    .    .    .    .    .    . <font color="#0000ff">&lt;/</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Subtexts</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Subtexts</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font>   .   .   .   .   .   .   .   .   . <font color="#0000ff">&lt;/</font> <font color="#800000">Text</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Subtexts</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Profile</font> <font color="#0000ff">&gt;</font></font></code> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  Next, we need to create xml for pdf (I will say that the link to iText.dtd scheme in the tutorial document is broken, I provide the correct link below), as I said above for this, we will write the <a href="http://www.w3.org/TR/xslt">xslt conversion</a> : <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:stylesheet</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">xmlns:xsl</font> <font color="#0000ff">="http://www.w3.org/1999/XSL/Transform"</font> <br> <font color="#ff0000">xmlns:msxsl</font> <font color="#0000ff">="urn:schemas-microsoft-com:xslt"</font> <font color="#ff0000">exclude-result-prefixes</font> <font color="#0000ff">="msxsl"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:param</font> <font color="#ff0000">name</font> <font color="#0000ff">="picturePath"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:output</font> <font color="#ff0000">method</font> <font color="#0000ff">="xml"</font> <font color="#ff0000">indent</font> <font color="#0000ff">="yes"</font> <font color="#0000ff">/&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="/Profile"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">itext</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">paragraph</font> <font color="#ff0000">align</font> <font color="#0000ff">="Center"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">phrase</font> <font color="#ff0000">fontstyle</font> <font color="#0000ff">="bold"</font> <font color="#ff0000">size</font> <font color="#0000ff">="16.0"</font> <font color="#0000ff">&gt;</font>    <font color="#0000ff">&lt;/</font> <font color="#800000">phrase</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">paragraph</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">image</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:attribute</font> <font color="#ff0000">name</font> <font color="#0000ff">="url"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:value-of</font> <font color="#ff0000">select</font> <font color="#0000ff">="$picturePath"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:attribute</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">image</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">table</font> <font color="#ff0000">width</font> <font color="#0000ff">="100%"</font> <font color="#ff0000">columns</font> <font color="#0000ff">="3"</font> <font color="#ff0000">cellpadding</font> <font color="#0000ff">="1"</font> <font color="#ff0000">cellspacing</font> <font color="#0000ff">="1"</font> <font color="#ff0000">borderwidth</font> <font color="#0000ff">="0.5"</font> <font color="#ff0000">red</font> <font color="#0000ff">="0"</font> <br> <font color="#ff0000">green</font> <font color="#0000ff">="0"</font> <font color="#ff0000">blue</font> <font color="#0000ff">="0"</font> <font color="#ff0000">left</font> <font color="#0000ff">="true"</font> <font color="#ff0000">right</font> <font color="#0000ff">="true"</font> <font color="#ff0000">top</font> <font color="#0000ff">="true"</font> <font color="#ff0000">bottom</font> <font color="#0000ff">="true"</font> <font color="#ff0000">widths</font> <font color="#0000ff">="33;33;33"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">row</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">cell</font> <font color="#ff0000">borderwidth</font> <font color="#0000ff">="0.5"</font> <font color="#ff0000">red</font> <font color="#0000ff">="0"</font> <font color="#ff0000">green</font> <font color="#0000ff">="0"</font> <font color="#ff0000">blue</font> <font color="#0000ff">="0"</font> <font color="#ff0000">left</font> <font color="#0000ff">="false"</font> <br> <font color="#ff0000">right</font> <font color="#0000ff">="true"</font> <font color="#ff0000">top</font> <font color="#0000ff">="false"</font> <font color="#ff0000">bottom</font> <font color="#0000ff">="true"</font> <font color="#ff0000">header</font> <font color="#0000ff">="true"</font> <font color="#ff0000">horizontalalign</font> <font color="#0000ff">="Center"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">phrase</font> <font color="#ff0000">size</font> <font color="#0000ff">="10.0"</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">phrase</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">cell</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">cell</font> <font color="#ff0000">borderwidth</font> <font color="#0000ff">="0.5"</font> <font color="#ff0000">red</font> <font color="#0000ff">="0"</font> <font color="#ff0000">green</font> <font color="#0000ff">="0"</font> <font color="#ff0000">blue</font> <font color="#0000ff">="0"</font> <font color="#ff0000">left</font> <font color="#0000ff">="false"</font> <br> <font color="#ff0000">right</font> <font color="#0000ff">="true"</font> <font color="#ff0000">top</font> <font color="#0000ff">="false"</font> <font color="#ff0000">bottom</font> <font color="#0000ff">="true"</font> <font color="#ff0000">header</font> <font color="#0000ff">="true"</font> <font color="#ff0000">horizontalalign</font> <font color="#0000ff">="Center"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">phrase</font> <font color="#ff0000">size</font> <font color="#0000ff">="10.0"</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">phrase</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">cell</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">cell</font> <font color="#ff0000">borderwidth</font> <font color="#0000ff">="0.5"</font> <font color="#ff0000">red</font> <font color="#0000ff">="0"</font> <font color="#ff0000">green</font> <font color="#0000ff">="0"</font> <font color="#ff0000">blue</font> <font color="#0000ff">="0"</font> <font color="#ff0000">left</font> <font color="#0000ff">="false"</font> <br> <font color="#ff0000">right</font> <font color="#0000ff">="false"</font> <font color="#ff0000">top</font> <font color="#0000ff">="false"</font> <font color="#ff0000">bottom</font> <font color="#0000ff">="true"</font> <font color="#ff0000">header</font> <font color="#0000ff">="true"</font> <font color="#ff0000">horizontalalign</font> <font color="#0000ff">="Center"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">phrase</font> <font color="#ff0000">size</font> <font color="#0000ff">="10.0"</font> <font color="#0000ff">&gt;</font>  <font color="#0000ff">&lt;/</font> <font color="#800000">phrase</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">cell</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">row</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">row</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">cell</font> <font color="#ff0000">borderwidth</font> <font color="#0000ff">="0.5"</font> <font color="#ff0000">red</font> <font color="#0000ff">="0"</font> <font color="#ff0000">green</font> <font color="#0000ff">="0"</font> <font color="#ff0000">blue</font> <font color="#0000ff">="0"</font> <font color="#ff0000">left</font> <font color="#0000ff">="false"</font> <br> <font color="#ff0000">right</font> <font color="#0000ff">="true"</font> <font color="#ff0000">top</font> <font color="#0000ff">="false"</font> <font color="#ff0000">bottom</font> <font color="#0000ff">="false"</font> <font color="#ff0000">header</font> <font color="#0000ff">="false"</font> <font color="#ff0000">horizontalalign</font> <font color="#0000ff">="Left"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">phrase</font> <font color="#ff0000">size</font> <font color="#0000ff">="10.0"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:value-of</font> <font color="#ff0000">select</font> <font color="#0000ff">="FirstName"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">phrase</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">cell</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">cell</font> <font color="#ff0000">borderwidth</font> <font color="#0000ff">="0.5"</font> <font color="#ff0000">red</font> <font color="#0000ff">="0"</font> <font color="#ff0000">green</font> <font color="#0000ff">="0"</font> <font color="#ff0000">blue</font> <font color="#0000ff">="0"</font> <font color="#ff0000">left</font> <font color="#0000ff">="false"</font> <br> <font color="#ff0000">right</font> <font color="#0000ff">="true"</font> <font color="#ff0000">top</font> <font color="#0000ff">="false"</font> <font color="#ff0000">bottom</font> <font color="#0000ff">="false"</font> <font color="#ff0000">header</font> <font color="#0000ff">="false"</font> <font color="#ff0000">horizontalalign</font> <font color="#0000ff">="Left"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">phrase</font> <font color="#ff0000">size</font> <font color="#0000ff">="10.0"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:value-of</font> <font color="#ff0000">select</font> <font color="#0000ff">="SecondName"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">phrase</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">cell</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">cell</font> <font color="#ff0000">borderwidth</font> <font color="#0000ff">="0.5"</font> <font color="#ff0000">red</font> <font color="#0000ff">="0"</font> <font color="#ff0000">green</font> <font color="#0000ff">="0"</font> <font color="#ff0000">blue</font> <font color="#0000ff">="0"</font> <font color="#ff0000">left</font> <font color="#0000ff">="false"</font> <br> <font color="#ff0000">right</font> <font color="#0000ff">="false"</font> <font color="#ff0000">top</font> <font color="#0000ff">="false"</font> <font color="#ff0000">bottom</font> <font color="#0000ff">="false"</font> <font color="#ff0000">header</font> <font color="#0000ff">="false"</font> <font color="#ff0000">horizontalalign</font> <font color="#0000ff">="Left"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">phrase</font> <font color="#ff0000">size</font> <font color="#0000ff">="10.0"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:value-of</font> <font color="#ff0000">select</font> <font color="#0000ff">="LastName"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">phrase</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">cell</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">row</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">table</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:apply-templates</font> <font color="#ff0000">select</font> <font color="#0000ff">="Subtexts"</font> <font color="#0000ff">/&gt;</font> <br> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">itext</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:template</font> <font color="#ff0000">match</font> <font color="#0000ff">="Subtexts"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">paragraph</font> <font color="#ff0000">align</font> <font color="#0000ff">="Justify"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">phrase</font> <font color="#ff0000">size</font> <font color="#0000ff">="14.0"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">xsl:value-of</font> <font color="#ff0000">select</font> <font color="#0000ff">="Text"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">phrase</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">paragraph</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">newline</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:template</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">xsl:stylesheet</font> <font color="#0000ff">&gt;</font></font></code> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  For me, the description scheme they chose was not the most successful one, too, a loud code is obtained for a small pdf document.  So, it is not very familiar to describe the colors of red green and blue separately from each other, so it would be possible to make them in the HEX record.  As can be seen in the xslt scheme - there is a parameter in the document that indicates the path of the picture, which will be inserted into our pdf document, as there is a table consisting of 3 columns and a couple of paragraphs described by the scheme. <br>  Next step: we describe all the code that will return us an array of bytes of our pdf document, with comments I tried to describe the whole sequence of actions: <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">byte</font> [] GetPdfRaw() <br> { <br> <font color="#2b91af">XmlDocument</font> doc = <font color="#0000ff">new</font> <font color="#2b91af">XmlDocument</font> (); <br> <font color="#008000">//   xml </font> <br> doc.Load(MapPath( <font color="#a31515">@"~\Resources\UserProfile.xml"</font> )); <br> XslCompiledTransform xslTransform = <font color="#0000ff">new</font> XslCompiledTransform(); <br> <font color="#008000">//  XSLT </font> <br> xslTransform.Load(MapPath( <font color="#a31515">@"~\Resources\ReportProcessor.xslt"</font> )); <br> XsltArgumentList list = <font color="#0000ff">new</font> XsltArgumentList(); <br> <font color="#008000">//      </font> <br> list.AddParam( <font color="#a31515">"picturePath"</font> , <font color="#0000ff">string</font> .Empty, MapPath( <font color="#a31515">@"~\Resources\Toco.jpg"</font> )); <br> <font color="#008000">//   ,     xml   pdf </font> <br> <font color="#0000ff">using</font> (MemoryStream stream = <font color="#0000ff">new</font> MemoryStream()) <br> { <br> <font color="#008000">// xml   pdf </font> <br> xslTransform.Transform(doc, list, stream); <br> <br> <font color="#008000">// Font  pdf </font> <br> BaseFont baseFont = BaseFont.CreateFont(Environment.ExpandEnvironmentVariables( <font color="#a31515">@"%systemroot%\fonts\Tahoma.TTF"</font> ), <br> <font color="#a31515">"CP1251"</font> , BaseFont.EMBEDDED); <br> <br> <font color="#008000">// PDF </font> <br> Document document = <font color="#0000ff">new</font> Document(); <br> <font color="#0000ff">using</font> (MemoryStream pdfStream = <font color="#0000ff">new</font> MemoryStream()) <br> { <br> PdfWriter.GetInstance(document, pdfStream); <br> <font color="#2b91af">XmlDocument</font> d = <font color="#0000ff">new</font> <font color="#2b91af">XmlDocument</font> (); <br> <font color="#0000ff">string</font> str = <font color="#2b91af">Encoding</font> .UTF8.GetString(stream.ToArray()).Substring(1); <br> d.LoadXml(str); <br> <font color="#008000">//   xml  pdf</font> <br> ITextHandler h = <font color="#0000ff">new</font> ITextHandler(document) {DefaultFont = baseFont}; <br> h.Parse(d); <br> <font color="#008000">//  pdf    byte[]</font> <br> <font color="#0000ff">return</font> pdfStream.ToArray(); <br> } <br> } <br> }</font> <br></code> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote>  I want to draw attention to the definition of baseFont and install it as a default font for ITextHandler.  If this procedure is not performed, then Cyrillic will not be displayed.  This approach allows you to display Cyrillic, but does not allow us to use multiple fonts in one document.  In their code (the source code is good) they always take codepage 1252 (directly hardcoded into the code), so if you need to use several fonts in one document, then correct the code and build the library itself, or do not use xml as the source Data (but not the fact that the problem is only in ITextHandler). <br>  Still very interested in why they are sometimes called classes with the letter I, in c # interfaces are so called.  Of course, I understand that the library is ported from java, but still - it introduced me first into a stupor ... <br>  The last is the output of the pdf document in the Response page (if you have an ASP.NET application like mine) <br><blockquote> <code><font color="black"><font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">void</font> OnLoad( <font color="#2b91af">EventArgs</font> e) <br> { <br> <font color="#008000">//  Response pdf ,   MIME    </font> <br> <font color="#2b91af">HttpContext</font> .Current.Response.Clear(); <br> <font color="#2b91af">HttpContext</font> .Current.Response.ContentType = <font color="#a31515">"application/pdf"</font> ; <br> <font color="#2b91af">HttpContext</font> .Current.Response.AddHeader( <font color="#a31515">"Content-Disposition"</font> , <font color="#0000ff">string</font> .Format( <font color="#a31515">"attachment;filename=\"{0}\""</font> , <font color="#a31515">"report.pdf"</font> )); <br> <font color="#0000ff">byte</font> [] pdfRaw = GetPdfRaw(); <br> <font color="#2b91af">HttpContext</font> .Current.Response.OutputStream.Write(pdfRaw, 0, pdfRaw.Length); <br> }</font></code> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font></font></code> </blockquote>  <a href="">Download the example ...</a> (for the work of the example, you must also download the library itextsharp, the example uses version 4.1.2.0) <br><br>  Related Links: <br><ul><li>  <a href="http://sourceforge.net/projects/itextsharp/">iTextSharp at SourceForge</a> </li><li>  <a href="http://itextsharp.sourceforge.net/tutorial/">iTextSharp Tutorial</a> </li><li>  <a href="">iText.dtd</a> (xml schema) </li></ul></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/56973/">https://habr.com/ru/post/56973/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../56964/index.html">KallOut - Search Accelerator for Firefox</a></li>
<li><a href="../56966/index.html">Creating a palette</a></li>
<li><a href="../56970/index.html">Synchronizing: recipes for working on multiple computers</a></li>
<li><a href="../56971/index.html">Four years progress</a></li>
<li><a href="../56972/index.html">Dead pixel in Google Earth</a></li>
<li><a href="../56974/index.html">Asynchronous loading of javascript files. Acceleration and optimization of the process, increasing productivity</a></li>
<li><a href="../56975/index.html">Development through the ass</a></li>
<li><a href="../56976/index.html">Patterns in historical context</a></li>
<li><a href="../56977/index.html">Bashstyle-ng. Application localization example</a></li>
<li><a href="../56999/index.html">number 3649</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>