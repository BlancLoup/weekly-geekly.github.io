<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Kubernetes 1.10: a review of major innovations</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the end of March, the release of Kubernetes 1.10 . Maintaining our tradition of telling details about the most significant changes in the next rele...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Kubernetes 1.10: a review of major innovations</h1><div class="post__text post__text-html js-mediator-article">  At the end of March, the release of <a href="https://kubernetes.io/blog/2018/03/27/kubernetes-1.10-stabilizing-storage-security-networking/">Kubernetes 1.10</a> .  Maintaining our tradition of telling details about the most significant changes in the next release of Kubernetes, we are publishing this review, based on <a href="">CHANGELOG-1.10</a> , as well as numerous issues, pull requests and design proposals.  So what does the new K8s 1.10 bring? <br><br><img src="https://habrastorage.org/webt/u3/mx/7u/u3mx7ub1e7abecjuadpjrhpj-ps.png"><a name="habracut"></a><br><br><h2>  Storage </h2><br>  <a href=""><b>Mount propagation</b></a> - the ability of containers to mount volumes as <code>rslave</code> , so that mounted host directories are visible inside the container ( <code>HostToContainer</code> value), or <code>rshared</code> , so that mounted container directories are visible on the host ( <code>Bidirectional</code> value).  Status - beta version ( <a href="https://kubernetes.io/docs/concepts/storage/volumes/">documentation</a> on the site).  Not supported on Windows. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Added the ability to create <b>local persistent storage</b> ( <a href="">Local Persistent Storage</a> ), i.e.  <code>PersistentVolumes</code> (PVs) can now be not only network volumes, but also be based on locally attached disks.  The innovation has two goals: a) improve performance (local SSDs have a better speed than network drives), b) ensure the possibility of using cheaper storages on bare metal Kubernetes installations.  These works will be introduced together with the creation of Ephemeral Local Storage, the <a href="https://github.com/kubernetes/features/issues/361">limitations / limits</a> in which (first introduced in <a href="https://habrahabr.ru/company/flant/blog/338230/">K8s 1.8</a> ) also received improvements in the next release - announced in beta and now included by default. <br><br>  <i><a href="https://github.com/kubernetes/features/issues/490">Topology Aware Volume Scheduling</a></i> became available (in beta <i>)</i> , the idea of ‚Äã‚Äãwhich comes down to the fact that the standard scheduler Kubernetes knows (and takes into account) the limitations of the topology of the volumes, and during the binding process <code>PersistentVolumeClaims</code> (PVCs) to PVs are accounted for by planner decisions.  It is implemented in such a way that it can now request PVs, which should be compatible with its other limitations: resource requirements, affinity / anti-affinity policies.  At the same time, planning of pods that do not use PVs with restrictions should occur with the same performance.  Details are in <a href="">design-proposals</a> . <br><br>  Among other improvements in volume / file system support: <br><br><ul><li>  Improvements in Ceph RBD with the <a href="https://github.com/kubernetes/kubernetes/pull/58916">ability to</a> use the rbd-nbd client (based on the popular librbd library) in pkg / volume / rbd; </li><li>  Ceph FS mount <a href="https://github.com/kubernetes/kubernetes/pull/55866">support</a> via FUSE; </li><li>  AWS EBS plugin <a href="https://github.com/kubernetes/kubernetes/pull/58625">adds</a> support for block volumes and <code>volumeMode</code> , as well as support for block volumes in the GCE PD plugin; </li><li>  <a href="https://github.com/kubernetes/kubernetes/pull/58794">the ability to</a> change the size of the volume, even in cases where it is mounted. </li></ul><br>  Finally, <b>additional metrics</b> <a href="https://github.com/kubernetes/features/issues/496">have been added</a> (and declared stable) that indicate the internal state of the storage subsystem in Kubernetes and are intended for debugging, as well as for obtaining an extended view of the cluster state.  For example, now for each volume (by <code>volume_plugin</code> ) you can find out the total time for the mount / umount and attach / detach operations, the total time of privision and deletion, as well as the number of volumes in <code>ActualStateofWorld</code> and <code>DesiredStateOfWorld</code> , bound / unbound PVCs and PVs, the number of used PVCs, etc. For more details, see the <a href="">documentation</a> . <br><br><h2>  Kubelet, nodes and their management </h2><br>  <i>Kubelet</i> was able to customize through a <b>versioned configuration file</b> (instead of the traditional way with flags on the command line), which has the <code>KubeletConfiguration</code> structure.  In order for <i>Kubelet to</i> pick up the config, you need to run it with the <code>--config</code> flag (see the <a href="https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/">documentation for</a> details).  This approach is called recommended because it simplifies node deployment and configuration management.  This was made possible by the emergence of an API group called <code>kubelet.config.k8s.io</code> , which has beta status for the release of Kubernetes 1.10.  Example configuration file for <i>Kubelet</i> : <br><br><pre> <code class="plaintext hljs">kind: KubeletConfiguration apiVersion: kubelet.config.k8s.io/v1beta1 evictionHard: memory.available: "200Mi"</code> </pre> <br>  With the help of a new option in the <code>shareProcessNamespace</code> spec, <code>shareProcessNamespace</code> in <code>PodSpec</code> , containers can now use a <b>common</b> <code>PodSpec</code> <b>for processes</b> <i>(PID namespace)</i> .  Previously, this feature was not due to the lack of <a href="https://github.com/moby/moby/pull/22481">necessary support</a> in Docker, which led to the emergence of an additional API, which has since been used by some container images ... Now everything has been <a href="">unified</a> , maintaining backward compatibility.  The result of the implementation is the support of three modes of PID namespace separation in the Container Runtime Interface (CRI): for each container (that is, its namespace for each container), for the hearth (common namespace for the hearth containers), for the node.  Readiness status - alpha. <br><br>  Another significant change in CRI is the emergence of support for the <b>Windows Container Configuration</b> .  Until now, only Linux containers could be configured in CRI, however, the features of other platforms, in particular, <a href="">Windows</a> , were described in the Open Container Initiative, <a href="https://github.com/opencontainers/runtime-spec">Runtime Specification</a> (OCI) executable environment.  Now CRI <a href="">supports</a> memory and processor limits for Windows containers (alpha version). <br><br>  In addition, the status of the beta version reached three development Resource Management Working Group: <br><br><ol><li>  <a href="https://kubernetes.io/docs/tasks/administer-cluster/cpu-management-policies/">CPU Manager</a> (assignment I will give you specific processor cores - read more about it in the <a href="https://habrahabr.ru/company/flant/blog/338230/">article about K8s 1.8</a> ); </li><li>  <a href="https://kubernetes.io/docs/tasks/manage-hugepages/scheduling-hugepages/">Huge Pages</a> (the ability to use 2Mi and 1Gi Huge Pages pods, which is important for applications that consume large amounts of memory); </li><li>  <a href="https://kubernetes.io/docs/concepts/cluster-administration/device-plugins/">Device Plugin</a> (framework for vendors that allows you to declare resources in <i>kubelet</i> : for example, from GPU, NIC, FPGA, InfiniBand, etc. - without the need to modify the main Kubernetes code). </li></ol><br>  <b>The number of processes running in the pod</b> <a href="https://github.com/kubernetes/kubernetes/pull/57973">can</a> now <a href="https://github.com/kubernetes/kubernetes/pull/57973">be limited</a> using the <code>--pod-max-pids</code> for the <code>--pod-max-pids</code> console command.  The implementation has the status of an alpha version and requires the inclusion of the <code>SupportPodPidsLimit</code> feature. <br><br>  Due to the fact that a native CRI v1alpha2 support appeared in containerd 1.1, in Kubernetes 1.10 you can work directly with containerd 1.1 without the need for a cri-containerd mediator <i>(we wrote more about it at the end of <a href="https://habrahabr.ru/company/flant/blog/340010/">this article</a> )</i> .  CRI-O also updated the CRI version to v1alpha2, and the CRI (Container Runtime Interface) added support for specifying the container GID in <code>LinuxSandboxSecurityContext</code> and in <code>LinuxContainerSecurityContext</code> (in addition to UID) - support is implemented for <i>dockershim</i> and has alpha version status. <br><br><h2>  Network </h2><br>  An option using CoreDNS instead of <i>kube-dns</i> has reached beta status.  In particular, this <a href="https://github.com/kubernetes/website/pull/7638/files">brought the</a> ability to <b>migrate to CoreDNS</b> when upgrading using the <i>kubeadm</i> cluster using <i>kube-dns</i> : in this case, <i>kubeadm will</i> generate a CoreDNS configuration (i.e. <code>Corefile</code> ) based on the <code>ConfigMap</code> from <i>kube-dns</i> . <br><br>  Traditionally, <code>/etc/resolv.conf</code> on the pod is managed by a <i>kubelet</i> , and the data of this config is generated based on <code>pod.dnsPolicy</code> .  Kubernetes 1.10 (in beta status) <a href="https://github.com/kubernetes/features/issues/504">provides</a> support <b>for the <code>resolv.conf</code> configuration of <code>resolv.conf</code></b> .  To do this, the <code>PodSpec</code> field has been added to the <code>dnsParams</code> , which allows you to overwrite the existing DNS settings.  Read more in <a href="">design-proposals</a> .  Illustration of using <code>dnsPolicy: Custom</code> with <code>dnsParams</code> : <br><br><pre> <code class="plaintext hljs"># Pod spec apiVersion: v1 kind: Pod metadata: {"namespace": "ns1", "name": "example"} spec: ... dnsPolicy: Custom dnsParams: nameservers: ["1.2.3.4"] search: - ns1.svc.cluster.local - my.dns.search.suffix options: - name: ndots value: 2 - name: edns0</code> </pre> <br>  An option has been <a href="https://github.com/kubernetes/features/issues/539">added to</a> <i>kube-proxy</i> that allows defining a <b>range of IP addresses for <code>NodePort</code></b> , i.e.  initiate filtering of valid values ‚Äã‚Äãusing <code>--nodeport-addresses</code> (with a default value of <code>0.0.0.0/0</code> , i.e. skip everything that the current behavior of <code>NodePort</code> ).  <a href="">Implementation</a> in <i>kube-proxy</i> for iptables, Linux userspace, IPVS, Window userspace, winkernel is provided.  Status - alpha version. <br><br><h2>  Authentication </h2><br>  Added new authentication methods (alpha version): <br><br><ol><li>  <b>external client providers</b> : responding to long-standing requests from K8s users for exec-based plugins, <i>kubectl</i> (client-go) <a href="https://github.com/kubernetes/features/issues/541">implemented</a> support for <a href="">executable plug-ins</a> that can receive authentication data by executing an arbitrary command and reading its output (the GCP plugin can also be configured to invoke commands other than <i>gcloud</i> ).  One application is that cloud providers will be able to create their own authentication systems (instead of using standard Kubernetes mechanisms); </li><li>  <b>TokenRequest API</b> for <a href="">receiving</a> JWT (JSON Web Tokens) tokens <b>associated</b> with clients <i>(audience)</i> and time. </li></ol><br>  In addition, the stable status <a href="https://github.com/kubernetes/features/issues/279">gained the</a> ability to restrict node access to certain APIs (using the <code>Node</code> authorization mode and the <code>NodeRestriction</code> admission plugin) in order to grant them permission only for a limited number of objects and their associated secrets. <br><br><h2>  CLI </h2><br>  Progress has been made in <b>processing the output</b> shown by the <code>kubectl get</code> and <code>kubectl describe</code> .  The global objective of the <a href="https://github.com/kubernetes/features/issues/515">initiative</a> , which has received beta status in Kubernetes 1.10, is that getting columns for tabular display of data should occur on the server side (and not the client), this is done to improve the user interface when working with extensions.  The work begun earlier (in K8s 1.8) on the server side has been brought to the beta level, and major changes <a href="https://github.com/kubernetes/kubernetes/issues/58536">have been</a> made on the client side. <br><br>  In <i>kubectl port-forward</i> , the <a href="https://github.com/kubernetes/kubernetes/pull/59705">ability to</a> use the resource name is added to select a suitable hearth (and the <code>--pod-running-timeout</code> flag to wait for at least one under the launch), as well as <a href="https://github.com/kubernetes/kubernetes/pull/59809">support for</a> specifying a service for port forwarding (for example: <code>kubectl port-forward svc/myservice 8443:443</code> ). <br><br>  New short names for <i>kubectl</i> commands: <code>cj</code> instead of <code>CronJobs</code> , <code>crds</code> - <code>CustomResourceDefinition</code> .  For example, the command <code>kubectl get crds</code> has become available. <br><br><h2>  Other changes </h2><br><ul><li>  <a href="https://github.com/kubernetes/features/issues/263">API Aggregation</a> , i.e.  aggregation of user apiservers with the main API in Kubernetes, has received a stable status and is officially ready for use in production. </li><li>  <i>Kubelet</i> and <i>kube-proxy</i> <a href="https://github.com/kubernetes/kubernetes/pull/60144">can</a> now <a href="https://github.com/kubernetes/kubernetes/pull/60144">run</a> as native services in Windows.  Added support for Windows Service Control Manager (SCM) and experimental <a href="https://github.com/kubernetes/kubernetes/pull/58751">isolation support</a> with Hyper-V for single-container pods. </li><li>  The <i>Persistent Volume Claim Protection</i> ( <code>PVCProtection</code> ) <code>PVCProtection</code> , which ‚Äúprotects‚Äù against the possible removal of PVCs that are actively used by subframes, has been renamed to <code>Storage Protection</code> and has been upgraded to beta. </li><li>  Alpha version of <a href="https://github.com/kubernetes/features/issues/514">Azure support</a> in <i>cluster-autoscaler</i> . </li></ul><br><h2>  Compatibility </h2><br><ul><li>  The supported <b>etcd</b> version is 3.1.12.  In this case, etcd2 as a backend is declared obsolete, its support will be removed in the release of Kubernetes 1.13. </li><li>  Proven <b>Docker</b> versions range from 1.11.2 to 1.13.1 and 17.03.x (have not changed since the release of K8s 1.9). </li><li>  <b>Go</b> version - 1.9.3 (instead of 1.9.2), minimum supported - 1.9.1. </li><li>  <b>CNI</b> version is 0.6.0. </li></ul><br><h2>  PS </h2><br>  Read also in our blog: <br><br><ul><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/344220/">Kubernetes 1.9: review of major innovations</a> ‚Äù; </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/344098/">Four releases 1.0 from CNCF and major announcements about Kubernetes from KubeCon 2017</a> ‚Äù; </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/338230/">Kubernetes 1.8: review of major innovations</a> ‚Äù; </li><li>  ‚Äú <a href="https://habrahabr.ru/company/flant/blog/332160/">Docker 17.06 and Kubernetes 1.7: key innovations</a> ‚Äù; </li><li>  " <a href="https://habrahabr.ru/company/flant/blog/341760/">Infrastructure with Kubernetes as an affordable service</a> ." </li></ul></div><p>Source: <a href="https://habr.com/ru/post/353114/">https://habr.com/ru/post/353114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353102/index.html">Effective use of AWS spot instances</a></li>
<li><a href="../353104/index.html">Procedural maze generation in Unity</a></li>
<li><a href="../353108/index.html">Is it possible to enter the closed door, or how patches vulnerabilities</a></li>
<li><a href="../353110/index.html">Mitap Cocoaheads in Tutu.ru office</a></li>
<li><a href="../353112/index.html">Security violations of mobile applications as a result of insufficient attention of the developers</a></li>
<li><a href="../353116/index.html">Dagaz: Looking for talents</a></li>
<li><a href="../353118/index.html">Sberbank Business Online on Windows 10 - a new solution for customers, or why UWP applications are driving</a></li>
<li><a href="../353120/index.html">How we did a project about the presidential elections in Russia in 2018</a></li>
<li><a href="../353122/index.html">Figma web-API - an interface that allows you to connect to other tools</a></li>
<li><a href="../353124/index.html">UL 3223: New Data Center Certification Standard introduced</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>