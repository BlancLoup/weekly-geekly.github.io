<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Programming for PlayStation 2: CD (DVD) -ROM Library - part one</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. I apologize for not writing for a long time. 
 2. Ready PS2 SDK. 

 I wanted to watch out for the CD (DVD) -ROM Library, so the links and the PS2 S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Programming for PlayStation 2: CD (DVD) -ROM Library - part one</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3b7/bff/ed4/3b7bffed4410cc6e476bc9482dfa37d7.jpg" alt="image"><br><br>  1. I apologize for not writing for a long time. <br>  2. Ready PS2 SDK. <br><br>  I wanted to watch out for the CD (DVD) -ROM Library, so the links and the PS2 SDK installation guide can be found at the end of the second part of this article. <br>  The topic is quite complicated.  <s>I will also be grateful if someone transfers to another non-paid hosting PS2 SDK</s> . <br>  PS2 SDK is available <a href="http://www.ex.ua/view_storage/294375590074">here</a> .  <a href="http://narod.ru/disk/37079533001/sce.zip.html">Narod.ru</a> . <br>  Magnet (link is not normally inserted thanks to the habr parser): magnet:? Xt = urn: btih: F6114E45C5E392E6D213F2547C466FADB5DA5A13 &amp; dn = sce.zip &amp; tr = udp% 3a // tracker.openbittorrent.com% 3a80 / announce <br>  <a href="">Another link</a> .  Thank you <a href="https://habrahabr.ru/users/konstantinus/" class="user_link">Konstantinus</a> and <a href="https://habrahabr.ru/users/ahmpro/" class="user_link">ahmpro</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h4>  CD (DVD) -ROM Library. </h4><br><br>  Both IOP and EE are used to operate the drive. <br>  The library responsible for working with the drive is called ‚Äúlibcdvd‚Äù (exactly). <br><br>  EE library to connect: "libcdvd.a". <br>  Header file: ‚Äúlibcdvd.h‚Äù. <br>  IOP library for connection: "cdvdman.ilb". <br>  IOP modules: "cdvdman.irx" and "cdvdfsv.irx". <br><br><h4>  Sector </h4><br><br>  The normal sector size for reading data is 2048 bytes for a DVD. <br>  For them, there is only one mode. <br>  Well, and the standard size for CD disks (also 2048).  However, the sector may be a different size, but, at the moment, it does not matter. <br><br><h4>  Rotation speed and data transfer </h4><br><br>  PS2 uses the CAV method, so the speed of the disk is maintained and is constant.  Thus, the speed of reading data will be different on the external and internal tracks. <br><ul><li>  CD, internal tracks - 10 speed = 1500 KB / s. </li><li>  CD, external tracks - 24 speed = 3600 KB / s. </li><li>  DVD, internal tracks - 1.6 speed = 2000 KB / s. </li><li>  DVD, external tracks - 4 speed = 5000 KB / s. </li></ul><br><br>  Oddly enough, the rotation speed can be controlled in the following three ways: <br>  - Using streaming mode (SCECdSpinStm): the rotational speed is adjusted in such a way that the reading can be performed reliably at a constant data rate. <br>  - Normal data mode (SCECdSpinNom): at the beginning, an attempt will be made to read at maximum speed and, if there is a read error, the speed will be reduced to the one at which reading will be normal. <br>  - Dual Layer Disk Mode (SCECdSpinDvdDL0): the same as streaming mode, only for dual layer discs.  The speed is read from the zero track. <br><br><h4>  File system </h4><br><br>  The file system is used in ISO-9660 format. <br>  There is a limit on the number of files and directories, however, it can be increased by the number of letters in the names of files and folders. <br><br>  Number of directories in a folder: 40. <br>  Maximum level of nesting: 8. <br>  Number of files in the directory: 30. <br>  File and folder names should consist only of numbers, letters of the English alphabet and underscore.  All folder and file names must be in upper case only. <br>  The file name can include no more than 8 characters in the file name and 3 characters in the extension. <br>  The folder name can include no more than 8 characters. <br><br><h4>  Work with a disk </h4><br><br>  To read the disc, you need to access it and specify the mode. <br>  After the processor checks it for legality.  =) <br>  Then you need to access it again. <br>  After initializing the program, you need to initialize the drive with the sceCdInit () function. <br>  The sceCdInit function takes one of the following parameters: <br><ul><li>  SCECdINIT - library initialization, blocking access and waiting for the next command. </li><li>  SCECdINoD - only initialization. </li><li>  SCECdEXIT - closing the library. </li></ul><br>  The function returns a number: 0 - initialization failed, 1 - initialization was normal, 2 - initialization has already been completed. <br><br>  After that, you need to specify the mode of working with the drive using the sceCdMmode () function, which takes one of the two SCECdCD or SCECdDVD parameters for CDs and DVDs, respectively.  Returns 1 or 0, which corresponds to the result or not. <br><br>  Example: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">int</font> main(){ <br> sceSifInitRpc(0); <br> sceCdInit(SCECdINIT); <font color="#008000">/*     CD/DVD */</font> <br> sceCdMmode(SCECdCD); <font color="#008000">/*   = CD-ROM */</font> <br> <font color="#008000">/*     */</font> <br> <font color="#0000ff">while</font> ( !sceSifRebootIop(IOPRP) ); <br> <font color="#0000ff">while</font> ( !sceSifSyncIop() ); <br> <font color="#008000">/*   */</font> <br> sceSifInitRpc(0); <br> sceCdInit(SCECdINIT); <br> sceCdMmode(SCECdCD); <font color="#008000">/*   = CD-ROM */</font> <br> sceFsReset(); <br> <font color="#008000">/*  ‚Ä¶ */</font> <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><h4>  Reading files </h4><br><br>  To read a file, you first need to find out in which sector it is located. <br>  To do this, there is the sceCdSearchFile () function, which takes the following arguments: <br><ul><li>  Pointer to the drive file structure (type sceCdIFILE).  It stores the LSN (logical sector number) and the file size after the function has been run. </li><li>  The absolute path to the file with the name and extension. </li></ul><br>  Returns 0 or 1, which means the file is not found or found, respectively. <br><br>  Those.  something like this: ret = sceCdSearchFile (&amp; fp, "\\ SYSTEM.CNF"); <br><br>  This information is cached. <br><br>  To read the file, there is the sceCdRead () function, which accepts the following parameters: LSN, number of sectors to read, buffer to read, type of reading. <br>  It is necessary to remember that the function is not blocking, so you can learn that the data transfer is completed using the sceCdSync () function. <br><br>  The sceCdSync () function takes one parameter, which can be of two types: <br><ul><li>  0x00 - will block the stream until the command ends.  In this case, the function will return 0 upon completion. </li><li>  0x01 - checks the status and returns the result without blocking the stream.  In this case, the function will return 0 or 1. </li></ul><br><br>  In order to indicate what type of reading you are using there is a sceCdRMode () function that takes the following parameters: <br><ul><li>  u_char - (from 0 to 255) the number of repetitions of a read before a read error is declared. </li><li>  u_char - disk rotation speed.  One of the options: <ul><li>  SCECdSpinStm - recommended speed; </li><li>  SCECdSpinNom - start reading the disc from the maximum speed and go down to the one on which you can read normally. </li><li>  SCECdSpinDvdDL0 - dual-layer disc reading mode. </li></ul></li><li>  u_char - sector size.  There is only one type of parameter: SCECdSecS2048, i.e.  the size is 2048 bits. </li><li>  u_char - filled data for alignment. </li></ul><br><br>  The alignment data is used to ensure that the function always occupies the same memory size. <br><br>  There is also a function through which you can learn about the type of error that occurred - <br>  sceCdGetError (). <br>  Returns the type of error or SCECdErNO if there were no errors. <br><br><h4>  Using Callback </h4><br><br>  Instead of waiting, you can use callback functions.  They are assigned using the sceCdCallback () function.  The parameter takes a pointer to the function address.  It is necessary to take into account that the function is called regardless of which asynchronous function has ended.  However, the reason code of the function call is passed in the first parameter. <br>  You can not assign a function during the execution of the function called Calbak (sorry for the tautology). <br>  If you pass 0 instead of the parameter, then the cashback will be removed. <br><br>  The parameter passed to the function from the kelbeck can take the following values: <br><ul><li>  SCECdFuncRead - says that the sceCdRead () function has ended </li><li>  SCECdFuncSeek - the sceCdSeek () function has ended; </li><li>  SCECdFuncStandby - the sceCdStandby () function has been completed; </li><li>  SCECdFuncStop - the sceCdStop () function has finished; </li><li>  SCECdFuncPause - the sceCdPause () function has ended. </li></ul><br><br>  You can not assign a function, type sceCdRead (); <br>  The function returns 0 or the address to the previous callback. <br><br><h4>  Stream reading </h4><br><br>  Stream reading requires the use of IOP memory.  To use streaming reading, you need to connect the cdvdstm.irx module via the sceSifLoadModule () function. <br><br>  The stream is loaded into the IOP memory and data can be read from there. <br><br>  The following functions are used for streaming reading. <br><br>  sceCdStInit () - initializes the stream and sets the buffer. <br>  Options: <br>  - stream capacity (determined using the number of sectors at 2048 bytes). <br>  - the number of parts of the flow (according to the specification - rings).  A buffer with 3 or more parts must have a capacity of more than 16 sectors. <br>  - stream address in memory. <br>  To get a location in the IOP memory, you need to use the sceSifAllocIopHeap () function from the EE Kernel. <br>  The function returns 0 or 1, which is False or True. <br><br>  sceCdStStart () - start stream filling. <br>  Options: <br>  - position to start reading from the disk.  Used LSN. <br>  - type of reading obtained through sceCdRMode (). <br>  Returns the same as the previous one. <br><br>  sceCdStRead () - read data from stream. <br>  Options: <br>  - the number of sectors to read from the buffer. <br>  - address for reading data (must be aligned to 64 bytes). <br>  - reading type: STMNBLK - returns the information that is in the buffer;  STMBLK - returns data, thu is or error. <br>  - variable for the error number. <br>  Returns the number of sectors read. <br><br>  Error numbers may be as follows: <br><ul><li>  0x00 = SCECdErNO - no error. </li><li>  0x01 = SCECdErABRT - termination command returned. </li><li>  0x13 = SCECdErNORDY - the block is not read. </li><li>  0x14 = SCECdErCUD - the read method is not suitable for a disk in the drive. </li><li>  0x20 = SCECdErIPI - abnormal sector position. </li><li>  0x21 = SCECdErRILI - abnormal number of sectors for reading. </li><li>  0x30 = SCECdErREAD - problems reading from disk. </li><li>  031 = SCECdErTRMOPN - the cover was opened during reading. </li></ul><br><br>  sceCdStPause () - pauses streaming fill. <br>  There are no parameters.  Returns the success of the operation as 0 or 1. <br><br>  sceCdStResume () - return streaming fill. <br>  There are no parameters.  Returns the success of the operation. <br><br>  sceCdStSeek () - changing position to read the stream. <br>  The parameter takes LSN.  Returns the success of the operation. <br><br>  sceCdStStat () - get stream read status to buffer. <br>  There are no parameters.  Returns 0 in case of an error or the number of sectors read. <br><br>  sceCdStStop () - stop filling status with stream <br>  There are no parameters.  Returns the success of the operation. <br><br>  After calling sceCdStInit () and performing initialization of the call to sceCdStart (), the data will be read in the background, starting from the specified sector, and store them in a buffer.  After sceCdStRead () is executed, the data in the buffer can be read sequentially. <br>  Please note that the following libcdvd functions cannot be used to access the disk during streaming (I will explain them later): <br><ul><li>  sceCdChangeThreadPriority () </li><li>  sceCdGetToc () </li><li>  sceCdInit () </li><li>  sceCdMmode () </li><li>  sceCdPause () </li><li>  sceCdRead () </li><li>  sceCdReadChain () </li><li>  sceCdReadIOPm () </li><li>  sceCdSearchFile () </li><li>  sceCdSeek () </li><li>  sceCdStandby () </li><li>  sceCdStop () </li><li>  sceCdSync () </li><li>  sceCdDiskReady () </li><li>  sceCdGetError () </li><li>  sceCdGetReadPos () </li></ul><br><br><h4>  Need to know </h4><br><br>  The bottom line is that the drive is connected to the IOP and somehow you have to use the IOP functions. <br>  The following data differs between IOP and EE: <br>  - the command to finish reading data from EE means that the data are received by the processor EE, and not the completion of reading data from the disk; <br>  - errors on the EE side affect subsequent actions on the IOP side; <br>  - when transferring data to EE, memory alignment will always occur up to 64 bytes. <br>  - the priority of the stream in EE, which will work with the disk, will correspond to the priority in the IOP, so be careful, otherwise you can lose the normal processing of other IOP streams. <br><br><h4>  By the end of the first part </h4><br><br>  The topic is very complex.  In the second part I will explain the rest of the article and how to install the PS2 SDK on Windows and Linux. <br><br>  <b>PS</b> : I apologize for any typos. </div><p>Source: <a href="https://habr.com/ru/post/135898/">https://habr.com/ru/post/135898/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../135891/index.html">The story of how I switched to my bread (sharing experiences for beginners and asking for the advice of experienced ones)</a></li>
<li><a href="../135893/index.html">Announcement on CES: ThinkPad X1 Hybrid - x86 + ARM in one laptop</a></li>
<li><a href="../135895/index.html">Nokia has closed a deal to acquire the developer of a mobile OS Smarterphone</a></li>
<li><a href="../135896/index.html">I will give the project in good hands</a></li>
<li><a href="../135897/index.html">Top 5 most impressive books every software developer should read</a></li>
<li><a href="../135899/index.html">Apple plans to protect its products from theft by storing the password in the charger</a></li>
<li><a href="../135900/index.html">Parse KCaptcha, reassemble ... under .NET</a></li>
<li><a href="../135902/index.html">Packaging of Python-program in APK format</a></li>
<li><a href="../135904/index.html">Project management system with blackjack and addons</a></li>
<li><a href="../135908/index.html">Django Admin Bootstrap Theme</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>