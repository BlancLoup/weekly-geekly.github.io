<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Broadband Method (Class Library)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 
 (from the article COMPUTER STEGANOGRAPHY OF YESTERDAY, TODAY, TOMORROW. Information security technologies of the 21st century. / V. Barsuko...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Broadband Method (Class Library)</h1><div class="post__text post__text-html js-mediator-article"><h2>  Foreword </h2><br>  <b>(from the article COMPUTER STEGANOGRAPHY OF YESTERDAY, TODAY, TOMORROW. Information security technologies of the 21st century. / V. Barsukov, Ph.D., Romantsov A.P. / 1998 /)</b> <br>  The task of reliable information protection from unauthorized access is one of the oldest and still unsolved problems.  The methods and methods of concealing secret messages have been known for a long time, and this area of ‚Äã‚Äãhuman activity has been called steganography.  This word comes from the Greek words steganos (secret, secret) and graphy (record) and thus literally means ‚Äúsecret writing‚Äù, although steganography methods appeared probably before the writing itself appeared (the symbols and symbols were originally used). <br>  Later, to protect the information, coding and cryptography methods that were more efficient at the time of creation were used. <br>  As you know, the purpose of cryptography is to block unauthorized access to information by encrypting the content of secret messages.  Steganography has another task, and its purpose is to hide the very fact of the existence of a secret message.  At the same time, both methods can be combined and used to increase the effectiveness of information security (for example, for transmitting cryptographic keys). <br>  Like any tools, steganographic methods require attention and careful handling, as they can be used both for defense purposes and for attack purposes. <br><br><h2>  Algorithm </h2><br>  In accordance with the broadband signal method, each data bit is encoded by a sequence of altered pixel intensities in accordance with the values ‚Äã‚Äãof the pseudo-random bit bits. <br>  The broadband signal method implies the possibility of generating the same pseudo-random sequence from the sending and receiving sides, or at least pseudo-random sequences with statistical characteristics equivalent to equal. <br>  At the same time, not only the image itself, but also a reversible transformation of this image, for example, the spectrum obtained as a result of Fourier transforms, can act as a container for placing data.  The presence of a large number of libraries that implement Fourier transforms (in all sorts of variants of fast versions) makes the implementation of algorithms not a very difficult task for programming. <br><a name="habracut"></a><br><h3>  Formula for placing data in a graphic file </h3><br>  The formula for changing the brightness of pixels depending on the value of the i-th bit of the data x [i] and the j-th bit of the pseudo-random sequence y [j]: <br>  Cw [i, j] = C [i, j] + A * (- 1) ^ (x [i] xor y [j]) <br>  Where <br>  C [i, j] is the brightness value of a pixel of a graphic image associated with the i-th bit of data x [i] and the j-th bit of the pseudo-random sequence y [j] <br>  A - brightness change value (method parameter - immersion depth) <br><br><h3>  Formula for extracting data from a graphic file </h3><br>  When extracting data from the pixel brightness array, a weighted voting scheme is applied with coefficients equal to the difference between the average brightness value and the brightness of the voting pixel. <br>  V [i] = SUM (Cw [i, j] -Mw [i, j]) (- 1) ^ y [j] <br>  if V [i] &lt;0 then x [i] == 0 else x [i] == 1 <br>  Where <br>  Cw [i, j] is the pixel brightness value of the decoded graphic image associated with the i-th bit of data x [i] and the j-th bit of the pseudo-random sequence y [j] <br>  Mw [i, j] - the value of the average brightness of pixels around a pixel of a decoded graphic image associated with the i-th bit of the data x [i] and the j-th bit of the pseudo-random sequence y [j] 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Compensation of changes in the average brightness of the image when applying the method of wideband signal </h3><br>  The use of a pseudo-random sequence with characteristics close to equiprobable for encoding data allows to preserve the average brightness of pixels in the original graphic image and in the image containing embedded data. <br>  However, with direct and literal application of the algorithm, the average brightness of the pixels could have been offset relative to the average brightness of the original image. <br>  To estimate the magnitude of the bias, a statistical calculation is made of the number of zeros and ones of the function (x [i] xor y [j]) <br>  And if p0 is the probability of zeros, and p1 is the probability of ones, then an estimate of the magnitude of the change in average brightness is calculated by the formula: <br>  dC = A * (p0-p1) <br>  This dC estimate will be used in the formula of the algorithm itself for the method of wideband signals to compensate for the displacement of the average brightness of the image. <br>  Cw [i, j] = C [i, j] + A * (- 1) ^ (x [i] xor y [j]) - dC <br><br><h3>  Using Noise Suppression </h3><br>  Since the change in brightness up or down is equally probable (or at least it is assumed by the method), then the average brightness of the original image should almost coincide with the average brightness of the image generated by the method.  The same rule, apparently, should be executed for small sections of the image. <br>  Thus, it can be assumed that the images obtained as a result of eliminating noise from the original image and as a result of eliminating noise from the generated image should practically coincide, and therefore the image obtained by using the noise elimination filter can be selected as known to the sender and receiver of information. <br>  Thus, the formula for placing data in a graphic file can be replaced by the formula <br>  Cw [i, j] = M [i, j] + A * (- 1) ^ (x [i] xor y [j]) <br>  Where <br>  M [i, j] - the value of the average brightness of pixels around a pixel of the encoded graphic image associated with the i-th bit of the data x [i] and the j-th bit of the pseudo-random sequence y [j] <br><br><h3>  Automatic calculation of the depth of immersion. </h3><br>  When used to place data in a graphic file of the formula <br>  Cw [i, j] = C [i, j] + A * (- 1) ^ (x [i] xor y [j]) - dC <br>  and to extract the data from the graphic file of the formula <br>  V [i] = SUM (Cw [i, j] -Mw [i, j]) (- 1) ^ y [j] <br>  if V [i] &lt;0 then x [i] == 0 else x [i] == 1 <br>  it is possible to give an estimate for choosing the optimal value of the algorithm parameter ‚Äî the immersion value A based on statistical estimates. <br>  So adding or subtracting the value of A from the brightness values ‚Äã‚Äãof the pixels will increase the square of the variance of the final image by the value of A ^ 2. <br>  At the same time, we assume it equally probable to add and subtract the value of A from the brightness of a pixel. <br>  So, when using a locally averaged value M in the recovery formula, you can set the value of A using the following formula <br>  A = SQRT (AVG (C [i, j] -M [i, j]) ^ 2) <br><br><h3>  The role of coefficients in the voting scheme </h3><br>  When using the voting scheme in the original methodology, the vote coefficients equal to the difference between the average brightness value and the voting pixel brightness are the vote coefficients from the statistical criterion for separating two simple statistical hypotheses known as the ‚ÄúMost Powerful‚Äù to separate two simple hypotheses about the normal distribution or with parameters (A, A), or with parameters (-A, A). <br>  Since, when receiving and extracting data from a graphic file, the value of A is not known reliably, its average value can be selected as SQRT (AVG (Cw [i, j] -Mw [i, j]) ^ 2), which in turn, coincides with the dispersion of the same distribution. <br><br><h4>  Evidence </h4><br>  The coefficients of the votes, using the statistical criterion "Most powerful", can be calculated using the formula -log (P1 (x) / P0 (x)), where P0 and P1 are the probability values ‚Äã‚Äãof the statistics being studied, and x is the difference between the average the brightness value and the brightness of the voting pixel. <br>  Pn (x) = exp (- (xA) ^ 2 / A ^ 2) / (SQRT (2 * pi) * A) <br>  -log (Pn (x)) = -log (exp (- (xA) ^ 2 / A ^ 2) / (SQRT (2 * pi) * A)) = (xA) ^ 2 / A ^ 2 + log ( SQRT (2 * pi) * A), <br>  which means <br>  -log (Pn (x) / Pn (-x)) = (xA) ^ 2 / A ^ 2 + log (SQRT (2 * pi) * A) - (- xA) ^ 2 / A ^ 2-log ( SQRT (2 * pi) * A) = ((xA) ^ 2- (x + A) ^ 2) / A ^ 2 = 4 * x / A ^ 2 = O (x) <br>  Thus, using a voting scheme with vote coefficients equal to the difference between the average brightness value and the brightness of the voting pixel is a statistical criterion for the separation of two simple statistical hypotheses known as the ‚ÄúMost Powerful‚Äù to separate two simple hypotheses about normal distribution with parameters (A, A) and parameters (-A, A). <br><br><h3>  Improving the voting scheme </h3><br>  We will continue to use the statistical criterion for separating two simple statistical hypotheses known as the ‚ÄúMost Powerful‚Äù, however, to calculate the probabilities, we use not the predetermined hypothesis about the normal distribution of the difference between the average brightness value and the brightness of the voting pixel, but the actual selective statistical information from the available data. <br>  Let be <br>  Pw (x) is the sample distribution of actually calculated values ‚Äã‚ÄãCw [i, j] -Mw [i, j], where Cw [i, j] is the pixel brightness value of the decoded graphic image and Mw [i, j] is the average brightness value of pixels around the pixel of the graphic being decoded mapped to the i-th bit of the decoded data x [i] and the j-th bit of the pseudo-random sequence y [j]. <br>  dCw = A * (p0-p1) = E Pw = SUM i * Pw (i) = AVG (Cw [i, j] -Mw [i, j]) is the sample mean value of the brightness shift in the blurred image <br>  Aw = SQRT (E Pw ^ 2 - (E Pw) ^ 2) = SQRT (SUM i ^ 2 * Pw (i) - (SUM i * Pw (i)) ^ 2) - the sample dispersion value of the brightness shift of the blurred image <br><br><h4>  Method 1 </h4><br>  We use the correction factor dCw when counting votes <br>  V [i] = SUM (Cw [i, j] -Mw [i, j] -dCw) (- 1) ^ y [j] <br><br><h4>  Method 2 </h4><br>  We will use the ‚ÄúMost Powerful‚Äù statistical criterion to separate two hypotheses with average values ‚Äã‚Äãabove and below dCw and distribution functions P1 and P2, such that P1 (dCw + x) = P0 (dCw-x) and P1xP0 = Pw ‚Äî where P1xP0 (t) = SUM P1 (i) * P0 (j) | i + j = t is the operation of convolution of two functions. <br><br>  Putting P1 (dCw + x) = P0 (dCw-x) = f (x), we recover the unknown distribution f (x) from its own convolution function fxf, <br>  We assume that for a known computed sampling distribution Pw (x), the equality fxf (x) = Pw (dCw + x) holds <br>  After the function f (x) is calculated, we will use the voting factors calculated by the formula -log (f (x-dCw) / f (x + dCw)) for voting <br><br><h2>  Formulas implemented in the library </h2><br><h3>  Formula for placing data in a graphic file </h3><br>  The formula for changing the brightness of pixels depending on the value of the i-th bit of the data x [i] and the j-th bit of the pseudo-random sequence y [j]: <br>  Cw [i, j] = C [i, j] + A * (- 1) ^ (x [i] xor y [j]) <br>  Where <br>  C [i, j] is the brightness value of a pixel of a graphic image associated with the i-th bit of data x [i] and the j-th bit of the pseudo-random sequence y [j] <br>  A = SQRT (AVG (C [i, j] -M [i, j]) ^ 2) <br><br><h3>  Formula for extracting data from a graphic file </h3><br>  When extracting data from the pixel brightness array, a weighted voting scheme is applied with coefficients equal to the difference between the average brightness value and the brightness of the voting pixel. <br>  V [i] = SUM (log (Pn (Cw [i, j] -Mw [i, j]) / Pn (Mw [i, j] -Cw [i, j])) (- 1) ^ y [ j] <br>  if V [i] &lt;0 then x [i] == 0 else x [i] == 1 <br>  Where <br>  Pn is the probability value of the statistics with a normal distribution, the average value and the variance value equal to A = SQRT (AVG (Cw [i, j] -Mw [i, j]) ^ 2) <br>  Cw [i, j] is the pixel brightness value of the decoded graphic image associated with the i-th bit of data x [i] and the j-th bit of the pseudo-random sequence y [j] <br>  Mw [i, j] - the value of the average brightness of pixels around a pixel of a decoded graphic image associated with the i-th bit of the data x [i] and the j-th bit of the pseudo-random sequence y [j] <br><br><h3>  Image size required </h3><br>  If a <br>  - L8 - the number of bits of data transmitted <br>  - N - the number of variable pixels for each transmitted bit <br>  then the required number of pixels in a graphic image must be at least L8 * N, that is, the inequality L8 * N&gt; = W * H * K must be satisfied, where W and H are the width and height of the graphic image, K is the number of color channels of the graphic image . <br><br><h2>  Implementation of the broadband signal method </h2><br>  - For generating a pseudo-random sequence and for generating indexes of positions, algorithms using user-defined data, called a steganographic key, are used to embed data bits in an image. <br>  ‚ÄúAlthough cryptographic algorithms are used for generating pseudo-random sequences and for generating indices, as algorithms with the most studied statistical properties, the broadband signal method is NOT ENCRYPTION, but is one of the methods of covert transmission of information, that is, the STEGANOGRAPHIC method. <br>  - The mean pixel brightness values ‚Äã‚Äãare obtained by applying a graphic blur filter to the incoming graphic image. <br><br><h2>  Additional options in the current library implementation </h2><br>  In addition to the broadband signal method itself, in the current implementation of the library, there are embedded algorithms with which <br>  - the original sample graphic image can be automatically scaled to a size sufficient to transfer all the necessary data <br>  - the required depth of immersion can be calculated automatically <br>  - the source data are texts of RTF format and can be compressed by data compression algorithm, <br>  - error correction codes can be added to the transmitted data, <br>  - sequences of bits can be placed in the image not sequentially, but in accordance with the selected bit allocation algorithm in the graphic file. <br>  - The parameters of the program algorithms can be embedded in the transmitted image as a barcode.  To generate a pseudo-random sequence and to generate indices for embedding data bits in an image, algorithms are used using a string entered by the user and called a steganographic key.  When transferring data, the steganographic key is transmitted along with the barcode. <br><br><h2>  Used software </h2><br>  - Microsoft Visual Studio 2013 C # - environment and programming language <br>  - EmguCV / OpenCV - C # / C ++ library of structures and algorithms for image processing <br>  - FFTWSharp / FFTW - C # / C ++ library that implements fast discrete Fourier transform algorithms <br>  - ZXing.Net - .Net library for processing bar codes <br>  - FFTTools - C # library that implements FFT algorithms for digital image processing <a href="https://github.com/dprotopopov/FFTTools">github.com/dprotopopov/FFTTools</a> <br><br><h2>  Screenshots of programs </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/3a9/c66/c07/3a9c66c078ddcb276542e9f00da869f0.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/f32/537/849/f325378499eacb843137ef4c23524349.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/f47/36b/b48/f4736bb482d4b75f816f433b5740e7d6.jpg" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/59f/689/2a7/59f6892a747b908f49e13b32b99f1f2e.jpg" alt="image"><br><br><h2>  Literature </h2><br>  - Vyacheslav Sergeevich Barsukov, Candidate of Technical Sciences.  Romantsov Andrey Petrovich.  COMPUTER STEGANOGRAPHY OF YESTERDAY, TODAY, TOMORROW.  Information security technologies of the 21st century.  Publication.  1998. <a href="http://www.ess.ru/sites/default/files/files/articles/1998/0405/1998_0405_03.pdf">www.ess.ru/sites/default/files/files/articles/1998/0405/1998_0405_03.pdf</a> <br>  - Dmitry Protopopov.  Fourier processing of digital images.  Internet publishing.  <a href="http://habrahabr.ru/post/265781/">habrahabr.ru/post/265781</a> <br><br>  Project Internet address: <a href="https://github.com/dprotopopov/mssove2">github.com/dprotopopov/mssove2</a> </div><p>Source: <a href="https://habr.com/ru/post/266087/">https://habr.com/ru/post/266087/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266077/index.html">Analysis of one of the VaultCrypt encryption modifications</a></li>
<li><a href="../266079/index.html">‚ÄúFortran - Alive and Alive‚Äù or ‚ÄúWhat‚Äôs new ifort‚Äôs grandfather‚Äù</a></li>
<li><a href="../266081/index.html">In the footsteps of Meteor, or cycling reactivity</a></li>
<li><a href="../266083/index.html">Restriction of memory available to the program</a></li>
<li><a href="../266085/index.html">We build real-time web applications with RethinkDB</a></li>
<li><a href="../266089/index.html">Linux container developers meeting</a></li>
<li><a href="../266091/index.html">We integrate Paypal payment into web-application</a></li>
<li><a href="../266093/index.html">Healthcare IT: or how to exceed the budget by 420%</a></li>
<li><a href="../266095/index.html">How many downloads do you need for the TOP-10 free games of the App Store</a></li>
<li><a href="../266097/index.html">Script to calculate the space occupied by Hyper-V virtual machines</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>