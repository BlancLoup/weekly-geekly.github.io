<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>X-Notifier. We write notification for tracker and dialogues on Khabarakhabr</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There is a good plugin for all popular browsers, X-Notifier . It allows you to receive notifications about new letters, messages, or about anything fr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>X-Notifier. We write notification for tracker and dialogues on Khabarakhabr</h1><div class="post__text post__text-html js-mediator-article"><img align="right" src="https://habrastorage.org/getpro/habr/post_images/471/55a/aab/47155aaab99765863efd7f63570cef2a.gif"><br>  There is a good plugin for all popular browsers, <a href="http://xnotifier.tobwithu.com/dp/">X-Notifier</a> .  It allows you to receive notifications about new letters, messages, or about anything from various services in one place.  For X-Notifier a <a href="http://xnotifier.tobwithu.com/scripts.php">lot of scripts are</a> written (Gmail, Yandex. Mail, Google+, Facebook, Twitter and others).  But still no one has written a script for Habr, it's time to fix this misunderstanding! <br><a name="habracut"></a><br><h5>  Introduction </h5><br>  The script created by the methods used in this post will most likely work in any browser for which this add-on exists.  The script written for Habr, tested only in Firefox and Google Chrome, in the latter it works with <a href="https://habr.com/ru/post/210020/">restrictions</a> .  Also at this stage is supported simultaneous work with only one account.  For those who do not want to read the article, but just want an alert, a <a href="https://habr.com/ru/post/210020/">link to the conclusion</a> . <br><br><h5>  Study goal </h5><br>  If we describe the process superficially, we need to do the following.  Send a request with the data for authorization, get cookies and from time to time get the page of an authorized user and parse the tracker and dialog counters.  Everything is extremely simple! <br>  Consider the authorization form on the page <a href="https://id.tmtm.ru/login/">https://id.tmtm.ru/login/</a> (extra details are removed): <br><div class="spoiler">  <b class="spoiler_title">The form</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/c61/b47/3e3/c61b473e36dc945fca41cf982e5788d2.jpg"><br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">novalidate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-remote</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"login_form"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"s-form login_form validateble"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/ajax/login/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"180351c318af67fa0ec59ecad9ebae72"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"state"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"habrahabr"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"consumer"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"s-field s-with-error"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-validate_url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/ajax/validate/email/"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email_field"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tabindex</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autofocus</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-required</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"E-mail"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"s-field s-with-error"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"password"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tabindex</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"password"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-required</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"s-field"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"captcha"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"recaptcha_challenge_field"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"recaptcha_challenge_field"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"recaptcha_response_field"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"recaptcha_response_field"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-required</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"  "</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autocomplete</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"off"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tabindex</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"icon_captcha"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"//www.google.com/recaptcha/api/challenge?k=6LftHuoSAAAAAORONRXn_6xb2f_QCtXqfbRPfY2e"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hidden"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"recaptcha"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"captcha_type"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  Here we see 3 visible fields for sending (email, password, recaptcha_response_field), everything is clear with them.  As well as 5 hidden (state, consumer, captcha, recaptcha_challenge_field, captcha_type).  The <code>state</code> field is a kind of unique identifier that is generated for each login, the <code>consumer</code> for us is a static value and is always equal to <code>habrahabr</code> , the <code>captcha</code> value is always empty, <code>recaptcha_challenge_field</code> unique captcha identifier, <code>captcha_type</code> always <code>recaptcha</code> . <br>  Everything is clear with the form, now let's go to the data for the counter.  This is a user panel. <br><div class="spoiler">  <b class="spoiler_title">Panel</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/a9f/ccf/d5c/a9fccfd5c303270e844d0ae63c16021d.jpg"><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"userpanel silver"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bottom"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://habrahabr.ru/tracker/"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"count"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://habrahabr.ru/tracker/"</span></span></span><span class="hljs-tag">&gt;</span></span>+2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://habrahabr.ru/conversations/"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://habrahabr.ru/users/BloodUnit/favorites/"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Everything is simple, we just need to go through the regular line, and grab the tracker and dialog counter if there are any. <br>  We proceed to the implementation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  API </h5><br>  The plugin has something like an API, but I could not find documentation for it, and most likely it does not exist.  The only thing that was found is a <a href="http://xnotifier.tobwithu.com/dp/node/875">note on</a> how to enable logs and a <a href="http://xnotifier.tobwithu.com/dp/node/7">small post</a> from the add-on developer, but it is only suitable for sites with simple authorization, habr is not one such  Therefore, I had to read the <a href="">source</a> and try, and try ... <br><br>  Consider the methods to be used. <br>  In total, we need 5 of them: <br><ul><li>  <i>init ()</i> - script initialization method, runs once at startup </li><li>  <i>getCount (aData)</i> is a method that accepts a string (usually HTML) and returns a counter.  If the counter&gt; = 0, the check was successful, otherwise the check ended with an error </li><li>  <i>checkLogin (aData, aHttp)</i> - checks the login status, aData string (usually HTML), aHttp <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest">XMLHttpRequest</a> object </li><li>  <i>process (aData, aHttp)</i> - the method is launched at each stage (below is a list) of the plug-in operation, aData data line (usually HTML), aHttp <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest">XMLHttpRequest</a> object </li><li>  <i>dlog (name, data)</i> - a method for writing to the log, takes two string parameters </li></ul><br>  The list of stages, the number is the sequence of execution: <br><ul><li>  <i>ST_CHECK = 0</i> - authorization check </li><li>  <i>ST_PRE = 100</i> - preparation for login </li><li>  <i>ST_PRE_RES = 101</i> - receiving a response from a query launched in the previous step </li><li>  <i>ST_LOGIN = 200</i> - login </li><li>  <i>ST_LOGIN_RES = 201</i> - receive a response from a query launched in the previous step </li><li>  <i>ST_DATA = 300</i> - request data for processing, for example, counting unread messages </li><li>  <i>ST_DATA_RES = 301</i> - receiving a response from a query launched in the previous step </li></ul><br>  Some steps, for example, such as ST_LOGIN are implemented by a plugin and are suitable for most sites with simple authorization, but you can override them, which we will do. <br><br><h5>  We write </h5><br>  First we need to initialize the script.  Here we will set some static parameters and the stage from which the script will be executed. <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.initStage = ST_PRE; <span class="hljs-comment"><span class="hljs-comment">//  ,    ST_LOGIN,       ,     this.loginData = ["https://id.tmtm.ru/ajax/login/", "email", "password", "consumer=habrahabr&amp;captcha_type=recaptcha&amp;captcha="]; //    URL   ,      name   e-mail  ,    this.dataURL = "http://habrahabr.ru/"; // URL   this.viewURL = "http://habrahabr.ru/tracker/"; // URL      this.cookieDomain = "habrahabr.ru"; //       }</span></span></code> </pre><br></div></div><br>  The next step is authorization, all stages are arranged in chronological order: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">aData, aHttp</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stage) { <span class="hljs-comment"><span class="hljs-comment">/*    ,     state */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ST_PRE: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getHtml(<span class="hljs-string"><span class="hljs-string">"https://auth.habrahabr.ru/login/"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    ,  state     recaptcha,        */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ST_PRE_RES: <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> recaptchaScriptLink = aData.match(<span class="hljs-regexp"><span class="hljs-regexp">/(\/\/www.google.com\/recaptcha\/api\/challenge\S+?)"/</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> state = aData.match(<span class="hljs-regexp"><span class="hljs-regexp">/state=([\w\n]+)/</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (recaptchaScriptLink &amp;&amp; state) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.originPostData = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginData[LOGIN_POST]; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginData[LOGIN_POST] += <span class="hljs-string"><span class="hljs-string">"&amp;state="</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(state[<span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.referer = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginData[LOGIN_URL] + <span class="hljs-string"><span class="hljs-string">"?"</span></span> + <span class="hljs-string"><span class="hljs-string">"&amp;state="</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(state[<span class="hljs-number"><span class="hljs-number">1</span></span>]) + <span class="hljs-string"><span class="hljs-string">"&amp;consumer=habrahabr"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getHtml(<span class="hljs-string"><span class="hljs-string">"https:"</span></span> + recaptchaScriptLink[<span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onError(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*          */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ST_PRE_RES + <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> recaptchaUid = aData.match(<span class="hljs-regexp"><span class="hljs-regexp">/challenge\s*:\s*'(\S+?)'/</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (recaptchaUid) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginData[LOGIN_POST] += <span class="hljs-string"><span class="hljs-string">"&amp;recaptcha_challenge_field="</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(recaptchaUid[<span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.openCaptchaDialog(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.user, <span class="hljs-string"><span class="hljs-string">"https://www.google.com/recaptcha/api/image?c="</span></span> + recaptchaUid[<span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onError(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*       */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ST_PRE_RES + <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginData[LOGIN_POST] += <span class="hljs-string"><span class="hljs-string">"&amp;recaptcha_response_field="</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(aData); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stage = ST_LOGIN; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.process(aData, aHttp); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ST_LOGIN: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getHtml(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginData[LOGIN_URL], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginData[LOGIN_POST], { <span class="hljs-attr"><span class="hljs-attr">Referer</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.referer }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*            */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ST_LOGIN_RES: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginData[LOGIN_POST] = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.originPostData; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> habrRedirectLink = aData.match(<span class="hljs-regexp"><span class="hljs-regexp">/'(.*?)'/</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (habrRedirectLink) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getHtml(habrRedirectLink[<span class="hljs-number"><span class="hljs-number">1</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stage = ST_DATA; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.baseProcess(aData, aHttp); }</code> </pre><br></div></div><br>  There are a few points. <br><ul><li>  Javascript in the context of the plugin is not executed, so we need to do extra gestures to get the link to the captcha </li><li>  If the stage returns <code>false</code> , the sequence value will be incremented. </li><li>  The data that returns <code>this.getHtml</code> and <code>this.openCaptchaDialog</code> methods will be passed to the next stage. </li><li><a name="restrictions"></a>  At the <code>ST_LOGIN</code> stage, we need to set the Referer value, otherwise authorization will not pass.  Google Chrome does not allow setting this parameter (and this is the <a href="http://www.w3.org/TR/XMLHttpRequest/">standard</a> , albeit in Working Draft), respectively, authorization <b>via the plugin</b> will not work in it, but if you are logged in, everything will work fine! </li><li>  At the <code>ST_LOGIN</code> stage, Habr returns a script with a redirect to the main one that looks like this: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location.href = <span class="hljs-string"><span class="hljs-string">'https://habrahabr.ru/ac/entrance/?token=5a15a5d48c7fdeaed5ab20e852107dc6&amp;state=26593fdea0963d8241aab3f20a6893b4&amp;time=1390388377&amp;sign=bb8f45d63c768ed6aebc5ae2bb22de3b'</span></span>;</code> </pre><br></div></div><br></li></ul><br>  The implementation of the login method is very simple: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkLogin</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">aData, aHttp</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stage) { <span class="hljs-comment"><span class="hljs-comment">/*  HTML   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ST_CHECK: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getHtml(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dataURL); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*     ,   ,  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> ST_CHECK + <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loginLink = aData.match(<span class="hljs-regexp"><span class="hljs-regexp">/&lt;a.+?class="login"/</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!loginLink) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stage = ST_DATA; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.getHtml(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.dataURL); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.stage = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.initStage; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.process(<span class="hljs-string"><span class="hljs-string">""</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onError(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; }</code> </pre><br></div></div><br>  And finally, the last method, parsing counters: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCount</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">aData</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> userMenu = aData.match(<span class="hljs-regexp"><span class="hljs-regexp">/userpanel[\s\S]*?charge_string/</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!userMenu) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> counterRegex = <span class="hljs-regexp"><span class="hljs-regexp">/class="count"[^&gt;]*&gt;\+?(\d*)/g</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> counterResult; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((counterResult = counterRegex.exec(userMenu[<span class="hljs-number"><span class="hljs-number">0</span></span>])) !== <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { counter += +counterResult[<span class="hljs-number"><span class="hljs-number">1</span></span>] || <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> counter; } }</code> </pre><br></div></div><br>  There‚Äôs nothing much to explain here, just select the values ‚Äã‚Äãwith regular expressions, and return the result. <br><br><h5>  Conclusion </h5><br>  In this post, an example was shown how to write a simple script to check the site for new messages.  Following these rules, you can write a script for almost any site.  Some scripts will be much easier to write, especially if the site has a simple authorization scheme (for example, the script for Yandex.Mail works in 30 lines). <br><a name="download"></a><br><img align="left" src="https://habrastorage.org/getpro/habr/post_images/cdc/057/26e/cdc05726e33ce0c61da511d13a69eab9.jpg"><br>  <i>The ready script for Habr can be downloaded from the <a href="http://xnotifier.tobwithu.com/scripts.php%3Fkey%3Dname%26dir%3D1%26page%3D2">scripts page for X-Notifier</a> or taken <a href="https://github.com/olsh/XNotifier-Habrahabr">on GitHub</a></i> .  Forks and pull requests are welcome. <br>  <a href="http://xnotifier.tobwithu.com/dp/">Add-on page</a> . </div><p>Source: <a href="https://habr.com/ru/post/210020/">https://habr.com/ru/post/210020/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210010/index.html">How internet addicts are treated in China: a New York Times report</a></li>
<li><a href="../210012/index.html">Free programs: dangers and charms</a></li>
<li><a href="../210014/index.html">Epilogue stories with "spying" smart TVs LG</a></li>
<li><a href="../210016/index.html">A supernova was discovered in the neighboring galaxy M82. Blast after 2 weeks</a></li>
<li><a href="../210018/index.html">European Space Agency ESA presented a video of the awakening of the interplanetary probe "Rosette"</a></li>
<li><a href="../210022/index.html">Server on ARM? Made in Russia!</a></li>
<li><a href="../210024/index.html">Programmer as a source of evil and the impact of robotics on society</a></li>
<li><a href="../210026/index.html">CCNP Security ver. 2014</a></li>
<li><a href="../210030/index.html">We had 540 points, 120 merchandisers, 30 TPs, 2 supervisors, 5 tables in XLS and one package for the routing software</a></li>
<li><a href="../210032/index.html">We collect and analyze statistics in mobile applications</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>