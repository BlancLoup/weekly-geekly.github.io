<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Async / await: 6 reasons to forget about promises</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you do not know, in Node.js, starting from version 7.6, support for the async / await mechanism is built in. They talk about it, of course, for a l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Async / await: 6 reasons to forget about promises</h1><div class="post__text post__text-html js-mediator-article">  If you do not know, in Node.js, starting from version 7.6, support for the async / await mechanism is built in.  They talk about it, of course, for a long time, but it‚Äôs one thing when ‚Äúcrutches‚Äù are needed to use some functionality, and quite another when it all goes, as they say, ‚Äúout of the box.‚Äù  If you have not tried async / await yet, be sure to try. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ae7/b03/b42/ae7b03b4215d166e5bbe478e3c05d818.gif" alt="image"></div><br>  Today we will look at the six features of async / await, which make it possible to assign a new approach to writing asynchronous code to the category of tools that you should learn and use wherever possible, replacing what was before with them. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Basics of async / await</font> </h2><br>  For those who are not familiar with async / await, here are the basic things that will be useful to know before moving on. <br><br><ul><li>  Async / await is a new way to write asynchronous code.  Previously, a similar code was written using callbacks and promises. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </li><li>  Our proposal to ‚Äúforget about promises‚Äù does not mean that they have lost their relevance in the light of new technology.  In fact, async / await is based on promises.  It should be borne in mind that this mechanism cannot be used with callbacks. <br><br></li><li>  Constructions built using async / await, like promises, do not block the main thread of program execution. <br><br></li><li>  Thanks to async / await, the asynchronous code becomes similar to synchronous, and in its behavior features of such code appear, which are very useful in some situations in which it was, for various reasons, inconvenient to use promises.  But earlier it was impossible to do without them.  Now everything has changed.  This is where the power of async / await lies. <br></li></ul><br><h2>  <font color="#3AC1EF">Syntax</font> </h2><br>
,      <code>getJSON</code>,   ,      JSON-.     ,    JSON-   <code>done</code>.<br>
<br>
      :<br>
<br>
<pre><code>const makeRequest = () =&gt;
 &nbsp;getJSON()
 &nbsp;&nbsp;&nbsp;.then(data =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(data)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return "done"
 &nbsp;&nbsp;&nbsp;})

makeRequest()</code></pre><br>
        async/await:<br>
<br>
<pre><code>const makeRequest = async () =&gt; {
 &nbsp;console.log(await getJSON())
 &nbsp;return "done"
}

makeRequest()</code></pre><br>
     ,   :<br>
<br>
<ol>
<li>      <code>async</code>.   <code>await </code>     ,    <code>async</code>.      ,  ,     ,  ,    <code>return</code>,      <code>done</code>.<br>
<br>
</li>
<li> ,    <code>await</code>    async-,    .<br>
<br>
<pre><code>//         
// await makeRequest()

//   - 
makeRequest().then((result) =&gt; {
 &nbsp;// do something
})</code></pre><br>
</li>
<li> <code>await getJSON()</code> ,   <code>console.log</code>     <code>getJSON()</code>,    ,   .<br>
</li>
</ol><br>
<h2><font color="#3AC1EF"> async/await  ?</font></h2><br>
    async/await   .<br>
<br>
<h3><font color="#3AC1EF">‚ñç1.    </font></h3><br>
   ,    ,  ,   async/await, .   ,   ,     ,      ,    .    ,     <code>.then</code>,      ,        <code>data</code>,  ,  ,  .  ,     .      ,     .<br>
<br>
<h3><font color="#3AC1EF">‚ñç2.  </font></h3><br>
 async/await                ‚Äî   <code>try/catch</code>.      <code>try/catch</code>   ,    <code>JSON.parse</code>,      .        <code>.catch()</code>        .           <code>console.log</code>  .<br>
<br>
<pre><code>const makeRequest = () =&gt; {
 &nbsp;try {
 &nbsp;&nbsp;&nbsp;getJSON()
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.then(result =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//  JSON   
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const data = JSON.parse(result)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(data)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//       
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// .catch((err) =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// &nbsp;&nbsp;console.log(err)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// })
 &nbsp;} catch (err) {
 &nbsp;&nbsp;&nbsp;console.log(err)
 &nbsp;}</code></pre><br>
   ,    async/await.  <code>catch</code>     ,    JSON.<br>
<br>
<pre><code>const makeRequest = async () =&gt; {
 &nbsp;try {
 &nbsp;&nbsp;&nbsp;//  JSON   
 &nbsp;&nbsp;&nbsp;const data = JSON.parse(await getJSON())
 &nbsp;&nbsp;&nbsp;console.log(data)
 &nbsp;} catch (err) {
 &nbsp;&nbsp;&nbsp;console.log(err)
 &nbsp;}
}</code></pre><br>
<h3><font color="#3AC1EF">‚ñç3.      </font></h3><br>
,     , ,   ,    ,      , ,   ,   ,   -.     :<br>
<br>
<pre><code>const makeRequest = () =&gt; {
 &nbsp;return getJSON()
 &nbsp;&nbsp;&nbsp;.then(data =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (data.needsAnotherRequest) {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return makeAnotherRequest(data)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.then(moreData =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(moreData)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return moreData
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;console.log(data)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return data
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
 &nbsp;&nbsp;&nbsp;})
}</code></pre><br>
        .       (  6 ), ,  ,     ,      .<br>
<br>
    ,      async/await.<br>
<br>
<pre><code>const makeRequest = async () =&gt; {
 &nbsp;const data = await getJSON()
 &nbsp;if (data.needsAnotherRequest) {
 &nbsp;&nbsp;&nbsp;const moreData = await makeAnotherRequest(data);
 &nbsp;&nbsp;&nbsp;console.log(moreData)
 &nbsp;&nbsp;&nbsp;return moreData
 &nbsp;} else {
 &nbsp;&nbsp;&nbsp;console.log(data)
 &nbsp;&nbsp;&nbsp;return data &nbsp;&nbsp;&nbsp;
 &nbsp;}
}</code></pre><br>
<h3><font color="#3AC1EF">‚ñç4.  </font></h3><br>
,    ,    <code>promise1</code>,   ,   ,   <code>promise2</code>,           <code>promise3</code>.     ,   .<br>
<br>
<pre><code>const makeRequest = () =&gt; {
 &nbsp;return promise1()
 &nbsp;&nbsp;&nbsp;.then(value1 =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// do something
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return promise2(value1)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.then(value2 =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// do something &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return promise3(value1, value2)
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;})
}</code></pre><br>
  <code>promise3</code>   <code>value1</code>,       ,       ,   .      <code>value1</code>  <code>value2</code>   <code>Promise.all</code>     .<br>
 <br>
<pre><code>const makeRequest = () =&gt; {
 &nbsp;return promise1()
 &nbsp;&nbsp;&nbsp;.then(value1 =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// do something
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return Promise.all([value1, promise2(value1)])
 &nbsp;&nbsp;&nbsp;})
 &nbsp;&nbsp;&nbsp;.then(([value1, value2]) =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// do something &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return promise3(value1, value2)
 &nbsp;&nbsp;&nbsp;})
}</code></pre><br>
        .    ,   <code>value1</code>  <code>value2</code>         ,    .<br>
<br>
       async/await,     ,  ,  ,   .     ,       ,      -     .<br>
<br>
<pre><code>const makeRequest = async () =&gt; {
 &nbsp;const value1 = await promise1()
 &nbsp;const value2 = await promise2(value1)
 &nbsp;return promise3(value1, value2)
}</code></pre><br>
<h3><font color="#3AC1EF">‚ñç5.  </font></h3><br>
   ,      ,  -     .<br>
<br>
<pre><code>const makeRequest = () =&gt; {
 &nbsp;return callAPromise()
 &nbsp;&nbsp;&nbsp;.then(() =&gt; callAPromise())
 &nbsp;&nbsp;&nbsp;.then(() =&gt; callAPromise())
 &nbsp;&nbsp;&nbsp;.then(() =&gt; callAPromise())
 &nbsp;&nbsp;&nbsp;.then(() =&gt; callAPromise())
 &nbsp;&nbsp;&nbsp;.then(() =&gt; {
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw new Error("oops");
 &nbsp;&nbsp;&nbsp;})
}

makeRequest()
 &nbsp;.catch(err =&gt; {
 &nbsp;&nbsp;&nbsp;console.log(err);
 &nbsp;&nbsp;&nbsp;// 
// Error: oops at callAPromise.then.then.then.then.then (index.js:8:13)</code></pre><br>
 ,    ,     ,    .  ,             .   ,     ‚Äî <code>callAPromise</code>,        (, ,      ‚Äî   ,   ,    ).<br>
<br>
        async/await,      ,    .<br>
<br>
<pre><code>const makeRequest = async () =&gt; {
 &nbsp;await callAPromise()
 &nbsp;await callAPromise()
 &nbsp;await callAPromise()
 &nbsp;await callAPromise()
 &nbsp;await callAPromise()
 &nbsp;throw new Error("oops");
}

makeRequest()
 &nbsp;.catch(err =&gt; {
 &nbsp;&nbsp;&nbsp;console.log(err);
 &nbsp;&nbsp;&nbsp;// 
 &nbsp;&nbsp;&nbsp;// Error: oops at makeRequest (index.js:7:9)
 &nbsp;})</code></pre><br>
    ,        ,       .     ,      ,  -,   -.    ,     <code>makeRequest</code>, ,  ,    ‚Äî  <code>then</code>,     <code>then</code>,     - <code>then</code>‚Ä¶<br>
<br>
<h3><font color="#3AC1EF">‚ñç6. </font></h3><br>
  ,    ,     .    async/await   ,  ,     ,   .        .<br>
<br>
<b>1.</b>       ,      (  ).<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/359/313/003/359313003f1a22441abbe5616ad2771c.png"></div><br>
<i><font color="#999999">  -     </font></i><br>
<br>
<b>2.</b>        <code>.then</code>      ¬´  ¬ª (step-over),      <code>.then</code>,     ¬´¬ª     .<br>
<br>
  async/await      ,   ¬´¬ª  ,     <code>await </code>  ,       .<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/66b/942/4d2/66b9424d23323d4dee9cb5c93e21c368.png"></div><br>
<i><font color="#999999">   async/await</font></i><br>
<br>
<h2><font color="#3AC1EF"></font></h2><br>
 ,          async/await,   .    .<br>
<br>
<ul>
<li><b>      .</b> ,  ,  ,     ,     <code>.then</code>,      ,       async/await. , ,  C#      ,  ,    , ,          .<br>
 <br>
</li>
<li><b>Node 7 ‚Äî  LTS-.</b>  ,     Node 8,      , ,    .<br>
</li>
</ul><br>
<h2><font color="#3AC1EF"></font></h2><br>
, async/await ‚Äî       ,   JavaScript    .           . , async/await  ,     .<br>
<br>
 !     async/await?        ?</div><p>Source: <a href="https://habr.com/ru/post/326074/">https://habr.com/ru/post/326074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../326062/index.html">Improving the reliability of Kubernetes: how to quickly notice that the node fell</a></li>
<li><a href="../326064/index.html">Courses Computer Science Club, spring 2017</a></li>
<li><a href="../326068/index.html">How to write TK on the system or revision of the 1C system</a></li>
<li><a href="../326070/index.html">Cat Discrimination: Web Tracking Through Invisible Pictures</a></li>
<li><a href="../326072/index.html">Integration of 3CX with Bitrix24 - free CRM plugin</a></li>
<li><a href="../326076/index.html">Mikrotik 6to4 automation with dynamic IPv4</a></li>
<li><a href="../326078/index.html">MASM, TASM, FASM, NASM for Windows and Linux</a></li>
<li><a href="../326080/index.html">Future API</a></li>
<li><a href="../326082/index.html">Huawei HyperMetro - tested and implemented</a></li>
<li><a href="../326084/index.html">Audit of current vulnerabilities without registration and SMS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>