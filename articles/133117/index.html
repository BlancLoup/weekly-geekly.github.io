<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Work with the SharePoint Foundation REST Interface using OData and jQuery</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Web services in our time are becoming very popular. And this is understandable, they are universal. On their basis, you can write a cross-platform mob...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Work with the SharePoint Foundation REST Interface using OData and jQuery</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/13da9e08/98f099fb/b9ac6851/b138fd14.png" align="left"><br>  Web services in our time are becoming very popular.  And this is understandable, they are universal.  On their basis, you can write a cross-platform mobile application in HTML5, make a gadget for the Windows 7 desktop, or simply bring to the site a list of the latest news. <br><br>  I would like to demonstrate how you can combine modern technologies, such as REST service, OData and jQuery, with SharePoint 2010 through its standard RESTful interface using the example of creating a small web part to search and view data about company employees.  The main feature of my example is the absence of server-side programming. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  SharePoint Foundation REST Interface </h4><br>  The SharePoint Foundation REST Interface is a new service that appeared in Microsoft SharePoint 2010. <br><br>  The basic concept of this web service is that all lists and elements of SharePoint are represented as HTTP resources and are accessible remotely by URL.  This is a full RESTful service.  It has a standard set of operations: read, write, edit, and delete.  The format of data output is possible both XML, and JSON.  The web service supports the <a href="http://www.odata.org/">Open Data Protocol</a> , which I will discuss below. <br>  Due to all these possibilities, high flexibility and compatibility of the web service with any applications that can make HTTP requests is achieved. <br><br>  My acquaintance with the SharePoint Foundation REST Interface happened relatively recently, but it immediately became clear how convenient it was to use it.  I regretted not knowing about him before.  Of course, this is not a tool for all occasions, but sometimes it makes life much easier. <br><br>  The SharePoint Foundation REST Interface is available at: <br><br> <code>http://{server_name}/_vti_bin/listdata.svc</code> <br> <br>  You can use it immediately after installing Microsoft SharePoint Foundation 2010. It does not require any additional settings. <br><br>  Following the link, you will see XML with all the available lists and libraries in SharePoint, both standard and created by the administrator. For example, the list of users is available at the URL: <br><br> <code>http://{server_name}/_vti_bin/listdata.svc/UserInformationList</code> <br> <br><h4>  Open data protocol </h4><br>  Open Data Protocol is an open web protocol for querying and updating data.  The protocol allows you to perform operations with resources using HTTP commands as requests and receive responses in JSON or XML formats. <br><br>  After receiving a list of users from the web service, you will notice that it returns not only users, but also groups.  They differ in the value of the ContentType element.  ContentType users have the value ‚ÄúPerson‚Äù.  Now, in order to filter only users, we will use the opportunity of a web service to work with OData.  You need to add the $ filter variable to the URI: <br><br> <code>http://{server_name}/_vti_bin/listdata.svc/UserInformationList?$filter=ContentType eq 'Person'</code> <br> <br>  As a result, we get a list of all users. <br><br>  The web part also uses dynamic substitution of usernames as you type.  Therefore, you need to search including the user name and sort by it.  Complicate the filtering condition: <br><br> <code>http://{server_name}/_vti_bin/listdata.svc/UserInformationList?$filter=((ContentType eq 'Person') and (substringof(Name,'{query}')))&amp;$orderby=Name</code> <br> <br>  Now in the results of the sample there are only users whose name contains the substring {query}. <br><br>  As you will see, the web service returns a lot of information that is not always needed.  Therefore, the size of the resulting file can be reduced by specifying which fields we want to receive.  To do this, add the $ select variable: <br><br> <code>http://{server_name}/_vti_bin/listdata.svc/UserInformationList?$filter=((ContentType eq 'Person') and (substringof(Name,'{query}')))&amp;$orderby=Name&amp;$select=Id,Name,ContentType</code> <br> <br>  Now the resulting file contains only three fields that we specified. <br><br>  Well, I wasn‚Äôt talking about flexibility for good reason; a query with OData parameters can be anything complicated.  So, at no cost, you can get data from any SharePoint sheet or library, whether it is news, a list of documents or anything else. <br><br>  As I said at the very beginning, the SharePoint Foundation REST Interface allows you not only to receive data, but also to add, edit, and delete it.  You can read more about how this can be done and other features of the Open Data Protocol here: <br><br>  <a href="http://www.odata.org/developers/protocols/operations">http://www.odata.org/developers/protocols/operations</a> <br><br><h4>  No C #, use jQuery </h4><br>  Let's move on to the private use of the web service.  Let's build a small web part based on it. <br><br>  Schematically, the web part will look like this: <br><br><h6>  Initial state </h6><br><img src="https://habrastorage.org/storage1/3cd455c4/4e1d40ca/9479d3e3/3652090c.png"><br><br><h6>  We start to enter the username </h6><br><img src="https://habrastorage.org/storage1/6c16c44e/ad478980/c4bc8054/49591407.png"><br><br><h6>  User selected </h6><br><img src="https://habrastorage.org/storage1/2ec51363/53ac8724/df480b56/7258abaf.png"><br><br>  As mentioned earlier, we will not program anything on the server.  Everything goes to the client side and will be executed using jQuery and $ .ajax ().  Of course, one cannot do without creating a project in a studio and deployment, but the involvement of a specialized programmer is not required and can be managed by any web developer. <br><br>  Create a web part project and add all the necessary files to it: <br><br><h6>  Create a web part </h6><br><img src="https://habrastorage.org/storage1/3fa97545/b01e9a04/942d23dd/5efa3633.png"><br><br><h6>  This is the structure of the project with all the files. </h6><br><img src="https://habrastorage.org/storage1/931f8be0/20cb03cb/ede18992/526b1d9d.png"><br><br>  Now you need to connect the css and JavaScript files to the ascx control.  Open EmployeesWebPartUserControl.ascx and paste the code: <br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//  css  jQuery Autocomplete &lt;SharePoint:CssRegistration ID="jquery_autocomplete" Name="/_layouts/EmployeesWebPart/css/jquery.autocomplete.css" After="corev4.css" runat="server" /&gt; //  css ,        - &lt;SharePoint:CssRegistration ID="webpart_base" Name="/_layouts/EmployeesWebPart/css/webpart.css" After="corev4.css" runat="server" /&gt; //  javascripts &lt;script src="/_layouts/EmployeesWebPart/js/webpart.include.js" type="text/javascript"&gt;&lt;/script&gt;</span></span></code> </pre><br>  Insert the HTML part of the web part into this file: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_search"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Search users as you type..."</span></span></span><span class="hljs-tag"> /&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_image"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> /&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_name"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_position"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_departament"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_status"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>Ask me about:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_asklist"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_phone"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>Mobile:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wpuser_email"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>Email:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  This can be said to be the template of our web part.  In empty divs with jQuery, we will enter the values ‚Äã‚Äãobtained through $ .ajax (); <br><br>  Actually, we finished the preparations, now we can proceed to writing the code itself. <br><br>  The way to get the list of users is simple and clear: <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// URL -    var serviceUrl = "/_vti_bin/listdata.svc/UserInformationList?$filter=ContentType eq 'Person'&amp;$orderby=Name"; //   $.ajax({ 'type': 'GET', 'url': serviceUrl, 'dataType': 'json', 'success': function(data){ userSearch(data['d']['results']); } });</span></span></code> </pre><br>  Do not forget to add a parameter: <br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'dataType'</span></span>: <span class="hljs-string"><span class="hljs-string">'json'</span></span></code> </pre><br>  Without it, the web service will return XML instead of JSON. <br><br>  In fact, I <a href="http://docs.jquery.com/Plugins/autocomplete">cheated a</a> little and used the <a href="http://docs.jquery.com/Plugins/autocomplete">jQuery Autocomplete plugin</a> <br><br>  This plugin can take values ‚Äã‚Äãnot only in the form of a ready-made array of elements, but it can also handle the URL of the service itself, which returns JSON.  Unfortunately, I could not get it to work directly with the SharePoint web service.  The plugin gave some error when parsing the data, but I was too lazy to figure out what the problem was.  In addition, it seemed to me best to load the entire list of users at once, and not to wait for a response from the server after each entered letter.  Yes, and frequent requests to the server to anything.  Therefore, my decision was as follows: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">userSearch</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ $field = $(<span class="hljs-string"><span class="hljs-string">"#wpuser_search"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    $field.autocomplete(data, { formatItem: function (item) { return item.Name }, matchContains: true }); $field.result(function (event, data, formatted) { userShowInfo(data); }); }</span></span></code> </pre><br>  The auto-substitute field is ready.  It remains to show the remaining information about the user: <br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showUserInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// name $("#wpuser_name").text(data.Name); // email $("#wpuser_email a").text(data.WorkEMail).attr('href', 'mailto:' + data.WorkEMail); // phone $("#wpuser_phone a").text(data.MobilePhone).attr('href', 'callto:' + data.MobilePhone); // departament $("#wpuser_departament").text(data.Department); // picture $("#wpuser_image img").attr('src', data.Picture.split(", ")[0]); // position $("#wpuser_position").text(data.Title); // ask me abolut list $("#wpuser_asklist").text(data.AskMeAbout); }</span></span></code> </pre><br>  The function will fill our template with data from the web service. <br><br>  That's all.  As promised, no server-side programming was used in the development process.  I simplified the code in order to make it as short and clear as possible.  Immediately I will say that you need to take into account the path to the site collection and the path to the sub-site, where the page with the web part lies.  This is necessary in order to form the path to the web service from exactly the same collection and the same sub-site. <br><br>  I hope getting to know the SharePoint Foundation REST Interface was enjoyable, and you can use it correctly in your projects.  Good luck! <br><br>  The whole project can be downloaded here: <br><br>  SVN <a href="http://users-list-webpart.googlecode.com/svn/trunk/">http://users-list-webpart.googlecode.com/svn/trunk/</a> <br><br>  Additional links: <br><ul><li>  Microsoft SharePoint 2010: <a href="http://sharepoint.microsoft.com/">sharepoint.microsoft.com</a> </li><li>  SharePoint Foundation REST Interface: <a href="http://msdn.microsoft.com/en-us/library/ff521587.aspx">msdn.microsoft.com/en-us/library/ff521587.aspx</a> </li><li>  Open Data Protocol: <a href="http://odata.org/">odata.org</a> </li><li>  What is a RESTful service: <a href="http://ru.wikipedia.org/wiki/REST">ru.wikipedia.org/wiki/REST</a> </li><li>  jQuery asynchronous HTTP (Ajax) request: <a href="http://api.jquery.com/jQuery.ajax/">api.jquery.com/jQuery.ajax</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/133117/">https://habr.com/ru/post/133117/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../133107/index.html">Openflow for dummies</a></li>
<li><a href="../133108/index.html">On one problem of running Backup and Restore when using OpenSource code from CodeGuru site</a></li>
<li><a href="../133111/index.html">Search for volunteer guides</a></li>
<li><a href="../133115/index.html">Adobe will release Flash for Android 4.0 Ice Cream Sandwich by the end of the year.</a></li>
<li><a href="../133116/index.html">DYN also against SOPA</a></li>
<li><a href="../133124/index.html">In the Runet will control the content of the sites</a></li>
<li><a href="../133126/index.html">Introduction to Qt Quick3D</a></li>
<li><a href="../133129/index.html">JSZip Create .zip files</a></li>
<li><a href="../133130/index.html">Everything you wanted to know about ezines</a></li>
<li><a href="../133132/index.html">Solutions for data centers: StruxureWare Central software and hardware</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>