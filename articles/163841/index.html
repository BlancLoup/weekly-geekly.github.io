<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Display generated on the fly html pages without saving to the clipboard or file system</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Often, when developing, the programmer raises the question of displaying the results of work to the user in a form convenient for him. The benefit of ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Display generated on the fly html pages without saving to the clipboard or file system</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/storage2/762/7a1/b51/7627a1b5160db795f0640acbb3c4a0bb.png">  Often, when developing, the programmer raises the question of displaying the results of work to the user in a form convenient for him.  The benefit of the options for implementing the output of information is myriad.  So, one of them is a web page, as a very flexible solution that allows you to format data in any form. <br><br>  However, at times, a seemingly simple problem becomes complicated by some limitations.  For example, due to lack of access rights, a situation may arise when the file system cannot be used.  In other words, the results can not be saved to a file.  And the use of the clipboard can lead to the destruction of important information stored in it. <br><br>  How to show the user html page that does not have a local view under the cat. <br><a name="habracut"></a><br>  The solution to the problem will be considered in C #.  Using the following Active-X libraries from the Windows / System32 / folder: <br><ul><li>  Microsoft HTML Viewer (mshtml.dll) - for object-oriented work with DHTML web page elements; </li><li>  Shell Doc Object and Control Library (SHDocVw.dll) - to perform basic operations with local and Internet resources. </li></ul><br>  With the first one we will generate the page itself, and the second will open it in the Internet Explorer browser.  The main reason for using IE is the presence of it on almost any computer. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  main idea </h4><br>  In any browser there are pages like about: ***, they are not stored locally, but are generated from the template when opened.  For example, having written ‚Äúabout: InPrivate‚Äù to the IE address bar, a service page will open, informing you that you have entered private browsing mode. <br><br><img src="https://habrastorage.org/storage2/dd5/caf/3c7/dd5caf3c7733f883912860c9ae647f69.png"><br><br>  In order to understand how this mechanism works, let us turn to the Windows registry.  To do this, use the standard Registry Editor program (Run -&gt; regedit).  Open the path HKEY_LOCAL_MACHINE / SOFTWARE / Microsoft / Internet Explorer / AboutURLs.  Here it is looking for a browser template for the page, the link to which we indicated after the word about. <br><br><img src="https://habrastorage.org/storage2/1e9/bbe/48b/1e9bbe48b6c20325e491ce4c2b266657.png"><br><br>  As you can see, under the mask ‚Äúabout: InPrivate‚Äù hides the address of the location of that very page: res: //iframe.dll/inprivate.htm.  It follows that the desired page is in the resources of the ieframe.dll library.  (Read more about Dll resources and how to create them, you can read on <a href="http://msdn.microsoft.com/ru-ru/library/e9zazcx5.aspx">MSDN</a> ) <br><br><h4>  Implementation </h4><br><pre><code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ie = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InternetExplorer(); ie.Navigate(@<span class="hljs-string"><span class="hljs-string">"about:blank"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-built_in"><span class="hljs-built_in">document</span></span> = ie.Document; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.open(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> element = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"body"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nodeBody = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.ImportNode(element, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.appendChild(nodeBody); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> stringBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); stringBuilder.Append(<span class="hljs-string"><span class="hljs-string">"&lt;div id=\"Content\" style=\" "</span></span> + <span class="hljs-string"><span class="hljs-string">"font-family:Segoe UI; "</span></span> + <span class="hljs-string"><span class="hljs-string">"text-align:center; "</span></span> + <span class="hljs-string"><span class="hljs-string">"width:500px; "</span></span> + <span class="hljs-string"><span class="hljs-string">"border:1px solid black; "</span></span> + <span class="hljs-string"><span class="hljs-string">"float:left; "</span></span> + <span class="hljs-string"><span class="hljs-string">"padding-bottom:10px;"</span></span> + <span class="hljs-string"><span class="hljs-string">"margin: 5px auto;\"&gt;"</span></span> ); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.insertAdjacentHTML(<span class="hljs-string"><span class="hljs-string">"beforeEnd"</span></span>, stringBuilder.ToString()); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> content = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"Content"</span></span>); stringBuilder.Clear(); stringBuilder.Append(<span class="hljs-string"><span class="hljs-string">"&lt;h1&gt;      IE &lt;/h1&gt;"</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;h3&gt;          &lt;/h3&gt;&lt;br/&gt;"</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;hr style=\"width:100px;\"/&gt;&lt;br/&gt;"</span></span> + <span class="hljs-string"><span class="hljs-string">"&lt;p&gt; , ! &lt;/p&gt;"</span></span> ); content.insertAdjacentHTML(<span class="hljs-string"><span class="hljs-string">"beforeEnd"</span></span>, stringBuilder.ToString()); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.insertAdjacentHTML(<span class="hljs-string"><span class="hljs-string">"beforeEnd"</span></span>, <span class="hljs-string"><span class="hljs-string">"&lt;/div&gt;"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.close(); ie.Visible = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;</code> </pre> <br>  The code is basically simple, I think it‚Äôs not necessary to explain line by line, I‚Äôll tell you the essence: <br><ol><li>  Create an instance of the interface for working with IE; </li><li>  We open the page already available on the computer (in our case it is a blank page); </li><li>  Extract "Document" from IE, this is an object representation of our page; </li><li>  Fill it with the necessary content; </li><li>  (Required) Close the document - IE displays the changes. </li></ol><br><img src="https://habrastorage.org/storage2/cca/b0f/3a3/ccab0f3a35c091c9e063eb46b4e22131.png"><br><br>  That's it, the software-generated page with our content is displayed in the browser without using the file system and the clipboard. <br><br>  Thus, it is possible to use a complex page layout written to the dll library to display frequently changing data instead of creating new files multiple times. </div><p>Source: <a href="https://habr.com/ru/post/163841/">https://habr.com/ru/post/163841/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../163829/index.html">Network Rendering on Hybrid Cluster</a></li>
<li><a href="../163831/index.html">Amazing Mars</a></li>
<li><a href="../163835/index.html">CentOS 5.x and Motion: View video stream after authorization</a></li>
<li><a href="../163837/index.html">We understand the development of Windows 8 applications on XAML / –° #, implementing a simple RSS Reader. Part 2</a></li>
<li><a href="../163839/index.html">Product Lifecycle Management. Popularly about the processes of life cycle management of telecommunications services</a></li>
<li><a href="../163845/index.html">When is MIN (DATE)! = MIN (DATE)?</a></li>
<li><a href="../163847/index.html">Controlled caching of pages in nginx</a></li>
<li><a href="../163849/index.html">What is wrong with the work on the result</a></li>
<li><a href="../163853/index.html">Git internals: data storage and merge</a></li>
<li><a href="../163855/index.html">Creating a Django web application in Visual Studio 2012 and publishing it to the Windows Azure cloud</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>