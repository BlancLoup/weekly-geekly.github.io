<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to make thin client from old Windows PC?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sooner or later the question arises about the need to replace one or more PCs due to slow work. 

 The easiest way, nothing to invent and just replace...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to make thin client from old Windows PC?</h1><div class="post__text post__text-html js-mediator-article">  Sooner or later the question arises about the need to replace one or more PCs due to slow work. <br><br>  The easiest way, nothing to invent and just replace the PC. <br><br>  The easiest way to do this is to start implementing ‚Äúremote desktops‚Äù in the terminal server version or virtual desktops. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The cost of a thin client <a href="http://www8.hp.com/us/en/thin-clients/overview.html%3Fjumpid%3Dva_r11260_go_thin">HP</a> , <a href="http://www.dell.com/us/business/p/desktops-n-workstations%3F~ck%3Dmn">DELL</a> or other brands can be compared with the cost of a full-fledged PC, and using an old PC as a thin client will extend the life of the product for a long enough period. <br><br>  How to deal with obsolete PCs: <br>  - leave Windows PC, the user will connect to the remote desktop. <br>  - boot the PC over the network, one of the linux options <a href="http://thinstation.github.io/thinstation/">thinstation</a> . <br>  - install on the PC a local version of linux, <a href="https://ru.wikipedia.org/wiki/%25D1%25EF%25E8%25F1%25EE%25EA_%25E4%25E8%25F1%25F2%25F0%25E8%25E1%25F3%25F2%25E8%25E2%25EE%25E2_Linux">options for the sea</a> . <br><br>  Next, I will describe the version with Windows, such a thin client has some advantages when compared with linux options. <br><a name="habracut"></a><br><hr><br>  <b>Why did I do all this:</b> <br><br>  - I have remote offices with users who needed to be transferred to work on terminal servers, using group policies in the domain allows you to get the desired result without being in the office and without replacing the PC. <br>  ‚ÄúBoth Windows and linux versions of HP thin client, Wyse / DELL user interfaces do not suit me for various reasons. <br><br>  Benefits of the Windows option: <br>  - Full support for RDP / RemoteFX. <br>  - Full support for removable media. <br>  - Ability to use a local printer. <br>  - Ability to use smart cards for bank customers. <br>  - Redirect of video / audio playback to a thin client using Windows Media Player, without brakes and without server load, you can watch 1080p video, but this is a separate story =). <br><br>  <b>If you start with the result:</b> <br><br>  This is what the user's desktop will look like if Windows XP is installed on the PC: <br><img src="https://habrastorage.org/files/e10/8fc/099/e108fc099e7f420da0537c4ababcb25e.gif"><br><br>  This is how the user's desktop will look like if Windows 7 is installed on the PC: <br><img src="https://habrastorage.org/files/1b2/a37/722/1b2a3772264a49be8dc265310861de28.gif"><br><br>  To get the result that you can see on the slides, you need an AD domain and several group policies for PCs and users. <br><br>  On a PC with XP SP3, you need to install updates for rdp client <a href="http://support.microsoft.com/kb/969084">KB969084</a> and <a href="http://support.microsoft.com/kb/951608">Fixit50588</a> , for extended group policies, you need to install update <a href="http://www.microsoft.com/ru-ru/download/details.aspx%3Fid%3D3628">KB943729</a> . <br><br>  <b>Key policies:</b> <br><br>  <b># 1</b> - Users need <a href="http://blogs.msdn.com/b/rds/archive/2007/04/19/how-to-enable-single-sign-on-for-my-terminal-server-connections.aspx">to allow Single sign-on</a> , I extend this policy to the entire domain. <br><img src="https://habrastorage.org/files/4c1/4e4/d2e/4c14e4d2e2544891aa5b072c53e8fab9.png"><br><br>  <b>No. 2</b> - For a PC, we make a separate OU and <a href="http://blogs.technet.com/b/askds/archive/2013/02/08/circle-back-to-loopback.aspx">close the group policies</a> in this OU. <br><img src="https://habrastorage.org/files/a37/a5b/4ad/a37a5b4adeb14101b7d6733207453fb6.png"><br><br>  <b>No. 3</b> - In the new OU, we create a policy where we change the user to ‚Äúwscript c: \ thinPC \ thinPC.vbs / nologo / b‚Äù. <br><img src="https://habrastorage.org/files/953/d5f/f1a/953d5ff1abec4cbfba917ef97b3bb754.png"><br>  On the target PC, you need to copy 3 files, I use for this extended group policies. <br>  I recommend files to be placed in the central storage of group policies \\ domain name \ SYSVOL \ domain name \ Policies \, this will provide fault tolerance in case of unavailability of one of the domain controllers. <br>  For domain controllers, this network resource corresponds to the folder C: \ Windows \ SYSVOL \ sysvol \ domain name \ Policies <br><br>  Contents of <b>thinPC.cmd</b> file <br><blockquote>  C: \ BGInfo \ Bginfo.exe "C: \ BGInfo \ config.bgi" / NOLICPROMPT / timer: 0 <br>  mstsc "c: \ thinPC \ thinPC.rdp" <br>  shutdown -l </blockquote>  <a href="http://technet.microsoft.com/en-US/sysinternals/bb897557">BGInfo</a> adds an inscription on the user's desktop with the necessary data, the results of BGInfo are visible on the slides. <br>  mstsc starts the rdp client, after the end of the remote session, the shutdown -l command is executed to end the user session on the thin client. <br><br>  During the work of the described script, the user will observe the execution of commands in the window, and to hide the window, the script is launched using <a href="https://ru.wikipedia.org/wiki/Visual_Basic_Scripting_Edition">VBS</a> . <br><br>  Contents of <b>thinPC.vbs</b> file <br><blockquote>  Dim oShell <br>  Set oShell = WScript.CreateObject ("WSCript.shell") <br>  oShell.run "C: \ thinPC \ thinPC.cmd", 0 <br>  Set oShell = Nothing </blockquote><br>  Contents of <b>thinPC.rdp</b> file <br>  This is an rdp file with the connection settings that are needed. <br><blockquote>  - It is necessary to disable the display of the connection panel when working in full screen. <br>  - I disable forwarding of local disks, but I allow forwarding of disks connected later, this will allow users to work with removable media that will connect after the start of a remote session. <br>  - In the case of windows 7, to use the <b>RemoteFX</b> protocol, <b>you</b> need to set a color depth of 32 bits and specify a connection speed of 10 megabits / LAN. <br>  - In cases where the server certificate is self-signed, you must disable the warning in the "Server Authentication" section. </blockquote><br>  That's all, replacing the user‚Äôs shell will make the boot process of the thin client as close as possible to the boot process of a regular PC. <br><br>  The main disadvantage of the proposed script is the inability of the user to choose the screen resolution, but I honestly do not understand when asking for a monitor of 22-24 inches, and then asked to increase the letters on it. <br>  In such cases, I install the VNC server on the target PC and change the resolution using it. <br><br><hr><br>  <b>Secondary policies:</b> <br><br>  <b>No.4</b> - In order to disable this message, it is enough for the user to tick the checkbox no longer to notify. <br><img src="https://habrastorage.org/files/ad7/0b2/689/ad70b268916240ebabc75e6d11db4731.png"><br>  To automate the process with administrative tools, you need to add a key to the registry. <br><blockquote>  [HKEY_CURRENT_USER \ Software \ Microsoft \ Terminal Server Client \ LocalDevices] <br>  "Server address" = dword: 0000000d </blockquote><br>  <b>No. 5</b> - It is necessary to increase the cache for the RDP connection, in the cases of Windows XP it is vital, but in the cases of Windows 7 it can be possible without increasing the cache. <blockquote>  [HKEY_CURRENT_USER \ Software \ Microsoft \ Terminal Server Client] <br>  "BitmapCacheSize" = dword: 0000ffff </blockquote>  A little more detail about graphics optimization, <a href="http://blogs.technet.com/b/askperf/archive/2009/04/17/terminal-services-and-graphically-intensive-applications.aspx">Terminal Services and Graphically Intensive Applications</a> . <br><br>  <b># 6</b> - <a href="https://technet.microsoft.com/en-us/library/cc780932(v%3Dws.10).aspx">Interactive logon: Do not require CTRL + ALT + DEL</a> <br>  set the parameter Disabled. <br><br>  <b># 7</b> - <a href="https://technet.microsoft.com/en-us/library/cc785301(v%3Dws.10).aspx">Interactive logon: Do not display last user name</a> <br>  set the parameter Enabled. <br><br>  <b># 8</b> - <a href="https://technet.microsoft.com/en-us/library/jj852199.aspx">Attempting to log on</a> and <a href="https://technet.microsoft.com/en-us/library/jj852182(v%3Dws.10).aspx">Interactive logon:</a> <br>  Fill in the title and text that is intended for users, in the simplest cases, you need to specify the contacts of the support center. <br><br>  <b>No.9</b> - To disable visual effects on a thin client, you must add a key to the registry. <br><blockquote>  [HKEY_CURRENT_USER \ Software \ Microsoft \ Windows \ CurrentVersion \ Explorer \ VisualEffects] <br>  "VisualFXSetting" = dword: 00000002 </blockquote><br>  <b>‚Ññ10</b> - <a href="http://blogs.technet.com/b/grouppolicy/archive/2009/09/30/configuring-a-power-plan-with-group-policy-preferences-by-alan-burchill.aspx">Power options</a> <br>  Using advanced group policies, you need to create a power plan in which when you press the power button, the thin client will be turned off. <br><br>  <b># 11</b> - <a href="https://technet.microsoft.com/en-us/library/bb457006.aspx">Software Restriction Policies</a> <br>  I recommend setting up software launch control, this mechanism works on WindowsXP and Windows 7 PRO. <br>  AppLocker is more flexible but only works on Windows 7 enterprise and higher. <br>  I believe that in cases of a thin client, flexibility is not needed, the goal is to eliminate the possibility of running malware. <br><br>  <b>‚Ññ12</b> - <a href="http://www.symantec.com/connect/articles/how-disable-autoplay-feature-prevent-virus-spreading-using-feature">Turn off Autoplay</a> <br>  To disable the automatic launch of removable media, you must set the parameter Enabled for All drives. <br><br>  <b># 13</b> - <a href="https://technet.microsoft.com/en-us/library/gg607265(v%3Dws.10).aspx">Allow RDP RemoteFX supported devices</a> <br>  If you plan to forward USB devices, allow the policy for Adminstrators and Users. <br><br>  <b># 14</b> - <a href="http://www.grouppolicy.biz/2009/11/group-policy-setting-of-the-week-1-how-to-remove-old-user-profiles-after-x-days/">System Restart</a> <br>  I set the parameter to 180 days, the policy only works on Windows 7. <br><br>  <b>‚Ññ15</b> - <a href="http://www.ithacks.com/2009/01/17/disable-user-account-control-uac-in-windows-7/">User Account Control</a> <br>  UAC bothers me and disconnects for this. <br><br>  <b># 16</b> - Replacing the desktop background, beauty requires sacrifice. <br><br>  For Windows XP, this key in the registry is responsible for the wallpaper on the login and password entry screen. <br>  The background file can be anywhere, but it must be a bmp file. <br><blockquote>  [HKEY_USERS \ .DEFAULT \ Control Panel \ Desktop] <br>  "Wallpaper" = "C: \\ thinPC \\ rd.bmp" <br>  "WallpaperStyle" = "2" </blockquote><br>  To <a href="http://www.grouppolicy.biz/2011/04/best-practice-how-to-use-group-policy-to-configure-windows-7-logon-ui-background-wallpaper/">change the background of Windows 7,</a> you need to install the key, and transfer the file with the% WindowsDir% \ System32 \ oobe \ info \ backgrounds \ backgrounddefault.jpg background. <br><blockquote>  [HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Authentication \ LogonUI \ Background] <br>  "OEMBackground" = dword: 00000001 </blockquote><br>  You also need to set the background for the user session on the thin client. <br><blockquote>  [HKEY_CURRENT_USER \ Control Panel \ Desktop] <br>  "Wallpaper" = "C: \\ thinPC \\ rd.bmp" <br>  "WallpaperStyle" = "2" </blockquote><br><hr><br>  <b>About the practice:</b> <br><br>  - Similar thin clients have been working for over a year. <br>  - On several old PCs, disks had time to be poured, HP thin clients were sent in return, but all user data was on the servers;) <br>  - Several accountants successfully work with BIFIT USB tokens </div><p>Source: <a href="https://habr.com/ru/post/245183/">https://habr.com/ru/post/245183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245159/index.html">Hacker found a way to read files on Facebook servers</a></li>
<li><a href="../245165/index.html">CloudFlare + nginx = we cache everything on a free plan</a></li>
<li><a href="../245171/index.html">Research software in universities in the UK</a></li>
<li><a href="../245175/index.html">C ++ 11/14/17 support summary table</a></li>
<li><a href="../245181/index.html">The digest of interesting materials for the mobile developer # 82 (December 1-7)</a></li>
<li><a href="../245185/index.html">International and national standards for information project management</a></li>
<li><a href="../245187/index.html">Translation and dubbing of the movie at home: Hawking. My short story</a></li>
<li><a href="../245189/index.html">Tibbo in creating GIS utilities</a></li>
<li><a href="../245193/index.html">UHF in working time and access control systems</a></li>
<li><a href="../245195/index.html">Review of the most interesting materials on data analysis and machine learning ‚Ññ25 (December 1 - 7, 2014)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>