<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parable about automatic widget management</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- Hello‚Ä¶ 
 - Aaaa! Pamagite! Kill! \ (0_0) / 
 - Pal, calm, I am my own: - \ 
 - They do not sneak up behind their heads! \ (@ _ @) / 
 - I dynamicall...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parable about automatic widget management</h1><div class="post__text post__text-html js-mediator-article">  - Hello‚Ä¶ <br>  - Aaaa!  Pamagite!  Kill!  \ (0_0) / <br>  - Pal, calm, I am my own: - \ <br>  - They do not sneak up behind their heads!  \ (@ _ @) / <br>  - I dynamically added B-] <br>  - Uh-uh (~ _ ~) / <br>  - Clearly, you do not know how to respond to such situations?  XD <br>  - Well ... how would ... have thoughts ... \ (= _ =) / <br>  - Show me your source code% -) <br>  - I ... this ... I hesitate ... \ (._.) / <br>  - Come on, don't be afraid, I'm your own ;-) <br>  - Laaaadno \ (-_-) / <br><blockquote><code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> &lt;br&gt;        $( <font color="#0000ff">function</font> (){&lt;br&gt;            $( <font color="#A31515">'.c-example'</font> ).wrapInner( <font color="#A31515">'&lt;span class="wrapper" /&gt;'</font> )&lt;br&gt;        })&lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">class</font> <font color="#0000ff">="c-example"</font> <font color="#0000ff">&gt;</font> epic <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <a name="habracut"></a><br>  - Laconic: ^ D <br>  - Doooo \ (* ^ *) / <br>  - What do you say to that?  }: -] <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> &lt;br&gt;        $( <font color="#0000ff">function</font> (){&lt;br&gt;            $( <font color="#A31515">'.c-example'</font> ).wrapInner( <font color="#A31515">'&lt;span class="wrapper" /&gt;'</font> )&lt;br&gt;        })&lt;br&gt;        $( <font color="#0000ff">function</font> (){&lt;br&gt;            $( <font color="#A31515">'body'</font> ).html( <font color="#A31515">'&lt;div class="c-example"&gt;fail&lt;/div&gt;'</font> )&lt;br&gt;        })&lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">class</font> <font color="#0000ff">="c-example"</font> <font color="#0000ff">&gt;</font> epic <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  - Nothing \ (% _%) / I did not notice how everything changed ... <br>  - That's the same ... and now look :-P <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">body</font> <font color="#ff0000">xmlns:c</font> <font color="#0000ff">="urn:component"</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> &lt;br&gt;        CComponent({ tag: <font color="#A31515">'c:example'</font> , factory: <font color="#0000ff">function</font> ( el ){&lt;br&gt;            $(el).wrapInner( <font color="#A31515">'&lt;span class="wrapper" /&gt;'</font> )&lt;br&gt;        }})&lt;br&gt;        $( <font color="#0000ff">function</font> (){&lt;br&gt;            $( <font color="#A31515">'body'</font> ).html( <font color="#A31515">'&lt;c:example&gt;win&lt;/c:example&gt;'</font> )&lt;br&gt;        })&lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">c:example</font> <font color="#0000ff">&gt;</font> epic <font color="#0000ff">&lt;/</font> <font color="#800000">c:example</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">body</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  - How?  How does it work?  \ (* o *) / <br>  - It tracks the appearance of certain elements in real time and binds to them, created using the factory, widgets that are automatically destroyed (destroy method) when the element is removed from the house B ^] <br>  - Wow, great!  \ ($ _ $) / <br>  - Yeah ... well, smoke the library: -] <br><br><blockquote> <code><font color="black"><font color="#0000ff">var</font> CComponent= <font color="#0000ff">new</font> <font color="#0000ff">function</font> (){&lt;br&gt;&lt;br&gt; <b>Version:</b> 2&lt;br&gt; <b>Description:</b> <font color="#A31515">'attach widget constructor to DOM as live component'</font> &lt;br&gt; <b>License:</b> <font color="#A31515">'public domain'</font> &lt;br&gt; &lt;br&gt; <b>Implementation:</b> &lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> latencyDefault= 50&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> CComponent= <font color="#0000ff">function</font> ( arg ){&lt;br&gt; <font color="#0000ff">if</font> (!( <font color="#0000ff">this</font> instanceof CComponent )) <font color="#0000ff">return</font> <font color="#0000ff">new</font> CComponent( arg )&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> elements= [], widgets= []&lt;br&gt; <font color="#0000ff">var</font> timerTracking, timerCleaning&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> latencyTracking= arg.latencyTracking || latencyDefault&lt;br&gt; <font color="#0000ff">var</font> latencyCleaning= arg.latencyCleaning || latencyDefault&lt;br&gt; <font color="#0000ff">var</font> field= <font color="#A31515">'CComponent:'</font> + <font color="#0000ff">new</font> Date + Math.random()&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> tag= arg.tag&lt;br&gt; <font color="#0000ff">var</font> factory= arg.factory&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> attach= <font color="#0000ff">function</font> ( el ){&lt;br&gt; <font color="#0000ff">var</font> widget= <font color="#0000ff">new</font> factory( el ) || <font color="#0000ff">null</font> &lt;br&gt;        el[ field ]= widget&lt;br&gt; <font color="#0000ff">if</font> ( !widget ) <font color="#0000ff">return</font> &lt;br&gt;        elements.push( el )&lt;br&gt;        widgets.push( widget )&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> attachIfLoaded= <font color="#0000ff">function</font> ( el ){&lt;br&gt; <font color="#0000ff">var</font> cur= el&lt;br&gt; <font color="#0000ff">do</font> {&lt;br&gt; <font color="#0000ff">if</font> ( !cur.nextSibling ) <font color="#0000ff">continue</font> &lt;br&gt;            attach( el )&lt;br&gt; <font color="#0000ff">break</font> &lt;br&gt;        } <font color="#0000ff">while</font> ( cur= cur.parentNode )&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> tracking= <font color="#0000ff">function</font> ( ){&lt;br&gt; <font color="#0000ff">var</font> nodes= CComponent.tags( tag )&lt;br&gt; <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i= 0, len= nodes.length; i &lt; len; ++i ){&lt;br&gt; <font color="#0000ff">var</font> el= nodes[ i ]&lt;br&gt; <font color="#0000ff">var</font> widget= el[ field ]&lt;br&gt; <font color="#0000ff">if</font> ( <font color="#0000ff">typeof</font> widget === <font color="#A31515">'object'</font> ) <font color="#0000ff">continue</font> &lt;br&gt;            attachIfLoaded( el )&lt;br&gt;        }&lt;br&gt;        timerTracking= setTimeout( tracking, latencyTracking )&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> cleaning= <font color="#0000ff">function</font> ( ){&lt;br&gt; <font color="#0000ff">var</font> doc= <font color="#0000ff">document</font> .documentElement&lt;br&gt;        checking: <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i= elements.length; i--; ){&lt;br&gt; <font color="#0000ff">var</font> el= elements[ i ]&lt;br&gt; <font color="#0000ff">var</font> cur= el&lt;br&gt; <font color="#0000ff">do</font> {&lt;br&gt; <font color="#0000ff">if</font> ( cur === doc ) <font color="#0000ff">continue</font> checking&lt;br&gt;            } <font color="#0000ff">while</font> ( cur= cur.parentNode )&lt;br&gt; <font color="#0000ff">var</font> widget= el[ field ]&lt;br&gt; <font color="#0000ff">if</font> ( widget.destroy ) widget.destroy()&lt;br&gt;            el[ field ]= <font color="#0000ff">void</font> 0&lt;br&gt;            elements.splice( i, 1 )&lt;br&gt;            widgets.splice( i, 1 )&lt;br&gt;        }&lt;br&gt;        timerCleaning= setTimeout( cleaning, latencyCleaning )&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> revive= <font color="#0000ff">function</font> ( ){&lt;br&gt;        tracking()&lt;br&gt;        cleaning()&lt;br&gt;    }&lt;br&gt; <font color="#0000ff">var</font> freeze= <font color="#0000ff">function</font> ( ){&lt;br&gt;        timerTracking= clearTimeout( timerTracking )&lt;br&gt;        timerCleaning= clearTimeout( timerCleaning )&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> destroy= <font color="#0000ff">function</font> ( ){&lt;br&gt;        freeze()&lt;br&gt; <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i= elements.length; i--; ){&lt;br&gt; <font color="#0000ff">var</font> widget= widgets[ i ]&lt;br&gt; <font color="#0000ff">if</font> ( widget.destroy ) widget.destroy()&lt;br&gt;        }&lt;br&gt;        elements= []&lt;br&gt;        widgets= []&lt;br&gt;    }&lt;br&gt;    &lt;br&gt; <font color="#0000ff">var</font> onload= <font color="#0000ff">function</font> ( ){ attachIfLoaded= attach }&lt;br&gt; <font color="#008000">// replace with DOMContentLoaded from your framework</font> &lt;br&gt;    window.addEventListener&lt;br&gt;    ? window.addEventListener( <font color="#A31515">'load'</font> , onload, <font color="#0000ff">false</font> )&lt;br&gt;    : window.attachEvent( <font color="#A31515">'onload'</font> , onload )&lt;br&gt;    &lt;br&gt; <font color="#0000ff">this</font> .tag= <font color="#0000ff">function</font> ( ){ <font color="#0000ff">return</font> tag }&lt;br&gt; <font color="#0000ff">this</font> .field= <font color="#0000ff">function</font> ( ){ <font color="#0000ff">return</font> field }&lt;br&gt; <font color="#0000ff">this</font> .factory= <font color="#0000ff">function</font> ( ){ <font color="#0000ff">return</font> factory }&lt;br&gt; <font color="#0000ff">this</font> .latencyTracking= <font color="#0000ff">function</font> ( ){ <font color="#0000ff">return</font> latencyTracking }&lt;br&gt; <font color="#0000ff">this</font> .latencyCleaning= <font color="#0000ff">function</font> ( ){ <font color="#0000ff">return</font> latencyCleaning }&lt;br&gt; <font color="#0000ff">this</font> .elements= <font color="#0000ff">function</font> ( ){ <font color="#0000ff">return</font> elements.slice( 0 ) }&lt;br&gt; <font color="#0000ff">this</font> .widgets= <font color="#0000ff">function</font> ( ){ <font color="#0000ff">return</font> widgets.slice( 0 ) }&lt;br&gt; <font color="#0000ff">this</font> .revive= revive&lt;br&gt; <font color="#0000ff">this</font> .freeze= freeze&lt;br&gt; <font color="#0000ff">this</font> .destroy= destroy&lt;br&gt;&lt;br&gt;    revive()&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">var</font> cacheTags= {}&lt;br&gt;&lt;br&gt;CComponent.tags= <font color="#0000ff">function</font> ( name ){&lt;br&gt; <font color="#0000ff">var</font> nodes= cacheTags[ name ]&lt;br&gt; <font color="#0000ff">if</font> ( !nodes ){&lt;br&gt; <font color="#0000ff">var</font> isIE= <font color="#008000">/*@cc_on!@*/</font> <font color="#0000ff">false</font> &lt;br&gt; <font color="#0000ff">var</font> chunks= /(?:(\w+):)?([-\w]+)/.exec( name )&lt;br&gt; <font color="#0000ff">var</font> scope= isIE &amp;&amp; chunks[1] || <font color="#A31515">''</font> &lt;br&gt; <font color="#0000ff">var</font> tag= isIE &amp;&amp; chunks[2]|| name&lt;br&gt;        nodes= cacheTags[ name ]= <font color="#0000ff">document</font> .getElementsByTagName( tag )&lt;br&gt;        nodes.scopeName= scope&lt;br&gt;    }&lt;br&gt; <font color="#0000ff">var</font> res= [], scope= nodes.scopeName&lt;br&gt; <font color="#0000ff">if</font> ( scope ){&lt;br&gt; <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i= 0, len= nodes.length; i &lt; len; ++i ){&lt;br&gt; <font color="#0000ff">var</font> node= nodes[ i ]&lt;br&gt; <font color="#0000ff">if</font> ( node.scopeName !== scope ) <font color="#0000ff">continue</font> &lt;br&gt;            res.push( node )&lt;br&gt;        }&lt;br&gt;    } <font color="#0000ff">else</font> {&lt;br&gt; <font color="#0000ff">for</font> ( <font color="#0000ff">var</font> i= 0, len= nodes.length; i &lt; len; ++i )&lt;br&gt;            res.push( nodes[ i ] )&lt;br&gt;    };&lt;br&gt; <font color="#0000ff">return</font> res&lt;br&gt;}&lt;br&gt;&lt;br&gt; <b>Export:</b> <font color="#0000ff">return</font> CComponent&lt;br&gt;&lt;br&gt; <b>Usage:</b> &lt;br&gt;&lt;br&gt;CComponent(&lt;br&gt;{  tag: <font color="#A31515">'c:example'</font> &lt;br&gt;,  factory: <font color="#0000ff">function</font> ( el ){&lt;br&gt; <font color="#0000ff">this</font> .el= el&lt;br&gt;        alert( <font color="#A31515">'FOUND '</font> + <font color="#0000ff">this</font> .el.innerHTML )&lt;br&gt; <font color="#0000ff">this</font> .destroy= <font color="#0000ff">function</font> (){&lt;br&gt;            alert( <font color="#A31515">'LOST '</font> + <font color="#0000ff">this</font> .el.innerHTML )&lt;br&gt;            delete <font color="#0000ff">this</font> .el&lt;br&gt;        }&lt;br&gt;    }&lt;br&gt;} )&lt;br&gt;&lt;br&gt;}</font></code> </blockquote> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/91003/">https://habr.com/ru/post/91003/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../90993/index.html">Chobi Mini Digital Camera - the world's smallest camera</a></li>
<li><a href="../90994/index.html">About morals and games</a></li>
<li><a href="../90997/index.html">Launch of Visual Studio 2010 in St. Petersburg</a></li>
<li><a href="../91001/index.html">Using video to attract new Wikipedia editors</a></li>
<li><a href="../91002/index.html">Managing ISC DHCPd 4.x from scripts</a></li>
<li><a href="../91004/index.html">Library of Congress acquires Twitter archive</a></li>
<li><a href="../91005/index.html">Denial of information distributed by Oversan-Mercury</a></li>
<li><a href="../91007/index.html">Netgear DGN3500: a first look at the first in Russia router with ADSL, Gigabit Ethernet and 802.11n support</a></li>
<li><a href="../91009/index.html">Russian startup in The Next Web Startup Rally final</a></li>
<li><a href="../91010/index.html">What project management system do you use in the company?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>