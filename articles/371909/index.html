<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Interaction with the robot based on the Lego Mindstorms EV3 constructor via RCML</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article describes the experience of using the Lego Mindstorms EV3 designer to create a prototype of a robot with its subsequent program and manual...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Interaction with the robot based on the Lego Mindstorms EV3 constructor via RCML</h1><div class="post__text post__text-html js-mediator-article"><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/jPh0W_KhO4s%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhhscV4-ut4X8uCuXFuhywbLg9yOPA" frameborder="0" allowfullscreen=""></iframe><br><br>  The article describes the experience of using the Lego Mindstorms EV3 designer to create a prototype of a robot with its subsequent program and manual control using Robot Control Meta Language (RCML). <br><br>  The following key points will be considered: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Building a robot prototype based on the Lego Mindstorms EV3 designer </li><li>  Quick installation and configuration of RCML for Windows </li><li>  Software control robot based on the EV3 controller </li><li>  Manual control of the periphery of the robot using the keyboard and gamepad </li></ul><br>  Looking ahead a bit, I‚Äôll add that in order to implement Lego-robot control using the keyboard, you need to create a program containing only 3 lines of program code.  Details on how to do this are written under the cut. <br><a name="habracut"></a><br>  1. To begin with, a prototype robot was created from the Lego Mindstorms EV3 designer, which will be used for programming and manual piloting. <br><br><div class="spoiler">  <b class="spoiler_title">Description of the prototype of the robot</b> <div class="spoiler_text">  The robot has a design similar to a car chassis.  Two motors mounted on the frame have one common axis of rotation, which is connected to the rear wheels through a gearbox.  The gearbox converts torque by increasing the angular velocity of the rear axle.  The steering system is assembled on the base of a bevel gearbox. <br><br><img src="https://habrastorage.org/files/160/6ae/93a/1606ae93a8154cd1af97f60bf144094a.JPG"><br><br><img src="https://habrastorage.org/files/ca4/619/add/ca4619add3724c30b3a570ef629c4885.JPG"><br><br><img src="https://habrastorage.org/files/234/9dd/595/2349dd5953e84e4688ae465648420f0d.JPG"><br><br><img src="https://habrastorage.org/files/0c4/a61/4f0/0c4a614f06d14fadbe6b5b0b1495aa49.JPG"><br><br><img src="https://habrastorage.org/files/661/205/30d/66120530d28a41579bbf724a775cfe7c.JPG"><br><br><img src="https://habrastorage.org/files/c7a/b84/2f2/c7ab842f24f54629972668f9c3bf8fa0.JPG"><br></div></div><br>  2. The next step is to prepare RCML to work with the Lego Mindstorms EV3 designer. <br><br>  It is necessary to download archives with executable files and library files <a href="http://sourceforge.net/projects/rcmlang/files/windows/rcml_build_1.0.6.zip/download">rcml_build_1.0.6.zip</a> and <a href="http://sourceforge.net/projects/rcmlang/files/windows/rcml_modules_build_1.0.6.zip/download">rcml_modules_build_1.0.6.zip</a> . <br><br>  The following describes the process of performing a quick start for the interaction of RCML and Lego of a robot controlled by an EV3 controller. <br><br>  The downloaded archives must be extracted into a directory with an arbitrary name, but you should <b>avoid</b> Russian letters in the name. <br><br><div class="spoiler">  <b class="spoiler_title">Directory contents after unpacking archives</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/240/f73/bfd/240f73bfd36b4cecb458ca7ac66cc1d8.png"><br></div></div><br>  Next, you need to create a config.ini configuration file, which must be located in the same directory.  To implement the ability to control the EV3 controller using the keyboard and gamepad, you need to connect the modules lego_ev3, keyboard and gamepad. <br><br><div class="spoiler">  <b class="spoiler_title">Listing of the config.ini configuration file for RCML</b> <div class="spoiler_text"><pre><code class="hljs java">[robot_modules] <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> = lego_ev3 [control_modules] <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> = keyboard <span class="hljs-keyword"><span class="hljs-keyword">module</span></span> = gamepad</code> </pre> </div></div><br>  Next, you should pair the EV3 controller and adapter. <br><br><div class="spoiler">  <b class="spoiler_title">Instructions for pairing the EV3 controller and Bluetooth adapter</b> <div class="spoiler_text">  The manual contains an example of pairing a Lego Ev3 controller and a PC running the Windows 7 operating system. <br><br>  1. Go to the settings section of the Ev3 controller, then go to the menu item ‚ÄúBluetooth‚Äù. <br><br>  2. Make sure the configuration settings are correct.  The checkboxes against ‚ÄúVisibility‚Äù and ‚ÄúBluetooth‚Äù should be checked. <br><br><img src="https://habrastorage.org/files/190/620/1f2/1906201f219842a3a4766ed300f43d67.png"><br><br>  3. You need to go to the "Control Panel", then "Devices and Printers", then "Bluetooth Devices". <br><br><img src="https://habrastorage.org/files/93a/887/915/93a8879157674f49b833d3d403ed0ee4.png"><br><br>  4. You must click the "Add Device" button.  A window will open to select available Bluetooth devices. <br><br><img src="https://habrastorage.org/files/62c/17f/3ac/62c17f3ac81d46c580822a4c8f2220cc.png"><br><br>  5. Select the ‚ÄúEV3‚Äù device and click the ‚ÄúNext‚Äù button. <br><br>  6. The ‚ÄúConnect?‚Äù Dialog box will be displayed on the EV3 controller screen.  You need to select the checkmark option, and confirm your choice by pressing the central key. <br><br><img src="https://habrastorage.org/files/ede/4dd/a7b/ede4dda7b76c4a3ab72bc51b5445d02e.jpg"><br><br>  7. Next, the ‚ÄúPASSKEY‚Äù dialog box will appear, the digits ‚Äú1234‚Äù should be indicated in the input line, then you should confirm the key phrase for pairing devices by pressing the central key on the position with a check mark. <br><br><img src="https://habrastorage.org/files/66c/934/64a/66c93464a6804650923eaafc76df084a.jpg"><br><br>  8. A form for entering the key for pairing devices will appear in the device pairing wizard.  You need to enter the code "1234" and press the "Next" button. <br><br><img src="https://habrastorage.org/files/d91/49a/272/d9149a272e94462ba30a96da0bf48aaa.png"><br><br>  9. Next, a window will appear, with successful connection of the device.  Press the "Close" button. <br><br><img src="https://habrastorage.org/files/ba0/20f/365/ba020f365d7243d09cf6b8f7c61829c6.png"><br><br>  10. On the PC, you need to return to the ‚ÄúControl Panel‚Äù, then ‚ÄúDevices and Printers‚Äù, then ‚ÄúBluetooth Devices‚Äù.  The list of available devices will display the device with which the pairing was made. <br><br><img src="https://habrastorage.org/files/42a/fd3/167/42afd31679cd4293ad32e669aa0a17b9.png"><br><br>  11. Double-tap to go to the ‚ÄúEV3‚Äù connection properties. <br><br><img src="https://habrastorage.org/files/ed3/08c/66a/ed308c66ac7244998c1153e6f3dff303.png"><br><br>  12. Next, go to the tab "Equipment". <br><br><img src="https://habrastorage.org/files/232/3c1/e96/2323c1e96b39494a9d0aae8a3a1d1c7d.png"><br><br>  13. Next, double-click to go to the properties of the connection "Standard serial port via Bluetooth connection". <br><br><img src="https://habrastorage.org/files/dfb/9d8/2f2/dfb9d82f272c4a9bbaec38fc40b4f3ee.png"><br><br>  14. The COM port index specified in the properties should be used in the config.ini configuration file of the lego_ev3 module.  The example shows the Bluetooth properties of the Lego EV3 controller using the standard COM14 serial port. <br></div></div><br>  Further configuration of the module is reduced to the fact that it is necessary to write in the configuration file of the lego_ev3 module the address of the COM port through which communication with the Lego robot takes place. <br><br><div class="spoiler">  <b class="spoiler_title">Listing of the config.ini configuration file for the lego_ev3 module</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">[connections] <span class="hljs-keyword"><span class="hljs-keyword">connection</span></span> = COM14 [<span class="hljs-keyword"><span class="hljs-keyword">options</span></span>] dynamic_connection = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br></div></div><br>  Now you need to configure the keyboard module.  The module is located in the control_modules directory, then the keyboard.  You should create a config.ini configuration file next to the keyboard_module.dll file.  Before you create a configuration file, you must determine which actions should be performed by pressing the keys. <br><br>  The keyboard module allows you to use keys that have a certain numeric code.  Table of virtual key codes can be found <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v%3Dvs.85).aspx">here</a> . <br><br>  As an example, I will use the following key presses: <br><br><ul><li>  The up / down arrows are used to rotate the rear wheel motor forward / backward. </li><li>  Left / right arrows turn wheels left / right </li></ul><br>  The keyboard module configuration file describes which axes are available to the programmer to interact with the robot in manual control mode.  Thus, in the example we have two control groups - these are the keyboard axes.  To add a new axis, follow the following axis description rules. <br><br><div class="spoiler">  <b class="spoiler_title">Rules for describing axes for the keyboard module</b> <div class="spoiler_text">  1. When adding a new axis, you need to add a property in the <b>[mapped_axis]</b> section, the name of which is the name of the axis, and assign it the value of the keyboard button in the <b>HEX</b> format, and a similar entry is added to each button, i.e.  axis name can be used several times.  In general, an entry in the <b>[mapped_axis]</b> section will look like this: <br><br><pre> <code class="hljs">_ = ____HEX_</code> </pre><br>  2. It is necessary to set the maximum and minimum value that can be stored on this axis.  To do this, you need to add a section in the <b>config.ini</b> configuration file, the same name as the axis name, and set the <b>upper_value</b> and <b>lower_value</b> properties that correspond to the maximum and minimum axes, respectively.  In general, this section looks like this: <br><br><pre> <code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta">_</span></span>] upper_value = __ lower_value = __</code> </pre><br>  3. Next, determine what value the axis will have if you press a button on the keyboard that was previously attached to it.  Definition of values ‚Äã‚Äãoccurs by creating a section, the name of which consists of the axis name and the value of the keyboard button in <b>HEX</b> format, separated by an underscore.  To set the default value (in the non- <b>depressed)</b> and <b>depressed</b> state, the <b>unpressed_value</b> and <b>pressed_value</b> properties are used, respectively, to which the values ‚Äã‚Äãare passed.  The general view of the section in this case is as follows: <br><br><pre> <code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta">-_--</span></span>] pressed_value = ____ unpressed_value = ____</code> </pre><br>  The spoiler text is copied from the <a href="http://robotct.ru/aboutrcml">RCML documentation</a> for easy viewing. <br></div></div><br>  To implement the robot prototype control, a keyboard configuration file was created that includes the go and rotate axes.  The go axis is used to set the direction of movement of the robot.  When you press the up arrow, the axis will receive a value of 100, and when you press the down arrow, the axis will take a value of -50.  The rotate axis is used to set the angle of rotation of the front wheels.  If you press the left-arrow key, the axis value will be -5; when you press the right arrow, the axis will take the value 5. <br><br><div class="spoiler">  <b class="spoiler_title">Listing of the config.ini configuration file for the keyboard module</b> <div class="spoiler_text"><pre> <code class="hljs mel">;  [mapped_axis] ;_ = _ ( HEX ) ; go    _ go = <span class="hljs-number"><span class="hljs-number">0x26</span></span> ; go    _ go = <span class="hljs-number"><span class="hljs-number">0x28</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span>    _ <span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span> = <span class="hljs-number"><span class="hljs-number">0x25</span></span> ; <span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span>    _ <span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span> = <span class="hljs-number"><span class="hljs-number">0x27</span></span> ;  go,      [go] ;    go upper_value = <span class="hljs-number"><span class="hljs-number">-100</span></span> ;    go lower_value = <span class="hljs-number"><span class="hljs-number">100</span></span> ;  <span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span>,      [<span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span>] ;    <span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span> upper_value = <span class="hljs-number"><span class="hljs-number">-100</span></span> ;    <span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span> lower_value = <span class="hljs-number"><span class="hljs-number">100</span></span> ;   go   *_* (<span class="hljs-number"><span class="hljs-number">0x26</span></span>) [go_0x26] ;   *_*     <span class="hljs-number"><span class="hljs-number">50</span></span> pressed_value = <span class="hljs-number"><span class="hljs-number">100</span></span> ;   *_*     <span class="hljs-number"><span class="hljs-number">0</span></span> unpressed_value = <span class="hljs-number"><span class="hljs-number">0</span></span> ;   go   *_* (<span class="hljs-number"><span class="hljs-number">0x28</span></span>) [go_0x28] ;   *_*     <span class="hljs-number"><span class="hljs-number">-50</span></span> pressed_value = <span class="hljs-number"><span class="hljs-number">-50</span></span> ;   *_*     <span class="hljs-number"><span class="hljs-number">0</span></span> unpressed_value = <span class="hljs-number"><span class="hljs-number">0</span></span> ;   <span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span>   *_* (<span class="hljs-number"><span class="hljs-number">0x25</span></span>) [rotate_0x25] ;   *_*     <span class="hljs-number"><span class="hljs-number">-5</span></span> pressed_value = <span class="hljs-number"><span class="hljs-number">-5</span></span> ;   *_*     <span class="hljs-number"><span class="hljs-number">0</span></span> unpressed_value = <span class="hljs-number"><span class="hljs-number">0</span></span> ;   <span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span>   *_* (<span class="hljs-number"><span class="hljs-number">0x27</span></span>) [rotate_0x27] ;   *_*     <span class="hljs-number"><span class="hljs-number">5</span></span> pressed_value = <span class="hljs-number"><span class="hljs-number">5</span></span> ;   *_*     <span class="hljs-number"><span class="hljs-number">0</span></span> unpressed_value = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br></div></div><br>  Next, to implement the control using the gamepad, you need to configure the gamepad module.  Configuring the module involves creating a config.ini configuration file next to gamepad_module.dll, located in the control_modules directory, then gamepad. <br><br><div class="spoiler">  <b class="spoiler_title">Universal configuration file of the module for interacting with the gamepad</b> <div class="spoiler_text"><pre> <code class="hljs sql">;     [axis] ;      Exit = 9 ; 11  ,    B1 = 1 B2 = 2 B3 = 3 B4 = 4 L1 = 7 L2 = 5 R1 = 8 R2 = 6 <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> = <span class="hljs-number"><span class="hljs-number">10</span></span> T1 = <span class="hljs-number"><span class="hljs-number">11</span></span> T2 = <span class="hljs-number"><span class="hljs-number">12</span></span> ; 4   ;   / RTUD = 13 ;   / RTLR = 16 ;   / LTUD = 15 ;   / LTLR = 14 ; 2   ;  / arrowsUD = 17 ;  / arrowsLR = 18 ;   B1 [B1] ;   B1     1 upper_value = 1 ;   B1     0 lower_value = 0 [B2] upper_value = 1 lower_value = 0 [B3] upper_value = 1 lower_value = 0 [B4] upper_value = 1 lower_value = 0 [L1] upper_value = 1 lower_value = 0 [L2] upper_value = 1 lower_value = 0 [R1] upper_value = 1 lower_value = 0 [R2] upper_value = 1 lower_value = 0 [<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>] upper_value = <span class="hljs-number"><span class="hljs-number">1</span></span> lower_value = <span class="hljs-number"><span class="hljs-number">0</span></span> [T1] upper_value = <span class="hljs-number"><span class="hljs-number">1</span></span> lower_value = <span class="hljs-number"><span class="hljs-number">0</span></span> [T2] upper_value = <span class="hljs-number"><span class="hljs-number">1</span></span> lower_value = <span class="hljs-number"><span class="hljs-number">0</span></span> ;      / [RTUD] ;         upper_value = 0 ;         lower_value = 65535 [RTLR] upper_value = 0 lower_value = 65535 [LTUD] upper_value = 0 lower_value = 65535 [LTLR] upper_value = 0 lower_value = 65535 ;     / [arrowsUD] ;      upper_value = 1 ;      lower_value = -1 [arrowsLR] upper_value = 1 lower_value = -1</code> </pre><br></div></div><br>  Additional information about the features of the gamepad module configuration is displayed in the <a href="http://robotct.ru/aboutrcml">RCML reference manual</a> . <br><br>  3. The next step is to write a program in the RCML language. <br><br>  In the root of the created directory, you must create a program file.  The file name of the program and its extension can be any, but you should avoid Russian letters in the name.  In the example, the file name is used - hello.rcml. <br><br>  For the lego_ev3 module, the robot reservation code is the following: <br><br><pre> <code class="hljs css">@<span class="hljs-keyword"><span class="hljs-keyword">tr</span></span> = robot_lego_ev3;</code> </pre><br><br>  On <a href="http://robotct.ru/aboutrcml">the connection page of the lego_ev3 module</a> , most of the functions supported by the controller are described.  As a test example, a program was created to automatically enter the robot into a skid. <br><br>  The program algorithm is as follows: <br><br>  After reserving the first free robot, a connection is established between two engines for subsequent work with them, as with one.  Then the robot starts to drift.  Program description of the actions of the robot allows you to accurately set the angles of rotation of the front wheels and the speed of rotation of the rear.  Using this technique allows you to achieve results that are difficult to repeat during manual piloting from a keyboard or gamepad. <br><br><div class="spoiler">  <b class="spoiler_title">Program listing for Lego robot in RCML language</b> <div class="spoiler_text"><pre> <code class="hljs matlab"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> { @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tr</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">robot_lego_ev3</span></span></span><span class="hljs-function">; //  @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tr</span></span></span><span class="hljs-function">-&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setTrackVehicle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">("B","C",0,0)</span></span></span><span class="hljs-function">; //   @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tr</span></span></span><span class="hljs-function">-&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motorMoveTo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">("D",100,0,0)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">system</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sleep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(500)</span></span></span><span class="hljs-function">; @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tr</span></span></span><span class="hljs-function">-&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trackVehicleForward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(-100)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">system</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sleep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1000)</span></span></span><span class="hljs-function">; @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tr</span></span></span><span class="hljs-function">-&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motorMoveTo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">("D",50,-50,0)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">system</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sleep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4000)</span></span></span><span class="hljs-function">; @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tr</span></span></span><span class="hljs-function">-&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">motorMoveTo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">("D",50,50,0)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">system</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sleep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(4000)</span></span></span><span class="hljs-function">; @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tr</span></span></span><span class="hljs-function">-&gt;</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trackVehicleOff</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">system</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sleep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1000)</span></span></span><span class="hljs-function">; }</span></span></code> </pre></div></div><br>  To compile the program, you must use the command line window.  First you need to move to the created directory with executable files rcml_compiler.exe and rcml_intepreter.exe.  Next you need to enter the following commands. <br><br>  The command to compile the hello.rcml file is: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">rcml_compiler</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.exe</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">hello</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.rcml</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">hello</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.rcml</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pc</span></span></code> </pre><br>  As a result of compiling, a new file hello.rcml.pc will appear in the created directory. <br><br><div class="spoiler">  <b class="spoiler_title">Screenshot command line after successful compiling</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/aea/c89/090/aeac8909022b4b5d8b131aa8e064a773.png"><br></div></div><br>  Now you need to make sure that the EV3 controller is on, paired with a Bluetooth adapter.  Gamepad must be connected to PC.  After that, you need to execute the command to execute the program file: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">rcml_intepreter</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.exe</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">hello</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.rcml</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">The appearance of the command line in the program</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/221/e42/ebb/221e42ebb94a42db9b4eb9a89e898a67.png"><br></div></div><br>  A video showing the robot movement program is located at the bottom of the article. <br><br>  4. The next step is to control the robot in manual mode using the keyboard. <br><br>  Further, the process of software communication between the engines of the robot and the keyboard will be demonstrated. <br><br>  Using the keyboard, you can control any engine of the robot.  Within the framework of the example, the following mechanisms are implemented: <br><br><ul><li>  Angle of rotation of the front wheels </li><li>  The direction of rotation of the rear wheels </li></ul><br><div class="spoiler">  <b class="spoiler_title">Listing of the program of interaction between the keyboard and the Lego robot based on the EV3 controller</b> <div class="spoiler_text"><pre> <code class="hljs ruby">function main() { @tr = robot_lego_ev3; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  @tr-&gt;setTrackVehicle(<span class="hljs-string"><span class="hljs-string">"B"</span></span>,<span class="hljs-string"><span class="hljs-string">"C"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   system.hand_control(@tr,<span class="hljs-string"><span class="hljs-string">"keyboard"</span></span>, <span class="hljs-string"><span class="hljs-string">"straight"</span></span>,<span class="hljs-string"><span class="hljs-string">"go"</span></span>, <span class="hljs-string"><span class="hljs-string">"speedMotorD"</span></span>,<span class="hljs-string"><span class="hljs-string">"rotate"</span></span>); }</code> </pre><br></div></div><br>  Next you should compile the program and execute it.  The result of the manual control of the Lego robot using the keyboard is shown in the video at the bottom of the page. <br><br>  5. In addition to the keyboard, a gamepad module is available that allows you to manipulate the robot using a gamepad.  To implement the control of the robot using a gamepad, it is necessary to describe at the program level which axes of the robot will assume the values ‚Äã‚Äãof the gamepad axes. <br><br><div class="spoiler">  <b class="spoiler_title">Program listing of gamepad and Lego robot interaction</b> <div class="spoiler_text"><pre> <code class="hljs ruby">function main() { @tr = robot_lego_ev3; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  @tr-&gt;setTrackVehicle(<span class="hljs-string"><span class="hljs-string">"B"</span></span>,<span class="hljs-string"><span class="hljs-string">"C"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   system.hand_control(@tr,<span class="hljs-string"><span class="hljs-string">"gamepad"</span></span>, <span class="hljs-string"><span class="hljs-string">"straight"</span></span>,<span class="hljs-string"><span class="hljs-string">" RTUD"</span></span>, <span class="hljs-string"><span class="hljs-string">"speedMotorD"</span></span>,<span class="hljs-string"><span class="hljs-string">" RTLR"</span></span>); }</code> </pre><br></div></div><br>  Next, you should repeat the process of compiling the program and then execute it.  The following shows the result of the manual control of the Lego robot using a gamepad, and all previously connected methods: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/C8YWgs2thqg%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiKGytazOJQ2gv2qVl415O95ypaEw" frameborder="0" allowfullscreen=""></iframe><br><br>  The article briefly demonstrated only some of the features of RCML.  The most detailed description is in the reference manual. </div><p>Source: <a href="https://habr.com/ru/post/371909/">https://habr.com/ru/post/371909/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../371899/index.html">Interview with American science fiction writer Nancy Kress: "Any radical new technology is always frightening"</a></li>
<li><a href="../371901/index.html">UK regulators punished the service, placing fake reviews about the products or services of its customers</a></li>
<li><a href="../371903/index.html">Quick help with muscle and joint pain (and after injury) before visiting the doctor</a></li>
<li><a href="../371905/index.html">Scientists have identified the mechanism of collective memory in populations of microorganisms</a></li>
<li><a href="../371907/index.html">The new Firefox 45 removed tab grouping. How to fix</a></li>
<li><a href="../371911/index.html">The founder of the electronic library LitMir blocked in the Russian Federation launched an exact copy of the resource on the new domain</a></li>
<li><a href="../371913/index.html">Video from surveillance cameras of a bus colliding with a Google car</a></li>
<li><a href="../371915/index.html">Amazon leased 20 cargo planes to build an internal delivery network</a></li>
<li><a href="../371917/index.html">The neural network turns scribbles into artistic masterpieces</a></li>
<li><a href="../371919/index.html">Technological evolution: A tour of the new trading floor of the New York Stock Exchange</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>