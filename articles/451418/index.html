<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The experience of creating position maps for Wikipedia</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For several years I worked on maps that are used in Russian and other language sections of Wikipedia. In total, I created more than 300 cards . I am n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The experience of creating position maps for Wikipedia</h1><div class="post__text post__text-html js-mediator-article"><p>  For several years I worked on maps that are used in Russian and other language sections of Wikipedia.  In total, I created <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D1%2587%25D0%25B0%25D1%2581%25D1%2582%25D0%25BD%25D0%25B8%25D0%25BA:Nzeemin/%25D0%259A%25D0%25B0%25D1%2580%25D1%2582%25D1%258B">more than 300 cards</a> .  I am not a professional cartographer, and I have no special education in this area.  Apparently, I just liked to make cards :) </p><br><p>  In this article, I want to share the experience of creating maps for Wikipedia, with a focus on positional maps. </p><br><p><img src="https://habrastorage.org/webt/hp/su/4t/hpsu4tdkk6v9rrd8kn3n45agwc4.png"><br>  <em><a href="">Physical Map of Canada</a></em> </p><a name="habracut"></a><br><h2 id="pozicionnye-karty">  Position Cards </h2><br><p>  All graphic materials for Wikipedia, published under free licenses, are posted on <a href="https://commons.wikimedia.org/">Wikimedia Commons</a> , this allows them to be used in any Wikimedia projects and in all language sections of Wikipedia. </p><br><p>  Among all types of maps on Wikipedia, the so-called ‚Äúposition maps‚Äù stand out.  The peculiarity here is that it is not just an image of a map, but an image in a known projection, with known geographic coordinates for corners.  For such a map, in each language section where it is used, a special template is created that describes this metadata.  Having such a template, we can apply it on any page, placing markers for objects of interest on top of the map.  The coordinates of the objects are described in the form of geographical coordinates, the formulas in the templates are calculated exactly where to put the marker.  For example, on the page about the region, you can insert a map of this region and mark regional centers and major cities on it. </p><br><p><img src="https://habrastorage.org/webt/b_/kt/fd/b_ktfd2ti_blmrd0szjrvbelzs4.png"><br>  <em>An example of using a <a href="https://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B0%25D0%25B1%25D0%25BB%25D0%25BE%25D0%25BD:%25D0%259F%25D0%25BE%25D0%25B7%25D0%259A%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0_%25D0%2592%25D0%25B5%25D0%25BB%25D0%25B8%25D0%25BA%25D0%25BE%25D0%25B1%25D1%2580%25D0%25B8%25D1%2582%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F_%25D0%25A4%25D0%25BE%25D0%25BB%25D0%25BA%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B4%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B5_%25D0%25BE%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0">positional card</a> in a <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B5%25D0%25B1%25D0%25B1%25D0%25BB">Pebble</a> Island article card.</em>  <em>The red marker and the inscription are automatically placed in place of the object on top of the map image.</em> </p><br><p>  Position maps are used in all articles on administrative units: countries / districts / cities / towns, etc., as well as in many articles on geographical features.  It often turns out that immediately after creating a positional map, it is used in 20-50 existing Wikipedia articles. </p><br><p>  In a positional map template, in theory, two map drawings should be used at once: a ‚Äúcontour‚Äù / ‚Äúpolitical‚Äù map, and a ‚Äúphysical‚Äù / ‚Äúgeographical‚Äù map with the same coordinates, projection, and dimensions.  The contour map is usually vector (SVG), the physical map can be vector, but most often it is raster (usually PNG). </p><br><p><img src="https://habrastorage.org/webt/yd/ym/mf/ydymmfiypxl56rgwzefe6uooaoq.png"><br>  <em><a href="https://ru.wikipedia.org/wiki/%25D0%25A8%25D0%25B0%25D0%25B1%25D0%25BB%25D0%25BE%25D0%25BD:%25D0%259F%25D0%25BE%25D0%25B7%25D0%259A%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0_%25D0%259A%25D0%25B0%25D0%25B7%25D0%25B0%25D1%2585%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD_%25D0%2592%25D0%25BE%25D1%2581%25D1%2582%25D0%25BE%25D1%2587%25D0%25BD%25D0%25BE-%25D0%259A%25D0%25B0%25D0%25B7%25D0%25B0%25D1%2585%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25BE%25D0%25B1%25D0%25BB%25D0%25B0%25D1%2581%25D1%2582%25D1%258C">Example of a positional map template with two types of maps</a></em> </p><br><p>  There are a lot of positional maps: they must cover all levels from the world as a whole to individual regions, small islands, etc.  In addition to the positional map, so-called so-called is created for all administrative objects  ‚ÄúLocator‚Äù is a map on which the region of interest is highlighted with a bright color ( <a href="https://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25B0%25D0%25B9%25D0%25BB:East_Kazakhstan_in_Kazakhstan.svg">an example of a</a> map-locator).  At the ‚Äúupper‚Äù level (world, country) with position maps, everything is relatively good, but at the ‚Äúlower‚Äù level (level of districts) everything is often quite bad: there are no position maps or there are, but of insufficient quality, or made in an inappropriate / non-standard style. </p><br><p>  Only for the Russian Federation, we have 83 subjects, if we add to this area, then we‚Äôll probably get a thousand or more administrative units, each of which needs a position map, including a contour map, a physical map, a locator card ... In addition, from time to time there are changes in the form ‚Äúa new decree has been issued‚Äù: a legal document appears that changes the boundaries of administrative units, divides / unites them, etc.  And of course, in all such cases, you need to redraw one or more position maps. </p><br><p>  In general, I think you already understood - the cards are very necessary and they need a lot :) </p><br><h2 id="ishodnye-dannye-dlya-kart">  Initial data for maps </h2><br><p>  For position maps, images with a free license should be used.  This means that the source data for such cards must be free. </p><br><p>  Baseline data for the maps I used: </p><br><ul><li>  OpenStreetMap - the main source of vector data;  but it should be borne in mind that the data obtained by crowdsourcing, therefore, in some places they are dense and high-quality, sometimes very incomplete.  There are also errors in the data, so the resulting cards must be carefully checked. </li><li>  GSHHG - vector data in GMT (see below);  can be used for maps of large scales, poorly suited for small scales. </li><li>  ETOPO1 (resolution ~ 1.85 km, volume ~ 890 MB), ETOPO2 (resolution 2 '= 3.6 km) - elevation maps, including the seabed topography (bathymetry). </li><li>  TOPO30 (resolution ~ = 0.9 km, volume ~ 1800 MB) - elevation map, including the seabed topography. </li><li>  GLOBE (resolution 30 "~ = 0.9 km) - elevation map. </li><li>  <a href="https://ru.wikipedia.org/wiki/Shuttle_Radar_Topography_Mission">SRTM</a> (SRTM3 resolution: 3 "~ = 90m) is a rather detailed height map, but because of this it is rather heavy (each 1x1 degree file weighs ~ 2.8 MB), so you usually have to download only the files you need. In addition, the SRTM source data has gaps that need to be closed by interpolating the missing points by adjacent ones. You can do this yourself, or use ‚Äúvoid-filled" source code, such as SRTM-Plus. SRTM is a height map only for sushi, does not contain data on the seabed topography. </li></ul><br><h2 id="proekcii">  Projections </h2><br><p>  In the overwhelming majority of cases we work with a projection which is called ‚Äúequidistant cylindrical‚Äù.  This same family of projections includes the Mercator projection and its special case - ‚ÄúGoogle projection‚Äù or ‚ÄúWeb Mercator projection‚Äù, which is used by all major web maps.  The formulas for this projection are fairly simple, moreover, the templates of positional maps already ‚Äúknow‚Äù this projection. </p><br><p>  In the remaining few cases, you will have to google the desired projection and read the special literature in order to understand exactly how the x, y coordinates are derived from latitude and longitude.  Mediawiki has an advanced mechanism for calculating expressions (including those with trigonometric functions), you can use it to check your maps, even before you make a position map template on them (examples can be viewed <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D1%2587%25D0%25B0%25D1%2581%25D1%2582%25D0%25BD%25D0%25B8%25D0%25BA:Nzeemin/%25D0%259F%25D0%25BE%25D0%25B7%25D0%259A%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B5%25D0%25BA%25D1%2586%25D0%25B8%25D0%25B8">here</a> ). </p><br><h2 id="instrumenty-dlya-sozdaniya-kart">  Map Creation Tools </h2><br><p>  There are a lot of tools for creating maps (geographic information systems, GIS), including free and open source.  But in order for a card to be open it is not necessary to use an open and free system, it is enough that the original data is open, and that you yourself put an open license on the finished card.  (But there must be a lot of nuances here, I don‚Äôt dare to get into the area of ‚Äã‚Äãcopyright, not mine :) </p><br><p>  To create maps, I used mainly three programs described below. </p><br><h3 id="maperitive">  Maaperitive </h3><br><p>  <a href="http://maperitive.net/">Maperitive</a> is a free, but closed product.  It is extremely useful when working with data OpenStreetMap, works with data from both the OSM site, and with saved dumps.  Allows you to select a stylus and save the map in SVG format.  There are a number of ready-made stylists and you can write your own.  I have prepared several style files, and use them for exporting to the SVG borders of the districts, and maps of the districts with settlements. </p><br><h3 id="generic-mapping-tools-gmt">  Generic Mapping Tools (GMT) </h3><br><p>  In general, Generic Mapping Tools (GMT) is a free set of command line utilities designed to process and visualize scientific data, including a number of its tools that allow you to work with geodata, i.e.  we can use GMT as a console GIS.  The finished map (or a separate layer for the future map) is obtained as a result of a sequence of invoking utilities.  Usually I write a batch file in which all parameters are set and utilities are invoked.  At first glance it looks difficult, but to me as a programmer, this approach seems clear and familiar.  In addition, repeatability is provided here: to create the map again, I can always run the script again. </p><br><p>  An example of a batch file (see also <a href="https://ru.wikipedia.org/wiki/%25D0%25A3%25D1%2587%25D0%25B0%25D1%2581%25D1%2582%25D0%25BD%25D0%25B8%25D0%25BA:Nzeemin/%25D0%259A%25D0%25B0%25D1%2580%25D1%2582%25D1%258B/%25D0%25A1%25D0%25BE%25D0%25B7%25D0%25B4%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5_%25D1%2580%25D0%25B5%25D0%25BB%25D1%258C%25D0%25B5%25D1%2584%25D0%25B0">here</a> ): </p><br><pre><code class="plaintext hljs">set PATH=C:\programs\GMT5\bin;%PATH% set GSBIN=C:\PROGRA~1\gs\gs9.04/bin set COORDSCUT=144.7492/157.3007/42.9694/51.3837 rem width = xmaxsvg / 150.0 * 2.54 set PAPERX=14.9352 rem height = ymaxsvg / 150.0 * 2.54 set PAPERY=16.0189333333333 grdcut.exe ETOPO1_Bed_g_gmt4.grd -R%COORDSCUT% -Gh_cor_cut.grd grdgradient h_cor_cut.grd -Ne0.3 -A315 -M -Ghi.grd grdimage h_cor_cut.grd -Ihi.grd -Cwiki-water-verlauf2.cpt -P -R%COORDSCUT% -JX%PAPERX%cd/%PAPERY%cd --PAPER_MEDIA=Custom_%PAPERX%cx%PAPERY%c -X0 -Y0 -K &gt; map.eps pscoast.exe -JX%PAPERX%cd/%PAPERY%cd -R%COORDSCUT% -Gc -P -Df --PAPER_MEDIA=Custom_%PAPERX%cx%PAPERY%c -X0 -Y0 -O -K &gt;&gt; map.eps grdimage h_cor_cut.grd -Ihi.grd -Cmount.cpt -P -R%COORDSCUT% -JX%PAPERX%cd/%PAPERY%cd --PAPER_MEDIA=Custom_%PAPERX%cx%PAPERY%c -X0 -Y0 -O -K &gt;&gt; map.eps pscoast.exe -JX%PAPERX%cd/%PAPERY%cd -R%COORDSCUT% -Q -P -Df --PAPER_MEDIA=Custom_%PAPERX%cx%PAPERY%c -X0 -Y0 -O -K &gt;&gt; map.eps pscoast.exe -JX%PAPERX%cd/%PAPERY%cd -R%COORDSCUT% -Na -Ia/0.25p,#0978AB -W0.25,#0978AB -P -Df --PAPER_MEDIA=Custom_%PAPERX%cx%PAPERY%c -X0 -Y0 -O &gt;&gt; map.eps %GSBIN%\gswin32c.exe -dSAFER -dBATCH -dNOPAUSE -dGraphicsAlphaBits=4 -sDEVICE=pngalpha -dEPSCrop -r150 -sOutputFile=Oblast_etopo.png map.eps</code> </pre> <br><p>  Result: <br><img src="https://habrastorage.org/webt/5t/za/e9/5tzae9e1eymokaachw8zt2faejc.png"></p><br><p>  As part of GMT, along with the command line tools, data is also supplied, this set is called <a href="http://www.soest.hawaii.edu/pwessel/gshhg/">GSHHG</a> , maps from this data are created using the <code>pscoast</code> utility included in GMT. </p><br><h3 id="inkscape">  Inkscape </h3><br><p>  <a href="https://inkscape.org/">Inkscape</a> is a free and open vector graphics editor, the main format of which is SVG. </p><br><p>  Maperitive and GMT I usually use as tools for the preparation of individual layers of the future map.  Then the resulting layers are imported into separate layers in the Inkscape document, and all the final work on the map is already there.  For example, for a positional map, it is necessary that the area shown on the map be ‚Äúhighlighted‚Äù ‚Äîthe color on the outline map and the shading on the physical map.  This is already manual work on objects and layers in Inkscape. </p><br><p>  The final step in preparing the map images will be to save the SVG (for the vector map) or export the PNG (for the raster). </p><br><h2 id="process-sozdaniya-karty">  Card making process </h2><br><ol><li>  I usually begin by taking the area of ‚Äã‚Äãthe future map and looking at the source data that I have for this area.  I create a primitive contour map via GMT on GSHHG data, try to render the relief of the same area on ETOPO1, TOPO30 data, see how this area looks in OpenStreetMap.  It happens that I refuse to create a map at this stage, if I see that the available data is not enough or they are of poor quality, contain errors or large gaps. </li><li>  Next, based on approximate renders, I choose on which data I will make the map. </li><li>  Create separate layers of the map.  As a rule, a layer of boundaries is obtained separately (for example, a vector from OSM), a separate relief pattern for land and a separate layer of underwater relief (bathymetry), a separate coastline layer and a layer of rivers and reservoirs.  It often happens that two raster layers have different resolutions, and here you have to play with interpolation, so that they look more or less organic.  For example, the terrain map for sushi is taken from ETOPO1, because this area is better represented there, and bathymetry is taken from TOPO30, and the resolution of these two sources differs twice.  Then, for a lower resolution, we do an increase in the resolution with interpolation so that no ‚Äúsquares‚Äù appear, no moire effect appears, etc. </li><li>  Using Inkscape, we put together separate layers of the map.  We perform the necessary manual work, if necessary.  We try to export the map to a raster, carefully review and identify shortcomings, correct and repeat.  The result is map files ready for uploading to Commons. </li><li>  We upload map files to Wikimedia Commons; we document there.  Each file should be written about what kind of map it is, which object, with which coordinates and in which projection, which source data was used with which licenses, and which tools the work was done. </li><li>  Create or update a positional card template in ru-wiki, check its use.  Make sure that the objects are placed in the right places of the map, i.e.  that the coordinates of the corners of the map are set correctly, and the map itself corresponds to these coordinates.  After that, we update the templates for this positional map in other language sections. </li></ol><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  It took me from 20-30 minutes to create one map (in simple cases, when a number of similar maps of regions are done as on a conveyor), up to 4-6 hours (in difficult cases, when there were problems with the source data and a lot of manual work was needed work).  It took me several days to go to the physical map of Canada (see KDPV): it took me to select a projection that was already used on the contour map. </p><br><p>  If we talk about "what I get from this," then probably - a lot of aesthetic pleasure, from what cards are obtained. </p><br><p>  Thank you for reading, I hope my experience will somehow come in handy :) </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/451418/">https://habr.com/ru/post/451418/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451408/index.html">Ultrasound gps</a></li>
<li><a href="../45141/index.html">Jerry Yang retires from Yahoo! CEO</a></li>
<li><a href="../451410/index.html">Unstated-next: minimalist state management of a React application</a></li>
<li><a href="../451412/index.html">How Mars Loses Water - A Simulated Scientific Study</a></li>
<li><a href="../451414/index.html">VR \ AR armed with digital retail</a></li>
<li><a href="../451420/index.html">Basic knowledge of site security</a></li>
<li><a href="../451426/index.html">MSI / 55 - the old terminal for ordering goods to a branch in the central store</a></li>
<li><a href="../45143/index.html">Human memory</a></li>
<li><a href="../451432/index.html">The digest of interesting materials for the mobile developer # 297 (May 6 - 12)</a></li>
<li><a href="../451434/index.html">How I bought a fiber laser marker in Russia + the nuances of choosing devices for engraving and marking in 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>