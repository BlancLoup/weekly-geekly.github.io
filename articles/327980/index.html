<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>3 administrative scripts</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is necessary to revive the public, so some administrative scripts. 

 1. Get network settings and configs of domain computers 
 2. Change the defau...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>3 administrative scripts</h1><div class="post__text post__text-html js-mediator-article">  It is necessary to revive the public, so some administrative scripts. <br><br>  1. Get network settings and configs of domain computers <br>  2. Change the default gateway on domain computers <br>  3. Get mailbox statistics <br><br><h3>  1. Get network settings and configs of domain computers. </h3><br>  Bypasses domain computers and collects information from them.  At the exit of the full object is thrown.  The computer must be turned on of course.  The script contains an example of working through WMI.  Run from domain. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs smalltalk">#     <span class="hljs-string"><span class="hljs-string">$c</span></span>red = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">Credential</span></span> &lt;anchor&gt;habracut&lt;/anchor&gt; <span class="hljs-string"><span class="hljs-string">$C</span></span>lients = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">ADComputer</span></span> -<span class="hljs-type"><span class="hljs-type">Filter</span></span> * | <span class="hljs-type"><span class="hljs-type">Sort</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> name | <span class="hljs-type"><span class="hljs-type">Select</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> name <span class="hljs-string"><span class="hljs-string">$C</span></span>ompData = @() foreach (<span class="hljs-string"><span class="hljs-string">$c</span></span>li in <span class="hljs-string"><span class="hljs-string">$C</span></span>lients) { if (( <span class="hljs-type"><span class="hljs-type">Test</span></span>-<span class="hljs-type"><span class="hljs-type">Connection</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>li.<span class="hljs-type"><span class="hljs-type">Name</span></span> -<span class="hljs-type"><span class="hljs-type">Count</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> -<span class="hljs-type"><span class="hljs-type">Quiet</span></span> ) -eq <span class="hljs-string"><span class="hljs-string">'True'</span></span>) { if (<span class="hljs-string"><span class="hljs-string">$c</span></span>li.name -ne <span class="hljs-string"><span class="hljs-string">$e</span></span>nv:<span class="hljs-type"><span class="hljs-type">COMPUTERNAME</span></span>) { #   <span class="hljs-type"><span class="hljs-type">WMI</span></span> <span class="hljs-string"><span class="hljs-string">$o</span></span>s = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">WmiObject</span></span> -<span class="hljs-type"><span class="hljs-type">ComputerName</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>li.name <span class="hljs-type"><span class="hljs-type">Win32_OperatingSystem</span></span> -<span class="hljs-type"><span class="hljs-type">Credential</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>red <span class="hljs-string"><span class="hljs-string">$n</span></span>et = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">WmiObject</span></span> -<span class="hljs-type"><span class="hljs-type">Class</span></span> <span class="hljs-type"><span class="hljs-type">Win32_NetWorkAdapterConfiguration</span></span> -<span class="hljs-type"><span class="hljs-type">Filter</span></span> <span class="hljs-type"><span class="hljs-type">IPEnabled</span></span>=<span class="hljs-type"><span class="hljs-type">TRUE</span></span> -<span class="hljs-type"><span class="hljs-type">ComputerName</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>li.name -<span class="hljs-type"><span class="hljs-type">Credential</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>red <span class="hljs-string"><span class="hljs-string">$n</span></span>ic = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">WmiObject</span></span> -<span class="hljs-type"><span class="hljs-type">Class</span></span> <span class="hljs-type"><span class="hljs-type">Win32_NetWorkAdapter</span></span> -<span class="hljs-type"><span class="hljs-type">ComputerName</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>li.name -<span class="hljs-type"><span class="hljs-type">Credential</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>red | where {<span class="hljs-string"><span class="hljs-string">$_</span></span>.adaptertype -eq <span class="hljs-string"><span class="hljs-string">'Ethernet 802.3'</span></span>} | where { <span class="hljs-string"><span class="hljs-string">$_</span></span>.<span class="hljs-type"><span class="hljs-type">NetEnabled</span></span> -eq <span class="hljs-string"><span class="hljs-string">'True'</span></span>} <span class="hljs-string"><span class="hljs-string">$d</span></span>isk = <span class="hljs-type"><span class="hljs-type">Get</span></span>-<span class="hljs-type"><span class="hljs-type">WmiObject</span></span> -<span class="hljs-type"><span class="hljs-type">Class</span></span> <span class="hljs-type"><span class="hljs-type">Win32_DiskDrive</span></span> -<span class="hljs-type"><span class="hljs-type">ComputerName</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>li.name -<span class="hljs-type"><span class="hljs-type">Credential</span></span> <span class="hljs-string"><span class="hljs-string">$c</span></span>red <span class="hljs-string"><span class="hljs-string">$p</span></span>rops = [ordered]@{ <span class="hljs-type"><span class="hljs-type">Name</span></span>=<span class="hljs-string"><span class="hljs-string">$o</span></span>s.<span class="hljs-type"><span class="hljs-type">CSName</span></span> <span class="hljs-type"><span class="hljs-type">OSName</span></span>=<span class="hljs-string"><span class="hljs-string">$o</span></span>s.<span class="hljs-type"><span class="hljs-type">Caption</span></span> <span class="hljs-type"><span class="hljs-type">OSSN</span></span>=<span class="hljs-string"><span class="hljs-string">$o</span></span>s.<span class="hljs-type"><span class="hljs-type">SerialNumber</span></span> <span class="hljs-type"><span class="hljs-type">OSVersion</span></span>=<span class="hljs-string"><span class="hljs-string">$o</span></span>s.<span class="hljs-type"><span class="hljs-type">Version</span></span> <span class="hljs-type"><span class="hljs-type">OSSystemDirectory</span></span>=<span class="hljs-string"><span class="hljs-string">$o</span></span>s.<span class="hljs-type"><span class="hljs-type">SystemDirectory</span></span> <span class="hljs-type"><span class="hljs-type">OSBuild</span></span>=<span class="hljs-string"><span class="hljs-string">$o</span></span>s.<span class="hljs-type"><span class="hljs-type">BuildNumber</span></span> <span class="hljs-type"><span class="hljs-type">OSMUI</span></span>=<span class="hljs-string"><span class="hljs-string">$o</span></span>s.<span class="hljs-type"><span class="hljs-type">MUILanguages</span></span> <span class="hljs-type"><span class="hljs-type">OSBootDevice</span></span>=<span class="hljs-string"><span class="hljs-string">$o</span></span>s.<span class="hljs-type"><span class="hljs-type">BootDevice</span></span> <span class="hljs-type"><span class="hljs-type">NICNetConnectionID</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">NetConnectionID</span></span> <span class="hljs-type"><span class="hljs-type">NICName</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">Name</span></span> <span class="hljs-type"><span class="hljs-type">NICDeviceID</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">DeviceID</span></span> <span class="hljs-type"><span class="hljs-type">NICAdapterType</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">AdapterType</span></span> <span class="hljs-type"><span class="hljs-type">NICIndex</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">Index</span></span> <span class="hljs-type"><span class="hljs-type">NICInterfaceIndex</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">InterfaceIndex</span></span> <span class="hljs-type"><span class="hljs-type">NICMAC</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">MACAddress</span></span> <span class="hljs-type"><span class="hljs-type">NICManufacturer</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">Manufacturer</span></span> <span class="hljs-type"><span class="hljs-type">NICNetEnabled</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">NetEnabled</span></span> <span class="hljs-type"><span class="hljs-type">NICPhysical</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">PhysicalAdapter</span></span> <span class="hljs-type"><span class="hljs-type">NICProductName</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">ProductName</span></span> <span class="hljs-type"><span class="hljs-type">NICServiceName</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">ServiceName</span></span> <span class="hljs-type"><span class="hljs-type">NICSpeed</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>ic.<span class="hljs-type"><span class="hljs-type">Speed</span></span> <span class="hljs-type"><span class="hljs-type">NetDHCPEnabled</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>et.<span class="hljs-type"><span class="hljs-type">DHCPEnabled</span></span> <span class="hljs-type"><span class="hljs-type">NetIPAddress</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>et.<span class="hljs-type"><span class="hljs-type">IPAddress</span></span> <span class="hljs-type"><span class="hljs-type">NetDefaultGateway</span></span>=<span class="hljs-string"><span class="hljs-string">$n</span></span>et.<span class="hljs-type"><span class="hljs-type">DefaultIPGateway</span></span> <span class="hljs-type"><span class="hljs-type">DiskName</span></span>=<span class="hljs-string"><span class="hljs-string">$d</span></span>isk.<span class="hljs-type"><span class="hljs-type">Caption</span></span> <span class="hljs-type"><span class="hljs-type">DiskStatus</span></span>=<span class="hljs-string"><span class="hljs-string">$d</span></span>isk.<span class="hljs-type"><span class="hljs-type">Status</span></span> <span class="hljs-type"><span class="hljs-type">DiskDeviceId</span></span>=<span class="hljs-string"><span class="hljs-string">$d</span></span>isk.deviceid <span class="hljs-type"><span class="hljs-type">DiskSerialNumber</span></span>=<span class="hljs-string"><span class="hljs-string">$d</span></span>isk.serialnumber <span class="hljs-type"><span class="hljs-type">DiskSize</span></span>=<span class="hljs-string"><span class="hljs-string">$d</span></span>isk.size } <span class="hljs-string"><span class="hljs-string">$o</span></span>bj = <span class="hljs-type"><span class="hljs-type">New</span></span>-<span class="hljs-type"><span class="hljs-type">Object</span></span> -<span class="hljs-type"><span class="hljs-type">TypeName</span></span> <span class="hljs-type"><span class="hljs-type">PSObject</span></span> -<span class="hljs-type"><span class="hljs-type">Property</span></span> <span class="hljs-string"><span class="hljs-string">$p</span></span>rops <span class="hljs-string"><span class="hljs-string">$C</span></span>ompData += <span class="hljs-string"><span class="hljs-string">$o</span></span>bj } } } <span class="hljs-string"><span class="hljs-string">$C</span></span>ompData</code> </pre> <br><h3>  2. Change the default gateway </h3><br>  We modify the previous script so that it changes the default gateway.  (Be sure to check everything in your environment before running it on a live system!) It uses WMI calls to change the gateway.  through Povercell, you need to remove and re-create the adapter, which will lead to loss of communication with the computer.  Tested on Powershell 4 and 3, win 2012 and 8. <br><br><pre> <code class="hljs mel">$cred = Get-Credential $OldGateway = <span class="hljs-string"><span class="hljs-string">'192.168.30.1'</span></span> $NewGateway = <span class="hljs-string"><span class="hljs-string">'192.168.30.50'</span></span> $Clients = Get-ADComputer -Filter * | Sort-Object name | Select-Object name $CompData = @() foreach ($cli <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $Clients) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (( Test-Connection $cli.Name -Count <span class="hljs-number"><span class="hljs-number">2</span></span> -Quiet ) -eq <span class="hljs-string"><span class="hljs-string">'True'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($cli.name -ne $env:COMPUTERNAME) { $os = Get-WmiObject -ComputerName $cli.name Win32_OperatingSystem -Credential $cred $net = Get-WmiObject -Class Win32_NetWorkAdapterConfiguration -Filter IPEnabled=TRUE -ComputerName $cli.name -Credential $cred $nic = Get-WmiObject -Class Win32_NetWorkAdapter -ComputerName $cli.name -Credential $cred | where {$_.adaptertype -eq <span class="hljs-string"><span class="hljs-string">'Ethernet 802.3'</span></span>} | where { $_.NetEnabled -eq <span class="hljs-string"><span class="hljs-string">'True'</span></span>} $disk = Get-WmiObject -Class Win32_DiskDrive -ComputerName $cli.name -Credential $cred $props = [ordered]@{ Name=$os.CSName OSName=$os.Caption OSSN=$os.SerialNumber OSVersion=$os.Version OSSystemDirectory=$os.SystemDirectory OSBuild=$os.BuildNumber OSMUI=$os.MUILanguages OSBootDevice=$os.BootDevice NICNetConnectionID=$nic.NetConnectionID NICName=$nic.Name NICDeviceID=$nic.DeviceID NICAdapterType=$nic.AdapterType NICIndex=$nic.Index NICInterfaceIndex=$nic.InterfaceIndex NICMAC=$nic.MACAddress NICManufacturer=$nic.Manufacturer NICNetEnabled=$nic.NetEnabled NICPhysical=$nic.PhysicalAdapter NICProductName=$nic.ProductName NICServiceName=$nic.ServiceName NICSpeed=$nic.Speed NetDHCPEnabled=$net.DHCPEnabled NetIPAddress=$net.IPAddress NetDefaultGateway=$net.DefaultIPGateway DiskName=$disk.Caption DiskStatus=$disk.Status DiskDeviceId=$disk.deviceid DiskSerialNumber=$disk.serialnumber DiskSize=$disk.<span class="hljs-keyword"><span class="hljs-keyword">size</span></span> } $obj = New-Object -TypeName PSObject -Property $props $CompData += $obj } } } #$CompData ################################################################ #   foreach($Co <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $CompData) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($Co.NetDefaultGateway = $OldGateway) { $Co.Name $Co.netdefaultgateway $NWCards = Get-WmiObject Win32_NetworkAdapterConfiguration -ComputerName $co.Name -Credential $cred | where{ $_.ipenabled -eq $true } foreach ($nwc <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $NWCards) { $gateway = $nwc.defaultipgateway <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($gateway -eq $OldGateway) { $nwc.setgateways($NewGateway) } } } }</code> </pre><br><h3>  3. Get mailbox statistics </h3><br>  Collects statistics of top boxes by size, top boxes by the number of letters, top boxes by deleted items (purge basket 2 has not yet happened, just deleting letters by the user), then it forms a ‚Äúbeautiful‚Äù HTML report and sends it to the mail and adds it to the daddy.  It was used as a monthly reporter of the state of the base, installed in the task scheduler.  Run on the exchange server.  Tested on Exchange 2010. <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">#</span></span></span><span class="hljs-tag">     </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">25</span></span></span><span class="hljs-tag">        #&gt;</span></span> Param ( [int]$TopCount = 25, [boolean]$SaveReport = $false, [string]$ReportPath = 'C:\Reports\MailboxReport.html', [boolean]$SendReport = $true, [string]$ReportMail1 = 'admin@mail.local' ) # check snapin present $EX2010 = $false $snaps = Get-PSSnapin foreach( $snap in $snaps ) { if ($snap.Name -eq 'Microsoft.Exchange.Management.PowerShell.E2010') { $EX2010 = $true } } if ($EX2010 -eq $false) { Add-PSSnapin Microsoft.Exchange.Management.PowerShell.E2010 } $boxes = Get-Mailbox | Get-MailboxStatistics | sort TotalItemSize -Descending $TotalSize = $boxes | sort TotalItemSize -Descending | select -First $TopCount #    $Size = @() foreach ($box in $TotalSize) { $propsTotalSize = [ordered]@{ DisplayName=$box.DisplayName User=$box.LastLoggedOnUserAccount Database=$box.Database TotalSize=$box.TotalItemSize ItemCount=$box.ItemCount DeletedItemCount=$box.DeletedItemCount TotalDeletedSize=$box.TotalDeletedItemSize } $obj = New-Object -TypeName PSObject -Property $propsTotalSize $Size += $obj } #    purge $Deleted = $boxes | sort TotalDeletedItemSize -Descending | select -First $TopCount $Del = @() foreach ($box in $Deleted) { $propsDeleted = [ordered]@{ DisplayName=$box.DisplayName User=$box.LastLoggedOnUserAccount Database=$box.Database TotalSize=$box.TotalItemSize ItemCount=$box.ItemCount DeletedItemCount=$box.DeletedItemCount TotalDeletedSize=$box.TotalDeletedItemSize } $obj = New-Object -TypeName PSObject -Property $propsDeleted $Del += $obj } #    ,               $Top = $boxes | sort ItemCount -Descending | select -First $TopCount $TopItems = @() foreach ($box in $Top) { $propsTopItems = [ordered]@{ DisplayName=$box.DisplayName User=$box.LastLoggedOnUserAccount Database=$box.Database TotalSize=$box.TotalItemSize ItemCount=$box.ItemCount DeletedItemCount=$box.DeletedItemCount TotalDeletedSize=$box.TotalDeletedItemSize } $obj = New-Object -TypeName PSObject -Property $propsTopItems $TopItems += $obj } ##### HTML generating Write-Verbose 'HTML fragment producing' $fragTopItems = $TopItems | ConvertTo-Html -As table -Fragment -PreContent '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>     (items count)<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>' | Out-String $fragTopSizes = $Size | ConvertTo-Html -As table -Fragment -PreContent '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>' | Out-String $fragTopDelItems = $Del | ConvertTo-Html -As table -Fragment -PreContent '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>     (purge   )<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span>' | Out-String Write-Verbose 'definiting CSS' $head = @' <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">body</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">background-color</span></span></span><span class="css">:</span><span class="hljs-number"><span class="css"><span class="hljs-number">#ffffff</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">font-family</span></span></span><span class="css">:Tahoma; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">font-size</span></span></span><span class="css">:</span><span class="hljs-number"><span class="css"><span class="hljs-number">12pt</span></span></span><span class="css">; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">td</span></span></span><span class="css">, </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">th</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border</span></span></span><span class="css">:</span><span class="hljs-number"><span class="css"><span class="hljs-number">1px</span></span></span><span class="css"> solid black; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-collapse</span></span></span><span class="css">:collapse; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">th</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">color</span></span></span><span class="css">:white; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">background-color</span></span></span><span class="css">:black; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">table</span></span></span><span class="css">, </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">tr</span></span></span><span class="css">, </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">td</span></span></span><span class="css">, </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">th</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">padding</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">2px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">margin</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0px</span></span></span><span class="css"> } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">table</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">font-family</span></span></span><span class="css">: </span><span class="hljs-string"><span class="css"><span class="hljs-string">"Lucida Sans Unicode"</span></span></span><span class="css">, </span><span class="hljs-string"><span class="css"><span class="hljs-string">"Lucida Grande"</span></span></span><span class="css">, Sans-Serif; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">font-size</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">14px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-radius</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">10px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-spacing</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">text-align</span></span></span><span class="css">: center; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">th</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">background</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">#BCEBDD</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">color</span></span></span><span class="css">: white; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">text-shadow</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">1px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">1px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">#2D2020</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">padding</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">10px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">20px</span></span></span><span class="css">; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">th</span></span></span><span class="css">, </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">td</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-style</span></span></span><span class="css">: solid; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">1px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">1px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-color</span></span></span><span class="css">: white; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">th</span></span></span><span class="hljs-selector-pseudo"><span class="css"><span class="hljs-selector-pseudo">:first-child</span></span></span><span class="css">, </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">td</span></span></span><span class="hljs-selector-pseudo"><span class="css"><span class="hljs-selector-pseudo">:first-child</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">text-align</span></span></span><span class="css">: left; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">th</span></span></span><span class="hljs-selector-pseudo"><span class="css"><span class="hljs-selector-pseudo">:first-child</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-top-left-radius</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">10px</span></span></span><span class="css">; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">th</span></span></span><span class="hljs-selector-pseudo"><span class="css"><span class="hljs-selector-pseudo">:last-child</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-top-right-radius</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">10px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-right</span></span></span><span class="css">: none; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">td</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">padding</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">10px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">20px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">background</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">#F8E391</span></span></span><span class="css">; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">tr</span></span></span><span class="hljs-selector-pseudo"><span class="css"><span class="hljs-selector-pseudo">:last-child</span></span></span><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">td</span></span></span><span class="hljs-selector-pseudo"><span class="css"><span class="hljs-selector-pseudo">:first-child</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-radius</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">10px</span></span></span><span class="css">; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">tr</span></span></span><span class="hljs-selector-pseudo"><span class="css"><span class="hljs-selector-pseudo">:last-child</span></span></span><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">td</span></span></span><span class="hljs-selector-pseudo"><span class="css"><span class="hljs-selector-pseudo">:last-child</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-radius</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">10px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">0</span></span></span><span class="css">; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">tr</span></span></span><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">td</span></span></span><span class="hljs-selector-pseudo"><span class="css"><span class="hljs-selector-pseudo">:last-child</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border-right</span></span></span><span class="css">: none; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> '@ Write-Verbose 'HTML producing' $Date = Get-Date if ($SaveReport = $true) { $rep = ConvertTo-HTML -head $head -PostContent $fragTopSizes, $fragTopDelItems, $fragTopItems -PreContent "<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>    $Date<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>" | Out-String $rep | Out-File $ReportPath } # Sending Email to admins if ($SendReport = $true) { $encoding = [System.Text.Encoding]::UTF8 $body = ConvertTo-HTML -head $head -PostContent $fragTopSizes, $fragTopDelItems, $fragTopItems -PreContent "<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>    $Date<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>" | Out-String Write-Verbose "Sending e-mail" $params = @{'To'=$ReportMail1 'From'='bot@geomex.local' 'Subject'="Mailbox report $Date" 'Body'=$Body 'BodyAsHTML'=$True 'SMTPServer'='mail.domain.local'} Send-MailMessage @params -Encoding $encoding }</code> </pre><br>  All with the May holidays. </div><p>Source: <a href="https://habr.com/ru/post/327980/">https://habr.com/ru/post/327980/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327962/index.html">Experience DataLine: the work of technical support service</a></li>
<li><a href="../327966/index.html">Technosphere Lectures: Go Programming</a></li>
<li><a href="../327970/index.html">Roskomnadzor is trying to finish off Rutracker. Locking server announcers and workarounds</a></li>
<li><a href="../327974/index.html">South Korea: what any developer who wants to localize his mobile game needs to know</a></li>
<li><a href="../327978/index.html">Neuroclot: Part 1. Installing the Raspberry Pi and the cameras in the chicken coop and setting them up</a></li>
<li><a href="../327982/index.html">Reaction to user feedback in order to increase the average rating</a></li>
<li><a href="../327984/index.html">Mikrotik guarding temperature</a></li>
<li><a href="../327986/index.html">We broadcast a video stream from a web page via WebRTC to Facebook and YouTube at the same time</a></li>
<li><a href="../327988/index.html">Free from all shackles: Emercoin version 6.2 has become completely decentralized</a></li>
<li><a href="../327990/index.html">Pentestit Security Conference 2017: reports</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>