<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Contour.Elba for Android. Developer Notes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the end of last year, I joined the Elba web service team, and we started developing an ‚Äúelectronic accountant‚Äù for Android. 

 In this post I will ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Contour.Elba for Android. Developer Notes</h1><div class="post__text post__text-html js-mediator-article"><img align="left" src="https://habrastorage.org/files/358/85a/390/35885a39048140769e21df4e089abb32.png">  At the end of last year, I joined the Elba web service team, and we started developing an ‚Äúelectronic accountant‚Äù for Android. <br><br>  In this post I will talk about why we abandoned the mobile version of the site in favor of the applications, which rakes we came to during the development process and what came of it. <br><br>  The article will be useful: <ul><li>  Android developers; </li><li>  Web service development managers who are thinking of entering the mobile market; </li><li>  entrepreneurs who have long been looking for a way to "shove your business into the phone." </li></ul><br><a name="habracut"></a>  <a href="http://www.e-kontur.ru/">Kontur.Elba</a> is a web service that has been helping IP and small organizations to conduct business and report over the Internet for more than 4 years.  Elba began as a service in which it was possible to solve one single task - to pass the declaration of the USN.  And today we are able to form and deliver almost all the necessary small business reports to the regulatory authorities via the Internet.  The system also allows you to manage documents, cash receipts and write-offs, employees, goods in stock ... in general, the full "living wage of a businessman." 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The natural development of the service was access to mobile platforms.  The simplest and cheapest (as it seemed at first glance) scenario was to make a mobile version of the site: you could immediately cover all possible devices and save money on attracting mobile developers - everything could be done by the existing development team. <br><br>  But having studied this option together with usability specialists, we saw that the scenarios and principles of our users' work on the mobile device and computer are very different: the phone is used rather for viewing / reading / tracking changes, while the computer is for active actions like reporting, input new data. <br><br>  But most importantly, the mobile version does not allow you to use all the advantages of mobile devices: background tasks, push notifications, gesture control (the latter is available on the web, but in very limited amounts).  And, of course, in the mobile version to work offline would not have happened. <br><br>  Therefore, they decided - no half measures!  Only native applications for each platform, only hardcore! <br><br>  They decided to start with Android.  The choice of platform was determined by the preferences of users of our service: Android smartphones and tablets among them are slightly more than devices on iOS or Windows Phone.  So I appeared in the team :) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/50a/884/4e8/50a8844e821d4fb69342fd8f9423d888.png"></div><br><div class="spoiler">  <b class="spoiler_title">What is already possible in our application (many screenshots!)</b> <div class="spoiler_text">  Do not wait for details and immediately <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.kontur_elba%26referrer%3Dutm_source%3Dhabr%26utm_medium%3Dpost%26utm_content%3Ddima%26utm_campaign%3Dandroid">download the application here</a> . <br><br>  First and foremost, what can be said about our application - you can work with it effectively in the absence of the Internet.  When you first start the application downloads all documents, accounts, contractors and other data in your phone.  Now they can be managed (edited, deleted, changed status) regardless of the Internet connection.  All changes will be saved in the phone and at the first opportunity they will be sent to the server. <br><br>  Almost all the most important data from the system is available in the application, in particular, receipts and debits, documents, contractors: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/02a/e2e/c89/02ae2ec89be54a2f9995df99f65c384a.png"></div><br>  Information can be conveniently filtered, searched for and, of course, edited. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/261/454/518/261454518dfc43688aa948817d34f614.png"></div><br>  You can view current information about the tax reports sent, as well as a list of current and upcoming tasks.  In addition, from the program, you can send a document or your own details to the post of another person: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/251/3cd/ee6/2513cdee652f4dbc91a5e854ee4a5cb9.png"></div><br>  The application can receive push notifications, so you will know almost instantly about changes in the status of a report or receipt of money on a current account. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c6d/989/cd0/c6d989cd027345809b6a78b246bccf72.png"></div><br>  If your counterparty is calling you, we can show an additional plate with information about it over the main window of the call: <br><div style="text-align:center;"><img src="https://habrastorage.org/files/358/85a/390/35885a39048140769e21df4e089abb32.png"></div><br>  If you are concerned about data integrity, you can put a pin code on the application.  And, of course, all these features are amenable to customization. <br></div></div><br><h3>  Novice rake </h3><br>  New people in a team are always great: new workers, new ideas and new approaches to work.  And, of course, new errors and problems.  This time, the ‚Äúnewcomer,‚Äù you guessed it, turned out to be me, and it was a mistake to begin development on the very first day of work in Elba. <br><br>  The fact is that in our team, TZs do not work for a variety of reasons: here there is no single customer, and interface design with pieces, and programmers in general dislike reading multivolume tasks.  Therefore, the main way to transfer tasks from interface designers to developers are prototypes - we even <a href="http://habrahabr.ru/post/105008/">wrote about it</a> . <br><br>  The lack of approach - you need to have the context of what is happening in the system, understand how not only this screen works, but also those that are associated with it, because everything cannot be depicted on sketches - something is considered obvious.  But not newcomers to the team ... As a result, I had to redo much, and, accordingly, the time for the first release took one and a half times more than I planned - two and a half months instead of 4-6 weeks. <br><br>  My ‚Äúfavorite‚Äù example among all the alterations is the search for documents.  They can be searched either by parameters (date, counterparty, document type, status), or by the text of the document. <br><br><img src="https://habrastorage.org/files/613/996/0a7/6139960a7e9541508d4869649884c7b8.png"><br><br>  For me it was obvious that you can search around at once.  And having spent some time on developing and debugging, it was very disappointing to find out that in Elbe full-text search and filters were intentionally made mutually exclusive.  This was done for a reason, and at the request of users, who found it more convenient when these types of searches do not complement each other, but replace them.  In general, the explicit specificity of the project, which I ignorantly ignored. <br><br>  The conclusion may be obvious, but to repeat it once again will not be superfluous: gentlemen, mobile developers, do not be lazy and do not postpone acquaintance with the team and the product for later - then spending time on reworking is much more offensive. <br><br><h3>  Interface </h3><br>  The interface from the initial sketches to the current version has come a long way.  For example, in the first version we were going to use the panel below on the main screen to switch between main pages, documents, money, reports ... <br><br><img src="https://habrastorage.org/files/097/ab3/1d3/097ab31d33614aee8d46ee2fc2b67223.png"><br><br>  But there was a problem - not all users need all the capabilities of the service: someone does not use documents, someone does not work through the application with money, and someone does not need reports.  And which of the lists to do mainly in this situation?  Thus, we come to the screen-dashboard with a summary of all the key information. <br><br>  The bigger problem was, by the way, not the variety of resolutions, but the quality of the screens!  Colors that looked great on an iPhone or monitor screen could look very different on different phones.  We had to constantly double-check new interface options on at least three phones. <br><br>  With the permissions, we acted simply: the main screen was initially prepared for a resolution of 480 √ó 800, then it was checked how it would enter 320 √ó 480, and, if necessary, it was adjusted to it.  We do not support resolutions below 320 √ó 480, there is no special tablet version yet. <br><br><h3>  Severe technical topic (almost no pictures) </h3><br>  The application is written in Java, no multiplatform layers, and supports Android 2.3 and higher.  Will we continue to support 2.3 - I do not know yet: our active users on this OS version are less than 2%.  At the same time, at least 20-30% of the time was spent on ensuring compatibility, so if we started the project now, the minimum supported version would be 4.0.  The main problems were the layout, but with the fresh API or its backports, everything was not so smooth either. <br><br>  The database is SQLite, and without using ORM (nothing, by the way). <br><br>  We collect reports on uncaught exceptions (as well as parts of completely intercepted ones) using <a href="https://github.com/ACRA/acra">the ACRA library</a> on our own server, the results are aggregated and dropped to developers by mail.  Why we did not limit ourselves to the usual assembly of information on exceptions in Google Play?  Because users do not like to click on the button "send report to the developer."  We have, for example, the ratio of the number of real errors to the reports sent by users is about 100 to 1. So I highly recommend using ACRA or a similar library.  I see no reason to write my own bike - ACRA is finely tuned. <br><br>  Analytics on the use of the application we collect using Google Analytics.  There are no surprises, everything works as expected: custom events allow you to track almost any interesting scenarios for research.  Although I was surprised by the documentation on analytics: try <a href="https://developers.google.com/analytics/devguides/collection/android/v4/%3Fhl%3Dru">to click on the link</a> , and then click on the links in the left block concerning the Android SDK.  The references will lead to the documentation for the 3rd version of the library, although the 4th version is already relevant for a month now.  Trifle, yes kosyachok. <br><br>  We also have our own warm and lamp approach to icons.  As known, <br><ol><li>  Android 4.4 and below does not support out of the box vector images, only PNG, JPEG and GIF </li><li>  The normal way for the platform is to prepare several copies of the image in different resolutions and lay them out in folders like drawable-hdpi, drawable-xhdpi, drawable-mdpi, etc. </li></ol><br>  But!  In Android, you can simply connect your font in the application.  And in this font, you can include icons and in the right places instead of the ImageView put TextView with one character.  Thus, it is not necessary to render and copy one icon 7 times in a row, and the fonts are scaled adequately - no need to think about how your icon will appear on a small or giant screen.  Although during the layout process, this approach sometimes leads to amusing results: in the IDE preview mode, the custom font is not loaded and instead of icons, letters and numbers are displayed. <br><br><img src="https://habrastorage.org/files/eda/1d3/2e8/eda1d32e83e641d79610638fc0cb7263.png"><br><br>  And now the tip-off is for those who want to make themselves a feature with information about the call: the <b>TYPE_SYSTEM_ALERT</b> class <b>windows</b> can be drawn on top of all other windows, including the system dialer.  However, if you want, we will write a full-fledged tutorial on this topic with a description of the pitfalls. <br><br><h3>  Testing </h3><br>  So far, testing is carried out by our testers manually.  Typically, the test is conducted on three phones - on Android 4.4, 4.2 and 2.3, plus an innumerable number of emulators of both native and, for example, <a href="http://www.genymotion.com/">Genymotion</a> .  The latter is a very useful thing, sorry calls and push notifications cannot be tested on it. <br><br>  But when it comes to checking out some new theory about the interface or testing something cool, like, for example, information about a call, devices from the entire floor are collected on the table! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/907/382/083/90738208375f46d491c06225516b9184.jpg"></div><br><br>  This seems to be all.  I am pleased to answer questions on both technical and non-technical aspects of application development.  In addition, an article is being prepared on the preparation and evolution of application design. </div><p>Source: <a href="https://habr.com/ru/post/234241/">https://habr.com/ru/post/234241/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234229/index.html">Interview with Grigori Kornilov (Kaspersky Lab)</a></li>
<li><a href="../234231/index.html">Google will have to return the steering wheel and pedals to their robotic cars.</a></li>
<li><a href="../234235/index.html">RDP vs RemoteFX</a></li>
<li><a href="../234237/index.html">Debugging C ++ programs in GNU / Linux OS</a></li>
<li><a href="../234239/index.html">Stay Journey. Part 1</a></li>
<li><a href="../234243/index.html">Video surveillance from idea to ... idea. Data</a></li>
<li><a href="../234245/index.html">Monkey Selfie copyright problem solved by US Copyright Office</a></li>
<li><a href="../234247/index.html">Techniques for working with query execution plans in Oracle</a></li>
<li><a href="../234249/index.html">Two DataPro Specialists Receive Accredited Tier Specialist Certificates</a></li>
<li><a href="../234251/index.html">Inside the OST data center on the street. Borovaya</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>