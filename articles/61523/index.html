<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I learned to work with XML</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Honestly, I was pretty surprised, not finding an article on a similar topic on Habr√©. And the topic is quite relevant and necessary, so I will take th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I learned to work with XML</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/blogs/python/61523/"><img src="https://habrastorage.org/getpro/habr/post_images/edd/1f2/b7b/edd1f2b7bc33ee35ab0b8d8f4c76bf66.gif" alt="image"></a> <br>  Honestly, I was pretty surprised, not finding an article on a similar topic on Habr√©.  And the topic is quite relevant and necessary, so I will take the liberty to light it up a bit. <br><a name="habracut"></a><br><br><h4>  Short excursion </h4><br>  When working with xml in python, many people use the rather convenient built-in module <b>xml.dom.minidom</b> .  All the information in it, including the contents of the tags, is presented as such <i>nodes</i> , work with which is conducted directly.  Here is a piece of code handling the xml file: <br><blockquote><code><a href="http://s-c.me/2151/s"></a> <a href="http://s-c.me/2151/h"></a> <font color="black">Copy Source | Copy HTML <b>app_xml</b> = xmlp.parse( <font color="#008000">"base.xml"</font> ) <b>id</b> = app_xml.createElement(att) <b>node</b> = app_xml.createTextNode("simple.App") <b>id</b> .appendChild(node) root.appendChild(id) <b>res</b> = <b>open</b> ( <font color="#008000">"base.xml"</font> , <font color="#008000">"w"</font> ) <b>res</b> .writelines(app_xml.toprettyxml()) <b>res</b> .close()</font></code> <ol> <li> <code><font color="black"><a href="http://s-c.me/2151/s"></a> <a href="http://s-c.me/2151/h"></a> Copy Source | Copy HTML <b>app_xml</b> = xmlp.parse( <font color="#008000">"base.xml"</font> ) <b>id</b> = app_xml.createElement(att) <b>node</b> = app_xml.createTextNode("simple.App") <b>id</b> .appendChild(node) root.appendChild(id) <b>res</b> = <b>open</b> ( <font color="#008000">"base.xml"</font> , <font color="#008000">"w"</font> ) <b>res</b> .writelines(app_xml.toprettyxml()) <b>res</b> .close()</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2151/s"></a> <a href="http://s-c.me/2151/h"></a> Copy Source | Copy HTML <b>app_xml</b> = xmlp.parse( <font color="#008000">"base.xml"</font> ) <b>id</b> = app_xml.createElement(att) <b>node</b> = app_xml.createTextNode("simple.App") <b>id</b> .appendChild(node) root.appendChild(id) <b>res</b> = <b>open</b> ( <font color="#008000">"base.xml"</font> , <font color="#008000">"w"</font> ) <b>res</b> .writelines(app_xml.toprettyxml()) <b>res</b> .close()</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2151/s"></a> <a href="http://s-c.me/2151/h"></a> Copy Source | Copy HTML <b>app_xml</b> = xmlp.parse( <font color="#008000">"base.xml"</font> ) <b>id</b> = app_xml.createElement(att) <b>node</b> = app_xml.createTextNode("simple.App") <b>id</b> .appendChild(node) root.appendChild(id) <b>res</b> = <b>open</b> ( <font color="#008000">"base.xml"</font> , <font color="#008000">"w"</font> ) <b>res</b> .writelines(app_xml.toprettyxml()) <b>res</b> .close()</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2151/s"></a> <a href="http://s-c.me/2151/h"></a> Copy Source | Copy HTML <b>app_xml</b> = xmlp.parse( <font color="#008000">"base.xml"</font> ) <b>id</b> = app_xml.createElement(att) <b>node</b> = app_xml.createTextNode("simple.App") <b>id</b> .appendChild(node) root.appendChild(id) <b>res</b> = <b>open</b> ( <font color="#008000">"base.xml"</font> , <font color="#008000">"w"</font> ) <b>res</b> .writelines(app_xml.toprettyxml()) <b>res</b> .close()</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2151/s"></a> <a href="http://s-c.me/2151/h"></a> Copy Source | Copy HTML <b>app_xml</b> = xmlp.parse( <font color="#008000">"base.xml"</font> ) <b>id</b> = app_xml.createElement(att) <b>node</b> = app_xml.createTextNode("simple.App") <b>id</b> .appendChild(node) root.appendChild(id) <b>res</b> = <b>open</b> ( <font color="#008000">"base.xml"</font> , <font color="#008000">"w"</font> ) <b>res</b> .writelines(app_xml.toprettyxml()) <b>res</b> .close()</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2151/s"></a> <a href="http://s-c.me/2151/h"></a> Copy Source | Copy HTML <b>app_xml</b> = xmlp.parse( <font color="#008000">"base.xml"</font> ) <b>id</b> = app_xml.createElement(att) <b>node</b> = app_xml.createTextNode("simple.App") <b>id</b> .appendChild(node) root.appendChild(id) <b>res</b> = <b>open</b> ( <font color="#008000">"base.xml"</font> , <font color="#008000">"w"</font> ) <b>res</b> .writelines(app_xml.toprettyxml()) <b>res</b> .close()</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2151/s"></a> <a href="http://s-c.me/2151/h"></a> Copy Source | Copy HTML <b>app_xml</b> = xmlp.parse( <font color="#008000">"base.xml"</font> ) <b>id</b> = app_xml.createElement(att) <b>node</b> = app_xml.createTextNode("simple.App") <b>id</b> .appendChild(node) root.appendChild(id) <b>res</b> = <b>open</b> ( <font color="#008000">"base.xml"</font> , <font color="#008000">"w"</font> ) <b>res</b> .writelines(app_xml.toprettyxml()) <b>res</b> .close()</font></code> </li> <li> <code><font color="black"><a href="http://s-c.me/2151/s"></a> <a href="http://s-c.me/2151/h"></a> Copy Source | Copy HTML <b>app_xml</b> = xmlp.parse( <font color="#008000">"base.xml"</font> ) <b>id</b> = app_xml.createElement(att) <b>node</b> = app_xml.createTextNode("simple.App") <b>id</b> .appendChild(node) root.appendChild(id) <b>res</b> = <b>open</b> ( <font color="#008000">"base.xml"</font> , <font color="#008000">"w"</font> ) <b>res</b> .writelines(app_xml.toprettyxml()) <b>res</b> .close()</font></code> </li> </ol></blockquote><br>  All this code, as it is easy to guess, opens the existing xml-file, parses and adds to it a single <b>id</b> tag with the string <i>‚Äúsimple.App‚Äù</i> .  Bulky?  Yes, not the word.  Moreover, another unpleasant bug was discovered - since the time of Python 2.4, the <b>toprettyxml ()</b> function, designed to output the contents of a node or tree of nodes in text form, for some reason adds a carriage transfer character to each line, resulting in <br><blockquote>  &lt;id&gt; simple.App &lt;/ id&gt; </blockquote><br>  issued <br><blockquote>  &lt;id&gt; <br>  simple.App <br>  &lt;/ id&gt; </blockquote><br>  At first glance, this is not critical, since the value remains intact, however, in some cases, and for some parsers (if, for example, you intend to use generated XML in other designs), an error will be displayed during the processing of numerical data.  In particular, this is the fault of the Adobe AIR applications collector, to which I actually wrote the binding. <br>  Searches on the Internet gave the result.  It turned out that either I had to use a hack in my code as an extra function of twenty lines of lines, or use standard <b>toxml ()</b> , which though generates valid files - but all the information in them is in one line, that is, my entire descriptor has become into the porridge of the species <br><blockquote> <code><a href="http://s-c.me/2152/s"></a> <a href="http://s-c.me/2152/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#0000ff">&lt;?</font>  <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">= '1.0'</font> <font color="#ff0000">encoding</font> <font color="#0000ff">= 'utf-8'</font> ?  <font color="#0000ff">&gt; &lt;</font> <font color="#800000">application</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">= "http://ns.adobe.com/air/application/1.5"&gt; &lt;</font> <font color="#800000">id</font> <font color="#0000ff">&gt;</font> simple.test.program <font color="#0000ff">&lt;/</font> <font color="#800000">id</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">version</font> <font color="#0000ff">&gt;</font> 0.1 <font color="#0000ff">&lt;/</font> <font color="#800000">version</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">filename</font> <font color="#0000ff">&gt;</font> testapp <font color="#0000ff">&lt;/</font> <font color="#800000">filename</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">name</font> <font color="#0000ff">&gt;</font> testapp <font color="#0000ff">&lt;/</font> <font color="#800000">name</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">initialWindow</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> Test AIR Application <font color="#0000ff">&lt;/</font> <font color="#800000">title</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">content</font> <font color="#0000ff">&gt;</font> test.html <font color="#0000ff">&lt;/</font> <font color="#800000">content</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">height</font> <font color="#0000ff">&gt;</font> 320 <font color="#0000ff">&lt;/</font> <font color="#800000">height</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">width</font> <font color="#0000ff">&gt;</font> 240 <font color="#0000ff">&lt;/</font> <font color="#800000">width</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">visible</font> <font color="#0000ff">&gt;</font> true <font color="#0000ff">&lt;/</font> <font color="#800000">visible</font> <font color="#0000ff">&gt; &lt;</font> <font color="#800000">resizable</font> <font color="#0000ff">&gt;</font> true <font color="#0000ff">&lt;/</font> <font color="#800000">resizable</font> <font color="#0000ff">&gt; &lt;/</font> <font color="#800000">initialWindow</font> <font color="#0000ff">&gt; &lt;/</font> <font color="#800000">application</font> <font color="#0000ff">&gt;</font> </li></ol></blockquote><br>  Call me an esthete, but for large file sizes (and even with comments), it‚Äôs still a pleasure to look for erroneous values ‚Äã‚Äãin such a heap. <br>  And then I began to look for an alternative option. <br><br><h4>  A light in the end of a tunnel </h4><br>  And this option came in the form of the <a href="http://codespeak.net/lxml/">lxml</a> module.  He was mentioned just in the topic in which <b>xml.dom.minidom was</b> scolded for the disgrace he was <b>creating</b> :) <br>  And now let's take a look at the code for generating the application handle without any additions and rewrites: <br><blockquote> <code><a href="http://s-c.me/2153/s"></a> <a href="http://s-c.me/2153/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  root = etree.Element ( <font color="#008000">"initialWindow"</font> ) </li><li>  etree.SubElement (root, <font color="#008000">"title"</font> ) .text = title </li><li>  etree.SubElement (root, <font color="#008000">"content"</font> ) .text = content </li><li>  etree.SubElement (root, <font color="#008000">"height"</font> ) .text = <b>str</b> (height) </li><li>  etree.SubElement (root, <font color="#008000">"width"</font> ) .text = <b>str</b> (width) </li><li>  app_window = etree.tostring (root) </li><li>  ... </li><li>  root = etree.Element ( <font color="#008000">"application"</font> , xmlns = <font color="#008000">"http://ns.adobe.com/air/application/1.5"</font> ) </li><li>  etree.SubElement (root, <font color="#008000">"id"</font> ) .text = id </li><li>  etree.SubElement (root, <font color="#008000">"version"</font> ) .text = version </li><li>  etree.SubElement (root, <font color="#008000">"filename"</font> ) .text = filename </li><li>  etree.SubElement (root, <font color="#008000">"name"</font> ) .text = <b>self</b> .name </li><li>  root.append (etree.XML (app_window)) </li><li>  handle = etree.tostring (root, pretty_print = True, encoding = <font color="#008000">'utf-8'</font> , xml_declaration = True) </li><li>  applic = <b>open</b> ( <b>self</b> .fullpath + <font color="#008000">"/"</font> + <b>self</b> .name + <font color="#008000">"-app.xml"</font> , <font color="#008000">"w"</font> ) </li><li>  applic.writelines (handle) </li><li>  applic.close () </li></ol></blockquote><br>  Where is clearer and clearer, is not it?  This code allows you to generate such a clean and pretty XML: <br><blockquote> <code><a href="http://s-c.me/2154/s"></a> <a href="http://s-c.me/2154/h"></a> <font color="black">Copy Source | Copy HTML</font></code> <ol> <li>  <font color="#0000ff">&lt;?</font>  <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">= '1.0'</font> <font color="#ff0000">encoding</font> <font color="#0000ff">= 'utf-8'</font> ?  <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">application</font> <font color="#ff0000">xmlns</font> <font color="#0000ff">= "http://ns.adobe.com/air/application/1.5"&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">id</font> <font color="#0000ff">&gt;</font> simple.test.program <font color="#0000ff">&lt;/</font> <font color="#800000">id</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">version</font> <font color="#0000ff">&gt;</font> 0.1 <font color="#0000ff">&lt;/</font> <font color="#800000">version</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> testapp <font color="#0000ff">&lt;/</font> <font color="#800000">filename</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">name</font> <font color="#0000ff">&gt;</font> testapp <font color="#0000ff">&lt;/</font> <font color="#800000">name</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">initialWindow</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> Test AIR Application <font color="#0000ff">&lt;/</font> <font color="#800000">title</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">content</font> <font color="#0000ff">&gt;</font> test.html <font color="#0000ff">&lt;/</font> <font color="#800000">content</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">height</font> <font color="#0000ff">&gt;</font> 320 <font color="#0000ff">&lt;/</font> <font color="#800000">height</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;</font> <font color="#800000">width</font> <font color="#0000ff">&gt;</font> 240 <font color="#0000ff">&lt;/</font> <font color="#800000">width</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">initialWindow</font> <font color="#0000ff">&gt;</font> </li><li>  <font color="#0000ff">&lt;/</font> <font color="#800000">application</font> <font color="#0000ff">&gt;</font> </li></ol></blockquote><br>  I think 90% of the code does not need an explanation.  All street magic is enclosed in the line <b>handle = etree.tostring (root, pretty_print = True, encoding = 'utf-8', xml_declaration = True)</b> .  Here <b>pretty_print</b> is a replacement for the same ill-fated <b>toprettyxml ()</b> , only, unlike it, it works fine.  We also set the encoding and attach the standard header line of the XML document. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Allegedly, this module, oddly enough, works twice as fast as the standard one.  It is installed elementarily via <b>setuptools</b> : <br><blockquote>  $ sudo easy_install lxml </blockquote><br>  Normal tutorial lies on the official site, here is a <a href="http://codespeak.net/lxml/tutorial.html">direct link</a> . <br><br>  Long live the beautiful, convenient and valid code!  Good luck to all of you, write comments. </div><p>Source: <a href="https://habr.com/ru/post/61523/">https://habr.com/ru/post/61523/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../61509/index.html">I resent Beeline - kidalovo</a></li>
<li><a href="../61513/index.html">Reminder of attached documents in e-mail</a></li>
<li><a href="../61518/index.html">Six ways Google Wave will change your business, career and life</a></li>
<li><a href="../61521/index.html">How I became an application developer for vkontakte.ru</a></li>
<li><a href="../61522/index.html">Web options in Google search</a></li>
<li><a href="../61524/index.html">Learning to design based on the domain (DDD: Domain Driven Design)</a></li>
<li><a href="../61526/index.html">Let me work!</a></li>
<li><a href="../61532/index.html">Apache, fastcgi and c ++: "Hello, world"</a></li>
<li><a href="../61534/index.html">Several tools for organizing bookmarks in Mozilla Firefox</a></li>
<li><a href="../61535/index.html">Password by mail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>