<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tasks and Back Stack on Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hey. From the title of the topic you might have noticed that it will be a question of how Tasks and Back Stack work in Android. This article will be a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tasks and Back Stack on Android</h1><div class="post__text post__text-html js-mediator-article">  Hey.  From the title of the topic you might have noticed that it will be a question of how Tasks and Back Stack work in Android.  This article will be a free translation of the <a href="http://developer.android.com/guide/components/tasks-and-back-stack.html">official source</a> .  The topic is more focused on beginners, but I think that an experienced developer will be able to learn something new, because  The topic is specific and it is not often necessary to customize the behavior of our Activity. <br><a name="habracut"></a><br><h1>  Introduction </h1><br>  So.  Each Android application, at least, consists of the fundamental objects of the system - Activity.  An activity is a separate screen that has its own separate logic and UI.  The number of Activity in the application is different, from one to many.  When navigating between different Activities, the user can always return to the previous, closed Activity when pressing the back button on the device.  Similar logic is implemented using the stack stack (Activity Stack).  His organization ‚Äúlast in, first out‚Äù - i.e.  last entered, first out.  When you open a new Activity, it becomes the top, and the previous one goes into stop mode.  The stack cannot be mixed, it has the ability to add to the top of a new Activity and delete the top current one.  The same Activity can be on the stack any number of times. <br>  Task is a set of Activity.  Each task contains its own stack.  In a standard situation, each application has its own task and its own stack.  When the application is minimized, the task goes to the background, but does not die.  He keeps his entire stack at the next opening of the application through the manager or through the launcher, the existing task will be restored and continue its work. <br><br><h5>  Below I show a picture of how the stack works. </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/d33/894/a97/d33894a97f136d5a0e027c9102394420.png" alt="image"><br><br>  If you continue to press the back button, the stack will delete the Activity until the main root remains.  If on it the user clicks back, the application closes and the task will die.  By the way, I said that when we minimize our application and launch, for example, a new one, then our task just goes into the background and will wait for the moment while we call it.  In fact, there is one "but."  If we have a lot of tasks in the background or just heavily load your device, it is not likely that the task will die due to lack of system resources.  This is not a war of course, but the fact that we lose all our current data and our stack is cleared is for sure.  By the way, to avoid data loss in such cases, you should read about <a href="http://developer.android.com/guide/components/activities.html">SavingActivityState</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Small total </h2><br>  All that we have described above is the standard behavior for an Android application.  In most cases, this is how it should be.  But if you still want to change something, there is room for it.  They will be described further, but for now a small result of what we have already discussed. <br><ul><li>  When launching, a new Activity gets to the top of the stack, shifting the current </li><li>  When the application is minimized, the task goes to the background and stores its state.  After the next launch of the application, the task is restored along with its stack </li><li>  When you press back, the current Activity is permanently deleted.  The previous one is put on the top of the stack. </li><li>  The same Activity can have any number of instances on the stack. </li></ul><br><h1>  Tasking </h1><br>  There are two ways to change the standard organization of tasks.  We can set special attributes in the manifest for each Activity.  We can also set special flags for Intent, which launches a new Activity with startActivity ().  Note that sometimes the attributes in the manifest and the flags in the Intent can contradict each other.  In this case, the flags Intent will take precedence. <br><br><h3>  LaunchMode attribute </h3><br>  For each Activity in the manifest, you can specify the launchMode attribute.  It has several meanings: <br><ul><li>  <b>standard</b> - (by default) when you start an Activity, a new instance is created on the stack.  An activity can be placed on the stack several times. </li><li>  <b>singleTop</b> - Activity may be placed on the stack several times.  A new entry in the stack is created only if this Activity is not located at the top of the stack.  If it is currently at the top, then the onNewIntent () method will work for it, but it will not be recreated. </li><li>  <b>singleTask</b> - creates a new task and sets the Activity root for it, but only in cases when there is no instance of this Activity in any other task.  If the Activity is already located in any task, then that instance will open and the onNewIntent () method will be called.  It becomes the main one in due time, and all the upper copies are removed, if there are any.  Only one instance of such an activity can exist. </li><li>  <b>singleInstance</b> is the same as singleTask, but for this Activity a separate task will always be created and it will be the root in it.  This flag indicates that the Activity will be the one and only member of its task. </li></ul><br>  In fact, it does not matter in which task a new Activity is opened.  When you press the back button, we still return to the previous task and previous Activity.  The only point to consider is the singleTask parameter.  If, when opening such an Activity, we get it from another background task, then we completely switch to it and to its stack.  The picture below shows this. <br><img src="https://habrastorage.org/getpro/habr/post_images/a5e/a85/458/a5ea8545835dc2f0b77c7f35078e7e8b.png" alt="image"><br><br><h3>  Flags </h3><br>  As mentioned above, we can set special flags for Intent, which launches a new Activity.  Flags have higher priority than launchMode.  There are several flags: <br><ul><li>  <b>FLAG_ACTIVITY_NEW_TASK</b> - launches Activity in a new task.  If there is already a task with an instance of this Activity, then this task becomes active, and the onNewIntent () method is triggered. <br>  The flag is similar to the singleTop parameter described above. </li><li>  <b>FLAG_ACTIVITY_SINGLE_TOP</b> - if the Activity starts itself, i.e.  it is at the top of the stack, instead of creating a new instance on the stack, the onNewIntent () method is called. <br>  The flag is similar to the singleTop parameter described above. </li><li>  <b>FLAG_ACTIVITY_CLEAR_TOP</b> - if an instance of this Activity already exists on the stack of this task, then all the Activities that are on top of it are destroyed and this instance becomes the top of the stack.  Also called onNewIntent () </li></ul><br><br><h2>  Affinity </h2><br>  By default, all the activities of our application work in the same task.  Optionally, we can change this behavior and specify that in one application Activity work in different tasks, or Activity of different applications work in one.  To do this, we can specify in the manifest for each Activity the name of the task by the taskAffinity parameter.  This is a string value, which should not coincide with the name of the package, because  The standard application task is called exactly as our package.  In general, this parameter indicates that the Activity will be guaranteed to open in its separate task.  This parameter is relevant if we specify the flag FLAG_ACTIVITY_NEW_TASK or set the attribute attribute to allowTaskReparenting = "true".  This attribute indicates that the Activity can move between the tasks that launched it and the task that is specified in taskAffinity if one of them becomes active. <br><br><h2>  Stack cleaning </h2><br>  If the task is in the background for a long time, then the system cleans its stack itself, leaving only the root Activity.  This behavior is due to the fact that the user can forget what he did in the application before and most likely entered it again for another purpose.  This logic can also be modified using several attributes in the manifest. <br><ul><li>  <b>alwaysRetainTaskState</b> - if the flag is set to true for the root Activity, the stack will not be cleaned and fully restored even after a long time. </li><li>  <b>clearTaskOnLaunch</b> - if you set the flag to true for the root Activity, the stack will be cleaned instantly as soon as the user leaves the task.  The exact opposite of alwaysRetainTaskState </li><li>  <b>finishOnTaskLaunch</b> - works in the same way as clearTaskOnLaunch, but can be installed on any Activity and remove it from the stack </li></ul><br><br>  This is all for this topic.  The article is not improvised, but in fact is a free translation of <a href="http://developer.android.com/guide/components/tasks-and-back-stack.html">official documentation</a> .  I recommend collecting an easy example and experimenting with flags and attributes.  Some moments, for me personally, were unexpectedly interesting.  Any errors and omissions I will consider in HP.  Thank. </div><p>Source: <a href="https://habr.com/ru/post/186434/">https://habr.com/ru/post/186434/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../186422/index.html">Social networks in Russia, summer 2013: numbers, trends, forecasts</a></li>
<li><a href="../186424/index.html">The pedal helicopter stayed in the air for 64 seconds</a></li>
<li><a href="../186428/index.html">Active users on VKontakte and Twitter: rating of Russian regions</a></li>
<li><a href="../186430/index.html">HP Store Once</a></li>
<li><a href="../186432/index.html">Microsoft refuses SkypeKit and Skype Desktop API</a></li>
<li><a href="../186436/index.html">We study Storm Framework. Part II</a></li>
<li><a href="../186438/index.html">DARPA introduced the humanoid robot Atlas</a></li>
<li><a href="../186440/index.html">Stop praising your hard work</a></li>
<li><a href="../186442/index.html">MNP: nothing is ready</a></li>
<li><a href="../186444/index.html">Cisco localizes production in Russia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>