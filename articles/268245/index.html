<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Module example for Magento 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is out of date. Here is a new one . 


 In the week I felt an example of creating a module for Magento 2. In the course of probing, I tri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Module example for Magento 2</h1><div class="post__text post__text-html js-mediator-article"><hr><br>  <strong>This article is out of date.</strong>  <strong>Here is a <a href="https://habrahabr.ru/post/277183/">new one</a> .</strong> <br><br><hr><br>  In the week I felt an example of creating a module for Magento 2. In the course of probing, I tried to create a working environment by analogy with the environment we had developed at the moment for developing modules for Magento 1. <br><br><ul><li>  placing the module code in the Github repository; </li><li>  connecting the module to the Magento application using Composer; </li><li>  automating the deployment of developer / test version of Magento; </li></ul><br>  Under the cat link to the github-project with an example of a module for Magento 2 with (semi) automatic deployment of the environment for its development. <br><a name="habracut"></a><br><h4>  useful links </h4><br>  I do not describe the system requirements for Magento 2, how to install Composer, set up PHP and create a database.  Similar general information is here on these links or is searched on Google: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <a href="https://github.com/magento/magento-composer-installer">Magento Composer Installer</a> </li><li>  <a href="http://devdocs.magento.com/guides/v2.0/install-gde/install/web/install-web.html">Setup Wizard installation</a> </li><li>  <a href="http://magenticians.com/installing-magento-2-composer">Installing Magento 2 with Composer</a> </li></ul><br><h4>  Module itself </h4><br>  Link to the project on github: <a href="https://github.com/flancer32/sample_mage2_module">sample_mage2_module</a> <br><br><h4>  Catalogs </h4><br><img align="left" src="https://habrastorage.org/files/601/ffd/c3b/601ffdc3beda42f2871e0ca2eabddb44.png"><br>  <i>(gray indicates files and directories that are not under version control, they are generated during deployment or manually created)</i> <br><br>  We place the code for the module itself in the <a href="https://github.com/flancer32/sample_mage2_module/tree/master/src/">./src</a> subdirectory. <br><br>  We deploy the development environment for the development of the module in the <a href="https://github.com/flancer32/sample_mage2_module/tree/master/work">./work/</a> directory. <br><br>  The <i>./work/cfg/</i> directory contains the source code for the script (s) for deploying the developer version of the Magento application. <br><br>  The <a href="">./work/cfg/templates.json</a> file is one of the two configuration files of our <a href="https://github.com/praxigento/composer_plugin_templates">composer_plugin_templates</a> plugin which, according to the composer events (for example, <i>composer install</i> ), copies the source file templates (under version control) to the target directory with the replacement in placeholder templates their real values ‚Äã‚Äãfor this instance of the application.  You can do it manually, but we use this plugin.  In this example, we need to create from the <a href="">./work/cfg/bin/deploy/post_install.sh</a> template just one shell script ( <i>./work/bin/deploy/post_install.sh</i> ), which will raise the database for the Magento application after working out <i>"composer install"</i> . <br><br>  The <i>./work/htdocs/</i> directory is the root of our web application, Magento2 ( <i>copy</i> strategy) is deployed in it, and our module files are <i>superimposed</i> on this scan ( <i>symlink</i> strategy).  Please note that files in <i>./work/htdocs/ are</i> linked not from the <i>./src/</i> directory, but from the <i>./work/vendor/flancer32/sample_mage2_module/src</i> directory. <br><br>  The file <a href="https://github.com/flancer32/sample_mage2_module/blob/master/work/.gitignore">./work/.gitignore</a> belongs to the directory <i>./work/</i> (working environment for the development of the module). <br><br>  File <a href="">./work/composer.json</a> - instructions for deploying a working environment through Composer. <br><br>  The <a href="">./work/templates.json.init</a> file is a template for the second configuration file used in our composer composer_plugin_templates plugin.  In the plugin, we use two configuration files: in one we define the list of templates and addresses where we need to place the finished files after replacing the variables with their values ‚Äã‚Äãfor this instance of the sweep, and in the second - the values ‚Äã‚Äãof these variables.  If the first configuration file does not depend on where we are deploying the application (and is under version control), then the second one depends, and therefore is taken out of control.  Instead, control is the preparation for its creation. <br><br>  The <a href="https://github.com/flancer32/sample_mage2_module/blob/master/.gitignore">./.gitignore</a> file refers to the entire project (with the exception of the <i>./work. Subdirectory</i> ). <br><br>  The <a href="">./composer.json</a> file <a href="">contains</a> instructions for deploying our Magento2 module (the module itself, not the working environment for its development). <br><br><h4>  Preparing for deployment </h4><br>  I do not describe how to create a database and configure a web server and PHP - for Magento 2 this is done in exactly the same way as for Magento 1. After setting up the system environment, you should have the parameters for working with the database and the URL, under your web application will run. <br><br><pre><code class="bash hljs">$ git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> git@github.com:flancer32/sample_mage2_module.git $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> sample_mage2_module/work/</code> </pre> <br>  Creating a configuration file with parameters specific to your application instance (working with the database, URL, etc.): `` `bash <br>  $ cp templates.json.init templates.json <br>  $ nano templates.json <br>  { <br>  "vars": { <br>  "LOCAL_ROOT": "/ home / magento / instance / sample_mage2_module", <br>  "CFG_ADMIN_FIRSTNAME": "Store", <br>  "CFG_ADMIN_LASTNAME": "Admin", <br>  "CFG_ADMIN_EMAIL": "admin@store.com", <br>  "CFG_ADMIN_USERNAME": "admin", <br>  "CFG_ADMIN_PASSWORD": "eUvE7Yid057Cqtq5CkA8", <br>  "CFG_BASE_URL": " <a href="http://mage2.local.host.com/">http://mage2.local.host.com/</a> ", <br>  "CFG_BACKEND_FRONTNAME": "admin", <br>  "CFG_DB_HOST": "localhost", <br>  "CFG_DB_NAME": "magento2", <br>  "CFG_DB_USER": "magento2", <br>  "CFG_DB_PASSWORD": "JvPESKVSjXvZDrGk2gBe", <br>  "CFG_LANGUAGE": "en_US", <br>  "CFG_CURRENCY": "USD", <br>  "CFG_TIMEZONE": "UTC", <br>  "CFG_USE_REWRITES": "0", <br>  "CFG_USE_SECURE": "0", <br>  "CFG_USE_SECURE_ADMIN": "0", <br>  "CFG_ADMI_USE_SECURITY_KEY": "0", <br>  "CFG_SESSION_SAVE": "db" <br>  } <br>  } <br><br><pre> <code class="hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://devdocs.magento.com/guides/v2.0/install-gde/install/cli/install-cli-install.html#instgde-install-cli-magento"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span>    Magento 2   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span>setup:install<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span> (.  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://github.com/flancer32/sample_mage2_module/blob/master/work/cfg/bin/deploy/post_install.sh"</span></span></span><span class="hljs-tag">&gt;</span></span>./work/bin/deploy/post_install.sh<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span>). <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h4</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h4</span></span></span><span class="hljs-tag">&gt;</span></span>```bash $ composer install $ sh ./bin/deploy/post_install.sh</code> </pre> <br>  Access points to web interfaces: <br><br><ul><li>  mage2.local.host.com/index.php </li><li>  mage2.local.host.com/index.php/admin/ </li></ul><br><h4>  What we have </h4><br>  The deployed Magento application (see the <i>./work/htdocs/</i> directory) with the files of our module linked to it (from the <i>./work/vendor/flancer32/sample_mage2_module/src/</i> directory).  Therefore, when changing the files of our module in the deployed Magento 2 application, the files in the <i>./vendor / ...</i> directory that are under version control change in fact.  It remains to configure your IDE to work with this repository: <br><br><img src="https://habrastorage.org/files/90e/af1/e8c/90eaf1e8ce2548a5b892cb72937d30b0.png"><br>  ... and you can work with the source code of our module in a more or less familiar way: <br><br><img src="https://habrastorage.org/files/5b5/c53/125/5b5c5312553b443985571f8fe7ab1dd6.png"><br>  The number of modules that can be connected in this way to the developer sweep is large enough.  Composer will pull them all out and put them in the <i>./work/vendor/</i> directory, <i>all</i> that remains is to connect the necessary repositories to the IDE, and all the necessary code is under version control. <br><br><h4>  Additions </h4><br>  The root directory <i>./work/htdocs/</i> for deploying a Magento2 application is created in <a href="">./work/composer.json</a> : `` `bash <br>  { <br>  "scripts": { <br>  "pre-install-cmd": [ <br>  "# Create root directory for the development Magento instance.", <br>  "mkdir -p htdocs" <br>  ] <br>  } <br>  } <br><br><pre> <code class="hljs ruby">       &lt;a href=<span class="hljs-string"><span class="hljs-string">"https://github.com/flancer64/magento-composer-installer"</span></span>&gt; &lt;<span class="hljs-regexp"><span class="hljs-regexp">/a&gt;  &lt;a href="https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/github.com/magento</span></span><span class="hljs-regexp"><span class="hljs-regexp">/magento-composer-installer"&gt;magento/magento</span></span>-composer-installer&lt;<span class="hljs-regexp"><span class="hljs-regexp">/a&gt;, &lt;a href="https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/github.com/magento</span></span><span class="hljs-regexp"><span class="hljs-regexp">/magento-composer-installer/pull</span></span><span class="hljs-regexp"><span class="hljs-regexp">/7"&gt;pull request&lt;/a</span></span>&gt;        (. &lt;a href=<span class="hljs-string"><span class="hljs-string">"https://github.com/flancer32/sample_mage2_module/blob/master/work/composer.json#L28"</span></span>&gt;./work/composer.json&lt;<span class="hljs-regexp"><span class="hljs-regexp">/a&gt;): ```bash { "repositories": [ { "type": "vcs", "url": "https:/</span></span><span class="hljs-regexp"><span class="hljs-regexp">/github.com/flancer</span></span>64/magento-composer-installer<span class="hljs-string"><span class="hljs-string">" } ], "</span></span><span class="hljs-keyword"><span class="hljs-keyword">require</span></span><span class="hljs-string"><span class="hljs-string">": { "</span></span>magento/magento-composer-installer<span class="hljs-string"><span class="hljs-string">": "</span></span>dev-patch-<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-string"><span class="hljs-string">" } }</span></span></code> </pre> <br>  Configuring the <a href="https://github.com/praxigento/composer_plugin_templates">composer_plugin_templates</a> plugin (see <a href="">./work/composer.json</a> ): `` `bash <br>  { <br>  "extra": { <br>  "praxigento_templates_config": [ <br>  "./templates.json", <br>  "./cfg/templates.json" <br>  ] <br>  } <br>  } <br><br><pre> <code class="hljs xml">  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span>php $LOCAL_ROOT/work/htdocs/bin/magento setup:install<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://devdocs.magento.com/guides/v2.0/install-gde/install/cli/install-cli-install.html#instgde-install-cli-magento"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span>--use-sample-data<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span>  ```bash composer require magento/sample-data:~1.0.0-beta</code> </pre> <br>  in the <i>./work</i> directory, the desired sample data is first downloaded for a long time (especially media), then installed for a long time, then everything collapses, and you need to start over, but without sample data.  Perhaps, when the errors are corrected, it will be possible to fill in sample data, but for now, like this. <br></div><p>Source: <a href="https://habr.com/ru/post/268245/">https://habr.com/ru/post/268245/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268235/index.html">Candy Challenge (improving the result)</a></li>
<li><a href="../268237/index.html">Gartner's Magic Quadrant for Data Center Networking Technologies</a></li>
<li><a href="../268239/index.html">A couple of goodies for CodeIgniter</a></li>
<li><a href="../268241/index.html">We invite to student hackathons of Imagine Cup</a></li>
<li><a href="../268243/index.html">Kaspersky Industrial CTF: time to protect substations, and time to break substations</a></li>
<li><a href="../268247/index.html">Network overlay technologies for data centers. Part 2</a></li>
<li><a href="../268249/index.html">Flux in pictures</a></li>
<li><a href="../268251/index.html">Welcome to GDG DevFest Voronezh 2015</a></li>
<li><a href="../268253/index.html">Usability Authorization Forms</a></li>
<li><a href="../268257/index.html">Integration of CoreSpotlight on the example of "Rambler. Mail"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>