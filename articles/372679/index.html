<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>IPhone 5c password brute force demonstration with flash memory mirroring</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In April 2016, the FBI and Apple staged a real show around the iPhone 5c shooter from San Bernardino, for which they allegedly could not find the pass...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>IPhone 5c password brute force demonstration with flash memory mirroring</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a14/486/661/a14486661f32496d8dffe21989972189.jpg"><br><br>  In April 2016, the FBI and Apple staged a <a href="https://geektimes.ru/post/271742/">real show</a> around the iPhone 5c shooter from San Bernardino, for which they allegedly could not find the password without the help of Apple. <br><br>  The FBI pressured Apple, demanding technical assistance.  Tim Cook <a href="https://geektimes.ru/post/271238/">published an open letter</a> in which he accused the FBI of forcing Apple to build a backdoor in iOS.  It came to the US Congress and the Senate, the problem was discussed by all major American media and television channels.  The world with a sinking heart watched Santa Barbara and wondered if Apple would give the feds or not give access to the iPhone's cryptosystem. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      iPhone is protected from brute-force through the option of deleting data on the device after ten incorrect input attempts and an increasing delay time between sets of unlock code (5 seconds after 5 attempts, then 1 minute, 5 minutes, 15 minutes and 60 minutes). <br><a name="habracut"></a><br>  It is logical to get around the defense by copying the flash memory with brute-force copies (NAND mirroring), but for some reason, the FBI experts <a href="https://en.wikipedia.org/wiki/FBI%25E2%2580%2593Apple_encryption_dispute">could not conduct such an attack</a> .  They turned to the NSA - they also <a href="http://www.zdnet.com/article/nsa-comes-clean-on-why-it-couldnt-hack-san-bernardino-shooters-iphone/">could not help</a> . <br><br>  After lengthy unsuccessful attempts to pressure the Apple, the FBI <a href="https://geektimes.ru/post/274739/">paid more than $ 1 million to</a> hackers (supposedly from Israel), who proposed the iPhone 5c password brute force method.  Sources said at the time that the smartphone had been hacked using a previously unknown (0day) vulnerability in iOS 9. Despite Apple‚Äôs request, the FBI has not yet released information about the vulnerability so that Apple can fix it - such a fbrovski revenge. <br><br>  The director of the FBI said that copying NAND did not apply because it <a href="http://www.computerworld.com/article/3048243/apple-ios/fbi-chief-shoots-down-theory-that-nand-mirroring-will-be-used-to-crack-terrorists-iphone.html">does not work</a> . <br><br>  Now one simple hacker did what the FBI and NSA specialists could not do.  Sergey Skorobogatov from the University of Cambridge (United Kingdom) vividly showed how the iPhone 5C password brute force is implemented after copying the flash memory.  The scientific work on cryptography is <a href="http://arxiv.org/abs/1609.04327">published</a> in the public domain on the site arXiv.org. <br><br>  According <a href="http://www.slideshare.net/andrey.belenko/ios-and-blackberry-forensics">to the iOS encryption scheme</a> , a user password and a unique UID key are used to generate a key to the System Keybag system storage.  The UID key is hardware-registered in the SoC and is not available at the software level, so it is impossible to conduct brute-force without access to a specific chip. <br><br><img src="https://habrastorage.org/files/6c9/91f/2f1/6c991f2f14624a1c8f1ca9dc99883034.png"><br><br>  Although the architecture of the iPhone 5c is kept secret, on the forums you can find <a href="http://forum.gsmhosting.com/vbb/f631/iphone-5c-6-plus-schematic-diagram-available-1857968/">schemes and names of the chips iPhone 5c, iPhone 6</a> , etc., with a NAND pin.  But Sergey Skorobogatov warns that some VCCQ and GND contacts have been swapped, so that the pinout can permanently damage the microcircuit.  To study the protocols and commands you will need an oscilloscope and a logic analyzer. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  In the <a href="https://www.youtube.com/watch%3Fv%3DtM66GWrwbsY">demo video,</a> Sergey shows how to disassemble the iPhone, remove the chip with a flash memory chip, solder it with a blow dryer and clone the data.  For similar instructions on parsing the iPhone 5C, <a href="https://www.ifixit.com/Teardown/iPhone%2B5c%2BTeardown/17382">see iFixit</a> . <br><br>  SoC A6 and NAND chip are located on different sides of the motherboard.  The distance between NAND and the board is approximately 0.05 mm.  Extraction will require a special thin knife and blowtorch with a temperature of more than 300 ¬∞ C. <br><br><img src="https://habrastorage.org/files/d7f/d0b/0d3/d7fd0b0d336b4393b3dd70012a8bc8d2.jpg"><br><br>  All small components around the chip were pre-protected with a temperature-resistant epoxy resin. <br><br><img src="https://habrastorage.org/files/4cd/ef8/13d/4cdef813d6044682875bdccef1941638.jpg"><br>  <i>NAND extraction preparation</i> <br><br>  High temperature does not damage data in flash memory.  Previous studies have shown that it can withstand up to 400 ¬∞ C. <br><br><img src="https://habrastorage.org/files/ed3/46e/763/ed346e7630f841fa81fab18845563bc3.jpg"><br>  <i>Extracted NAND Module</i> <br><br>  To test the functionality, each contact of the NAND module is connected to the motherboard with 0.3 mm wires with Teflon insulation (MGTF). <br><br><img src="https://habrastorage.org/files/200/70b/b2e/20070bb2ea9c4cfb88339e58d7ec281c.jpg"><br><br>  Then the motherboard was inserted into place, and a hole was cut out for wires with the NAND module removed. <br><br><img src="https://habrastorage.org/files/1b2/204/b65/1b2204b65d6d46d3839b3aa8f0561e23.jpg"><br><br><img src="https://habrastorage.org/files/bcb/69b/e53/bcb69be53608462e9575d5a878d8e402.jpg"><br><br>  At first, the phone was very buggy.  Sergei found out that this is due to interference in long wires. <br><br><img src="https://habrastorage.org/files/a4a/c51/ba1/a4ac51ba199a4f2cadc7a57b9fc5cacb.png"><br>  <i>Noise signal</i> <br><br>  I had to add matching resistors to all signal wires.  Then the signal leveled off and the phone stopped to fail. <br><br><img src="https://habrastorage.org/files/83a/3e7/9d8/83a3e79d8a78424ba81295b70d075db9.png"><br>  <i>Signal without interference</i> <br><br>  Then an engineer from the University of Cambridge inserted an intermediate board for wiretapping the signal, connected an oscilloscope and a logic analyzer for reverse engineering of the protocol and commands of the iPhone 5c. <br><br><img src="https://habrastorage.org/files/db9/046/441/db904644164f4fa89cde66730f8b43f8.jpg"><br>  <i>Intermediate fee for wiretapping</i> <br><br>  Here again, there were problems with the integrity of the signal, this time due to the input and output capacitances of the 74LVC and 74AVC buffer elements of 4 pF and 6 pF.  I had to replace them with elements with a smaller capacity 74AUP and 74AXP. <br><br>  In the end, the researcher still managed to prepare the iPhone 5c for reverse engineering.  By this time he, obviously, had already gone further than the FBI and NSA specialists managed to do. <br><br><img src="https://habrastorage.org/files/23c/27d/6a1/23c27d6a1c5b41aa9c565d992cc993ee.jpg"><br>  <i>iPhone 5c with logic analyzer</i> <br><br>  Further was a matter of technique.  It turned out that the iPhone 5c uses different interfaces and commands at different stages of loading, including undocumented proprietary commands at a clock frequency of 50 MHz.  In the end, the logic analyzer wrote down all the commands and helped determine the specific proprietary protocol that is used to communicate with NAND. <br><br>  Sergei Skorobogatov learned how to read, erase and write NAND memory at will.  This is all that is needed for a successful brute force password. <br><br><img src="https://habrastorage.org/files/4af/aea/2a1/4afaea2a164642bd8b7c6f6bd3e1523d.jpg"><br>  <i>NAND Copy Test Bench</i> <br><br>  The bruteforce program tries six password options until a 1 minute delay appears, then the process of restoring the memory from the backup copy automatically starts (to reset the counter that protects against bruteforce), then the bruteforce continues.  The recovery cycle after 6 attempts takes 90 seconds.  Thus, complete enumeration of all four-digit pincode options will take about 40 hours. <br><br><img src="https://habrastorage.org/files/67c/168/be5/67c168be505a41a087aaee660553be77.jpg"><br>  <i>NAND Mirroring Software for iPhone 5c</i> <br><br>  This bruteforce method does not work in newer iPhones, which has the optional <a href="https://www.apple.com/business/docs/iOS_Security_Guide.pdf">Secure Enclave</a> protection.  But it can be assumed that Sergey Skorobogatov‚Äôs colleagues from Elcomsoft and other companies that specialize in hacking smartphones, including those ordered by special services, are already solving this problem. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tM66GWrwbsY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/372679/">https://habr.com/ru/post/372679/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../372663/index.html">Scheduled Watering (STM32F103)</a></li>
<li><a href="../372665/index.html">How the brain remembers panoramic views</a></li>
<li><a href="../372673/index.html">Is artificial intelligence incomprehensible?</a></li>
<li><a href="../372675/index.html">Rumors that Adobe will remove the link to download the Flash Player - not confirmed</a></li>
<li><a href="../372677/index.html">Physics in the animal world: hummingbirds and its flight</a></li>
<li><a href="../372683/index.html">Pluto somehow glows in the X-ray range</a></li>
<li><a href="../372687/index.html">Hackers broke into a moving Tesla Model S from 20 kilometers</a></li>
<li><a href="../372689/index.html">A human skeleton was found on the site of the discovery of the Anti-Kite mechanism</a></li>
<li><a href="../372691/index.html">Welcome to the MIXAR conference on September 24</a></li>
<li><a href="../372693/index.html">A new record of quantum teleportation over fiber: 6.2 km in a straight line</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>