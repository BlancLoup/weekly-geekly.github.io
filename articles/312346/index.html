<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cross-VC NSX: Simplicity and Flexibility for Multiple Deployments</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As you know, Cross-VC NSX enables multi-site functionality ‚Äî it provides centralized vertical routing between logical networks deployed in NSX domains...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cross-VC NSX: Simplicity and Flexibility for Multiple Deployments</h1><div class="post__text post__text-html js-mediator-article"><p>  As you know, <nobr>Cross-VC</nobr> NSX enables multi-site functionality ‚Äî it provides centralized vertical routing between logical networks deployed in NSX domains and external physical network infrastructure. <br><br>  The benefits of this feature are clear at a glance - we are talking about mobility, workload distribution, creating resource pools, centralized management and applying security policies for vCenter domains / sites, and disaster recovery.  This article is not devoted to the study of detailed technical indicators, and the ease and flexibility in terms of applying <nobr>Cross-VC</nobr> NSX for several sites. <br><br><img src="https://habrastorage.org/files/7c3/9b3/4dc/7c39b34dc8bb4b5988841ee9f2d4f373.png"><a name="habracut"></a><br>  In this example, vCenter, the main NSX Manager, and the Universal Controller Cluster (UCC) are deployed at site 1. A secondary NSX Manager, registered with the primary NSX Manager, is deployed at site 2 with the appropriate vCenter. </p><br><img src="https://habrastorage.org/files/71d/5de/d8e/71d5ded8e21b4abc923a7d02ea66c40d.png"><br><p>  <em>Picture 1</em> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Figure 2 shows NSX <nobr>managers</nobr> with the primary and secondary roles, as well as the corresponding <nobr>UCC clusters</nobr> and interconnections.  The Universal Controller Cluster is deployed from the NSX Manager with the ‚Äúprimary‚Äù role on site 1 inside the vCenter, to which the NSX Manager with the ‚Äúprimary‚Äù role is linked. <br><br>  On the main site there are only 3 universal controllers that control all universal and local objects for all vCenter domains within the <nobr>Cross-VC</nobr> NSX deployment.  However, in Figure 2, inside the NSX Controllers Node section, the status of all controllers pertaining to all NSX Managers. </p><br><img src="https://habrastorage.org/files/64b/059/de9/64b059de9d9d47a4923e8ff3b4b79915.png"><br><p>  <em>Figure 2</em> <br><br>  As you can see in Figure 3, the Universal Controller Cluster is deployed in the Edge cluster on site 1. </p><br><img src="https://habrastorage.org/files/9d1/64a/2e6/9d164a2e6ca447249e8e1fa0ac58572a.png"><br><p>  <em>Figure 3</em> <br><br>  Once the NSX configurations are configured, the ‚Äúprimary‚Äù and ‚Äúsecondary‚Äù roles for the NSX Manager are selected, and the UCC is deployed, you can begin to create logical networks connecting different sites with a single click of a button. </p><br><img src="https://habrastorage.org/files/8bd/cff/76d/8bdcff76d81842e7a82f2af42a55d1ef.png"><br><p>  <em>Figure 4</em> </p><br><p>  If a user wants to get Active / Active deployments, where the active workloads for the same segment are on both sites (configuration with a single high availability server), this can be easily done using logical intervals on both sites.  In addition, since <nobr>Cross-VC</nobr> NSX extends logical networks and security to all vCenter domains, workloads can easily be moved between vCenter domains across all sites without <nobr>any</nobr> changes in <nobr>IP addresses</nobr> or security policies. <br><br>  Figure 5 shows the application of the Universal Distributed Firewall rules to the Universal Section. </p><br><img src="https://habrastorage.org/files/e2f/033/58d/e2f03358d7f84787b1e5f346931daf3a.png"><br><p>  <em>Figure 5</em> <br><br>  If the user wants only site 1 to serve as an exit for North / South traffic, this can be done by deploying the Universal Control VM, which is located on the Universal Distributed Logical Router (UDLR) management layer on the main site, as well as using routing " metric / weight ‚Äùto ensure that all North / South traffic passes through the Edge Service Gateways (ESGs) site 1. <img src="http://habr.habrastorage.org/post_images/330/ed7/08a/330ed708a1aa493498f25de98a59cf09.gif"><br><br>  In this model, North / South traffic corresponds to the active / passive model, where Edge Service Gateways on site 1 are active and Edge Service Gateways on site 2 are passive on North / South traffic. <br><br>  The existence of a single site at the Ingress / Egress point for North / South traffic simplifies the process of deploying and taking further action and may be required for cases where tracking services use North / South traffic and it is necessary to avoid asymmetric traffic flows.  An example of such a deployment is shown below. <br></p><br><img src="https://habrastorage.org/files/d1d/5a2/056/d1d5a2056445475f8bf99d4e0df45b3c.png"><br><p>  <em>Figure 6</em> <br><br>  If a user needs Active / Active North / South traffic flows and is not disturbed by the asymmetry of traffic flows, or he has <nobr>some</nobr> solution for controlling incoming traffic, then Local can be used to provide North / South traffic flow specific to a particular site. Egress.  It is activated when creating a UDLR. <br><br>  Local Egress allows you to control which routes are provided for ESXi hosts, based on a unique identifier, the so-called Locale ID.  All hosts within the NSX Manager domain have the same Locale ID;  the default is the UUID of the NSX <nobr>Manager on the</nobr> local site. <br><br>  The Universal Control VM on each site examines routes from the physical network through the ESG of the local site.  UCC then examines the best routes with the companion Locale ID from the Universal Control VM of each site.  Finally, the UCC distributes information about the best routes to ESXi hosts with the corresponding Locale ID.  Such a deployment using Local Egress is shown below.  Note that in this deployment model, Universal Control VM is present at each site. </p><br><img src="https://habrastorage.org/files/53c/8c3/517/53c8c3517d1349c6a1af1da7b7d8d1fe.png"><br><p>  <em>Figure 7</em> </p><br><p>  As you can see, the <nobr>Cross-VC</nobr> NSX provides flexibility and capabilities for multiple deployments.  In fact, this way you can deploy the NSX infrastructure for several users, while some users will use the Active / Passive scheme, while others will use the Active / Active scheme.  Such a deployment is shown below: User 1 and User 2 use the same UDLR and a single Universal Control VM with an Active / Passive scheme.  User 3 uses a different UDLR with Local Egress and, accordingly, another Universal Control VM for site 1 and site 2;  this makes the Active / Active scheme possible.  In this case, the <nobr>IP addresses of</nobr> users do not overlap.  Separate UDLR and ESG can also be used for each user if <nobr>IP address</nobr> overlap or additional isolation is required. </p><br><img src="https://habrastorage.org/files/6f5/320/cfa/6f5320cfab774e1ca545e41b8a3dedc8.png"><br><p>  <em>Figure 8</em> </p></div><p>Source: <a href="https://habr.com/ru/post/312346/">https://habr.com/ru/post/312346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312330/index.html">Network Monitoring with Apple TV</a></li>
<li><a href="../312336/index.html">Content theft in Chinese game dev</a></li>
<li><a href="../312338/index.html">MapReduce from scrap materials. Part III - Putting It All Together</a></li>
<li><a href="../312340/index.html">Basics of computer networks. Subject number 4. Network devices and types of cables used</a></li>
<li><a href="../312344/index.html">Pro application backward compatibility and digging out flight attendants</a></li>
<li><a href="../312348/index.html">OpenShift xPaaS version 3. "Hello, world"</a></li>
<li><a href="../312352/index.html">TailSampler - parallel GET requests sent to Apache.JMeter</a></li>
<li><a href="../312354/index.html">For lovers of FPGAs, ASICs, architecture and micro-architecture - more about seminars and conveyors</a></li>
<li><a href="../312356/index.html">Building a mental map for learning</a></li>
<li><a href="../312358/index.html">Study. As an increase in the clickable area of ‚Äã‚Äãa button changes the number of clicks on it.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>