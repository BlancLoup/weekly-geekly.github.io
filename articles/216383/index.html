<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How did I highlight specific values ‚Äã‚Äãin a table in SAPUI5 (SAP MII)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The topic is probably for a very narrow circle of specialists, but, nevertheless, I wanted to find out how many habrovchan people are working on integ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How did I highlight specific values ‚Äã‚Äãin a table in SAPUI5 (SAP MII)</h1><div class="post__text post__text-html js-mediator-article">  The topic is probably for a very narrow circle of specialists, but, nevertheless, I wanted to find out how many habrovchan people are working on integrating the business processes of enterprises into the SAP ERP business environment in the SAP MII system, in addition, the article may be interesting for those who use in their projects, an open version of the framework <a href="http://sap.github.io/openui5/">OpenUI5</a> . <br><br>  He started working in this area a year ago, he realized that there is not so much information on the network, and the tasks are very diverse.  Sometimes you encounter tasks that cannot be solved by standard approaches and you have to get out.  Here, I decided to publish my solution to a non-standard task - highlighting non-equal values ‚Äã‚Äãin different columns in the standard Table object for SAPUI5 ( <a href="http://sap.github.io/openui5/">OpenUI5</a> ).  I hope you understand what will be discussed. <br>  To illustrate the purpose of the task and its result, I will give for example a screenshot of the result that I got: <br>  <i>(blue and red blocks are combined into cells, the values ‚Äã‚Äãin them must be identical)</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/238/636/df3/238636df3d3d5c715d203ed23fa343a0.jpg"><br><a name="habracut"></a><br>  So, I‚Äôll start with an extended description of the problem and then proceed to find its solution. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The task was as follows: it was necessary to select information from the database to compare the values ‚Äã‚Äãin the columns (sent and confirmed).  The case when the values ‚Äã‚Äãwere different from each other - it was necessary to simplify for the end user and mark problem records. <br><br>  To begin with, a controller is created and a model (messagesSearchResult) is defined, in the future it will store the result of the request.  We also define the URL for the query in the searchMessages variable. <br><br><pre><code class="javascript hljs">sap.ui.controller(<span class="hljs-string"><span class="hljs-string">"controller_name.page"</span></span>, { <span class="hljs-attr"><span class="hljs-attr">models</span></span>: { <span class="hljs-attr"><span class="hljs-attr">messagesSearchResult</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">urls</span></span>: { <span class="hljs-attr"><span class="hljs-attr">searchMessages</span></span>: <span class="hljs-string"><span class="hljs-string">"/XMII/Illuminator?QueryTemplate=PATH/TO/query&amp;Content-Type=text/xml"</span></span> },</code> </pre> <br><br>  Then we create an initialization function, where we create an XML object (new sap.ui.model.xml.XMLModel ()) and enable the functions to process the start, end, and query error. <br><br><pre> <code class="javascript hljs"> onInit: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.models.messagesSearchResult = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> sap.ui.model.xml.XMLModel(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.models.messagesSearchResult.attachRequestCompleted(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._dataLoadingFinished) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.models.messagesSearchResult.attachRequestFailed(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._dataLoadingFinished) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.models.messagesSearchResult.attachRequestSent(thisLoadingStarted); },</code> </pre><br><br>  The next step is to create the main function, where we ‚Äúbind‚Äù the request data with the <a href="https://sapui5.netweaver.ondemand.com/sdk/">Table object</a> and enable the function to manipulate the request data. <br><br><pre> <code class="javascript hljs"> searchMessages: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> t = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.byId(<span class="hljs-string"><span class="hljs-string">'searchResultTbl'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// get Table element from page t.setModel(this.models.messagesSearchResult); // connect XML-model to Table element at page // aggregation binding data from XML-path (/Rowset/Row) to Table rows // and manipulation with data by function _addTableRows(this.models.messagesSearchResult). // At the end, loading data from query by url. (this.models.messagesSearchResult.loadData()) t.bindAggregation("rows", { path: "/Rowset/Row", factory: $.proxy(this._addTableRows(this.models.messagesSearchResult), this) }); this.models.messagesSearchResult.loadData(this.urls.searchMessages, {}}, false, "POST"); },</span></span></code> </pre><br><br>  Finally, a function for working with data, as well as highlighting cells with ‚Äúproblem‚Äù data. <br><br><pre> <code class="javascript hljs"> _addTableRows: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">oContext</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> _this = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-comment"><span class="hljs-comment">// save handler _this to controller var backgroundColor = '#fcdd82'; // define background-color for "problem" cells var ConfRecColumn, SentRecColumn; var TMP_REC; // Compare this field with next. // Bind property (CONF_REC) from XML-model to new TextField value and save it to temporary variable (TMP_REC). // By jQuery set attribute readonly to true ($('#' + this.getId()).attr("readonly", true)). // Set this TextField not editable (this.setEditable(false)). var ConfRecColor = new sap.ui.commons.TextField().bindProperty("value", "CONF_REC", function(cellValue){ $('#' + this.getId()).attr("readonly", true); this.setEditable(false); _this.TMP_REC = cellValue; return cellValue; }); // Compare this field with previous and highlight if doesn't match. // Bind property (SENT_REC) from XML-model to new TextField value and compare it with temporary variable (TMP_REC). // By jQuery set background-color if doesn't match ($('#' + this.getId()).parent().parent().css("background-color", backgroundColor)). // Or remove by jQuery attribute style if previous and this values is match ($('#' + this.getId()).parent().parent().removeAttr('style')). // By jQuery set attribute readonly to true ($('#' + this.getId()).attr("readonly", true)). // Set this TextField not editable (this.setEditable(false)). var SentRecColor = new sap.ui.commons.TextField().bindProperty("value", "SENT_REC", function(cellValue){ if(cellValue != _this.TMP_REC) { $('#' + this.getId()).parent().parent().css("background-color", backgroundColor); } else { $('#' + this.getId()).parent().parent().removeAttr('style'); } $('#' + this.getId()).attr("readonly", true); this.setEditable(false); return cellValue; }); this.byId('searchResultTbl').getColumns()[11].setTemplate(ConfRecColor); // set template, which we prepare above ConfRecColor this.byId('searchResultTbl').getColumns()[12].setTemplate(SentRecColor); // set template, which we prepare above SentRecColor },</span></span></code> </pre><br><br>  At the end, we define the functions for processing the start, end, and error of the request. <br><br><pre> <code class="javascript hljs"> _dataLoadingStarted: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ sap.ui.core.BusyIndicator.show(); }, <span class="hljs-attr"><span class="hljs-attr">_dataLoadingFinished</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">oEvent</span></span></span><span class="hljs-function">) </span></span>{ sap.ui.core.BusyIndicator.hide(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (oEvent.getId() == <span class="hljs-string"><span class="hljs-string">"requestFailed"</span></span>) { sap.ui.commons.MessageBox.alert(oEvent.getParameter(<span class="hljs-string"><span class="hljs-string">'message'</span></span>)); } } }); <span class="hljs-comment"><span class="hljs-comment">// close controller body</span></span></code> </pre><br><br>  Ready script controller: on <a href="http://jsfiddle.net/6HdAk/">JSFiddle</a> <br>  All code is commented in detail. <br><br>  I hope that my first article on Habr√© will be interesting and useful to someone.  There are many solutions to non-standard problems in stock, if you like this article, I will be happy to share with you others! <br><br>  <i>PS I want to express a special thanks to the person who liked this article, for which I was issued an invitation!</i> <br><br>  UPD: I correct the remark of the user <a href="http://habrahabr.ru/users/vest/" class="user_link">Vest</a> and post a link to the open version of the framework: <a href="http://sap.github.io/openui5/">OpenUI5</a> <br><br>  UPD: At the request of <a href="http://habrahabr.ru/users/vest/" class="user_link">Vest, I</a> add an example of the structure of the XML document that is being processed. <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Rowsets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Rowset</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NPP</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NPP</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SYS_ID</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SYS_ID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DATE_OF_POST</span></span></span><span class="hljs-tag">&gt;</span></span>14-03-2014<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DATE_OF_POST</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SMENA</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SMENA</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KOD</span></span></span><span class="hljs-tag">&gt;</span></span>10000000001<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KOD</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DESCR</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DESCR</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOURCE_ID</span></span></span><span class="hljs-tag">&gt;</span></span>200<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOURCE_ID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TARGET_ID</span></span></span><span class="hljs-tag">&gt;</span></span>300<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TARGET_ID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PROC_ID</span></span></span><span class="hljs-tag">&gt;</span></span>8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PROC_ID</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CONF_Q</span></span></span><span class="hljs-tag">&gt;</span></span>1131.12<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CONF_Q</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CONF_REC</span></span></span><span class="hljs-tag">&gt;</span></span>22<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CONF_REC</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SENT_Q</span></span></span><span class="hljs-tag">&gt;</span></span>1131.12<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SENT_Q</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SENT_REC</span></span></span><span class="hljs-tag">&gt;</span></span>22<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SENT_REC</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Rowset</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Rowsets</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></div><p>Source: <a href="https://habr.com/ru/post/216383/">https://habr.com/ru/post/216383/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../216373/index.html">Results and analysis of tasks online tour NeoQUEST-2014</a></li>
<li><a href="../216375/index.html">Responsive design. Reaction to the light level</a></li>
<li><a href="../216377/index.html">About megapixels, number 41 and Jacques Fresco / UPD: added a demo video with zoom and comparison with a soap box at the request of readers</a></li>
<li><a href="../216379/index.html">Autonomous solar power station for cellular transponder. Leap into the unknown and what came of it</a></li>
<li><a href="../216381/index.html">Exchange of data arrays with external components 1C</a></li>
<li><a href="../216385/index.html">NPC in 5 minutes or a bit about character creation</a></li>
<li><a href="../216389/index.html">Tizen SDK for Wearable released</a></li>
<li><a href="../216391/index.html">FormStamp - widget library for AngularJS</a></li>
<li><a href="../216395/index.html">A single charger for all mobile devices: in the EU adopted a new law</a></li>
<li><a href="../216401/index.html">Big data: size matters?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>