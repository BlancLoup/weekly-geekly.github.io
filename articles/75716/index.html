<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>diff for lazy developers or how to compare the incomparable</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the old days, on Windows, for comparing oracle-schemes (read databases), I was satisfied with the compiler built into Quest Software TOAD. He was n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>diff for lazy developers or how to compare the incomparable</h1><div class="post__text post__text-html js-mediator-article">  In the old days, on Windows, for comparing oracle-schemes (read databases), I was satisfied with the compiler built into Quest Software TOAD.  He was not bad, and coped with his task.  But transferring to linux, I was disappointed.  None of the [and so few] tools provides even half of the former comfort.  Namely, an elementary <b>comparison and merging of two files</b> (DDL, SQL, any source code is not the essence) of several thousand lines in each, <b>where each is formatted in its own way and the real changes are all-nothing, becomes natural torture.</b> <br><br><a name="habracut"></a><br><br>  Understanding the futility of trying to find the necessary functionality in one tool, I decided to look for crutches in the form of third-party tools.  Namely - independent comparisons and interlocks ([visual] compare and merging tools).  After <a href="http://en.wikipedia.org/wiki/Comparison_of_file_comparison_tools">going through</a> almost <a href="http://en.wikipedia.org/wiki/Comparison_of_file_comparison_tools">all the popular tools</a> , it turned out that very few (read almost no one) were able to skip line end characters in the comparison of two text files. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For clarity, I will explain with an example.  Suppose we have 2 files, typically old and new. <br><br>  Old (ora1.sql): <br><br><blockquote><code><font color="black"><font color="#0000ff">declare</font> <br> nfunctionresult NUMBER(9); <br> <font color="#0000ff">begin</font> <br> <br> nFunctionResult := <br> orauser.pack_util.FGetNeededValue ( <br> in_nSomeParam =&gt; somevalue <br> ); <br> <br> dbms_output.put_line( <font color="#A31515">'Function result: '</font> || <br> nFunctionResult); <br> <font color="#0000ff">exception</font> <br> <font color="#0000ff">when</font> SOME_EXCEPTION <font color="#0000ff">THEN</font> <br> orauser.pack_util.PReportError( <font color="#A31515">'SOME_EXCEPTION'</font> ); <br> <font color="#0000ff">when</font> OTHERS <font color="#0000ff">THEN</font> <br> orauser.pack_util.PReportError( <font color="#A31515">'OTHER exception'</font> ); <br> <font color="#0000ff">end</font> ;</font></code> </blockquote> <br><br>  New (ora2.sql): <br><br><blockquote> <code><font color="black"><font color="#0000ff">declare</font> <br> nFunctionResult NUMBER(9); <br> <font color="#0000ff">begin</font> <br> nFunctionResult := orauser.pack_util.FGetNeededValue (in_nSomeParam =&gt; somevalue); <br> dbms_output.put_line( <font color="#A31515">'Function result: '</font> ||nFunctionResult); <br> <font color="#0000ff">exception</font> <br> <font color="#0000ff">when</font> SOME_EXCEPTION <font color="#0000ff">THEN</font> <br> orauser.pack_util.PReportError( <font color="#A31515">'SOME_EXCEPTION'</font> ); <br> <font color="#0000ff">when</font> OTHERS <font color="#0000ff">THEN</font> <br> orauser.pack_util.PReportError( <font color="#A31515">'OTHER'</font> ); <br> <font color="#0000ff">end</font> ; <br></font> <br></code> </blockquote><br><br>  As can be seen with an inquiring human eye, the essence of the differences between ora1.sql and ora2.sql files is in one word and different formatting, but their diff is completely unreadable.  Here is the classic result of comparing them: <br><br><blockquote> <code><b>[bugman@localhost 1]$ diff ora1.sql ora2.sql</b> <br> 2c2 <br> &lt; nfunctionresult NUMBER(9); <br> --- <br> &gt; nFunctionResult NUMBER(9); <br> 4,11c4,5 <br> &lt; <br> &lt; nFunctionResult := <br> &lt; orauser.pack_util.FGetNeededValue ( <br> &lt; in_nSomeParam =&gt; somevalue <br> &lt; ); <br> &lt; <br> &lt; dbms_output.put_line('Function result: '|| <br> &lt; nFunctionResult); <br> --- <br> &gt; nFunctionResult := orauser.pack_util.FGetNeededValue (in_nSomeParam =&gt; somevalue); <br> &gt; dbms_output.put_line('Function result: '||nFunctionResult); <br> 16c10 <br> &lt; orauser.pack_util.PReportError('OTHER exception'); <br> --- <br> &gt; orauser.pack_util.PReportError('OTHER'); <br></code> </blockquote><br><br>  The key "put on all spaces" -w does not improve the situation: <br><br><blockquote> <code><b>[bugman@localhost 1]$ diff -wi ora1.sql ora2.sql</b> <br> 4,11c4,5 <br> &lt; <br> &lt; nFunctionResult := <br> &lt; orauser.pack_util.FGetNeededValue ( <br> &lt; in_nSomeParam =&gt; somevalue <br> &lt; ); <br> &lt; <br> &lt; dbms_output.put_line('Function result: '|| <br> &lt; nFunctionResult); <br> --- <br> &gt; nFunctionResult := orauser.pack_util.FGetNeededValue (in_nSomeParam =&gt; somevalue); <br> &gt; dbms_output.put_line('Function result: '||nFunctionResult); <br> 16c10 <br> &lt; orauser.pack_util.PReportError('OTHER exception'); <br> --- <br> &gt; orauser.pack_util.PReportError('OTHER'); <br></code> </blockquote><br><br>  Despite the fact that the original documentation states that the spaces are the <a href="http://www.gnu.org/software/diffutils/manual/html_node/White-Space.html">end-of-line characters</a> , the bug I started was closed in a redhat bugzilla with the mark ‚ÄúNOT BAG‚Äù, and the GNUs themselves unsubscribed that they say yes, this is BAG, but BAG documentation .  And in the last letter, they promised to fix everything in the world. <br><br>  Of all the tried and tested utilities, the most convenient was xxdiff (and more specifically its <a href="http://furius.ca/xxdiff/doc/xxdiff-secrets.html">ignore per-hunk whitespaces option</a> ), but unfortunately, the utility itself was not able to work with Unicode files, did not have a built-in editor.  to edit files on the fly, did not provide the CLI for possible integration with other tools, and besides, it didn‚Äôt have the most pleasant interface. <br><br>  But the utility of the dwdiff command line came closest.  This small wrapper around diff delivers exactly what I need - differences at the level of WORDS.  But there was no costing a spoon of tar - the output of this utility is unique and there are no standard options to bring the difference to diff: <br><br><blockquote> <code><b>[bugman@localhost 1]$ dwdiff -P -i ora1.sql ora2.sql</b> <br> declare <br> nFunctionResult NUMBER(9); <br> begin <br> nFunctionResult := orauser.pack_util.FGetNeededValue (in_nSomeParam =&gt; somevalue); <br> dbms_output.put_line('Function result: '||nFunctionResult); <br> exception <br> when SOME_EXCEPTION THEN <br> orauser.pack_util.PReportError('SOME_EXCEPTION'); <br> when OTHERS THEN <br> orauser.pack_util.PReportError('OTHER [-exception-]'); <br> end; <br></code> </blockquote><br><br>  On the other hand, it is not surprising, because the standard patch has a line level, and in what form can the difference of two files be displayed if they differ in each line?  I was puzzled by this question and got in touch with the author of this utility, commander GP Halkes, the result of the correspondence was a small crutch: <br><br><blockquote> <code><b>[bugman@localhost 1]$ ./diffwrap.sh ora1.sql ora2.sql diff -i</b> <br> 10c10 <br> &lt; orauser.pack_util.PReportError('OTHER exception'); <br> --- <br> &gt; orauser.pack_util.PReportError('OTHER'); <br></code> </blockquote><br><br>  This vrapper allows you to use with visual differentials, such as kdiff3.  The script itself, the perfected version of which will soon become part of dwdiff and will be distributed with it to the joy of lazy coders, but who can't wait to try it out now, there is no magic here: <br><br><blockquote> <code><b>[bugman@localhost 1]$ cat ~/diffwrap.sh</b> <br> #!/bin/bash <br> <br> if [ $# -lt 3 ] ; then <br> echo "Usage: script.sh " <br> exit 1 <br> fi <br> <br> OLD="$1" <br> NEW="$2" <br> shift 2 <br> <br> # First create a version of the old file that is formated like <br> # the new file... <br> TMP="`mktemp oldconvertXXXXXX`" <br> dwdiff -P -2 -w '' -x '' "$OLD" "$NEW" &gt; "$TMP" <br> <br> # ... and then call a diff program to show the changes (per line). <br> "$@" "$TMP" "$NEW" <br> <br> # Finally, clean up the temporary file <br> rm "$TMP" <br> <br> <br> PS         .    -     - .         : 1)     coding style guide,             ,    ,        ; 2)    ,        -     ,    -      ?</code> </blockquote> </div><p>Source: <a href="https://habr.com/ru/post/75716/">https://habr.com/ru/post/75716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../75711/index.html">Office 2010 Beta is available to everyone!</a></li>
<li><a href="../75712/index.html">First laptop</a></li>
<li><a href="../75713/index.html">ExtizeMe - Web2.0 Template for WordPress</a></li>
<li><a href="../75714/index.html">English without fools: Lessons online for free, live, for everyone!</a></li>
<li><a href="../75715/index.html">Mikron. PHP ORM</a></li>
<li><a href="../75717/index.html">Green robot</a></li>
<li><a href="../75722/index.html">Collecting analytics for the iPhone application</a></li>
<li><a href="../75725/index.html">The tale of how one man with "Megaphone" butting</a></li>
<li><a href="../75726/index.html">PDC second day, a wave of announcements</a></li>
<li><a href="../75727/index.html">Silverlight 4: NotificationWindow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>