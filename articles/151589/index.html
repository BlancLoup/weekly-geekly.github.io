<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Karma extension for Google Chrome</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! 



 Immediately link to the impatient: http://bit.ly/habrauser 

 The popup opens by clicking, you can go to the user‚Äôs page either by ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Karma extension for Google Chrome</h1><div class="post__text post__text-html js-mediator-article">  Hello to all! <br><br><img src="https://habrastorage.org/storage2/baa/aaf/850/baaaaf8509214c97f90d9cd834c7a190.jpg"><br><br>  Immediately link to the impatient: <a href="http://bit.ly/habrauser">http://bit.ly/habrauser</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The popup opens by clicking, you can go to the user‚Äôs page either by clicking the middle button (opens in the background tab) or on the username in the popup. <br><br>  Under the cut there are some details for those interested. <br><a name="habracut"></a><br><h2>  Prehistory </h2><br>  I have been reading Habr for a long time, about 6 years, and it always remained for me something like this ... a high light.  I didn‚Äôt have my own account, because registration was by invitation only, I didn‚Äôt know anyone and therefore I felt small and insignificant. <br><br>  However, once I had accumulated some knowledge that I couldn‚Äôt find in Runet and I decided that it was a good reason to try my luck on a habr.  I was warmly received, though not fervently.  I deserve an invite, shared knowledge, hurray!  I was a little surprised that I can vote only a limited number of times and therefore I carefully hid the appeared couple of votes. <br><br>  As time went on, articles became more and more, I increasingly read Habr logged in.  And then I noticed that my voices were completely gone.  I felt sad.  ‚ÄúWhere do people get their voices from?‚Äù, I thought.  ‚ÄúSo many votes have been spent on comments, on karma!  And I am out of this stream, I can‚Äôt even click! ‚ÄùAnd yes, I did not read the help at that time =) <br><br>  Not so long ago, I had the opportunity to publish my second post translation.  He was somewhat interested in people and I acquired some positive karma.  Thank!  Together with <a href="https://habrahabr.ru/users/tsvetkovpa/" class="user_link">tsvetkovpa</a> we figured out how it all worked out, smoked man, I realized that the number of votes depends on karma and the restriction is only daily.  Well, that clarifies! <br><br>  I began to show signs of severe hablability. <br><br><h2>  Hablability </h2><br>  Read Habr I became noticeably harder.  I read even most of the comments, watched and voted in the tracker.  However, something bothered me a lot.  If you can vote for comments so easily, then why can't I vote for karma as easily?  <i>Do I have to go to another page?</i>  Sorry, this is somehow not human! <br><br>  I poked into all the existing extensions, <a href="https://chrome.google.com/webstore/detail/ekkngamdmcljjgmhlihjiiapfcdladgh">found something</a> similar, but it turned out to be karma-readonly, and in general somehow did not make me happy (to the author without offense, this is IMHO). <br><br>  Maybe I was looking badly, but the thirst for the invention of bicycles took over. <br><br><h2>  Bicycles </h2><br>  For a couple of evenings, I threw a working code.  Since the API has a habrahabra, ahem, let's say, not <i>very</i> rich (the <a href="http://habrahabr.ru/api/profile/404tesla/">only thing that was found</a> ), I had to have crutches.  jQuery, <code>on('click')</code> , voila!  It was necessary to pull out the page of a juzverej entirely through GET request (by the way, I didn‚Äôt get anywhere from this), cache and isolate pieces of habrainformation on my own, and manage styles.  For karma-voting on the Habr√©, the function is responsible, as you have guessed, <code>karma_vote()</code> and it really needs a user ID, which is not shown anywhere else in this function. <br><br>  I piled on classes, methods, ayaksovs and already started to even think about backbone. <br><br>  A little later, I decided to check something: can we do without bicycles?  Since I‚Äôm pulling so much, why not just insert the entire user header?  Oh, how wonderful it was!  And with this, and styles, and onclik, everything pulled itself out!  Lepot, it's a pity that the habr js is not arranged, it stretches into pieces on demand and the styles / logic of the user page are only on this page and are present.  Well, okay, no problem.  There are a few styles, I simply banned them and connect them via content-cc;  Voting code decided to just inject from the very habr to the bottom of the page. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); script.type = <span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>; script.src = src; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.appendChild(script);</code> </pre><br>  Haha  Thumbs up! <br><br>  This started the optimization. <br><br><h2>  Optimization </h2><br>  I sawed out all the classes, all the self-made layout.  It turned out so little that I was ashamed that for this I force the page to once again execute the jQuery code.  How many are there already?  Damn it, should every extension in chrome really attract jQuery?  Maybe there is some kind of sharpened?  It's time to make it built-in!  Of course, you can do without it, but do not want to. <br><br>  Yes, and Habr himself uses jQuery!  But ... maybe it can somehow be used? <br><br>  I dug a little Internet on this topic and realized that I don‚Äôt have one, from the extensions with the DOM pages only, and it won't take me a ride on the back of the script loaded with habr = ( <br><br>  Well, okay, move away from the content scripts, what about inject?  Since I can touch the DOM with my hands, then why don't I just push the extension core there?  And the page will launch it.  I tried: <br><br><pre> <code class="javascript hljs">script.text = <span class="hljs-string"><span class="hljs-string">"console.log(jQuery().jquery);"</span></span>;</code> </pre> <br>  Oops, it works!  We get rid of jQuery in the package, create a loader and now Habr carefully executes my code! <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">chrome</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttpRequest(), urlToMain = chrome.extension.getURL(<span class="hljs-string"><span class="hljs-string">'js/main.js'</span></span>), script; request.open(<span class="hljs-string"><span class="hljs-string">'GET'</span></span>, urlToMain, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); request.send(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); script.type = <span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>; script.text = request.responseText; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.appendChild(script); }(chrome));</code> </pre> <br><h2>  Result </h2><br>  Slightly drank styles, compressing them and the output code, I got what you see. <br><br><img src="https://habrastorage.org/storage2/edd/26d/08b/edd26d08b332e5b1a81fb0914051e9d6.png"><br><img src="https://habrastorage.org/storage2/abe/88e/5a5/abe88e5a532199e994f972a055d42052.png"><br><br>  Thank you for reading!  I hope the extension is useful to someone else besides myself =) <br><br>  I apologize to those whom I spotted in the screenshots, I needed experimental subjects!  =) I thought that Habr is a country that is still friendly and free, but I can also ignore it, if it really hinders. <br><br>  At the end I would like to ask a habrakomuyuniti a couple of questions: <br><ul><li>  Does it make sense to alter the hover or is it better to give a choice? </li><li>  Do I need a choice of highlighting contexts?  For example, "in the comments", "in the sidebar", "author of the post" </li><li>  Any ideas how not to pull the entire user page? </li></ul><br><h2>  Have a nice day! </h2></div><p>Source: <a href="https://habr.com/ru/post/151589/">https://habr.com/ru/post/151589/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151582/index.html">Cybersquatting in chinese</a></li>
<li><a href="../151583/index.html">155 years since the birth of Konstantin Tsiolkovsky</a></li>
<li><a href="../151584/index.html">Ineffectiveness of the rating system or the course of thought</a></li>
<li><a href="../151585/index.html">vkontakte_api: ruby-adapter for VK API</a></li>
<li><a href="../151586/index.html">Radio-controlled cockroach</a></li>
<li><a href="../151591/index.html">ECT is a new javascript coffee-flavored template engine.</a></li>
<li><a href="../151592/index.html">Apple Special Event 2012: iPhone 5 Presentation, New iPods, iOS 6 (in Russian)</a></li>
<li><a href="../151593/index.html">Using MS Project to manage software development projects</a></li>
<li><a href="../151594/index.html">The first details about the processor Power7 +</a></li>
<li><a href="../151595/index.html">Tricky way to drain mobile traffic</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>