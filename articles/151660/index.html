<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The evolution of installers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Goods in beautiful packaging easier to sell. A program in a good installer? 

 It‚Äôs not a fact that the installer is an analogue of packaging. It is r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The evolution of installers</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/d81/1db/3fb/d811db3fbd422bf63332744fdce1d7c8.png" align="left"><br>  Goods in beautiful packaging easier to sell.  A program in a good installer? <br><br>  It‚Äôs not a fact that the installer is an analogue of packaging.  It is rather a <i>process of</i> taking the product out of the box.  Many times click "Next", at the very end - "Finish", and there is no neat unraveling of ribbons.  Torn mica, carelessly opened the box - "What is there inside us?" <br><br>  The box itself does not represent much value.  For some products specifically make budget packaging.  But it is important that the <a href="http://habrahabr.ru/post/147922/">process was predictable</a> .  If the installer is predictable, then its appearance and capabilities do not matter.  But when something goes "wrong", or the user suddenly does not have enough standard options, all the flaws will surface - both in appearance and capabilities. <br><a name="habracut"></a><br><h3>  What they want from the installers </h3><br>  A corporate user, for example, will be interested to know how to put the program <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa372391%2528v%3Dvs.85%2529.aspx">in silent mode</a> , and which installer has <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa367988%2528v%3Dvs.85%2529.aspx">command line keys</a> .  Support for the standard Windows msi-file installer here will be most welcome. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If the installer asks complex questions, it is important that they are in a language that the user understands.  Guessing this language right away is another problem.  The language of the operating system interface is not always the right choice.  Therefore, providing the ability to select a language is an integral part of modern installers. <br><br>  Previously, we already <a href="http://habrahabr.ru/company/radmin/blog/117264/">wrote</a> about how you can implement the choice of language and make a "real" msi.  We have learned to appreciate the traditions of different linguistic cultures and respect strict corporate requirements.  But is everything taken into account?  After all, someone instead of the installer wants to immediately have a portable version of the program.  And users working under an account with limited rights?  Many programs they simply can not deliver without calling the administrator.  And this is not always the administrator‚Äôs mistake, more often the developer‚Äôs. <br><br><h3>  Two-in-one installers </h3><br>  Immediately after running the installer, you can offer not only install the program, but also run it without installation.  Such a program can store configuration files and user data in the same folder with the installer, acting simultaneously as an installer and portable-version.  And for unpacking the program from msi, you can always use the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa367541%2528v%3Dvs.85%2529.aspx">administrative installation</a> - few people know that it was created just for this purpose.  You just need to remember to delete temporary files at the end of the program. <br><br>  Such an approach eliminates the need to redo the concept of a huge green ‚ÄúDownload‚Äù button on the website, since  one file will be enough for those who want to install the program - and those who want to run it only once, and even those who want to carry it with them on a flash drive.  It is easy to teach the program to work with a given settings file and store user data in a given path.  It is important not to touch the registry, and in the case of integration with other programs - to provide support for relative paths.  And do not forget that the installer file may suddenly appear on the CD :-). <br><br><h3>  Restricted account rights </h3><br>  Home users, and also employees of the companies in which kind system administrators work, do not face such problem.  Developers, however, too.  Working on our computers with unlimited rights, we often forget about the support of users with disabilities. <br><br>  The fact is that in Windows Installer there are two ways to install the program - for all users of the system (the most common), and for the current user who launched the installer.  Moreover, in the corporate world it is not uncommon when the current user does not have enough privileges to install the program in the ‚Äúfor all users‚Äù mode. <br><br>  To make an installer that supports both installation methods and works without any problems on Windows Vista (in Windows 7 they added support for the so-called <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/dd408068%2528v%3Dvs.85%2529.aspx">‚ÄúSingle Package Authoring‚Äù</a> ), the developer needs to take special actions. <br><br>  Namely, each time before starting the installation ‚Äúfor the current user‚Äù patch the installer msi-file, setting in ‚Äú1‚Äù the third bit of the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa372870%2528v%3Dvs.85%2529.aspx">special property</a> ‚ÄúWord Count‚Äù in the so-called ‚ÄúSummary Information Stream‚Äù (which is an integral part of the msi-file) .  You can use the <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa370491%2528v%3Dvs.85%2529.aspx">MsiSummaryInfoSetProperty</a> () function to do this.  If the msi-file is digitally signed, then when installed in the ‚Äúfor all users‚Äù mode, the ‚Äúblue‚Äù UAC window will be displayed.  When installed in the ‚Äúfor the current user‚Äù mode, the fact of a corrupted digital signature does not affect UAC, so this approach works great. <br><br>  If you do not use the shaman dances described above with a tambourine for Windows Vista, but simply set the third bit to ‚Äú1‚Äù during the msi build, then even the system administrator <a href="http://social.technet.microsoft.com/Forums/en/winservergen/thread/64af2d23-e45c-413f-bf1b-5ea7c9d52abd">will not be able to</a> install such msi in the ‚Äúfor all users‚Äù mode :-).  And vice versa, if the third bit is not set, then the UAC window will be displayed, and in the worst case, an administrator password will be required. <br><br><h3>  How to pack? </h3><br>  To implement these features need an exe-file installer.  The msi-file is already packed into it.  The user interface engine is also desirable to make in exe, to ensure not only switching the installation language "on the fly", but also the choice of options before the msi-installation.  It is important not to forget about interaction with the Windows Installer system, to ensure correct detection of an already installed version and support for uninstallation.  A corporate customer receives the same msi file as packed in exe - he does not need support for either the portable mode or the installation for the current user, and the language is <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa372085%2528v%3Dvs.85%2529.aspx">specified</a> on the command line. <br><br>  To develop such an exe-installer, you need experience in the development of user interfaces, or the ability to use a suitable framework.  But regardless of the selected tools, you need a deep knowledge of WinAPI and the Windows Installer API. <br><br><h3>  And try </h3><br>  The beta version of the free <a href="http://www.advanced-ip-scanner.com/ru/">Advanced IP Scanner</a> , our small testing ground for testing new technologies <s>in humans</s> , has acquired a new installer that actually implements most of the features described.  And start without installation, and change of language, and the msi-file inside - everything in it is.  It is recommended to download, watch and learn.  :-) <br><br>  We used <a href="http://www.jrsoftware.org/isinfo.php">Inno Setup</a> to select the language, display the dialogs, and launch the portable version.  Filling (msi) remained the same, on <a href="http://wixtoolset.org/">WiX</a> , only now without dialogs. <br><br>  Everyone who dared to see the live all-in-one installer and take part in the beta testing should: <br><ol><li>  Download Advanced IP Scanner 2.3.226 beta. </li><li>  Get acquainted with the product. </li><li>  Check its compatibility with your OS. </li><li>  Send us a bug report and / or suggestions for improvement through a special form on <a href="http://www.radmin.ru/products/beta.php">the beta testing page</a> . </li></ol><br>  Each beta tester will receive a <b>perpetual license</b> for <a href="http://www.radmin.ru/">Radmin 3</a> . <br><br>  Thanks in advance for your participation.  Questions to developers and comments are welcome! </div><p>Source: <a href="https://habr.com/ru/post/151660/">https://habr.com/ru/post/151660/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../151653/index.html">Emacs and the correct work with someone else's code: indentation</a></li>
<li><a href="../151654/index.html">Mars rover Curiosity is theoretically capable of infecting Mars due to the negligence of NASA engineers</a></li>
<li><a href="../151655/index.html">Creating a stereogram based on a three-dimensional model</a></li>
<li><a href="../151656/index.html">The minimum price of Microsoft Surface - $ 300</a></li>
<li><a href="../151658/index.html">HTC Desire V - more than two in one</a></li>
<li><a href="../151661/index.html">Forwarding a video card to a guest OS from the Xen hypervisor</a></li>
<li><a href="../151664/index.html">New CEO - new smartphones. Yahoo!</a></li>
<li><a href="../151666/index.html">I use the firm's smartphone ...</a></li>
<li><a href="../151667/index.html">Clone of the application "aelios weather" with html5</a></li>
<li><a href="../151669/index.html">IS audit methodology</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>