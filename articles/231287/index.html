<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Aspect oriented programming in Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hearing about aspect-oriented programming, I, as an Android developer, immediately thought that it would hardly work on Android, however, I decided to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Aspect oriented programming in Android</h1><div class="post__text post__text-html js-mediator-article">  Hearing about aspect-oriented programming, I, as an Android developer, immediately thought that it would hardly work on Android, however, I decided to try.  I was very surprised when, after 5 minutes, the application using AspectJ was successfully launched on the phone. <br><br>  I will not convince of the need to use aspects in Android and give examples of "uses cases", just give an example of how to add the ability to use aspects to your application.  What are aspects and what to use them are beautifully described, for example, on the <a href="http://ru.wikipedia.org/wiki/%25D0%2590%25D1%2581%25D0%25BF%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BD%25D0%25BE-%25D0%25BE%25D1%2580%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">wiki</a> . <br><a name="habracut"></a><br>  As an IDE for development, I have long since switched to Android Studio, and therefore I use gradle as a build system.  For her, and I will give an example of configuration. <br><br>  The entire AspectJ connection process consists of the following steps: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li> Connect the plugin for the assembly: <br>  In the <code>buildscript</code> section of the <code>buildscript</code> script of your project, add the following line to the <code>dependencies</code> : <br><pre> <code class="java hljs">classpath <span class="hljs-string"><span class="hljs-string">'com.uphyca.gradle:gradle-android-aspectj-plugin:0.9.+'</span></span></code> </pre> <br></li><li>  Add to the <code>build.gradle</code> the application module: <br><pre> <code class="java hljs">apply plugin: <span class="hljs-string"><span class="hljs-string">"android-aspectj"</span></span></code> </pre> <br></li><li>  ... and depending on the module we add: <br><pre> <code class="java hljs">dependencies { compile <span class="hljs-string"><span class="hljs-string">'org.aspectj:aspectjrt:1.8.+'</span></span> }</code> </pre><br></li><li>  We write the aspect itself. <br>  Aspects can be written using a special syntax in files with the as extension, or using java + a series of annotations.  Since Android Studio does not include the AspectJ plugin, I preferred the second option (For Ultimate owners, IDEA versions are both available): <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Aspect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivityAspect</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TAG = <span class="hljs-string"><span class="hljs-string">"helloaspectj"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Pointcut</span></span>(<span class="hljs-string"><span class="hljs-string">"execution(* ru.hoticecream.helloaspectj.ui.MainActivity.onCreate(..))"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} <span class="hljs-meta"><span class="hljs-meta">@Before</span></span>(<span class="hljs-string"><span class="hljs-string">"onCreateMethod()"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doBeforeOnCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JoinPoint joinPoint)</span></span></span><span class="hljs-function"> </span></span>{ Log.i(TAG, <span class="hljs-string"><span class="hljs-string">"AspectJ was here"</span></span>); } }</code> </pre><br>  This aspect is built in before calling the <code>MainActivity.onCreate</code> method, displaying the corresponding message in the log. <br></li></ol><br><br>  Now, starting the application and opening the MainActivity, we will see in the log: <br> <code>... I/helloaspectjÔπï AspectJ was here</code> <br> <br>  Let me give you another example of the use of aspect. <br>  To do this, add a method to the MainActivity that sets a message to a specific text field: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextView mGreetingText; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); mGreetingText = (TextView) findViewById(R.id.greeting_message); setGreetingMessage(<span class="hljs-string"><span class="hljs-string">"Hello Android"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setGreetingMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String message)</span></span></span><span class="hljs-function"> </span></span>{ mGreetingText.setText(message); }</code> </pre><br>  As you can see, the field takes the value ‚ÄúHello Android‚Äù, by launching the application you can make sure of it;) <br><br>  Now add the following methods to the same aspect class: <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Pointcut</span></span>(<span class="hljs-string"><span class="hljs-string">"execution(* ru.hoticecream.helloaspectj.ui.MainActivity.setGreetingMessage(..))"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setGreetingMessageMethod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{} <span class="hljs-meta"><span class="hljs-meta">@Around</span></span>(<span class="hljs-string"><span class="hljs-string">"setGreetingMessageMethod()"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">makeNasty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ProceedingJoinPoint pjp)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Throwable </span></span>{ Log.d(TAG, pjp.getSignature().toLongString()); pjp.proceed(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object[] { <span class="hljs-string"><span class="hljs-string">"Hello AspectJ"</span></span> }); }</code> </pre><br>  Now this aspect is still looking for the <code>setGreetingMessage</code> method and replaces its call with the contents of the <code>makeNasty</code> method, using the @Around <code>@Around</code> for this <code>@Around</code> <br><br>  Having started the application, we will already see ‚ÄúHello AspectJ‚Äù.  At the same <code>MainActivity.java</code> we did not change the <code>MainActivity.java</code> . <br><br>  That's all.  I hope the article was useful to you. <br><br>  Finally, a couple of links: <br><ul><li>  For the fact that everything was so easy to say thanks to the plugin author for gradle: <br>  <a href="https://github.com/uPhyca/gradle-android-aspectj-plugin">github.com/uPhyca/gradle-android-aspectj-plugin</a> </li><li>  An interesting lecture on AspectJ, telling about examples of use and possibilities of the library: <br>  <a href="http://www.youtube.com/watch%3Fv%3DX_QJMKEgJBk%26index%3D3%26list%3DPLCA5CB42F5A816A17">www.youtube.com/watch?v=X_QJMKEgJBk&amp;index=3&amp;list=PLCA5CB42F5A816A17</a> </li><li>  And finally, the source code of the example from this article: <br>  <a href="https://github.com/HotIceCream/helloaspectj">github.com/HotIceCream/helloaspectj</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/231287/">https://habr.com/ru/post/231287/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../231275/index.html">Convenient binary data source instead of Stream</a></li>
<li><a href="../231277/index.html">We open possibilities of map in nginx</a></li>
<li><a href="../231279/index.html">‚ÄúNo complications‚Äù home video surveillance: AdvoCam-HappyCam review</a></li>
<li><a href="../231281/index.html">Sass maps: responsive design without routine computing</a></li>
<li><a href="../231285/index.html">Financing innovation. Introduction</a></li>
<li><a href="../231289/index.html">Experience in the development and production of prototypes of BLE sockets</a></li>
<li><a href="../231293/index.html">E-Commerce Today: Art and Science</a></li>
<li><a href="../231295/index.html">Images in the layout. Enough tolerating this</a></li>
<li><a href="../231297/index.html">Squares game</a></li>
<li><a href="../231299/index.html">Overview of manufacturers of consumables for FDM 3D printers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>