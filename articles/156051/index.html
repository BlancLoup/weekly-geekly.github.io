<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Circuit Switch FallBack: First Step on the Road to Voice in LTE</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the last article about LTE, we mentioned the technology of providing voice service CSFB (Circuit Switch FallBack). LTE networks are designed to tra...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Circuit Switch FallBack: First Step on the Road to Voice in LTE</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/2d8/19d/6f7/2d819d6f7f249bdd4d29bb60ee602e29.jpg" align="right"><br>  In the <a href="http://habrahabr.ru/company/megafon/blog/154153/">last article</a> about LTE, we mentioned the technology of providing voice service CSFB (Circuit Switch FallBack).  LTE networks are designed to transmit packet information; there is no voice in this network in the sense in which we understand this by the example of traditional GSM / UMTS networks.  But it is possible to change this. <br>  Currently, testing and configuration of CSFB technology, which uses the existing, traditional CS ( <a href="http://en.wikipedia.org/wiki/Circuit_switching">Circuit switching</a> ) domain of 2G / 3G networks, is <a href="http://en.wikipedia.org/wiki/Circuit_switching">underway</a> .  This is done because the original voice over LTE technology - VoLTE (Voice over LTE), where voice is already transmitted over an IP network using LTE tools without using previous generation networks, is dependent on so many state level solutions and permissions.  In order to create conditions for making calls using VoLTE, it is necessary to provide support for this functionality not only by the network, but also by the user equipment (User Equipment / UE). <br><br>  Let's leave VoLTE for future articles, but for now let's consider the CSFB from the technical side. <br><a name="habracut"></a><br><br><h4>  CSFB - Circuit switch fallback </h4><br>  The simplified EPS network architecture for CS fallback and SMS messaging is shown in the figure and is based on the use of the SGs interface: <div style="text-align:center;"><img src="https://habrastorage.org/storage2/872/4b1/770/8724b1770cbe29857c82ba105180500c.png"></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Features / characteristics of equipment supporting CS fallback </h6><br>  <b>The UE</b> , of course, has access to both E-UTRAN / EPC and CS domain through the GERAN and / or UTRAN network. <br>  <b>The MME</b> uses the LAI and the hash value obtained from the IMSI to determine the VLR number, in case this LAI is served by several MSC / VLRs, the same hash value / function is used in the <b>SGSN</b> . <br>  Everything is clear with <b>MSC</b> , but it is also possible to expand the functionality of CS fallback support with ICS and / or SRVCC. <br><br><h4>  Mobile Originated Call - Subscriber calls from LTE </h4><br>  What happens during a call to a subscriber who is on the LTE network?  Let's look at a simplified call flow (a diagram of the exchange of signaling messages between network elements), which will quite clearly explain everything: <br clear="all"><div style="text-align:center;"><img src="https://habrastorage.org/storage2/45a/68d/d00/45a68dd008c5364e43288f317dbde187.png"></div><br><br><h6>  Consider the basic scenario of events </h6>  The lucky owner of a phone with LTE support is walking down the street in the coverage area of ‚Äã‚Äã4G and 3G / 2G networks.  In the background, updated mail, Facebook, Twitter and other services.  Having decided to call, he performs his usual actions: dials a number and <s>presses the call button,</s> touches the location on the screen where the call button is shown. <br><br>  At this moment, the first <em>extended</em> request is generated (2 years ago it was difficult to imagine that the simplest voice call would be interpreted as an extended request) to provide the service.  The MME receives the request, having information that the subscriber is in the LTE network, informs the eNodeB about this, so that it initiates the CSFB procedure.  The CSFB procedure involves transferring to a 2G / 3G network, but the phone is already actively using the network at this time: it receives mail and updates from services, and this process cannot be interrupted.  Seeing the active data transfer, the eNodeB decides to make a handover to the 3G or 2G network.  The decision on the choice of the network is made on the basis of measurements received from the UE.  Thus, the transition between networks occurs without interruption of active data transfer sessions. <br><br>  The eNodeB communicates its decision to the MME, and then the MME begins to negotiate with the SGSN.  To start this process, you need to make sure that you have the necessary resources for this subscriber in the SGSN (PFCs, PDP context, APN) and in the RNC.  For this, the MME transmits a location change request (Update Location) to the SGSN.  SGSN, in turn, conducts the compliance of LTE services (EPS bearer service) to non-LTE services (PDP context) and requests resource allocation (PFCs - Packet Flow Context) to the RNC.  Not all services will be accepted, depending on the workload of the 3G network, some EPS services may be discarded. <br><br>  Then the RNC prepares the so-called ‚Äútransparent container from source to receiver‚Äù, which will contain data for both the 3G network (Handover Radio Resources) and LTE (NAS container).  Upon receiving confirmation of the availability of the necessary resources, the SGSN reports this to the MME, which initiates the Handover procedure (sends a ‚Äútransparent container‚Äù to the eNodeB). <br><br>  The eNodeB, having received the command, starts ‚Äúswitching‚Äù services from the MME to the SGSN, and at the same time sends the Handover command (with the ‚Äútransparent container‚Äù) to the UE.  At this command, the UE (smartphone) starts to rebuild to the radio part of the 3G network.  For these purposes, the ‚Äútransparent container‚Äù contains data for handover of both LTE and 3G networks.  After rebuilding to a new network, the UE sends an XID message (eXchange IDentifier) ‚Äã‚Äãand resumes data transfer at the same time.  The RNC informs the SGSN about the successful completion of the handover, as well as relays the XID to the SGSN.  After receiving confirmation of Update Location, the MME and eNodeB resources are released. <br><br>  And then the standard voice call procedure worked out over the years in 2G / 3G networks. <br><br><h4>  Mobile Terminated Call - LTE call subscriber </h4><br>  An incoming call to LTE is almost the same as the outgoing call discussed above, except that the initiator of the call is not the UE, but the MSC. <br clear="all"><div style="text-align:center;"><img src="https://habrastorage.org/storage2/654/e91/115/654e9111576b83cf339e84c1fd8a5871.png"></div><br>  To start, on the SGs interface, the MME accepts paging from the MSC with the necessary information (IMSI, VLR TMSI, Location Information).  Depending on the settings, paging is carried out either via IMSI or TMSI.  In the first case, the MME uses the IMSI, in the second case it generates S TMSI from the received data and transmits to the eNodeB.  After receiving the paging, the smartphone starts requesting radio resources and generates an advanced request.  As in the previous scenario, a handover occurs, and after it the UE responds to paging on the 2G / 3G network.  Voice connection is established. <br><br>  This is how relatively easy it is to use a legacy network to replenish voice services on a new generation network on the way to the upcoming VoLTE. <br><br><hr><h4>  Information sources </h4><br>  3GPP <a href="http://www.3gpp.org/ftp/Specs/html-info/23272.htm">TS 23.272</a> - Circuit Switched (CS) fallback in Evolved Packet System (EPS);  Stage 2 <br>  3GPP <a href="http://www.3gpp.org/ftp/Specs/html-info/23401.htm">TS 23.401</a> - General Packet Radio Service (GPRS) enhancements for Universal Terrestrial Radio Access Network (E-UTRAN) access <br>  3GPP <a href="http://www.3gpp.org/ftp/Specs/html-info/43129.htm">TS 43.129</a> - Packet-switched handover for GERAN A / Gb mode;  Stage 2 <br></div><p>Source: <a href="https://habr.com/ru/post/156051/">https://habr.com/ru/post/156051/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../156037/index.html">A bit about the interfaces in .Net (based on one interview)</a></li>
<li><a href="../156039/index.html">Battle City on unity in 1 day?</a></li>
<li><a href="../156045/index.html">Determining the dominant colors: Python and the k-means method</a></li>
<li><a href="../156047/index.html">The data center is the engine of energy efficiency in the world. But in Russia?</a></li>
<li><a href="../156049/index.html">Microelectronics for space and military</a></li>
<li><a href="../156053/index.html">VDI for SMB on Windows Server 2012 by HP</a></li>
<li><a href="../156057/index.html">Single-factor two-factor authentication</a></li>
<li><a href="../156059/index.html">Configuring the synchronization of two iRedMail mailers on two channels</a></li>
<li><a href="../156063/index.html">Android monetization is growing with each new version.</a></li>
<li><a href="../156065/index.html">Windows Azure webinar: news and latest cloud platform updates</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>