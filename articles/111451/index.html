<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Localization of .NET applications, and in particular ASP.NET WebForms</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habradrug! 
 Of course, I understand that the topic is already jaded, but I will try to describe my vision of the localization of the application a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Localization of .NET applications, and in particular ASP.NET WebForms</h1><div class="post__text post__text-html js-mediator-article">  Hi Habradrug! <br>  Of course, I understand that the topic is already jaded, but I will try to describe my vision of the localization of the application and its implementation.  And so, what we want to get in the end: The system of fast localization of .NET applications, and in particular WebForms, is at the post development stage.  The points: <br><br>  1. Application development: minimum attention localization. <br>  2. Completion of development: a minimum of time for localization. <br>  And it is also necessary that it would all be as convenient and simple as possible. <br><br>  In short, everything will look like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We will have a method, something like a <i>gettext</i> , to which we will transmit some text, or a key + text, and the method in turn will return a localized string or what was passed to it.  And there will also be a utility that will parse the <i>* .cs</i> , <i>* .aspx</i> , <i>* .ascx</i> files in search of this very method, get the keys and text from there, look, or the given texts and keys are already in the application resources.  Then we will use google translate, so that at least poorly, but translate new texts.  And finally, edit the translations and save it all back to the resources.  Is done. <br>  It is obvious that a similar, or maybe even the best mechanism has already been developed, but, having climbed the Internet, I saw only mega hard and, besides, paid solutions. <br><br><a name="habracut"></a><br><br>  So, we will start implementation.  Let's start with an auxiliary class, a for server-side controls with ExpressionBuilder-a: <br><habracut><br><blockquote><code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> L <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> Regex KeyRepairRegex = <font color="#0000ff">new</font> Regex( <font color="#A31515">"[^\\w\\d]"</font> , RegexOptions.Compiled); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">string</font> Run( <font color="#0000ff">string</font> <font color="#0000ff">value</font> ) <br> { <br> <font color="#0000ff">var</font> key = GenerateKey( <font color="#0000ff">value</font> ); <br> <font color="#0000ff">var</font> localized = Resources.ResourceManager.GetString(key); <br> <font color="#0000ff">return</font> <font color="#0000ff">string</font> .IsNullOrEmpty(localized) ? <font color="#0000ff">value</font> : localized; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">string</font> Run( <font color="#0000ff">string</font> key, <font color="#0000ff">string</font> <font color="#0000ff">value</font> ) <br> { <br> <font color="#0000ff">var</font> localized = Resources.ResourceManager.GetString(key); <br> <font color="#0000ff">return</font> <font color="#0000ff">string</font> .IsNullOrEmpty(localized) ? <font color="#0000ff">value</font> : localized; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">string</font> Run( <font color="#0000ff">string</font> key, <font color="#0000ff">string</font> <font color="#0000ff">value</font> , <font color="#0000ff">params</font> <font color="#0000ff">object</font> [] format) <br> { <br> <font color="#0000ff">var</font> localized = Run(key, <font color="#0000ff">value</font> ); <br> <br> <font color="#0000ff">if</font> (format != <font color="#0000ff">null</font> &amp;&amp; format.Length &gt; 0) <br> { <br> <font color="#0000ff">try</font> <br> { <br> localized = <font color="#0000ff">string</font> .Format(localized, format); <br> } <br> <font color="#0000ff">catch</font> <br> { <br> <br> } <br> } <br> <font color="#0000ff">return</font> localized; <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">string</font> GenerateKey( <font color="#0000ff">string</font> <font color="#0000ff">value</font> ) <br> { <br> <font color="#0000ff">if</font> ( <font color="#0000ff">string</font> .IsNullOrEmpty( <font color="#0000ff">value</font> )) <font color="#0000ff">return</font> <font color="#0000ff">value</font> ; <br> <br> <font color="#0000ff">value</font> = <font color="#0000ff">value</font> .Length &gt; 23 ? <font color="#0000ff">value</font> .Substring(0, 23) + <font color="#A31515">"__"</font> : <font color="#0000ff">value</font> ; <br> <font color="#0000ff">value</font> = KeyRepairRegex.Replace( <font color="#0000ff">value</font> , <font color="#A31515">"_"</font> ); <br> <font color="#0000ff">if</font> ( <font color="#0000ff">char</font> .IsUpper( <font color="#0000ff">value</font> [0])) <font color="#0000ff">value</font> = <font color="#A31515">"_"</font> + <font color="#0000ff">value</font> ; <br> <font color="#0000ff">value</font> = <font color="#0000ff">value</font> .ToLowerInvariant(); <br> <br> <font color="#0000ff">return</font> <font color="#0000ff">value</font> ; <br> } <br> }</font></code> </blockquote> <br><br>  Now, during development, in places where we need localization, we write: <br><br><blockquote> <code><font color="black">&lt;%= L.Run( <font color="#A31515">"Hello, Mr.Everybody"</font> ) %&gt;</font></code> </blockquote> <br><br>  Class <i>L is</i> not specifically located in any <i>namespace</i> , so that you do not have to import it in <i>* .ascx</i> files. <br><br><blockquote> <code><font color="black">&lt;%@ Import Namespace = <font color="#A31515">"Example.Namespace"</font> %&gt; <br></font></code> </blockquote><br><br>  There is, as can be seen from the code, not a few important method <i>GenerateKey</i> .  If we transmit only text, without a key, then this method will generate a key and it is this key that we will look for in resources.  The key in resources can contain only the characters [a-z0-9_].  And our utility will use the same method to generate keys.  Now we will consider ExpressionBuilder and give a more specific example of the whole scheme.  Why do we need this very Builder? <br><br>  The &lt;% =%&gt; construction in server controls will lead to an error, and for &lt;% #%&gt; you need to additionally call the DataBind method, which is not very convenient.  We need a class inherited from ExpressionBuilder. <br><br><blockquote> <code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> LExpressionBuilder: ExpressionBuilder <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> CodeExpression GetCodeExpression(BoundPropertyEntry entry, <font color="#0000ff">object</font> parsedData, ExpressionBuilderContext context) <br> { <br> <font color="#0000ff">var</font> thisType = <font color="#0000ff">new</font> CodeTypeReferenceExpression(GetType()); <br> <font color="#0000ff">var</font> expression = <font color="#0000ff">new</font> CodePrimitiveExpression(entry.Expression.Trim()); <br> <font color="#0000ff">const</font> <font color="#0000ff">string</font> evaluationMethod = <font color="#A31515">"Localize"</font> ; <br> <font color="#0000ff">return</font> <font color="#0000ff">new</font> CodeMethodInvokeExpression(thisType, evaluationMethod, <font color="#0000ff">new</font> CodeExpression[] { expression }); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">string</font> Localize( <font color="#0000ff">string</font> expression) <br> { <br> <font color="#0000ff">return</font> L.Run(expression); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">object</font> EvaluateExpression( <font color="#0000ff">object</font> target, BoundPropertyEntry entry, <font color="#0000ff">object</font> parsedData, ExpressionBuilderContext context) <br> { <br> <font color="#0000ff">return</font> Localize(entry.Expression); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">bool</font> SupportsEvaluate <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; } <br> } <br> }</font></code> </blockquote> <br><br>  As a result, we write: <br><br><blockquote> <code><font color="black">&lt;input typ= <font color="#A31515">'submit'</font> id= <font color="#A31515">'btnSubmit'</font> runat= <font color="#A31515">'server'</font> <font color="#0000ff">value</font> = <font color="#A31515">"&lt;%$ L:A people free to choose will always choose peace %&gt;"</font> /&gt;</font></code> </blockquote> <br><br>  The first part is ready.  Go to the utility.  This is an ordinary WinForms application. <br><br>  <a href="">Classes Chart</a> <br><br>  As can be seen from the diagram, the code is fairly straightforward.  But the main thing is simple.  We load the <i>Solution</i> or project we need, specify the path to our resource file in the Settings class.  And ... "let's go"!  <i>Solution</i> class will load all files.  <i>CodeParser will</i> load all the strings and keys into the <i>Translation</i> class, which in turn will load all the translations from the resources and show it all in the GridView.  Now you can translate manually or through google, you can save the original lines to a text file or something else to implement, for example, saving to <i>xml</i> . <br><br>  <a href="http://www.assembla.com/code/rlocalizer/subversion/nodes">Assembla Subversion</a> <i>(Registration is not required)</i> <br><br>  This utility was written for myself quickly, according to the principle: ‚Äúif only it worked,‚Äù so I will ask the guru not to judge strictly.  If someone has an interest, I can bring this business to, at least, the alpha version. <br><br>  What else do you want to do: <br><br>  <i>CodeParser</i> ripping out lines from files remembers their positions.  And since most of the localized strings go to me initially without keys, several extra seconds are needed to generate them, so the utility should insert the keys to the strings into the files afterwards. <br><br>  But even without this, everything works very fast, although I will be glad to hear any criticism or suggestions. <br><br>  Thanks for attention. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="gray">* Source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> </habracut></div><p>Source: <a href="https://habr.com/ru/post/111451/">https://habr.com/ru/post/111451/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111439/index.html">Windows Confidential: What is preserved from Windows 3.0</a></li>
<li><a href="../111441/index.html">MapChat</a></li>
<li><a href="../111445/index.html">The local knowledge base of the organization on the wiki engine</a></li>
<li><a href="../111448/index.html">Programmer's notes on the new features of MODx Revolution</a></li>
<li><a href="../111449/index.html">String Search Algorithms</a></li>
<li><a href="../111452/index.html">Taiwanese patient Twinhead Slimnote GX</a></li>
<li><a href="../111453/index.html">Budget VPS hosting BurstNET (USA) on personal experience</a></li>
<li><a href="../111454/index.html">HbbTV or Teletext v3.0</a></li>
<li><a href="../111456/index.html">Java Bytecode Fundamentals</a></li>
<li><a href="../111458/index.html">Unpacking Lego Mindstorms NXT 2.0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>