<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Arduino and keyboard (full guide)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, residents of Habr! Today I decided to make a full guide on keyboards for Arduino. 
 Attention! The article is focused primarily on beginners! 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Arduino and keyboard (full guide)</h1><div class="post__text post__text-html js-mediator-article">  Hello, residents of Habr!  Today I decided to make a full guide on keyboards for Arduino. <br>  <i>Attention!</i>  <i>The article is focused primarily on beginners!</i> <br><br>  In many projects, it becomes necessary to create user input capabilities.  If you need to implement a large number of buttons (relatively), then connecting them separately becomes both long and irrational.  For this purpose, it is better to choose some kind of keyboard, but as with any choice, it must be approached consciously.  What are the types of keyboards and how to interact with them? <br><a name="habracut"></a><br>  Globally, all modules of this type can be divided into two broad categories: <i>matrix</i> and <i>analog</i> . <br><br><h2>  Matrix keyboards </h2><br>  The easiest, cheapest and most popular type of keyboards.  It is relatively simple to manufacture and fills most of the arduino module market.  Most often looks like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/fee/390/1d2/fee3901d2c35439b9c02446b6dcf1859.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e35/191/2f2/e351912f255faab99497335cc854f971.jpg" alt="image"><br><br><h3>  Principle of operation </h3><br>  You can understand how this keyboard works by studying the following scheme: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/411/573/a54/411573a548046547f8c3f2b877311754.png" alt="image"><br><br>  To understand which button was pressed, you need to give a signal to the first four contacts of the module and watch which signal comes back from the second.  But you should not be afraid of the fact that you will have to write the processing algorithms for eight pins manually - the ready-made library ‚Äúkeypad.h‚Äù will help us in this, thanks to which we will not have to reinvent the wheel. <br><br><h3>  Connection to the board </h3><br><h4>  Connecting the module itself </h4><br>  In this article I will use the following connection diagram: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a92/976/140/a9297614070ab279e0f1869d4bbe4dde.png" alt="image"><br><br>  You probably have a question: ‚ÄúWhy did I decide to use pins from the second to the ninth, skipping zero and first?‚Äù - the fact is that some modules use them as RX and TX channels for receiving and transmitting data, respectively.  For example, bluetooth module.  Therefore, taking into account the possible addition of the project to other modules, it was decided to leave these connection pins free. <br><br><h4>  Writing a sketch </h4><br>  To begin with, in order to be able to use the library to connect keyboards in the code, you need to install it on your device.  This can be done as follows: in the Arduino IDE itself, click <i>Sketch -&gt; Connect Library -&gt; Manage Libraries ...</i> or use the hotkey combination "Ctrl + Shift + I".  In the search we drive in "keypad.h" (without parentheses) and click "Install". <br><br>  After installation, we start writing the sketch: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Keypad.h&gt; //      const byte ROWS = 4; //     const byte COLS = 4; //     char hexaKeys[ROWS][COLS] = {//      ,   ,   {'1','4','7','*'}, {'2','5','8','0'}, {'3','6','9','#'}, {'A','B','C','D'} }; byte rowPins[ROWS] = {5, 4, 3, 2}; //      byte colPins[COLS] = {9, 8, 7, 6}; //      //    : Keypad customKeypad = Keypad( makeKeymap(hexaKeys), rowPins, colPins, ROWS, COLS); void setup(){ Serial.begin(9600);//      } void loop(){ char customKey = customKeypad.getKey();//   if (customKey){// -  Serial.println(customKey);//      } }</span></span></span></span></code> </pre> <br><h3>  Advantages and disadvantages </h3><br><h4>  Minuses </h4><br><ul><li>  Too many pins to connect to work.  This is a big problem, if you are not creating a calculator or combination lock, but a larger project, in which you still need to use a huge number of different modules - perhaps they simply do not have enough pins. <br></li><li>  The quality of the module is too low: no one guarantees you a constant, stable signal.  The original keyboards are not made at a very high level, and if you even made an order on Aliexpress, then most likely you will have to fix the jambs of Chinese engineers with a soldering iron to achieve stable operation. <br></li><li>  An additional library is used, which will also occupy the memory of the microcontroller, which it does not have very much.  If you are writing a big project with a lot of functions and calculations, you need to read data from the keyboard manually or use an analog keyboard for each byte in the account. <br></li></ul><br><h4>  pros </h4><br><ul><li>  Low price </li><li>  Easy to find on sale </li></ul><br><h2>  Analog Keyboards </h2><br><h3>  Principle of operation </h3><br>  In analog keyboards, resistors are used to change the voltage level, and the signal goes through one channel, which is connected to the actual pin on the board.  How everything is arranged can be understood by looking at the following scheme: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f45/e95/aaf/f45e95aaf010b5b38f9887e9aa7f224f.png" alt="image"><br><br><h3>  Connection to the board </h3><br>  The connection is very simple, but may change depending on the specific keyboard.  In this article I will consider an example of using <a href="https://ru.aliexpress.com/item/32635207928.html">this</a> Chinese analog keyboard with Ali. <br><br>  So: we connect the analog output of the keyboard to any analog pin on the board, connect the VCC contact on the board with 3.3V (do not look at the inscription on the keyboard itself, which says 5V is an error), and GND on the board with GND on the module.  You can use the following scheme: <br><br><img src="https://habrastorage.org/webt/lx/wn/d1/lxwnd1z3gxtgoqrolfl1yi5v2je.png"><br><br><h4>  Sketch writing </h4><br>  There is no need to use third-party libraries, because  everything is very simple and clear.  This is actually the code itself that reads the pressed button and displays its number, from 1 to 16 (from left to right, from top to bottom) or 0, if nothing is pressed, to the port monitor. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> KEYPAD_PIN = <span class="hljs-number"><span class="hljs-number">0</span></span>;<span class="hljs-comment"><span class="hljs-comment">//    void setup() { Serial.begin(9600); analogReadResolution(10);//      0...1023 } void loop() { Serial.println(getPressedKeypadButton());//       } short int getPressedKeypadButton(){//  keypad`a //   1  16      0     const int OCCURACY = 5;//     int sensorValue = analogRead(KEYPAD_PIN);//    int keys[] = {1016, 937, 860, 794, 683, 641, 604, 571, 509, 485, 464, 444, 407, 328, 275, 236};//    (0-15,  0=1, 1=2  ..) if(sensorValue &gt; -OCCURACY &amp;&amp; sensorValue &lt; OCCURACY){return 0;}//   ,    0 for(short int i = 0; i &lt; 16; i++){//             if(sensorValue &gt; (keys[i] - OCCURACY) &amp;&amp; sensorValue &lt; (keys[i] + OCCURACY)){ return i+1;//   , ..     0   ,    0    } } }</span></span></code> </pre> <br><h3>  Advantages and disadvantages </h3><br><h4>  pros </h4><br><ul><li>  Very simple connection </li><li>  It takes only one pin </li><li>  Saves the memory you do not spend under the library </li><li>  Provides stable operation (provided that you will not press more than one button at a time) </li></ul><br><h4>  Minuses </h4><br><ul><li>  It is more expensive than matrix keyboards </li><li>  Most likely the only way to purchase will order from China and delivery will take some time. </li></ul><br><h2>  Results </h2><br>  Personally, I recommend using analog keyboards, as they are often better quality ones and it is easier to connect them.  The main thing is to pay attention to the table of the values ‚Äã‚Äãof the pressed buttons, which the manufacturer provides or, if not, you can make these measurements yourself by outputting the values ‚Äã‚Äãfrom the analog port to the port monitor, so that you can use them in code.  But the choice is always yours: use the standard cheap option or overpay for the sake of significant advantages in some situations. <br><br>  I have it all.  Leave your questions in the comments, write your opinion and meet on the open spaces of Habr! </div><p>Source: <a href="https://habr.com/ru/post/460409/">https://habr.com/ru/post/460409/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460399/index.html">SVG download indicator on Vue.js</a></li>
<li><a href="../4604/index.html">Syndication reaction</a></li>
<li><a href="../46040/index.html">The concept of the mechanism for correcting typos</a></li>
<li><a href="../460403/index.html">Advantages and disadvantages of HugePages</a></li>
<li><a href="../460405/index.html">Why do we need hidden game mechanics</a></li>
<li><a href="../46041/index.html">Electronic First Aid Guide</a></li>
<li><a href="../460411/index.html">Insane GIF Converter in Animated Telegram Stickers</a></li>
<li><a href="../460413/index.html">7 useful sites and applications for learning English</a></li>
<li><a href="../460415/index.html">Apple Watch 4 (44 mm, 2019) vs Pebble Steel Classic (2014)</a></li>
<li><a href="../46042/index.html">And in parrots, I am much longer ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>