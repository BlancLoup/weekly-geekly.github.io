<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The script to disable Windows components</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuing a series of articles on the administration of the Windows operating system. In the previous article, work was done with service packs, and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The script to disable Windows components</h1><div class="post__text post__text-html js-mediator-article">  Continuing a series of articles on the administration of the Windows operating system.  In the previous <a href="https://habrahabr.ru/post/343132/">article,</a> work was done with service packs, and in this one with system components.  Additional components extend the functionality of the OS, but many of them are simply useless for most users.  I offer a convenient script that disables "unnecessary" components.  Script commands refer to the <b>DISM</b> tools and can be applied to both the installed system and the offline image.  The script determines the version of the <i>dism.exe</i> utility and substitutes the necessary commands.  Implemented branching according to the version of the target OS, so that in one script you can specify the components to be disabled for different versions of Windows. <br><a name="habracut"></a><br>  Disabling components of this script is reversible.  I mainly do this in order to remove links to unnecessary programs from the Start menu.  Here, for example, there are two components for each version of Windows that will be disabled.  Those who will use this script in their work need to supplement it.  Determine the components that you do not need and add their disabling to the script.  By simple changes, it is possible on the contrary - to include components.  For my needs, I leave only Internet Explorer, Media Player, Windows Search and .NET Framework 3.5.1.  The latter is disabled by the manufacturer in new versions of Windows, with the deletion of files, and in order to enable it I have a separate script about which I will write later. <br><br><h2>  Script </h2><br><pre><code class="dos hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">title</span></span> Disabling features <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Windows image <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _file=install.wim <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _img=Online <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _mnt=mount <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _tool=<span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _word=Wim dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-<span class="hljs-built_in"><span class="hljs-built_in">Help</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> "Version: <span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>" &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> || <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _tool=<span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_tool%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _word=Image :pre_menu <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> <span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :version dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>Info /<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>File:<span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEQ</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /p _ind=Input index or press [Enter] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> quit: || <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :version <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GTR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEQ</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :ind_menu <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :pre_menu :ind_menu <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>Info /<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>File:<span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> /Index:<span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEQ</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :pre_menu choice /c abcdefghijklmnopqrstuvwxyz /n /m "Mount selected image? [m] " <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EQU</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :mount <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :pre_menu :version dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-<span class="hljs-built_in"><span class="hljs-built_in">Help</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> "Image Version: <span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span>" &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :disable-<span class="hljs-number"><span class="hljs-number">7</span></span> dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-<span class="hljs-built_in"><span class="hljs-built_in">Help</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> "Image Version: <span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>" &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :disable-<span class="hljs-number"><span class="hljs-number">9</span></span> dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-<span class="hljs-built_in"><span class="hljs-built_in">Help</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> "Image Version: <span class="hljs-number"><span class="hljs-number">10</span></span>" &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :disable-A <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :unmount :disable-<span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Getting list of features. Please wait... dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Features /<span class="hljs-built_in"><span class="hljs-built_in">Format</span></span>:Table &gt; <span class="hljs-variable"><span class="hljs-variable">%TEMP%</span></span>\features.txt <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _num+=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%_num%</span></span> Disable: WindowsGadgetPlatform <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :state WindowsGadgetPlatform &amp;&amp;^ dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Disable-Feature /FeatureName:WindowsGadgetPlatform /NoRestart <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _num+=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%_num%</span></span> Disable: MediaCenter <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :state MediaCenter &amp;&amp;^ dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Disable-Feature /FeatureName:MediaCenter /NoRestart <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> <span class="hljs-variable"><span class="hljs-variable">%TEMP%</span></span>\features.txt <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> <span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :unmount :disable-<span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Getting list of features. Please wait... dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Features /<span class="hljs-built_in"><span class="hljs-built_in">Format</span></span>:Table &gt; <span class="hljs-variable"><span class="hljs-variable">%TEMP%</span></span>\features.txt <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _num+=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%_num%</span></span> Disable: Printing-Foundation-Features <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :state Printing-Foundation-Features &amp;&amp;^ dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Disable-Feature /FeatureName:Printing-Foundation-Features /NoRestart <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _num+=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%_num%</span></span> Disable: Windows-Defender-Default-Definitions <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :state Windows-Defender-Default-Definitions &amp;&amp;^ dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Disable-Feature /FeatureName:Windows-Defender-Default-Definitions /NoRestart <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> <span class="hljs-variable"><span class="hljs-variable">%TEMP%</span></span>\features.txt <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> <span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :unmount :disable-A <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Getting list of features. Please wait... dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Get-Features /<span class="hljs-built_in"><span class="hljs-built_in">Format</span></span>:Table &gt; <span class="hljs-variable"><span class="hljs-variable">%TEMP%</span></span>\features.txt <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _num+=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%_num%</span></span> Disable: MicrosoftWindowsPowerShellV2Root <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :state MicrosoftWindowsPowerShellV2Root &amp;&amp;^ dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Disable-Feature /FeatureName:MicrosoftWindowsPowerShellV2Root /NoRestart <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /a _num+=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">%_num%</span></span> Disable: NetFx4-AdvSrvs <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> :state NetFx4-AdvSrvs &amp;&amp;^ dism /<span class="hljs-variable"><span class="hljs-variable">%_img%</span></span> /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Disable-Feature /FeatureName:NetFx4-AdvSrvs /NoRestart <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> ------------------------------------------------------------------------------- <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> <span class="hljs-variable"><span class="hljs-variable">%TEMP%</span></span>\features.txt <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exist</span></span> <span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :unmount :state <span class="hljs-built_in"><span class="hljs-built_in">findstr</span></span> %<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-variable"><span class="hljs-variable">%TEMP%</span></span>\features.txt | <span class="hljs-built_in"><span class="hljs-built_in">find</span></span> "Enable" &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b :mount <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-built_in"><span class="hljs-built_in">md</span></span> <span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Mount-<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span> /<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span>File:<span class="hljs-variable"><span class="hljs-variable">%_file%</span></span> /Index:<span class="hljs-variable"><span class="hljs-variable">%_ind%</span></span> /MountDir:<span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-variable"><span class="hljs-variable">%ERRORLEVEL%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NEQ</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-built_in"><span class="hljs-built_in">rd</span></span> <span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> &amp; <span class="hljs-built_in"><span class="hljs-built_in">pause</span></span> &amp; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _img=Image:<span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :version :unmount <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-variable"><span class="hljs-variable">%_img%</span></span>==Online ( dism /English /LogLevel:<span class="hljs-number"><span class="hljs-number">1</span></span> /Unmount-<span class="hljs-variable"><span class="hljs-variable">%_word%</span></span> /MountDir:<span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> /Commit <span class="hljs-built_in"><span class="hljs-built_in">rd</span></span> <span class="hljs-variable"><span class="hljs-variable">%_mnt%</span></span> ) <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> _img=Online <span class="hljs-keyword"><span class="hljs-keyword">goto</span></span> :pre_menu</code> </pre> <br><h2>  Using </h2><br>  This script can disable components both in the online system and in the offline image.  If there is no <i>install.wim</i> image file in the launch folder, the script will disable the components in fully automatic mode.  If there is an <i>install</i> file in the startup folder, <i>install.wim</i> , then the script reads information about it from the existing "indexes" and offers to enter a number.  After that, extended information about the selected "index" is displayed, a request for mounting is issued.  Pressing any key leads to a return, and pressing the [m] key launches the following chain of actions: mounting the image, disabling components, unmounting the image, returning to the selection menu.  Then you can select another "index" to disable components.  Selecting "index" at number 0 starts disabling components on a live OS. <br><br><h2>  Parsing code </h2><br>  At first, the <b>set</b> command <b>sets</b> the variables.  You can change the estimated name of the <i>install.wim</i> image <i>file</i> (for example, to <i>install.esd</i> ).  You can change the name of the mount folder or set the path if the mount folder should be outside the launch folder.  From the installation of the ‚Äúlevel‚Äù of logging, as in the previous script on the update packages, I decided to refuse and directly registered in all commands informing only about errors - <i>/ LogLevel: 1</i> .  Also, in all commands I added the <i>/ English</i> key so that all messages are displayed in English. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The script can be run on different versions of the OS, and thus refer to different versions of the <b>DISM</b> system, which differ in the set of commands.  So, in versions after <b>6.1</b> in all commands, the word <i>Wim is</i> replaced by <i>Image</i> , although the old ‚Äúnames‚Äù of commands are left for backward compatibility.  At the very beginning of the script, the version of the <i>dism.exe</i> utility is <i>determined</i> and, in the future, the necessary word is substituted into all the commands.  It would have been possible to do without determining the version, but I use this functionality in my script for retrieving information from a Windows image, so I simply did not rewrite the code. <br><br><h3>  : pre_menu </h3><br>  Preliminary menu.  Getting basic information about a <i>wim</i> file with error checking.  If there is no image file, then run in online mode.  I did not find information about the maximum number of "indexes" in one image and set the value to 24. <br><br><h3>  : ind_menu </h3><br>  Index menu.  Get extended information about the selected "index" in a <i>wim</i> file with error control.  Offer to mount the "index". <br><br><h3>  : version </h3><br>  Determining the version of the target system.  If the required string is found, then go to the specified label.  If the string is not detected, then unmount occurs. <br><br><h3>  : disable-7: disable-9: disable-A </h3><br>  Labels target service systems.  I call Windows 8.1 - nine, and Windows 10 - Windows A (who understands the topic), so these labels have names.  At the beginning of this block, the status of all components is queried and saved in the <i>features.txt</i> file.  Later, in order to speed up the shutdown process and not try to disable something that is already disabled, a preliminary check of the state of each component takes place.  At the end of the block - delete temporary files and unmount. <br><br><h3>  : state </h3><br>  Check component status.  Pseudo-function that returns the result by error code in the global variable <i>% ERRORLEVEL%</i> .  The line with the name of the component is searched in the <i>features.txt</i> file and if the word ‚ÄúEnable‚Äù is found and also found, then the signal is turned off. <br><br><h3>  : mount </h3><br>  Mounting image  Pre-created mount folder.  Error control.  The variable defining the specification of the image changes, now points to the path to the autonomous image. <br><br><h3>  : unmount </h3><br>  Unmounting an image.  If online maintenance was performed (/ Online), then it is not necessary to unmount it.  Return of variables to initial values. <br><br><h2>  Possible problems </h2><br>  When servicing the image of the higher version on the system of the lower version, there may be hangs and errors.  That is, you do not need to try to process the Windows 8.1 or 10 image file on Windows 7. Also, for successful execution of all commands, you need to disable User Account Control - set the <b>EnableLUA</b> parameter to 0. <br><br><h2>  Question </h2><br>  I turn off all components related to printing and at the same time my printer continues to print and the scanner to scan.  I assume that print components (for example, <i>Printing-Foundation-Features</i> and others) are used for advanced features ‚Äî for example, to set up a printer accessible over a network.  Is it so? </div><p>Source: <a href="https://habr.com/ru/post/345510/">https://habr.com/ru/post/345510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345500/index.html">Generative design: on the threshold of a new design era</a></li>
<li><a href="../345502/index.html">Monitoring SMART HDD - windows + python + zabbix</a></li>
<li><a href="../345504/index.html">Five safety rules for holiday trips</a></li>
<li><a href="../345506/index.html">We introduce mandatory verification of customers</a></li>
<li><a href="../345508/index.html">Analysis of publications on Habrahabr for 2017. Statistics, useful finds and ratings</a></li>
<li><a href="../345512/index.html">Five antitheses to the next artificial intelligence revolution</a></li>
<li><a href="../345514/index.html">Subjective differences in defense and business</a></li>
<li><a href="../345518/index.html">If you're a girl, is it worth going to the developers. My experience</a></li>
<li><a href="../345520/index.html">Java Programmer Crib 10: Lombok</a></li>
<li><a href="../345522/index.html">UE4 and mobile development: myths and reality</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>