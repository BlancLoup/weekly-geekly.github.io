<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mirror of the reference archives of Visual Studio 2010</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction  One of the few useful innovations of the Visual Studio 2010 help system (aka Microsoft Help System 1.1) is the ability to install and up...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mirror of the reference archives of Visual Studio 2010</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4>  One of the few useful innovations of the Visual Studio 2010 help system (aka Microsoft Help System 1.1) is the ability to install and update help archives from the online catalog.  However, the need to extract the order of a gigabyte of archives for each developer machine may seem expensive, so it was decided to create a local mirror of the online catalog.  Unfortunately, it was not possible to find an official way to solve this problem. <br><br><h4>  Study </h4>  Using any HTTP sniffer (such as <a href="http://www.fiddler2.com/fiddler2/">Fiddler</a> , for example), you can find out that the directory is located at <a href="http://services.mtps.microsoft.com/ServiceAPI/products">http://services.mtps.microsoft.com/ServiceAPI/products</a> , while the archives are located directly on http: // packages .mtps.microsoft.com /.  It is these two resources that will need to be mirrored. <br><br><h4>  Implementation </h4><a name="habracut"></a>  To create a mirror, we need the well-known console utility wget, as well as a web server (I used nginx). The mirror creation process consists of the following steps: <ol><li>  Training.  The first step is to create a folder that will store the contents of the future mirror, for example D: \ mtps. </li><li> Download directory.  In the created folder, you need to run the following, rather lengthy command: <br> <code>wget -r -k -x -nH -H -N -E -l inf -e robots=off -X /ServiceAPI/packages -R *fr-fr*,*pt-br*,*es-es*,*pl-pl*,*de-de*,*cs-cz*,*it-it*,*tr-tr*,*ru-ru*,*ja-jp*,*ko-kr*,*zh-tw*,*zh-cn* http://services.mtps.microsoft.com/ServiceAPI/products/</code> <br>  after which, in the folder, there will be a mass of archives, and also a ServiceAPI folder.  It is worth paying attention to the -R parameter, which controls the language of the loaded archives.  In this case, all languages ‚Äã‚Äãexcept en-us are excluded. </li><li>  Setting up a web server.  First you need to mount the previously created folder as the root of the web server, and then create a rewrite rule that would make links like http://services.mtps.microsoft.com/ServiceAPI/products/dd936256 into http: //services.mtps. microsoft.com/ServiceAPI/products/dd936256.html because this is how wget saves the directory structure.  In my case, the server setup looked like this: <br> <code>location / {&lt;br/&gt; root d:\mtps;&lt;br/&gt; index index.html index.htm;&lt;br/&gt; rewrite ^(.*/[a-z0-9-]+)$ $1.html last;&lt;br/&gt;}&lt;br/&gt;</code> </li> <li>  Customize the client.  Since the help system management utility expects a directory at services.mtps.microsoft.com, you need to edit the etc / hosts file by matching the address of our local mirror to this domain.  In my case, it was enough to create an alias on localhost. </li><li>  Check.  Now you can run the Help Library Manager (menu Help -&gt; Manage Help Contents in Visual Studio) and make sure that the Check for updates online and Install content from online items work fine using the contents of the local mirror. </li></ol>  To update the mirror, just go to the folder with the archives, delete the ServiceAPI subfolder and restart wget with the above parameters, while the ‚ÄìN switch prevents the old archives from being downloaded again.  You can also create a script that automatically performs this work and runs, say, once a week using the scheduler. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I hope this guide will be useful to you. </div><p>Source: <a href="https://habr.com/ru/post/133266/">https://habr.com/ru/post/133266/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../133258/index.html">Realistic shadows using CSS3 without using images</a></li>
<li><a href="../133259/index.html">Single-pixel contact lens checked on rabbits</a></li>
<li><a href="../133260/index.html">Hackers made another "climategate"</a></li>
<li><a href="../133261/index.html">Jekyll and Github Blog</a></li>
<li><a href="../133263/index.html">Live broadcast of the lecture "Interaction with the investor" and the seminar "Creating a presentation for the investor"</a></li>
<li><a href="../133267/index.html">Video review of applications and games for iPad - iPADrom</a></li>
<li><a href="../133268/index.html">Google improves SSL session security</a></li>
<li><a href="../133269/index.html">Detachment of special opinion</a></li>
<li><a href="../133270/index.html">Custom annotations in symfony 2</a></li>
<li><a href="../133272/index.html">"Premium" War Runet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>