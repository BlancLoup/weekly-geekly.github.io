<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>UWP Game: Advanced Splash Screen</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! We continue our experimental series of articles for self-taught programmers, in which Alexey Plotnikov , one of the members of our Microsoft...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>UWP Game: Advanced Splash Screen</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr!  We continue our experimental series of articles for self-taught programmers, in which <a href="https://habrahabr.ru/users/lxgdark/">Alexey Plotnikov</a> , one of the members of our Microsoft Developer community, talks about creating a game for UWP.  Today we will talk about the extended splash screen.  Do not forget to leave comments, you can influence the course of development. <br><br><img src="https://habrastorage.org/webt/mz/yy/vj/mzyyvjrvmpddxrbfvsczlokttqm.jpeg"><a name="habracut"></a><br><br><ul><li>  <a href="https://habrahabr.ru/company/microsoft/blog/349402/"><b>Part 1: Where to start</b></a> </li><li>  <b><a href="https://habr.com/company/microsoft/blog/351972/">Part 2: Advanced Splash Screen</a></b> </li><li>  <b><a href="https://habr.com/company/microsoft/blog/354426/">Part 3: The style of the mother's son's girlfriend</a></b> </li><li>  <b><a href="https://habr.com/company/microsoft/blog/358426/">Part 4: Receiving user data (voluntary)</a></b> </li><li>  <b><a href="https://habr.com/company/microsoft/blog/414261/">Part 5: Where do you keep the data?</a></b> </li></ul><br>  <i>I give the word to the author.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Objectively speaking, the topic of the extended splash screen was worth considering closer to the end of this cycle.  This is not only not the most important part of the application, but, in principle, not mandatory.  However, since the cycle is written in parallel with the development of the project, this makes some adjustments to the order of writing articles.  I have an extended splash screen ready, and in the course of the cycle there will be situations where I will be sent to it, so I decided to talk about it first. <br><br>  We start small - what is a splash screen and why should it be expanded?  You have definitely come across application screensavers long before the advent of UWP.  We will not go far.  When you start Visual Studio, you enter a rectangular image with the appropriate caption. <br><br><img src="https://habrastorage.org/webt/l9/3e/nr/l93enr8tbrjsfauct9zft5aqngg.png"><br><br>  Each program needs a little time to initialize and load the interface, and at this time the user understands that something is happening, the splash screen image is shown.  In programs where the startup process is more complicated and the time is longer, an extended screen saver is used.  On these we often see text or status bar showing the download status of the application. <br><br>  Now let's see how this works in UWP.  The main difference lies in the features of the platform.  Since it is universal, the concept of ‚Äúwindow‚Äù is not a priority here, and the concept of ‚Äúscreen‚Äù comes to the fore.  The container in which the screen is displayed depends on the device and the window is only on the PC. <br><br>  The first thing that a user sees when launching your application is a splash screen consisting of a PNG image and a background fill.  If you have just created your application and have not changed anything, the splash screen will be painted in the main color of the system, and in the center there will be a basic ‚Äústub‚Äù picture, which is automatically created along with the application.  Standardly this picture is located in the Assets folder and is called SplashScreen.png.  Also in the file name there may be something like ‚Äúscale-200‚Äù.  This is part of the scaling system, which I will talk about separately in one of the articles in the series, and now I‚Äôll touch only on general features. <br><br><img width="400" src="https://habrastorage.org/webt/zk/qv/du/zkqvdumwimotfvzgdsepee2cehm.png"><br><br>  Since your application can run on a variety of devices, you have the opportunity to create several variants of images with different sizes, so that at different screen resolutions it does not lose in quality from stretching or compressing.  The standard name of any image in the project consists of two parts - the name and extension.  Such an image will be perceived as an image with a scale of 100%.  If you add ‚Äú.scale-xxx‚Äù between the name and the extension, where xxx is the scaling factor, it will be considered as the default for screens with such a scale, and stretched or shrunk for others (if there are no versions for them with their scale).  For example, for a scale of 200%, the name of the splash screen image would be ‚ÄúSplashScreen.scale-200.png‚Äù.  Hereinafter, I will only consider images at a scale of 100%, so as not to duplicate the topic planned for future articles. <br><br>  Now directly about the size of the image.  All basic visual resources of the application have fixed sizes for each of the scales.  The image on the screen saver in a standard scale should have a size of 620x300 pixels.  If you try to use a different size, you will receive an error warning, however, looking at the screenshot above, you can see a square image of a clearly different size.  In fact, it also has a size of 620x300 pixels, only a large part of it is transparent, which is not only forbidden to do, but is even recommended in many scenarios. <br><br>  As the background fill of the splash screen, the system default color or specified by you in the application manifest is used. <br><br><img src="https://habrastorage.org/webt/x-/ix/qb/x-ixqblkqnrg3kl8mrk1gzuqj3q.png"><br><br>  Setting the color for the background, as well as choosing your own image, is done in the manifest editor window on the "Visual Resources" tab in the "Screen Saver" subsection.  As mentioned in the previous article, you can open the manifest editor by double-clicking on the <b>Package.appxmanifest</b> file in the object browser.  This editor develops along with the UWP platform and in the latest versions of VS a tool appeared that allows you to quickly form one image, all the necessary variations of it at different scales, but I‚Äôll talk about this tool separately in another article, and here I‚Äôll consider only the manual setting of parameters . <br><br>  In the first field ‚ÄúScreen saver background‚Äù you need to specify the background color in <a href="https://ru.wikipedia.org/wiki/%25D0%25A6%25D0%25B2%25D0%25B5%25D1%2582%25D0%25B0_HTML">HTML</a> (HEX) format.  You can get the color value in a suitable format in almost any image editor (including Paint 3D) or online, but do not forget about the rules for recording this color, according to which the beginning of the alphanumeric value should be a ‚Äú#‚Äù.  For example, my screen saver uses the value "# fae57a" as a background. <br><br><img width="300" src="https://habrastorage.org/webt/uc/3a/re/uc3arencf9m2rbetwd0b9xs7_ec.png"><br><br>  The second ‚ÄúSplash Screen‚Äù field prompts you to specify the storage folder and the base name for the image file.  The ‚ÄúAssets‚Äù folder is not a mandatory location for storing images, as is the name ‚ÄúSplashScreen‚Äù, but the need to change them may arise unless you transfer old projects.  In other cases, it is much easier to use the base values, so in my project I leave the name and path unchanged.  Also note that when specifying the base name, you do not need to add an indication of the scale.  Such a prefix in the name appears automatically when selected in the boxes below. <br><br>  Actually, the windows below contain a preview of the installed images and the buttons for their selection for each scale.  Also next to the windows there is a hint on what size the image should have for a specific scale.  As you might have guessed, you can select an image of the appropriate size anywhere with any name, and it will be placed in the specified folder with the specified name and adding scale data. <br>  After selecting the background color and image, you can launch the application and watch the result of the changes made. <br><br><img src="https://habrastorage.org/webt/tp/mi/z1/tpmiz1kmc7txjmhtarixjt05_7o.png"><br><br>  So, the standard splash screen is ready and it's time to move on to creating an enhanced version.  As I mentioned above, in more complex programs, instead of the standard screensaver image, a screensaver with a download status is displayed.  The expanded screen saver UWP performs the same function, but it makes sense to use it only if there are lengthy tasks at the start.  In my application to such tasks include: loading saves, initial miscalculation of changes, accessing the database on the network and checking purchases.  On different devices, all these tasks will take different times and it would be nice if, on weaker devices, at that moment the user understood that the application was not stuck. <br><br>  Despite the title ‚ÄúExtended splash screen‚Äù, which is fixed in the documentation, in fact we will deal with a self-created page that will simulate a splash screen with additions of load indicators and in any case will be preceded by the display of a standard screen, which we have disassembled above .  As a result, the expanded screensaver should for the most part repeat the standard one and appear as smoothly as possible after the standard one. <br><br>  From the point of view of design, this stage is very important and, depending on the flight of your imagination, you can create a very interesting and attractive screensaver that will greatly affect the perception of your application, so do not underestimate this step and limit yourself to trivial loading indicators like ProgressRing. <br><br>  A little thought, I decided to implement the indication of loading by rotating the blades in the mill and adding a text line that displays the current loading status.  Thus, as planned, the standard screen will imperceptibly turn into an expanded one, the blades will begin to rotate, and the text will appear below.  However, taking the first steps in this matter, I came to the conclusion that the available materials do not cover the issue completely, and some are not used by the most successful ‚Äúcrutches‚Äù. <br><br>  Below, I'll tell you my own recipe for creating a splash screen based on online articles and official guidelines, but still different from them. <br><br><h4>  Step 1. Create a blank page </h4><br>  As I mentioned above, the extended splash screen is a regular application page, which we will make as close as possible to the basic splash screen.  To add a new page to the project, go to the ‚ÄúProject&gt; Add New Element‚Äù menu and select the ‚ÄúEmpty Page‚Äù element in the dialog box that appears.  In the official documentation, it is recommended to use ‚ÄúExtendedSplash‚Äù as the name of this page and, although we are free to choose any other name, we have no objective reasons for this.  Specify the proposed name and click "Add." <br><br>  The newly created page consists of two files: one for the <b>ExtendedSplash.xaml</b> markup and the second for the <b>ExtendedSplash.xaml.cs / vb</b> code.  We will return to them a little later, but for now the next step. <br><br><h4>  Step 2. Assignment of the ExtendedSplash as a start </h4><br>  In the official manual, this step is performed at the end, but I prefer to carry it out in advance.  The fact is that it is not enough for us to simply add a country and, in order for it to appear immediately behind the system splash screen, you need to perform some manipulations in the file <b>App.xaml.cs / vb</b> . <br><br>  As you remember from the previous article, this is the main application file that is responsible for its life cycle.  In particular, it has an OnLaunched procedure, which runs immediately when the application is started and in which the start page is set. <br><br>  Here is the code of this procedure immediately after creating a new project (VB.NET): <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-function">Protected Overrides Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnLaunched</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e As Windows.ApplicationModel.Activation.LaunchActivatedEventArgs</span></span></span><span class="hljs-function">) Dim rootFrame As Frame</span></span> = TryCast(Window.Current.Content, Frame) If rootFrame Is Nothing Then rootFrame = <span class="hljs-function"><span class="hljs-function">New </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Frame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) AddHandler rootFrame.NavigationFailed, AddressOf OnNavigationFailed If e.PreviousExecutionState</span></span> = ApplicationExecutionState.Terminated Then End If Window.Current.Content = rootFrame End If If e.PrelaunchActivated = False Then If rootFrame.Content Is Nothing Then rootFrame.Navigate(GetType(MainPage), e.Arguments) End If Window.Current.Activate() End If End Sub</code> </pre> <br>  <i>To shorten the code, commenting is removed from it.</i> <br><br>  To fully understand what is happening in this procedure, a more extensive deepening of the life cycle and application navigation will be needed, but we'll talk about this in one of the following articles.  For now, all you need to understand from this code is that you first create a Frame object, which is set as the content (visual root) of the application, and then this Frame navigates to the MainPage page of the application. <br><br>  And here it would be logical to assume that instead of MainPage, you need to set ExtendedSplash and we will get the desired page as the start page, but this option does not suit us, since in this case the ExtendedSplash page will be saved in the navigation history and you can return to it, we don't need that.  To solve this problem, instead of navigating, we set the application‚Äôs content not as Frame, but as ExtendedSplash itself, which, although it is an Page object, can also be the visual root of the application. <br><br>  Fix the code as follows: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">Protected Overrides Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnLaunched</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e As Windows.ApplicationModel.Activation.LaunchActivatedEventArgs</span></span></span><span class="hljs-function">) Dim rootFrame As Frame</span></span> = TryCast(Window.Current.Content, Frame) If rootFrame Is Nothing Then rootFrame = <span class="hljs-function"><span class="hljs-function">New </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Frame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) AddHandler rootFrame.NavigationFailed, AddressOf OnNavigationFailed </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">If</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e.PreviousExecutionState &lt;&gt; ApplicationExecutionState.Running</span></span></span><span class="hljs-function">) Then Window.Current.Content</span></span> = <span class="hljs-function"><span class="hljs-function">New </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExtendedSplash</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e.SplashScreen</span></span></span><span class="hljs-function">) End If End If If e.PrelaunchActivated</span></span> = False Then If rootFrame.Content Is Nothing Then rootFrame.Navigate(GetType(MainPage), e.Arguments) End If Window.Current.Activate() End If End Sub</code> </pre> <br>  As you have noticed, the code has undergone changes in the first condition.  At the bottom of this block, a check is made to see if the application is running and, if it is not running, a new object of the ExtendedSplash page is assigned as the application content. <br><br>  Also, as a parameter when declaring a new class ExtendedSplash, the SplashScreen class is given.  This class is an important part of creating an advanced splash screen, as it contains data about the size and position of the image on the basic splash screen, which will help us to seamlessly replace the basic screen with our own.  Well, so that this class contains the necessary data, we take it from the arguments obtained by the OnLaunched procedure from the system. <br><br>  Stayed the final touch.  In the file of the ExtendedSplash.xaml.cs / vb code, you need to add the New constructor, which will accept an object of the SplashScreen type: <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-function">Public Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">New</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">splashscreen As SplashScreen</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitializeComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) End Sub</span></span></code> </pre> <br>  Now when you start the application, we will see the ExtendedSplash page, not the MainPage page, which will allow us to immediately see the changes made to the page markup and more conveniently debug the code. <br><br><h4>  Step 3: Page Layout </h4><br>  The first and simplest change in the layout of the ExtendedSplash page is to set the background color of the page to the same as that of the basic splash screen.  The newly created page already contains the root Grid element with the Background property.  By default, this property is set to a system resource, but we will replace it with a color that was previously indicated in the application manifest.  In principle, the color value can be indicated on the direct Background = "# fae57a", but I store the primary colors of the application in a special file <b>ApplicationStyle.xaml</b> , which I mentioned at the end of the previous article.  I call the resource for the background as ‚ÄúBackgroundBrush‚Äù, and then refer to it in the right places. <br><br>  In the style resource file: <br><br><pre> <code class="cs hljs">&lt;SolidColorBrush x:Key=<span class="hljs-string"><span class="hljs-string">"BackgroundBrush"</span></span> Color=<span class="hljs-string"><span class="hljs-string">"#fae57a"</span></span>/&gt;   ExtendedSplash.xaml: &lt;Grid Background=<span class="hljs-string"><span class="hljs-string">"{StaticResource BackgroundBrush}"</span></span>‚Ä¶</code> </pre> <br>  And finally, we got to the place where the main differences between my method and that described in the official manual and other articles begin. <br><br>  If you have already studied the article from the official documentation, then you noticed that we use the Canvas element to position the image on the page.  It is necessary so that we can set the image not only the size, but also the position, but in practice everything is not as perfect as expected. <br><br>  The authors of the manual proceed from the fact that the image of the screen saver can be scaled differently in different situations.  The reason may be as the scaling factor on different devices, and the size of the window on the PC.  The behavior of the base image in all these situations is regulated by the system, and, so that we can imitate this behavior, we are given the above-mentioned SplashScreen class, the only property of which is ImageLocation of the Rect type.  This property contains information about the size (width, height) and position of the image (X, Y), so it is quite logical that for manipulating the image on the basis of the available data, we can use the Canvas element, which works with objects precisely on the basis of such parameters. <br><br>  And in fact, if you implement an advanced screen saver as it is recommended, then everything will work, but, only on a PC.  If you run the application on the phone, then completely unpredictable metamorphosis begins to occur.  Your image will either not display or will not display correctly.  When the screen is rotated in a horizontal position, the image runs off to the edge of the screen, partially cutting off and only when returning to the vertical position, it will take the right place. <br><br>  Judging by the mass of discussions in the network, as well as on the articles with recommended corrections, it can be concluded that I am not the only one who has encountered a similar problem.  The most popular solution that I found recommends using different markup for different devices.  Canvas for PC and Grid for mobile.  Fully repeating this decision, I got a workable splash screen coupled with a persistent feeling that I was using unnecessary crutches. <br><br>  In the end, I decided to independently understand what exactly is happening on the basic screen and how much I need to imitate it.  As a result of a series of experiments on different devices and emulators, I realized that you can completely reject information about the position of the image.  Regardless of the window size, device type or orientation, the image on the basic splash screen is always displayed in the center of the screen.  Thus, we can only extract information about the size of the image, and we can easily repeat the basic screen. <br><br>  My window layout at the first stage looks like this: <br><br><pre> <code class="cs hljs">&lt;Grid Background=<span class="hljs-string"><span class="hljs-string">"{StaticResource BackgroundBrush}"</span></span>&gt; &lt;Image x:Name=<span class="hljs-string"><span class="hljs-string">"SplashScreenImage3"</span></span> Source=<span class="hljs-string"><span class="hljs-string">"Assets/SplashScreens/SplashScreen3.png"</span></span> Canvas.ZIndex=<span class="hljs-string"><span class="hljs-string">"3"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span>/&gt; &lt;Image x:Name=<span class="hljs-string"><span class="hljs-string">"SplashScreenImage2"</span></span> Source=<span class="hljs-string"><span class="hljs-string">"Assets/SplashScreens/SplashScreen2.png"</span></span> Canvas.ZIndex=<span class="hljs-string"><span class="hljs-string">"2"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span>/&gt; &lt;Image x:Name=<span class="hljs-string"><span class="hljs-string">"SplashScreenImage1"</span></span> Source=<span class="hljs-string"><span class="hljs-string">"Assets/SplashScreens/SplashScreen1.png"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span>/&gt; &lt;TextBlock x:Name=<span class="hljs-string"><span class="hljs-string">"LoadingSatatusTextBox"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Bottom"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"0,0,0,20"</span></span> TextAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> Foreground=<span class="hljs-string"><span class="hljs-string">"{StaticResource ForegroundBrush}"</span></span> FontWeight=<span class="hljs-string"><span class="hljs-string">"Bold"</span></span>/&gt; &lt;/Grid&gt;</code> </pre> <br>  Before starting to analyze it, I want to turn to novice developers.  If this is your first encounter with the XAML markup language, I highly recommend that you work as little as possible in a window designer (also called ‚ÄúDesigner‚Äù).  Despite his improvement with each new version of Visual Studio, it still remains not an exact tool.  For example, when dragging an Image control onto a page, you might think that you aligned it in the center, but in fact, positioning can be set based on indents, rather than based on vertical and horizontal position properties.  In our markup, it is extremely important to exclude any indents and other factors affecting the position of images, except for two properties: HorizontalAlignment and VerticalAlignment. <br><br>  But back to the markup.  In order for it to work without errors, you need to add image files to the project, which are used as sources in the Image elements.  I put them in the ‚ÄúSplashScreens‚Äù subfolder of the ‚ÄúAssets‚Äù folder.  To add images to the project, right-click on the desired folder and select the menu item: ‚ÄúAdd&gt; Existing item ...‚Äù.  Three images as I need to separate the static elements from moving. <br><br><img src="https://habrastorage.org/webt/8g/dw/2p/8gdw2pzmsjghxy9szllebw1dcbw.png"><br><br>  It is important to note that the first and third images are the same size as the base 620x300 pixels (for a standard scale), while the third image contains the icon in the same place where it is located on the whole image, and the rest of it is transparent.  This is done in order to minimize labor costs for positioning them relative to each other.  The image of the blades is cropped to the edge and has no excess areas. <br><br>  All three images are placed strictly in the center of the page.  In our case, the center of the Grid element, but since it is the root element of the page and has no indentation, its center is equal to the center of the page.  Next, we need to set the correct order of overlay images on each other, so that the situation in which the blades will be behind the mill does not work out.  For this, the Canvas.ZIndex property is used, and it does not matter at all what order the Image elements are in the markup, and only the value of this property is important.  The higher the value, the element will be higher in the overlay (Z-axis). <br><br>  The last element in the markup is a text block that will display the status of the download.  It is located centrally relative to the horizontal plane and lower relative to the vertical.  Also indicated is a small indent from the bottom, so that the text does not ‚Äústick‚Äù to the edge of the screen.  Two more properties indicate the text color and style of the outline. <br><br>  The resource for the text color is set as follows: <br><br><pre> <code class="cs hljs">&lt;SolidColorBrush x:Key=<span class="hljs-string"><span class="hljs-string">"ForegroundBrush"</span></span> Color=<span class="hljs-string"><span class="hljs-string">"#c89103"</span></span>/&gt;</code> </pre> <br>  At this point, the first stage of work with markup can be considered complete, however, we will return to it when we add animation of rotation for the blades. <br><br><h4>  Step 4. Page code </h4><br>  The most important part of the work will be carried out in the code of the page, which is in the file <b>ExtendedSplash.xaml.cs / vb</b> . <br><br>  The first step is to import the Windows.UI.Core namespace and add the variables that we need later in the code: <br><br><pre> <code class="cs hljs">Imports Windows.UI.<span class="hljs-function"><span class="hljs-function">Core Public NotInheritable Class ExtendedSplash Inherits Page Friend splashImageRect As Rect Private splash As SplashScreen Friend ScaleFactor As Double Public Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">New</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">splashscreen As SplashScreen</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitializeComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) End Sub End Class       : Public Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">New</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">splashscreen As SplashScreen</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitializeComponent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) AddHandler Window.Current.SizeChanged, AddressOf ExtendedSplash_OnResize splash</span></span> = splashscreen If splash IsNot Nothing Then AddHandler splash.Dismissed, AddressOf DismissedEventHandler ScaleFactor = DisplayInformation.GetForCurrentView().RawPixelsPerViewPixel splashImageRect = splash.<span class="hljs-function"><span class="hljs-function">ImageLocation </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetSizeImage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) End If End Sub</span></span></code> </pre> <br>  The code begins with a subscription to the root container resizing event.  This will be needed to make changes to the image size when the window size or device orientation changes.  Next, the SplashScreen class passed in the argument is transferred to the local variable, which we will contact to obtain information about the required image size. <br><br>  After checking the local variable splash, which should not be empty, proceed to further manipulations.  You can now subscribe to the Dismissed event, which occurs when the system splash screen closes.  This point is important for understanding the general principle of the splash screen.  In fact, while the code is being executed inside the New procedure, the page is still initializing and it is not ready to be displayed, therefore the basic splash screen ‚Äúsecures‚Äù the application showing that it is running and the necessary page will now appear.  In many ways, this is precisely why an expanded splash screen is needed so that lengthy initialization processes are accompanied by live visualization, and not a static patch. <br><br>  The next line of code saves the current scaling factor for the correct interpretation of the dimensions, and the dimensions themselves are further code stored in the splashImageRect variable.  And at the end of the last line calls the procedure, where we operate with all the data obtained. <br><br>  Of course, after adding this code, we will receive three error messages, since we have no procedures to which the above events are attached, and there is no SetSizeImage procedure. <br><br>  Add them: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">Private Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetSizeImage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) End Sub Private Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DismissedEventHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sender As SplashScreen, args As Object</span></span></span><span class="hljs-function">) End Sub Private Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExtendedSplash_OnResize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sender As Object, e As WindowSizeChangedEventArgs</span></span></span><span class="hljs-function">) End Sub           SetSizeImage: Private Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetSizeImage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) SplashScreenImage1.Height</span></span> = splashImageRect.Height / ScaleFactor SplashScreenImage1.Width = splashImageRect.Width / ScaleFactor SplashScreenImage2.Width = splashImageRect.Width / ScaleFactor * <span class="hljs-number"><span class="hljs-number">0.3073</span></span> SplashScreenImage2.Margin = <span class="hljs-function"><span class="hljs-function">New </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Thickness</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">-splashImageRect.Width / ScaleFactor * </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.547</span></span></span></span><span class="hljs-function"><span class="hljs-params">, -splashImageRect.Width / ScaleFactor * </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.1633</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">) SplashScreenImage3.Height</span></span> = splashImageRect.Height / ScaleFactor SplashScreenImage3.Width = splashImageRect.Width / ScaleFactor ScaleFactor = <span class="hljs-number"><span class="hljs-number">1</span></span> End Sub</code> </pre> <br>  This code in turn sets the size for each image placed on the page.  In the case of the first and third images, it is enough for us to set the width and height of the image to be equal to what we have withdrawn from the SplashScreen class, adjusted for the scaling factor.  Please note that the last line of the ScaleFactor variable is assigned one, and when you call this procedure again, the correction for the scaling factor will not actually occur.  This is due to the same problem for which the solution from the official manual does not work on mobiles.  For some reason, the SplashScreen class, when first launched, reports the size of the image, taking into account the scaling factor, and with further manipulations, such as turning the device, without it.  That is why during initialization this coefficient is saved for the first manipulation and is reset to one for further. <br><br>  It is absolutely possible that in one of the further builds of Windows 10 this oddity will be eliminated, and we will need to change this code, but for now it works fine on all the released builds up to Fall Creators Update. <br><br>  Separate consideration is worth setting the size for the second image.  More precisely, in the case of him, we do not limit ourselves only to setting the size, but we also set the position, because initially the blades are in the middle, and not in the area of ‚Äã‚Äãthe mill. <br><br>  By the way, it‚Äôs enough to set the size only for one of the sides, for example, for the width, since the image is square and will proportionally change the height to the same size.  When setting a size other than an amendment to the scaling factor, we also adjust the size based on the main image.  More precisely, we take as the basis the width of the image and calculate what proportion of this size the blades occupy.  In my case, this is 0.3073. <br><br>  Further, based on the same logic, we calculate the distance from the center to the desired point, taking the width of the entire image as a basis.  The next line sets the indentation left and up to the calculated distance. <br><br>  We start the application and see that at this stage, the result is not visually different from the basic splash screen.  Now we run the application on the mobile and see a slight shift of our image relative to the base one.  It is caused by the fact that the base screen is positioning itself in the middle of the screen completely ignoring such interface elements as the status bar at the top of the phone or the lower virtual button panel, which is present on some models.  Let's make the required changes to the code. <br><br>  First, prepare a variable to store the height of the status bar: <br><br><pre> <code class="cs hljs">Friend statusBarRect As Rect        : If Metadata.ApiInformation.IsTypePresent(<span class="hljs-string"><span class="hljs-string">"Windows.UI.ViewManagement.StatusBar"</span></span>) Then statusBarRect = StatusBar.GetForCurrentView.OccludedRect End If</code> </pre> <br>  This code is interesting at once with two points.  First, here we first come across the adaptive code that I mentioned in the previous article.  The essence of the condition is that we check the availability of the required class on the end device and, if it exists, the code inside the condition will be executed without errors. <br><br>  Despite the adaptive code, accessing the StatusBar will not lead to success, and we will receive a message about the absence of such a class.  This is due to the fact that UWP applications initially have only common code that is able to run on all supported devices without any manipulations.  Links to platform-specific classes are added separately.  The status bar is inherent only to mobile devices, so first you need to add a link to the desired class library.  Go to the menu "Project&gt; Add link ...".  We find on the left the ‚ÄúUniversal Windows‚Äù section and the ‚ÄúExtensions‚Äù subsection.  In the list of libraries we find the library "Windows Mobile Extensions for the UWP" and select the version equal to the minimum version of our application. <br><br>  Now the code above works without errors.  More precisely, it will work only on the mobile, and on all other devices will be ignored. <br><br>  Finally, we will correct the code for positioning and setting image sizes: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">Private Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetSizeImage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) SplashScreenImage1.Height</span></span> = splashImageRect.Height / ScaleFactor SplashScreenImage1.Width = splashImageRect.Width / ScaleFactor SplashScreenImage1.Margin = <span class="hljs-function"><span class="hljs-function">New </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Thickness</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, -statusBarRect.Height, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">) SplashScreenImage2.Width</span></span> = splashImageRect.Width / ScaleFactor * <span class="hljs-number"><span class="hljs-number">0.3073</span></span> SplashScreenImage2.Margin = <span class="hljs-function"><span class="hljs-function">New </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Thickness</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">-splashImageRect.Width / ScaleFactor * </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.547</span></span></span></span><span class="hljs-function"><span class="hljs-params">, -splashImageRect.Width / ScaleFactor * </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.1633</span></span></span></span><span class="hljs-function"><span class="hljs-params"> - statusBarRect.Height, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">) SplashScreenImage3.Height</span></span> = splashImageRect.Height / ScaleFactor SplashScreenImage3.Width = splashImageRect.Width / ScaleFactor SplashScreenImage3.Margin = <span class="hljs-function"><span class="hljs-function">New </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Thickness</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, -statusBarRect.Height, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">) ScaleFactor</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span> End Sub</code> </pre> <br>  The added code shifts each image up by a size equal to the height of the status bar and now when you run the application on any device, our image is in the same place as the base one.  Unfortunately, this decision is still not complete.  Some phone models do not have hardware buttons, and instead the phone control buttons are located on the virtual panel of the phone itself, which leads to the same effect of displacement and, as I did not search, I could not find information on where to get the height of this panel, and, in general, to receive information about its presence or absence, in order to make the necessary changes.  If you have this information, be sure to share it in the comments. <br><br>  Now that all the necessary adjustments have been made, it remains to add a response to changes in the window size or orientation of the device: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">Private Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ExtendedSplash_OnResize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sender As Object, e As WindowSizeChangedEventArgs</span></span></span><span class="hljs-function">) If splash IsNot Nothing Then splashImageRect</span></span> = splash.<span class="hljs-function"><span class="hljs-function">ImageLocation </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetSizeImage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) End If End Sub</span></span></code> </pre> <br>  It's all very simple.     ,   SplashScreen  ,  ,       ,      SetSizeImage. <br><br>      .     ,      .     ,    -   ,      DismissedEventHandler.      ,        .    : <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">Private Async Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DismissedEventHandler</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sender As SplashScreen, args As Object</span></span></span><span class="hljs-function">) Await Dispatcher.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RunAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">CoreDispatcherPriority.Normal, New DispatchedHandler(AddressOf DismissExtendedSplash</span></span></span><span class="hljs-function">)) End Sub</span></span></code> </pre> <br>        DismissExtendedSplash             ,      . ,       Async  Await,     .      :   Await ,         ,          . Await      /    /,        Async. <br><br>  DismissExtendedSplash,       : <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-function">Private Async Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">DismissExtendedSplash</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) LoadingSatatusTextBox.Text</span></span> = <span class="hljs-string"><span class="hljs-string">" ..."</span></span> Await Task.Delay(<span class="hljs-function"><span class="hljs-function">New </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TimeSpan</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">15</span></span></span></span></span><span class="hljs-function">)) Dim rootFrame As New Frame rootFrame.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Navigate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">GetType(MainPage</span></span></span><span class="hljs-function">)) Window.Current.Content</span></span> = rootFrame End Sub</code> </pre> <br>      .        ,  ,        .        .       ,      15 .         ,    15 ,       . <br><br>       ,      Frame,             .         ,            . <br> :      ,          15    . <br><br><h4>  5.    </h4><br>     ,    ,           ¬´¬ª.        . <br><br>  XAML   : <br><br><pre> <code class="cs hljs">&lt;Grid Background=<span class="hljs-string"><span class="hljs-string">"{StaticResource BackgroundBrush}"</span></span>&gt; &lt;Grid.Resources&gt; &lt;Storyboard x:Name=<span class="hljs-string"><span class="hljs-string">"ImageRotateAnimation"</span></span>&gt; &lt;DoubleAnimation Storyboard.TargetName=<span class="hljs-string"><span class="hljs-string">"ImageRotate"</span></span> Storyboard.TargetProperty=<span class="hljs-string"><span class="hljs-string">"Angle"</span></span> To=<span class="hljs-string"><span class="hljs-string">"360"</span></span> BeginTime=<span class="hljs-string"><span class="hljs-string">"0:0:0.5"</span></span> Duration=<span class="hljs-string"><span class="hljs-string">"0:0:5"</span></span> RepeatBehavior=<span class="hljs-string"><span class="hljs-string">"Forever"</span></span>/&gt; &lt;/Storyboard&gt; &lt;/Grid.Resources&gt; &lt;Image x:Name=<span class="hljs-string"><span class="hljs-string">"SplashScreenImage3"</span></span> Source=<span class="hljs-string"><span class="hljs-string">"Assets/SplashScreens/SplashScreen3.png"</span></span> Canvas.ZIndex=<span class="hljs-string"><span class="hljs-string">"3"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span>/&gt; &lt;Image x:Name=<span class="hljs-string"><span class="hljs-string">"SplashScreenImage2"</span></span> Source=<span class="hljs-string"><span class="hljs-string">"Assets/SplashScreens/SplashScreen2.png"</span></span> Canvas.ZIndex=<span class="hljs-string"><span class="hljs-string">"2"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> RenderTransformOrigin=<span class="hljs-string"><span class="hljs-string">"0.5 0.5"</span></span>&gt; &lt;Image.RenderTransform&gt; &lt;RotateTransform x:Name=<span class="hljs-string"><span class="hljs-string">"ImageRotate"</span></span> Angle=<span class="hljs-string"><span class="hljs-string">"0"</span></span>/&gt; &lt;/Image.RenderTransform&gt; &lt;/Image&gt; &lt;Image x:Name=<span class="hljs-string"><span class="hljs-string">"SplashScreenImage1"</span></span> Source=<span class="hljs-string"><span class="hljs-string">"Assets/SplashScreens/SplashScreen1.png"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span>/&gt; &lt;TextBlock x:Name=<span class="hljs-string"><span class="hljs-string">"LoadingSatatusTextBox"</span></span> HorizontalAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> VerticalAlignment=<span class="hljs-string"><span class="hljs-string">"Bottom"</span></span> Margin=<span class="hljs-string"><span class="hljs-string">"0,0,0,20"</span></span> TextAlignment=<span class="hljs-string"><span class="hljs-string">"Center"</span></span> Foreground=<span class="hljs-string"><span class="hljs-string">"{StaticResource ForegroundBrush}"</span></span> FontWeight=<span class="hljs-string"><span class="hljs-string">"Bold"</span></span>/&gt; &lt;/Grid&gt;</code> </pre> <br>     . -,         0 .     ,              . <br><br> -,       Storyboard,     Double.           Double    .             .       ,        . <br><br>    ,       .       New    : <br><br> <code>ImageRotateAnimation.Begin</code> <br> <br> ,           ,           . <br><br><img src="https://habrastorage.org/webt/bm/eb/x6/bmebx6avvnywidaef1ynj4r5lzi.gif"><br><br>      <a href="https://1drv.ms/u/s!As_Jp5udagcOjog5hbTlYT-RUUyZoQ"> </a> . <br><br>             ,           ,        ,        . </div><p>Source: <a href="https://habr.com/ru/post/351972/">https://habr.com/ru/post/351972/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351960/index.html">3 years of ‚Äúright to oblivion‚Äù: Google has disclosed statistics on requests to ‚Äúdelete‚Äù information</a></li>
<li><a href="../351964/index.html">FastTrack Training. "Network Basics". "The value of Cisco products for security." Eddie Martin December 2012</a></li>
<li><a href="../351966/index.html">The digest of interesting materials for the mobile developer # 246 (March 19 - March 25)</a></li>
<li><a href="../351968/index.html">Check Point R80.20. What will be new?</a></li>
<li><a href="../351970/index.html">Simplifying code with if constexpr in C ++ 17</a></li>
<li><a href="../351974/index.html">Testing and continuous integration for Ansible roles with Molecule and Jenkins</a></li>
<li><a href="../351976/index.html">FastReport.Mono. Part 1: Run the Web demo report</a></li>
<li><a href="../351978/index.html">Unity posted the original C # code on Github</a></li>
<li><a href="../351980/index.html">FastReport.Mono. Part 2: Web Report in Docker Container</a></li>
<li><a href="../351982/index.html">Matthias Noback on Ideal Architecture - Layers, Ports, and Adapters (Part 2 - Layers)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>