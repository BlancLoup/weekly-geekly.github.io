<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Trojan in highscreen, or as the phone began to work wonders</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good afternoon, Habr! 
 I want to tell you a story that almost provoked my graying, still young, head. 
 Prehistory 
 It all started with the fact tha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Trojan in highscreen, or as the phone began to work wonders</h1><div class="post__text post__text-html js-mediator-article">  Good afternoon, Habr! <br>  I want to tell you a story that almost provoked my graying, still young, head. <br>  Prehistory <br>  It all started with the fact that I bought myself a Highscreen Omega Prime S a couple of months ago, I was happy as an elephant, I could not get enough of this wonderful device, which worked smartly and almost without complaints.  And everything would be great if I once did not see a bunch of notifications that looked something like this: <br><img src="https://habrastorage.org/files/e2a/fa9/f91/e2afa9f913fe4bdd90198708ef81a7a6.png"><br><br>  And I began to think - what is it, where did it come from, maybe my phone was broken, but how ?!  But after a few seconds, the panic subsided, I squeezed one of the notifications, chose the item ‚ÄúApplication Information‚Äù, and was very surprised to see that the notification was displayed by the Software Update application ... <br><a name="habracut"></a><br>  I was even more surprised that this application requires permissions to send SMS, determine location, install shortcuts and pairing with Bluetooth devices. <br><div class="spoiler">  <b class="spoiler_title">Full list of permissions</b> <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WRITE_EXTERNAL_STORAGE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_PHONE_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_LOGS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SEND_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.GET_TASKS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CHANGE_WIFI_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.android.vending.BILLING"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_WIFI_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BLUETOOTH"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.android.launcher.permission.INSTALL_SHORTCUT"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SYSTEM_ALERT_WINDOW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SYSTEM_OVERLAY_WINDOW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_FINE_LOCATION"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_COARSE_LOCATION"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.GET_ACCOUNTS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INSTALL_PACKAGES"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WAKE_LOCK"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.REBOOT"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre> <br></div></div><br>  While I was thinking about how to get rid of this application, I downloaded the utility for rutting and just thought about how this is possible at all - I got about 5 shortcircuits (or rather, I noticed their presence, they probably appeared along with the notifications): <br><img src="https://habrastorage.org/files/6d5/718/f7e/6d5718f7ea0840879a6f7392980d3c73.png"><br><br>  I immediately dragged the APK file from the phone, disassembled it into its parts using the utilities apktool, dex2jar and jd-gui - and proceeded to the study. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Study of </h5><br>  The study began with an analysis of AndroidManifest.xml, and the second thing that confused me about it was the presence of services and receivers inside the com.gmobi.trade package (despite the fact that the application itself is in com.redbend.dmClient). <br><div class="spoiler">  <b class="spoiler_title">The list of services and receivers</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.gmobi.trade.ActionActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:theme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@android:style/Theme.Translucent.NoTitleBar"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.DEFAULT"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.gmobi.trade.ActionService"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.gmobi.trade.ActionMonitor"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PACKAGE_ADDED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PACKAGE_REPLACED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PACKAGE_REMOVED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:scheme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"package"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.DEFAULT"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  And here you can see a very suspicious receiver - why should an application that updates the system track the addition / removal of applications?  As well as a quick scan of the code, it was discovered that ActionMonitor launches an ActionService, which in turn launches TradeService, which, in turn, launches something unknown and obfuscated.  Unfortunately, most of the code that jd-gui issued to me is not amenable to analysis sober. <br><br><h5>  SMS </h5><br>  Yes, and the code for sending SMS in this application is available: from somewhere comes the JSON, from which the AlertDialog is created, and in the handler for pressing the positive button the SMS is sent.  I am glad that at least this does not happen in the background.  But it is still unclear why the utility to update the software in general to send SMS messages somewhere. <br><div class="spoiler">  <b class="spoiler_title">SMS sending code</b> <div class="spoiler_text"><pre> <code class="java hljs">AlertDialog.Builder localBuilder2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AlertDialog.Builder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); localBuilder2.setTitle(str14); localBuilder2.setMessage(str15); localBuilder2.setPositiveButton(str16, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DialogInterface.OnClickListener(locallqe, str1, str19, str18, localNotificationManager, i) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DialogInterface paramDialogInterface, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> paramInt)</span></span></span><span class="hljs-function"> </span></span>{ bb(c, <span class="hljs-number"><span class="hljs-number">3</span></span>); SmsManager localSmsManager = SmsManager.getDefault(); dfe.a(<span class="hljs-string"><span class="hljs-string">"Sending ["</span></span> + d + <span class="hljs-string"><span class="hljs-string">"] to ["</span></span> + e + <span class="hljs-string"><span class="hljs-string">"]"</span></span>); localSmsManager.sendTextMessage(e, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, d, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); f.cancel(g); finish(); bb(c, <span class="hljs-number"><span class="hljs-number">5</span></span>); } }); localBuilder2.setNegativeButton(str17, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DialogInterface.OnClickListener(locallqe, str1) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DialogInterface paramDialogInterface, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> paramInt)</span></span></span><span class="hljs-function"> </span></span>{ bb(c, <span class="hljs-number"><span class="hljs-number">4</span></span>); finish(); } }); localBuilder2.setCancelable(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); localBuilder2.create().show();</code> </pre><br></div></div><br><br><h5>  Bluetooth, geocoordinates, etc. </h5><br>  It's all more or less safe.  Well, as ‚Äúsafe‚Äù ... the application just receives the bt-adapter's MAC address, receives geo-coordinates, checks whether Wi-Fi is turned on, receives the wifi-adapter's MAC address and sends this data into the unknown :) <br><div class="spoiler">  <b class="spoiler_title">Code to collect information</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> JSONObject </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ JSONObject localJSONObject1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSONObject(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"sdk"</span></span>, <span class="hljs-string"><span class="hljs-string">"go2sync"</span></span>); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"sdk_v"</span></span>, <span class="hljs-string"><span class="hljs-string">"1.2"</span></span>); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"sdk_b"</span></span>, <span class="hljs-string"><span class="hljs-string">"2014.03.06.1"</span></span>); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"app"</span></span>, a.getPackageName()); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"ch"</span></span>, t); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"app_v"</span></span>, opt.e(a)); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"imsi"</span></span>, qj); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"imei"</span></span>, qk); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"wifi"</span></span>, k); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"gprs"</span></span>, l); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"brand"</span></span>, g()); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"sd"</span></span>, opt.c()); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"id"</span></span>, c()); azw.lqe.azw localazw = opt.c(a); StringBuilder localStringBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"ua:"</span></span>) .append(opt.a(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)) .append(<span class="hljs-string"><span class="hljs-string">"|imei:"</span></span>) .append(localazw.a()) .append(<span class="hljs-string"><span class="hljs-string">"|imsi:"</span></span>) .append(localazw.b()) .append(<span class="hljs-string"><span class="hljs-string">"|wmac:"</span></span>) .append(opt.b(a)) .append(<span class="hljs-string"><span class="hljs-string">"|bmac:"</span></span>); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"cid"</span></span>, opt.a(opt.a() + <span class="hljs-string"><span class="hljs-string">"|sn:"</span></span> + opt.a(a))) localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"ua"</span></span>, opt.a(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"os"</span></span>, <span class="hljs-string"><span class="hljs-string">"android"</span></span>); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"os_v"</span></span>, opt.b()); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"lang"</span></span>, Locale.getDefault().getLanguage()) localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"country"</span></span>, opt.h(a)); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"gp"</span></span>, qn); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"wmac"</span></span>, opt.b(a)); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"bmac"</span></span>, opt.a()); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"sn"</span></span>, opt.a(a)); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"sa"</span></span>, opt.g(a)); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"sw"</span></span>, opt.j(a)); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"sh"</span></span>, opt.k(a)); Location localLocation = opt.f(a); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (localLocation != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { JSONObject localJSONObject2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSONObject(); localJSONObject2.put(<span class="hljs-string"><span class="hljs-string">"lng"</span></span>, localLocation.getLongitude()); localJSONObject2.put(<span class="hljs-string"><span class="hljs-string">"lat"</span></span>, localLocation.getLatitude()); localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"loc"</span></span>, localJSONObject2); } localJSONObject1.put(<span class="hljs-string"><span class="hljs-string">"roaming"</span></span>, opt.o(a)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> localJSONObject1; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JSONException localJSONException) { dfe.a(localJSONException); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> localJSONObject1; }</code> </pre><br></div></div><br><br><h5>  Results </h5><br>  The phone had to be ruined to remove this application.  How to update the system now is unknown. <br><br><h5>  PS </h5><br>  This application was a "junk box", it could not be removed or disabled.  And I don‚Äôt install applications from sources that I don‚Äôt trust, so the likelihood that it all happened through my fault tends to zero. <br>  All files are available for download <a href="https://drive.google.com/file/d/0B-FBrG1Sn1nheG1YcjRnclN6Um8/view">here</a> . <br><br>  UPD1: Virustotal - <a href="https://www.virustotal.com/ru/file/108299c363e361d85b8e34676806373c7e445ae6731b3f3400d77cf947550b6c/analysis/1412500174/">www.virustotal.com/ru/file/108299c363e361d85b8e34676806373c7e445ae6731b3f3400d77cf947550b6c/analysis/1412500174</a> <br><br>  UPD2: As it turned out, highscreen acknowledged the problem, citing the fact that this is a GMobi error.  Link: <a href="http://highscreen.org/babltrabl/">highscreen.org/babltrabl</a> <br>  But only there is one BUT: the highscreen referred to the FOTA-provider, but not a single update came to my device via OTA. <br>  Thanks to <a href="http://habrahabr.ru/users/peyt/" class="user_link">Peyt</a> for the info! </div><p>Source: <a href="https://habr.com/ru/post/239213/">https://habr.com/ru/post/239213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../239203/index.html">Freemium Pros and cons</a></li>
<li><a href="../239205/index.html">Cryptocurrencies go to the underground. The bill from the Ministry of Finance</a></li>
<li><a href="../239207/index.html">Using generics in Swift</a></li>
<li><a href="../239209/index.html">Cosmic catastrophes almost happened, part 2</a></li>
<li><a href="../239211/index.html">An easy way to restore the health of Li-Ion batteries from portable devices</a></li>
<li><a href="../239217/index.html">The digest of interesting materials for the mobile developer # 73 (September 29 - October 5)</a></li>
<li><a href="../239219/index.html">Interesting moments in C # (boxing unboxing)</a></li>
<li><a href="../239221/index.html">Debugging NDK and JNI for Android</a></li>
<li><a href="../239223/index.html">A few words about planning a recovery strategy</a></li>
<li><a href="../239225/index.html">P2P - The Next Stage of Information Systems Development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>