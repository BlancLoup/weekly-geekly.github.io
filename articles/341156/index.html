<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 43: The Great IoT Reap Is Coming, Like NATO Cyberconf Hackers Flying, Bad Exception Rabbit Ears ExPetr</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Repent, for coming! The streets were flooded with mad preachers with apocalyptic posters, an unusually huge bloody moon rises over the horizon at nigh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 43: The Great IoT Reap Is Coming, Like NATO Cyberconf Hackers Flying, Bad Exception Rabbit Ears ExPetr</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/kv/7u/ie/kv7uieidi7lx-jj9xtbntrxqgns.jpeg" width="400" align="right">  Repent, for coming!  The streets were flooded with mad preachers with apocalyptic posters, an unusually huge bloody moon rises over the horizon at night, and scholars who did not receive the Nobel Prize because of too radical ideas unsuccessfully try to reach the authorities with their shocking discoveries.  Something terrible is brewing.  It is already close.  Well or not. <br><br>  Perhaps this time we were lucky, and we <a href="https://threatpost.com/hackers-prepping-iotroop-botnet-with-exploits/128608/">received a warning</a> in time about the upcoming uprising of the ‚ÄúInternet of things‚Äù.  NewSky Security found in the darknet a forum thread in which ‚Äúblack hats‚Äù relaxedly discussed the concept and implementation of the attack through CVE-2017-8225, which allows merging credentials from Chinese cameras from many different vendors.  The two most active participants in the discussion eventually gave birth to two scripts. <br><a name="habracut"></a><br>  The first script searched for devices with CVE-2017-8225 in a very original way - using the service Shodan Premium.  The second script follows the list of IP addresses compiled by Shodan and extracts administrator logins and passwords from devices. <br><br>  Stop!  A botnet that infects IoT devices.  It sounds familiar - just recently, CheckPoint researchers <a href="https://threatpost.ru/iotroop-botnet-could-dwarf-mirai-in-size-and-devastation-says-researcher/22939/">warned</a> about a similar botnet.  According to their data, the monster called IoTroop at the time of October 19, 2017 has already infected <i>more than a million organizations</i> .  Not devices.  Organizations.  Unlike the pioneer Mirai, which was thrown onto the device, just going through the popular logins, passwords in the dictionary, IoTroop was not limited to this - it is distributed using vulnerabilities (mostly already known).  But the fact that the vulnerability is known does not mean that it is useless - according to the same CheckPoint, 60% of organizations use at least one IoT device with a known vulnerability, be it a security camera, router or network storage. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Where is the connection?  In the thread where the black hats talked, among other things, there was a discussion of the difficulties of getting a shell on the device under attack.  Hackers use a reverse shell method when a device translates an administrator session to a management and control server.  On the port that listens to the netcat installed there.  The same method was discovered by Checkpoint, during the study of IoTroop, which allows us to connect the participants in the discussion with the very million of infected offices. <br><br>  So far, IoTroop has been quietly spreading, not conducting an active malicious activity.  What the botovody wait for is unknown: it may be that they are building up strength, and maybe they are looking for a generous customer.  One thing is clear - when they turn to action, it will not seem to anyone much. <br><br>  <b>Sofacy attacks safe researchers</b> <br><br>  <a href="https://threatpost.com/latest-sofacy-campaign-targeting-security-researchers/128576/">News</a>  <a href="http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html">Research</a>  The Sofacy Group, also known as FancyBear, also known as APT28, was caught catching attacks on a very specific group of security people interested in the CyCon warfare conference organized by the Center for Coordinated Cyber ‚Äã‚ÄãDefense and the Application of NATO Best Practices. <br><br>  The bait file was a Microsoft Word document containing a dish from an announcement drawn from the CyCon site, seasoned with a cunning VBA script.  This time there are no exploits, the victim opens the file, and a script is launched that does not even think to surf the Internet.  Instead, he climbs into the document fields, such as 'Subject', 'Company', 'Category', 'Hyperlink base' and 'Comments', and extracts some meaningless jumble of characters from there. <br><br><img src="https://habrastorage.org/webt/_i/8i/nm/_i8inmurf5sanvkfaaopwmuclhq.png"><br><br>  In fact, this is not a jumble - this is a file encoded in base64 and divided into several parts.  The script collects and decodes the file, then writes it to disk as netwf.dat and launches it with the help of rundll32.exe.  So, this file is a slightly modified dropper Seduploader, the same one that was previously used in the attacks of Sofacy. <br><br>  The dropper, in turn, loads the load files from the management server, netwf.bat and netwf.dll, and the VBA script sets the attribute to them hidden.  Dropper starts the load, and that rooted in the system.  She knows how to more than enough: capture a picture from the display via the GDI API, extract and send data to the server, download and run files.  The motives for this attack are unknown, but the focus on military information security specialists shows that intruders were interested in, most likely, not money. <br><br>  <b>Of course, Petya!</b>  <b>Well, who does not know him ...</b> <br><br><img src="https://habrastorage.org/webt/7c/d0/_q/7cd0_qyznxw4gflnkjru1sze-s8.jpeg" width="300" align="right">  <a href="https://threatpost.com/bad-rabbit-linked-to-expetrnot-petya-attacks/128611/">News</a>  Still, the extortionist Bad Rabbit turned out to be a fellow ExPetr / Not Petya.  Our analysts have confirmed the connection between the two attacks.  First, both have similar hashing algorithms.  Secondly, both there and there used the same domains, and in the source codes a clear relationship was found. <br><br>  To spread rabbit, hackers hacked a number of popular sites around the world and downloaded a Trojan onto them.  Visitors received an offer to download the new version of FlashPlayer (is someone else caught by this?).  The victims themselves installed a cryptograph, and they even gave him all the necessary rights, without looking at the call from UAC. <br><br><img src="https://habrastorage.org/webt/ef/t6/_w/eft6_whmlc3u8gvesq6cmbfzvws.jpeg"><br>  <i>Sites Distributing Bad Rabbit</i> <br><br>  Just like ExPetr, Rabbit retrieved credentials from the machine‚Äôs memory and spread further across the local network using WMIC.  At the same time, the authors took into account the lesson learned in the ExPetr campaign - Bad Rabbit portrays the runner-up more convincingly, that is, the honor to honor data encrypts and sends the keys to the server, as if it really is going to decrypt something ... <br><br>  It is impossible not to notice that the authors of the campaign have become very careful.  As soon as the security companies launched an investigation, the hackers immediately removed the malicious code from all the hacked sites. <br><br><img src="https://habrastorage.org/files/1a3/d84/77c/1a3d8477c94641beaa19694292d10b54.png" align="right"><h3>  Antiquities </h3><br>  Family "PC-FLU" <br><br>  Dangerous resident viruses, standardly infect .COM files when they are launched or opened.  Write their TSR-copies at 9A00: xxxx without changing anything in MCB_blocks, which can cause the computer to hang.  Apparently, resident antivirus monitors are looking in memory and trying to bypass them.  Intercepted int21h <br><br>  <i>Quote from the book "Computer viruses in MS-DOS" Eugene Kaspersky.</i>  <i>1992</i>  <i>Page 42.</i> <br><br>  <i><strong>Disclaimer:</strong> This column reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/341156/">https://habr.com/ru/post/341156/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341144/index.html">What every C programmer should know about Undefined Behavior. Part 2/3</a></li>
<li><a href="../341146/index.html">$ mol - the best cure for hemorrhoids</a></li>
<li><a href="../341148/index.html">Fuzzy string comparison: understand me if you can</a></li>
<li><a href="../341152/index.html">Development of 2D sandboxes on JavaScript from scratch</a></li>
<li><a href="../341154/index.html">What every C programmer should know about Undefined Behavior. Part 3/3</a></li>
<li><a href="../341160/index.html">Remove radial distortion from photos and videos using the openCV library and the python language</a></li>
<li><a href="../341164/index.html">Your users do not need passwords.</a></li>
<li><a href="../341166/index.html">How to arrange an open source project</a></li>
<li><a href="../341168/index.html">Virtuozzo Storage: Actual Operating Experience, Optimization and Problem Solving Tips</a></li>
<li><a href="../341170/index.html">Cloning a 50Gb database from Prod to Dev in 1 second without loss of integrity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>