<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using Python and Excel to process and analyze data. Part 2: libraries for working with data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The first part of the article was published here . 

 How to read and edit Excel files with openpyxl 
 

 TRANSFER 
 Original article - www.datacamp.c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using Python and Excel to process and analyze data. Part 2: libraries for working with data</h1><div class="post__text post__text-html js-mediator-article">  The first part of the article was published <a href="https://habrahabr.ru/company/otus/blog/331746/">here</a> . <br><br>  <b>How to read and edit Excel files with openpyxl</b> <b><br></b> <br><br>  TRANSFER <br>  Original article - <a href="https://www.datacamp.com/community/tutorials/python-excel-tutorial">www.datacamp.com/community/tutorials/python-excel-tutorial</a> <br>  Author - Karlijn Willems 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This library is useful if you want to read and edit .xlsx, xlsm, xltx and xltm files. <br><br>  Install openpyxl using pip.  General recommendations for installing this library - do it in a virtual Python environment without system libraries.  You can use a virtual environment to create isolated Python environments: it creates a folder containing all the necessary files to use the libraries that are required for Python. <br><br>  Go to the directory where your project is located, and re-activate the virtual environment venv.  Then go to the installation of openpyxl using pip to make sure that you can read and write files with it: <br><a name="habracut"></a><br><pre><code class="hljs mel"># Activate virtualenv $ <span class="hljs-keyword"><span class="hljs-keyword">source</span></span> activate venv # Install <span class="hljs-string"><span class="hljs-string">`openpyxl`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">`venv`</span></span> $ pip install openpyxl</code> </pre> <br>  Now that you have installed openpyxl, you can start downloading data.  But what exactly is this data?  For example, in the data book you are trying to get in Python, there are the following sheets: <br><br><img src="https://habrastorage.org/web/db6/738/152/db6738152e3444c091b29ef030703bad.png"><br><br>  The load_workbook () function takes the file name as an argument and returns the workbook object that represents the file.  This can be checked by running type (wb).  Remember to make sure you are in the correct directory where the spreadsheet is located.  Otherwise, you will receive an error message when importing. <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Import</span></span> `load_workbook` module <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> `openpyxl` <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> openpyxl <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_workbook # <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the workbook wb = load_workbook(<span class="hljs-string"><span class="hljs-string">'./test.xlsx'</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> sheet names print(wb.get_sheet_names())</code> </pre> <br>  Remember, you can change the working directory with os.chdir ().  The code snippet above returns the sheet names of the book loaded in Python.  You can use this information to obtain individual sheets of a book.  You can also check which sheet is currently active using wb.active.  In the code below, you can also use it to load data on another sheet of the book: <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> a sheet <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> sheet = wb.get_sheet_by_name(<span class="hljs-string"><span class="hljs-string">'Sheet3'</span></span>) # Print the sheet title sheet.title # <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> currently active sheet anotherSheet = wb.active # <span class="hljs-keyword"><span class="hljs-keyword">Check</span></span> `anotherSheet` anotherSheet</code> </pre> <br>  At first glance, with these Worksheet objects, there is little that can be done.  However, you can extract values ‚Äã‚Äãfrom specific cells on a book sheet using square brackets [], to which you need to transfer the exact cell from which you want to get the value. <br><br>  Note that this is similar to selecting, retrieving, and indexing NumPy and Pandas DataFrames arrays, but this is not all that needs to be done to get the value.  It is necessary to add the attribute value: <br><br><pre> <code class="hljs pgsql"># Retrieve the <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a certain cell sheet[<span class="hljs-string"><span class="hljs-string">'A1'</span></span>].<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> element <span class="hljs-string"><span class="hljs-string">'B2'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> your sheet c = sheet[<span class="hljs-string"><span class="hljs-string">'B2'</span></span>] # Retrieve the <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> number <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> your element c.<span class="hljs-keyword"><span class="hljs-keyword">row</span></span> # Retrieve the <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> letter <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> your element c.<span class="hljs-keyword"><span class="hljs-keyword">column</span></span> # Retrieve the coordinates <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the cell c.coordinate</code> </pre> <br>  In addition to value, there are other attributes that can be used to check the cell, namely row, column, and coordinate: <br><br>  The row attribute returns 2; <br>  Adding the column attribute to ‚ÄúC‚Äù will give you ‚ÄúB‚Äù; <br>  coordinate will return "B2". <br><br>  You can also get cell values ‚Äã‚Äãusing the cell () function.  Pass the row and column arguments, add values ‚Äã‚Äãto these arguments that correspond to the cell values ‚Äã‚Äãyou want to get, and, of course, do not forget to add the value attribute: <br><br><pre> <code class="hljs pgsql"># Retrieve cell <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> sheet.cell(<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>, column=<span class="hljs-number"><span class="hljs-number">2</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> # Print <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">column</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): print(i, sheet.cell(<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>=i, column=<span class="hljs-number"><span class="hljs-number">2</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>)</code> </pre> <br>  Note that if you do not specify the value of the value attribute, you will get &lt;Cell Sheet3.B1&gt;, which says nothing about the value that is contained in this particular cell. <br><br>  You use a loop using the range () function to help you output the values ‚Äã‚Äãof the rows that have values ‚Äã‚Äãin column 2. If these specific cells are empty, you will get None. <br>  Moreover, there are special functions that you can call to get other values, for example get_column_letter () and column_index_from_string. <br><br>  In the two functions it is already more or less indicated what you can get by using them.  But it's best to make them explicit: as long as you can get the letter of the previous column, you can do the opposite or get the index of the column by sorting letter by letter.  How it works: <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Import</span></span> relevant modules <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> `openpyxl.utils` <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> openpyxl.utils <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> get_column_letter, column_index_from_string # <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> <span class="hljs-string"><span class="hljs-string">'A'</span></span> get_column_letter(<span class="hljs-number"><span class="hljs-number">1</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> <span class="hljs-string"><span class="hljs-string">'1'</span></span> column_index_from_string(<span class="hljs-string"><span class="hljs-string">'A'</span></span>)</code> </pre> <br>  You have already obtained values ‚Äã‚Äãfor rows that have values ‚Äã‚Äãin a specific column, but what should you do if you need to output the lines of a file without focusing on only one column? <br><br>  Of course, use another cycle. <br><br>  For example, you want to focus on the area between ‚ÄúA1‚Äù and ‚ÄúC3‚Äù, where the first indicates the upper left corner, and the second the lower right corner of the area you want to focus on.  This area will be the so-called cellObj, which you see in the first line of code below.  Then you specify that for each cell that is in this area, you want to output the coordinate and the value that is contained in this cell.  After the end of each line, you want to output a message signaling that the line of this cellObj region has been output. <br><br><pre> <code class="hljs pgsql"># Print <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> per <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cellObj <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sheet[<span class="hljs-string"><span class="hljs-string">'A1'</span></span>:<span class="hljs-string"><span class="hljs-string">'C3'</span></span>]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> cell <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cellObj: print(cells.coordinate, cells.<span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) print(<span class="hljs-string"><span class="hljs-string">'--- END ---'</span></span>)</code> </pre> <br>  Note that selecting a region is very similar to choosing, retrieving and indexing a list and the NumPy elements, where you also use square brackets and a colon to indicate the region from which you want to get values.  In addition, the above loop also makes good use of the attributes of the cell! <br><br>  To visualize the above, you may want to check the result, which will return the completed cycle to you: <br><br><pre> <code class="hljs python">(<span class="hljs-string"><span class="hljs-string">'A1'</span></span>, <span class="hljs-string"><span class="hljs-string">u'M'</span></span>) (<span class="hljs-string"><span class="hljs-string">'B1'</span></span>, <span class="hljs-string"><span class="hljs-string">u'N'</span></span>) (<span class="hljs-string"><span class="hljs-string">'C1'</span></span>, <span class="hljs-string"><span class="hljs-string">u'O'</span></span>) --- END --- (<span class="hljs-string"><span class="hljs-string">'A2'</span></span>, <span class="hljs-number"><span class="hljs-number">10L</span></span>) (<span class="hljs-string"><span class="hljs-string">'B2'</span></span>, <span class="hljs-number"><span class="hljs-number">11L</span></span>) (<span class="hljs-string"><span class="hljs-string">'C2'</span></span>, <span class="hljs-number"><span class="hljs-number">12L</span></span>) --- END --- (<span class="hljs-string"><span class="hljs-string">'A3'</span></span>, <span class="hljs-number"><span class="hljs-number">14L</span></span>) (<span class="hljs-string"><span class="hljs-string">'B3'</span></span>, <span class="hljs-number"><span class="hljs-number">15L</span></span>) (<span class="hljs-string"><span class="hljs-string">'C3'</span></span>, <span class="hljs-number"><span class="hljs-number">16L</span></span>) --- END ---</code> </pre> <br>  Finally, there are some attributes that you can use to verify the import result, namely max_row and max_column.  These attributes, of course, are common ways to ensure the data is loaded correctly, but nevertheless, in this case, they can and will be useful. <br><br><pre> <code class="hljs pgsql"># Retrieve the maximum amount <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> sheet.max_row # Retrieve the maximum amount <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> sheet.max_column</code> </pre> <br>  This is all very cool, but we can almost hear that you now think that this is an awfully difficult way to work with files, especially if you need to manage data as well. <br>  Should be something simpler, right?  It's like that! <br><br>  Openpyxl has support for Pandas DataFrames.  And you can use the Pandas DataFrame () function to put the sheet values ‚Äã‚Äãin the DataFrame: <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Import</span></span> `pandas` <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd # Convert Sheet <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> DataFrame df = pd.DataFrame(sheet.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span>)       ,      : # Put the sheet <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> `data` data = sheet.<span class="hljs-keyword"><span class="hljs-keyword">values</span></span> # Indicate the <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the sheet <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> cols = next(data)[<span class="hljs-number"><span class="hljs-number">1</span></span>:] # Convert your data <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> a list data = list(data) # <span class="hljs-keyword"><span class="hljs-keyword">Read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the data at <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the indices idx = [r[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data] # <span class="hljs-keyword"><span class="hljs-keyword">Slice</span></span> the data at <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> data = (islice(r, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data) # Make your DataFrame df = pd.DataFrame(data, <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>=idx, <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>=cols)</code> </pre> <br>  Then you can start managing the data with all the features that Pandas has.  But remember that you are in a virtual environment, so if the library is not already connected, you will need to install it again via pip. <br><br>  To write Pandas DataFrames back to an Excel file, you can use the dataframe_to_rows () function from the utils module: <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Import</span></span> `dataframe_to_rows` <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> openpyxl.utils.dataframe <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dataframe_to_rows # Initialize a workbook wb = Workbook() # <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> the worksheet <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the active workbook ws = wb.active # Append the <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the DataFrame <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> your worksheet <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> dataframe_to_rows(df, <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">header</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>): ws.append(r)</code> </pre> <br>  But this is definitely not all!  The openpyxl library offers you great flexibility in how you write your data to Excel files, change cell styles, or use write-only mode.  This makes it one of those libraries that you really need to know if you often work with spreadsheets. <br><br>  And don't forget to deactivate the virtual environment when you're done with the data! <br><br>  Now let's look at some other libraries that you can use to retrieve data in a Python spreadsheet. <br><br>  Ready to learn more? <br><br>  <b>Reading and formatting Excel xlrd files</b> <br>  This library is ideal if you want to read data and format data in files with the .xls or .xlsx extension. <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Import</span></span> `xlrd` <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> xlrd # <span class="hljs-keyword"><span class="hljs-keyword">Open</span></span> a workbook workbook = xlrd.open_workbook(<span class="hljs-string"><span class="hljs-string">'example.xls'</span></span>) # Loads <span class="hljs-keyword"><span class="hljs-keyword">only</span></span> <span class="hljs-keyword"><span class="hljs-keyword">current</span></span> sheets <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> memory workbook = xlrd.open_workbook(<span class="hljs-string"><span class="hljs-string">'example.xls'</span></span>, on_demand = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  If you do not want to review the entire book, you can use functions such as sheet_by_name () or sheet_by_index () to extract the sheets you want to use in the analysis. <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> a specific sheet <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span> worksheet = workbook.sheet_by_name(<span class="hljs-string"><span class="hljs-string">'Sheet1'</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Load</span></span> a specific sheet <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> worksheet = workbook.sheet_by_index(<span class="hljs-number"><span class="hljs-number">0</span></span>) # Retrieve the <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> cell at indices (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>) sheet.cell(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>).<span class="hljs-keyword"><span class="hljs-keyword">value</span></span></code> </pre> <br>  Finally, you can get the values ‚Äã‚Äãat specific coordinates indicated by indices. <br>  About how xlwt and xlutils relate to xlrd further. <br><br>  <b>Writing data to an Excel file using xlrd</b> <br><br>  If you need to create spreadsheets that contain data, in addition to the XlsxWriter library, you can use the xlwt libraries.  Xlwt is ideal for writing and formatting data in files with the .xls extension. <br><br>  When you manually want to write to a file, it will look like this: <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Import</span></span> `xlwt` <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> xlwt # Initialize a workbook book = xlwt.Workbook(encoding="utf-8") # <span class="hljs-keyword"><span class="hljs-keyword">Add</span></span> a sheet <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the workbook sheet1 = book.add_sheet("Python Sheet 1") # <span class="hljs-keyword"><span class="hljs-keyword">Write</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the sheet <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> the workbook sheet1.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, "This is the First Cell of the First Sheet") # Save the workbook book.save("spreadsheet.xls")</code> </pre> <br>  If you need to write data to a file, you can resort to a for loop to minimize manual labor.  This will automate the process a bit.  We make a script in which the book is created, in which the sheet is added.  Next, specify a list with columns and with values ‚Äã‚Äãthat will be transferred to the worksheet. <br><br>  The for loop will ensure that all values ‚Äã‚Äãfall into the file: we specify that we are going to take actions with each element in the range from 0 to 4 (5 is not included).  We will fill in the values ‚Äã‚Äãline by line.  To do this, specify the row element, which will ‚Äújump‚Äù in each cycle.  And then we have the next for loop, which will go through the columns of the sheet.  We set the condition that for each row on the sheet we look at the column and fill in the value for each column in the row.  When we have filled all the columns of the row with values, we proceed to the next line until we have filled all the rows. <br><br><pre> <code class="hljs pgsql"># Initialize a workbook book = xlwt.Workbook() # <span class="hljs-keyword"><span class="hljs-keyword">Add</span></span> a sheet <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> the workbook sheet1 = book.add_sheet("Sheet1") # The data cols = ["A", "B", "C", "D", "E"] txt = [<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>] # <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">over</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">rows</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> fill <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> num <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">5</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> = sheet1.<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>(num) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>, col <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(cols): <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> = txt[<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>] + num <span class="hljs-keyword"><span class="hljs-keyword">row</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>) # Save the result book.save("test.xls")</code> </pre> <br>  As an example, a screenshot of the resulting file: <br><br><img src="https://habrastorage.org/web/902/afb/461/902afb461a1240d38455b643c403b5c0.png"><br><br>  Now that you have seen how xlrd and xlwt interact together, it's time to look at a library that is closely related to these two: xlutils. <br><br>  <b>Xlutils utility collection</b> <br><br>  This library is basically a collection of utilities for which both xlrd and xlwt are required.  Includes the ability to copy and modify / filter existing files.  Generally speaking, both of these cases now fall under openpyxl. <br><br>  <b>Use pyexcel to read .xls or .xlsx files</b> <br><br>  Another library that can be used to read table data in Python is pyexcel.  This is a Python Wrapper, which provides one API for reading, processing and writing data in .csv, .ods, .xls, .xlsx and .xlsm files. <br><br>  To get the data in an array, you can use the get_array () function, which is contained in the pyexcel package: <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">Import</span></span> `pyexcel` <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyexcel # <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> an <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> the data my_array = pyexcel.get_array(file_name="test.xls")        ,   get_dict (): # <span class="hljs-keyword"><span class="hljs-keyword">Import</span></span> `OrderedDict` module <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyexcel._compact <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> OrderedDict # <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> your data <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> an ordered <span class="hljs-keyword"><span class="hljs-keyword">dictionary</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> lists my_dict = pyexcel.get_dict(file_name="test.xls", name_columns_by_row=<span class="hljs-number"><span class="hljs-number">0</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> your data <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a <span class="hljs-keyword"><span class="hljs-keyword">dictionary</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>D arrays book_dict = pyexcel.get_book_dict(file_name="test.xls")</code> </pre> <br>  However, if you want to return two-dimensional arrays to the dictionary or, in other words, get all the sheets of a book in one dictionary, you should use the get_book_dict () function. <br><br>  Keep in mind that both the mentioned data structures, arrays and dictionaries of your spreadsheet allow you to create your data's DataFrames with pd.DataFrame ().  This will simplify the processing of your data! <br><br>  Finally, you can simply get entries with pyexcel thanks to the get_records () function.  Just pass the argument to the file_name function and get back the list of dictionaries: <br><br><pre> <code class="hljs sql"><span class="hljs-comment"><span class="hljs-comment"># Retrieve the records of the file records = pyexcel.get_records(file_name="test.xls")</span></span></code> </pre> <br>  <b>File Records with pyexcel</b> <br><br>  Just as you can load data into arrays using this package, you can also easily export arrays back to a spreadsheet.  To do this, use the save_as () function with passing the array and the name of the target file to the argument dest_file_name: <br><br><pre> <code class="hljs lua"># Get the data data = <span class="hljs-string"><span class="hljs-string">[[1, 2, 3], [4, 5, 6], [7, 8, 9]]</span></span> # Save the array to a file pyexcel.save_as(array=data, dest_file_name=<span class="hljs-string"><span class="hljs-string">"array_data.xls"</span></span>)</code> </pre> <br>  Note: if you specify a delimiter, you can add the argument dest_delimiter and pass the character you want to use as a delimiter between ‚Äú‚Äù. <br><br>  However, if you have a dictionary, you will need to use the save_book_as () function.  Transfer the two-dimensional dictionary in bookdict and specify the file name, and everything is OK: <br><br><pre> <code class="hljs kotlin"># The <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>d_array_dictionary = {<span class="hljs-string"><span class="hljs-string">'Sheet 1'</span></span>: [ [<span class="hljs-string"><span class="hljs-string">'ID'</span></span>, <span class="hljs-string"><span class="hljs-string">'AGE'</span></span>, <span class="hljs-string"><span class="hljs-string">'SCORE'</span></span>] [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>], [<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>], [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>] ], <span class="hljs-string"><span class="hljs-string">'Sheet 2'</span></span>: [ [<span class="hljs-string"><span class="hljs-string">'X'</span></span>, <span class="hljs-string"><span class="hljs-string">'Y'</span></span>, <span class="hljs-string"><span class="hljs-string">'Z'</span></span>], [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>] [<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>] ], <span class="hljs-string"><span class="hljs-string">'Sheet 3'</span></span>: [ [<span class="hljs-string"><span class="hljs-string">'M'</span></span>, <span class="hljs-string"><span class="hljs-string">'N'</span></span>, <span class="hljs-string"><span class="hljs-string">'O'</span></span>, <span class="hljs-string"><span class="hljs-string">'P'</span></span>], [<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>], [<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">17</span></span>] [<span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">21</span></span>] ]} # Save the <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> to a file pyexcel.save_book_as(bookdict=<span class="hljs-number"><span class="hljs-number">2</span></span>d_array_dictionary, dest_file_name=<span class="hljs-string"><span class="hljs-string">"2d_array_data.xls"</span></span>)</code> </pre> <br>  Remember that when you use the code that is printed in the code snippet above, the order of the data in the dictionary will not be saved! <br><br>  <b>Read and write .csv files</b> <br><br>  If you are still looking for libraries that allow you to upload and write data to CSV files other than Pandas, we recommend the csv library: <br><br><pre> <code class="hljs pgsql"># <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> `csv` <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> csv # <span class="hljs-keyword"><span class="hljs-keyword">Read</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> csv file <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> csv.reader(<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'data.csv'</span></span>), delimiter=<span class="hljs-string"><span class="hljs-string">','</span></span>): print(<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>) # <span class="hljs-keyword"><span class="hljs-keyword">Write</span></span> csv file data = [[<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>], [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>], [<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>]] outfile = <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'data.csv'</span></span>, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) writer = csv.writer(outfile, delimiter=<span class="hljs-string"><span class="hljs-string">';'</span></span>, quotechar=<span class="hljs-string"><span class="hljs-string">'"'</span></span>) writer.writerows(data) outfile.<span class="hljs-keyword"><span class="hljs-keyword">close</span></span>()</code> </pre> <br>  Note that NumPy has a genfromtxt () function that allows you to load data contained in CSV files into arrays, which can then be placed in DataFrames. <br><br>  <b>Final data check</b> <br><br>  When the data is prepared, do not forget the last step: check that the data is loaded correctly.  If you put your data in the DataFrame, you can quickly and easily check whether the import was successful by running the following commands: <br><br><pre> <code class="hljs sql"><span class="hljs-comment"><span class="hljs-comment"># Check the first entries of the DataFrame df1.head() # Check the last entries of the DataFrame df1.tail()</span></span></code> </pre> <br>  Note: Use DataCamp Pandas Cheat Sheet when you plan to upload files as Pandas DataFrames. <br><br>  If the data is in an array, you can check it using the following attributes of the array: shape, ndim, dtype, etc .: <br><br><pre> <code class="hljs sql"><span class="hljs-comment"><span class="hljs-comment"># Inspect the shape data.shape # Inspect the number of dimensions data.ndim # Inspect the data type data.dtype</span></span></code> </pre> <br>  <b>What's next?</b> <br><br>  Congratulations, you now know how to read Excel files in Python :) But importing data is only the beginning of the workflow in the data area.  When you have data from spreadsheets in your environment, you can focus on what really matters: data analysis. <br><br>  If you want to dive deeper into the topic - meet PyXll, which allows you to write functions in Python and call them in Excel. </div><p>Source: <a href="https://habr.com/ru/post/331998/">https://habr.com/ru/post/331998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331988/index.html">Graphics for indie games. What to do if the roundels and sticks do not suit you</a></li>
<li><a href="../331990/index.html">Tale about NePetu, or rather not about Petya</a></li>
<li><a href="../331992/index.html">‚ÄúIceberg instead of Oscar!‚Äù Or as I tried to learn the basics of DataScience on kaggle</a></li>
<li><a href="../331994/index.html">Ruining people not beer</a></li>
<li><a href="../331996/index.html">Rasking through the parts of a particularly hardy iron bullion S line, where 768 GB of RAM</a></li>
<li><a href="../332000/index.html">Autoencoders in Keras, Part 5: GAN (Generative Adversarial Networks) and tensorflow</a></li>
<li><a href="../332004/index.html">Savings on matches or data recovery from the grating HDD Seagate ST3000NC002-1DY166</a></li>
<li><a href="../332006/index.html">"Factory Method" in the development for Android. The best way to handle pushes</a></li>
<li><a href="../332008/index.html">Retrospective. 10 years of Yota and 10 interesting facts about the company</a></li>
<li><a href="../332012/index.html">NetApp HCI is the new generation hyperconvergent system for working with data</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>