<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parallel loading of JavaScript and CSS without blocking page parsing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is known that following the ideas of the old school, namely, adding links to JS and CSS to the pages, can turn into a long page load time. The brow...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parallel loading of JavaScript and CSS without blocking page parsing</h1><div class="post__text post__text-html js-mediator-article">  It is known that following the ideas of the old school, namely, adding links to JS and CSS to the pages, can turn into a long page load time.  The browser displays the page as it is downloaded, but stops if it hits a script tag with a link, until the script is loaded and executed.  Sites began to use an increasing number of scripts, the initial display of the page takes more and more time, for example, on this page you are reading, 13 scripts, 7 of which are in the head.  In addition, some browsers still adhere to restrictions on the simultaneous number of downloads from a single host. <br><br>  Immediately I propose to accept that all JS files are minimized, and transmitted in a compressed form. <br><br>  There are several solutions, such as: <br>  - put styles and scripts directly on the page; <br>  - setting the async / defer attributes to the script tag; <br>  - merge all the scripts into one file; <br>  - Mix the links to the scripts at the end of the body; <br>  - place all files on CDN / on different hosts; <br>  - your own version ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      These solutions work, each better or worse depending on how the site itself is built, but they have a number of drawbacks, which I will describe below. <br>  There is an interesting technique that solves the problem of a pause before the initial display of the page, and at the same time adds some convenience.  I would venture to suggest that this technique is familiar to many, but nevertheless here I did not see any mention of it. <br><br>  It all started, of course, from the fact that I took up one project, and at some point it seemed to me that the unpretentious page was loading for a long time, and looked at the download schedule, and the results of YSlow.  The fire went out for a second in my eyes, but knowing that it could be better, I climbed to look, <a name="habracut"></a><br><br>  Let us analyze the disadvantages of the above methods. <br><br><h5>  Putting scripts and styles directly into the page </h5><br>  Obviously, this solution is only suitable for small pages, where there are not many style scripts, since in case of a page reload, static data will be reloaded, and caching may not work.  The solution is fully justified for small scripts and styles that are vital from the very moment the page is loaded. <br><br><h5>  Setting the async / defer attributes to the script tag </h5><br>  The specification is <a href="http://dev.w3.org/html5/spec/Overview.html">here</a> . <br>  The async and defer attributes of the script tag are supported by the <a href="http://caniuse.com/script-async">following</a> <a href="http://caniuse.com/script-defer">browsers</a> , which may seem insufficient for those who <a href="http://caniuse.com/script-defer">create</a> websites that people can access with outdated browsers, as well as Opera, which is especially important in runet. <br>  Among the shortcomings, it can also be noted that the scripts loaded from the tag with the defer attribute cannot use document.write, since their execution is not synchronized with the page parser. <br><br><h5>  Gluing Scripts and Styles </h5><br>  There is an interesting <a href="http://blog.getify.com/labjs-why-not-just-concat/">note</a> (carefully, English) and a <a href="http://test.getify.com/concat-benchmark/test-1.html">test</a> that show that downloading a single large file can take longer than parallel loading of individual files.  However, this technique is not only worthy of mention and life, but it is also extremely shown to be used if different pages of the site use the same set of scripts or styles. <br><br><h5>  Placing the stylesheet in the head, and the script in the end of the body </h5><br>  It is worth mentioning and using, but in this case, as in the ones described above, there may be unresolved dependencies between scripts until document.ready, and if this is acceptable for jQuery with plugins, then for the option when we load the Facebook API library or VKontakte, and we want to immediately run our script, which will send a request to the API to determine if the user is logged in, promises crutches, or by loading the API library at the top of the page, blocking its display, which is burdened by having to call DNS resolve. <br><br><h5>  CDN boot </h5><br>  Using a CDN can reduce the load on your own server, but it can both increase and decrease the load time, or it can completely block the script load, as in the case of an attack on a CDN server or blocking a CDN server on a provider or in an enterprise network. <br><br><h5>  What other solutions are there? </h5><br>  What if you try to load scripts while the page is loading, but do not execute them, and generally hide from the browser that these are scripts until they have finished loading, so as not to block the initial display of the page? <br><br>  Somewhere in the notes I found <a href="http://headjs.com/">HeadJS</a> , but since the first time I stumbled upon it, he seriously mated, and learned to do not only what we need, but much more.  Despite the fact that the library is clearly good, and in the minified form it only takes 3KB, I decided to look for alternatives and found as many as 14 similar libraries, a brief and not always true comparison of which can be found in <a href="http://webification.com/12-javascript-loaders-to-speed-up-your-web-applications">this</a> note, plus <a href="">load.js</a> and <a href="">include.js</a> .  Skimming through the libraries presented and noting first large (&gt; 3KB), and then those that I did not like with the syntax or principle of operation, I personally chose <a href="http://yepnopejs.com/">YepNope.js</a> , which is part of <a href="http://www.modernizr.com/">Modernizr</a> .  The authors of the library report that the library is neither better nor worse than the others, and performs the same task as the others, and that they also use other loaders in different projects. <br><br>  So, what and how does the resource loader on the example of YepNope: <br><pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">'/javascripts/yepnope-min.js'</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> yepnope(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'/javascripts/jquery.min.js'</span></span></span><span class="actionscript">, </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'/javascripts/jquery.loadmask.min.js'</span></span></span><span class="actionscript">, </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'/javascripts/jquery.jgrowl_minimized.js'</span></span></span><span class="actionscript">]) </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Execution of the loaded scripts goes in the specified order. <br><br>  Further in the initialization block: <br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">yepnope</span></span>({ <span class="hljs-attribute"><span class="hljs-attribute">load</span></span>: [<span class="hljs-string"><span class="hljs-string">'//connect.facebook.net/ru_RU/all.js'</span></span>, <span class="hljs-string"><span class="hljs-string">'/javascripts/facebook_auth_callback.js'</span></span>], complete: <span class="hljs-built_in"><span class="hljs-built_in">function</span></span>(){ FB.<span class="hljs-built_in"><span class="hljs-built_in">init</span></span>({appId: <span class="hljs-string"><span class="hljs-string">'273684999999999'</span></span>, xfbml: true, cookie: true, oauth: true}) FB.Event.<span class="hljs-built_in"><span class="hljs-built_in">subscribe</span></span>(<span class="hljs-string"><span class="hljs-string">'auth.statusChange'</span></span>, facebook_auth) } })</code> </pre><br>  So, we get all the desired buns, such as parallel loading, certainty of the execution time of the script, dependencies, callbacks on readiness. <br><br>  Example of loading styles: <br><pre> <code class="hljs lisp">yepnope(['/stylesheets/jquery.loadmask.css', '/stylesheets/jquery.jgrowl.css'])</code> </pre><br>  YepNope and other downloaders also have a lot of additional features, the description of which in this topic is not appropriate, but with which it is nice to meet, and everyone has to choose something for himself. <br><br>  The authors of the scripts can not come to a single principle of operation and API interface, and continue to create all new downloads.  In this regard, the author of HeadJS offers to build support for the boot order in the specifications, and the author of $ script.js supports it in this, but until it goes through the specifications and will work the same in all browsers, we will have to use the loaders. <br><br>  What is the final recipe? <br>  - embed in the head of the page script, pointing to the loader; <br>  - embed an inline script that uses the loader to load other scripts and styles; <br>  - combine scripts and styles that are used only together in one to minimize the number of HTTP requests; <br>  - minimize scripts and styles; <br>  - make sure that the server is packing the transmitted data with gzip; <br>  - make sure that the server is caching correctly; <br>  - carefully and thoughtfully use third-party CDN and additional hosts. <br><br>  When writing a topic, I looked at the following materials recommended for reading: <br>  <a href="http://javascript.ru/tutorial/events/timing">[one].</a>  <a href="http://javascript.ru/tutorial/events/timing">Event sequencing and javascript synchronization</a> <br>  <a href="http://ruseller.com/lessons.php%3Frub%3D32%26id%3D1190">[2].</a>  <a href="http://ruseller.com/lessons.php%3Frub%3D32%26id%3D1190">Simple script loading with yepnope.js</a> <br>  <a href="http://yepnopejs.com/">[3].</a>  <a href="http://yepnopejs.com/">Description yepnope.js</a> <br>  <a href="http://www.dustindiaz.com/scriptjs/">[four].</a>  <a href="http://www.dustindiaz.com/scriptjs/">Description $ script.js</a> <br><br>  UPD. <br>  from <a href="http://habrahabr.ru/users/shine/" class="user_link">sHinE</a> <a href="https://spreadsheets.google.com/lv%3Fkey%3DtDdcrv9wNQRCNCRCflWxhYQ">Another table-comparison of various boot loaders, with a more complete list.</a> <br>  by <a href="http://habrahabr.ru/users/s2nek/" class="user_link">S2nek</a> <a href="http://blog.obout.ru/posts/62/yepnope%2520-%2520%25D0%25B0%25D1%2581%25D0%25B8%25D0%25BD%25D1%2585%25D1%2580%25D0%25BE%25D0%25BD%25D0%25BD%25D1%258B%25D0%25B9%2520%25D0%25B7%25D0%25B0%25D0%25B3%25D1%2580%25D1%2583%25D0%25B7%25D1%2587%25D0%25B8%25D0%25BA%2520js/css%2520%25D1%2580%25D0%25B5%25D1%2581%25D1%2583%25D1%2580%25D1%2581%25D0%25BE%25D0%25B2">Russian translation of the description of YepNope.</a> </div><p>Source: <a href="https://habr.com/ru/post/135786/">https://habr.com/ru/post/135786/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../135778/index.html">Heat Sensing Pillow</a></li>
<li><a href="../135780/index.html">Do you use HP webOS based devices?</a></li>
<li><a href="../135782/index.html">New Year's zip quest 2012 - the passage</a></li>
<li><a href="../135783/index.html">Personal multicopter</a></li>
<li><a href="../135784/index.html">PayPal may ask the buyer to destroy the item for a refund</a></li>
<li><a href="../135788/index.html">Unkillable USB flash drive :: 2</a></li>
<li><a href="../135790/index.html">Radio-controlled Wi-Fi machine with a camera</a></li>
<li><a href="../135793/index.html">Nokia Maps 3D demo (WebGL)</a></li>
<li><a href="../135794/index.html">Classical mechanics: about diffusions "on the fingers"</a></li>
<li><a href="../135795/index.html">Artificial intelligence in CAM-systems for solving problems of automating the creation of control programs</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>