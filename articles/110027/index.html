<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Win 7 Optimization for VDI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So, colleagues, today we'll talk about preparing a virtual machine with Windows 7 for further cloning in the VDI environment. You should not consider ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Win 7 Optimization for VDI</h1><div class="post__text post__text-html js-mediator-article">  So, colleagues, today we'll talk about preparing a virtual machine with Windows 7 for further cloning in the VDI environment.  You should not consider this post as an unconditional guide to action, these are only recommendations for administrators on how to optimize Windows 7 as much as possible for efficient use of hardware resources of virtualization servers.  As a virtualization platform, the VMware ESX hypervisor is considered as a leader in its field. <br><a name="habracut"></a><br>  Beg a small entry.  Based on my own experience, I can confidently assert that the use of a physical machine transferred to a virtual environment as a ‚Äúgolden‚Äù image leads to a completely non-optimal use of resources.  This is due to the process of converting Physical-to-Virtual.  For one or two users (for example, VIP), this approach certainly has the right to coexist, but using such a conversion to create an image of a virtual machine (VM) will only lead to additional load on the virtualization servers, as mentioned above. <br><br>  So, the process of preparing a VM begins with the creation of this very VM.  Already at this stage, you can somewhat optimize the "golden" VM.  First, when creating a network card, specify VMXNet3.  Within one VM, this saves about 1-2% of hardware resources, however, when deploying VDI even for several hundred users, the savings cease to be something ephemeral.  As a hard disk, the ideal solution would be to use a SCSI disk on the LSI Logic SAS controller.  It is advisable to use ‚Äúthin‚Äù drives (Thin Provisioning), although if you have a very ‚Äúthick‚Äù storage system ... Then you can only envy! <br><br>  It is best to immediately remove the floppy disk, as well as LPT-and COM-ports. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The amount of RAM is best to assign 1-1.5 GB for a 32-bit OS and 1.5-2 for a 64-bit OS.  Of course, for heavily loaded VMs, you can allocate large amounts of RAM, but you should not exceed the values ‚Äã‚Äãof 3 GB for 32-bit and 4 GB for 64-bit OS. <br><br>  As an optical drive, you need to use a Windows 7 installation disk mounted to the VM. Make sure that the drive will turn on when you turn on the VM (Connect at Power on cover in the VM properties). <br>  Next, install the actual OS Windows 7. Here we give everything at the mercy of the administrator.  I will only note that two options are possible: <br><br>  ‚Ä¢ standard fully manual installation (to be considered further); <br><br>  ‚Ä¢ semi-automatic installation using the Microsoft Deployment Toolkit (leave for future posts). <br><br>  So, the OS is installed.  Now it‚Äôs time to install VMware Tools, VDI software (for example, VMware View Agent or Quest vWorkspace Agent) inside VMware Tools and start optimizing.  I recommend to immediately disable (switch to the Disabled state) the following services: <br><br>  ‚Ä¢ BitLocker Drive Encryption Service; <br><br>  ‚Ä¢ Block Level Backup Engine Service; <br><br>  ‚Ä¢ Desktop Window Manager Session Manager; <br><br>  ‚Ä¢ Disk Defragmenter; <br><br>  ‚Ä¢ Diagnostic Policy Service; <br><br>  ‚Ä¢ Home Group Listener; <br><br>  ‚Ä¢ Home Group Provider; <br><br>  ‚Ä¢ IP Helper (only if not using IPv6); <br><br>  ‚Ä¢ Microsoft iSCSI Initiator Service; <br><br>  ‚Ä¢ Microsoft Software Shadow Copy Provider; <br><br>  ‚Ä¢ Security Socket Tunneling Protocol Service; <br><br>  ‚Ä¢ Security Center; <br><br>  ‚Ä¢ Superfetch (for VMs that are not associated with users); <br><br>  ‚Ä¢ Tablet PC Input Service; <br><br>  ‚Ä¢ Themes (for VIP it is better not to disconnect - all ‚Äúbeautiful‚Äù will disappear ÔÅä); <br><br>  ‚Ä¢ UPnP Device Host; <br><br>  ‚Ä¢ Volume Shadow Copy Service; <br><br>  ‚Ä¢ Windows Backup; <br><br>  ‚Ä¢ Windows Defender (if you use third-party anti-virus software or in the case of "one-time" VMs that will be deleted after the user exits the OS); <br><br>  ‚Ä¢ Windows Error Reporting Service; <br><br>  ‚Ä¢ Windows Firewall (can also be disabled using Active Directory group policies); <br><br>  ‚Ä¢ Windows Media Center Receiver Service; <br><br>  ‚Ä¢ Windows Media Center Scheduler Service; <br><br>  ‚Ä¢ Windows Search; <br><br>  ‚Ä¢ Windows Update; <br><br>  ‚Ä¢ WLAN AutoConfig; <br><br>  ‚Ä¢ WWAN AutoConfig; <br><br>  ‚Ä¢ Offline Files; <br><br>  ‚Ä¢ SSDP Discover. <br><br>  The list, of course, can be supplemented or cut, it all depends on the needs of your infrastructure. <br><br>  You can use the following PowerShell command to disable services: <br>  <i>Powershell Set-Service &lt;service name&gt; -startuptype ‚Äúdisabled‚Äù</i> <br><br>  Below are a few recommendations related to setting the "golden" image using group policies. <br><br>  First, the ideal solution would be to use a dedicated OU for all VMs, blocking legacy for this OU (preferably, but not necessarily), and also enable loopback processing so that uniform policies are applied that are assigned to the OU with VM.  Again, I‚Äôll clarify that these recommendations refer to ordinary ‚Äúmortals‚Äù, whereas VIP certainly requires an individual approach. <br><br>  So, about the policy: <br><br>  ‚Ä¢ <b>Action Center Icon Removal</b> (User Configuration&gt; Administrative Templates&gt; Start Menu and Taskbar) - Remove the Action Center Icon = Enabled. <br><br>  ‚Ä¢ <b>Event Logs</b> (Computer Configuration&gt; Administrative Templates&gt; Event Log Service&gt; Specific Event Log) - Maximum log size = 1024 (for all logs - Application log, Security log, System log). <br><br>  ‚Ä¢ <b>Firewall</b> (Computer Configuration&gt; Windows Settings&gt; Security Settings&gt; Windows Firewall with Advanced Security&gt; Windows Firewall Properties) - Firewall State = Off. <br><br>  ‚Ä¢ <b>Internet Explorer Settings (cache)</b> (User Configuration&gt; Administrative Templates&gt; Windows Components&gt; Internet Explorer&gt; Internet Control Panel&gt; Advanced Page) - Empty Internet. <br><br>  ‚Ä¢ <b>Internet Explorer Settings (first run wizard)</b> (Computer Configuration&gt; Administrative Templates&gt; Windows Components&gt; Internet Explorer) - Prevent performance of First Run Customize = Enabled. <br><br>  ‚Ä¢ <b>Recycle Bin</b> (User Configuration&gt; Administrative Templates&gt; Windows Components&gt; Windows Explorer) - bin = Enabled. <br><br>  ‚Ä¢ <b>Remote Desktop</b> (Computer Configuration&gt; Administrative Templates&gt; Windows Components&gt; Remote Desktop Services&gt; Remote Desktop Session Host&gt; Connections) - Enable Remote Desktop Services = Enabled. <br><br>  ‚Ä¢ <b>Remote Desktop</b> (Computer Configuration&gt; Administrative Templates&gt; Windows Components&gt; Remote Desktop Services&gt; Remote Desktop Session Host&gt; Security) - Require user authentication - Enabled. <br><br>  ‚Ä¢ <b>RSS Feeds</b> (User Configuration&gt; Administrative Templates&gt; Windows Components&gt; RSS Feeds) - Turn Off background. <br><br>  ‚Ä¢ <b>Screen Saver</b> (User Configuration&gt; Administrative Templates&gt; Control Panel&gt; Personalization) - set in accordance with the policies of the Company. <br><br>  ‚Ä¢ <b>System Restore</b> (Computer Configuration&gt; Administrative Templates&gt; System&gt; System Restore) - Turn Off System Restore = Enabled. <br><br>  ‚Ä¢ <b>User Access Control</b> (Computer Configuration&gt; Windows Settings&gt; Security Settings&gt; Local Policies&gt; Security Options): <br><br>  o User Account Control: Approval Mode = Elevate without promting; <br><br>  o User Account Control: Detect application installations and promt for elevation = Disabled; <br><br>  o User Account Control: Only elevate applications that are installed in secure locations = Disabled; <br><br>  o User Account Control: Run all administrators in Admin Approval Mode = Disabled. <br><br>  ‚Ä¢ <b>Wallpaper</b> (User configuration&gt; Administrative Templates&gt; Desktop&gt; Desktop) - Desktop Wallpaper = ‚Äú‚Äú (a space must be used for a desktop without wallpaper, you can specify your path to the standard wallpaper of the Company). <br><br>  ‚Ä¢ <b>Windows Defender</b> (Computer Configurations&gt; Administrative Templates&gt; Windows Components&gt; Windows Defender) - Turn off Windows Defender = Enabled (already mentioned earlier about the limitations of disabling Windows Defender). <br><br>  ‚Ä¢ <b>Windows Sideshow</b> (Computer Configuration&gt; Administrative Templates&gt; Windows Components&gt; Windows Sideshow) - Turn off Windows Sideshow = Enabled. <br><br>  ‚Ä¢ <b>Windows Update</b> (Computer Configuration&gt; Administrative Templates&gt; System&gt; Internet Communication Management&gt; Internet Communication Settings): <br><br>  o Turn off Access to All Windows Update Features = Enabled; <br><br>  o Turn off Windows Update Device Driver Searching = Enabled. <br><br>  After the image is configured, you must run the ipconfig / release command to release the lease of the IP address on the DHCP server.  Now you can turn off the VM.  If you plan to use linked clone, then now is the time to take a snapshot of the VM (snapshot). <br><br>  Everything, the ‚Äúgolden‚Äù image of VM is ready for use! <br><br>  Colleagues, I will be glad to hear and discuss other ways to optimize Windows 7 for further use in the VDI environment. </div><p>Source: <a href="https://habr.com/ru/post/110027/">https://habr.com/ru/post/110027/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../110021/index.html">Capistrano and php</a></li>
<li><a href="../110022/index.html">Before the New Year - a gift to everyone!</a></li>
<li><a href="../110023/index.html">Visiting Google</a></li>
<li><a href="../110025/index.html">MultiTouch Twitter Wall</a></li>
<li><a href="../110026/index.html">The system of payments in freelance. Problems and their new solutions</a></li>
<li><a href="../110028/index.html">IBM computer will play against two champions Jeopardy!</a></li>
<li><a href="../110029/index.html">CSS tricks - we write a website without html</a></li>
<li><a href="../110031/index.html">Sending web pages from Instapaper to Kindle</a></li>
<li><a href="../110032/index.html">MS closed 17 vulnerabilities yesterday, including DLL Preloading / Hijacking and the last unclosed vulnerability from the Stuxnet worm</a></li>
<li><a href="../110033/index.html">The Humble Indie Bundle # 2 - "pay what you want" for 5 games</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>