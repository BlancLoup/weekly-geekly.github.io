<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Easy navigation in Windows Explorer and Total Commander</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Have you ever thought that navigating in Windows could be much more convenient? Why not add a feature similar to navigating through classes in many mo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Easy navigation in Windows Explorer and Total Commander</h1><div class="post__text post__text-html js-mediator-article">  Have you ever thought that navigating in Windows could be much more convenient?  Why not add a feature similar to navigating through classes in many modern IDEs, when in the drop-down list triggered by a shortcut, folders with the correct name are displayed, like this: <br><br><img src="https://habrastorage.org/storage1/2cd53624/61bae6bc/56bc19fe/7d977b72.png" alt="image"><br><a name="habracut"></a><br>  Once thinking, I wrote a small application called ‚ÄúNavigation Assistant‚Äù, shown above.  It is available <a href="http://code.google.com/p/navigation-assistant/downloads/list">here</a> , the source code is open, it is free, distributed under the MIT license.  I hope it will be useful to anyone. <br><br><h4>  Why do you need it? </h4><br>  Here are the shortcomings of navigation in Windows Explorer and Total Commander, which, I am sure, cause frustration for many: <br><ol><li>  with a large depth of nesting the desired folder you need to make a lot of mouse clicks <br></li><li>  The default search in Windows Explorer is incredibly slow.  In addition, to use it, you need to start the explorer itself, click on the search field, type the name of the entire folder or file, and wait a long time <br></li><li>  Total Commander has hints when typing the path in the address bar, but you need to type either the full path or the relative path (relative to the current folder), which is inconvenient <br></li></ol><br>  That's why I wrote Navigation Assistant, whose work is similar to navigating the classes or files of many modern IDEs: Ctrl-N and Ctrl-Shift-N in JetBrains products (ReSharper, IDEA, PhpStorm, WebStorm), Ctrl-Shift-T in Eclipse 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The bonus obtained by using this program is the best directory structure.  Many developers, especially those who have read Code Complete, know that the brain copes well with 7 ¬± 2 objects in working memory;  therefore, just as it is useful to limit the number of fields and methods in a class, it is useful to limit the number of subdirectories in a given directory. <br><br>  With the current state of things this can only be achieved at the cost of inconvenient navigation.  When using Navigation Assistant, you no longer have to fear the big nesting of directories. <br><br><h4>  How to use it? </h4><br>  So far only fast navigation through folders is supported, but not by files. <br><br>  To quickly get to the desired folder in Windows Explorer or Total Commander (or in any other, but then a new Windows Explorer will be instantiated to navigate) press a special shortcut (Ctrl-Shift-M by default, but you can change it in the settings ).  The main application window will appear: <br><br><img src="https://habrastorage.org/storage1/a60a6aa7/77cd82f4/33061777/a7790d02.png"><br><br>  Start typing the name of the folder you would like to get to. <br><br>  Killer feature: it is not necessary to type the name of the entire folder;  for example, to get into Documents and Settings, you can type only "documents and".  Moreover, it is not necessary to type the word ‚Äúdocuments‚Äù entirely, and ‚Äúdoc and‚Äù will suffice (hello, JetBrains!);  it is also not necessary to type the name of the folder from the first word: ‚Äúand settings‚Äù will also be appropriate.  Pascal / camel case is supported specifically for developers: the NavigationAssistant folder will also be assigned to the nav assist search bar. <br><br>  As a result of these manipulations, a list of suitable directories will appear on the screen: <br><br><img src="https://habrastorage.org/storage1/2cd53624/61bae6bc/56bc19fe/7d977b72.png"><br><br>  It remains for you to either select the desired item with the mouse, or use the up / down keys and click Enter (input focus can remain in the text field at this time). <br><br>  If the window doesn‚Äôt please you, you can quickly minimize it to the tray using the Escape key. <br><br>  If you call the program not in Windows Explorer or in Total Commander, then a new Windows Explorer window will open (with the necessary folder);  in the settings you can change the default navigator to Total Commander. <br><br><h4>  What else is there in it? </h4><br>  There is also a settings window in which you can change <br><ol><li>  list of programs to support improved navigation (for example, disable Total Commander) <br></li><li>  default navigation program <br></li><li>  keyboard shortcut to call the window Navigation Assistant <br></li><li>  specify which directories to search in (for example, only in C: \ Users \ or only in D: \) <br></li><li>  in addition, you can exclude certain directory names from the results (for example, bin, obj, .svn) <br>  (more precisely, any path containing the bin folder will be excluded; I note that these are actually regular expressions, so you can specify something like bin \ S *) <br></li><li>  configure the default boot (recommended, because it will not update the internal directory cache every time you start) <br></li></ol><br>  For all the options are available tooltips.  To get to the settings, just right-click on the tray icon. <br><br><h4>  How is it done </h4><br>  The utility is written on Microsoft .Net 3.5 using WPF technology, so it should work wherever .Net 3.5 is present. <br><br>  The installer is written using <a href="http://www.jrsoftware.org/isinfo.php">Inno Setup</a> , which I wildly recommend to anyone who writes installers: it‚Äôs much better than WiX, Install Shield, Visual Studio Installer, because it‚Äôs <br><ol><li>  free and free <br></li><li>  modular (not tied to Microsoft technology) <br></li><li>  transparent (only text script is edited, no visual programming, as, for example, in Visual Studio Installer) <br></li><li>  as a result, the installer files are not re-created with every change ‚Äî there are no problems with the version control system <br></li><li>  flexible (supports scripting with Pascal / Delphi).  Before that, I saw Delphi last 7 years ago, during my first year at the institute, but the advantages of InnoSetup more than compensate for this disadvantage. <br></li><li>  oh yeah, it magically creates one installation file for x32 and x64 versions <br></li></ol><br>  Comparison of installers can be found, for example, <a href="http://stackoverflow.com/questions/3767/what-is-the-best-choice-for-building-windows-installers">here</a> . <br><br>  There are several non-trivial points in the code: <br><br><h5>  Reaction to global keystrokes </h5><br>  In order to show the Navigation Assistant window in time, you need to listen to pressing the key combination globally (that is, in all applications).  .Net does not allow this out of the box.  Therefore, I used the code <a href="http://www.codeproject.com/KB/cs/globalhook.aspx">from here</a> (although there are several other solutions, it‚Äôs just google global hooks / global hotkeys). <br><br><h5>  Setting the focus on an inactive application </h5><br>  After we discovered that in some window the cherished key combination was pressed, it is necessary to show the Navigation Assistant and also set the focus to it (to make it active, I mean). <br><br>  Yes, WPF has a <a href="http://msdn.microsoft.com/en-us/library/system.windows.window.activate.aspx">Window.Activate</a> method that calls WinApi's SetForegroundWindow function, and, therefore, has all its limitations.  Namely, if your application is inactive when the method is called, the window will not be made working, that is, the focus will remain in the old window.  In fact, this is correct in order not to give malicious programs a sudden change in the current focus and in every possible way impede the work of the user.  But in our case, I want to get around this limitation. <br><br>  The solution helped <a href="http://forums.purebasic.com/english/viewtopic.php%3Ff%3D12%26t%3D7424%26hilit%3Dreal%2BSetForegroundWindow">from here</a> , although there are several others ( <a href="http://www.codeproject.com/Tips/76427/How-to-bring-window-to-top-with-SetForegroundWindo.aspx">one</a> , <a href="http://stackoverflow.com/questions/46030/c-sharp-force-form-focus/94642">two</a> ), but they did not work so well. <br><br><h5>  Integration with Windows Explorer </h5><br>  In order to get a list of open windows windows explorer, <a href="http://omegacoder.com/%3Fp%3D63">this code</a> was borrowed here.  Having a wrapper over a COM object, you can easily change the current path in this explorera window. <br><br><h5>  Integration with Total Commander </h5><br>  Integration with Total Commander is carried out using <a href="http://www.ghisler.ch/wiki/index.php/Command_line_parameters">command line options</a> , primarily / O, which sets the path passed with it not in the new Total Commander instance, but in the already open (if there is one). <br><br><h4>  Architecture </h4><br>  The standard multi-tier architecture is used (an excellent review is in ‚Äú <a href="http://www.infoq.com/minibooks/domain-driven-design-quickly">Domain Driven Design Quickly Online</a> ‚Äù by Avram and Marinescu) <br><ol><li>  UI Layer <br>  1. Views <br></li><li>  Presenters Layer <br>  1. Presenters <br>  2. Presentation Services <br>  3. View Models <br>  4. View Model Mappers <br></li><li>  Domain Model aka Business Layer <br>  1. Domain Services <br>  2. Domain Data Objects (plain Data Transfer Objects) <br></li><li>  No Data Access Layer :-) <br></li></ol><br>  At first, I tried to use the Model-View-View Model template, but then I switched to <br>  Model-View-Presenter for the following reasons: <br><ol><li>  MVP adds an extra level of abstraction Presenters, and without it, all the logic is in View Models, and the latter grow unnecessarily <br></li><li>  This logic should semantically not belong to View Models (single responsibility, that-ce) <br></li><li>  Unable to use interface-driven development (for Views) <br></li><li>  As a result, the UI layer turns to mush (in the sense that there is no separation of duties, modularity, clear interfaces) <br></li></ol><br>  Thus, the Model-View-Presenter is now used, and the UI and data are connected through View Models (WPF Binding), and View Models <br><ol><li>  either passed to the methods of the presentation interfaces from the presenters <br></li><li>  or instantiated by the views themselves <br></li></ol><br>  The main functionality is covered with tests (nUnit and Moq are used). <br><br><h4>  Problems </h4><br>  Surely in the application there are still undetected bugs. <br><br>  In addition, I am not a great specialist in drawing icons, so the system tray icon on a white background looks angular, as if without anti-aliasing;  in all other cases, the icons look, for me, at least, acceptable (but I will not refuse any help or advice). <br><br>  When you first start for a while, all folders will be searched on the user's computer, so you have to wait a few minutes. <br><br>  If the Navigation Assistant was not closed when the computer was last shut down, or it was not automatically started at system startup, then it is impossible to tell if the current directory cache is up to date;  therefore, this cache will be updated in the additional stream, and until the completion of this process, the last saved directory cache will be used (which may not fully correspond to the current file system). <br><br>  Yes, .Net in general and WPF are slow and resource-intensive, but this has to be tolerated. <br><br><h4>  Conclusion </h4><br>  So, I hurried to share with the hardware community a small utility for easy navigation in Windows Explorer and Total Commander.  I hope it will be useful to anyone.  In addition, it may be useful to have a brief overview of the technical solutions. <br><br>  Once again, links: to the <a href="http://code.google.com/p/navigation-assistant/downloads/list">installer</a> , to the project on <a href="http://code.google.com/p/navigation-assistant/">google code</a> (svn is used, as is most likely known to most). <br><br>  The source code is open, the application is free, distributed under the MIT license. <br><br>  Thanks to all! </div><p>Source: <a href="https://habr.com/ru/post/131023/">https://habr.com/ru/post/131023/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../131017/index.html">How to deal with pauses of java applications without touching GC</a></li>
<li><a href="../131018/index.html">Wikimedia Foundation Programming Contest</a></li>
<li><a href="../131020/index.html">Anonymous collapsed servers with child pornography</a></li>
<li><a href="../131021/index.html">Mitap materials scala.by # 5 - Pragmatic Erlang</a></li>
<li><a href="../131022/index.html">Microsoft channel on Youtube was hacked</a></li>
<li><a href="../131025/index.html">Stop analytics</a></li>
<li><a href="../131026/index.html">CLOS generic functions</a></li>
<li><a href="../131028/index.html">Do large companies have the right to disregard user security?</a></li>
<li><a href="../131029/index.html">What happened to hosting in DC MHost?</a></li>
<li><a href="../131034/index.html">MouseTrack is open and published on code.google.com</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>