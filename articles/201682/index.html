<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Once again about obfuscation javascript or tale about how i obfuscator wrote. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There was a task here, to write code in php, which accepts js-code and obfusts it on the very least. After smoking google and habr (including, as the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Once again about obfuscation javascript or tale about how i obfuscator wrote. Part 1</h1><div class="post__text post__text-html js-mediator-article">  There was a task here, to write code in php, which accepts js-code and obfusts it on the very least.  After smoking google and habr (including, as the <a href="http://habrahabr.ru/users/monolithed/" class="user_link">monolithed</a> correctly prompts, here is <a href="http://habrahabr.ru/post/112530/">this article</a> ), I set to work.  As it should, I started by running the JS console in chrome and starting to try to get strings from a mash of characters, that's what happened (with explanations): <br><pre><code class="javascript hljs">(![]+[])</code> </pre> <br>  "False" <br>  [] - empty array <br>  !  - the operation is a logical NOT, a feature of js (and not only), in the case of boolean operations if the operand is 0, false, undefined, null, '' (empty string), then it is reduced to false.  In all other cases - to true.  (thanks to <a href="http://habrahabr.ru/users/oshibka404/" class="user_link">oshibka404</a> for the amendments) <br>  That is, (! []) = False <br>  + Is the operation of addition and union of strings, if both operands are numbers, then addition will occur, otherwise it will be a union of strings with a cast.  By the way, there is a special magic of types, but this later. <br><a name="habracut"></a><br><pre> <code class="javascript hljs">(!(![])+[])</code> </pre><br>  "True" <br>  Absolutely the same principle, only double negation was added array =&gt; false =&gt; true =&gt; ‚Äútrue‚Äù <br><br>  Now we need to get two numbers at our disposal, who will guess which ones? <br><br><pre> <code class="javascript hljs">([]|[])</code> </pre><br>  0 <br>  Here we again have empty arrays passed through bitwise OR, the point is simply to skip any empty elements - we get zero 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="javascript hljs">(-~[])</code> </pre><br>  one <br>  But here everything is a bit more complicated, as we remember [] is an empty array, and we take it and deny it, and not just like that, but bitwise, but [] in the bit representation it will be something like 00000000, and if you invert 11111111 It would seem to be 255, but this is not so, without going into details on the representation of numbers and all sorts of wilds (mantissas, sign digits), suffice to say that in the bit representation the machine stores not only the number, but also the sign, though, if it is necessary, you read that I explain it, the Roskomnadzor has not yet banned Google.  Thus from 0 we get -1, and so, as u already has one minus sign, it turns out --1 = 1 <br>  <i>Dear <a href="http://habrahabr.ru/users/vitvad/" class="user_link">vitvad</a> in the comments kindly <a href="http://habrahabr.ru/post/201682/">gave a</a> <a href="https://www.youtube.com/watch%3Fv%3DMqHDDtVYJRI">link to the video</a> , where they explain the "magic" of numbers</i> <br><br>  Hmm, we certainly got quite a few, but the more the better! <br><br><pre> <code class="javascript hljs">([]+{})</code> </pre><br>  "[object Object]" <br>  Here again, everything is simple, to the gnashing of teeth, an empty array plus an empty object, the union of strings.  BUT!  Stop!  I wanted to tell you a little about this - if, when concatenating strings, one of the operands is an object, then "[object% object_name%]" is returned for its place. <br><br><pre> <code class="javascript hljs">([]/[]+[])</code> </pre><br>  "NaN" <br>  How much is zero divided by zero?  And hell knows, so JavaScript doesn't know either, but those who invented it were smart people (however, the creators of other languages ‚Äã‚Äãare never more stupid, but often have less inclination for masochism) and introduced a special number into the language (and not one , but this is slightly lower), so that NaN is a number, which is not equal to anything, even to itself and means ‚Äúbut the hell knows‚Äù.  What have we done here?  We divided the empty array into an empty array, the type cast worked, and it got equal to the division of 0 by 0. Then as usual <br><br><pre> <code class="javascript hljs">(~[]/-[]+[])</code> </pre><br>  "Infinity" <br>  Let's think about how much it will be -1 / -0?  Infinity and to designate infinity in JS also has its own number.  Basically, I think you already guessed how it works ... <br><br><pre> <code class="javascript hljs">([][[]]+[])</code> </pre><br>  "Undefined" <br>  Here, the case takes an interesting turn, as we remember [] - an empty array, but by turning to it, we allocated a place for it, and we can refer to its elements, which we were not slow to use by turning to an array element by index ... an empty array , but, as before our conversion, there was nothing there that returns undefined, a special type denoting ‚Äúthere could be something here, but it wasn‚Äôt until I looked, but now it‚Äôs here, but inside is empty‚Äù or in short, "not given." <br><br>  Well, let's summarize the first part, the survey and write a simple script: <br><pre> <code class="javascript hljs">alert(<span class="hljs-string"><span class="hljs-string">'cool'</span></span>)</code> </pre><br><br><pre> <code class="javascript hljs">_=[][(![]+[])[(-~[])+(-~[])+(-~[])]+([]+{})[(-~[])]+(!(![])+[])[(-~[])]+(!(![])+[])[([]|[])]]; _=_(); _[(![]+[])[(-~[])]+(![]+[])[(-~[])+(-~[])]+(![]+[])[(-~[])+(-~[])+(-~[])+(-~[])]+(!(![])+[])[(-~[])]+(!(![])+[])[([]|[])]](([]+{})[(-~[])+(-~[])+(-~[])+(-~[])+(-~[])]+([]+{})[(-~[])]+([]+{})[(-~[])]+(![]+[])[(-~[])+(-~[])]);</code> </pre><br>  Analyze in rows <br><br>  1) _ = [] [‚Äúsort‚Äù] - save in a variable a link to the sort method array <br>  2) _ = _ ();  - execute the sort method, get the Window object reference <br>  3) _ ['alert'] ('cool') - using the reference to the alert method in the Window object, execute it with the argument 'cool' </div><p>Source: <a href="https://habr.com/ru/post/201682/">https://habr.com/ru/post/201682/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201670/index.html">SassyStudio - SCSS / SASS / Compass support in Visual Studio</a></li>
<li><a href="../201674/index.html">Asynchronous utm tag mining</a></li>
<li><a href="../201676/index.html">On five screens</a></li>
<li><a href="../201678/index.html">How programming skills can allow to save the mind of a loved one or ‚ÄúFrom programming to psychotherapy‚Äù</a></li>
<li><a href="../201680/index.html">Automatic quest generator</a></li>
<li><a href="../201686/index.html">Vanilla JS vs jQuery 2.0</a></li>
<li><a href="../201688/index.html">Autorun Yandex.Disk as systemd service in Fedora 19</a></li>
<li><a href="../201692/index.html">Postmorthem: how to manage to make 14 mistakes, having developed one social game</a></li>
<li><a href="../201694/index.html">Performance comparison of various encryption systems for linux</a></li>
<li><a href="../201696/index.html">Anonymous chat TorChat and its improvement</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>