<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to quickly see the interesting warnings that the PVS-Studio analyzer issues for C and C ++ code?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From time to time, programmers who are starting to familiarize themselves with the PVS-Studio code analyzer ask: ‚ÄúIs there a list of warnings that acc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to quickly see the interesting warnings that the PVS-Studio analyzer issues for C and C ++ code?</h1><div class="post__text post__text-html js-mediator-article"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df3/c29/8f2/df3c298f21cb71d0c7c699b7e27269d3.png"></div><br>  From time to time, programmers who are starting to familiarize themselves with the PVS-Studio code analyzer ask: ‚ÄúIs there a list of warnings that accurately indicate errors?‚Äù There is no such list for the reason that uninteresting (false) warnings in one project are in another very important and helpful.  However, it is quite possible to begin acquaintance with the analyzer with the most interesting warnings.  Let's look at this topic in more detail. <br><a name="habracut"></a><br>  The trouble is that during the first launches the programmer receives, as a rule, a huge number of warnings in which he ‚Äúsinks‚Äù.  Naturally, he has a desire to start to get acquainted with the most interesting warnings in order to understand whether he should spend all this time at all.  Ok, here are three simple steps that will allow you to get acquainted with the most interesting positives. <br><br><h2>  Step 1 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/648/436/d98/648436d98521380495f1c9f8ee384646.png"></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Disable all alert types except Major (GA).  Common mistake: enable all kinds of warnings.  Inexperienced users think that the more they include the better.  This is not true!  There are sets of diagnostics, such as 64-bit checks and MISRA-rules, which should be used, only clearly representing what it is and how to work with them.  For example, turning on MISRA diagnostics for an ordinary application program will result in tens, thousands, or hundreds of thousands of messages like: <br><br><ul><li>  <a href="https://www.viva64.com/ru/w/v2506/">V2506</a> .  MISRA.  This should be a single point of exit at the end. </li><li>  <a href="https://www.viva64.com/ru/w/v2507/">V2507</a> .  MISRA.  The body of a loop \ conditional statement should not be enclosed in braces. </li><li>  <a href="https://www.viva64.com/ru/w/v2523/">V2523</a> .  MISRA.  All integer constants of unsigned type should have 'u' or 'U' suffix. </li></ul><br>  Most MISRA warnings do not indicate errors, but code smells.  Naturally, a person starts asking questions.  How to find something interesting in the mass of all these warnings?  What diagnostics should he look at?  These are the wrong questions.  You just need to disable the MISRA kit.  This is the standard for writing quality code for embedded devices.  The essence of the standard: make the code extremely simple and straightforward.  Do not try to apply it where it is inappropriate. <br><br>  Note.  Yes, in the MISRA standard there are rules aimed at identifying real errors.  Example: <a href="https://www.viva64.com/ru/w/v2538/">V2538</a> - The value of uninitialized variable should not be used.  But do not be afraid to disable the MISRA-standard.  You will not lose anything.  These errors will still be found in the framework of general-purpose diagnostics (GA).  For example, an uninitialized variable will be found by diagnosing the <a href="https://www.viva64.com/ru/w/v614/">V614</a> . <br><br><h2>  Step 2 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f30/9c1/d2f/f309c1d2fed7a2736170dad987cd4460.png"></div><br><br>  Any static analyzer at the first starts produces false positives and requires a certain setting.  With this nothing can be done, but it is not as scary as it may seem.  Even a simple quick setup allows you to remove most of the false warnings and begin to get acquainted with an already quite adequate report.  We‚Äôre not going to talk more about this, since I‚Äôve written many times about it, for example, in this article: " <a href="https://www.viva64.com/ru/b/0523/">Characteristics of the PVS-Studio analyzer on the example of EFL Core Libraries, 10-15% of false positives</a> ." <br><br>  Spend a little time turning off clearly irrelevant warnings and dealing with false positives due to macros.  Macros are generally the main source of false positives, since a warning appears everywhere where an unsuccessfully implemented macro is used.  To suppress warnings in macros, special comments can be placed next to their declaration.  Details of the format for writing comments are discussed in the <a href="https://www.viva64.com/ru/m/0017/">documentation</a> . <br><br>  Yes, the initial setup takes a little time, but will dramatically improve the perception of the report by eliminating distracting noise.  Spend some time with this.  If there are any difficulties or questions, we are always ready to help and suggest how best to configure the analyzer.  Feel free to <a href="https://www.viva64.com/ru/about-feedback/">write</a> and ask us questions. <br><br><h2>  Step 3 </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f87/0ec/c49/f870ecc49989743ae8caea3c745e602e.png"></div><br><br>  Start learning warnings from level 1.  And only then watch 2 and 3. Alert levels are nothing more than the accuracy of a warning.  Level 1 warnings are more likely to indicate a real error than 2. <br><br>  You can say that choosing ‚Äúwatch level 1‚Äù, you press the button ‚Äúwatch the most interesting mistakes‚Äù. <br><br>  PVS-Studio warnings classification by levels is described in more detail in the article " <a href="https://www.viva64.com/ru/b/0488/">How and why static analyzers deal with false alarms</a> ." <br><br><h2>  So why is there no list yet? </h2><br><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/df2/95f/70b/df295f70b19562c12916ec578022829f.png"></div><br><br>  Nevertheless, the idea of ‚Äã‚Äãa list of the most useful warnings may still seem reasonable.  Let me show you with a practical example that the diagnostic utility is relative and depends on the project. <br><br>  Consider the <a href="https://www.viva64.com/ru/w/v550/">V550</a> warning.  The warning reveals a potential error related to the fact that the operator == or! = Is used to compare floating point numbers. <br><br>  Most of the developers with whom I spoke, believe that this diagnostic is of little use and disable it, since all the positives for their project are false.  And that is why this diagnosis has low accuracy and is located at the 3rd level. <br><br>  Indeed, in most applications float / double types are used in very simple algorithms.  And often a comparison with a constant is used solely to check whether a certain value is set by default, or whether it has changed.  In this case, an accurate check is quite appropriate.  Let me explain this pseudocode. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> value = <span class="hljs-number"><span class="hljs-number">1.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (IsUserInputNewValue()) value = GetUserValue(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value == <span class="hljs-number"><span class="hljs-number">1.0f</span></span>) DefaultBehavior(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Foo(value);</code> </pre> <br>  Here the comparison <i>(value == 1.0f) is</i> correct and safe. <br><br>  Does this mean that the V550 is an uninteresting diagnostic?  Not.  It all depends on the project.  I will quote a fragment from the article ‚Äú <a href="https://habr.com/ru/company/pvs-studio/blog/259911/">About how we tried a static analysis on our project of an educational simulator of endovascular surgery,</a> ‚Äù written by one of our users. <br><br>  So, what does the static analyzer pay attention to here? <br><br>  V550 An odd precise comparison: t! = 0. It is better to use a precision: fabs (A - B)&gt; Epsilon.  objectextractpart.cpp 3401 <br><br><pre> <code class="cpp hljs">D3DXVECTOR3 N = VectorMultiplication( VectorMultiplication(V-VP, VN), VN); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t = Qsqrt(Scalar(N, N)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (t!=<span class="hljs-number"><span class="hljs-number">0</span></span>) { N/=t; V = V - N * DistPointToSurface(V, VP, N); }</code> </pre> <br>  Such errors are repeated quite often in this library.  I will not say that it came as a surprise to me.  Already earlier I ran into incorrect work with floating point numbers in this project.  However, there were no resources to systematically check the sources for this.  As a result of the test, it became clear that you need to give the developer something to read to broaden the horizon in terms of working with floating point numbers.  Threw him links to a couple of good articles.  Let's look at the result.  It is difficult to unequivocally say whether this error causes real malfunctions of the program.  The current solution sets a number of requirements for the original polygonal grid of arteries, by which the spreading of the radiopaque substance is simulated.  If the requirements are not met, the program may fall, or obviously incorrect work.  Some of these requirements are derived analytically, and some - empirically.  It is possible that this second part of the requirements is growing just from incorrect work with floating point numbers.  It should be noted that not all found cases of using an exact comparison of floating-point numbers were an error. <br><br>  As you can see, what is uninteresting in some projects is of interest in others.  This makes it impossible to create a ‚Äúmost interesting‚Äù list. <br><br>  Note.  It is possible to set the alert level using the settings.  For example, if you think that the V550 diagnostics deserves close attention, you can move it from the third level to the first.  This type of settings is described in the <a href="https://www.viva64.com/ru/m/0040/">documentation</a> (see "How to set your level for a specific diagnosis"). <br><br><h2>  Conclusion </h2><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/37d/d9e/ecd/37dd9eecd44e33d66c2993ad552e11f7.png"></div><br><br>  Now you know how to start examining analyzer alerts, looking at the most interesting ones.  And do not forget to look in the documentation to get acquainted with the detailed description of the warnings.  Sometimes it happens that behind a seemingly seemingly precarious warning lies hell.  An example of such diagnostics: <a href="https://www.viva64.com/ru/w/v597/">V597</a> , <a href="https://www.viva64.com/ru/w/v1026/">V1026</a> .  Thanks for attention. <br><br><p> <a href="https://habr.com/en/company/pvs-studio/blog/457330/"><img src="https://habrastorage.org/getpro/habr/post_images/898/3b6/5a7/8983b65a74adb29a2113eba12fbec3f1.png" align="left"></a> </p><br><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Andrey Karpov.  <a href="https://habr.com/en/company/pvs-studio/blog/457330/">How do you quickly check out the PVS-Studio analyzer for the C and C ++ code?</a> </div><p>Source: <a href="https://habr.com/ru/post/457332/">https://habr.com/ru/post/457332/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457316/index.html">How is the role-playing game in the real world for guests of Armenia with trips in half of the country arranged?</a></li>
<li><a href="../45732/index.html">Parallel Extensions for .net 3.5</a></li>
<li><a href="../457324/index.html">Digital events in Moscow from June 24 to June 30</a></li>
<li><a href="../457326/index.html">Failover cluster PostgreSQL + Patroni. Implementation experience</a></li>
<li><a href="../457328/index.html">Categories instead of directories, or Semantic Filesystem for Linux</a></li>
<li><a href="../457334/index.html">TacacsGUI, Configuration Manager</a></li>
<li><a href="../457336/index.html">Consequences of late removal of wisdom teeth</a></li>
<li><a href="../457338/index.html">Blitz with Ilya Krasinsky: how to shoot bad hypotheses, why to dismiss the product and how to grow in a minimum of actions?</a></li>
<li><a href="../45734/index.html">Discuss how to deal with automatic spam?</a></li>
<li><a href="../457340/index.html">10 PostCSS plugins that will save time for your coder</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>