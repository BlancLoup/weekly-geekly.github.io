<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to choose a dress using the main component method</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So, who does not mind if the program, the machine, the neural network picked up his clothes? 

 Any set of images can be analyzed using the principal ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to choose a dress using the main component method</h1><div class="post__text post__text-html js-mediator-article"> So, who does not mind if the program, the machine, the neural network picked up his clothes? <br><br>  Any set of images can be analyzed using <a href="https://onthe.io/learn/en/category/qna/What-is-principal-component-analysis">the principal component method</a> .  This method is already quite successfully used in face recognition.  We will try to use it on the example of women's dresses. <br><br> <a href="http://habrahabr.ru/company/io/blog/265089/"><img src="https://habrastorage.org/getpro/habr/post_images/831/3ec/c59/8313ecc59239428c781c7456097a47d7.jpg" alt="image"></a> <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Baseline: 807 photos of dresses from Amazon.  All images have the same size, but the postures of the models are different (although they, as a rule, have a similar arrangement in the frame).  Ideally, the main components should be determined directly by the style of the dress.  In our case, many of them will be associated with the pose of the model.  Despite this, much more can be done with the data set. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b29/d68/3ee/b29d683ee79c5ead6f679d40404637a2.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/8a1/37d/761/8a137d761a8b88b3b1dac1e096130cba.png" alt="image"><br><br>  The dress itself is the first major component that determines the greatest difference.  In general, the differences between light and dark dresses are tracked. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4b1/b28/dff/4b1b28dffb022bbbc2ecce16298998c8.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/344/277/d04/344277d046b8256744a3fd498be42d84.png" alt="image"><br><br>  The second component compares short and long dresses. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b5f/c7b/c75/b5fc7bc75b2b3d192f2e21f121c8d1ec.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/097/607/1ea/0976071eaf6a6dc4449ba5d712ed5458.png" alt="image"><br><br>  Reddish and bluish shades. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/578/db4/785/578db4785ac47bcc508edb537b5ab6d3.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/f41/7d8/1c3/f417d81c3b4f64c3930d6bb9f21e4bfa.png" alt="image"><br><br>  Models with short hair and sleeveless dresses and long hair with long sleeves. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/24c/4c2/b9e/24c4c2b9e81e4033b3335dc15ad4b438.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/aca/48f/7b7/aca48f7b7b71fd48622d2cb960f2b540.png" alt="image"><br><br>  Models with legs together and apart, and so on. <br><br><h4>  Using components to recreate an image </h4><br>  Having a set of similar components it is possible to reduce the image, for example, from 60,000 data points (pixel values) to just a few points. <br><br>  Let's try to recreate this dress from the components. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/59e/bb4/769/59ebb4769c44224fd8e67d857a4c120a.png" alt="image"><br><br>  The following images are recreated dress, respectively, from one, two, four, nine, ten, fifteen, thirty, forty and seventy components. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0d6/e18/f47/0d6e18f470ce0ba0e5cf1b9cb24b5601.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/c8b/b7e/762/c8bb7e76254367dc6f8ca6fe6a9b87eb.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/a97/94c/f6f/a9794cf6f2b790c912783af753d76889.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/684/042/d09/684042d09db5822273759d43722dc13e.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/d31/89a/aad/d3189aaada285940afc74fd1a1e819fc.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/c24/c9c/075/c24c9c0753633488dd271f561d9fa1e3.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/9ce/b24/5db/9ceb245dbefb509d8cc532abb044018a.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/fa1/9e4/f29/fa19e4f296e8c2e29416b5dcfc499280.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/a18/690/acc/a18690accb4b4a9f6107e1330990610a.png" alt="image"><br><br>  As you can see, the more components are used, the more accurate and detailed is the recreated dress. <br><br>  The data required to obtain the image of the dress of 10 components now look as follows: [-17541.81, -12749.33, -3766.29, 2005.28, 4193.08, 6832.55, -6704.90, -2135 , 51, 1112.27, 7627.80]. <br><br>  So, if you need to store a million photos, you can save a lot of disk space by storing only the values ‚Äã‚Äãof the components instead of the values ‚Äã‚Äãof all the pixels for each dress. <br><br>  The method works even for dresses that are not included in the training sample: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c66/f78/366/c66f7836657c9dc894896bd1045b1919.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/c8e/f33/63a/c8ef3363aa22159422b0736ccc54d944.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/fde/20e/d6c/fde20ed6c91847f917c9140cb83ded6c.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/d15/13d/cdc/d1513dcdc8481eb976239f72c0614de3.png" alt="image"><br><br>  Although the result is not so good in the case of combinations that have not been encountered in training: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3d6/5ac/ac7/3d65acac70dea00d0f2694485be1e7b0.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/5ba/c9f/739/5bac9f739dd0296783f0e8836d29745d.png" alt="image"><br><br>  Also, it will not be possible to recreate accessories that were not in the training set (note that the glasses and the handbag have disappeared): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bcb/947/66a/bcb94766a20c8e46baf8099fc1baf159.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/59e/32f/a24/59e32fa2438491ff4856d602481c263e.png" alt="image"><br><br>  And although there were only dresses in the training set, there is enough data to recreate various types of clothing, such as suits and overalls: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fd5/9f6/4f2/fd59f64f20fa7ed50cf89e65c9ce7496.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/b21/118/207/b211182072717f66c1e790b264f4e157.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ee/24c/663/8ee24c6636e12153034291a0abd27cec.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/b4c/373/b0a/b4c373b0a0f7185c8ebdf1f38c1b70a1.png" alt="image"><br><br><h4>  Using components to predict </h4><br>  I also manually grouped photos of dresses for those that I liked (287) and did not like (520 photos). <br><br>  Now, using the <a href="https://onthe.io/learn/en/category/qna/What-is-logistic-regression">logistic regression</a> in relation to the data components can predict whether I like the dress or not. <br><br>  Having sorted out the dresses according to the received estimate, we can see the most beautiful and the ugliest dresses from the whole sample. <br><br>  The most beautiful dresses: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/01c/91e/6c7/01c91e6c7985b384171e5264aa4329be.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/e02/fa6/5bd/e02fa65bd1d20ca1d4cc34f66a295432.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/bb6/7bb/f21/bb67bbf2179c6c4b1adb58893e0e485e.png" alt="image"><br><br>  And the ugliest ones: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b8c/8e6/575/b8c8e6575dc8cb47c253d6c01af66260.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/629/4bc/b93/6294bcb937f5b93eb0b15dd20bb16f48.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/00f/2c7/693/00f2c7693cf8c226bed1026114467d65.png" alt="image"><br><br>  Pretty accurate.  After that, you can come up with something that tracks new dresses posted on Amazon and sends me a catalog of suitable dresses for me. <br><br>  It is interesting to look at cases of incorrect definition.  Below are three ‚Äúthe ugliest beautiful dresses‚Äù that I defined as ‚Äúin my style‚Äù, but the program decided that I would not like them at all: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/122/f60/aca/122f60aca64bea8900856a5bfea80611.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/8ad/c8a/2dc/8adc8a2dcc2c4eb0647e86f05db5efb4.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/c70/c7d/33b/c70c7d33b6204647e25f33a835a68de4.png" alt="image"><br><br>  Perhaps this is a specific shade of blue. <br><br>  But "the most beautiful ugly dresses", which I attributed to nondescript, and the program predicted the opposite: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/886/591/a9d/886591a9d60bcc398da4dd993fb8c43a.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/2bf/f1e/74f/2bff1e74f7b043b25c68f5343d8bf20e.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/c48/ee1/485/c48ee148552dd0d4d7f596a03999b1ee.png" alt="image"><br><br>  Well, they are not so bad.  I basically like them, but I think they would look better if you change them a bit (make them less tight, remove the too-colorful pattern, choose a brighter shade). <br><br><h4>  Creating new dresses </h4><br>  When creating images, it is not necessary to limit yourself to already known combinations of components of dresses.  You can simply use random values ‚Äã‚Äãfor each component and see what happens! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6be/80b/745/6be80b745dc38087dfa4f168e024f8bf.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/398/399/13e/39839913e515a81f4e995676f18463cb.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/741/3c8/677/7413c867793274e374e8c98aa31428ba.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/cf7/bda/8cb/cf7bda8cb46581b12cf1c59d01ff11b4.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/857/acb/3fb/857acb3fb15a6be47c92a629edfde120.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/468/180/492/4681804928b126fd7ff4557eb0800202.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/d7a/2d2/015/d7a2d20156a23d3519c4a383a145b0bf.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/0be/740/318/0be740318ba1d5f103831b6167b90e16.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/0ff/031/6e6/0ff0316e62ca8001a313c9ac8aeaa731.png" alt="image"><br><img src="https://habrastorage.org/getpro/habr/post_images/4c4/07c/afc/4c407cafcd47fe57e4a7fc8d005b8bae.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/4c1/2fd/46a/4c12fd46a5a5f3089a373a5d4ec92966.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/de5/d2a/316/de5d2a3161e15adda1ac4423f334f1a5.png" alt="image"><br><br>  This is a brand new dress, invented by the program!  With a large amount and good quality data, this may be a promising tool for creating new styles of dresses!  The code can be downloaded <a href="https://github.com/graceavery/Eigenstyle">here</a> . <br><br>  So, cars already <a href="http://habrahabr.ru/company/io/blog/262267/">draw</a> pictures, write <a href="http://geektimes.ru/post/259958/">music</a> and define our style, what's next? <br><br><h4>  Abstract </h4><br><ol><li>  Any set of images can be analyzed using <a href="https://onthe.io/learn/en/category/qna/What-is-principal-component-analysis">the principal component method</a> . </li><li>  Initial sample: 807 photos of dresses from Amazon. </li><li>  The dress is the main component, other components: the length and shade of the dress, the length of the sleeve and the hair of the model, the pose of the model and others. </li><li>  Components can be used to reduce the size of the stored photos, predict and even come up with new styles. </li></ol></div><p>Source: <a href="https://habr.com/ru/post/265089/">https://habr.com/ru/post/265089/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265075/index.html">IP blacklist do-it-yourself</a></li>
<li><a href="../265077/index.html">Clustering graphs and searching for communities. Part 1: introduction, overview of tools and Hair Spheres</a></li>
<li><a href="../265079/index.html">Implementing V8 Sorted by Google</a></li>
<li><a href="../265081/index.html">Implement StyleCop in MSBuild</a></li>
<li><a href="../265083/index.html">How does the search for applications on Google Play. Abstract</a></li>
<li><a href="../265091/index.html">Migrating from 3CX v12 Cloud Server to 3CX v14 Virtual PBX Server</a></li>
<li><a href="../265093/index.html">MOOC courses in robotics</a></li>
<li><a href="../265095/index.html">Cycle optimization: blocks needed</a></li>
<li><a href="../265103/index.html">Tehnokniga, part 1: literature on web technologies, algorithms and data structures, in-depth C ++ programming</a></li>
<li><a href="../265105/index.html">Data Science Week - microanons for those who do not know</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>