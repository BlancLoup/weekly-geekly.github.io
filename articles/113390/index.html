<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Plankton Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A short note on the experience of Windows recovery automation. 

 Introduction 
 One of the jobs I currently have is accompanying a small computer par...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Plankton Windows</h1><div class="post__text post__text-html js-mediator-article">  A short note on the experience of Windows recovery automation. <br><br><h4>  Introduction </h4><br>  One of the jobs I currently have is accompanying a small computer park in a private firm.  The company's direction is retail: warehouses, a couple of supermarkets at three and four cash desks, as well as four small stores.  The contingent of users is traditional: accounting, cashiers, management.  Computers (45 in total) are geographically distant from each other, some programs (not all) need administrative rights for a number of reasons.  So just historically.  Not the point.  The network architecture and management policy of all these facilities can be described in one word: vinaigrette.  But I am a newcomer; I cannot and do not want to change the current system. <br><br><h4>  Formulation of the problem </h4><br>  It is quite clear that all this economy is destroyed over time by various trojans and viruses, the most powerful, merciless and unpredictable of which has a little different DNA from yours or mine.  Running the EXE directly from the mail marked as SPAM is one of the most innocuous activities.  Everyone is sitting on the Internet, of course (except for the box office).  Persuading and demonstrative whipping does not help any, the explanation of the term office plankton did not have the slightest effect.  Some ladies are especially vigorous.  Something needs to be done cardinal, not to drive in fact for every fact to manually restore the OS.  Moreover, there is practically no budget per se, the entire budget - savings on the possible cancellation of a KAV subscription.  Yes, and from the main work can not be distracted categorically, this is just a part-time job. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Taken measures </h4><br>  The rest is obvious in many ways.  For ordinary users, Windows is frozen using Deep Freeze purchased in the right amount (the utility has already been <a href="http://habrahabr.ru/blogs/i_recommend/27383/">described</a> on Habr√©), which allows you to get a pristine clean OS after a reboot and most importantly saves you on antivirus, firewalls and hardware updates.  You can use a similar program - it is a matter of taste.  For servers, regular system disk images are performed.  I drove mail into Google Apps, the client <a href="http://trayos.com/">trayos.com</a> - after all, GMail protects itself from viruses very well.  However, with workstations we have a number of problems.  Further, in order of increasing complexity. <br><a name="habracut"></a><br>  <u>First,</u> after the restart My documents, desktop, favorites are lost.  This trouble is treated simply.  My documents can be tritely moved to another disk, the desktop and favorites are also not a problem to register in the registry.  Favorites then it turned out and not necessary.  It is important not to transfer the entire user profile, only what is really required and, in principle, cannot participate in autoloading, otherwise the effect of freezing Windows is lost after the first virus. <br><br>  <u>Secondly, a</u> number of programs are tightly tied to the profile.  For example, the same Chrome after each reboot immediately begins to update, restore the user profile from your site and do other obscenities.  With Opera everything is even worse - the last profile is simply lost there and that's all.  It is clear that there are portable versions, but as a rule, the browser update does not work in them, and the task is to remind you of the total absence of the admin for a long time (ideally, after setting up the admin there is none at all).  In the example, only browsers, in fact, such programs are much more. <br>  In this case, all disks are converted to NTFS and the most painful directories are transferred to the neighboring logical drive from the profile.  Finally, these same directories are placed back to their original place via NTFS Junction Point: in FAR, this is Alt + F6, but of course there are more modern solutions. <br><br>  <u>Thirdly</u> , the most unpleasant problem with running programs on behalf of the administrator.  There are only 12 of them, all self-made authors are absolutely impossible to find.  The main abomination of these handicrafts is that they interact with the server under admin rights.  To rewrite them again, to train users again is not an option, it is easier to quit right away. <br>  Therefore, we need Runas, but not the usual one, but such that our office-plankton user does not enter the administrator password at every launch, and if possible he did not know it.  The solution was found in a completely unexpected (for me at least) place - JavaScript. <br>  Create a start.js file with the following content: <br><br> <code>var prg = "runas /user:Login c:\\path\\filename.exe"; <br> var WshShell = WScript.CreateObject("WScript.Shell"); <br> WshShell.Run(prg,1); <br> WScript.Sleep(250); <br> WshShell.SendKeys("p"); //    <br> WshShell.SendKeys("a"); // +,-,%,^,~,(,)      {} <br> WshShell.SendKeys("s"); <br> WshShell.SendKeys("s"); <br> WshShell.SendKeys("w"); <br> WshShell.SendKeys("o"); <br> WshShell.SendKeys("r"); <br> WshShell.SendKeys("d"); <br> WshShell.SendKeys("{.}"); <br> WshShell.SendKeys("{ENTER}");</code> <br> <br>  With JS syntax, the first line may be in single quotes, if necessary <br> <code>var prg = 'runas /user:Login "c:\\path  \\filename.exe"';</code> <br> <br>  Next, skip the resulting code through the service <a href="http://dean.edwards.name/packer/">dean.edwards.name/packer</a> or similar, we get <br><br> <code>eval(function(p,a,c,k,e,r){e=function(c){return c.toString(a)};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('k 4="b /j:lc:\\\\6\\\\7.8";9 0=3.e("3.f");0.g(4,1);3.h(i);0.2("p");0.2("a");0.2("5");0.2("5");0.2("m");0.2("o");0.2("n");0.2("d");0.2("{.}");0.2("{q}");',27,27,'WshShell||SendKeys|WScript|prg|s|path|filename|exe|var||runas|||CreateObject|Shell|Run|Sleep|250|user|ar|Login|w|r|||ENTER'.split('|'),0,{}))</code> <br> <br>  It remains to place this JS-file in the desired directory and make a launch shortcut for it.  For greater reliability, you can play around and finely try to configure NTFS, then the cunning plankton will not be able to pick out the password from here, but in my case it was not required, the admin password and so many people know.  JS obfuscation is done more for the beauty of the solution and a little bit like protecting the password from stray trojans.  This is all that is left to clear and defragment the system.  Then Deep Freeze and give it to the consumer. <br><br><h4>  Total </h4><br>  The measures described are certainly trivial, but in combination have proven to be very effective.  Half a year has passed, the flight is normal and the workstations do not even have viruses on the disk for data, they have recently scanned for interest.  I only deal with two servers, it‚Äôs not so smooth with them yet.  Attentions require weekly, but this aspect is also in the process. <br><br><h6>  02/10/2011 Results of the discussion </h6><br>  For freezing there are free alternatives to <a href="http://support.microsoft.com/kb/2390706">SteadyState.</a>  and <a href="http://www.comodo.com/home/data-storage-encryption/data-recovery.php">Comodo Time Machine</a> , and instead of RunAs, the <a href="http://www.microsoft.com/downloads/details.aspx%3FFamilyId%3D24DA89E9-B581-47B0-B45E-492DD6DA2971%26displaylang%3Den">MS App Compatibility Toolkit</a> or the <a href="http://admilink.narod.ru/">admilink</a> utility <a href="http://admilink.narod.ru/">comes in handy</a> .  Thanks to all who expressed their opinions. </div><p>Source: <a href="https://habr.com/ru/post/113390/">https://habr.com/ru/post/113390/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../113380/index.html">Kindle and its covers</a></li>
<li><a href="../113381/index.html">Indexing and searching with Xapian in .NET</a></li>
<li><a href="../113382/index.html">Texas Instruments is preparing a system-on-chip OMAP 5 with 3d support</a></li>
<li><a href="../113383/index.html">Hello again</a></li>
<li><a href="../113387/index.html">Good news for those who need HPC, HA and just an SSI cluster, finally</a></li>
<li><a href="../113392/index.html">Writing a rating module for Joomla, or AJAX in Russian</a></li>
<li><a href="../113393/index.html">Image palette clustering and PNG compression</a></li>
<li><a href="../113395/index.html">Would you be interested in the Russian Railways corporate blog about the company's IT infrastructure and technologies?</a></li>
<li><a href="../113397/index.html">Alien Dalvik to run Android applications on Maemo / MeeGo OS</a></li>
<li><a href="../113399/index.html">Natives from Google and Facebook showed an ‚Äúideal‚Äù task tracker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>