<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to draw a black hole. Geodesic ray tracing in a curved space-time</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúIt's easy. We take the Schwarzschild metric, look for the Christoffel symbols, calculate their derivative, write the geodesic equation, change some C...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to draw a black hole. Geodesic ray tracing in a curved space-time</h1><div class="post__text post__text-html js-mediator-article">  <i>‚ÄúIt's easy.</i>  <i>We take the Schwarzschild metric, look for the Christoffel symbols, calculate their derivative, write the geodesic equation, change some Cartesian coordinates (so as not to suffer), get a large multi-line ODU - and solve it.</i>  <i>Like that".</i> <br><br> <a href=""><img src="https://habrastorage.org/webt/cd/cl/gg/cdclggrnwlciaooxquus5xgfh64.jpeg"></a> <br><br>  Now it is clear that black holes sucked me.  They are infinitely exciting.  The last time I dealt with the visualization of the geometry of Schwarzschild.  I was absorbed by the problem of the exact representation of how the curvature of such a space-time affects the appearance of the sky (since photons from distant sources move along geodetic lines bent by a black hole) to create interactive modeling.  <a href="http://spiro.fisica.unipd.it/~antonell/schwarzschild/live/">Here is the result</a> (works in the browser).  Cunning in the maximum possible pre-calculation of the deflection of light rays.  Everything works more or less normally, but of course, such a simulation is far from ideal, because in reality no tracing is done there (for non-specialists: restoring the location of the light rays falling into the camera back in time). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      My new project corrects this flaw by discarding efficiency / interactivity in the simplest way: <b>it is a raytracer purely on the CPU</b> .  Tracing is performed as accurately and as long as possible.  The image rendering at the top took <s>15</s> 5 minutes (thanks, RK4) on my laptop. <br><a name="habracut"></a><br>  There is no improvement compared with similar works.  I just really like to do it.  I am writing this article to share not only the results, like the image above ( <a href="http://imgur.com/a/kocqC">especially as others did better</a> ), but also the <b>process of creating these images</b> , with a discussion / explanation of physics and implementation.  Ideally, it can inspire or become a guide for people with similar interests. <br><br>  <i><b>Look for fresh renders by <a href="http://rntnls.tumblr.com/tagged/starless">starless</a> tag on tumlr.</b></i> <br><br><h1>  Some pseudo-Riemann optics </h1><br><h2>  Shadow </h2><br>  If you have already tried my <a href="http://spiro.fisica.unipd.it/~antonell/schwarzschild/">applet</a> , then you are familiar with this picture: <br><br> <a href=""><img src="https://habrastorage.org/webt/fo/mc/vj/fomcvjrrzfk3ucsw48c5saukb04.jpeg"></a> <br><br>  It highlights the main features: a black disk and a strange ring of distortion. <br><br>  In discussions, people often pay attention: it is wrong to say that the black disk is the event horizon.  It is actually wrong to say that <i>the image area is</i> an <i>object</i> .  This is an <b>image of an</b> object.  Indeed, there are trajectories that, when tracked from your eye to the source, will be in the event horizon (HS).  These are black pixels, because no photon can travel along this path from a black hole (BH) to your eye.  Thus, this black disk very clearly represents an <b>image of the event horizon</b> , in the sense that if you draw (in the distant past) something right above the horizon, external observers will be able to see it directly on this black disk (we will actually perform this experiment later).  In some publications, this black region is also called the ‚Äúshadow‚Äù of the black hole. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e06/cb0/374/e06cb03747da9e3721e11bd227cf0b71.png"><br><br>  However, it is interesting to note that this is also the <b>image of the photon sphere</b> (FS).  The gnuplot graph at the top depicts the geodesy of incoming photons from infinity (looking at the BH from afar when zooming) along with the HS (black) and FS (green).  The radius of the photon sphere is 1.5 times larger than the radius of the event horizon (in Schwarzschild geometry) and here circular photon orbits around the BH (although unstable) are allowed.  On the graph, some rays fall into non-existence, while others are scattered (and, thus, turn out to be at another point in the celestial sphere).  It is seen that in the absorbed rays, the exposure parameter is less than ~ 2.5 radii.  This is the apparent radius of the black disk, and it is <b>much larger</b> than the HS and FS. <br><br>  In any case, the following fact is important: <br><br><blockquote>  <b>A light beam freely falling into the photon sphere will also reach the event horizon.</b> </blockquote><br>  This means that the image of the photon sphere is included in the image of the event horizon.  But since the HS is clearly located inside the FS, the image of the former should also be a subset of the latter.  Then the two images must match. <br><br>  Why do we check that the black disk is also an image of the file system?  Because it means that the <i>edge of the</i> black disk is filled with photons that <i>slide</i> along the photon sphere.  A pixel immediately outside the black disk corresponds to a photon, which (when traced back) spirals into the photon sphere, getting closer and closer to an unstable circular orbit, twisting many times (the closer you look, the faster it twists), and then spontaneously jumps out - because the orbit is unstable - and runs off to infinity. <br><br>  Such behavior will cause an interesting optical effect similar to a separatrix in a dynamical system.  Theoretically, if the beam is launched exactly along the edge, it will forever spiral into a spiral, closer and closer to the circular orbit of the photon sphere. <br><br><h2>  Influence on the sky </h2><br>  We will not dwell on this topic, because the last <a href="http://spiro.fisica.unipd.it/~antonell/schwarzschild">applet is</a> devoted to it, and it gives a much better idea of ‚Äã‚Äãthe distortions in the sky (including the UV grid option for clearer distortions). <br><br>  Just a few words about Einstein's ring.  The gravitational lens is optically distinguishable, because it is an image of a single point, which is directly opposite the observer.  The ring is formed at a viewing angle when the rays from the observer are bent in parallel.  The outer rays do not bend strongly enough and remain divergent;  inside they bend too much, converge and in reality they can even go backwards or in a circle, as we have seen. <br><br>  But think about this: if you get close enough to the black disk, the light rays can make one circle and then go parallel.  There we must see Einstein's secondary ring.  In fact, there may be rings of any order (any number of windings).  Also between them there should be ‚Äúodd‚Äù rings, where the rays of light bend in parallel, but directed towards the viewer.  This infinite series of rings exists, but it is completely invisible in our image (in fact, in most such images), because it is too close to the edge of the disk. <br><br><h2>  Distortion of the event horizon </h2><br> <a href=""><img src="https://habrastorage.org/webt/cv/zx/ml/cvzxmlbnifuyxv_thv8pdubrnfq.jpeg"></a> <br><br>  Something has changed in this new picture.  First of all, it is made in the best resolution and with background filtering to make it more distinguishable.  Then I zoomed into the BH image (without approaching, we are still at a distance of ~ 10 radii from it, just a zoom).  But most importantly, I drew a <b>grid on the horizon</b> . <br><br>  The horizon is "just a sphere."  Technically, it is not a standard Riemann sphere with a spatial metric.  The horizon is light-like!  This is a colorful way to say that it spreads at the speed of light.  However, in the Schwarzschild coordinates, it is still a surface <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.31ex" height="1.937ex" viewBox="0 -728.2 2286.1 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-3D" x="729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-31" x="1785" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> r = 1 </script>  and we can use <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-5"><span class="MJXp-mtext" id="MJXp-Span-6">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.891ex" height="2.419ex" viewBox="0 -780.1 1675.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-68" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-69" x="1330" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ phi </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-10"><span class="MJXp-mtext" id="MJXp-Span-11">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ theta </script>  as longitude and latitude.  Thus, it is possible to apply a coordinate grid in a canonical way.  You see it in the image. <br><br>  The grid allows you to see a special effect that can be derived by analyzing the photon scattering / absorption graph above: <br><br><blockquote>  <b>The entire surface of the horizon is visible simultaneously from any point.</b> </blockquote><br>  It is very interesting.  When you look at a fixed sphere in a standard flat space-time, you see no more than 50% of its surface at any given time (if you get closer, then less than 50% because of perspective).  But the horizon <b>is completely visible at the same time</b> as a black disk: pay attention, in particular, to the North and South Poles.  Nevertheless, although the entire surface fits on a black disk, <b>it does not cover it entirely</b> : if you zoom in on the edge, you will see that the image of the GE ends <i>up to the</i> end of the shadow.  You will find a ring located very close to the outer edge, but not completely.  This is the image of a point opposite the observer and it defines the boundaries of this ‚Äúfirst‚Äù image of the GE inside.  So what is between this ring and the actual edge?  I have not yet generated a zoomed image, but there <i>is another whole image of the event horizon</i> .  And then another, and one more, ad infinitum.  There are endless concentric images of the entire horizon compressed in the shadows.  <i>(Thank you very much <a href="http://www.reddit.com/user/xXxDeAThANgEL99xXx">/ u / xXxDeAThANgEL99xXx</a> for pointing out this phenomenon, which I missed)</i> . <br><br><h2>  Adding accretion disk </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/042/bf4/a2b/042bf4a2b53afda2d0c457ac6129cf06.png"><br><br>  What modern BH rendering will do without an accretion disk?  Although it is clearly a controversial question, is Nolan's Interstellar available for observation, not to mention accuracy, but we definitely have to thank the blockbuster for popularizing a particular distortion of the accretion disk.  Here we have an infinitely thin, flat, horizontal accretion disk, extending from the photon sphere (although this is very unrealistic because the orbits are lower <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mn" id="MJXp-Span-18"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-21" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.503ex" height="2.298ex" viewBox="0 -728.2 1508.4 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-33" x="0" y="0"></use><g transform="translate(500,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-53" x="638" y="-219"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-4"> 3r_S </script>  unstable, as stated below) up to 4 radii, painted in white and blue cell.  With this color, it is obvious that we are faced with another case where 100% of the object surface is visible at the same time. <br><br>  For this image, I moved the observer a little higher to look at the disk a little higher.  You see <b>images of two faces of the disk</b> : the top and bottom.  The image is bent by the arc above the BH shadow, because the beam directed directly above the black hole leans down to meet the upper surface of the disk behind the hole opposite the observer. <br><br>  This also explains the very existence of the lower image: the rays going under the BH are bent to the lower surface of the disk, which is behind the BH.  If you look closely, the image spreads throughout the shadow, but at the top it is much thinner.  This corresponds to the light rays that go above the BH, make an almost complete circle around the hole and hit the lower surface <b>in front of the</b> disk. <br><br>  Of course, it is easy to conclude that there is an infinite series of images of accretion disks, which very quickly become thinner as they approach the edge.  The image of the next order is already very thin, barely visible at the bottom of the edge. <br><br><h2>  GIFs are still relevant. </h2><br><img src="https://habrastorage.org/webt/k7/zy/3p/k7zy3pylvrumt8zolmpz6ncpnoq.gif"><br><br>  In this convulsive animation, I turn on / off the deflection of the light (formally Schwarzschild / Minkovsky) to clarify some points that we talked about. <br><br><img src="https://habrastorage.org/webt/mo/fi/sf/mofisfie5hkuarbctumls8pdnta.gif"><br><br><img src="https://habrastorage.org/webt/_j/15/iu/_j15iuuocydxwperrbtrwqrpbj0.gif"><br><br>  These two strange gifs are created at the request of readers.  In the first, the observer circles around the black hole at a distance of 10 radii.  This should not be understood as an actual orbit, since in reality there is no aberration when moving in orbit.  Here is a series of stationary BH snapshots from several points, where the observer moves from place to place between frames;  this is an ‚Äúadiabatic‚Äù orbit, if you like. <br><br><h1>  And the stereo is also still relevant </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/ac2/61b/693/ac261b693f956cd296ab4e296661dcc0.png"><br><br>  Interestingly, the shadow looks pretty flat. <br><br><h1>  Enough science </h1><br>  Enough with us informative pictures in the style of the 90s in low resolution with poisonous colors.  Here are a few "pop" renders (click for full size). <br><br> <a href=""><img src="https://habrastorage.org/webt/zn/d7/fv/znd7fvhl57ysf02onh8xa54zzm4.jpeg"></a> <br>  <i><font color="gray">This image was generated by user <a href="http://reddit.com/u/dfzxh">/ p / dfzxh</a> with fourfold oversampling.</font></i> <br><br> <a href=""><img src="https://habrastorage.org/webt/tb/7h/q0/tb7hq0cwak42zqimpr-gutaoi-y.jpeg"></a> <br>  <i><font color="gray">Larger view</font></i> <br><br> <a href=""><img src="https://habrastorage.org/webt/x0/pi/m3/x0pim3h3wadoaluz8pwy1sdivmw.jpeg"></a> <br>  <i><font color="gray">Enlarged image of the ring</font></i> <br><br> <a href=""><img src="https://habrastorage.org/webt/rc/bu/vo/rcbuvoo57-gllgwi8fgjtbgi57u.jpeg"></a> <br>  <i><font color="gray">The cult effect of the "ring of light" when viewed from the equatorial plane</font></i> <br><br> <a href=""><img src="https://habrastorage.org/webt/cd/cl/gg/cdclggrnwlciaooxquus5xgfh64.jpeg"></a> <br>  <i><font color="gray">If you download the program, then this is the current scene by default.</font></i> <br><br> <a href=""><img src="https://habrastorage.org/webt/m6/kx/bn/m6kxbn7zp3mzoqgggebacc8qrz8.jpeg"></a> <br>  <i><font color="gray">Much wider drive</font></i> <br><br>  Well, yes, nothing special.  There is no artwork here, just renders from the program.  Let's temporarily return to science: the <a href="">third image</a> , which seems to have no meaning, is actually very valuable.  This is an enlarged area between the upper edge of the black disk and the main image of the accretion disk.  The observer is on the outer edge of the accretion disk itself and zooms the picture.  The goal was to depict as many rings of different order as possible.  Three orders are visible: the brighter zone in the upper part is only the lower edge of the first image of the upper distal surface of the disk.  The strip below, under the calm sea of ‚Äã‚Äãstretching stars, is the upper part of the image of the lower front part of the disk.  At the very bottom is a thin line of light with a width of no more than a pixel glued to the black disk of the photon sphere.  This is basically the third image: the upper far surface again, but after the light has completed an additional rotation around the black hole.  Merged with him, but more and more subtle images - rings of a higher order.  Well, this is also worthy of the &lt;blockquote&gt; tag: <br><br><blockquote>  <b>Here are endless images of both the upper and lower surfaces of the accretion disk, and they all show the entire surface of the disk simultaneously.</b>  <b>Moreover, except for the very first one, these images do not pass either in front of the black disk or in front of each other, and therefore are ‚Äúconcentric‚Äù.</b> </blockquote><br>  Wonderful. <br><br>  <i><b>I accept requests for rendering</b></i> <i><br></i>  <i>Interested in a specific visualization, but not ready to go through the difficulties of installing the program and rendering yourself?</i>  <i>Just <a href="http://reddit.com/u/rantonels">email me reddit</a> or mail.</i>  <i>Rendering 1080p on my laptop takes no more than 10-20 minutes.</i> <br><br><h1>  Realistic accretion disk </h1><br>  Accretion disk in renders is quite cartoonish.  It's just a wacky texture disc.  What happens when real physics is included in the visual appearance of the disk?  What happens when you consider the redshift from the orbital motion, for example? <br><br>  A popular model of an accretion disk is an infinitely thin disk of matter in an almost circular orbit.  It starts with ISCO (the innermost stable circular orbit, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-22"><span class="MJXp-mn" id="MJXp-Span-23"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-26" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.214ex" height="2.298ex" viewBox="0 -728.2 1384 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-33" x="0" y="0"></use><g transform="translate(500,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-73" x="638" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-5"> 3r_s </script>  ) with a temperature profile according to a power law <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;">s </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-msubsup" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">r </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-34"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-36" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-37"><font style="vertical-align: inherit;">- </font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-34"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-36" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;">a</font></span></span></span></font><span class="MJXp-mtext" id="MJXp-Span-30">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-34"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-36" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-37"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.484ex" height="2.66ex" viewBox="0 -832 4513.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-54" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-73" x="1344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-69" x="1813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6D" x="2159" y="0"></use><g transform="translate(3037,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="778" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-6"> (T \ sim r ^ {- a} </script>  .  I will use a very simple option: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;">s </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;">i </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">r </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-47" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-48"><font style="vertical-align: inherit;">- </font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-47" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-49"><font style="vertical-align: inherit;">3 </font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-47" style="vertical-align: 0.5em;"><span class="MJXp-mrow" id="MJXp-Span-50"><span class="MJXp-mo" id="MJXp-Span-51"><font style="vertical-align: inherit;">/</font></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-47" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-52"><font style="vertical-align: inherit;"> 4</font></span></span></span></font><span class="MJXp-mtext" id="MJXp-Span-41">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-47" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-48"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-49"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-50"><span class="MJXp-mo" id="MJXp-Span-51"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn" id="MJXp-Span-52"><font style="vertical-align: inherit;"></font></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.176ex" height="2.66ex" viewBox="0 -1039.5 4811.7 1145.2" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-73" x="954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-69" x="1424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6D" x="1769" y="0"></use><g transform="translate(2648,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="0" y="0"></use><g transform="translate(451,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-33" x="778" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2F" x="1279" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-34" x="1779" y="0"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> T \ sim r ^ {- 3/4} </script></p><br>  which is definitely abnormal in the general theory of relativity for realistic liquids, but here it is (in any case, you will not notice the difference). <br><br>  Now the free parameter is a common scale for temperatures, for example, the temperature in ISCO.  This temperature <b>is huge</b> for most black holes.  We are talking about <b>hundreds of millions of</b> Kelvin;  It is difficult to imagine any human artifact that could <i>exist</i> if exposed to disk radiation (peak in X-rays) at such temperatures, not to mention photographing.  So we obviously need to reduce the temperature.  Obviously, supermassive black holes are colder, but not enough.  We need to go down to 10,000 K in ISCO so that we can see at least something.  This is very inaccurate, but that's all I can do. <br><br>  Two questions should be asked.  First: <b>what is the color of the</b> black body at this temperature?  Second: <b>how bright is it</b> ?  Formally, the answer to these two questions is in the scalar product of functions describing the R, G, B channels with the blackbody spectrum.  In practice, some approximations are used. <br><br>  Tanner Helland's <a href="http://www.tannerhelland.com/4435/convert-temperature-rgb-algorithm-code/">formula</a> is quite accurate and effective for color, but it includes numerous conditions that are impossible with my ray tracing (see below for more details).  The fastest way is to use a simple texture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ec/04e/a5a/7ec04ea5a9eeca4d606a11433fdc3f4e.jpg"><br><br>  This texture is one of many useful things in the Mitchell Charity compilation of <a href="http://www.vendian.org/mncharity/dir3/blackbody/">‚ÄúWhat color is black body?‚Äù</a> .  For reference, it corresponds to the white E point (whitepoint E). <br><br>  The scale shows the color of the black body at temperatures from 1000 K to 30 000 K, with higher temperatures corresponding to approximately the same shade of blue.  Since there is a huge difference in brightness between temperatures, this texture cannot transmit and does not transmit brightness;  rather, it normalizes the colors.  Our task is to calculate the relative brightness and apply it.  An analytical formula is suitable for this.  If we assume that the visible spectrum is very narrow, then the total apparent intensity is proportional to the spectrum of the black body itself: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-53"><span class="MJXp-mtext" id="MJXp-Span-54">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">c</span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mn" id="MJXp-Span-60">1</span></span><span class="MJXp-mrow" id="MJXp-Span-61"><span class="MJXp-mtext" id="MJXp-Span-62">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">d</span><span class="MJXp-msubsup" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-70" style="vertical-align: 0.5em;">5</span></span></span><span class="MJXp-mtext" id="MJXp-Span-71">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">c</span><span class="MJXp-mrow" id="MJXp-Span-76"><span class="MJXp-mn" id="MJXp-Span-77">1</span></span><span class="MJXp-mrow" id="MJXp-Span-78"><span class="MJXp-mtext" id="MJXp-Span-79">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">p</span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-84">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">c</span><span class="MJXp-mrow" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">c</span></span><span class="MJXp-mrow" id="MJXp-Span-92"><span class="MJXp-mtext" id="MJXp-Span-93">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">a</span><span class="MJXp-msubsup" id="MJXp-Span-100"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101" style="margin-right: 0.05em;">k</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-102" style="vertical-align: -0.4em;">B</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">T</span></span><span class="MJXp-mo" id="MJXp-Span-104" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-105" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-106">1</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="51.436ex" height="3.021ex" viewBox="0 -987.6 22145.9 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-31" x="2215" y="0"></use><g transform="translate(2715,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-64" x="2386" y="0"></use><g transform="translate(2909,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-35" x="748" y="583"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-66" x="6858" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="7408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="7860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-63" x="8389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-31" x="8823" y="0"></use><g transform="translate(9323,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-65" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-78" x="716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-70" x="1289" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-28" x="1792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-66" x="2432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="2982" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="3434" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-63" x="3963" y="0"></use><g transform="translate(4397,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-68" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-63" x="576" y="0"></use></g><g transform="translate(5407,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-64" x="2386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="2909" y="0"></use><g transform="translate(3439,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-42" x="737" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-54" x="4597" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-29" x="10709" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2212" x="11320" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-31" x="12321" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> \ frac {1} {\ lambda ^ 5} \ frac {1} {\ exp (\ frac {hc} {\ lambda k_B T}) - 1} </script></p><br>  where I got rid of the stupid common constants (we're still going to scale the brightness to see something).  You can simply insert <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mtext" id="MJXp-Span-108">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.987ex" height="2.057ex" viewBox="0 -780.1 3439 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-64" x="2386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="2909" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> \ lambda </script>  approximately for the visible range of the spectrum, and we obtain that the brightness is proportional to the temperature by the following formula: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-115"><span class="MJXp-mo" id="MJXp-Span-116" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-117"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-119" style="vertical-align: 0.5em;"><span class="MJXp-mtext" id="MJXp-Span-120">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">c</span><span class="MJXp-mrow" id="MJXp-Span-125"><span class="MJXp-mn" id="MJXp-Span-126">29622.4</span><span class="MJXp-mtext" id="MJXp-Span-127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">t</span><span class="MJXp-mrow" id="MJXp-Span-132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">K</span></span></span><span class="MJXp-mrow" id="MJXp-Span-134"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">T</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-137">1</span><span class="MJXp-msubsup" id="MJXp-Span-138"><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-140" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-141">‚àí</span><span class="MJXp-mn" id="MJXp-Span-142">1</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.75ex" height="3.021ex" viewBox="0 -987.6 10656.2 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-65" x="0" y="0"></use><g transform="translate(466,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-66" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="904" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="1355" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-63" x="1885" y="0"></use><g transform="translate(1639,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-39" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-36" x="1001" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-32" x="1501" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-32" x="2002" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2E" x="2502" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-34" x="2781" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="3635" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-65" x="3996" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-78" x="4463" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="5035" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-4B" x="5397" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-54" x="8605" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2212" x="7761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-31" x="8761" y="0"></use><g transform="translate(9262,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-29" x="0" y="0"></use><g transform="translate(389,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-31" x="778" y="0"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> (e ^ {\ frac {29622.4 \ text {K}} {T}} - 1) ^ {- 1} </script></p><br>  It is quite simple.  As a test, we note that the relative intensity quickly drops to zero as T approaches zero, and practically does not change when T goes to infinity. <br><br><h2>  Redshift </h2><br>  We discussed orbital velocities in the Schwarzschild geometry in the applet description.  To calculate the redshift, use the redshift formula from the SRT: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-143"><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-145">1</span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">z</span><span class="MJXp-msubsup" id="MJXp-Span-148"><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-150" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">t</span><span class="MJXp-mrow" id="MJXp-Span-155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">r</span></span><span class="MJXp-mo" id="MJXp-Span-163" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-164">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">c</span><span class="MJXp-mrow" id="MJXp-Span-169"><span class="MJXp-mn" id="MJXp-Span-170">1</span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-172">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">a</span><span class="MJXp-mtext" id="MJXp-Span-177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">s</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-182">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">a</span><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-189"><span class="MJXp-mtext" id="MJXp-Span-190">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">t</span><span class="MJXp-mrow" id="MJXp-Span-195"><span class="MJXp-mn" id="MJXp-Span-196">1</span><span class="MJXp-mo" id="MJXp-Span-197" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-198">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">t</span><span class="MJXp-msubsup" id="MJXp-Span-202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-204" style="vertical-align: 0.5em;">2</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="62.943ex" height="3.021ex" viewBox="0 -987.6 27100.3 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2B" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-7A" x="2112" y="0"></use><g transform="translate(2581,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-29" x="0" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="3320" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-65" x="3682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-78" x="4148" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="4721" y="0"></use><g transform="translate(5082,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-44" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6F" x="828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-70" x="1314" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-70" x="1817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6C" x="2321" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-65" x="2619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="3086" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-3D" x="8898" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-66" x="10204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="10755" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="11206" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-63" x="11736" y="0"></use><g transform="translate(12169,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2212" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-62" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-65" x="2402" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="2869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="3230" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-63" x="4010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-6F" x="4443" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-73" x="4929" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-28" x="5398" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="6038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-68" x="6399" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-65" x="6976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="7442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="7804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-29" x="8333" y="0"></use></g><g transform="translate(20892,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-71" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-72" x="1180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="1631" y="0"></use><g transform="translate(1993,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-2212" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-62" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-65" x="2402" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-74" x="2869" y="0"></use><g transform="translate(3230,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/423993/&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjuhW4Je5Cq-s08DORZvJ2wHVun9Q#MJMAIN-32" x="748" y="583"></use></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> (1 + z) _ \ text {Doppler} = \ frac {1 - \ beta \ cos (\ theta)} {\ sqrt {1- \ beta ^ 2}} </script></p><br>  Where as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-205"><span class="MJXp-mtext" id="MJXp-Span-206">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">s</span><span class="MJXp-mo" id="MJXp-Span-210" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-211">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">a</span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> \ cos (\ theta) </script>  Is the cosine of the angle between the direction of the beam emitted by the disk and the local speed of the disk, calculated in the local Schwarzschild local inertial coordinate system.  The formula is correct in this context due to the equivalence principle. <br><br>  It must be multiplied by the coefficient of gravitational redshift: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-218"><span class="MJXp-mo" id="MJXp-Span-219" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-220"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-221" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-223"><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-225" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-246"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-250" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-251"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-252"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-253"><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-255" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-256"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-257"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mrow" id="MJXp-Span-258"><span class="MJXp-mo" id="MJXp-Span-259"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-260"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2</font></font></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> (1 + z) _ \ text {Gravitational} = (1 - r ^ {- 1}) ^ {- 1/2} </script></p><br>  This coefficient does not depend on the trajectory of the light beam, but only on the radius of the radiation, since the Schwarzschild geometry is stationary. <br><br>  This also means that the contribution of the observer position to the gravitational redshift is constant over the entire field of view.  Our entire image has a constant total blue offset, because we are deep in BH.  Therefore, this effect gives only a faint tint that can be ignored. <br><br>  We also neglect the redshift from the movement of the observer, because our observer is stationary in the Schwarzschild geometry.  Here is the final result: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea3/9db/ced/ea39dbcedadbf6e77184f6c5436333c3.jpg"><br><br>  As you can see, most of the disk is completely white due to the maximum brightness in the color channels.  If you lower these channels to the range of 0.0-1.0, then the outer parts of the disk will become pale or black.  The increase in brightness is too great to see and appreciate.  I tried to show the effect with the help of post-processing, so that the brightest parts show the transition of colors, but this is hardly enough. <br><br>  Pretty messy picture.  Here is an image without brightness, where you can evaluate colors: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ab0/7c6/c16/ab07c6c1639bfd62a26d14e16e58599b.jpg"><br><br>  These pictures have lower resolution, because they <i>are</i> rendered on my laptop for a <i>very long time</i> (square roots are bad, children). <br><br>  In any case, this render is a thousand times less spectacular than others (mainly because the inner edge of the disc is already far enough from the GE, so that the lens is too large), but the render is at least <i>accurate</i> .  If you find a black hole with a temperature of 10,000 K and good sunglasses, you will see exactly that. <br><br>  Another shot from close range.  I unnaturally raised saturation for beauty: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a2/72c/cf7/7a272ccf75b2bf2cb90bd34f90671f26.jpg"><br><br><h1>  Writing a black hole ray tracer </h1><br><h3>  <a href="https://github.com/rantonels/starless">Source code on github</a> </h3><br>  There is a very large and obvious difference between the optics of black holes and the numerical integrator, which produces beautiful wallpapers for the desktop with a resolution of 1080p.  Last time I did not publish my reasoning, but just picked up a big and dirty git repository.  Now I want to explain a little more in detail, and also try to keep the code more accurate and with comments. <br><br>  My tracer was not created good, powerful, fast.  First of all, I wanted it to be easy to set up, so that it would be simple, so that people could get <i>inspiration</i> and see the potential for improvement: even its imperfection may lead to the fact that someone decides to write his own version.  Here is a brief overview of the algorithms and their implementation. <br><br><h2>  "Magical" potential </h2><br>  So, the general theory of relativity, everything is clear.  It is easy.  We take the Schwarzschild metric, look for the Christoffel symbols, calculate their derivative, write the geodesic equation, change some Cartesian coordinates to avoid endless suffering, get a huge multi-line ODE, solve it.  Like that. <br><br>  Just kidding.  Of course, there is one trick. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you remember, </font></font><a href="http://spiro.fisica.unipd.it/~antonell/schwarzschild/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">last time</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I derived the following equation for the orbit of a massless particle in its orbital plane in Schwarzschild geometry (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-261"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-264"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mrow" id="MJXp-Span-265"><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> r</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14">u=1/r</script>  ): <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-272"><span class="MJXp-msup" id="MJXp-Span-273"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-275" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≥</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œï </font></font></span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-282" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-283"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-284"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> u</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-287" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-15">u''(\phi) + u = \frac{3}{2} u^3</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The trick is to see </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Binet formula</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> here </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">For having a mass of Newtonian particles in the Newtonian potential of the field of central forces:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-288"><span class="MJXp-mfrac" id="MJXp-Span-289" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-292" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-296" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-297"><span class="MJXp-munderover" id="MJXp-Span-298"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-301" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-302" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-303"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> F</font></font></span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mo" id="MJXp-Span-308" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16">\frac{d^2}{dt^2} \vec x = \frac{1}{m} F(r)</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> then the particle will obviously move in its orbital plane and corresponds to the Binet formula for </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œï </font></font></span><span class="MJXp-mo" id="MJXp-Span-313" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17">u(\phi)</script>  : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-314"><span class="MJXp-msup" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-317" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≥</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-322" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-323"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-325"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-327" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-330" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> F</font></font></span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18">u'' + u = - \frac{1}{m h^2 u^2} F(u)</script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-335"><span class="MJXp-mfrac" id="MJXp-Span-336" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œï</font></font></span></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a prime number</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19">\frac{d}{d\phi}</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the mass, and</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> m </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the angular momentum per unit mass. </font><font style="vertical-align: inherit;">This is the equation for the orbit, not the equation of motion. </font><font style="vertical-align: inherit;">It says nothing about</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> h </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mo" id="MJXp-Span-346" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22">u(t)</script>  or <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , only shows the relationship between</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23">phi(t)</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> u </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-358"><span class="MJXp-mtext" id="MJXp-Span-359">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> \ phi </script>  . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's stop for a moment to think about what we actually got. </font><font style="vertical-align: inherit;">The equation says that </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">if we</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> present a hypothetical mechanical system of a particle under the action of a certain central force, then its trajectory will be a solution to the Binet formula. </font><font style="vertical-align: inherit;">Then the mechanical system becomes a formula calculation tool. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That is what I offer here. </font><font style="vertical-align: inherit;">We specified</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-366"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and took (non-physical, whatever) a simple system of a point particle in this particular force field:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26">m=1</script><font style="vertical-align: inherit;"></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-367"><span class="MJXp-mrow" id="MJXp-Span-368"><span class="MJXp-munderover" id="MJXp-Span-369"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.43em;"><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-372" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r</font></font></span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">=</font></font></span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-377" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-378"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-379"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> h</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-382" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mfrac" id="MJXp-Span-383" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-384"><span class="MJXp-munderover" id="MJXp-Span-385"><span><span class="MJXp-over"><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386"><font style="vertical-align: inherit;"> r</font></span></span></span></span></span></span></span></span></font><span class="MJXp-mfrac" id="MJXp-Span-383" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-384"><span class="MJXp-munderover" id="MJXp-Span-385"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0px; margin-right: 0px;"><font style="vertical-align: inherit;"></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386"><font style="vertical-align: inherit;"></font></span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-390" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-27">\vec F(r) = - \frac{3}{2} h^2 \frac{\hat r}{r^5}</script></p><br>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is some constant, and it is very simple to solve the equation numerically. </font><font style="vertical-align: inherit;">Then the solution</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> h </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-393"><span class="MJXp-mrow" id="MJXp-Span-394"><span class="MJXp-munderover" id="MJXp-Span-395"><span><span class="MJXp-over"><span class="" style="margin-bottom: -0.68em;"><span class="MJXp-mo" id="MJXp-Span-397" style="margin-left: 0px; margin-right: 0px; font-size: 60%;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29">\vec x (T)</script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the abstract temporal coordinate for this system; in fact, it is a parametrization of a single solution for the corresponding Binet equation,</font><b><font style="vertical-align: inherit;">which is exactly a geodesic equation</font></b><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Therefore, we solve the Newtonian equation in Cartesian coordinates, which is generally the simplest (I decided to use the Runge ‚Äì Kutta method in order to increase the step size and reduce the rendering time, but in the future the user will be able to choose a different solution method). </font><font style="vertical-align: inherit;">Then we get just the actual light-like geodesy, where</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> T </script><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is a parameter that runs along it (in contrast to the Schwarzschild one</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> T </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and from the normal time, which does not exist). </font><font style="vertical-align: inherit;">This is much better than the previous method, which worked with the polar coordinates in the orbit plane. </font><font style="vertical-align: inherit;">Here calculations are performed very effectively.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> t </script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ray tracing in numpy </font></font></h2><br>  If you look at the sources, you will see a Python script.  Horror!  Why write ray tracing in Python?  Everyone knows how <b>slow the</b> cycles are in Python, which always (almost) puts an end to work.  The fact is that we perform calculations in numpy - and in parallel.  That is why this program cannot gradually display already drawn parts on the screen: it renders everything at the same time. <br><br>  First, create an array of initial conditions.  For example, an array <code>(numPixel, 3)</code> with vectors for all image pixels (numPixel - image width √ó image height).  Then the calculation of each ray is reduced to arrays of the type <code>(numPixel, ...)</code> .  Since the operations with arrays in numpy are performed very quickly, and everything is statically typed here (I hope I‚Äôm not saying anything stupid right now), it should be calculated fairly quickly.  Maybe it's not C, but still fast.  At the same time, we have the flexibility and clarity of Python. <br><br>  This method is terrible for standard ray tracing, where objects have diffuse, reflective, refractive parts, and it is important to take the lighting conditions into account.  For example, the selective reflection of parts of an array of rays is a real nightmare;  tracking boolean values ‚Äã‚Äãor loop indices requires multiple masks, and loops cannot be split.  But here is another case: all objects in our scene only emit light: the sky, a hot accretion disk, a pitch black event horizon and bright dust.  They are not affected by the incident light, and the light itself also quietly passes through them, unless it reduces the intensity.  This leads us to the color determination algorithm: <br><br><h2>  Mixing colors </h2><br>  It's easy: you just need to mix all the objects between us and the source of the beam with their corresponding alpha values, and place them one above the other, where the furthest will be below.  We initialize the color buffer with alpha-transparent black color, then at the intersection with the object we update the buffer by mixing the color from the object <i>under</i> our color buffer.  We perform the same steps for dust (use the density profile <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-407"><span class="MJXp-msubsup" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-410" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-411"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-412"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> r ^ {- 2} </script>  ) and continue iteration to the end.  Note that the alpha channel also works as a Z-buffer, since the object stops contributing after the ray has crossed the opaque object (which thus set the alpha value of the buffer to 1.0). <br><br>  The obvious disadvantage of this method is that it is impossible to stop the ray tracing after it has been calculated, because it is part of an array where other ray tracing continues.  For example, after a collision with the horizon, the rays continue to randomly wander after they hit the singularity - you can see what happens if you explicitly turn off the horizon object.  The alpha blending algorithm ensures that they do not affect the final image, but these rays still load the CPU. </div><p>Source: <a href="https://habr.com/ru/post/423993/">https://habr.com/ru/post/423993/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423983/index.html">11 JavaScript libraries for data visualization, which should be known in 2018</a></li>
<li><a href="../423985/index.html">Roskomnadzor proposes to abolish network neutrality in 5G networks</a></li>
<li><a href="../423987/index.html">How to become a Java programmer</a></li>
<li><a href="../423989/index.html">VariFlight ADS-B - Flightradar in Chinese</a></li>
<li><a href="../423991/index.html">Apple's App Store Subscription Management Secrets</a></li>
<li><a href="../423995/index.html">Clean in the boom workshop. Part 2</a></li>
<li><a href="../423997/index.html">IT Crimea: a new technology park in Sevastopol - it will start working at the end of this year</a></li>
<li><a href="../423999/index.html">The data of Windows users on a PC with touch input is written to a separate file.</a></li>
<li><a href="../424001/index.html">Zimbra and spam protection</a></li>
<li><a href="../424003/index.html">As Apple comes out of an endless loop. Old campus stories</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>