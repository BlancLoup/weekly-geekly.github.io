<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SystemJS 0.20 - Combining with browser modules</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is a translation of the blog post by Guy Bedford - the main developer of such wonderful tools as JSPM - a package manager for browsers and NodeJS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SystemJS 0.20 - Combining with browser modules</h1><div class="post__text post__text-html js-mediator-article"><p>  <i>This is a translation of <a href="http://guybedford.com/systemjs-alignment">the</a> blog post by Guy Bedford - the main developer of such wonderful tools as <a href="http://jspm.io/">JSPM</a> - a package manager for browsers and NodeJS, which works on the basis of his brainchild <a href="https://github.com/systemjs/systemjs">SystemJS</a> - the asynchronous loader JS modules of any known formats that can deal <a href="">with cyclic dependencies</a> , and which, in turn, is based on his brainchild, called <a href="https://github.com/ModuleLoader/es-module-loader">es-module-loader</a> , a polyfile for loading ES modules.</i>  <i>As I understand it, the author pretty much rewrote SystemJS in this release, and it will be interesting to read about it to habrayamers.</i> </p><br><p>  SystemJS 0.20 has <a href="">just been released</a> - it is a complete reworking, as well as a specification correction, while the ES modules are already <a href="https://webkit.org/blog/7265/release-notes-for-safari-technology-preview-21/">right here</a> <a href="https://blogs.windows.com/msedgedev/2016/05/17/es6-modules-and-beyond/">in the browsers</a> . </p><br><p>  SystemJS was originally developed back in 2013 for the jspm project, while RequireJS was the leading module loader.  At the same time, ES6 was developing, and the ES6 modules still seemed to be an immaterial dream.  The idea of ‚Äã‚ÄãSystemJS was simple and convincing: modules come to browsers, so we need to be able to download any module at any time from the browser, which would give a very simple development process. <a name="habracut"></a></p><br><p>  With the advent of ES modules, it became clear that RequireJS is not going to stand the test of time.  Creating your own loader based on the early specification of the ES module loaders, it became possible to help get tangible feedback on the work of the specification of the module loaders, as well as to get a stable loader in the end in order to work with it later. </p><br><p>  Almost 4 years later, the project began to receive a little less than half a million downloads per month. </p><br><p>  It was always following an unstable specification, which meant permanent changes breaking compatibility, but the goal of the project was to track all of these changes.  Also, since specifications are mostly developed slowly, it was assumed that major changes would occur much less frequently than in most other projects. </p><br><p>  Basically, SystemJS 0.20 represents the next release of the adjustment specification. </p><br><p>  This post provides a summary of specification changes that have occurred lately, which will allow you to understand what to expect from the future browser specifications for loading modules, and SystemJS is right in all of this. </p><br><h2>  BOM alignment </h2><br><p> The road is almost clear for <code>&lt;script type="module"&gt;</code> and the dynamic <code>import()</code> syntaxist, thanks to the authors of the specification for this hard work. </p><br><p>  SystemJS has always been following the WhatWG bootloader specification, which actually stagnated for a while.  What we saw with <code>&lt;script type="module"&gt;</code> and dynamic <code>import()</code> are the fruits of the WhatWG bootloader, but coming from a small specification phase.  These features were always <a href="">present on the WhatWG roadmap</a> and represented a gradual refinement of the functions of the loader. </p><br><p>  Some of the features we have seen so far include: </p><br><ul><li>  <b>Modular scripts</b> : Described in the WhatWG HTML specification, implemented in Safari Preview and Edge Insider <br><br></li><li>  <b>Modular workers</b> : Described in WhatWG specification, currently being implemented <br><br></li><li>  <b>Dynamic import syntax</b> : The third stage of the TC39 specification, currently being implemented </li></ul><br><p>  Other features from the WhatWG bootloader specification, or what is still being discussed, but may appear in the future, include: </p><br><ul><li>  <b>Import Metadata</b> : Ability to get the path to the current module, something like __filename in NodeJS 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    </li><li>  <b>Resolver hooks</b> : Ability to intercept the browser script detection mechanism.  Currently, the import 'jquery' construction will fail with an error for a module script that complies with <a href="https://html.spec.whatwg.org/multipage/webappapis.html">the loading specification of WhatWG modules</a> .  The hook can add the ability to tell the browser to resolve ('lodash') -&gt; 'https://cdn.com/lodash/4.17.4/lodash.js'.  One of the great advantages of this approach is caching: the local app.js, which imports lodash, can be cached, regardless of the lodash updates. <br><br></li><li>  <b>Registry API</b> : Provides the ability to analyze and modify the URL map for namespace modules.  Allows you to specify in the registry dynamically created modules.  The registry API can also enable hot reloading of work environments (hot reloads) if dependency metadata is available. <br><br></li><li>  <b>Instantiation hook</b> : This is a hook that makes it possible to intercept the loading process and specify which module should be returned to the specified URL.  It also includes support for legacy modules in the loader ‚Äî the ability to load AMD or CommonJS modules. </li></ul><br><p>  What is missing in the above functions is the hooks "normalize, find, receive, translate and instantiate."  It became clear that this original canon would no longer be recycled or modified. </p><br><p>  SystemJS goes very close to this path, so removing these hooks is one of the project-breaking changes to the project ‚Äî you can no longer catch the <code>System.fetch</code> or <code>System.transate</code> .  Instead of <code>System[System.constructor.resolve]</code> and <code>System.instantiate[System.constructor.instantiate]</code> , only two hooks are new. </p><br><p>  In short, SystemJS 0.20 is based on the simplified assumptions of the resolver hook and the registry API in specification-based browsers.  For more precise details about these APIs, you can study the module loader project at <a href="https://github.com/ModuleLoader/es-module-loader">https://github.com/ModuleLoader/es-module-loader</a> , which carefully details all these specification solutions and trade-offs. </p><br><h2 id="sovmestimost-s-modulyami-nodejs">  Compatible with NodeJS modules </h2><br><p>  The NodeJS side has made significant progress in adopting the modules path.  The format of the SystemJS modules is largely consistent with these directions, but here there is one adjustment that is one of the biggest changes in the release that breaks compatibility. </p><br><p>  This change is that named exports will no longer be allowed when importing a CommonJS module from an ES module, and all this is discussed at <a href="https://github.com/nodejs/CTC/pull/60/files">https://github.com/nodejs/CTC/pull/60/files#diff-2b572743d67d8a47685ae4bcb9bec651R217</a> </p><br><p>  That is, the construction <code>import { name } from 'cjs.js</code> , where cjs.js is a CommonJS module - will no longer be supported, instead you will need to write <code>import cjs from 'cjs.js'; cjs.name</code>  <code>import cjs from 'cjs.js'; cjs.name</code> .  It will be a hard break, affecting NodeJS and Babel users in many places, so SystemJS is taking this punch right now. </p><br><p>  We will continue to support the <code>__esModule</code> flag in Interop, allowing you to raise named exports for similar situations. </p><br><p>  So, if the <code>cjs.js</code> module <code>cjs.js</code> written as follows: </p><br><pre> <code class="hljs delphi"><span class="hljs-keyword"><span class="hljs-keyword">exports</span></span>.__esModule = true; <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">name</span></span> = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">{ ... }</span></span></span></span></code> </pre> <br><p>  This will make it possible to get <code>import { name } from 'cjs.js'</code> , even if <code>cjs.js</code> is a CommonJS module, although in the long run it will also be eventually eliminated. </p><br><h2 id="bildy-dlya-prodakshena">  Production Builds </h2><br><p>  Since the project was reduced in size, the new production-build SystemJS was designed for optimal loading and performance on production. </p><br><p>  In the development environment, the loader deals with the problem of loading unknown modules, i.e.  we have a configuration problem - how do you get a package configuration that is not yet loaded?  And for this reason, SystemJS received a complete configuration management system, including the ability to dynamically load configurations for files in the browser as part of the resolution, almost like package.json files that are loaded into NodeJS. </p><br><p>  Removing all of these development conveniences reduces the production build to just 5KB.  This volume provides loading of the <code>System.register</code> and <code>System.registerDynamic</code> , plus it contains functions of the base URL, module paths, maps, context maps, bundles and support for the dependency cache. </p><br><h2 id="izomorfnye-brauzernye-moduli---polyfil-like-podhod">  Isomorphic browser modules - polyfil-like approach </h2><br><p>  SystemJS aims to enable polyfiles for modules as they begin to be supported by browsers, while at the same time continuing to support the main features of maps, context maps and dependency caches. </p><br><p>  For example, you might want to provide ES modules for browsers with support for ES modules, <br>  At the same time, the SystemJS loader will work in older browsers based on polyfiles. </p><br><p>  I refer to this approach as isomorphic browser modules, because using <code>System.register</code> as the module format, the polyphile version can maintain the exact semantics of the execution of the ES module in supported browsers. </p><br><p>  A demo was created at <a href="https://github.com/guybedford/isomorphic-browser-modules">https://github.com/guybedford/isomorphic-browser-modules</a> , based on the SystemJS 0.20 production build, which demonstrates how this module loading ES modules in Safari Technology Preview and returning back to SystemJS when native modules are not are supported. </p><br><h2 id="uluchsheniya-modulnyh-podhodov-razrabotki">  Improvements to modular development approaches </h2><br><p>  SystemJS continues to go along this road, optimizing loading on production and working with modules in browsers, in environments of native modules, which we hope will also continue to evolve.  One of the weaknesses of SystemJS at the moment is the lack of tools around the project from the development server to optimized production. </p><br><p>  A lot of interesting work still needs to be done in this area, and, of course, there is always room for ideas and a contribution to the ecosystem of tools. </p><br><p>  See <a href="http://www.thedotpost.com/2016/12/guy-bedford-unbundling-the-future-web-runtime">my recent conversations at the conference with DotJS</a> , where I lead a discussion about assembly optimization techniques for browsers that support ES modules. </p><br><p>  Thanks to everyone who supported and invested in the development of SystemJS.  If you have a desire to support the project in any way - we always have space for work, including <a href="https://supporterhq.com/support/user/33df4abbec4d39260f49015d2457eafe">cash donations are also welcome</a> . </p></div><p>Source: <a href="https://habr.com/ru/post/320462/">https://habr.com/ru/post/320462/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../320452/index.html">Developing a new application architecture for Uber passengers</a></li>
<li><a href="../320454/index.html">ITSM educational program: How to meet customer expectations</a></li>
<li><a href="../320456/index.html">Uncomplicated SCRUM and Image Segmentation for Highlighting Post-it Stickers</a></li>
<li><a href="../320458/index.html">Arduino on car wash</a></li>
<li><a href="../320460/index.html">Exploit Exercises: Introducing binary vulnerabilities using the example of Protostar</a></li>
<li><a href="../320464/index.html">OpenJDK 10 development begins</a></li>
<li><a href="../320470/index.html">Why did you need to develop a "Russian dropbox"</a></li>
<li><a href="../320472/index.html">Connect Xmega to FRAM over SPI</a></li>
<li><a href="../320474/index.html">Dagaz: evolution instead of revolution</a></li>
<li><a href="../320476/index.html">High Definition TK</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>