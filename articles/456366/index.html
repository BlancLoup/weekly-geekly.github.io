<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I was creating the LED HEART box</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Greetings, Habr! 

 I want to tell the story of creating a music box with elements of light illumination - a beautiful gift with the possibility of in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I was creating the LED HEART box</h1><div class="post__text post__text-html js-mediator-article">  Greetings, Habr! <br><br>  I want to tell the story of creating a music box with elements of light illumination - a beautiful gift with the possibility of individual selection of light effects and musical accompaniment.  Casket called uncomplicated - LED HEART.  What kind of work has been done, I want to share a short story on the work on this with my hobby project. <br><br>  It is no secret that in the network (including on Habr√©) you can find many projects to create LED valentines, hearts, etc.  Demo videos with them often collect flattering and rave reviews in the comments.  At the same time, the opportunity to give such an interesting gift still remained the lot of engineers, radio amateurs, etc., i.e.  people who are qualified to repeat someone‚Äôs project / make your own.  In addition, you need a lot of free time for this.  I did not meet a serial production of such a gift.  The closest is the simplest amateur soldering kits from a pair of domestic companies, and similar options presented on Chinese sites. <br>  This idea was originally and prompted to start a project to create a LED heart, which will be available not only to those who are on "you" with electronics. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I'll start a little from afar, with prehistory.  It lasted all for several years ... <a name="habracut"></a><br><br><h3>  Prehistory </h3><br>  The first video with a heart of LEDs I saw in 2010 on one of the youtube channels.  The project is impressed.  And in 2011, as a student, for a couple of weeks of work in the evenings, in secret from his girlfriend, he assembled a simple version of the LED heart, presented it on March 8th.  The project was developed by itself - and hardware and firmware - studied, invented bicycles. <br><br>  It looked ... well, something like this: <br><br><img src="https://habrastorage.org/webt/aa/ii/gz/aaiigzidhcvjjne9-iys01aj3_g.png" alt="image"><br><br><img src="https://habrastorage.org/webt/3g/w7/wk/3gw7wk6ohmy_mfadpdkomtq2aqw.jpeg" alt="image"><br><br>  No photo, unfortunately, will not fully convey the degree of gift exclusivity, which 9 years ago seemed to me unsurpassed in some places.  In the canned fish bank there was a printed circuit board with Attiny13A (in the photo, the MK is not visible, it was soldered by wiring outside - a bunch of wires extending beyond the upper limit of the photo), with shift registers and bright LEDs soldered along the outline of the heart symbol.  On the outer side of the lid of the tin can is the inscription: ‚ÄúIn your hands everything is filled with love ... and even ...‚Äù and on the inner side ‚Äú... mackerel.  Since March 8! ‚Äù.  By pressing the big red button, the lights started running, the LEDs blinked and poured in accordance with the fact that it got into 1 kilobyte of the microcontroller's memory.  Creative and romance splashing over the edge, as you can see.  As I remember now, I wander between the rows of the supermarket and think about what kind of case to choose for a ‚Äúhearty gift‚Äù ... suddenly my eyes stumble onto a shelf with canned goods ... and here it is ... enlightenment ... <br><br>  Well, a little distracted, I will continue. <br><br><h3>  The story itself </h3><br>  Having received the desired response from his future spouse, the idea settled in his head that the production and sale of such interesting gifts might make sense in principle.  Such a souvenir evokes positive emotions and symbolizes the warm feelings of the one who gives it.  But study, diploma, work, routine, personal life did not allow to allocate enough time to engage in such adventures - everything ended without starting. <br><br>  Three years have passed ... 2014 has come ... At some point, I began to stumble again on the Internet on similar projects - some of them were already more advanced and interesting - the idea to develop a unique heart version and start producing it with a new force, in the market- still nothing like that.  At the same time, obviously, people showed interest.  Having already experience in engineering, I began to approach this issue more systematically.  But still, the work on this heart was held in a hobby mode - on some evenings, and on weekends, if possible, in parallel with other hobby projects and the main work, which was in the first place in the priority of all works.  Therefore, in the end, the time frame turned out to be incredibly bloated for such a project. <br><br>  Where did the study began? <br><br>  First, the weaknesses found in the amateur constructions they saw were identified and assessed.  The most important thing then noted: <br><br><ul><li>  The lack of variety of elements of light illumination. </li><li>  The simplicity and clumsiness of the structures, which always lubricates the first impression and may not lead to the proper effect when giving.  The overwhelming majority of the considered devices looked like an amateur hand-made article, nothing more (like the type I did in 2010) - not solid, not serious, boring ... Most of the examined heart designs either have no body at all or this body is horrible - Ala jigsaw of rotten plywood, a screw in the board, the windows of the org.  glass etc.  Some kind of optimum is needed - the type of device should not at least scare people away, on the contrary - it should transmit to the maximum the whole range of feelings from the one who gives it, and at the same time - the device should not be too large, super-complex, etc. . </li><li>  The lack of sound effects of light effects in projects of hearts (with very few exceptions), although, in my opinion, it suggests itself.  Just flashing the LED matrix is ‚Äã‚Äãnot enough.  Music should enhance the effect, add romance at the time of donation.  Music can and at all be an individual feature of such a gift, it ‚Äúwarms up‚Äù the right atmosphere for the corresponding situation - romantic / solemn / fun and any other.  It has been suggested that if the effects of illumination, with all the rest, are also synchronized with the background melody, it will be very cool, convincing and cool. </li><li>  Since, according to the previous paragraph, there should be music - the idea to make a music box by itself - you open - play and sparkle - close - silence and fade away. </li></ul><br>  All these thoughts brain stormed for a while.  First I had to decide on the specific functionality of the box.  In general terms, it was seen as: <br><br><ul><li>  The heart must have an LED matrix of sufficient resolution so that you can run the ticker, do the simplest animation.  Must be the possibility of a smooth extinction and the expansion of the LEDs. </li><li> The possibility of quickly creating and correcting lighting effects should be implemented to quickly rebuild the illumination program for a specific customer.  Here it should be clarified that the model of interaction with customers implied the following.  Initially, the client is provided with a basic set of illumination programs with preset melodies, from which he selects one that best suits his wishes - then, for his part, we adjust the illumination program, adapting it for this particular person, his occasion / holiday (text of a running line, which other frames).  In the future, a gradual expansion of the base of available melodies and lighting effects was planned.  Also, for my part, I can always advise the best option after talking with the client, based on the input data.  The possibility of fully individual elaboration of the melody and illumination is not completely excluded, but at an increased cost, since  the process of drawing up a program of light effects for a new tune in any case turns out to be significantly longer than the other processes of preparing the device for sale. </li><li>  A specious body (relying so far only on your taste at the prototype stage). </li><li>  Power autonomy, because  the device is essentially a souvenir, it makes no sense to make it stationary, tied to an external source. </li></ul><br>  Further, these requirements were formalized into specific technical tasks, and one by one these tasks were gradually solved.  In the process, various materials, construction types were sorted out, circuitry was thought out, and the lion's share of time was taken by writing software, realizing the ability to quickly add / remove / edit light effects, etc. <br>  As an example of such transformations, I can offer a demonstration of the work of the intermediate version of the casket prototype, made in 2015 - can be considered as the result of iteration 1 (the video quality is terrible, the sound was superimposed separately from an mp3 file, could not adequately record it then): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/F8leTFH6pFw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  And already the final version, compiled in 2017: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/0MPJeOb9aJI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  It may seem that here the LEDs are dimmer than in the 2015 version, but this is not the case - just when shooting, there was too much light from an external source.  The sound here is already real. <br><br>  By the time this sample appeared, a lot of things had changed both from the outside, and from within the device, and in its software part. <br><br><h3>  Briefly about HW </h3><br>  The electronics of the box are located on three printed circuit boards.  On the one are the LEDs, transistors and resistors needed for the matrix switching on of the LEDs, the Atmega32A control microcontroller and its harness.  On the second board, power-on control is implemented when the box is opened, the power-off circuit with unacceptable power supply drawdown.  On the third board implemented mp3 player (purchase module). <br><br>  The case is a purchased metal box.  Inside, the entire structure is based on a plastic frame printed on a 3D printer.  Some elements are held using adhesive joints, the main board is held on magnets embedded in a plastic base. <br>  The box is powered by three AAA batteries. <br><br><h3>  SW in brief </h3><br>  For the PC, a code generator program with a graphical interface was developed that allows you to quickly create and edit lighting effects, monitor all necessary time intervals (to synchronize with the background melody) and immediately generate a code for the microcontroller firmware located on the heart board.  A specific format for writing effect parameters to data sets was developed.  On the MK side, the firmware parses these arrays and converts the desired LEDs to luminescence at the right times.  The format of recording effects in the code tables is quite economical - the internal memory of the microcontroller programs is quite enough for both the firmware code and tables with light effect parameters. <br><br>  On the solution of technical issues and problems encountered during the development, you can write a separate article.  Of course, this is not ‚Äúrocket Sains‚Äù and chewing such questions can be boring for the public, but if you are interested in someone, you can definitely be confused. <br><br><h3>  Total </h3><br>  What is the result?  The casket project can still be endlessly licked and modernized, improved in completely different directions, add functionality, etc.  But in the form in which the box was conceived - it was made, the design project was completed.  For (small) mass production, some more work needs to be done, but this is a matter of technology, as they say. <br><br>  Somewhere in the middle of the road, it was realized that trying to independently develop the commercial component of the project is not very interesting for me, there is neither time nor great desire for it.  There was no person who would take over most of the sales organization work, work with melodies and lighting effects in my environment.  With such a potential partnership, I agreed to close all technical issues, production, procurement and logistics.  But it did not work out.  And the time is constantly busy with other tasks - either more interesting, or simply necessary / everyday. <br><br>  Therefore, at the moment I consider the project completed at this stage.  In total, 3 copies of the latest version were made - two for gifts to relatives and one copy made to order.  It may happen that the story will continue in some form, I will not blame, but at the moment the status is.  In general, the result of the work I was satisfied.  But the most valuable is the reaction of close people, to whom the first samples of the heart were intended, for this it would not be a pity to spend as much time as you like! <br><br>  Well, in terms of the rationality of such a project, objective conclusions were made, lessons were learned that will surely serve me in future affairs and accomplishments! <br><br>  Thank you, if you have read it, always happy to talk in the comments, if you have questions, comments, suggestions. </div><p>Source: <a href="https://habr.com/ru/post/456366/">https://habr.com/ru/post/456366/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456352/index.html">Wireless communication module with a WISE-4000 object</a></li>
<li><a href="../456354/index.html">How we collect set-top boxes</a></li>
<li><a href="../456358/index.html">13 most mined articles last year</a></li>
<li><a href="../45636/index.html">Usability vs marketing</a></li>
<li><a href="../456362/index.html">Level 6 designer: how we motivate and develop designers</a></li>
<li><a href="../456368/index.html">Perform public and private transactions on the JPMorgan Quorum blockchain using Web3</a></li>
<li><a href="../456370/index.html">QoS implementation in Qsan storage</a></li>
<li><a href="../456372/index.html">SimbirSoft invites IT-specialists to the Summer Intensive-2019</a></li>
<li><a href="../456374/index.html">Plasma Cash blockchain status data structures</a></li>
<li><a href="../456376/index.html">Not a single spring boot: review alternatives</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>