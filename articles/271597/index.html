<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Corporate phishing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Phishing emails in a corporate environment usually mark a targeted attack , well thought out and implemented. Unlike ordinary users, employees of comp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Corporate phishing</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/d4e/144/feb/d4e144feb34e4edd8f4da17fffb22764.png"><br><br>  Phishing emails in a corporate environment usually mark a <a href="https://www.pentestit.ru/labs/corp-lab">targeted attack</a> , well thought out and implemented.  Unlike ordinary users, employees of companies can be instructed properly about the existing threats to information security.  For e-mail messages, one or another control may be established by the IT / IB staff of the departments. <a name="habracut"></a><br><br><h2>  Prelude </h2><br>  Phishing emails aimed at ordinary users are usually little ‚Äúpersonalized‚Äù; only the user's email can be substituted for attracting attention.  In the area of ‚Äã‚Äãattacks on corporate systems, phishing is preceded by a thorough collection and analysis of information about the object and subjects of attack, horizontal communications, possible areas of responsibility and authority.  This is necessary for the development of a well-thought-out sociotechnical scenario and the addition of details that make it possible to put down the vigilance of the recipients of the letter. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Currently, the percentage of targeted phishing attacks that are organized through emails is growing, in which a particular organization or group of individuals can be identified.  Target users receive carefully crafted phishing emails that force a person to enter more sensitive personal information ‚Äî such as a username and password, that give access to corporate networks or databases with critical information.  In addition to requesting credentials, targeted phishing emails can also contain malware.  For example, when you press a certain key, programs can be loaded to track everything that the victim will enter using the keyboard. <br><br><blockquote>  Under the usual scenario, the penetration into the system began with a phishing mailing.  Since here we are dealing with a targeted attack, the phishing mailing was as much as possible adapted for a specific recipient.  As Bruce Schneier <a href="https://www.schneier.com/blog/archives/2013/03/phishing_has_go.html">noted</a> , this is not just phishing, but phishing with a ‚Äúlaser sight‚Äù. <br><br>  In this case, the letters were intended for US officials who were sent to Copenhagen for a conference on climate change.  They received malicious files in the mail.  Characteristically, the letters were titled "China and Climate Change", and the return address was a fake address of the famous journalist National Journal who specializes in articles on the international economy.  This fact alone indicates that the attackers carefully thought out the attack and calculated that the addressees must necessarily open the attached file. <br><br>  Additionally, the body of the letter contained comments that create the impression that the document is directly related to the work duties of the officials. </blockquote><br>  Targeting phishing campaigns requires more time and money from cybercriminals than with traditional phishing campaigns.  Fraudsters must access or steal lists of valid email addresses for the target organization or group of individuals, and then create believable letters that are highly likely to attract recipients and they will provide their personal data.  However, if successful, the financial return on targeted phishing can be much higher, so the investment pays off. <br><br><blockquote>  What is common in high-profile stories about data leakage from leading retailer systems Target and Neiman Marcus, the health insurance giant Anthem and Sony Pictures?  They all began with a carefully planned targeted phishing attack using emails.  Documents infected with malware were attached to the letters.  However, they all looked quite normal and were addressed to specific employees within the organization. </blockquote><br>  Acupuncture phishing has become the most common type of targeted attack for one simple reason: this technique really works, misleading even those users who are serious about security.  It creates for hackers a strong point for penetrating the corporate network.  According to a Check Point survey conducted among more than 10,000 organizations worldwide, 84% of them have downloaded at least one infected document in the past 12 months.  This happens because an attacker simply needs to get an idea of ‚Äã‚Äãthe company or its specific employees on the Internet, and then write a letter that will cause even the most vigilant employee to open a malicious attachment and thereby initiate a hacker attack. <br><br><h2>  Collection of information </h2><br>  Information is collected from public sources using <a href="https://github.com/laramies/theHarvester">specialized</a> <a href="http://www.paterva.com/web6/products/maltego.php">tools</a> , <a href="https://www.exploit-db.com/google-hacking-database/">queries in search engines</a> , <a href="https://www.shodan.io/">specialized services</a> , analysis of company profiles in social networks and on job sites.  Such a collection of information can be correlated with the <a href="https://ru.wikipedia.org/wiki/OSINT">OSINT</a> methodology (Open Source Intelligence - intelligence based on an analysis of open sources of information).  The larger, more accurate (at least two or three sources) and more relevant information - the higher the success of the attack. <br><br>  Use <a href="https://github.com/laramies/theHarvester">theHarvester</a> utility to collect domain and postal address information: <br><br><img src="https://habrastorage.org/files/de5/36c/a86/de536ca866f04f9789b8ee40d61ece6d.png"><br><br>  Using the <a href="https://bitbucket.org/LaNMaSteR53/recon-ng">recon-ng</a> utility to collect information from social networks: <br><br><img src="https://habrastorage.org/files/212/8f3/079/2128f3079da343409968ebe9e8eef6c5.png"><br><br>  Using specialized <a href="https://www.robtex.com/">services</a> to obtain information: <br><br><img src="https://habrastorage.org/files/568/335/0b5/5683350b5a4242bf9781e7a410ace94e.png"><br><br><h2>  Analysis of the information received </h2><br>  After intelligence and information gathering, attackers verify the information obtained.  This may be a phone call, sending an e-mail message - to confirm the accuracy.  Also, the detected services (subdomain mail.example.site) are checked for the formation of phishing login forms. <br><br>  With the victim, you can enter into correspondence to find out the version of the possible software, IP addresses, antivirus software - all this can be extracted from the service headers and the body of the letter: <br><br><img src="https://habrastorage.org/files/07f/2d4/d1e/07f2d4d1e76c406c851f2e4a6c0fbb32.png"><br><br><h2>  Attack script formation </h2><br>  To form a phishing script, attackers can register a fake domain: <br><br><img src="https://habrastorage.org/files/799/36a/c25/79936ac2597d4c85821fb555bb65ce50.png"><br><br>  Attackers can create a fake login page at: <br><ul><li>  Corporate website; </li><li>  mail subdomain (or folder); </li><li>  corporate portal; </li><li>  CRM system; </li><li>  technical services (bugtracker, etc.) </li></ul><br><img src="https://habrastorage.org/files/317/7c1/992/3177c1992d434649aaeec67825870c96.png"><br><br><img src="https://habrastorage.org/files/4f7/f90/392/4f7f903924db41378a187e1cf13826d9.png"><br><br><h2>  Attack implementation </h2><br>  Phishing emails sent to large lists of addresses are developed taking into account social engineering methods.  For example, this could be content that requires a specific action from the recipient, as well as the inclusion of links to websites that look plausible (say, fraudulent online banking services websites).  However, in the e-mail messages of this type, personal data is very rarely used.  At the same time, thanks to targeted phishing emails, social engineering has taken a new level. By addressing the recipient by name and sending the letter directly to his or her address, the attackers inevitably increase the degree of trust in the malicious email and the fake websites that the victim is redirected to. <br><br>  For the attack, a targeted email is created containing personalized information and a link to the phishing site.  Mailing can be made from a fake website or using available (unclosed) <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25B9">smtp realy</a> to fake the sender's address. <br><br>  Basic vectors: <br><ul><li>  mail delivery error; </li><li>  a technical error; </li><li>  a message containing a link to a large amount of attachment / invalid format, etc .; </li><li>  messages from legislative / executive authorities; </li><li>  court decisions. </li></ul><br>  Errors of displaying the content and links in the letter are made in order to force the user to leave the mail program (if he uses it).  Also, these messages can lead to a known user, but a compromised resource - attacks of this class are called <a href="https://en.wikipedia.org/wiki/Watering_Hole">watering hole</a> . <br><br>  But the lion's share of phishing messages is made up of malicious files (the user may not know his password, or authorization on resources occurs through <a href="https://ru.wikipedia.org/wiki/LDAP">LDAP</a> , etc.), modified <a href="https://ru.wikipedia.org/wiki/RAT">RAT</a> and office documents containing macros with this or that functionality. <br><br>  An example of forming a back-connect shell using the macros of an office suite and powershell: <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/RnGNdMJCc-s%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700190,15700248,15700253&amp;usg=ALkJrhi8xio72e86fDqAI9DSr6dKqSTk2Q" frameborder="0" allowfullscreen=""></iframe><br><br><h2>  Cases from practice </h2><br>  Examples and types of attacks depend directly on the target chosen by the attackers, it is quite difficult to give specifics, therefore, as a dessert, a couple of examples from the practice of our company and our colleagues. <br><br><blockquote>  Phishing mailing was made to one of the financial organizations.  Employees' addresses were extracted using SQL injection from the developed CRM in one of the subdomains.  Corporate mail has been set up for gmail.  The phishing message contained a link to a similar resource and the gmail login form.  Cherry on the cake was embedded in this page iframe - the code of one of the known <a href="https://en.wikipedia.org/wiki/Blackhole_exploit_kit">bundles of exploits</a> .  Those.  in addition to the exploitation of the sociotechnical vector, an additional vector was implemented in the form of exploiting browser vulnerabilities and their components.  The attack allowed attackers to gain control on some accounts. </blockquote><br><blockquote>  An email containing a malicious program in the form of a <a href="https://ru.wikipedia.org/wiki/Portable_Executable">.scr</a> file was sent to one organization.  <a href="https://otvet.mail.ru/question/36775728">The zero patient</a> who downloaded and launched the malware did not see any obvious signs of its work and tried to do it several more times.  After that, he sent this investment to his colleagues with the remark ‚ÄúI can‚Äôt open it, try it, can it open?‚Äù The victim himself initiated a pandemic of viral activity in the corporate environment. </blockquote><br><h2>  Protection </h2><br>  Nowadays, more and more sophisticated methods are being used to force the victim to follow links to certain websites, where people unwittingly leave malicious information to attackers or download malicious software onto their computer.  Most spam emails now contain URLs to which recipients navigate to malicious websites.  At the same time, fraudulent websites where victims are sent look exactly the same as their legally valid counterparts. <br><br>  According to a study conducted at the University of California at Berkeley, even those who have long and often use the Internet sometimes fall for scammers and go to their websites.  To protect themselves against phishing websites, users should use a comprehensive verification strategy for the likely level of confidence in the content, monitor the address bar and security settings in it, pay attention to the image of the lock in the browser window and the security certificate of each website to which the user is redirected. <br><br>  As measures of protection, it is necessary to establish control over email attachments and links, <a href="https://www.pentestit.ru/labs/corp-lab">conduct trainings with personnel about the presence of new threats</a> , observe precautions and notify all suspicious cases to technical personnel. <br><br><hr>  Previous article: <a href="http://habrahabr.ru/company/pentestit/blog/271123/">phishing email examples</a> . </div><p>Source: <a href="https://habr.com/ru/post/271597/">https://habr.com/ru/post/271597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271587/index.html">Microsoft has withdrawn the updated Windows 10 from the download portal</a></li>
<li><a href="../271589/index.html">IBM Watson taught to discuss world-class problems</a></li>
<li><a href="../271591/index.html">Centralized Email Alerts</a></li>
<li><a href="../271593/index.html">Micro-conference UX-Environment ‚Ññ26: Design Education in Russia</a></li>
<li><a href="../271595/index.html">Cisco Switch and Hewlett Packard Enterprise Switch Virtualization Technologies</a></li>
<li><a href="../271601/index.html">Intensive German: how ABBYY Compreno teaches new languages</a></li>
<li><a href="../271605/index.html">EOIP & DD-WRT for connecting two apartments into one network or all for Remote Play</a></li>
<li><a href="../271611/index.html">YouTube Phenomenon: Thinking Locally to Be Global</a></li>
<li><a href="../271621/index.html">About programmers</a></li>
<li><a href="../271625/index.html">Blend4Web. Event system</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>