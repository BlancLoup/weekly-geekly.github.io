<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cryptographic strength 1000-fold password hashing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The discussion about the cryptographic strength of repeated use of a hash over a password (which slipped, by the way, in other forums), which has rise...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cryptographic strength 1000-fold password hashing</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/habraeffect/1e/ca/1ecaa4c452a18907744113e5341fc1f4.jpg"><br><br>  The discussion about the cryptographic strength of repeated use of a hash over a password (which slipped, by the way, in other forums), which has risen in <a href="http://habrahabr.ru/blogs/crypto/100138/">this topic</a> , pushed me to this somewhat mathematical topic.  The essence of the problem arises from the idea of ‚Äã‚Äãrepeatedly (1,000 or more times) processing a password before storing with any crypto-resistant algorithm (most often a hash function) in order to get a <b>slow</b> verification algorithm, thereby effectively opposing brute force in case of an interception or theft values.  As hrat users of <a href="http://habrahabr.ru/users/scratch/" class="user_link">Scratch</a> (the author of the first article), <a href="http://habrahabr.ru/users/mrthe/" class="user_link">mrThe</a> and <a href="http://habrahabr.ru/users/ilyapodkopaev/" class="user_link">IlyaPodkopaev</a> quite rightly noted, the idea is not new and developers of the equipment of Cisco, the RAR archiver and many others use it.  But, since hashing is an operation that compresses a set of values, a completely natural question arises - will we not harm the stability of the system?  Attempt to answer this question - <a name="habracut"></a><br><br>  Reduction of resilience will be considered in two threat models: <ol><li>  the attacker bans random input byte sets in the hope of finding a collision due to the narrowing of the value space (‚Äúfull brute force‚Äù); </li><li>  bust through the dictionary. </li></ol><br>  Let's start with the first, more theoretical, question: <b>‚Äúcan such a huge space of values ‚Äã‚Äãof a modern hash function <sup>2,128</sup> (MD5), 2,160 (SHA-1), <sup>2,256</sup> (GOST R 34.11, SHA-256) narrow as a result of repeated use to the extent that a collision with it can be picked up by a simple random search? ‚Äù</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Start </h4><br>  One of the main properties / requirements for crypto-resistant hash functions is a very good uniformity of distribution of output results.  This makes it possible to operate in the estimates required by ordinary probability theory and combinatorics. <br><br>  Let us take an input set of <i>N</i> elements and, in the output set, also of <i>N</i> objects, randomly assign an element to each of its objects (see the figure).  It is obvious that several mappings will be shown on identical elements, and, therefore, there will be elements that are not matched by any arrows: <br><br><img src="https://habrastorage.org/storage/habraeffect/de/45/de4515460615c8c1dfe857fd5211915b.gif"><br><br>  The probability that a particular element of the output set will NOT be chosen by a specific display (arrow) is equal to <img src="https://habrastorage.org/storage/habraeffect/49/62/4962826133e51b21a06a8b0c2f95c756.gif">  accordingly, the probability that it will NOT be selected by any of the <i>N</i> arrows is equal to <img src="https://habrastorage.org/storage/habraeffect/71/bc/71bc2c8760889f52bfbb8fe39c2f5ccf.gif">  or what is the same <img src="https://habrastorage.org/storage/habraeffect/f2/32/f232e63b0f8971f770f8718e4e2f6b04.gif">  (thanks to the property of crypto-resistant hash function, all <i>N</i> mappings are independent events in the first approximation). <br><br>  Limit <img src="https://habrastorage.org/storage/habraeffect/d5/0c/d50ccd6bb97c3c743cc7023950d62031.gif">  is a consequence of the second remarkable limit and is equal to <img src="https://habrastorage.org/storage/habraeffect/f6/06/f606094030d04ecef5f256e134fe0304.gif">  i.e.  approximately 0.3679.  This is the probability that the element in the output set will "turn gray."  At the same time, we note that for large <i>N</i> (greater than 2 <sup>32</sup> ) the degree of ‚Äúdegradation‚Äù does not depend on the digit capacity of the hash function.  As a result, after the first repetition of hashing, only about 63% will remain from the value space.  If everything goes further, it will be a catastrophe - in only 150 iterations we will ‚Äúeat‚Äù 100 bits of the output space, leaving, for example, for MD5 only <sup>2,128-100</sup> = 2 <sup>28</sup> options.  Fortunately, it is not. <br><br><h4>  In detail </h4><br>  As soon as the input set begins to be filled out completely (that is, after the second iteration in the first threat model or immediately in the second threat model (with a dictionary attack)), other formulas and other patterns begin to work.  This is clearly seen in the same figure for the case if there were only 3 ‚Äúactive‚Äù elements in the input set.  The probability of ‚Äúlosing‚Äù an element (narrowing the output set) decreases sharply, since  now far less often two or more mappings are found on the same element. <br><br><img src="https://habrastorage.org/storage/habraeffect/c4/64/c464023bee09cdfd1ed3ff2947c957c4.gif"><br><br>  Let only <i>kN</i> elements be active in the input set, where <i>0 &lt;k &lt;1</i> .  Then the probability of not choosing a particular element is <img src="https://habrastorage.org/storage/habraeffect/d6/68/d668ad05c6d396f901e170fc2cc6c0fd.gif">  that by the same consequence <img src="https://habrastorage.org/storage/habraeffect/92/de/92de59ed5c5060d642a27619446ca3a2.gif">  , and the narrowing of the output set on this iteration will be only <img src="https://habrastorage.org/storage/habraeffect/b9/06/b906b198893cbdff761f83a7bcea3c59.gif">  .  Here is a table of the first 6 iterations: <br><br><table><tbody><tr><th>  Iteration number, i </th><th>  The proportion of the set of values, k </th></tr><tr><td>  one </td><td>  1.0000 </td></tr><tr><td>  2 </td><td>  0.6321 </td></tr><tr><td>  3 </td><td>  0.4685 </td></tr><tr><td>  four </td><td>  0.3740 </td></tr><tr><td>  five </td><td>  0.3120 </td></tr><tr><td>  6 </td><td>  0.2680 </td></tr></tbody></table><br>  Of course, the share of active elements continues to decrease with each iteration, but not as quickly and catastrophically as at the very beginning. <br><br>  In order to assess the degree of reduction of resistance for a large number of iterations, it is more convenient to study not the number <i>k</i> itself, but the opposite to it ‚Äî how many times the output set has been reduced, and right away on the base 2 log scale, so that the units of measurement are bits: <img src="https://habrastorage.org/storage/habraeffect/80/28/802883cfb5f0e8bb364e1bbc6c0c8885.gif">  .  It is this number that will characterize the reduction in the resistance to full enumeration - it must be subtracted from the bit width of the selected hash function in order to get the bit depth equivalent to the stable hash function.  The graph of <i>r</i> up to 50.000 iterations is shown in the figure: <br><br><img src="https://habrastorage.org/storage/habraeffect/19/18/1918ce1934f69cac3fe9f7443685089d.gif"><br><br>  The points at which the graph intersects the integer values ‚Äã‚Äãof <i>r</i> are summarized in the table: <br><br><table><tbody><tr><th>  Reduced durability r (bit) </th><th>  Number of iterations, i </th></tr><tr><td>  four </td><td>  thirty </td></tr><tr><td>  five </td><td>  61 </td></tr><tr><td>  6 </td><td>  125 </td></tr><tr><td>  7 </td><td>  253 </td></tr><tr><td>  eight </td><td>  509 </td></tr><tr><td>  9 </td><td>  1.020 </td></tr><tr><td>  ten </td><td>  2.044 </td></tr><tr><td>  eleven </td><td>  4.092 </td></tr><tr><td>  12 </td><td>  8.188 </td></tr><tr><td>  13 </td><td>  16.379 </td></tr><tr><td>  14 </td><td>  32.763 </td></tr><tr><td>  15 </td><td>  65.531 </td></tr><tr><td>  sixteen </td><td>  131.067 </td></tr><tr><td>  ... </td><td>  ... </td></tr><tr><td>  20 </td><td>  2.097.146 </td></tr><tr><td>  ... </td><td>  ... </td></tr><tr><td>  24 </td><td>  33.554.425 </td></tr></tbody></table><br>  As you can see, the decrease in durability from a certain point increases very slowly.  Moreover, the number of iterations exactly follows the powers of two: <img src="https://habrastorage.org/storage/habraeffect/2d/c1/2dc13f545a3e55747ef10a7b5555fb92.gif">  .  In all cases when similar patterns are observed, they can be proved analytically, but I did not set it as my goal.  Thus, without reducing the robustness of the algorithm to more than 16 bits (and in my firm conviction for 128-bit hash functions, this does not affect their practical strength for the next 25 years, for example), you can perform 130.000 password hash iterations.  For 256-bit hash functions (SHA-256, GOST R 34.11, RIPEMD-256, etc.), obviously, this bar is still many times higher. <br><br><h4>  Validation of the model </h4><br>  As always, after a large number of theoretical speculations, there is a desire to at least somehow assess how far the obtained theory is from practice.  As a test hash function, I took the first 16 bits from MD5 (a crypto-resistant hash function allows you to select any set of result bits to form a truncated hash function with similar properties, although, of course, less persistence - according to its new bit depth).  All possible values ‚Äã‚Äãfrom 0 to 0xFFFF are input to the algorithm, <i>i</i> iterations are performed over each of the values, each iteration consists in calculating the first 16 bits of the MD5 result (a 16-bit hash function is obtained).  "The results of the experiments" are given in the table: <br><br><table><tbody><tr><th>  Planned decrease in durability, r (bit) </th><th>  Number of iterations, i </th><th>  The expected number of elements in the set </th><th>  The observed number of elements in the set </th></tr><tr><td>  four </td><td>  thirty </td><td>  2 <sup>16-4</sup> = 4.096 </td><td>  3.819 </td></tr><tr><td>  6 </td><td>  125 </td><td>  2 <sup>16-6</sup> = 1.024 </td><td>  831 </td></tr><tr><td>  eight </td><td>  509 </td><td>  2 <sup>16-8</sup> = 256 </td><td>  244 </td></tr></tbody></table><br>  Of course, with such a small value of <i>N</i> and especially <i>kN</i> , the fact that all the calculations above are given for limits (for <i>N</i> comparable and large <sup>2,128</sup> , everything is good) is immediately apparent.  But even here, the general trend is traced and acceptably fit into the formulas obtained above. <br><br><h4>  Corollary - resistance to dictionary attack </h4><br>  The time has <b>come to</b> analyze <b>whether ‚Äúthe narrowing of the range of meanings is perceptible in those cases when a vocabulary or easily constructed password is chosen as a passphrase?‚Äù</b> .  Obviously, in this case the ‚Äúactive‚Äù input set of values ‚Äã‚Äãis already extremely narrowed - it depends on the selection methods in the range from 2 <sup>16</sup> to 2 <sup>48</sup> .  Thus, we immediately find ourselves in a ‚Äúdischarged‚Äù situation - in the right side of the graph.  Here, the probability of displaying two different input elements on the same output is extremely small.  Millions and millions of operations practically do not change the number of elements in the output set at all.  Units / tens are eliminated - there is no question of any practical reduction in the persistence of speech. <br><br><h4>  findings </h4><br>  The described scheme of protection against brute force can be freely applied in practice with virtually no restrictions on the part of cryptographic security.  The recommended upper limits for the number of iterations (the allowed decrease in the stability of <i>r is</i> chosen subjectively in the amount <sup>of</sup> <sub>1/8</sub> digits of the hash function) are given in the table: <br><br><table><tbody><tr><th>  Hash function bit (bits) </th><th>  Permitted decrease in durability, r (bit) </th><th>  The upper limit of the allowed number of iterations, i </th></tr><tr><td>  128 </td><td>  sixteen </td><td>  130.000 </td></tr><tr><td>  160 </td><td>  20 </td><td>  2,000,000 </td></tr><tr><td>  192 </td><td>  24 </td><td>  32.000.000 </td></tr><tr><td>  224 </td><td>  28 </td><td>  500.000.000 </td></tr><tr><td>  256 </td><td>  32 </td><td>  8.000.000.000 </td></tr></tbody></table></div><p>Source: <a href="https://habr.com/ru/post/100301/">https://habr.com/ru/post/100301/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../100291/index.html">Google Apps for Government</a></li>
<li><a href="../100293/index.html">Facebook can be bought for $ 65 per share.</a></li>
<li><a href="../100295/index.html">Internet for musicians and lovers of exclusive: an overview of the possibilities</a></li>
<li><a href="../100296/index.html">PacMan in the browser</a></li>
<li><a href="../100297/index.html">Review of Android-tablet RoverPad for 7990 p</a></li>
<li><a href="../100302/index.html">Yahoo! Japan has signed an agreement with Google</a></li>
<li><a href="../100307/index.html">Designer Mimobot flash drives, are they worth their money?</a></li>
<li><a href="../100311/index.html">Wrong money. The story of a startup - part III</a></li>
<li><a href="../100312/index.html">Apple updated iMac, Mac Pro, LED Cinema Display and introduced Magic Trackpad, Battery Charger</a></li>
<li><a href="../100316/index.html">From Russia with a torrent: online viewing of torrents and not only</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>