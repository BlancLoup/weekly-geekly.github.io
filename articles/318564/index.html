<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating chthonic monsters, document</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Under this saying-meme, taken from the wonderful picture of Vladimir Filonov , every person who has at least a remote attitude to programming will put...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating chthonic monsters, document</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/11c/a6c/b46/11ca6cb46335472bb4ebe4a67512e884.png" alt="ioninja" align="right"><br><p>  Under this saying-meme, taken from the wonderful picture of <a href="https://www.facebook.com/pyhoster">Vladimir Filonov</a> , every person who has at least a remote attitude to programming will put his signature.  <strong>The whole question is how?</strong>  How exactly to document something? </p><br><p>  The following text has several goals: </p><br><ol><li>  To give a brief overview (read - a little pogundet on the topic) the poor state of the toolkit applicable to the chthonic monsters of the world C / C ++; </li><li>  Offer your <strong>alternative solution</strong> (free-without-SMS-and-registration - the project is non-commercial and is available on GitHub under the MIT-license); </li><li>  Encourage the community <strong>to chat</strong> and gather ideas; </li><li>  Invite to <strong>join the</strong> project <strong>development</strong> on GitHub. </li></ol><br><p>  Immediately, I‚Äôll make a reservation that although the project was created primarily as an alternative, or rather, the addition of Doxygen for Sishik and plus APIs, it is equally suitable <strong>for other languages</strong> .  This allows you to create portals for documentation of diverse libraries - the libraries themselves can be written in different languages, and the documentation will show the unity of style in appearance and behavior. </p><br><p><br clear="all"></p><a name="habracut"></a><br><h2>  Motivation </h2><br><p>  By and large, there are exactly two approaches to documenting APIs and libraries ‚Äî plus or not. </p><br><ul><li>  The first is <strong>to write everything with pens</strong> . </li></ul><br><p>  It doesn't even matter what - in Help &amp; Manual, RoboHelp, Word or another editor.  Despite the fact that this traditional way is clear to everyone and is still widely used, I am deeply convinced that it is fundamentally wrong.  The fact is that it generates documentation, which is irrelevant all the time and <strong>lags behind the documentation object</strong> .  Support for <em>consistency</em> between separately created, and often also different people, documentation, and the library API, which is constantly evolving - only dead or frozen products do not evolve!  - This is a huge task, only slightly easier to write primary documentation. </p><br><ul><li>  The second, the <em>‚Äúright‚Äù</em> approach, is to <strong>generate the</strong> source <strong>documentation</strong> automatically. </li></ul><br><p>  A specially trained parser runs through the source code, isolates specially designed <strong>comments with documentation,</strong> and builds the structure of the API public announcement tree.  After that, the documentation is generated in the right format - I, as I suppose, the majority are primarily interested in HTML and PDF.  The main advantage of this approach is the <strong>guaranteed coherence of</strong> ads in the source code of the API and in the final documentation.  Even with the complete absence in the source code of meaningful comments with the actual <em>‚Äúdocumentation‚Äù</em> , at the end we will have an excellent <strong>snapshot of the</strong> library's <strong>API status</strong> , with the ability to ‚Äújump‚Äù over declarations and type descriptions, etc. </p><br><p>  So, with your permission, I will concentrate on the <em>"right"</em> approach with autogeneration.  What options do we have here?  Alas, for the documentation of C / C ++, there are at present <strong>very sadly little</strong> used and really used: <a href="http://www.stack.nl/~dimitri/doxygen">Doxygen</a> and <a href="http://doc.qt.io/qt-5/qdoc-index.html">QDoc</a> .  And with these two, too, not everything goes smoothly. </p><br><p>  <strong>Doxygen</strong> is the first truly successful project to extract comments from the code on the pluses and turn them into HTML documentation with hyperlinks, pictures of inheritance graphs, calls, etc.  Unlike its direct parent, the pioneer of Doc ++, who has never received enough distribution, Doxygen is now the <strong>de facto standard for</strong> documenting C / C ++ code.  And all this would be great if it were not for the two "but": </p><br><ul><li>  The standard HTML generated by doxigen, however more softly to say ... <strong>not burdened with elegance</strong> . </li></ul><br><p> Of course, there is a place for subjectivism.  I fully admit that there are not so picky people in the world who are completely satisfied with the doxigen exhaust (I would venture to suggest, however, that there will not be professional designers among them).  But even if the default doxigen HTML suits someone from a visual point of view (and seriously, there are those who really <em>like it aesthetically</em> ? Write in the comments!), Very often you want to change and customize something that <strong>goes beyond the CSS twisting</strong> - for example, put declarations in <code>&lt;pre&gt;</code> and place indents and spaces in accordance with the coding-style adopted in this particular library.  This brings us to the second, more fundamental Doxygen problem: </p><br><ul><li>  During its long life, Doxygen has not grown real, <strong>modular customization</strong> . </li></ul><br><p>  Yes, there is a <code>Doxyfile</code> with a bunch of variables, it is possible to change the HTML headers and CSS, but architecturally - everything is <strong>coarse</strong> into a monolithic C ++ core!  Moreover, the front-end, namely, the source parsers, and the back-end are HTML, PDF, RTF and other generators (among which, thank heaven, there is also XML). </p><br><p>  <strong>QDoc</strong> defaults to much, much <strong>prettier HTML</strong> than Doxygen.  Unfortunately, if something is <em>not</em> needed <em>by default</em> , then QDoc suffers from the same innate hardness as Doxygen (growing, of course, from the same <del>  well ... </del>  hardness of both the parser and the generator into a monolithic positive core).  In addition to its woodenness, QDoc, unlike Doxygen, has <strong>only one input parser</strong> ‚Äî for the QT dialect of C ++ (with all <code>Q_OBJECT</code> , <code>Q_PROPERTY</code> , <code>foreach</code> , etc., strictly interpreted as keywords).  And at the same time, - which is absolutely not in any gate, - does not know how to generate PDF! </p><br><h2>  Alternative </h2><br><p>  It is proposed to replace one tool with a <strong>conveyor</strong> .  Instead </p><br><pre> <code class="bash hljs">Doxygen -&gt; (HTML, PDF, ...)</code> </pre> <br><p>  ... we will use the following pipeline: </p><br><pre> <code class="bash hljs">Doxygen -&gt; (XML) -&gt; -&gt; - -&gt; (reStructuredText) -&gt; -&gt; Sphinx -&gt; (HTML, PDF, ...)</code> </pre> <br><h2>  What do we leave old? </h2><br><p>  Developers know how to get used to documenting C / C ++ code with <strong>Doxygen comments</strong> : </p><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/*! \brief This is a brief documentation for class Foo. This is a detailed documentation for class Foo. ... */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre> <br><p>  Why invent a new syntax?  We will write the documentation in the same way as before! </p><br><p>  Doxygen is able to pull out documentation from sources and put it together with the tree of declarations in an XML database.  Perfectly!  This will be our <strong>front-end</strong> . </p><br><p>  It is even easier to answer the question of what to use as a <strong>back-end</strong> - of course, <a href="http://www.sphinx-doc.org/">Sphinx</a> .  <strong>Sphinx</strong> deservedly received enormous distribution as a tool for writing technical documentation.  It produces very <strong>tasty looking HTML</strong> with support for full-blown themes (and not just CSS!), Can glue everything into one HTML sheet, generate documentation in PDF, EPUB and many other formats - all from the box!  But most importantly, it is <strong>fully customizable</strong> using Python scripts, and they can be used both for tuning the appearance and for expanding the input language (which reStructuredText is for Sphinx) - namely, to add your directives and then use them in the documentation . </p><br><p>  It remains to make friends Doxygen and Sphinx. </p><br><h2>  Build a bridge </h2><br><p>  I note that I'm not the first to try to build a <strong>bridge between Doxygen and Sphinx</strong> .  The relative fame acquired project <a href="https://github.com/michaeljones/breathe">breathe</a> , written in Python as an extension for Sphinx.  At the moment, the project is not too actively picking a screwdriver, and, alas, out of the box is not suitable for serious tasks.  Architecturally, it is structured as follows: it parses the XML exhaust of doxigen and creates the reStructuredText nodes of the tree in memory directly. </p><br><p>  I decided to go a little different way.  <strong>Doxyrest</strong> - this is the name of our bridge - parses the Doxigen <code>.xml</code> files, and then gives the parsed XML and the set of template files to the template <strong>engine</strong> (template processor).  The template engine generates files with <strong>reStructuredText</strong> , and already these <code>.rst</code> files are transferred to the Sphinx-back-end for receiving the final documentation in the specified format. </p><br><p>  The main feature is, of course, the use of a template engine.  This allows <strong>you</strong> to <strong>fully customize the structure of the</strong> documentation: change the order and group the documented objects (classes / functions / properties, etc.), customize the style of declarations (where and how to use indents, spaces, line breaks, etc.), use arbitrary logic Difficulties to include or not include this particular object in the documentation, and so on - and all this <strong>without recompilation</strong> , just by editing the input templates! </p><br><p>  But the main thing is that the template approach allows Doxyrest to be used for the absolute majority of any <strong>other languages</strong> , and in particular, for various DSL - for which no one will ever make specialized documentation systems.  Doxygen can't parse your language?  They took a language compiler, added a generation of Doxygen-like XML to an already existing AST, then corrected the templates of the output <code>.rst</code> files - so that the declarations in the documentation were with the correct syntax - that's all!  Your language can now be documented with the help of Doxygen-comments and receive beautiful Sphinx-documentation at the output. </p><br><p>  At the moment, <strong>Lua is</strong> used for templating (simply because I already had a ready-made and debugged Lua string templates library), but in theory nothing prevents me from adding support to other templating languages. </p><br><p>  Templates look and work like this: </p><br><pre> <code class="lua hljs"> Title ===== %{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> } This text will be excluded.. %{ <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-comment"><span class="hljs-comment">-- if for i = 1, 3 do } * List item $i %{ end -- for }</span></span></code> </pre> <br><p>  At the exit we will have: </p><br><pre> <code class="bash hljs"> Title ===== * List item 1 * List item 2 * List item 3</code> </pre><br><h2>  Examples of using </h2><br><p>  Better to see once than hear a hundred times.  Therefore, instead of concluding, I decided to simply provide links to the <strong>results of the Doxyrest work</strong> applied to different languages: </p><br><ul><li>  <a href="http://docs.tibbo.com/jancy/stdlib">Jancy Standard Library Reference</a> (Jancy language) </li><li>  <a href="http://docs.tibbo.com/jancy/api">Jancy C API Reference</a> (C language) </li><li>  <a href="http://docs.tibbo.com/ioninja/api">IO Ninja API Reference</a> (Jancy language) </li><li>  <a href="http://docs.tibbo.com/axl/manual">AXL Library Reference</a> (C ++ language) </li></ul><br><p>  Despite the incompleteness of the substantive part of the documentation on the links above (the actual descriptions of classes, functions, etc.), all this should be enough to demonstrate the efficiency of the method. </p><br><p>  Project page on GitHub: <a href="http://github.com/vovkos/doxyrest">http://github.com/vovkos/doxyrest</a> </p><br><p>  The project is laid out under one of the most unstrict licenses in the world - <strong>The MIT License</strong> .  See, try, join the development.  And I will be happy to answer all the questions in the comments. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/318564/">https://habr.com/ru/post/318564/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318554/index.html">Azure-IaaS-Digest number 12 (November-December)</a></li>
<li><a href="../318556/index.html">DNS servers ntp.org not available</a></li>
<li><a href="../318558/index.html">Interactive results table</a></li>
<li><a href="../318560/index.html">How to choose a country to enter the international market and test the demand</a></li>
<li><a href="../318562/index.html">Artificial Intelligence "World of the Wild West" HBO: then and now</a></li>
<li><a href="../318568/index.html">Another Docker Home Media Server</a></li>
<li><a href="../318570/index.html">Basic models of mobile navigation</a></li>
<li><a href="../318572/index.html">Chinese Jovision cameras and their OEM clones. Security hoax</a></li>
<li><a href="../318576/index.html">How to become the first in sports programming: ITMO University shares experience. Part 2</a></li>
<li><a href="../318578/index.html">3CX V15 SP4 - New Features and Release Candidate Versions for Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>