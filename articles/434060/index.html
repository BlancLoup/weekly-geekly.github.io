<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Should I save the length of the array to a local variable in C #</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Very often I notice that people write like this: 



var length = array.Length; for (int i = 0; i < length; i++) { //do smth }
 , CLR Array.Length. .
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Should I save the length of the array to a local variable in C #</h1><div class="post__text post__text-html js-mediator-article">  Very often I notice that people write like this: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> length = array.Length;
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length; i++) {
    <span class="hljs-comment"><span class="hljs-comment">//do smth</span></span>
}</code></pre><br>
      ,       CLR        Array.Length.                     .<br>
<a name="habracut"></a><br>
      C#:<br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithoutVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; array.Length; i++) {
        sum += array[i];
    }
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum;
}
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = array.Length;
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length; i++) {
        sum += array[i];
    }
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum;
}</code></pre><br>
    ,    JIT     .NET Framework 4.7.2  LegacyJIT-x86:<br>
<table>
<tbody><tr>
<td>WithoutVariable()<br>
<font color="#666666">;int&nbsp;sum&nbsp;=&nbsp;0;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
<font color="#666666">;int&nbsp;i&nbsp;=&nbsp;0;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
<font color="#666666">;int[]&nbsp;localRefToArray&nbsp;=&nbsp;this.array;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;int&nbsp;arrayLength&nbsp;=&nbsp;localRefToArray.Length;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;if&nbsp;(arrayLength&nbsp;==&nbsp;0)&nbsp;return&nbsp;sum;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">test</font>&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ecx</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jle</font>&nbsp;&nbsp;exit<br>
<font color="#666666">;int&nbsp;arrayLength2&nbsp;=&nbsp;localRefToArray.Length;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font>&nbsp;<br>
<font color="#666666">;if&nbsp;(i&nbsp;&gt;=&nbsp;arrayLength2)</font><br>
<font color="#666666">;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfRangeException();</font><br>
&nbsp;&nbsp;<font color="#00007f">loop</font><font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">eax</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jae</font>&nbsp;&nbsp;056e2d31<br>
<font color="#666666">;sum&nbsp;+=&nbsp;localRefToArray[i];</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#46aa03">esi</font><font color="#339933">*</font><font color="#ff0000">4</font><font color="#339933">+</font><font color="#ff0000">8</font><font color="#009900">]</font><br>
<font color="#666666">;i++;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">inc</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><br>
<font color="#666666">;if&nbsp;(i&nbsp;&lt;&nbsp;arrayLength)&nbsp;goto&nbsp;loop</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jg</font>&nbsp;&nbsp;<font color="#00007f">loop</font><br>
<font color="#666666">;return&nbsp;sum;</font><br>
&nbsp;&nbsp;exit<font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font></td>
<td>WithVariable()<br>
<font color="#666666">;int&nbsp;sum&nbsp;=&nbsp;0;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
<font color="#666666">;int[]&nbsp;localRefToArray&nbsp;=&nbsp;this.array;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;int&nbsp;arrayLength&nbsp;=&nbsp;localRefToArray.Length;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;int&nbsp;i&nbsp;=&nbsp;0;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">eax</font><br>
<font color="#666666">;if&nbsp;(arrayLength&nbsp;==&nbsp;0)&nbsp;return&nbsp;sum;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">test</font>&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jle</font>&nbsp;&nbsp;exit<br>
<font color="#666666">;int&nbsp;arrayLength2&nbsp;=&nbsp;localRefToArray.Length;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;if&nbsp;(i&nbsp;&gt;=&nbsp;arrayLength2)</font><br>
<font color="#666666">;&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfRangeException();</font><br>
&nbsp;&nbsp;<font color="#00007f">loop</font><font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ecx</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jae</font>&nbsp;&nbsp;05902d31<br>
<font color="#666666">;sum&nbsp;+=&nbsp;localRefToArray[i];</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#46aa03">eax</font><font color="#339933">*</font><font color="#ff0000">4</font><font color="#339933">+</font><font color="#ff0000">8</font><font color="#009900">]</font><br>
<font color="#666666">;i++;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">inc</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><br>
<font color="#666666">;if&nbsp;(i&nbsp;&lt;&nbsp;arrayLength)&nbsp;goto&nbsp;loop</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jl</font>&nbsp;&nbsp;&nbsp;<font color="#00007f">loop</font><br>
<font color="#666666">;return&nbsp;sum;</font><br>
&nbsp;&nbsp;exit<font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font></td>
</tr>
</tbody></table><br>
<div class="spoiler"><b class="spoiler_title">   Meld</b><div class="spoiler_text"><img src="https://habrastorage.org/webt/gc/4s/mi/gc4smi2gsptfuyqiuwyizrv2q80.png"><br>
</div></div><br>
 ,       ‚Äî 15 .        .              .  ,             :<br>
<br>
<ul>
<li>   0 (<b>arrayLength</b>);</li>
<li>         (<b>arrayLength2</b>);</li>
</ul><br>
,           ,           .<br>
<br>
               :<br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithoutVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; array.Length; i++) {
        sum += array[i] + array.Length;
    }
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum;
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WithVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = array.Length;
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; length; i++) {
        sum += array[i] + length;
    }
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum;
}</code></pre><br>
      ,         ,         .      :<br>
<table>
<tbody><tr>
<td>WithoutVariable()<br>
<font color="#00007f">int</font>&nbsp;sum&nbsp;=&nbsp;<font color="#ff0000">0</font><font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
<font color="#00007f">int</font>&nbsp;i&nbsp;=&nbsp;<font color="#ff0000">0</font><font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
<font color="#00007f">int</font><font color="#009900">[</font><font color="#009900">]</font>&nbsp;localRefToArray&nbsp;=&nbsp;this<font color="#339933">.</font>array<font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#00007f">int</font>&nbsp;arrayLength&nbsp;=&nbsp;localRefToArray<font color="#339933">.</font>Length<font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">ebx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
if&nbsp;<font color="#009900">(</font>arrayLength&nbsp;==&nbsp;<font color="#ff0000">0</font><font color="#009900">)</font>&nbsp;return&nbsp;sum<font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">test</font>&nbsp;<font color="#46aa03">ebx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ebx</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jle</font>&nbsp;&nbsp;exit<br>
<font color="#00007f">int</font>&nbsp;arrayLength2&nbsp;=&nbsp;localRefToArray<font color="#339933">.</font>Length<font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
if&nbsp;<font color="#009900">(</font>i&nbsp;&gt;=&nbsp;arrayLength2<font color="#009900">)</font><br>
&nbsp;&nbsp;throw&nbsp;new&nbsp;IndexOutOfRangeException<font color="#009900">(</font><font color="#009900">)</font><font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;<font color="#00007f">loop</font><font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ecx</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jae</font>&nbsp;&nbsp;05562d39<br>
<font color="#00007f">int</font>&nbsp;t&nbsp;=&nbsp;array<font color="#009900">[</font>i<font color="#009900">]</font><font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#46aa03">esi</font><font color="#339933">*</font><font color="#ff0000">4</font><font color="#339933">+</font><font color="#ff0000">8</font><font color="#009900">]</font><br>
t&nbsp;<font color="#339933">+</font>=&nbsp;sum<font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
t<font color="#339933">+</font>=&nbsp;arrayLength<font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ebx</font><br>
sum&nbsp;=&nbsp;t<font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">eax</font><br>
i<font color="#339933">++</font><font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">inc</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><br>
if&nbsp;<font color="#009900">(</font>i&nbsp;&lt;&nbsp;arrayLength<font color="#009900">)</font>&nbsp;goto&nbsp;<font color="#00007f">loop</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">ebx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jg</font>&nbsp;&nbsp;&nbsp;<font color="#00007f">loop</font><br>
return&nbsp;sum<font color="#666666">;</font><br>
&nbsp;&nbsp;exit<font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
</td>
<td>WithVariable()<br>
<font color="#00007f">int</font>&nbsp;sum&nbsp;=&nbsp;<font color="#ff0000">0</font><font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
<font color="#00007f">int</font><font color="#009900">[</font><font color="#009900">]</font>&nbsp;localRefToArray&nbsp;=&nbsp;this<font color="#339933">.</font>array<font color="#666666">;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#00007f">int</font>&nbsp;arrayLength&nbsp;=&nbsp;localRefToArray<font color="#339933">.</font>Length<font color="#666666">;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">ebx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#00007f">int</font>&nbsp;i&nbsp;=&nbsp;<font color="#ff0000">0</font><font color="#666666">;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ecx</font><br>
if&nbsp;<font color="#009900">(</font>arrayLength&nbsp;==&nbsp;<font color="#ff0000">0</font><font color="#009900">)</font>&nbsp;<font color="#009900">(</font>return&nbsp;sum<font color="#666666">;)&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">test</font>&nbsp;&nbsp;<font color="#46aa03">ebx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ebx</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jle</font>&nbsp;&nbsp;exit<br>
<font color="#00007f">int</font>&nbsp;arrayLength2&nbsp;=&nbsp;localRefToArray<font color="#339933">.</font>Length<font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
if&nbsp;<font color="#009900">(</font>i&nbsp;&gt;=&nbsp;arrayLength2<font color="#009900">)</font><br>
&nbsp;throw&nbsp;new&nbsp;IndexOutOfRangeException<font color="#009900">(</font><font color="#009900">)</font><font color="#666666">;</font><br>
&nbsp;<font color="#00007f">loop</font><font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jae</font>&nbsp;&nbsp;04b12d39<br>
<font color="#00007f">int</font>&nbsp;t&nbsp;=&nbsp;array<font color="#009900">[</font>i<font color="#009900">]</font><font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#46aa03">ecx</font><font color="#339933">*</font><font color="#ff0000">4</font><font color="#339933">+</font><font color="#ff0000">8</font><font color="#009900">]</font><br>
t&nbsp;<font color="#339933">+</font>=&nbsp;sum<font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
t<font color="#339933">+</font>=&nbsp;arrayLength<font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ebx</font><br>
sum&nbsp;=&nbsp;t<font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">eax</font><br>
i<font color="#339933">++</font><font color="#666666">;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">inc</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><br>
if&nbsp;<font color="#009900">(</font>i&nbsp;&lt;&nbsp;arrayLength<font color="#009900">)</font>&nbsp;goto&nbsp;<font color="#00007f">loop</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ebx</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jl</font>&nbsp;&nbsp;&nbsp;<font color="#00007f">loop</font><br>
return&nbsp;sum<font color="#666666">;</font><br>
&nbsp;&nbsp;exit<font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
</td>
</tr>
</tbody></table><br>
<div class="spoiler"><b class="spoiler_title">   Meld</b><div class="spoiler_text"><img src="https://habrastorage.org/webt/co/8z/ix/co8zixjrk_p7fexmgmyhs1xfqqa.png"><br>
</div></div><br>
           ,             .   ,    sum    array.Length,     .    :<br>
<blockquote><font color="#00007f">int</font>&nbsp;arrayLength2&nbsp;=&nbsp;localRefToArray<font color="#339933">.</font>Length<font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
if&nbsp;<font color="#009900">(</font>i&nbsp;&gt;=arrayLength2<font color="#009900">)</font>&nbsp;throw&nbsp;new&nbsp;IndexOutOfRangeException<font color="#009900">(</font><font color="#009900">)</font><font color="#666666">;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jae</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;04b12d39</blockquote>    ‚Äî              .<br>
<br>
<i>      ,             , ..     .            .</i><br>
<br>
    ForEach.   :<br>
<br>
<pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForEachWithoutLength</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> array) {
        sum += i;
    }
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum;
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForEachWithLengthWithoutLocalVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> array) {
        sum += i + array.Length;
    }
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum;
}

<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ForEachWithLengthWithLocalVariable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sum = <span class="hljs-number"><span class="hljs-number">0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = array.Length;
    <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> array) {
        sum += i + length;
    }
    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum;
}</code></pre><br>
      JIT:<br>
<br>
<div class="spoiler"><b class="spoiler_title">ForEachWithoutLength()</b><div class="spoiler_text"><font color="#666666">;int&nbsp;sum&nbsp;=&nbsp;0;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
<font color="#666666">;int[]&nbsp;localRefToArray&nbsp;=&nbsp;this.array;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;int&nbsp;i&nbsp;=&nbsp;0;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">edx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edx</font><br>
<font color="#666666">;int&nbsp;arrayLength&nbsp;=&nbsp;localRefToArray.Length;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;if&nbsp;(arrayLength&nbsp;==&nbsp;0)&nbsp;goto&nbsp;exit;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">test</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jle</font>&nbsp;&nbsp;exit<br>
<font color="#666666">;int&nbsp;t&nbsp;=&nbsp;array[i];</font><br>
&nbsp;&nbsp;<font color="#00007f">loop</font><font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#46aa03">edx</font><font color="#339933">*</font><font color="#ff0000">4</font><font color="#339933">+</font><font color="#ff0000">8</font><font color="#009900">]</font><br>
<font color="#666666">;sum+=i;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">eax</font><br>
<font color="#666666">;i++;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">inc</font>&nbsp;&nbsp;<font color="#46aa03">edx</font><br>
<font color="#666666">;if&nbsp;(i&nbsp;&lt;&nbsp;arrayLength)&nbsp;goto&nbsp;loop</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edx</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jg</font>&nbsp;&nbsp;<font color="#00007f">loop</font><br>
<font color="#666666">;return&nbsp;sum;</font><br>
&nbsp;&nbsp;exit<font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font></div></div><br>
<div class="spoiler"><b class="spoiler_title">ForEachWithLengthWithoutLocalVariable()</b><div class="spoiler_text"><font color="#666666">;int&nbsp;sum&nbsp;=&nbsp;0;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
<font color="#666666">;int[]&nbsp;localRefToArray&nbsp;=&nbsp;this.array;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">edx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edx</font><br>
<font color="#666666">;int&nbsp;arrayLength&nbsp;=&nbsp;localRefToArray.Length;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;if&nbsp;(arrayLength&nbsp;==&nbsp;0)&nbsp;goto&nbsp;exit</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">test</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jle</font>&nbsp;&nbsp;exit<br>
<font color="#666666">;int&nbsp;t&nbsp;=&nbsp;array[i];&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;<font color="#00007f">loop</font><font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#46aa03">edx</font><font color="#339933">*</font><font color="#ff0000">4</font><font color="#339933">+</font><font color="#ff0000">8</font><font color="#009900">]</font><br>
<font color="#666666">;sum+=i;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">eax</font><br>
<font color="#666666">;sum+=localRefToArray.Length;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;i++;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">inc</font>&nbsp;&nbsp;<font color="#46aa03">edx</font><br>
<font color="#666666">;if&nbsp;(i&nbsp;&lt;&nbsp;arrayLength)&nbsp;goto&nbsp;loop&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edx</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jg</font>&nbsp;&nbsp;<font color="#00007f">loop</font><br>
<font color="#666666">;return&nbsp;sum;</font><br>
&nbsp;&nbsp;exit<font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font></div></div><br>
<div class="spoiler"><b class="spoiler_title">ForEachWithLengthWithLocalVariable()</b><div class="spoiler_text"><font color="#666666">;int&nbsp;sum&nbsp;=&nbsp;0;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font><br>
<font color="#666666">;int[]&nbsp;localRefToArray&nbsp;=&nbsp;this.array;&nbsp;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">ecx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;int&nbsp;length&nbsp;=&nbsp;localRefToArray.Length;&nbsp;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">ebx</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">xor</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ecx</font><br>
<font color="#666666">;int&nbsp;arrayLength&nbsp;=&nbsp;localRefToArray.Length;&nbsp;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#ff0000">4</font><font color="#009900">]</font><br>
<font color="#666666">;if&nbsp;(arrayLength&nbsp;==&nbsp;0)&nbsp;goto&nbsp;exit;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">test</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">edi</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jle</font>&nbsp;&nbsp;exit<br>
<font color="#666666">;int&nbsp;t&nbsp;=&nbsp;array[i];&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;<font color="#00007f">loop</font><font color="#339933">:</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#0000ff">dword</font>&nbsp;ptr&nbsp;<font color="#009900">[</font><font color="#46aa03">edx</font><font color="#339933">+</font><font color="#46aa03">ecx</font><font color="#339933">*</font><font color="#ff0000">4</font><font color="#339933">+</font><font color="#ff0000">8</font><font color="#009900">]</font><br>
<font color="#666666">;sum+=i;&nbsp;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">eax</font><br>
<font color="#666666">;sum+=length&nbsp;;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">add</font>&nbsp;&nbsp;<font color="#46aa03">esi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ebx</font><br>
<font color="#666666">;i++;&nbsp;</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">inc</font>&nbsp;&nbsp;<font color="#46aa03">ecx</font><br>
<font color="#666666">;if&nbsp;(i&nbsp;&lt;&nbsp;arrayLength)&nbsp;goto&nbsp;loop</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">cmp</font>&nbsp;&nbsp;<font color="#46aa03">edi</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">ecx</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">jg</font>&nbsp;&nbsp;<font color="#00007f">loop</font><br>
<font color="#666666">;return&nbsp;sum;</font><br>
&nbsp;&nbsp;exit<font color="#339933">:</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00007f">mov</font>&nbsp;&nbsp;<font color="#46aa03">eax</font><font color="#339933">,</font>&nbsp;<font color="#46aa03">esi</font></div></div><br>
      ,     ,     for (       foreach 12 ,  for 15).<br>
<br>
<div class="spoiler"><b class="spoiler_title">  For  ForEach</b><div class="spoiler_text"><img src="https://habrastorage.org/webt/mw/ga/qy/mwgaqykzztnhwmztdcg4ns5thwa.png"><br>
</div></div><br>
  ,    for vs foreach  1 000 000  ,      <br>
<br>
<pre><code class="cs hljs">sum+=array[i];</code></pre><table>
<tbody><tr>
<td>Method</td>
<td>ItemsCount</td>
<td>Mean</td>
<td>Error</td>
<td>StdDev</td>
<td>Median</td>
<td>Ratio</td>
<td>RatioSD</td>
</tr>
<tr>
<td>ForEach</td>
<td>1000000</td>
<td>1.401 ms</td>
<td>0.2691 ms</td>
<td>0.7935 ms</td>
<td>1.694 ms</td>
<td>1.00</td>
<td>0.00</td>
</tr>
<tr>
<td>For</td>
<td>1000000</td>
<td>1.586 ms</td>
<td>0.3204 ms</td>
<td>0.9447 ms</td>
<td>1.740 ms</td>
<td>1.23</td>
<td>0.65</td>
</tr>
</tbody></table>  <br>
<br>
<pre><code class="cs hljs">sum+=array[i] + array.Length;</code></pre><table>
<tbody><tr>
<td>Method</td>
<td>ItemsCount</td>
<td>Mean</td>
<td>Error</td>
<td>StdDev</td>
<td>Median</td>
<td>Ratio</td>
<td>RatioSD</td>
</tr>
<tr>
<td>ForEach</td>
<td>1000000</td>
<td>1.703 ms</td>
<td>0.3010 ms</td>
<td>0.8874 ms</td>
<td>1.726 ms</td>
<td>1.00</td>
<td>0.00</td>
</tr>
<tr>
<td>For</td>
<td>1000000</td>
<td>1.715 ms</td>
<td>0.2859 ms</td>
<td>0.8430 ms</td>
<td>1.956 ms</td>
<td>1.13</td>
<td>0.56</td>
</tr>
</tbody></table>ForEach      For.   ?        JIT.<br>
<br>
<div class="spoiler"><b class="spoiler_title">     foreach</b><div class="spoiler_text"><img src="https://habrastorage.org/webt/ae/wx/5s/aewx5szyufp55plv9zsq2wznplq.png"><br>
</div></div><br>
  ForEachWithoutLength.                   .      ForEach -     ,  -       . -  JIT           .<br>
<br>
     ForEachWithLengthWithoutLocalVariable.          ,  sum+=length        arrayLength,   ,       . ,         N + 1,  N ‚Äî  .<br>
<br>
   ForEachWithLengthWithLocalVariable.       ForEachWithLengthWithoutLocalVariable,     .      arrayLength,        ,           length         . ,            .             .<br>
<br>
           .     ,       ,             ,       :              .  , ,  Foreach       For.</div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/434060/">https://habr.com/ru/post/434060/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../434050/index.html">Java Enterprise vs Android in 2019 - what to choose a newbie?</a></li>
<li><a href="../434052/index.html">BLACK HAT conference. How to make a spy phone. Part 1</a></li>
<li><a href="../434054/index.html">BLACK HAT conference. How to make a spy phone. Part 2</a></li>
<li><a href="../434056/index.html">Need to know where to put zero</a></li>
<li><a href="../434058/index.html">A technical presentation of the new SpaceX spacecraft Starship / BFS from SpaceX is planned in March-April 2019</a></li>
<li><a href="../434062/index.html">Amazon sent Alexa's 1,700 audio recordings to a random person.</a></li>
<li><a href="../434172/index.html">We are looking for the killer on the Prologue</a></li>
<li><a href="../434174/index.html">Genetics of the Romanesco variety: a fractal mathematical model of gene expression</a></li>
<li><a href="../434176/index.html">Getting ready to investigate incidents</a></li>
<li><a href="../434178/index.html">How the service provider did its Service Desk</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>