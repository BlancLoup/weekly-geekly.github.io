<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Low automation, or how to send two bytes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Something about me 
 I do industrial automation. Literally from head to ass, i.e. from the field level (sensors / actuators) to the top (PLC programmi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Low automation, or how to send two bytes</h1><div class="post__text post__text-html js-mediator-article"><h4>  Something about me </h4><br>  I do industrial automation.  Literally from head to ass, i.e.  from the field level (sensors / actuators) to the top (PLC programming / SCADA development).  It so happened that most of all I was doing the setup, but the last year was mostly development.  In addition, for me, software and hardware are divided into Siemens and everything else. <br><br><h4>  about the project </h4><br>  The essence of the project is to update the automation systems at a fairly large number of pumping stations (water and sewage).  In addition to the update itself, the task was to collect and transmit the current values ‚Äã‚Äãof a number of parameters to a common control room for centralized archiving and monitoring.  Geographically, all this economy is located in the Lower Galilee, in Israel. <br>  At the time of the start of work, automation tools at different stations were a very diverse zoo: from ET-200S CPU controllers at more recent stations to relay logic for older ones.  Currently, Siemens, Twido (Schneider), Koyo, GE Fanuc controllers are working at different stations. <br>  It turned out that this project is formally implemented by Schneider Electric, our company is a subcontractor.  This determined the choice of SCADA for control room (Vijeo Citect) and controllers for stations where their replacement is required. <br><br><a name="habracut"></a><br><h4>  Features and Difficulties </h4><br>  And there are not so many of them.  The main and almost the only one is how to transfer technological information from stations that are sufficiently distant from each other to the control center.  For this purpose, a system from <a href="http://www.realiteq.com/">Realiteq</a> was used.  The idea is quite simple: the company sells its devices (Motorola internals), which have a ModBus interface (it is possible to use RS-232, 485, Ethernet), a cellular terminal and are configured using a special utility.  Further, these terminals receive Modbus data and transmit their server to the company.  For this, the company takes a monthly fee, the exact size of which is unknown to me.  To get this data and use it in SCADA, you need to install another utility, the OPC server, which requests data from the company‚Äôs server via the Internet and sends it via the OPC protocol. <br>  The configuration stored in the module itself is minimal.  This is the project name, the node name in the project (there may be several nodes), settings for connecting to the controller and setting up the cellular terminal. <br>  Here is the terminal itself: <br><img src="https://habrastorage.org/getpro/habr/post_images/208/519/91e/20851991e608109119605d112441f3a6.jpg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All data settings exchanged by the terminal in the PLC are made through the web interface or through a special utility.  "Access to the body" is no longer required, only the Internet is needed.  This is the web interface: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2e8/097/8fe/2e80978fe0ed0f6f54ca0f03b1028f7e.png" alt="image"><br><br>  In addition to data collection, the web interface has minimal SCADA functionality, i.e.  You can implement the simplest pictures. <br><br>  And this is how the water station looks on the operator‚Äôs screen in the Citect system: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3de/3a2/98c/3de3a298ce662d7ad268b6d17b40f377.jpg" alt="image"><br><br>  Naturally, all the Hebrew inscriptions do not forget where the project is located :) In a nutshell, on this screen we see the water level in the tank, the status of the float level sensors (top, bottom and two intermediate ones on the left on the tank), the state of all three pumps (gray - off, green - in operation, red - malfunction), turn-on sequence (number in the box above each pump), water pressure at the inlet and outlet of the pumping station, level setpoints (full / empty capacity alarm, level of pump shutdown, first level  pump, the level of inclusion of the backup pump).  Below is a graph of the level change in the last 12 hours; the story is stored for 3 years <br><br><h5>  Additional difficulties with water stations </h5><br>  In general, the algorithm of the water pumping station operation is almost the same as that of the sewage plant: turn on the pump at one level in the tank, turn off the pump at another level.  The difference lies in the fact that at the sewer station capacity and pumps are in the same place, and at the water-pressure station - far enough from each other.  Strictly speaking, due to the remoteness of the pumping and expendable capacity - these are two different stations, each with its own controller. <br>  The need for pressure stations is due to the fact that some localities are located on the slopes of the mountains, and the pressure in the central water supply system is insufficient to raise the water to the desired height.  Therefore, on the uplands, consumable tanks were built (the principle is similar to water towers), and below - pumping tanks, which raise the pressure and fill these tanks as needed. <br><br>  Let's return to our project.  This territorial remoteness also creates the main complexity.  The capacity together with the level sensor is located too far from the pump room and at various times attempts were made to ensure communication over the radio channel, but at the time of the implementation of our project this system did not work for reasons unknown to me. <br>  But the data collection system that we use allows us not only to receive data, but also to transfer them between different stations within the project.  Thus, the controller's tasks on the consumable capacity are minimal: to receive a signal from the level sensor (4..20 mA), convert it to engineering units and transfer it up to the pumping unit using the Modbus protocol.  This Modbus register is the very 2 bytes in the header, without which the pumping station cannot operate.  In the first screenshot, I circled in red the source register and the register-receiver in the second controller. <br>  In fact, this controller transmits a little more information.  During operation, it is possible that at the pump we see: the level has decreased, it is time to fill the tank.  And turn on the pump.  The pump is running, the tank is filling up, and at some point the connection is lost.  The level in the tank grows, and the pump controller does not receive information.  And the capacity overflows. <br>  To prevent this, we transfer one more value from the tank to the pump room.  This is a counter whose value increases every minute.  Just once a minute, the pump controller saves the resulting value and compares it with the previous four.  If they all match, it means that already 5 minutes we have a loss of communication. <br>  At the pump room, at each pump start-up, a timer starts at the same time as they, the setpoint of which can be changed.  If the timer has finished counting and the controller ‚Äúsees‚Äù the loss of communication - the pumps stop.  Thus implemented protection. <br><br><h4>  The status of the project today </h4><br>  In total, the project is scheduled to update the automation and connect 12 stations to the control room.  Currently, 8 of them are finished, the hardware has been updated as necessary, if necessary, changes have been made to the controller programs and information is regularly received at the dispatch console. <br><br>  And, for dessert, a general view of the village, where the pumping and expendable capacity are located: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b9/9ba/046/5b99ba046d7747553743ba780a4ae39c.jpg" alt="image"></div><p>Source: <a href="https://habr.com/ru/post/180273/">https://habr.com/ru/post/180273/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180257/index.html">Panorama at 9600 km in 15 minutes</a></li>
<li><a href="../180259/index.html">Unknown mathematician made a breakthrough in the theory of twin prime numbers</a></li>
<li><a href="../180265/index.html">Corporate PBX based on Asterisk</a></li>
<li><a href="../180269/index.html">Graphs of road networks and algorithms for working with them</a></li>
<li><a href="../180271/index.html">The effect of film film projector in digital video technology</a></li>
<li><a href="../180275/index.html">The effect of slides on the site. Version two, supplemented and corrected</a></li>
<li><a href="../180277/index.html">Time management and organizers</a></li>
<li><a href="../180279/index.html">JQuery validate plugin work from inside</a></li>
<li><a href="../180281/index.html">Automation of operations of the same type when setting up switches via telnet without programming</a></li>
<li><a href="../180283/index.html">Creating custom virtual machines and images in Windows Azure</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>