<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unreal LED, or load management from Unreal Tournament</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The idea may seem like a mockie, but it deserves the right to life. Here we will focus on copying events from virtual reality to the outside, that is,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unreal LED, or load management from Unreal Tournament</h1><div class="post__text post__text-html js-mediator-article">  The idea may seem like a mockie, but it deserves the right to life.  Here we will focus on copying events from virtual reality to the outside, that is, in the direction opposite to the usual replication of reality into virtuality.  I call it ‚Äúaugmented reality the other way around.‚Äù  The idea is to send HTTP requests to the Arduino Ethernet Shield.  From UT. <br><a name="habracut"></a><br><h3>  Intro </h3><br>  Perhaps, every buyer of the Ethernet module or shield has made a server to turn on the LED from * Duino, and many sooner or later sewed it to some client like an Android smartphone.  I recently had a thought - why not use the Unreal Tournament as a client?  UT is an excellent visualization environment, and besides, the engine itself is very convenient and flexible. <br><br>  Knowledge of the editor at the interface level is enough.  The source for UnrealScript will be explained in the course of writing our client, and in general UnrealScript has the usual syntax with quite clear names of functions.  For those who see the Unreal Editor for the first time, but still want to try, I recommend reading the article <a href="http://habrahabr.ru/users/vbkesha/" class="user_link">VBKesha</a> <a href="http://habrahabr.ru/post/185232/">Introducing UnrealEngine.</a>  <a href="http://habrahabr.ru/post/185232/">Part 1</a> , and to be honest, I myself am very much looking forward to continuing this course, because in network replication, for example, I am a complete dunduk.  All my weapons made for UT99 only work correctly in single / offline mode. <br><br><h3>  Server </h3><br>  In general, it is assumed that the reader already knows everything about the issue of creating a web server on the Arduino.  Nevertheless, repetition is the mother of the teachings, so just in case I cite one of the variants of this example. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Server Description</b> <div class="spoiler_text">  The hardware is represented by an Ethernet module or shield on ENC28J60, for the construction of the sketch, <a href="http://www.doctormonk.com/2010/03/simplified-ethernet-library-for-28j60.html">Dr.</a> Ether_28J60 library is used <a href="http://www.doctormonk.com/2010/03/simplified-ethernet-library-for-28j60.html">.</a>  <a href="http://www.doctormonk.com/2010/03/simplified-ethernet-library-for-28j60.html">Monk</a> .  It is a wrapper for the <a href="http://www.nuelectronics.com/estore/index.php%3Fmain_page%3Dproduct_info%26products_id%3D4">Nuelectronics</a> library.  Unpack the archives <a href="">from here</a> and <a href="">from here</a> to the% arduino% \ libraries directory, take the WebRemote example, change it to fit your needs, build according to the scheme (for a separate module): <br><table><tbody><tr><td>  Board ENC28J60 </td><td>  Arduino </td></tr><tr><td>  SI </td><td>  MOSI (D11) </td></tr><tr><td>  SO </td><td>  MISO (D12) </td></tr><tr><td>  SCL </td><td>  SCK (D13) </td></tr><tr><td>  Rst </td><td>  RESET </td></tr><tr><td>  5V </td><td>  5V </td></tr><tr><td>  GND </td><td>  GND </td></tr><tr><td>  CS </td><td>  D10 </td></tr></tbody></table>  On the D6 output of the Arduino, the LED (through a resistor), the anode (plus) towards the dyne, the cathode towards the ground. <br><br>  The sketch for me is as follows: <br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"EtherShield.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"ETHER_28J60.h"</span></span></span><span class="hljs-meta"> int outputPin = 6; static uint8_t mac[6] = {0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED}; static uint8_t ip[4] = {192, 168, 0, 40}; static uint16_t port = 80; ETHER_28J60 e; void setup(){ e.setup(mac, ip, port); pinMode(outputPin, OUTPUT); } void loop(){ char* params; </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (params = e.serviceRequest()){ e.print(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;H1&gt;Web Remote&lt;/H1&gt;"</span></span></span><span class="hljs-meta">); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (strcmp(params, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"?cmd=on"</span></span></span><span class="hljs-meta">) == 0) digitalWrite(outputPin, HIGH); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> (strcmp(params, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"?cmd=off"</span></span></span><span class="hljs-meta">) == 0) digitalWrite(outputPin, LOW); e.print(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"LED state: &lt;br&gt;"</span></span></span><span class="hljs-meta">); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(digitalRead(outputPin)==1) e.print(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"on"</span></span></span><span class="hljs-meta">); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">else</span></span></span><span class="hljs-meta"> e.print(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"off"</span></span></span><span class="hljs-meta">); e.print(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">".&lt;br&gt;"</span></span></span><span class="hljs-meta">); e.print(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;A HREF='?cmd=on'&gt;Turn on&lt;/A&gt;&lt;br&gt;"</span></span></span><span class="hljs-meta">); e.print(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"&lt;A HREF='?cmd=off'&gt;Turn off&lt;/A&gt;"</span></span></span><span class="hljs-meta">); e.respond(); } }</span></span></code> </pre> </div></div><br><h3>  Pig </h3><br>  To fulfill the request, we need a client class to which we can pass our parameters at run time.  Fortunately, there is already such a class there, it is called UBrowser.UBrowserHTTPClient.  There is no UBrowser pack in UT2003 / 2004, but there is UWeb.WebApplication and its subclasses.  Consider sending a request from UT99, and for older versions it will be possible to sharpen by analogy.  UBrowserHTTPClient can only do a GET request, but you can teach it and POST.  Actually, you can even change the HTTP-headers in any way, and implement not only the HTTP protocol, but also some other one. <br><br>  UBrowserHTTPClient does not have a visual display in the editor (mesh or sprite texture) - if you add it to the level, it will appear there, but the editor will not show it.  Therefore, we will create a more convenient "wrapper" for it, at the same time endowing with a couple of variables that can be edited at the level.  As the parent (superclass), we use the trigger class. <br><br>  Now we will continue what was not <a href="http://habrahabr.ru/users/vbkesha/" class="user_link">discussed</a> in the article <a href="http://habrahabr.ru/users/vbkesha/" class="user_link">VBKesha</a> .  Above the working area with views (viewports) there are browser call buttons (they look like this: <img src="https://habrastorage.org/storage2/1a0/646/4e6/1a06464e64d96f7108cd6b8dc4510999.jpg">  ).  We are interested in Actor Classes, opens with a button that looks like a pawn (the very first).  If there is no checkbox field in this window, it is activated with the command <b>View -&gt; Show packages</b> from the menu.  It is necessary to include, it will be needed, since we are going to create our own pack with scripts. <br><br> <a href=""><img src="https://habrastorage.org/storage2/200/86b/167/20086b167cd544168480b10e94629ac1.jpg" alt="Browser Actor Classes"></a> <img src="https://habrastorage.org/storage2/b73/a6f/5eb/b73a6f5ebaba840da050c4545cd21758.jpg" alt="Class creation"><br><br>  To create a test trigger that allows us to manage the request, open the <b>Triggers</b> group in this window (principle - as in the Windows registry editor), then select the <b>Trigger</b> and press the button <img src="https://habrastorage.org/storage2/d53/a4f/b35/d53a4fb35398d20b3d4b5621bebb86cf.jpg">  .  The top line of the window that appears is the name of the file with a pack for the class being created, the bottom line is the name of the class.  So, if you press Enter, you get the class MyPackage.MyTrigger.  I called my own stdHTTPTrig.stdHTTPTrigger.  Next, write the actual code: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stdHTTPTrigger</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">expands</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Trigger</span></span></span><span class="hljs-class">;</span></span> var() <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> BrowseURL,BrowseArg; <span class="hljs-function"><span class="hljs-function">function </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Touch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(actor Other)</span></span></span></span>{ local UBrowserHTTPClient uhc; <span class="hljs-function"><span class="hljs-function">foreach </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">allactors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(class</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'UBrowserHTTPClient'</span></span></span></span><span class="hljs-function"><span class="hljs-params">,uhc)</span></span></span><span class="hljs-function"> uhc.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">destroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; uhc=spawn(class<span class="hljs-string"><span class="hljs-string">'UBrowserHTTPClient'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(uhc != none) uhc.Browse(browseurl,browsearg); }</code> </pre><br>  The script editor (where to write the source code) is opened by double clicking on the class, and automatically when creating the class;  compilation done button <img src="https://habrastorage.org/storage2/af4/fa0/359/af4fa03593a5f2ad230a761a9226160e.jpg">  (Compile changed scripts) at the top of the window.  I do not advise pressing Compile ALL - first, the UE will think for a long time, then it will complain that some classes are not found (due to the fact that only the necessary things are loaded), and then, most likely, it will make the GPF and fall out, or it will hang tightly shoot with three fingers.  After compilation, the pack must be saved; to do this, we find its name (what was written in the Package name line) at the bottom of the Actor Classes window, put a flag opposite it, and press the button <img src="https://habrastorage.org/storage2/dae/693/946/dae6939468048003d98eaacdf739f6ae.jpg">  .  By the way, if you need to quickly correct the source and save, it is convenient to open the class browser window with the button <img src="https://habrastorage.org/storage2/8d5/246/8e8/8d52468e8bcf871e5a228e6583857a1a.jpg">  without getting out of the script editor (if the latter is maximized). <br><br>  As you can see, the considered trigger acts quite roughly: it destroys all the client‚Äôs actors in the level in general (just to save memory), then creates a new one, and looks at the specified resource.  After the browse () call, the client is not destroyed, since it takes some time to work.  The browse () method has two optional parameters: TCP port and timeout.  Using the latter, you can track the success of the request, thus assessing the availability of the resource.  Also, this client has callback functions for returning server response and error handling.  To enable this feature, you need to override these functions, that is, to create your own subclass, the parent of which will be UBrowserHTTPClient. <br><br><div class="spoiler">  <b class="spoiler_title">Test Level 1</b> <div class="spoiler_text"><img src="https://habrastorage.org/storage2/286/8fa/4d9/2868fa4d95b1a9aa5bc05a967aa095f0.jpg"></div></div><br>  The test room consists of two triggers, one PlayerStart and light sources.  The BrowseURL properties are the same for both - this is the IP address of the server.  BrowseArg is a parameter consisting of the resource name (slash /), and data (question mark and variables), that is, one has <b>/? Cmd = on</b> , the other has <b>/? Cmd = off</b> .  The properties window opens with the RMB on the object -&gt; properties, or F4.  If F4 is not pressed, you must click on any view with the left mouse button.  Having drawn a room, we press F6, in the opened window (level properties) we find LevelInfo, there - DefaultGameType.  We change to singleplayer and press Enter (UnrealShare.SinglePlayer will be substituted), otherwise a bunch of bots will appear and interfere.  Then build the level (Rebuild geometry), save, run.  Burning from a blaster on triggers (by default, their radius of action is 40), enjoy the effect. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/5TC504WPNG0%3Ffeature%3Doembed&amp;xid=25657,15700023,15700186,15700190,15700253,15700259&amp;usg=ALkJrhisoDmn5cYenArVABYnAxuUpkhjtQ" frameborder="0" allowfullscreen=""></iframe><br><br><h3>  Getting server response </h3><br>  Now, having checked out the idea in general terms, you can proceed to the development of the final one.  If you plan to call the pack with the new class in the same way, and the old ‚Äúoak‚Äù trigger is not needed, exit the editor and do something with the file packname.u in the% ut99% \ system directory (packname is what we called the pack with the class ,% ut99% - path to Unreal Tournament): move to the old directory, for example.  Or immediately in the basket, since we will not need it.  Start the editor again. <br><br><h4>  Level events </h4><br>  The U engine has no other mechanism for creating events, except bypassing all the actors in turn with suitable properties, and calling the appropriate functions.  For all types of triggers, the Tag property is used for this - a variable of type name (object name) and the Trigger () function, Untrigger ().  Untrigger () is intended for the effect of "destroying" an event, for example, in sliding doors.  A trigger is placed in the middle of the opening, creating an event specified in the Tag's property of movers (Mover, or Moveable brush - moving brush, or brush) that forms the door, and the TriggerControl is specified in the InitialState property (in the Object group) - a mode specifically designed for this behavior.  When a player enters the range of a trigger, the Trigger () function is called by the movers, while leaving the radius, the Untrigger () function is called.  As a result, the doors will open only while the player is in range of the trigger.  We will do the same, pursuing 2 goals: usability when building a level, and compatibility. <br><br>  In this example, in fact, only the on / off state is checked.  This is done using the condition and the function of finding the substring in the string.  But nothing prevents you from developing this system before pulling out of the server a certain value, say, PWM levels for RGB LEDs.  However, please note that the RGB LED requires data in the form of RGB, and for Unreal the color will have to be recalculated in HSB. <br><br>  The new trigger will have 8 line patterns that should be searched for in the server response, and the same number of names for creating / destroying events in case the line is found / not found.  If desired, you can increase, remove, etc. For HTTP errors, only the creation of events is provided - IMHO, the use of Untrigger is not necessary in this case.  Again, no one forbids adding. <br><br>  Open the class browser (Actor Classes), open the <b>Actor \ Info \ InternetInfo \ InternetLink \ TcpLink \ UBrowserBufferedTcpLink</b> group in it, <b>select the UBrowserHTTPClient</b> class, click the button <img src="https://habrastorage.org/storage2/d53/a4f/b35/d53a4fb35398d20b3d4b5621bebb86cf.jpg">  (New script).  Specify the class name and pack, write the code: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stdHTTPBrowser</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">expands</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UBrowserHTTPClient</span></span></span><span class="hljs-class">;</span></span> var <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> SearchRespData[<span class="hljs-number"><span class="hljs-number">8</span></span>]; var name SearchRespEvent[<span class="hljs-number"><span class="hljs-number">8</span></span>]; var name SearchNotInRespEvent[<span class="hljs-number"><span class="hljs-number">8</span></span>]; var name SearchRespCancelEvent[<span class="hljs-number"><span class="hljs-number">8</span></span>]; var name SearchNotInRespCancelEvent[<span class="hljs-number"><span class="hljs-number">8</span></span>]; var <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> HTTPErrCode[<span class="hljs-number"><span class="hljs-number">8</span></span>]; var name HTTPErrEvent[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-function"><span class="hljs-function">event </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HTTPReceivedData</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Data)</span></span></span></span>{ local <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; local actor a; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;=<span class="hljs-number"><span class="hljs-number">7</span></span>;i++){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(SearchRespData[i] != <span class="hljs-string"><span class="hljs-string">""</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(InStr(Caps(Data),Caps(SearchRespData[i])) != <span class="hljs-number"><span class="hljs-number">-1</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(SearchRespEvent[i] != <span class="hljs-string"><span class="hljs-string">'') foreach allactors(class'</span></span>Actor',a,SearchRespEvent[i]) a.Trigger(self,self.instigator); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(SearchRespCancelEvent[i] != <span class="hljs-string"><span class="hljs-string">'') foreach allactors(class'</span></span>Actor',a,SearchRespCancelEvent[i]) a.Untrigger(self,self.instigator); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(SearchNotInRespEvent[i] != <span class="hljs-string"><span class="hljs-string">'') foreach allactors(class'</span></span>Actor',a,SearchNotInRespEvent[i]) a.Trigger(self,self.instigator); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(SearchNotInRespCancelEvent[i] != <span class="hljs-string"><span class="hljs-string">'') foreach allactors(class'</span></span>Actor',a,SearchNotInRespCancelEvent[i]) a.Untrigger(self,self.instigator); } } } } <span class="hljs-function"><span class="hljs-function">event </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">HTTPError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Code)</span></span></span></span>{ local <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; local actor a; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;=<span class="hljs-number"><span class="hljs-number">7</span></span>;i++){ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(HTTPErrCode[i] == Code &amp;&amp; HTTPErrEvent[i] != <span class="hljs-string"><span class="hljs-string">'') foreach allactors(class'</span></span>Actor',a,HTTPErrEvent[i]) a.Trigger(self,self.instigator); } }</code> </pre> <br>  The name type, IMHO, is not much different from string, except that there is a localized string for strings in Chinese, Russian, etc. However, it is extremely important: under test conditions, empty names are '' (in single quotes), empty strings - "" (in double quotes).  The event keyword is the same as the callback in the source code for the Windows API.  In short, the callback, that is, the function does not run a class script, but an external event. <br><br>  Anticipating the comments akin to Bo‚Äôs shop ‚Äúclimbed into the hole,‚Äù rejoicing that we will not add this class to the level with the Add YourHTTPClientClass here command.  The spawn () function in the trigger will do this for us.  In my opinion, this is the most appropriate class for such things.  Therefore, we close the script editor window, and in the class browser open the <b>Actor \ Triggers</b> group and select the <b>Trigger</b> .  Click the New script and write the trigger code: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">stdHTTPTriggerX</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">expands</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Trigger</span></span></span><span class="hljs-class">;</span></span> var() <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> EHTTPTriggerLaunchType{ <span class="hljs-comment"><span class="hljs-comment">// launch type HTTLT_Touch, HTTLT_Trigger } HTTPTriggerLaunchType; var() string SearchRespData[8]; // search template in HTTP response var() name SearchRespEvent[8]; // events generated on match var() name SearchNotInRespEvent[8]; // events generated if no match var() name SearchRespCancelEvent[8]; // events cancelled on match var() name SearchNotInRespCancelEvent[8]; // events cancelled if no match var() int HTTPErrCode[8]; // HTTP error templates var() name HTTPErrEvent[8]; // events generated if defined HTTP error(s) ocurrs var() string BrowseURL,BrowseArg; // URL var() bool bAutoExec; // enable auto launch var stdHTTPBrowser hClient; // client handle function CreateClientRequest(){ local int i; if(hClient != none) hClient.destroy(); // destroy previous request hClient=spawn(class'stdHTTPBrowser'); // create if(hClient != none){ for(i=0;i&lt;=7;i++){ hClient.SearchRespData[i]=self.SearchRespData[i]; // transfer configs hClient.SearchRespEvent[i]=self.SearchRespEvent[i]; hClient.SearchNotInRespEvent[i]=self.SearchNotInRespEvent[i]; hClient.SearchRespCancelEvent[i]=self.SearchRespCancelEvent[i]; hClient.SearchNotInRespCancelEvent[i]=self.SearchNotInRespCancelEvent[i]; hClient.HTTPErrCode[i]=self.HTTPErrCode[i]; hClient.HTTPErrEvent[i]=self.HTTPErrEvent[i]; } hClient.Browse(browseurl,browsearg); // launch } } function Trigger(actor Other,pawn EventInstigator){ // triggered launch if(HTTPTriggerLaunchType == HTTLT_Trigger) CreateClientRequest(); } function Touch(actor Other){ // proximity launch local actor a; if(IsRelevant(Other) &amp;&amp; HTTPTriggerLaunchType == HTTLT_Touch){ if(ReTriggerDelay &gt; 0){ if(Level.TimeSeconds-TriggerTime &lt; ReTriggerDelay) return; TriggerTime=Level.TimeSeconds; } CreateClientRequest(); if(Message != "") Other.Instigator.ClientMessage(Message); if(bTriggerOnceOnly) SetCollision(False); } } function PostBeginPlay(){ // autoexec launch if(bAutoExec) CreateClientRequest(); }</span></span></code> </pre> <br>  Here, only the client object created by this trigger is destroyed.  This allows multiple clients to work simultaneously.  Keyword none - empty object name, allows you to find out if an object was created or not;  self - the name of the own object, allows you to refer to yourself.  The expression self.  it is possible not to write in front of the variable name, but this makes the code less understandable.  The brackets () after the var mean that this variable should be shown in the window of the property editor (Actor properties).  That is, the client class, although it has these properties, but you can edit them only from the script - we have a cycle in CreateClientRequest () that does this.  IsRelevant () is borrowed from the Engine.Trigger class to ensure compatibility with its properties.  The condition with ReTriggerDelay allows you to make a limit on triggering no more than a specified interval. <br><br>  Compile (scripts in the script editor), save the pack in the browser. <br><br><h4>  Variable description </h4><table><tbody><tr><td>  HTTPTriggerLaunchType </td><td>  Startup type </td></tr><tr><td>  SearchRespData [] </td><td>  Search Templates </td></tr><tr><td>  SearchRespEvent [] </td><td>  Events triggered when a pattern is found </td></tr><tr><td>  SearchNotInRespEvent [] </td><td>  Events triggered when there is no template </td></tr><tr><td>  SearchRespCancelEvent [] </td><td>  Events destroyed when a pattern is found </td></tr><tr><td>  SearchNotInRespCancelEvent [] </td><td>  Events destroyed in the absence of a template </td></tr><tr><td>  HTTPErrCode [] </td><td>  HTTP error codes </td></tr><tr><td>  HTTPErrEvent [] </td><td>  Events caused by HTTP errors </td></tr><tr><td>  BrowseURL </td><td>  Server address </td></tr><tr><td>  BrowseArg </td><td>  Resource and Parameters </td></tr><tr><td>  bAutoExec </td><td>  Automatic query execution at boot level </td></tr></tbody></table>  If the startup type is HTTLT_Touch, the trigger will run CreateClientRequest () when a certain class is within its radius.  This takes into account the TriggerType value (in the Trigger group): TT_AnyProximity ‚Äî any class, TT_PawnProximity ‚Äî any pawn (player, bot or monster), TT_PlayerProximity ‚Äî only player, TT_ClassProximity ‚Äî a certain class (specified in the ClassProximityType property), TT_Shoot ‚Äî shell (subclass) ) or getting from a weapon with an instant action, i.e. a call to the function TakeDamage () of this trigger.  The damage threshold (how painful it is to make a trigger to trigger) is specified in the DamageThreshold property. <br>  If the startup type is HTTLT_Trigger, it is launched only by calling the Trigger function, for example, when an event specified in the Tag property (in the Events group) occurs. <br>  If bAutoExec is true, the trigger will automatically make a request after the start of the game.  This is used for the initial installation of triggers according to the state of the server, i.e. for synchronization. <br><br><div class="spoiler">  <b class="spoiler_title">Test Level 2</b> <div class="spoiler_text"><img src="http://habrastorage.org/storage2/bc3/9c4/c0e/bc39c4c0e61c9b1c9f85c3557edd8b52.jpg"></div></div><br>  The light source in the room with PlayerStart is the usual Light.  The source under the ceiling in the room with triggers - TriggerLight.  It duplicates the state of the LED.  Two other sources in the same room just highlight the panels.  First place the TriggerLight.  Select it in Actor classes (located in <b>Actor \ Light</b> ), add it by right-clicking on the ceiling texture and selecting Add TriggerLight here.  For some reason I have two classes in my browser, both work, so we choose either. <br>  The properties of the TriggerLight group are not touched, bInitiallyActive is false, and so should be.  Open the Object group and change the InitialState to TriggerControl.  If, by clicking on the property, the pop-up menu is not displayed (possible bug under Win 7), we scroll with the left / right arrows from the keyboard.  Next, open the Events group, change the Tag from None to some word, I had a lighton. <br><br>  Triggers are added similarly (located at <b>Actor \ Triggers \ Trigger</b> );  Panels can not draw - I made it so that the video was clearer.  Textures from Mine.utx. <br><br>  Properties of the triggers are given in the table. <br><table><tbody><tr><td></td><td>  HTTPTrigger0 </td><td>  HTTPTrigger1 </td><td>  HTTPTrigger2 </td></tr><tr><td>  bAutoExec </td><td>  False </td><td>  False </td><td>  True </td></tr><tr><td>  BrowseArg </td><td>  /? cmd = on </td><td>  /? cmd = off </td><td>  / </td></tr><tr><td>  BrowseURL </td><td>  192.168.0.40 </td><td>  192.168.0.40 </td><td>  192.168.0.40 </td></tr><tr><td>  HTTPTriggerLaunchType </td><td>  HTTLT_Touch </td><td>  HTTLT_Touch </td><td>  HTTLT_Trigger </td></tr><tr><td>  SearchNotInRespCancelEvent [0] </td><td>  lighton </td><td>  lighton </td><td>  lighton </td></tr><tr><td>  SearchRespEvent [0] </td><td>  lighton </td><td>  lighton </td><td>  lighton </td></tr><tr><td>  SearchRespData [0] </td><td>  LED state: &lt;br&gt; on </td><td>  LED state: &lt;br&gt; on </td><td>  LED state: &lt;br&gt; on </td></tr></tbody></table>  If you plan to catch server errors, simply write the numbers in the HTTPErrCode [] properties, for example, 404, 403, 302, etc. <br><br><h4>  Result </h4><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/skuFiDyJ7WA%3Ffeature%3Doembed&amp;xid=25657,15700023,15700186,15700190,15700253,15700259&amp;usg=ALkJrhhI2L1rDHgfFVw8_MIioZ7cJEhOcg" frameborder="0" allowfullscreen=""></iframe><br><br>  Bratyunya already wrote one comment under the video, just accompanied the whole process.  Apparently, for the sake of Hochma, he decided to draw an apartment and tie the control of the smart home to his beloved Rubilov.  But of course, this is not the only use of a GET request.  You can, for example, make a UT-server that will load maps for players with the necessary atmospheric phenomena, depending on the sensor readings.  In general, now you can make the web-interface really colorful. </div><p>Source: <a href="https://habr.com/ru/post/189802/">https://habr.com/ru/post/189802/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189786/index.html">"Multithreading" WSH VBScript</a></li>
<li><a href="../189788/index.html">The basis of AI - the structure of the mind</a></li>
<li><a href="../189792/index.html">Creating a simple bot for WoW, programming routes</a></li>
<li><a href="../189794/index.html">Creating Metaboxes in WordPress</a></li>
<li><a href="../189798/index.html">Hadoop Tutorial. Writing your grep</a></li>
<li><a href="../189804/index.html">Recognition and conversion of subtitles from VOB to SRT format</a></li>
<li><a href="../189806/index.html">Entity Framework Code First - field indexing and full text search</a></li>
<li><a href="../189808/index.html">jqGrid for Raudus</a></li>
<li><a href="../189812/index.html">Node.JS and uploading a directory from 1C to the site</a></li>
<li><a href="../189814/index.html">The Story of The Pirate Bay</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>