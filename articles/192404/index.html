<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Yandex, robots and Siberia - as we did a search system for the downloaded image</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, Yandex has launched a search for images on the downloaded image . In this post, we want to talk about the technology behind this service and ho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Yandex, robots and Siberia - as we did a search system for the downloaded image</h1><div class="post__text post__text-html js-mediator-article">  Today, Yandex has launched a <a href="https://yandex.ru/images">search for images on the downloaded image</a> .  In this post, we want to talk about the technology behind this service and how it was done. <br><br>  Technology inside Yandex is called Siberia.  From CBIR - <a href="http://en.wikipedia.org/wiki/Content-based_image_retrieval">Content Based Image Retrieval</a> . <br><br>  Of course, the problem itself is not new, and a lot of research is devoted to it.  But to make a prototype that works on an academic collection, and to build an industrial system that works with billions of images and a large flow of requests are very different stories. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="http://habrahabr.ru/company/yandex/blog/192404/"><img src="https://habrastorage.org/getpro/habr/post_images/422/210/772/422210772e549c20fc906374961ce45b.jpg"><br></a> <br><h4>  What is all this for? </h4><br>  There are three scenarios in which you need to search for the loaded picture and which we needed to learn how to process. <br><a name="habracut"></a><br><ul><li>  A person needs the same or a similar picture, but in a different resolution (usually the largest), or maybe of a different color, better quality or not cropped. </li><li>  You need to understand what is in the picture.  In this case, a short description next to the image is enough to make it clear who or what is on it. </li><li>  It is necessary to find a site on which there is the same picture.  For example, when I wanted to read about what is in the picture.  Or look at the same pictures.  Or buy what is shown in the picture - in this case, shops are needed. </li></ul><br><h4>  How it works? </h4><br>  There are different approaches with which you can find similar images.  The most common is based on the representation of the image in the form of <i>visual words</i> - quantized local descriptors, computed at particular points.  Especially called the points that are most stable with changes in the image.  To find them, the image is processed with special filters.  The description of the areas around these points in digital form is a descriptor.  To turn descriptors into visual words, a dictionary of visual words is used.  It is obtained by clustering all descriptors counted for a representative set of images.  In the future, each newly calculated descriptor is assigned to the corresponding cluster - this is how quantized descriptors (visual words) are obtained. <br><br>  The process of searching for an image from a loaded picture in large collections is usually built in this order: <br><ol><li>  Getting a set of visual words for the loaded image. </li><li>  Search for candidates by inverted index, which, according to a given set of visual words, determines the list of images containing it. </li><li>  Checking the relative position of the matching descriptors for the sample image and the image under study.  This is the stage of validation and ranking of candidates.  Clustering of Hough or RANSAC transformations is traditionally used. </li></ol><br><blockquote>  Ideas of the approach are presented in the articles: <br><ul><li>  J. Philbin, O. Chum, M. Isard, J. Sivic, and A. Zisserman.  Object retrieval with large vocabularies and fast spatial matching.  In CVPR, 2007 </li><li>  J. Sivic and A. Zisserman.  Video google: a text retrieval approach to object matching in videos.  In ICCV, 2003. </li><li>  James Philbin Joseph Sivic Andrew Zisserman Geometry Lens Dirichlet Allocation for a Large-scale Image Datasets (Items 3.1, 3.2) </li></ul></blockquote><br>  The method of image retrieval by image-request used by us is similar to the above traditional approach.  However, checking the relative position of local features requires significant computational resources.  And in order to search for a huge collection of images stored in the Yandex search index, we had to find more efficient ways to solve the problem.  Our indexing method can significantly reduce the number of images that can be considered relevant to the sample (request). <br><br>  The key to our implementation of the search for candidates is the transition from indexing visual words to indexing more discriminative traits, a special index structure. <br><br>  For the selection of candidates two methods showed themselves equally well: <br><ol><li>  Indexing high-level features or visual phrases (phrases).  They are a combination of visual words and parameters that characterize the relative position and other relative characteristics of the corresponding local features of the image. </li><li>  Multi-index, where the key is composed of quantized parts of descriptors (product quantization).  The method was published: <a href="http://download.yandex.ru/company/cvpr2012.pdf">download.yandex.ru/company/cvpr2012.pdf</a> </li></ol><br>  During validation, we use our own implementation of clustering transformations between images. <br><br>  Now we will rise on level up and we will look at the product scheme as a whole. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c4/7d8/e1a/9c47d8e1addb131876a984dbec06a1d1.jpg"><br><br><ol><li>  User picture is in temporary storage. </li><li>  From there, a reduced copy of the image gets into the daemon, where descriptors and visual words are computed for the image and a search query is formed from them. </li><li>  The request is sent first to the average meta-search and from there is distributed to the basic search.  On each basic search there can be a set of images. </li><li>  Found images are sent back to the average meta-search.  There the results are merged, and the resulting ranked list is shown to the user. </li></ol><br>  Each basic search works with its part of the index.  This ensures the scalability of the system: as the index grows, new fragments and new replicas of the basic search are added.  And fault tolerance is provided by duplicating basic searches and index fragments. <br><br>  And one more important nuance.  When we built our image search index, in order to improve the search efficiency, we used the knowledge we already have about duplicate images.  We used it in such a way that from each group of duplicates we took only one representative and included it in the search index by image.  The logic is simple: if the picture is relevant to the request, then all its copies will be the same relevant answer. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/663/bab/4f4/663bab4f47f561a91b75b2ba664bb7e3.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/715/a2d/ba4/715a2dba4edec76214ea943b993b8cc5.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/cad/fc5/6d8/cadfc56d84dc2bc4901fb57eb7aab7f7.jpg"><br><br>  In this version, we expected to find only copies of the image, either entirely coinciding with the loaded picture, or containing matching fragments.  But now our solution shows the ability to generalize: sometimes there is not just the same picture, but another picture, but containing the same object.  For example, it often manifests itself in architecture. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1d8/ea8/dc0/1d8ea8dc0018376bb80e83e7905f4181.jpg"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/100/a02/9ed/100a029edbb4bded6df20308df5cf1b5.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/911/1f7/882/9111f7882b38fb68fa844342159880f0.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/45b/f6b/074/45bf6b0744642fe0506599494e28d40d.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ee/977/404/8ee9774042a2db0b9840e386d337ee3c.jpg" alt="image"><br><br>  This is our first step in finding images by content.  Of course, we will develop similar technologies and make new products based on them.  And what is something, and we have enough ideas and desires for this. </div><p>Source: <a href="https://habr.com/ru/post/192404/">https://habr.com/ru/post/192404/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../192394/index.html">The path to contextual advertising is through REG.RU</a></li>
<li><a href="../192396/index.html">Software Development: Facts Against Myths</a></li>
<li><a href="../192398/index.html">RailsRumble 2013</a></li>
<li><a href="../192400/index.html">Ukraine remains exactly one month to #FailOverConf!</a></li>
<li><a href="../192402/index.html">Rwpod. 25th edition of the 01 season. Parallel installation of gems via bundler, Memfs, Ember.js 1.0, Flipload.js, etc.</a></li>
<li><a href="../192408/index.html">-ms-filter generating bugs. Be carefull</a></li>
<li><a href="../192410/index.html">High-speed SSD of new generation</a></li>
<li><a href="../192412/index.html">The new bill provides for fines of up to one million rubles for providers that do not comply with the requirements of the "anti-piracy" law</a></li>
<li><a href="../192414/index.html">You could not even kill your router? (or FAQ: dir-620 recovery)</a></li>
<li><a href="../192416/index.html">What is your home network for you?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>