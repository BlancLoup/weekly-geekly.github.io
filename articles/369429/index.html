<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Win CAN bus. Part 1. Technology</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today I want to introduce you to the interesting CANNY microcontroller platform. This is a review article in which you will learn about technology, an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Win CAN bus. Part 1. Technology</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/8fe/650/48b/8fe65048bfc74e77b13f2b02f5c7ce35.jpg" alt="image"><br><br>  Today I want to introduce you to the interesting <a href="http://canny.ru/">CANNY</a> microcontroller platform.  This is a review article in which you will learn about technology, and in subsequent articles I will tell you about working with CAN messages, CANNY integration with the <a href="http://hi-lab.ru/arduino-mega-server">Arduino Mega Server,</a> and about the possibilities offered by this bundle. <br><br>  Why canny?  From the name of the CAN bus, which is widely used in transport and, in particular, in all modern cars as an onboard network.  So, what can be done with a specialized controller connected to the CAN bus of your car? <br><a name="habracut"></a><br><h2>  CAN bus </h2><br>  Figuratively speaking, the CAN bus is the nervous system of your car.  It transmits all the information about the status of units and systems, as well as control commands, which largely determine the behavior of the car.  Ignition headlights, opening and closing doors, controlling the playback of music in the car, the alarm is triggered, etc. - all this works and is controlled by this bus. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Physically, the CAN bus consists of two intertwined wires and is very easy to install and connect.  Despite its simplicity, due to its differential nature, it is well protected from various interferences and interferences.  High reliability and long network length, up to 1000 meters, helped CAN to gain wide popularity among manufacturers of various, not only automotive, equipment. <br><br><h2>  CANNY controllers </h2><br>  This is a whole family of specialized controllers with built-in native support for working with the CAN bus.  This applies to both the ‚Äúiron‚Äù part and the support at the ‚Äúsoftware‚Äù level. <br><br><img src="https://habrastorage.org/files/aad/148/2f5/aad1482f5e7a4216b923921abb4164af.png" alt="image"><br><br>  The flagship of the line is the controller CANNY 7, the most powerful and having the most features.  A large amount of memory, powerful outputs that allow you to directly control the car relay, intelligent protection system against short circuits, protection against inrush current and voltage in the vehicle‚Äôs on-board network - all this makes this controller a great solution for translating any of your ideas and projects. <br><br><img src="https://habrastorage.org/files/daa/9bb/c56/daa9bbc5615a43189f3fe373a7bec26e.png" alt="image"><br><br>  In addition to CANNY 7, there are several more models in the line of controllers; we will conduct our experiments with the simpler embedded model CANNY 5 Nano.  It also supports work with the CAN bus, but at the same time is similar to the Arduino Nano already familiar to us. <br><br><h2>  Visual programming </h2><br><br><img src="https://habrastorage.org/files/3c0/558/f7a/3c0558f7a80c4e99aed56aa9eda7154a.png" alt="image"><br><br>  Developed support for the CAN bus is not the only feature of these controllers. Besides, CANNY has its own programming environment, CannyLab, but not ‚Äúnormal‚Äù, but a visual one, where the whole process of writing programs is reduced to manipulating ready-made structural blocks, setting their parameters and connecting inputs and outputs of these blocks in a certain sequence, in accordance with the algorithm of the problem being solved. <br><br>  Not a single line of code! <br><br>  Is it good or bad?  In my opinion, this is a matter of habit.  As an accustomed to ‚Äútraditional‚Äù programming, it was unusual for me to manipulate blocks instead of writing lines of code.  On the other hand, there are many adherents of just such an approach to the compilation of algorithms and it is believed that for engineers and non-programmers this is the simplest and most accessible method of programming microcontrollers. <br><br>  At least it was ‚Äúfun‚Äù for me to compose programs in this way and after a while I even began to like it.  It is possible that if you continue to do this, then after a while writing code will seem inconvenient. <br><br>  CannyLab is a free development environment and you can <a href="http://www.canny.ru/downloads">freely download</a> it from the developers site, it also does not require a special installation procedure - just unzip the file with the archive - and you can start working. <br><br><h2>  Connection </h2><br>  Connecting CANNY 5 Nano to a computer is not much different from connecting Arduino controllers.  If there is a Silicon Labs CP210x driver in the system, or after it is installed from the downloaded CannyLab distribution, Windows creates a virtual COM port and CANNY is ready for use.  In my case, it took more to restart the computer, but perhaps this is a feature of my system. <br><br><h2>  Practical examples </h2><br>  Let's use simple examples to analyze how to perform actions in CannyLab, which are familiar to us in the Arduino IDE.  Let's start with the traditional LED blinking. <br><br>  At the CANNY 5 controller, at the C4 (Channel 4) pin, there is a test LED (similar to the LED located at pin 13 in the Arduino).  And it can also be used for display and experiments, which we will use. <br><br>  What do you need to blink the LED in the controller CANNY?  All you need to do is do two things - configure the pin of the fourth channel as an output and send a PWM generator signal to this output.  We have already done all these actions in the Arduino IDE, let's see how it looks in CannyLab. <br><br>  So, we configure pin of the fourth channel as an output <br><br><img src="https://habrastorage.org/files/b4c/0ab/dbe/b4c0abdbe5c34469bdd5b6c77700635c.png" alt="image"><br><br>  We configure the PWM generator.  We set a period of 500 milliseconds, the fill is 250 milliseconds (that is, 50%) and 1 (true) at the input of the ‚ÄúStart‚Äù generator and ... everything!  There is no need to do anything else - the program is ready, it remains only to pour it into the controller. <br><br><img src="https://habrastorage.org/files/a43/21f/e2e/a4321fe2e9144a289611b0ca6bbadba3.png" alt="image"><br><br><h2>  Simulation mode </h2><br>  Here you need to say a few words about the process of simulation on the computer of the controller and pouring the developed program into the memory of the ‚Äúiron‚Äù controller. <br><br><img src="https://habrastorage.org/files/2c5/430/50f/2c543050f72e4106b4e1ac815990cd74.png" alt="image"><br><br>  The CannyLab development environment allows you to run and debug a program without writing it to the controller‚Äôs memory.  In the simulation mode, you can see the result of the program right in real time and even interfere with its work. <br><br><h2>  Filling controller </h2><br>  For the CANNY controllers to work, before filling the program (in the terminology of the "diagrams" developers), you must first fill in the operating system "Device / System Software / Write".  This needs to be done only once, for this you need to select the file with the <strong>.ccx</strong> extension that matches your controller. <br><br>  After the program is written and debugged, it can be downloaded to your controller.  This is done simply - in the menu, select the item ‚ÄúDevice / Diagram / Record‚Äù and after a few seconds the program is recorded in the controller. <br><br>  Next, you need to disconnect the controller from the computer's USB port, remove the jumper on the board and you can turn on the programmed controller, which after switching on will work according to your program. <br><br><h2>  Analog inputs </h2><br>  In order to better understand the principle of programming CANNY controllers in the CannyLab development environment, let's take another look at an example of working with an analog input in this system. <br><br>  We will monitor the voltage level on the 10 pin controller and if it is in the range of 2.5 V ¬± 20%, we will light the built-in LED. <br><br>  As in the previous example, we configure the 4th pin as an output in order to be able to control the operation of the LED. <br><br><img src="https://habrastorage.org/files/8d2/341/975/8d23419756554ba1bb2ed7c4e4e4af92.png" alt="image"><br><br>  Turn on the ADC on the 10th channel. <br><br><img src="https://habrastorage.org/files/9c2/877/fd6/9c2877fd6a2b4d0091f59bdcd07d11f9.png" alt="image"><br><br>  Next, we use two logical blocks that give 1 to the output if the voltage is in the specified range.  Full range from 0 to 4095. <br><br><img src="https://habrastorage.org/files/7e7/6b6/f9c/7e76b6f9c8c54461b6eb7413fc7e72c7.png" alt="image"><br><br>  The ‚ÄúLogic And‚Äù block completes the work and controls the operation of the LED on the board from its output. <br><br>  That's all.  What we used to do on the Arduino, we easily made in CannyLab.  It remains only to get comfortable in this programming environment and you can easily and naturally create your projects on this platform. <br><br>  These simple programming examples are provided so that you can understand the principle of visual programming of CANNY microcontrollers.  In the future, you will be helped by excellent reference documentation and developer support on the site and the forum of the system. <br><br><h2>  Conclusion on the introductory article cycle </h2><br>  By connecting the <a href="http://canny.ru/">CANNY</a> controller to your car, you will be able to implement many interesting and unique ideas, for example, non-standard alarms that are not so easy to open (due to its non-standard) or add new features that you dreamed about but did not expect that it could be implemented on practice. <br><br>  If you like visual programming in the style of CannyLab, then CANNY controllers can be an interesting alternative to Arduino for you or work in conjunction with Arduino controllers.  We will discuss this in the second article of the cycle, in which I will tell you about the integration of CANNY controllers with the <a href="http://hi-lab.ru/arduino-mega-server/details">Arduino Mega Server system</a> . <br><br>  Let me remind you that AMS now works not only on Arduino boards, but also on ESP8266 wireless Wi-Fi modules, and this particular bundle will be discussed next time. <br><br>  And as usual, stay with us, it will be interesting! </div><p>Source: <a href="https://habr.com/ru/post/369429/">https://habr.com/ru/post/369429/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../369419/index.html">Metalins created by scientists from Harvard, will improve the quality of the snapshot of the camera of the smartphone to the level of DSLR-camera</a></li>
<li><a href="../369421/index.html">Condensers for dummies</a></li>
<li><a href="../369423/index.html">Bacteriophage capable of infecting the immune system of bacteria using stolen CRISPR chains</a></li>
<li><a href="../369425/index.html">Ask Ethan # 66: magnetism from afar</a></li>
<li><a href="../369427/index.html">Blocking the site as a means of combating fraudsters</a></li>
<li><a href="../369431/index.html">Anti Aging Therapies</a></li>
<li><a href="../369433/index.html">Two experimental Zika virus vaccines worked in mice: it took one dose</a></li>
<li><a href="../369435/index.html">Between sleep and reality: the place where ideas are born</a></li>
<li><a href="../369437/index.html">Google puts machine learning at the forefront</a></li>
<li><a href="../369439/index.html">Hummer - a family of Trojans</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>