<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Voice control in Android applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started with the fact that I looked a good review (comparison) of Siri and Google Now. Which of them is better, I will not argue, but I persona...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Voice control in Android applications</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/118/b49/b0b/118b49b0b6df0e14724b996543bdef2f.jpg"><br><br>  It all started with the fact that I looked a good review (comparison) of Siri and Google Now.  Which of them is better, I will not argue, but I personally have a tablet on Android.  I thought, what if I could write the calculator completely on voice control (would it be convenient?).  But first I had to deal a little with the voice control itself, more precisely with voice input (control still needs to be achieved).  In addition, I just downloaded Android Studio, and I could not wait to try it out in practice (well, on the mini-project).  Well, let's start. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We throw on the activity <b>ListView</b> and <b>Button</b> .  In ListVu, we will save the commands themselves, or rather the variants of one command, and the button will politely ask what we want.  Yes, the program will not have logic, with its help we will just see the implementation itself. <br><br><img src="https://habrastorage.org/storage2/a59/1f8/8a3/a591f88a3b023222a53e2e5febec6d4b.png"><br><br>  Add the same resolution to the manifesto. <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><br>  And that's all, now you can go directly to programming.  "Find the necessary components": <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ListView mList; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Button speakButton; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> VOICE_RECOGNITION_REQUEST_CODE = <span class="hljs-number"><span class="hljs-number">1234</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.main); speakButton = (Button) findViewById(R.id.button); speakButton.setOnClickListener(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); mList = (ListView) findViewById(R.id.listView); }</code> </pre><br><br>  We set the click handler for the button, which will call the startSpeak () method, which we will discuss later: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v)</span></span></span><span class="hljs-function"> </span></span>{ startSpeak(); }</code> </pre><br><br>  Well, finally ended the "water".  We start to "speak": <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startSpeak</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Intent intent = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH); <span class="hljs-comment"><span class="hljs-comment">//       () intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM); //      intent.putExtra(RecognizerIntent.EXTRA_PROMPT, "What can you tell me?"); startActivityForResult(intent, VOICE_RECOGNITION_REQUEST_CODE); //    }</span></span></code> </pre><br><br>  It's time to give vent to fantasy and decide which teams to use.  I myself first wanted to show on the example of a tetris tank: they would dictate to him ‚Äúup‚Äù, ‚Äúdown‚Äù, ‚Äúleft‚Äù, ‚Äúfire‚Äù and so on, but <s>I</s> leave <s>it difficult for</s> you.  I gave commands to change the color of the button, exit the application, open the pages in the browser, launch the maps and reboot the device.  As for the latter, reboot, this command will work, as I understand it, only on rooted devices.  On the phone, I have the rights of a joint venture and everything works well, but on the tablet, it just ignores this command.  There is nothing complicated in the record of commands, I think comments will be enough: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onActivityResult</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> requestCode, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> resultCode, Intent data)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (requestCode == VOICE_RECOGNITION_REQUEST_CODE &amp;&amp; resultCode == RESULT_OK){ ArrayList commandList = data.getStringArrayListExtra(RecognizerIntent.EXTRA_RESULTS); mList.setAdapter(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayAdapter(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, android.R.layout.simple_list_item_1, commandList)); <span class="hljs-comment"><span class="hljs-comment">//     ,    .     //            if (commandList.contains("red")){ speakButton.setText("red"); speakButton.setBackgroundColor(Color.RED); } if (commandList.contains("blue")){ speakButton.setText("blue"); speakButton.setBackgroundColor(Color.BLUE); } if (commandList.contains("green")){ speakButton.setText("green"); speakButton.setBackgroundColor(Color.GREEN); } if (commandList.contains("yellow")){ speakButton.setText("yellow"); speakButton.setBackgroundColor(Color.YELLOW); } if (commandList.contains("white")){ speakButton.setText("white"); speakButton.setBackgroundColor(Color.WHITE); } if (commandList.contains("black")){ speakButton.setText("black"); speakButton.setBackgroundColor(Color.BLACK); } //  if (commandList.contains("finish")){ finish(); } //     if (commandList.contains("maps")){ Intent i = new Intent(); PackageManager manager = getPackageManager(); i = manager.getLaunchIntentForPackage("com.google.android.apps.maps"); i.addCategory(Intent.CATEGORY_LAUNCHER); startActivity(i); } //    if (commandList.contains("google")){ finish(); Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.google.com")); startActivity(browserIntent); } if (commandList.contains("facebook")){ finish(); Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("http://www.facebook.com")); startActivity(browserIntent); } //       //  -   "android.permission.REBOOT",        () if (commandList.contains("reboot")){ try { Process proc = Runtime.getRuntime() .exec(new String[]{ "su", "-c", "reboot -p" }); proc.waitFor(); } catch (Exception ex) { ex.printStackTrace(); } } } super.onActivityResult(requestCode, resultCode, data); }</span></span></code> </pre><br><br>  This is the command entry window: <br><br><img src="https://habrastorage.org/storage2/835/6b6/028/8356b60288f275f66df1c399bd5f476d.jpg"><br><br>  Say with a beautiful English accent "maps".  Called Google Maps: <br><br><img src="https://habrastorage.org/storage2/13b/b09/2e7/13bb092e76f3906e9d4829897e7f35a8.jpg"><br><br>  "Blue": <br><br><img src="https://habrastorage.org/storage2/a11/b38/b31/a11b38b31b6aa7b14c32b0c0c222ef09.jpg"><br><br>  As you can see, the list displays all possible (similar) words and from them the necessary for us is chosen. <br><br>  Well, on the "finish", I ended the conversation with a soulless (or not?) Machine. <br><br>  I hope my small article will encourage someone to create (not, not a terminator) any promising project that will simplify people's daily lives, and you will bring millions, or at least it will be useful.  Dare! <br><br>  PS: a couple of useful links to the <a href="http://developer.android.com/reference/android/speech/RecognizerIntent.html">documentation</a> and <a href="https://github.com/vlad0058/VoiceApp">source</a> </div><p>Source: <a href="https://habr.com/ru/post/180515/">https://habr.com/ru/post/180515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../180503/index.html">Update Kits for Windows XP x86 and Windows 7 x86-x64</a></li>
<li><a href="../180505/index.html">We study the principles of interaction between Ubuntu Touch and Android</a></li>
<li><a href="../180507/index.html">Adding Google Apps to the Android emulator (Intel x86 Atom System Image)</a></li>
<li><a href="../180509/index.html">Google coding tips in Python. Part Two: Tips for Formatting Source Code</a></li>
<li><a href="../180513/index.html">Wonderful introduction to programming</a></li>
<li><a href="../180517/index.html">Why develop electronic meeting minutes for Sharepoint 2013</a></li>
<li><a href="../180523/index.html">Dennis Ritchie's first C compiler - on Github</a></li>
<li><a href="../180525/index.html">RiSCiSO - another group of scenery, hit by the FBI</a></li>
<li><a href="../180535/index.html">Mechanical watches in the environment of a smart home</a></li>
<li><a href="../180537/index.html">Overview of data center network architectures</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>