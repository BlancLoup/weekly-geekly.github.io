<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Processes and threads in Android: we write AsyncTask correctly</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I continue my stories about Android. And this time I want to share valuable information about processes and threads, which should be well understood a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Processes and threads in Android: we write AsyncTask correctly</h1><div class="post__text post__text-html js-mediator-article">  I continue my stories about Android.  And this time I want to share valuable information about processes and threads, which should be well understood and always be on hand to avoid mistakes and misunderstandings when writing applications.  At the end of the article I will give an example of the implementation of AsyncTask, which loads the image into ImageView by pressing a button. <br><a name="habracut"></a><br>  First of all, I‚Äôll note that more details on this topic can be found in this tutorial - <a href="http://developer.android.com/guide/topics/fundamentals/processes-and-threads.html">developer.android.com/guide/topics/fundamentals/processes-and-threads.html</a> <br><br>  <b>A note about processes and threads in Android</b> <br><br>  When an application component starts and the application has no other components running, Android creates a new process for an application with a single thread of execution.  By default, all components of a single application run in the same process, in a thread called the ‚Äúmain‚Äù one.  If the application component starts and a process already exists for the application (some component from the application exists), then the component is started in this process and uses its execution flow.  You can change this behavior by specifying different processes for different components of your application.  In addition, you can add threads to any process. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You can define a separate process for a component using the manifest file.  Each component tag (activity, service, receiver and provider) supports the android: process attribute.  This attribute allows you to specify the process in which the component will run.  You can also specify the process in which components of different applications will run.  This attribute is also supported by the application tag, which allows you to define a specific process for all application components. <br><br>  Android tries to maintain the application process for as long as possible, but when resources are required, old processes will be superseded by importance hierarchy. <br><br>  There are 5 levels of importance hierarchy: (the processes of the first level from the list will be deleted last) <br><br>  <i>1. Process with which the user interacts (Foreground process)</i> <br>  Such processes include for example: activit with which it interacts to use;  the service (Service instance) with which the user interacts;  service started by startForeground () method;  a service that performs one of the methods of its life cycle;  BroadcastReceiver which executes the onReceive () method. <br><br>  <i>2. Visible process</i> <br>  A process in which the conditions from clause 1 are not met, but which influences what the user sees on the screen.  For example, the onPause () method is activated. <br><br>  <i>3.Service process</i> <br>  Service started by startService () method <br><br>  <i>4. Background process</i> <br>  A process running in the background that is invisible to the user. <br><br>  <i>5. Empty process</i> <br><br>  I note that there is an onLowMemory () method in the application components, but it‚Äôs impossible to rely on this method to be called, it‚Äôs also impossible to rely on the onDestroy () method 100%, so the logic of storing data or any settings can be implemented in onStop (), which (as they assure) is exactly called. <br><br>  When an application is launched, the system creates a ‚Äúmain‚Äù thread of execution for this application, also called a UI thread.  This stream is very important, since it is in it that the widgets (buttons, lists) are rendered and the events of your application are processed.  The system does not create a separate thread for each component instance.  All components that are running in the same process will be created in the UI thread.  The Android UI library is not thread safe, so two important rules must be followed: <br><br>  1) Do not block the UI thread <br>  2) Do not access components of the user interface from outside the UI thread. <br><br>  Now, suppose that we had a task - to upload a picture to the ImageView from the network and immediately display it.  How will we proceed?  Logically, we will create a separate thread that will do all our work, like this: <br><pre><code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">View v</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Bitmap b = loadImageFromNetwork(<span class="hljs-string"><span class="hljs-string">"http://example.com/image.png"</span></span>); mImageView.setImageBitmap(b); } }).start(); }</code> </pre> <br>  It looks believable, since we rendered the operation of loading the image into a separate stream.  The problem is that we have violated rule number 2.  You can fix this problem using the following methods: <br><br>  Activity.runOnUiThread (Runnable) <br>  View.post (Runnable) <br>  View.postDelayed (Runnable, long) <br><br>  For example, we will use the first of them: <br><pre> <code class="hljs java"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Bitmap bitmap = loadImageFromNetwork(<span class="hljs-string"><span class="hljs-string">"http://example.com/image.png"</span></span>); mImageView.post(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ mImageView.setImageBitmap(bitmap); } }); } }).start(); }</code> </pre><br>  Now the implementation is thread-safe: the network operation is performed in a separate thread, and the ImageView is accessed from the UI stream. <br>  Fortunately, these operations can be combined with the help of inheriting the Handler class and implementing the necessary logic, but the best solution is to inherit the AsyncTask class. <br><br>  AsyncTask allows you to perform asynchronous work and make user interface updates. <br>  To update, implement the onPostExecute () method, and enclose all background work in the doInBackground () method.  After you implement your own task, you need to run it with the execute () method. <br><br>  I give the promised example of AsyncTask, which implements the task of loading and displaying a picture (a variant with annotations and deviations from the use of the standard dialog protocol): <br><pre> <code class="hljs scala"><span class="hljs-meta"><span class="hljs-meta">@EActivity</span></span>(<span class="hljs-type"><span class="hljs-type">R</span></span>.layout.main) public <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DownloadImageActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-type"><span class="hljs-type">ProgressDialog</span></span> progress; <span class="hljs-meta"><span class="hljs-meta">@ViewById</span></span> <span class="hljs-type"><span class="hljs-type">ImageView</span></span> image; <span class="hljs-meta"><span class="hljs-meta">@ViewById</span></span> <span class="hljs-type"><span class="hljs-type">Button</span></span> runButt; <span class="hljs-type"><span class="hljs-type">String</span></span> pictUrl = <span class="hljs-string"><span class="hljs-string">"http://www.bigfoto.com/sites/main/churfirsten_switzerland-xxx.JPG"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@BeforeCreate</span></span> void getProgressDialog(){ progress = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">ProgressDialog</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); progress.setMessage(<span class="hljs-string"><span class="hljs-string">"Loading..."</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Click</span></span>(<span class="hljs-type"><span class="hljs-type">R</span></span>.id.runButt) void runClick(){ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">DownloadImageTask</span></span>().execute(pictUrl); } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DownloadImageTask</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AsyncTask&lt;String</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bitmap&gt;</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-type"><span class="hljs-type">Bitmap</span></span> doInBackground(<span class="hljs-type"><span class="hljs-type">String</span></span>... params) { publishProgress(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Void</span></span>[]{}); <span class="hljs-comment"><span class="hljs-comment">//or null String url = ""; if( params.length &gt; 0 ){ url = params[0]; } InputStream input = null; try { URL urlConn = new URL(url); input = urlConn.openStream(); } catch (MalformedURLException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); } return BitmapFactory.decodeStream(input); } @Override protected void onProgressUpdate(Void... values) { super.onProgressUpdate(values); progress.show(); } @Override protected void onPostExecute(Bitmap result) { super.onPostExecute(result); progress.dismiss(); image.setImageBitmap(result); } } }</span></span></code> </pre><br><br>  And now we will consider the most correct option from the point of view of working with dialogues: <br><pre> <code class="hljs java"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DownloadImageActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ ImageView image; Button runButt; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String PICT_URL = <span class="hljs-string"><span class="hljs-string">"http://www.bigfoto.com/sites/main/churfirsten_switzerland-xxx.JPG"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> PROGRESS_DLG_ID = <span class="hljs-number"><span class="hljs-number">666</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> String DEBUG_TAG = <span class="hljs-string"><span class="hljs-string">"+++ImageDownloader+++"</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.main); loadViews(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadViews</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ runButt = (Button)findViewById(R.id.runButt); image =(ImageView)findViewById(R.id.image); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Dialog </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateDialog</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dialogId)</span></span></span></span>{ ProgressDialog progress = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (dialogId) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> PROGRESS_DLG_ID: progress = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProgressDialog(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); progress.setMessage(<span class="hljs-string"><span class="hljs-string">"Loading..."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> progress; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runButtonHandler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(View button)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(button.getId() == R.id.runButt) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DownloadImageTask().execute(PICT_URL); } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DownloadImageTask</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AsyncTask</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">String</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Void</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bitmap</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> Bitmap </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doInBackground</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String... params)</span></span></span><span class="hljs-function"> </span></span>{ publishProgress(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Void[]{}); String url = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( params.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ){ url = params[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } InputStream input = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { URL urlConn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URL(url); input = urlConn.openStream(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (MalformedURLException e) { Log.d(DEBUG_TAG,<span class="hljs-string"><span class="hljs-string">"Oops, Something wrong with URL..."</span></span>); e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { Log.d(DEBUG_TAG,<span class="hljs-string"><span class="hljs-string">"Oops, Something wrong with inpur stream..."</span></span>); e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> BitmapFactory.decodeStream(input); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onProgressUpdate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Void... values)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onProgressUpdate(values); showDialog(PROGRESS_DLG_ID); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onPostExecute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bitmap result)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onPostExecute(result); dismissDialog(PROGRESS_DLG_ID); image.setImageBitmap(result); } } }</code> </pre><br>  The code has become bigger, but it is better to use the standard protocol for working with dialogs. <br>  I also removed all the annotations to make it easier for newbies to try this code. <br><br>  Do not forget to add an attribute with the specified value to your button markup: android: onClick = "runButtonHandler" <br><br>  And I will add: in the official document ( <a href="http://developer.android.com/reference/android/os/AsyncTask.html">tyts</a> ) as well as in my case, preExecute () is not used, but if you need to perform some actions with your user interface before starting the task, then boldly use this method. <br><br>  Parameters passed to AsyncTask: <br>  1. Parameters (in our case, the URL). <br>  2. Progress (units defining the course of the task change).  In our case, not used. <br>  3. The result of the task (in our case, the object Bitmap) <br><br>  The code is pretty simple: we do all the background work in the doInBackGround () method, calling the publishProgress () method so that our ProgressDialog spins when the image is loaded when the onProgressUpdate () method is called.  After performing the background work, the onPostExecute () method is called into which the result of the doInBackGround () method is transferred, in our case it is a Bitmap object and right there we load it into the ImageView. <br>  I will note a couple of important points that need to be considered: <br><br>  1) The doInBackGround () method runs in the background thread, so there is no access to the UI stream within this method. <br>  2) The onPostExecute () and onProgressUpdate () methods are executed in the UI thread, so we can safely refer to our UI components. <br><br>  <b>Conclusion</b> <br><br>  Yes, I applied the android-annotations library again, so don't be scared by annotations. <br><br>  I want to note the importance of understanding the process model in Android, in order to prevent mistakes when developing applications. <br><br>  This article is the processing of available information + personal experience in the implementation of this task and work with streams. <br><br>  As always, suggestions and comments about the material of the article in a personal.  If you have something to add or supplement - feel free to write in the comments. <br><br>  <b>UPD The</b> article is updated by adding a more accurate version in terms of working with dialogs. </div><p>Source: <a href="https://habr.com/ru/post/124484/">https://habr.com/ru/post/124484/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124479/index.html">What is Google making money on? Top 20 most expensive words in Google Adwords</a></li>
<li><a href="../124480/index.html">Version migration of the database structure: from theory to practice</a></li>
<li><a href="../124481/index.html">Stackato: deploy Perl application in your cloud in 3 steps</a></li>
<li><a href="../124482/index.html">Creating a multiboot USB HDD or flash drive</a></li>
<li><a href="../124483/index.html">Google+ application for iPhone appeared on the App Store</a></li>
<li><a href="../124486/index.html">Rent textbooks with Amazon</a></li>
<li><a href="../124491/index.html">Remote mouse control using .NET Remoting</a></li>
<li><a href="../124492/index.html">Correct setting DDoS Deflate</a></li>
<li><a href="../124493/index.html">Truecrypt collects $ 150,000, but why?</a></li>
<li><a href="../124495/index.html">Mechanics of casual games</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>