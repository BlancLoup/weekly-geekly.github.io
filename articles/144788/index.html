<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Trikopter on Crius MultiWii controller</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ATTENTION, the article is outdated, but it can still be used for informational purposes. 

 Inspired by the article with rcexplorer on the simple cons...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Trikopter on Crius MultiWii controller</h1><div class="post__text post__text-html js-mediator-article">  <b>ATTENTION, the article is outdated, but it can still be used for informational purposes.</b> <br><img src="https://habrastorage.org/storage2/079/4ac/166/0794ac166fa5fd7a09f20bb6449c5702.jpg"><br>  Inspired by the <a href="http://rcexplorer.se/projects/tricopterv25/tricopterv25.html">article with rcexplorer</a> on the simple construction of a copter ( <a href="http://habrahabr.ru/post/141669/">here is my translation</a> ), I also made myself a small flying unit with 3 motors, but with different brains and an aluminum base of rays instead of wood. <br><a name="habracut"></a><br>  I will keep silent about some things, as they are described <a href="http://habrahabr.ru/post/141669/">in</a> detail <a href="http://habrahabr.ru/post/141669/">in the last article</a> . <br><br><h4>  Frame </h4><br>  The frame is made very simple.  We take a piece of fiberglass or other similar thin and durable material, cut two parts of the central part of the desired size and, fastening the resulting parts with two third-party tape, drill 6 holes in them to fix the rays: 2 holes per beam, and each beam at an angle of 120 degrees.  It is desirable to calculate in advance the distance from the axis of the motor to the center of the connection of the rays, otherwise there may be problems with the future tuning of the flight controller. <br>  If you do not know where to find fiberglass, then you can always <a href="http://www.taydaelectronics.com/copper-clad-board-pcb-single-side-6x6.html">order</a> on the website taydaelectronics.com, one square measuring 6 by 6 inches costs a little more than $ 1, but you need to buy at least 5 pieces to keep within the minimum weight of the package. <br><img src="https://habrastorage.org/storage2/bd5/7c9/fc9/bd57c9fc98bd21116c5bf5d8d259970d.jpg"><br>  Now we need a lightweight and durable aluminum profile.  As I was lazy to go shopping, and time was patient, I <a href="http://www.goodluckbuy.com/aluminum-square-tube-13mm-x-13mm-x-0-8mm-x-250mm-4-pack-for-quadcopter-multicopter.html">ordered a set of 4 beams</a> , 25 cm long, each from the GoodLuckBuy website. <br>  I usually estimate the location and dimensions in inkscape, then leave the contour, print and paste on the workpiece. <br><img src="https://habrastorage.org/storage2/aea/522/72a/aea52272abacf30e8e024d566079fc13.png"><br>  At the time of construction, I had only a small piece of foiled fiberglass, so it turned out two rectangles of size 65 by 85 mm.  In which later 4 more holes were made for fastening the suspension with a battery and a camera. <br><img src="https://habrastorage.org/storage2/c9b/146/22c/c9b14622c8f666444dc5ff01af41df91.jpg"><br>  The result was such a frame, fastened with <a href="http://www.ebay.com/itm/370555753904">plastic bolts</a> and nuts, which also does not add up badly (later it will not be so beautiful, but still compact) <br><br><h4>  Swivel mechanism </h4><br>  The most difficult and problematic place of the tricopter is a rotating mechanism of the rear motor, which serves to compensate for the rotation, as well as for turning.  That's just because of him for a long time did not dare to build a "three rubles", but really wanted in view of the economy and the ability to easily fold the frame for transportation.  As in David's article, I took <a href="http://www.hobbyking.com/hobbyking/store/uh_viewitem.asp%3Fidproduct%3D8432">these things</a> : <br><img src="https://habrastorage.org/storage2/8b2/491/ba6/8b2491ba6bdb9c856fc5d60d032f0c9a.jpg"><br>  But there was an error with the servo (I wanted to save a little, but I had to buy it twice), so the first version of the mechanism turned out to be quite large and heavy. <br><img src="https://habrastorage.org/storage2/777/7b1/26e/7777b126ea54cddd1ceb3245850f776d.jpg"><br>  Therefore, I recommend immediately take the servos BMS-385DMAX, specified <a href="http://habrahabr.ru/post/141669/">in the article David</a> . <br>  Note that the screed holding the swivel mechanism does not fall off, you should slightly bend the profile.  I also recommend screwing a small piece of wood into the recess of the white block of the mechanism, as well as using 2-sided tape or glue. <br><img src="https://habrastorage.org/storage2/fb4/491/fc8/fb4491fc86399ce97e15770b69102fb3.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Speed ‚Äã‚Äãcontrollers, motors and propellers </h4><br>  By tradition (and there was a house <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3FidProduct%3D13429">too</a> ) <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3FidProduct%3D13429">HobbyKing BlueSeries 30A</a> speed <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3FidProduct%3D13429">controllers</a> and <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3FidProduct%3D4700">20-22L</a> motors.  Speed ‚Äã‚Äãcontrollers had to lengthen the power wires to conveniently remove the <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3FidProduct%3D9572">power connector</a> , and even to reach the <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3FidProduct%3D11911">battery</a> .  And of course, you need to slightly change the settings of the speed controllers by turning on the Brake, increasing Timing to High and removing smooth acceleration (on different speed controllers there are different parameters, but on the whole, put everything so that it is faster). <br><img src="https://habrastorage.org/storage2/b23/8f6/c3d/b238f6c3d8f32617d7a104f74bcc00f3.jpg"><br>  <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3Fidproduct%3D22452">The propellers are</a> <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3Fidproduct%3D22453">multidirectional</a> , according to the rotations of the motors: the front left rotates clockwise, the front right counterclockwise, and the rear one, depending on your settings (I remind you that to change the direction of rotation, it is enough to change any 2 wires from the speed controller to the motor in some places). <br><br><h4>  Suspension, battery and rack </h4><br>  Suspension in this case is just plywood, cut to the width of the battery.  <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3FidProduct%3D9374">Velcro is</a> glued to the plywood (the other part is on the battery) and at the same time <a href="http://www.goodluckbuy.com/battery-fastener-magic-sticker-for-multicopter-aeroplane-2pcs.html">an additional</a> adhesive tape is inserted to securely attach the battery. <br><img src="https://habrastorage.org/storage2/ebe/dde/526/ebedde52620a37cfbfb1876072fd50d3.jpg"><br>  <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3FidProduct%3D7579">Silicone tubes</a> are attached to the suspension through the screeds, other silicone tubes are attached to the frame on the screeds, and then fastened together to dampen the vibration on the camera. <br><img src="https://habrastorage.org/storage2/84d/285/ff0/84d285ff0413097dc4f4ba37639ed4f1.jpg"><br>  To prevent the copter from landing on the battery (which is extremely dangerous), 3 small rectangles can be cut out of PCB remnants and, by drilling holes in them, fasten them to the rays with ties. <br><img src="https://habrastorage.org/storage2/4fc/6eb/5fe/4fc6eb5fed01743fef1028be87310ee2.jpg"><br>  With a relatively hard landing, the screeds fall off, quenching most of the fall energy, so the battery does not suffer (tested in a fall from 7 meters on the asphalt). <br><br><h4>  Crius Lite Flight Controller </h4><br>  Not so long ago, a very cheap flight controller with atmega328p and a set of sensors appeared on the site goodluckbuy: a gyro + accelerometer for the <a href="http://www.goodluckbuy.com/mwc-multiwii-lite-4-axis-x-mode-flight-control-board-quadx-w-ftdi-basic-breakout-.html">Lite version</a> and an additional barometer and compass for the <a href="http://www.goodluckbuy.com/mwc-multiwii-se-standard-edition-4-axis-flight-control-board-quadx-w-ftdi-basic-breakout-.html">Standart version</a> .  I took the Lite version for two reasons: the price (at the time of purchase, the difference was 2 times) and the senselessness of other sensors (the course holds perfectly without a compass, and holding the height with jumps + -2 meters on the bmp085 sensor does not inspire me). <br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/5f6/6dc/2f3/5f66dc2f31892cd1b363f27da9e33d8e.jpg"></div><br>  After the purchase, I recommend otkovyryat all unnecessary and rinse the handkerchief in alcohol, as almost all the Chinese have left a lot of conductive dirt that closes the contacts and can just kill the controller. <br><img src="https://habrastorage.org/storage2/5c5/d86/2bb/5c5d862bba4bfbf5c76553b30561ecb3.jpg"><br>  Fasten the board and related equipment (receiver) to the frame with <a href="http://www.hobbyking.com/hobbyking/store/uh_viewItem.asp%3FidProduct%3D8999">foam tape</a> .  It holds very firmly, and at the same time it eliminates vibrations a little.  (Only do not fasten the antenna so if you are going to fly far). <br>  The weight of the copter is about 800 grams, the flight time with a 2.2Ah battery and camera up to 200 grams is about 10 minutes, while the power reserve is still about 40-50%. <br>  The iron part ends and the game begins with the software. <br><br><h4>  Software </h4><br>  After the first connection of the board, it turned out that the flooded firmware is quite old, and with the sensor axes mixed up, i.e.  You can even fly on this one.  Therefore, download the <a href="http://arduino.cc/en/Main/Software">Arduino IDE</a> and the <a href="http://code.google.com/p/multiwii/downloads/list">new firmware</a> (do not download the dev!), And even better is the <a href="http://forum.rcdesign.ru/blogs/83206/blog14262.html">port</a> from <a href="https://geektimes.ru/users/mahowik/" class="user_link">mahowik</a> with a bunch of improvements. <br><br><h5>  Customization </h5><br>  Open through Arduino IDE sketch-firmware.  The entire configuration is described in the config.h file (more details about most of the parameters and settings can be found <a href="http://airm.ru/articles/2">here</a> , in this article many trivia are omitted).  For a tricopter we set the frame type #define TRI, the type of sensor board #define CRIUS_LITE and the filter for the gyro #define ITG3200_LPF_42HZ.  And now in the Arduino IDE settings, select any 328p Arduinka and fill the resulting sketch. <br>  Run MultiWiiConf for your system. <br><img src="https://habrastorage.org/storage2/981/6ca/3e9/9816ca3e9553aa7e35691395e5cec2ae.png"><br>  Since our rotary mechanism uses servo, which has properties to burn under heavy loads, it is better to find out and set limits for deviations of the serva.  To do this, use the YAW stick on the control panel to reject the servo left and right and remember the maximum and minimum SERVO value in its extreme positions, and then enter these values ‚Äã‚Äãin the config.h file <br><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* you can change the tricopter servo travel here */</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> TRI_YAW_CONSTRAINT_MIN 1340 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> TRI_YAW_CONSTRAINT_MAX 1855</span></span></code> </pre> <br>  And reload the sketch into the controller.  Now you can try to take off, but note that the copter will rotate, so stream the YAW channel on the console so that there are no rotations during takeoff and flights, and then go back to MultiWiiConf, look at this value in the SERVO field and change it to <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> TRI_YAW_MIDDLE 1630 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// tail servo center pos. - use this for initial trim; later trim midpoint via LCD</span></span></span></span></code> </pre><br>  ATTENTION!  In the new firmware (2.0 and higher), similar trimming is done through the LCD screen or terminal, if you do not have either one or the other, you will have to change the code in Output.ino a little <br><pre> <code class="cpp hljs"> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifdef</span></span></span><span class="hljs-meta"> TRI motor[0] = PIDMIX( 0,+4/3, 0); </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//REAR motor[1] = PIDMIX(-1,-2/3, 0); //RIGHT motor[2] = PIDMIX(+1,-2/3, 0); //LEFT servo[5] = constrain(TRI_YAW_MIDDLE + YAW_DIRECTION * axisPID[YAW], TRI_YAW_CONSTRAINT_MIN, TRI_YAW_CONSTRAINT_MAX); //REAR #endif</span></span></span></span></code> </pre><br>  Ready configuration file for my trikopter <a href="http://nekaka.com/d/sgNj8AXp2Y">nekaka.com/d/sgNj8AXp2Y</a> - maybe someone will come in handy. <br>  Now you can <a href="http://airm.ru/articles/2">configure the PID</a> , add <a href="http://airm.ru/articles/2">camera grip control, etc.</a>  , as well as <a href="http://airm.ru/articles/2">add GPS support</a> with hold and return home functions. <br><br><h4>  Conclusion </h4><br>  In fact, the construction and configuration will be a lot of incomprehensible and interesting.  But the occupation of aircraft modeling is demanding, and the occupation of copters is twofold, especially if you are a programmer and you want to improve the code of one of the open source projects. <br>  And in the conclusion of the video of the recent flight, during which the kopter was badly damaged, but was quickly repaired right there on the field (thanks to the screeds and plastic bolts). <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/aD_AZEvw2uQ%3Ffeature%3Doembed&amp;xid=17259,15700002,15700021,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhgzCRp-BF3L3u8SV52M_zgfSiknSQ" frameborder="0" allowfullscreen=""></iframe><br>  The shooting was carried out with 2x devices: a quadrocopter with a GoPro camera and my tricopter with an onboard FPV camera, the picture with which was recorded on the ground on an old miniDV camera. <br>  ps: if you have any questions - ask, I will update the article as much as possible. </div><p>Source: <a href="https://habr.com/ru/post/144788/">https://habr.com/ru/post/144788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../144779/index.html">Finland is the birthplace of Windows Phone</a></li>
<li><a href="../144783/index.html">Tecart - a new theme for opencart</a></li>
<li><a href="../144784/index.html">QML and QtQuick webinars: states and transitions</a></li>
<li><a href="../144785/index.html">Facebook is negotiating the purchase of Face.com</a></li>
<li><a href="../144787/index.html">Visa Electron and Maestro in e-commerce. First results</a></li>
<li><a href="../144789/index.html">Free licenses for open source projects and educational institutions</a></li>
<li><a href="../144790/index.html">The Japanese started selling a smartphone with a radiation sensor</a></li>
<li><a href="../144791/index.html">At Harvard, robots are collected as children's folding books</a></li>
<li><a href="../144793/index.html">Russian Code Cup 2012: a detailed analysis of the tasks from the first qualification</a></li>
<li><a href="../144794/index.html">Solving problems with the horizon and vertical video on camera phones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>