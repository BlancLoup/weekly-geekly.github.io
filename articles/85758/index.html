<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LogParser - a familiar look at unusual things</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When I once again used LogParser, then to penetrate and other people's experiences, I entered its name into the search on Habr√©. As a result - the mes...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LogParser - a familiar look at unusual things</h1><div class="post__text post__text-html js-mediator-article"> When I once again used LogParser, then to penetrate and other people's experiences, I entered its name into the search on Habr√©.  As a result - the message "Surprisingly, but the search has not yielded results."  This is truly amazing when such an interesting tool is overlooked.  It's time to fill this gap.  So, meet the <a href="http://www.microsoft.com/downloads/details.aspx%3FFamilyID%3D890cd06b-abf8-4c25-91b2-f8d975cf8c07%26DisplayLang%3Den">LogParser</a> .  A small but damn useful utility for SQL lovers. <br><br>  From the name of the tool, it would seem very difficult to understand what it does in the SQL section.  And the truth is that it is the same LogParser, like the ChartGenerator.  In the sense that he copes with both tasks with the same success.  In general, I would describe it as a heterogeneous data SQL processor.  The concept of work in general is such that it takes data from a certain format and converts it into a tabular view (in fact, it is only at this stage that the parsing is done sometimes).  Then, by running some SQL query on these tabular data, it forms a table with the result and saves it again in some format.  In short, the chain looks like preparing input data-&gt; SQL processing-&gt; generating output data. <a name="habracut"></a>  Or, as illustrated in the documentation: <br><img src="https://habrastorage.org/getpro/habr/post_images/e3e/c35/024/e3ec35024d4996984b669e38ddc9c7c2.gif" alt="image"><br>  It‚Äôs time, perhaps, to move from theory to practice, for it is much more visual.  Let's start for the seed with this example: <br><br> <code>X:\&gt;LogParser.exe -i:FS -o:CSV "SELECT TOP 100 HASHMD5_FILE(Path) AS Hash, COUNT(*) AS FileCount, AVG(Size) AS FileSize INTO Duplicates.csv FROM X:\Folder\*.* GROUP BY Hash HAVING FileCount &gt; 1 AND FileSize &gt; 0 ORDER BY FileSize DESC" <br> <br> Statistics: <br> ----------- <br> Elements processed: 10 <br> Elements output: 2 <br> Execution time: 0.06 seconds</code> <br> <br>  I think many immediately guessed what the mystery happened here.  In the familiar and familiar SQL style, we select ... files from the X: \ Folder folder, group these files by MD5, in order to identify duplicates among them by content.  Naturally, we discard those cases when the number of such files = 1 (i.e. there are no identical ones).  In addition, we organize the found duplicates in descending order of size and display only the top 100 of the most gross.  To make sure that the result is correct, look in the Duplicates.csv file.  There you will find something in the following spirit: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>Hash,FileCount,FileSize <br> 7EF9FDF4B8BDD5B0BBFFFA14B3DAD42D,2,5321 <br> 5113280B17161B4E2BEC7388E617CE91,2,854</code> <br> <br>  The first value is the MD5 hash of duplicates found, the second is their number and the third is the size.  Let us now try to decompose the code of the example in accordance with the previously described concept.  Input data is determined by the provider of the input format and some address according to the selected provider.  In our case, it is specified with the -i: FS option for the file system.  And specific data is addressed (folder X: \ Folder) in the FROM part of our SQL query.  A query to the registry, for example, for the \ HKLM \ Software branch would look like this: LogParser.exe -i: REG "SELECT * FROM \ HKLM \ Software".  Provider - REG, address - \ HKLM \ Software. <br><br>  By default, LogParser offers us the following source formats providers: <br><br>  <b>IIS Log File Input Formats</b> <br><ul><li>  IISW3C: parses IIS log files in the W3C Extended Log File Format. </li><li>  IIS: parses IIS log files in the Microsoft IIS Log File Format. </li><li>  BIN: parses IIS log files in the Centralized Binary Log File Format. </li><li>  IISODBC: Returns IISODBC when I have logged in to the ODBC Log Format. </li><li>  HTTPERR: parses HTTP error log files generated by Http.sys. </li><li>  URLSCAN: parses log files generated by the URLScan IIS filter. </li></ul><br>  <b>Generic Text File Input Formats</b> <br><ul><li>  CSV: parses comma-separated values ‚Äã‚Äãtext files. </li><li>  TSV: parses tab-separated and space-separated values ‚Äã‚Äãtext files. </li><li>  XML: parses XML text files. </li><li>  W3C: parses text files in the W3C Extended Log File Format. </li><li>  NCSA: The NCSA Common, Combined, and Extended Log File Formats. </li><li>  TEXTLINE: returns lines from generic text files. </li><li>  TEXTWORD: returns words from generic text files. </li></ul><br>  <b>System Information Input Formats</b> <br><ul><li>  EVT: returns events from the event log files (.evt files). </li><li>  FS: returns information on files and directories. </li><li>  REG: returns information on registry values. </li><li>  ADS: returns information on Active Directory objects. </li></ul><br>  <b>Special-purpose Input Formats</b> <br><ul><li>  NETMON: parses network capture files created by NetMon. </li><li>  ETW: parses Enterprise Tracing for Windows trace log files and live sessions. </li><li>  COM: provides an interface to the COM. </li></ul><br>  Already a lot.  And given that you can create your own providers - generally wonderful.  Later, I will touch on this issue and show how you can create them as ‚Äúgrown-ups‚Äù using compiled assemblies, as well as on-the-fly, simply using scripts. <br><br>  The output artifact format is defined in a similar way.  With the -o: CSV option, we indicated that we are interested in the provider for CSV files, and in the INTO part of our SQL query, we addressed the search file to which the result will be saved.  By analogy with the input providers, we list the weekends that are available out of the box. <br><br>  <b>Generic Text File Output Formats</b> <br><ul><li>  NAT: formats output records as readable tabulated columns. </li><li>  CSV: formats output records as comma-separated values ‚Äã‚Äãtext. </li><li>  TSV: format output records as tab-spaced or space-space values ‚Äã‚Äãtext. </li><li>  XML: formats output records as XML documents. </li><li>  W3C: formats output records in the W3C Extended Log File Format. </li><li>  TPL: formats output records following user-defined templates. </li><li>  IIS: formats output records in the Microsoft IIS Log File Format. </li></ul><br>  <b>Special-purpose Output Formats</b> <br><ul><li>  SQL: uploads output to a table in a SQL database. </li><li>  SYSLOG: sends output records to a Syslog server. </li><li>  DATAGRID: displays output records in a graphical user interface. </li><li>  CHART: creates image files containing charts. </li></ul><br><br>  Let's try another example for priming with completely different input and output providers.  For example, the frequently encountered task of analyzing web server logs and displaying the top of referring sites. <br><br> <code>c:\Program Files\Log Parser 2.2&gt;LogParser.exe -i:W3C -o:CHART "SELECT TOP 10 DISTINCT EXTRACT_TOKEN(EXTRACT_TOKEN(cs(Referer), 1, '://'), 0, '/') AS Domain, COUNT(*) AS Hits INTO Hits.gif FROM X:\ex0909.log WHERE cs(Referer) IS NOT NULL AND Domain NOT LIKE '%disele%' GROUP BY Domain ORDER BY Hits DESC" -chartType:Column3D -chartTitle:"Top 10 referrers" -groupSize:800x600 <br> <br> Statistics: <br> ----------- <br> Elements processed: 1410477 <br> Elements output: 10 <br> Execution time: 16.92 seconds</code> <br> <br>  As you can see, LogParser thrashed nearly half a million records in less than 17 seconds with non-trivial conditions on the old Pentium D 2.8, which, in my opinion, is not such a bad result.  Well, the main result is in the picture: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/06e/7fa/36b/06e7fa36b3f25e59edb4f4f202b1152c.gif" alt="image"><br><br>  It seems to me that this is a terrific tool for database managers :), because it allows us to apply SQL magic where we often wanted, but it was impossible.  Behind this thesis, for the time being I will suspend my narration.  First of all, it‚Äôs possible to talk about LogParser for a long time and it will not fit in the framework of one post.  Secondly, I would like to hope that this material is enough to at least slightly interest my colleagues in the workshop and understand how much they share my enthusiasm for this utility.  And as soon as they are interested in continuing, I will immediately do it, because there are a lot of unsolved topics left.  This is the conversion mode.  And the formation of the output directly, as well as using LogParser-templates and XSLT.  Incremental mode for working with large amounts of data.  Creating your own input formats using the example of C # and JavaScript.  Use LogParser from applications.  Multvvod and multiple output in multiple files.  Familiar with the abundance of subtleties SQL LogParser'a, including the vastness of its functions.  Various options and command line options.  Subtleties of various providers and their configuration.  And of course, more examples of all sorts and different :) </div><p>Source: <a href="https://habr.com/ru/post/85758/">https://habr.com/ru/post/85758/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../85745/index.html">Starcraft 2 is offline. But there is no one to play with</a></li>
<li><a href="../85749/index.html">Individual approach</a></li>
<li><a href="../85750/index.html">Solving the problem with ajax-loading files in the jQuery Form plugin in Opera 10</a></li>
<li><a href="../85754/index.html">The Internet Community of Kyrgyzstan is being created.</a></li>
<li><a href="../85755/index.html">3D solar panels</a></li>
<li><a href="../85759/index.html">The rector of the Iranian University of Jihad announced the successful testing of the first Iranian aircraft driven by solar energy</a></li>
<li><a href="../85760/index.html">StreamTorrent - watch streaming video</a></li>
<li><a href="../85761/index.html">We buy abroad through intermediary services</a></li>
<li><a href="../85766/index.html">One day</a></li>
<li><a href="../85767/index.html">MacHeist distributes Squeeze!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>