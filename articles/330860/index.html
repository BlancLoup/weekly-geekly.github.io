<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Transition from ASP.NET to Angular2 with features (personal experience)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Expanded Theme: Splitting ASP.NET into Front-End (Angular) and Back-End (WebApi) 

 Features: corporate development (hence the main browser - IE, web ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Transition from ASP.NET to Angular2 with features (personal experience)</h1><div class="post__text post__text-html js-mediator-article">  <u>Expanded Theme:</u> Splitting ASP.NET into Front-End (Angular) and Back-End (WebApi) <br><br>  <u>Features:</u> corporate development (hence the main browser - IE, web server - IIS, environment - Windows);  this is a partial refactoring, but rather a redesign of the web part (there is a legacy code, orientation to the existing UX); <br><br>  <u>Causes and goals:</u> The goal is to redesign the architecture of the web component (in the current version of ASP.NET Forms + WCF), because of the impossibility / complexity of solving the problems and new requirements (complete update of the pages after the postback, resubmitting the form, complex navigation and related problems with data in forms). <br><div style="text-align:center;"><img src="https://camo.githubusercontent.com/d483cd3d9134d01bcca3f0a368f7cd91b231c102/68747470733a2f2f64616d69656e626f642e66696c65732e776f726470726573732e636f6d2f323031362f30362f76735f7765627061636b5f616e67756c6172322e706e673f773d363030" alt="image"></div><br>  Everything described is based on personal experience (or, accordingly, its absence - just a month ago I knew nothing about the Node.js and Angular except the name).  If you are interested in a brief description of the article, let's begin. <br><a name="habracut"></a><br>  In the midst of a search for a new architecture (at that time I tried to use ASP.NET MVC) I came across a video from channel9 ‚Äú <a href="https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/WEB-103">Building web apps powered by Angular 2.x using Visual Studio 2017</a> ‚Äù and its <a href="https://blogs.msdn.microsoft.com/webdev/2017/02/14/building-single-page-applications-on-asp-net-core-with-javascriptservices/">text variation</a> .  After reading parallel to the official website of Angular, I penetrated and began to try to discover the following advantages: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  Modern (in some places even too much) and popular technology; </li><li>  Suitable for VisualStudio (due to Typescript) Front-End framework; </li><li>  Modular architecture; </li><li>  Without much difficulty, the written test program solved the main problems (including which I could not solve with MVC). </li></ul><br>  Naturally found and cons: <br><br><ul><li>  Little is aimed at IE: errors in the browser are treated with polyfills / shim, but during debugging in the Visual Studio console, there are constant javascript exceptions (which seem to have no effect on the work, but who knows how this will manifest when the program becomes more complex); </li><li>  Difficulties in communicating with the legacy part (WCF service): Core and the .NET Framework are not fully compatible (in Core 2.0 they promise to improve this situation); </li><li>  Additional complexity / features of deployment in IIS; </li><li>  The finished complex configuration: it is not clear what, how and why it works, it is difficult to modify; </li><li>  (It follows from the previous paragraph) binding to the version and the existing configuration. </li></ul><br>  So I began to read, understand, and came across a simple <a href="https://github.com/Burgyn/Angular2VisualStudioTemplate">WebApi + Angular 2</a> project template based on the official <a href="https://angular.io/guide/visual-studio-2015">Visual Studio 2015 QuickStart</a> tutorial.  Having repulsed from this template, I began to modify the project for myself (you can read the entire code from the link to GitHub below): <br><br><ul><li>  Removed extra npm packages - everything related to testing (karma, protractor etc.) and is not necessary for a minimum start; <br></li><li>  Updated to Angular 4.x. <br><br><div class="spoiler">  <b class="spoiler_title">package.json</b> <div class="spoiler_text">  Final option <br><br><pre><code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"angular-quickstart"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"QuickStart package.json from the documentation for visual studio 2017 &amp; WebApi"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"scripts"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"build:prod"</span></span>: <span class="hljs-string"><span class="hljs-string">"webpack --config config/webpack.prod.js --colors --progress"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"build"</span></span>: <span class="hljs-string"><span class="hljs-string">"webpack --colors"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"build:vendor"</span></span>: <span class="hljs-string"><span class="hljs-string">"webpack --config config/webpack.vendor.ts --colors"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"typings"</span></span>: <span class="hljs-string"><span class="hljs-string">"typings install"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"keywords"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"author"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"license"</span></span>: <span class="hljs-string"><span class="hljs-string">"MIT"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dependencies"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@angular/common"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@angular/compiler"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@angular/core"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@angular/forms"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@angular/http"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@angular/platform-browser"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@angular/platform-browser-dynamic"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@angular/router"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bootstrap"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.3.7"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"core-js"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.4.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"jquery"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.12.4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"moment"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.18.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rxjs"</span></span>: <span class="hljs-string"><span class="hljs-string">"^5.4.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"zone.js"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.8.12"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"devDependencies"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@types/node"</span></span>: <span class="hljs-string"><span class="hljs-string">"^6.0.46"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"@types/core-js"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.9.41"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"angular2-template-loader"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.6.2"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"awesome-typescript-loader"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.1.3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"css-loader"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.28.4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"extract-text-webpack-plugin"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.1.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"file-loader"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.11.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"html-loader"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.4.5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"raw-loader"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.5.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"script-loader"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.7.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"style-loader"</span></span>: <span class="hljs-string"><span class="hljs-string">"^0.18.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"typescript"</span></span>: <span class="hljs-string"><span class="hljs-string">"~2.3.4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"webpack"</span></span>: <span class="hljs-string"><span class="hljs-string">"^2.6.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"webpack-merge"</span></span>: <span class="hljs-string"><span class="hljs-string">"^4.1.0"</span></span> } }</code> </pre> <br></div></div><br></li><li>  Replaced systemjs with a webpack with the division of the entire code into three packages (vendor, polyfills, app) - so far without automatic (re-) assembly and ‚Äúaccelerators‚Äù (full assembly takes 15 seconds on an average laptop) <br><br><div class="spoiler">  <b class="spoiler_title">webpack.config.js</b> <div class="spoiler_text">  Common: <br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">entry</span></span>: { <span class="hljs-string"><span class="hljs-string">'polyfills'</span></span>: <span class="hljs-string"><span class="hljs-string">'./app/polyfills.ts'</span></span>, <span class="hljs-string"><span class="hljs-string">'vendor'</span></span>: <span class="hljs-string"><span class="hljs-string">'./app/vendor.ts'</span></span>, <span class="hljs-string"><span class="hljs-string">'app'</span></span>: <span class="hljs-string"><span class="hljs-string">'./app/main.ts'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">resolve</span></span>: { <span class="hljs-attr"><span class="hljs-attr">extensions</span></span>: [<span class="hljs-string"><span class="hljs-string">'.ts'</span></span>, <span class="hljs-string"><span class="hljs-string">'.js'</span></span>] }, <span class="hljs-attr"><span class="hljs-attr">module</span></span>: { <span class="hljs-attr"><span class="hljs-attr">rules</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.ts$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'awesome-typescript-loader'</span></span>, <span class="hljs-attr"><span class="hljs-attr">options</span></span>: { <span class="hljs-attr"><span class="hljs-attr">configFileName</span></span>: helpers.root(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'tsconfig.json'</span></span>) } }, { <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'angular2-template-loader'</span></span> } ] }, { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.html$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [{ <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'html-loader'</span></span>, <span class="hljs-attr"><span class="hljs-attr">options</span></span>: { <span class="hljs-attr"><span class="hljs-attr">minimize</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">removeComments</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">collapseWhitespace</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } }] }, { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.(png|jpe?g|gif|svg|woff|woff2|ttf|eot|ico)$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'file-loader?name=dist/assets/[name].[hash].[ext]'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.css$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">exclude</span></span>: helpers.root(<span class="hljs-string"><span class="hljs-string">'app'</span></span>), <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: ExtractTextPlugin.extract({ <span class="hljs-attr"><span class="hljs-attr">fallback</span></span>: <span class="hljs-string"><span class="hljs-string">'style-loader'</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: <span class="hljs-string"><span class="hljs-string">'css-loader?sourceMap'</span></span> }) }, { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.css$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">include</span></span>: helpers.root(<span class="hljs-string"><span class="hljs-string">'app'</span></span>), <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'raw-loader'</span></span> } ] }, <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.ProvidePlugin({ <span class="hljs-attr"><span class="hljs-attr">$</span></span>: <span class="hljs-string"><span class="hljs-string">'jquery'</span></span>, <span class="hljs-attr"><span class="hljs-attr">jQuery</span></span>: <span class="hljs-string"><span class="hljs-string">'jquery'</span></span> }), <span class="hljs-comment"><span class="hljs-comment">// Maps these identifiers to the jQuery package (because Bootstrap expects it to be a global variable) // Workaround for angular/angular#11580 for angular v4 new webpack.ContextReplacementPlugin( /angular(\\|\/)core(\\|\/)@angular/, helpers.root('./app'), // location of your src {} // a map of your routes ), new webpack.optimize.CommonsChunkPlugin({ //order is important: //The CommonsChunkPlugin identifies the hierarchy among three chunks: app -&gt; vendor -&gt; polyfills. //Where Webpack finds that app has shared dependencies with vendor, it removes them from app. //It would remove polyfills from vendor if they shared dependencies, which they don't. name: ['app', 'vendor', 'polyfills'] }), ] };</span></span></code> </pre> <br>  Dev: <pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = webpackMerge(commonConfig, { <span class="hljs-attr"><span class="hljs-attr">devtool</span></span>: <span class="hljs-string"><span class="hljs-string">'source-map'</span></span>, <span class="hljs-attr"><span class="hljs-attr">output</span></span>: { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: helpers.root(<span class="hljs-string"><span class="hljs-string">'dist'</span></span>), <span class="hljs-attr"><span class="hljs-attr">publicPath</span></span>: <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'[name].js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">chunkFilename</span></span>: <span class="hljs-string"><span class="hljs-string">'[id].chunk.js'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ExtractTextPlugin(<span class="hljs-string"><span class="hljs-string">'[name].css'</span></span>) ] });</code> </pre> <br></div></div><br></li><li>  I tried to deal with IE and the mentioned exceptions in VS: I found out that the webpack does something with shim / polyfill scripts and if you use the link to the original version, the exceptions disappear <br><br><div class="spoiler">  <b class="spoiler_title">index.html</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Angular.io QuickStart<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">base</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">/</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">UTF-8</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">viewport</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width,initial-scale=1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./dist/vendor.css"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my-app</span></span></span><span class="hljs-tag">&gt;</span></span>Loading App<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">my-app</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"node_modules/core-js/client/shim.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--&lt;script src="node_modules/es6-shim/es6-shim.min.js"&gt;&lt;/script&gt; &lt;script src="node_modules/core-js/client/shim.js"&gt;&lt;/script&gt; &lt;script src="node_modules/zone.js/dist/zone.js"&gt;&lt;/script&gt;--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./dist/polyfills.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./dist/vendor.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./dist/app.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br></li><li>  Added bootstrap and jQuery; </li><li>  Complicated the structure of the program, trying to follow the official style guide: <br><br><ul><li>  Core module for services and single components (for example header.component); </li><li>  shared module for common components; </li><li>  a couple of feature modules representing separate independent areas of the site. </li></ul><br><div class="spoiler">  <b class="spoiler_title">screenshot</b> <div class="spoiler_text"><img src="https://preview.ibb.co/gviZk5/Angular_io_Quick_Start_Internet_Explorer_2017_06_13_15_45_47.png" alt="image"><br></div></div><br></li><li>  Added WebApi controller and Angular service for communication with api <br><br><div class="spoiler">  <b class="spoiler_title">api.service.ts</b> <div class="spoiler_text"><pre> <code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@Injectable()</span></span> export <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApiService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> apiUrl: string; <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> http: Http) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.apiUrl = <span class="hljs-string"><span class="hljs-string">"/api"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> setHeaders(): Headers { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> headersConfig = { <span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>: <span class="hljs-string"><span class="hljs-string">'application/json'</span></span>, <span class="hljs-string"><span class="hljs-string">'Accept'</span></span>: <span class="hljs-string"><span class="hljs-string">'application/json'</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> new Headers(headersConfig); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> formatErrors(error: any) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.<span class="hljs-keyword"><span class="hljs-keyword">throw</span></span>(error.json()); } <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(path: string, params: URLSearchParams = new URLSearchParams()): Observable&lt;any&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.http.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(`${<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.apiUrl}${path}`, { headers: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setHeaders(), search: params }) .<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.formatErrors) .map((res: Response) =&gt; res.json()); } <span class="hljs-comment"><span class="hljs-comment">//put(path: string, body: Object = {}): Observable&lt;any&gt; { // return this.http.put(...); //} //post(path: string, body: Object = {}): Observable&lt;any&gt; { // return this.http.post(...); //} //delete(path): Observable&lt;any&gt; { // return this.http.delete(...)); //} }</span></span></code> </pre> <br>  Usage example: <pre> <code class="hljs cs">export <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HomeSiteComponent</span></span> { title = <span class="hljs-string"><span class="hljs-string">"I'm home-site component with WebApi data fetching"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ctrlData: DummyData[]; constructor(apiService: ApiService) { apiService.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-string"><span class="hljs-string">'/Dummier/Get'</span></span>).subscribe(result =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctrlData = &lt;DummyData[]&gt;result; }); } } <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">DummyData</span></span> { clientData: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; serverData: <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>; }</code> </pre> <br></div></div><br></li><li>  I tried to deploy everything in a full-fledged IIS - everything works.  Returned the project to IIS Express; </li><li>  Configured routing by adding URL Rewrite Rules to Web.config.  Now the server accepts and processes api requests and redirects all other <i>new</i> requests to Angular.  Angular itself is responsible for client-side navigation (including responsible for the ‚Äú404 page‚Äù). <br><br><div class="spoiler">  <b class="spoiler_title">Routing</b> <div class="spoiler_text"><pre> <code class="hljs lua">const routes: Routes = [ { <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: <span class="hljs-string"><span class="hljs-string">'welcome'</span></span>, component: WelcomeComponent }, //Component w/o Menu item { <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: <span class="hljs-string"><span class="hljs-string">'home'</span></span>, loadChildren: () =&gt; HomeSiteModule }, //Feature Modul with own Routing { <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: <span class="hljs-string"><span class="hljs-string">'area1'</span></span>, loadChildren: () =&gt; Area1SiteModule }, //Feature Modul with own Routing { <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, redirectTo: <span class="hljs-string"><span class="hljs-string">'home'</span></span>, pathMatch: <span class="hljs-string"><span class="hljs-string">'full'</span></span> }, //Empty Route { <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: <span class="hljs-string"><span class="hljs-string">'**'</span></span>, component: PageNotFoundComponent } //<span class="hljs-string"><span class="hljs-string">"404"</span></span> Route ]; @NgModule({ imports: [RouterModule.forRoot(routes)], exports: [RouterModule], }) export class AppRoutingModule { }</code> </pre> <br>  Web.Config: <pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.webServer</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rewrite</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rules</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WebApi Routes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">stopProcessing</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"^api/"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"None"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Angular Routes"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">stopProcessing</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">match</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".*"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">conditions</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">logicalGrouping</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"MatchAll"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">input</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{REQUEST_FILENAME}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">matchType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IsFile"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">negate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">input</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{REQUEST_FILENAME}"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">matchType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IsDirectory"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">negate</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">conditions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Rewrite"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">url</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rule</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rules</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">rewrite</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.webServer</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br></div></div></li></ul><br>  Still to do: <br><br><ul><li>  Automate webpack assembly; </li><li>  Divide the assembly into two parts so as not to rebuild the vendor package each time; </li><li>  Add Windows authentication; </li><li>  Redirect WebApi to an existing WCF service. </li></ul><br>  The final draft can be found on <a href="https://github.com/shwedberlin/AngularWebApi">GitHub</a> (at the time of writing, <a href="https://github.com/shwedberlin/AngularWebApi/tree/74e54cf90a92dc261cb3ec7ef3a66928e8c20231">commit 74e54cf</a> ). <br>  I am pleased to answer questions and discuss on the subject ‚Äúwhy this is so, and not that kind of business.‚Äù </div><p>Source: <a href="https://habr.com/ru/post/330860/">https://habr.com/ru/post/330860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../330850/index.html">Microsoft at CodeFest 2017 - report, slides and video reports</a></li>
<li><a href="../330852/index.html">What is missing Gmail. 4 free deskun features</a></li>
<li><a href="../330854/index.html">Optimize memory usage in Xamarin applications</a></li>
<li><a href="../330856/index.html">Bench press: compare HPE StoreOnce and EMC Data Domain</a></li>
<li><a href="../330858/index.html">We collect data in CRM: steroids for the company</a></li>
<li><a href="../330862/index.html">Publisher Peter. Summer Sale</a></li>
<li><a href="../330864/index.html">Open Data Board: Transport Disclosure</a></li>
<li><a href="../330866/index.html">What threatens information security or a review of the PHDays VII 2017 forum in Moscow</a></li>
<li><a href="../330868/index.html">Jobs-To-Be-Done Framework: Our Experience</a></li>
<li><a href="../330870/index.html">Own CRM system for 3 hours in Google tables</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>