<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to speed up the site or factors affecting the download site</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Objective : To give a basic understanding of the factors affecting the speed of loading a site. Disassemble every step of the download. Give an idea o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to speed up the site or factors affecting the download site</h1><div class="post__text post__text-html js-mediator-article">  <b>Objective</b> : To give a basic understanding of the factors affecting the speed of loading a site.  Disassemble every step of the download.  Give an idea of ‚Äã‚Äãhow to accelerate by optimizing each load factor that can be influenced. <br><br>  I want to clarify right away that I will not give any configs or commands here, the article is intended to present a picture of the site‚Äôs download as a whole, and then, having discovered a problem area, a person can at least google in the right direction. <br><br>  <b>Target audience</b> : site owners, web-studios, specialists and amateurs.  I will try to write an article in such a way that it is accessible for everyone to understand. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The reason for writing this article lies in the fact that I noticed that many do not even understand the true causes of the brakes of their sites and decided to write this article so that the person himself could read and understand what was missing.  A lot of factors influence the website loading, we can influence most of them;  the rest we just need to take into account. <br><a name="habracut"></a><br><h4>  The power and quality of the client device, as well as the speed of its Internet and distance from the server location </h4><br>  We can buy the client a normal computer and connect high-speed Internet to it and will no longer have problems with this factor (of course, I'm joking).  Although I would definitely visit sites whose owners update my computer and pay for the Internet.  Besides the jokes, what can we actually do if the client has a weak Internet and a low-power device? <br><br>  1. Place your website in the data center, which is in close proximity to potential customers of the site and make sure that it provides a fairly wide channel for the planned load.  Simply put, choose a good hosting.  Many underestimate the importance of this item, in vain underestimate. <br><br>  2. The weaker the device, the longer it creates new connections to the server, which means we need to reduce the number of these connections.  Often, the site owner doesn‚Äôt even know how hard his site is being loaded, and he thinks that the problems with braking are clearly not due to the site, but simply to the customers having a slow Internet.  It should be borne in mind that you as the owner are on your site more often than others and the entire contents of the site has long been cached by the browser, which means it does not load every time you go through the pages <i>(unless of course you have static caching configured in the client‚Äôs browser)</i> , but taken from the cache.  Accordingly, not only is traffic saved, without loading your Internet channel each time, but connections are not created to download these files. <br><br>  You can see the number of connections, loading steps and page weight in the browser‚Äôs developer tools.  In Google Chrome, in order to open the developer‚Äôs tools, just click anywhere on the page with the right key, click ‚ÄúView code‚Äù and go to the Network section. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/271/efa/79d/271efa79d5d838aec09c4d5e4bb29238.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/043/cc5/8d9/043cc58d99c8e25d6b6c85b3d74c9d6e.png" alt="image"><br><br>  The download can be divided into several stages, each stage of loading the page of your site is important. <br><br>  <b>1. Server response time.</b>  The execution time of this boot phase is usually called the ‚Äúserver response time‚Äù.  Now I‚Äôll tell you what is happening during this time and how this time can be shortened if you have the beyond and, in general, how long the server response is considered beyond. <br><br>  We divide this gap into sub-points: <br><br>  1.1 Sending a request to the client browser. <br><br>  The speed of the Internet and the power of the client device, as well as the remoteness of the server on which your site is located, from the client and its workload are factors that can affect this stage. <br><br>  Further, until the server sends the finished page in response, it goes through several stages, and for each specific site the stages may differ.  I will take as an example a site in php with a MySQL database. <br><br>  1.2 The request is received by the web server, it finds in the list of virtual hosts the one that fits the request and processes the virtual host, in our example, the php site, which means the web server will turn to php to generate a page, which in turn will fill the page data will go to the database.  After forming the page, it will be transferred by the web server to the client‚Äôs browser. <br><br>  A very important role is played by caching at each stage, caching at the web server level, caching at the php level (opcache), caching queries in the database (memcache), there may be other caching options, I cited these as the most common.  This is exactly the stage at which you can influence and this stage needs time. <br><br>  Here are ways to speed it up. <br><br><ul><li>  Choose fast hosting or even better VPS, VDS or even a physical server.  If you are not competent in this choice, it is better to ask for help from a specialist or ask recommendations from friends who already use these or other hosts.  Pay attention to where the data center hoster is located: ideally, if it will be located in close proximity to your potential customers.  I personally use foreign servers, if only the site carries out DDOS-attacks, Russian hosters provide protection against poor quality DDOS, and here you have to put up with pings and latency. <br><br></li><li>  Proper server setup will help speed up the response from it.  Here the choice of more nimble software and its correct configuration play a role.  For the web server, I use Nginx, where whenever possible I use hhvm in conjunction with php 7.1, the choice of php version, and also hhvm mostly also depends on the code of your site: if the site uses outdated functions, then you either have to update it or content with old versions that have not so high performance.  Well, as a database, use MariaBD or even Percona, if you have a larger project.  Also, do not forget about protection: antibruts, filters against typical attacks, http authorization as an additional authorization on all admin areas, antispam, antivirus, and so on. </li></ul><br>  1.3 Sending the generated page to the client and the moment of receiving this page will be the final stage of this part of the page load.  Here, to reduce the amount of data sent, it is best to use gzip compression. <br><br>  I want to make a correction, I have a server response for the Habr site equal to 3.48 seconds - this is a bad time, but Habr is not really to blame here.  I have a mediocre quality 3G internet.  Therefore, I specifically recommend this stage of the download to track using the service.  I use for this <a href="https://webmaster.yandex.ru/tools/server-response/">service check response server from Yandex</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3d6/520/ef2/3d6520ef22065590347b2087912c3612.png" alt="image"><br><br>  HTTP status code should be 200. <br><br>  The server response here is noticeably less than on my 3G Internet.  Ideally, the server response time should tend to zero, but at least it should not exceed 200 ms, although this is my personal criterion.  No, not only mine.  Google PageSpeed ‚Äã‚Äãif I'm not mistaken, too, makes sure that the server response does not exceed 200 ms and, if the site exceeds the recommended time, it warns you that you need to reduce the server response. <br><br>  Well, at the very bottom we can see that the answer is compressed with gzip. <br><br>  Habr has passed the first stage of loading on a fivefold (no, no, I do not suck up at all). <br><br>  Those whose sites have also passed these requirements can read further, well, and the rest should reflect on my recommendations and continue reading the article after you have finished the first stage. <br><br>  <b>2. DOMContentLoaded</b> - this is how this stage of loading the page is called in the developer‚Äôs tools, and if in a simple way, this is the very moment when the visual loading of the page is finished. <br><br>  What you need to pay attention to. <br><br>  2.1 Number of connections - Habr has a lot of them, if you have a lot of them, you should think about reducing the number of these connections.  As I wrote above, the more connections, the more resources are required to open them, and this is a good load, especially for weak devices and, by the way, the server itself as well. <br><br>  How to reduce them?  In <a href="https://ru.wikipedia.org/wiki/HTTP">http / 1.0</a> and <a href="https://ru.wikipedia.org/wiki/HTTP">http / 1.1</a> , a separate connection is created for each individual file, which means that our task is to reduce the number of files loaded on the page. <br><br><ul><li>  Combine all css into one file and all js into one file, this procedure is called concatenation. <br><br></li><li>  Place small images in encoded form directly in the css or in the body of the page so that no separate connections are created for them. <br><br></li><li>  It is possible to get rid of loading any unnecessary elements, and if possible, delay the loading of js or put them at the end well, or at least make their loading asynchronous.  CSS, by the way, would be nice to optimize. <br><br></li><li>  If you postpone loading css, the page when surfing the site will blink - in my opinion, this is unacceptable, but we can download the css needed to display the top of the site at the beginning, and the rest later.  It is better to consult with the coder, I am not, therefore do not take these recommendations literally. <br><br></li><li> Go to <a href="https://ru.wikipedia.org/wiki/HTTP">http / 2</a> , this version of the protocol allows you to load all elements into one stream without creating unnecessary connections.  And the most shrewd have already thought, so why then follow the first two recommendations if you can just go to <a href="https://ru.wikipedia.org/wiki/HTTP">http / 2</a> , now I will explain.  Currently, <a href="https://ru.wikipedia.org/wiki/HTTP">http / 2 is</a> not supported by all devices, so some customers will continue to use the site on previous versions of the protocol, so this recommendation will help speed up the page loading for fresh devices with current versions of browsers. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/37a/d77/053/37ad7705364ed71a728bc7d7e1258e95.png" alt="image"><br><br>  Here you can clearly see how fewer connections are created using <a href="https://ru.wikipedia.org/wiki/HTTP">http / 2.</a> <br><br>  2.2 Weight of the page and elements loaded from it. <br><br><ul><li>  Remove unnecessary comments in the code. </li><li>  Use compression. </li><li>  Optimize site content, compress and merge css and js, compress images, etc. </li></ul><br>  And there is another recommendation that will help reduce the number of connections and reduce the weight of the page and the content placed on it.  This is a sort of panacea, although it requires certain skills in customization. <br><br>  Module for PageSpeed ‚Äã‚Äãweb server.  It is for nginx - ngx_pagespeed and for apache2 - mod_pagespeed.  About what he can do, it is better to read more in the official documentation, its settings are very flexible.  I just note that he is able to perform concatenation on the fly, which will help reduce the number of connections, and he also shakes the content, reducing the weight of the page and its contents. <br><br>  At this stage, I can put Habra a hard 4 and then only in the absence of http / 2, although I would probably still reduce the amount of loadable elements and make concatenation. <br>  Ideally, this stage of loading a page should not exceed 2-3 seconds <i>(although there is no limit to perfection and I have clients who want faster even at download speeds of less than 1 second)</i> .  If you have more time, you should think about the recommendations that I gave above. <br><br>  <b>3. Load</b> - this is the moment when the browser wheel stopped spinning, that is, a full page load occurred.  This is a less critical stage of loading and it is often slowed down by third-party chats to communicate with customers on the site and other secondary elements.  If you follow the recommendations I gave above, then this stage will also become faster.  I would also like to note that if you do not have a high-load project and at the same time you have a VPS, VDS or physical.  server, try to keep all static loaded from your server only.  Placing statics on third-party sites and in CDN will benefit only under high loads, and for non-loaded sites it will only play in the negative. <br><br>  <b>4.</b> At this stage, you can not look at all, because in fact the page is loaded and then the browser will always load something, communicating with the site. <br><br>  <b>5.</b> By this figure in the screenshot, I designated the place where the number of loaded elements on the page and the weight of the page with all the elements are displayed.  It should be borne in mind that if it is not a problem for a PC to download a 2.5 MB page, then for a mobile browser with a weak 3G this becomes more problematic.  In particular, I have 3G Internet and Habr doesn‚Äôt load as fast as other sites.  For mobile devices, ideally, the page weighs less than 1 MB.  Here either reduce the size of all content on the pages or make a mobile version. <br><br><h4>  PS </h4><br>  <i>Pros of downloading content from:</i> <i><br><br></i> <ul><li>  <i>We reduce the load on your server.</i> </li><li>  <i>The same static data, namely css, js, images and fonts could have already been loaded earlier while browsing other sites that also use this static and they will be loaded from the browser cache.</i> </li></ul> <i><br></i>  <i>Cons content loading side:</i> <i><br><br></i> <ul><li>  <i>Often, public CDNs and sites that store fonts, images, css and js have a high load, as they are used by hundreds or even thousands of sites with different levels of attendance, as a result it turns out that it is sometimes faster to give from your own than to save the load .</i> </li><li>  <i>If you use http2 to reduce the number of connections, third-party sites will only add them to you.</i> </li></ul><br>  Now, even if you have not yet figured out the causes of the brakes on your site, at least you know where to dig.  I also want to note that a well-written site code and optimal layout will also speed up your site, but this is not my destiny - these moments are already well described on the Internet. <br><br>  I hope this article was for you informative. </div><p>Source: <a href="https://habr.com/ru/post/334236/">https://habr.com/ru/post/334236/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../334226/index.html">Storage Infortrend is an alternative to A-brands. Review and Testing</a></li>
<li><a href="../334228/index.html">Why do good people leave large IT companies?</a></li>
<li><a href="../334230/index.html">Information services, robots and trading software: the use of API in the world of finance</a></li>
<li><a href="../334232/index.html">Non-classical admission to university</a></li>
<li><a href="../334234/index.html">Data: beautiful and terrible</a></li>
<li><a href="../334238/index.html">IT events that you can attend until the end of summer</a></li>
<li><a href="../334242/index.html">Cards, accounts, 2 balances</a></li>
<li><a href="../334244/index.html">‚ÄúThe market is becoming more aggressive and high-end‚Äù - Alexander Zimin on iOS development trends</a></li>
<li><a href="../334248/index.html">Outdoor Wi-Fi: outdoor Wi-Fi networks and bridges on TP-Link equipment</a></li>
<li><a href="../334250/index.html">Analysis of the tasks of the final Yandex. Algorithm 2017</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>