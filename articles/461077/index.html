<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How are pentesters cooked? Entrance Testing for Digital Security Interns</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Summer of Hack 2019 at Digital Security is already in full swing, which means it's time to tell how we recruited people. 



 Under the cut, volum...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How are pentesters cooked? Entrance Testing for Digital Security Interns</h1><div class="post__text post__text-html js-mediator-article">  <b>The Summer of Hack 2019</b> at Digital Security is already in full swing, which means it's time to tell how we recruited people. <br><br><img src="https://habrastorage.org/webt/iv/ef/ud/ivefudzwssbwskpfaxaxkczsxvu.jpeg"><br><br>  Under the cut, voluminous and interesting material about how we select young specialists for our internship ‚ÄúSummer of Hack 2019‚Äù, and specifically to the Department of Security Audit. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Consider what, in our opinion, a pentester should know in order to successfully do its job. <br><br>  We will analyze a number of difficult tasks that we tortured the guys, including on behalf of one of them. <br><a name="habracut"></a><br>  Perhaps the most interesting part of the selection for an internship in the security audit department was our profile.  Every year we gather as a whole department and discuss what skills, in our opinion, are in demand for a modern specialist in the field of practical safety, recall the most interesting tasks that had to be solved this year, and write out areas of knowledge without which it is difficult to imagine a successful auditor.  When all the jokes are joked and the stories are told, the bottom line remains a set of ideas. <br><br>  This year, we were guided by the following requirements: <br><br><ul><li>  Basic knowledge of the device web-applications and attacks on them; </li><li>  Basic knowledge of browser-based protection and access control mechanisms (yes, the same SOP and CORS, where without them); </li><li>  Basic code reading skills and the ability to see logic behind it; </li><li>  Understanding the operation of computer networks and routing in them; </li><li>  Experience with Linux-like systems; </li><li>  The ability not to be afraid of unfamiliar technology.  The ability to google and organize the information received; </li><li>  And a pinch of Android (though not necessary, but this is our little whim). </li></ul><br>  After questions were developed.  Partially, we borrowed them from the questions we asked at the interviews, but more than half were specially prepared for this questionnaire.  Our experts spent their personal time preparing traffic dumps, arguing how to better formulate the question, and which vulnerabilities were ‚Äútoo specific, why torment trainees‚Äù.  For such zeal, we cannot help but take off our hat (white, of course). <br><br>  The analysis of each question consists of two parts.  The first part is the answer of one of our trainees - Danila <a href="https://habr.com/ru/users/korgik_0/" class="user_link">Korgik_0</a> Leontyeva (he is the author of the publication), and the second is the comments of specialists who were piling over the questionnaire. <br><br><hr><br>  <i>Hello, Habr!</i> <i><br><br></i>  <i>First, a little lyrical digression.</i> <i><br></i>  <i>More specifically, ‚ÄúHow did I find out about Summ3r 0f h4ck‚Äù.</i> <i><br></i>  <i>I heard about the announcement of the internship from a speech by <a href="https://twitter.com/_ttffdd_">Denis Rybin</a> and <a href="https://twitter.com/barracud4_">Ilya Bulatov</a> at the RuCTF2019 conference.</i> <i><br><br></i>  <i>Literally after 4 days, a <a href="https://habr.com/ru/company/dsec/blog/450036/">post</a> was posted on habr about the opening of an internship set.</i> <i><br><br></i>  <i>And in the evening of the same day I opened the task, in the security audit department, and immersed myself in work.</i>  <i>Today I will share with the reader what difficulties I had to face and which solution option I could offer.</i> <br><br><hr><br><h1>  <strong><font color="#cc0000">No. 1.</font></strong>  <strong><font color="#cc0000">Php source code</font></strong> </h1><br>  Examine the code.  Describe what flaws you see and how you would fix them. <br><br><img src="https://habrastorage.org/webt/ne/0x/ku/ne0xkuq_5uz955i1rypa8or5spk.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">Job parsing</b> <div class="spoiler_text">  4th line - use the md5 hash. <br>  Problem - md5 can be brutalized in a reasonable amount of time using hashcat. <br>  How to fix? <br><br>  Using more "resource-intensive" hashing algorithms. <br>  In this case, you must completely refuse the user cookies and tie all the logic to phpsession. <br><br>  5th line - PostgreSQL-injections. <br>  How to fix? <br>  Using prepared statement. <br>  Implementation of prepared statement to verify login <br><br><pre><code class="plaintext hljs">$query = "SELECT username FROM login WHERE username=?"; $stmt = $conn-&gt;prepare($query); $stmt-&gt;execute(array($username)); $username = $stmt-&gt;fetchColumn(); if($username == FALSE) { die(" !"); }</code> </pre> <br>  11 line - a number of unsuccessful decisions. <br><br><ol><li>  Session life too long.  A whole year is a lot.  If the cookie is hijacked successfully, long access to the user account by the attacker is possible. </li><li>  Missing httpOnly flag.  If set to TRUE, cookies will only be accessible through the HTTP protocol.  That is, cookies in this case will not be available to scripting languages ‚Äã‚Äãlike JavaScript. </li><li>  No cookie hashing. </li><li>  Lack of setting the secure flag.  The secure flag indicates that the cookie value should be transmitted from the client over a secure HTTPS connection.  If set to TRUE, the cookie from the client will be sent to the server only if a secure connection is established. </li></ol><br>  How to fix? <br>  By default, in php, the session lifetime is only 24 minutes, let's implement this. <br>  Set the secure flag, httpOnly. <br><br>  In this case, you should refuse the strange user cookie and tie all the logic to phpsession. <br><br>  18 line - XSS (English Cross-Site Scripting - "intersite scripting"). <br>  How to fix?  Convert all possible characters to the corresponding HTML entities. <br><br><pre> <code class="plaintext hljs">$query = htmlentities($query, ENT_QUOTES, "UTF-8");</code> </pre> <br>  We will explicitly indicate the encoding in order to avoid its substitution for UTF-7. <br><br><pre> <code class="plaintext hljs">header("Content-Type: text/html; charset=utf-8");</code> </pre> <br>  Line 20 - defects of the authentication system and session storage. <br><br>  Problem - if you set the user id encoded in base64 in the cookie user, you can log in to his account! <br><br>  How to fix?  When authorizing the user, we record the session in the database and when installing the session, we check its presence in the database. <br><br><pre> <code class="plaintext hljs"> $query = "SELECT sessions FROM login WHERE sessions=?"; $stmt = $conn-&gt;prepare($query); $stmt-&gt;execute(array($_COOKIE["user"])); $session = $stmt-&gt;fetchColumn(); if($session == TRUE) { do_login($_COOKIE["user"]); }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Expert Commentary D:</b> <div class="spoiler_text"><blockquote>  The first question with which the questionnaire met future interns concerned the main and widely known web vulnerabilities.  The only difficulty here is the need to see them in the source code in PHP.  However, no one set the task of ‚Äúhiding bugs‚Äù. <br><br>  Here is a list of vulnerabilities that can be detected in this listing in order of frequency of their detection: <br><br>  <b>Password hashing using the MD5 algorithm was</b> noticed even by candidates far from the web.  However, there were also interesting nuances, for example, many candidates used very incorrect terms, trying to describe the problems in their own words.  ‚ÄúAlgorithm vulnerabilities‚Äù, ‚Äúone-way functions‚Äù, ‚Äúthe existence of collisions‚Äù and other strange turns went into battle, upon closer examination, they turned out to be nothing more than a set of big words that did not reveal the essence.  Of course, here we went to a meeting and did not find fault with those people who are just preparing to embark on the path to learning the wisdom of information security.  To get a ‚Äúset-off‚Äù, mention of the threat would be enough, that in case of compromising the database, the md5 hashes can be sorted out by an attacker in an acceptable time and passwords (or equivalent strings) can be obtained in clear text.  And, of course, many mentioned the lack of salt and brute force based on the use of rainbow tables.  We also perceived such comments positively, especially if the respondent explained why this is a threat. <br><br>  <b>Potential SQL injection.</b>  It‚Äôs hard to add something;  when forming a call to the database, user input of login and password are directly concatenated with the request.  If it is unlikely that you can manipulate the password value at this stage (a hash is taken from it), then introducing an injection into username will not be difficult for a potential attacker. <br><br>  <b>Output of unnecessary debug information leading to an XSS attack.</b>  By carefully reading the listing, one could pay attention to the echo call, which displays the generated request to the database in HTML comments on the page.  Of course, such a conclusion of additional information to the page is completely optional and, most likely, simply forgotten by the developer after conducting the tests.  Such additional information is very beneficial for the attacker and allows a much better understanding of how the application works.  However, unfortunately, this is only half the trouble.  The fact is that an attacker can manipulate the contents of the query variable, and its contents are not filtered or escaped before being displayed to the user - there is a potential XSS attack.  However, its exploitation can turn out to be that still a headache due to the poorly located strtoupper function.  The vector injected by the attacker will be uppercase, and if this is not a problem for HTML tags, then Javascript is very offended by such an appeal.  This can be easily verified using the browser console. <br><br><img src="https://habrastorage.org/webt/cg/ev/oy/cgevoykot6pzht0mx5ppeqyxwne.png"><br><br>  Well, at least, apparently, the attacker will have to resort to the so-called ‚Äúscriptless attacks‚Äù or sophisticated techniques for bypassing filtering (in this case, JSFUCK would do), so the fact of a security risk does not cancel this. <br><br>  <b>An error in the logic of the session management mechanism</b> was the most interesting part of the task.  Its discovery required not only to read the source line by line, but also to understand the logic of the whole listing.  One could feel something was wrong by noticing the setting of a cookie containing the base64-encoded user id in the remember-me block.  Further analysis of the logic of this mechanism leads us to the thought: ‚ÄúIt turns out that an attacker who knows or goes through id can log into any account without entering a login and password ?!‚Äù.  Yes, indeed, an attacker can, on his side, independently generate a cookie user and assign it any id value encoded by base64.  Sending a request with such a cookie without username and password would trigger the do_login function and log in to someone else's account. <br><br>  The mention of these 4 vulnerabilities in the candidates' response directly influenced their scores. <br><br>  However, much depended on the quality of the response.  Mentioning ways to rectify the situation, comments on additional factors affecting the feasibility of a particular attack, the use of the right terms and the ability to structure your thoughts, comments on additional weaknesses or potential threats - all this warmed our hearts and led to an increase in the final rating. <br></blockquote><br></div></div><br><hr><br><h1>  <strong><font color="#cc0000">No. 2.</font></strong>  <strong><font color="#cc0000">Jwt</font></strong> </h1><br>  When researching a web application, you found that the application uses a JWT token as authorization. <br><br>  What security concerns do you see, what kind of checks would you do? <br><br>  JWT Token: <br><br><pre> <code class="plaintext hljs">eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6InNla2EiL CJpYXQiOjE1MTYyMzkwMjIsInJvbGUiOiJub2JvZHkiLCJpc0FkbWluIjoiRmFsc2UiLCJwYX Nzd29yZCI6IjFkMDBjYUgifQ.F7Y1mCAmg5-QFok-rkpLdwe8prCyiKsCyJ-3Z5f7luI</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Job parsing</b> <div class="spoiler_text">  Dan JSON Web Tokens (JWT). <br>  Its structure -&gt; [base64url (HEADER)]. [Base64url (PAYLOAD)]. [Base64url (SIGNATURE)] <br>  [base64url (HEADER)] = eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0 <br>  base64url decode -&gt; {"alg": "None", "typ": "JWT"} <br>  We can immediately note the fact that the signature algorithm (‚Äúalg‚Äù: ‚ÄúNone‚Äù) of the signature is not used.  Some JWT libraries do not support the ‚Äúnone‚Äù algorithm, that is, the signature algorithm.  When the alg header is ‚Äúnone‚Äù, the server side will not perform signature verification. <br>  That is, you can write any payload in base64url, and its signature will not be verified. <br>  Which allows us to create a user with admin rights. <br><br>  Also, the fact that the payload part does not use such headers as aud (defines the recipients for which the JWT token is intended) and exp (token lifetime) does not make things easier for us. <br><br>  Estimated Payload <br>  eyJhbGciOiJOb25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6ImhhY2siLCJpYXQiOjE1MTYyMzkwMjIsInJvbGUiOiJub2JvZHkiLCJpc0FkbWluIjoiVHJ1ZSIsInBhc3N3b3JkIjoiaGFjayJ9 <br><br>  base64url decode payload -&gt; {"sub": "1234567890", "name": "hack", "iat": 1516239022, "role": "nobody", "isAdmin": "True", "password": "hack ¬ª} <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Expert Commentary D:</b> <div class="spoiler_text"><blockquote>  In the work of the auditor often have to deal with new technologies, and the ability to understand them is very important.  Including this question in the questionnaire, we assumed that most of the candidates hardly heard about the technology of JWT tokens except for the name.  Therefore, this question, first of all, was aimed at the ability to search and analyze information from public sources.  As a result, a person who missed the issuance of Google at the request of ‚ÄúJWT‚Äù and ‚Äújwt vulnerability‚Äù could come to the following conclusions: <br><br>  1. This token does not have a signature algorithm, so an attacker is able to modify any fields inside the token, which is not assumed by the concept of JWT tokens. <br><br>  2. Fields inside the token contain the user's password in clear form; storing such information in the token is, at a minimum, a bad practice.  In most cases, you can refuse such a decision and thereby increase your level of security. <br><br>  3. Remembering the lack of a signature and our ability to modify the fields inside the token, it is logical to assume that changing the value of isAdmin can increase our privileges to administrator privileges. <br><br>  4. Another interesting idea that few people mentioned in their answer concerns the very fact of the ability to transfer user input in the fields of a JWT token.  In a normal situation, an attacker can‚Äôt influence the data in the token in any way, which means that developers can often neglect the introduction of additional checks in the code of the handlers.  This begs the simple idea: but let's try to conduct classic attacks not through GET / POST parameters, but through token fields.  This can give an unexpectedly good result.  Such a creative approach with the correct justification of our actions was highly appreciated by us in assessing both this and other issues. <br><br>  Many candidates in their answers arranged a brief retelling of how the JWT token is structured, and where it is used, it was interesting for us to read, and yet, first of all, we evaluated the aspects of the answer regarding security. <br></blockquote><br></div></div><br><hr><br><h1>  <strong><font color="#cc0000">Number 3.</font></strong>  <strong><font color="#cc0000">CORS / CSRF / IDOR / ???</font></strong> </h1><br><br>  In the web application, the user password is changed using the following request (see Option 1).  What potential security threats do you see?  What checks would you carry out?  Will the situation change in the case of the following behavior (see Option 2)?  Explain your answer. <br><img src="https://habrastorage.org/webt/mr/b-/se/mrb-seaadzkgqbmqvsq-zcqflyo.jpeg"><br><div class="spoiler">  <b class="spoiler_title">Job parsing</b> <div class="spoiler_text">  <b>Option 1.</b> <br>  ‚ÄúWhat potential security threats do you see?‚Äù <br><br>  1) Lack of access control. <br>  If the user-a number to which the password change request is being made is not checked, then the password can be changed for any registered user in the system. <br>  How to fix?  - Matching JSESSION from the database and the requested id-shnik. <br><br>  2) The ability to conduct CSRF attacks <br>  We lure an authorized user to a host controlled by us and, after making a request, to example.com on behalf of the victim, to change the password. <br>  How to fix?  - Adding CSRF token. <br><br>  <b>Option 2</b> <br>  ‚ÄúWhat potential security threats do you see?‚Äù <br>  A flaw in the CORS policy. <br>  It is recommended that you whitelist the Access-Control-Allow-Origin header. <br><br>  How to fix?  - <br><br>  1) Modifying the .htaccess file <br><br><pre> <code class="plaintext hljs">&lt;ifmodule mod_headers.c&gt; Header always set Access-Control-Allow-Origin: "https://whitelist.domain.ru" Header always set Access-Control-Allow-Methods "PUT" &lt;/ifmodule&gt;</code> </pre><br>  2) PHP <br><br><pre> <code class="plaintext hljs">&lt;?php header('Access-Control-Allow-Origin: ‚Äúhttps://whitelist.domain.ru‚Äù); header('Access-Control-Allow-Methods: PUT'); ?&gt;</code> </pre><br>  ‚ÄúWill the situation change with the following behavior?‚Äù <br><br>  Yes.  Since the PUT request is used in the second case, which is important, since using the PUT request makes the CORS request ‚Äúdifficult‚Äù, which in turn completely deprives us of the opportunity to conduct a CSRF attack + the absence of such a header as Access-Control-Allow-Credentials: true deprives us the ability to send in place with other http headers and the user's cookie. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Expert I comment:</b> <div class="spoiler_text"><blockquote>  Let us consider, in order, what are the main problems that are visible on the given queries: <br><br>  1) Indeed, since the user‚Äôs numerical identifier ‚Äú10012‚Äù is observed in the request, the first step is to check whether it is possible to change the password for another user?  Can it be enough <b>to specify someone else's id</b> ? <br>  Vulnerabilities of the IDOR class are fairly easy to exploit and often have high criticality. <br><br>  2) The request to change the password occurs by the POST method, the CSRF token is not observed, and the content type is ‚Äútext / plain‚Äù.  There is the possibility of <b>faking such a request.</b> <br><br>  Consequently, in order to change the victim‚Äôs password, it is enough for the attacker to convince them to just visit the ‚Äúmalicious‚Äù link. <br><br>  3) In the response headers, the server <b>reveals the version of the software used</b> .  This can be called a vulnerability at a stretch, but it‚Äôs better to hide such banners - attackers can easily find the well-known 1-day exploits on them, plus the value of the software used greatly simplifies the planning of further attacks. <br><br>  4) We would be very pleased to see the sentence ‚ÄúWhat will happen if we <b>change the data format from JSON to XML</b> ?‚Äù <br><br>  The fact is that modern frameworks are smart, omnivorous and can process data in different formats.  And when parsing XML, a dangerous XXE vulnerability is often allowed.  With its help, the intruder can "go" to the internal network, can read configuration files from the server, and occasionally execute RCE. <br><br>  5) I also wanted to see a remark like ‚ÄúWhy <b>is the knowledge of the old not checked</b> when changing the password?‚Äù <br><br>  As for ‚ÄúOption # 2‚Äù, there is a ‚Äútrap‚Äù in it - CORS headers are used here, and the Content-Type of the request is already set to ‚Äúapplication / json‚Äù. <br><br>  The mistake that the vast majority of candidates made is the answer of the form "-That's the asterisk in Allow-Origin, which means you can send requests from any site!" <br><br>  No you can not.  Firstly, the Allow-Credentials: True header is missing, which means that the browser should execute the request ‚Äúwith cookies‚Äù, so that the request would be anonymous, without a session.  And secondly, even if such a header were present, the browser would still forbid sending cookies - just because of the "asterisk".  Their combination is forbidden, and the browser is ignored. <br></blockquote></div></div><br><hr><br><h1>  <strong><font color="#cc0000">Number 4.</font></strong>  <strong><font color="#cc0000">Network dump</font></strong> </h1><br>  Imagine that you got into the internal network of the company and intercepted the traffic whose dump is attached below.  Describe what attacks you would try to conduct and with what tools? <br><br>  Dump: <a href="https://yadi.sk/d/qkLcfwSCzdxcwg">yadi.sk/d/qkLcfwSCzdxcwg</a> <br><br><div class="spoiler">  <b class="spoiler_title">Job parsing</b> <div class="spoiler_text">  1) LLMNR Spoofing &lt; <br>  An attacker on the local subnet can listen to and respond to broadcast messages, claiming that the requested host name is his own IP address. <br>  This causes the requesting client computer to connect to the attacker computer and, depending on the protocol, may try to authenticate. <br><br>  The utilities used are Intercepter-NG, a project on githab VindicateTool. <br><br>  2) Abuse of the HSRP protocol. <br>  Problematic - when the ‚Äúpreempt‚Äù parameter is set to 1, the attacker has the opportunity to ‚Äúsqueeze out‚Äù other routers, due to the higher priority.  After sending HSRP to the multicast, the controlled router becomes the main router (Active Router) in the network, and all traffic will pass through it.  In fact, we came to the implementation of mitm attacks. <br><br>  For this attack vector, we need to know the group and password. <br>  From the traffic dump given to us, we recognize the group (it is - 3) and the password.  The password in our case is default - cisco. <br><br>  Utilities used are yersinia, scapy. <br><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Expert X comment:</b> <div class="spoiler_text"><blockquote>  The objective of the question was to determine the trainee's familiarity with modern (and not so) techniques for conducting MitM attacks.  Let's look at potential scenarios based on an existing traffic dump: <br><br>  <b>1) ARP spoofing</b> <br>  ARP-spoofing is the oldest and easiest way to implement MitM attacks.  It consists in sending a gratuitous ARP request to host A. <br><br>  The IP address of host B is the IP address, and our MAC address is the MAC address.  Such a request allows you to modify the ARP table on host A, forcing it to send requests to our device when trying to access host B. Host B is usually the default gateway. <br><br>  Recommended Tools: bettercap, arpspoof <br><br>  <b>2) LLMNR, NBNS spoofing</b> <br>  Link-Local Multicast Name Resolution and NetBIOS Name Service are the protocols used to resolve hostnames on the local network.  Unlike the DNS protocol, there is no dedicated server that stores all the information; instead, the request is broadcast to all hosts on the network, if the hostname in the request matches the hostname of the device, it will send a response. <br><br>  As was correctly noted in the answer, the attacker can respond to such requests by sending his IP address in the response, which will lead to the fact that in the future the victim will contact the attacker‚Äôs device, instead of the device whose hostname appeared in the request.  In addition, an attacker can request NTLM authentication from the victim, which causes the victim device to send an NTLM hash, which can be further used for brute force. <br><br>  Recommended Tools: Responder <br><br>  <b>3) WPAD spoofing</b> <br>  WPAD spoofing can be attributed to a special case of LLMNR and NBNS spoofing.  Web Proxy Auto Discovery protocol is used to automatically configure an HTTP proxy server. <br><br>  The device sends an LLMNR / NBNS request with the wpad hostname, receives the corresponding IP address and tries to access the wpad.dat file via HTTP, which stores information about the proxy settings. <br><br>  As a result, the attacker can perform LLMNR / NBNS spoofing and provide the victim with his wpad.dat file, as a result, all HTTP and HTTPS traffic will go through the attacker. <br><br>  Recommended Tools: Responder, mitm6 <br><br>  <b>4) Router Advertisement</b> <br>  As you can see from the dump, there are devices with IPv6 enabled on the network.  While on the network, you can try sending messages to the victim IPv6 Router Advertisement in order to change the default gateway or DNS server. <br><br>  Router Advertisement (RA) messages are part of the Stateless Address Autoconfiguration (SLAAC) mechanism, which is required to automatically obtain IPv6 addresses on a network, without using a DHCPv6 server, or in conjunction with it.  This is achieved by periodically sending multicast RA messages to the router, which contain the default gateway address, network prefix, DNS server address, domain prefix. <br><br>  Recommended Tools: raw-packet <br><br>  <b>5) DHCP spoofing</b> <br>  Also, in a dump, DHCP Discover requests from the same device are repeated at some intervals.  We can conclude that there is no DHCP server in this network and respond to the next Discover request by specifying the victim as a default gateway to the device. <br><br>  Recommended Tools: Yersinia <br><br>  <b>6) HSRP spoofing</b> <br>  In addition, HSRP packets can be seen in the dump.  Hot Standby Router Protocol can increase the availability of routers that act as the default gateway.          IP-,     -.   Hello -        ,           .           HSRP, ,      ,      HSRP         . <br><br>  : Yersinia <br><br> <b>7) STP-</b> <br> Spanning Tree Protocol      L2-  .    BPDU-,           ,     .          BPDU-,   ,   ,    ,    ,         ,   ,   ,     STP,    ,    . <br><br>  : Yersinia <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 5. </font><font style="vertical-align: inherit;">Nginx config</font></font></font></strong> </h1><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here is the nginx web server configuration. </font><font style="vertical-align: inherit;">Describe in detail what security problems you see in it? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration: </font></font><a href="https://pastebin.com/nYp7uVbB"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pastebin.com/nYp7uVbB</font></font></a> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Job parsing</font></font></b> <div class="spoiler_text">   nginx,          : <br> 1)  86 ,   http  X-Managed      secured,  nginx     /management/ <br> 2)        API  70  105 . <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Expert J comment:</font></font></b> <div class="spoiler_text"><blockquote>        ,          .   nginx    ,     web-,       nginx    web-  /.           nginx ,  , ,     . <br><br> ,     ,   ,            .      ,         . ,    ,     . <br><br>         <a href="https://github.com/yandex/gixy">gixy</a> . <br><br> Gixy  4    : <br><br> <b>1) Alias travesal:</b> <br><br>   80     : <br><br><pre> <code class="plaintext hljs">location /static { alias /prod_static/; }</code> </pre><br>     - ,    .  : //host/static../etc/passwd.   -     alias:     ,   /static,   /prod_static/,       : /prod_static/../etc/passwd,      /etc/passwd.    alias traversal  <a href=""></a> <br><br> <b>2) Http Splitting (CRLF injection)</b> <br>    nginx  ,   ,        .       HTTP-. <br> : <a href="https://github.com/yandex/gixy/blob/master/docs/ru/plugins/">github.com/yandex/gixy/blob/master/docs/ru/plugins/httpsplitting.md</a> <br><br> <b>3)   -   </b> <br>   75      ¬´rigin¬ª   .    , -       , ,  <a href="http://production.host.evil.com/">production.host.evil.com</a> . <br> : <a href="">github.com/yandex/gixy/blob/master/docs/ru/plugins/origins.md</a> <br><br> <b>4)     add_header</b> <br>  nginx  :      add_header,       , ,    ,  .      CSP      . <br> : <a href="">github.com/yandex/gixy/blob/master/docs/ru/plugins/addheaderredefinition.md</a> <br><hr><br>  ,   gixy,          .       : <br><br> 1)   17     <b>default_type   text/html.</b>     :   ,     ,  nginx    Content-Type,    default_type.   ,         Content-Type: text/html.            HTML-  ,   , , XSS-   . <br><br> <b>2)    POST-</b> <br>  29-30   ,           .  ,   ‚Äú‚Äù POST-.       .  But!       SSRF  ,     ,   ,     , . <br><br> <b>3)   php-fpm</b> <br>   48  ,  FastCGI-    unix ,    9000.  ,    ,   .   ,      PHP-. <br><br> <b>4) ‚Äú‚Äù CSP</b> <br>  production.host  Content-Security-Policy,    Javascript,    . <br><br> <b>5) ‚Äú‚Äù CORS</b> <br>   76-77   CORS,          ,       cookie  . <br><br> 6)     ,   86   <b>  </b>  .       secured     /managed. <br><br> 7)      ,    ,        ,    -. ,   ,  ,    /user/{userid}  IDOR. <br><br>   ,       ,    ,     . <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 6. </font><font style="vertical-align: inherit;">Linux Permissions</font></font></font></strong> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> When can a Linux user read other user's home directories? </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Job parsing</font></font></b> <div class="spoiler_text">  ~ ()  Debian <br> C              ( ,      /etc/passwd). <br> ,      ftp  ,     ~. <br><br>  Example: <br> * root@server:~# ls ~ftp <br> * welcome.msg <br>      : <br> * root@server:~# cat ~ftp/welcome.msg <br> * Welcome, archive user %U@%R! <br>   ,    :      : <br> * root@amorale:~# echo ~ftp <br> * /srv/ftp <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Expert K Comment:</font></font></b> <div class="spoiler_text"><blockquote>    ,        : <br><br><ul><li>       </li><li>  ACL      </li><li>    </li><li>      </li><li>  capabilities </li></ul><br>   ,      ,   : <br> ‚Äú ,   root‚Äù   . <br><br>      ,     <code>Linux/Unix</code> . <br>    ,        ‚Äú ‚Äù ‚Äî           . <br>   ,     ,    <code>funky_test.txt</code>      <br><br><pre> <code class="plaintext hljs">-rwxrw-rx 1 alice interns 12  4 13:00 funky_test.txt</code> </pre> <br> ,    Linux/Unix   : <br><br><ul><li>  - ‚Äî    ‚Äúrwx‚Äù  alice </li><li>   ‚Äî    ‚Äúrw‚Äù   interns </li><li>    ‚Äî    ‚Äúrx‚Äù  others </li></ul><br>          <code>read, write, execute</code> . <br><br> ,     ‚Äî       ,      : <br><br><ul><li>    ,      read </li><li>    ,      read </li><li>     read </li></ul><br>  ,       <code>read</code>            .      ,      execute  . <br><br>            ,    . <br><br>          , ,    .      : <br><br> 1.          ,       ls. <br><br> 2.      ‚Äî <code>POSIX Access Control Lists</code> . <br><br><h4>    c   . </h4><br><h6>  Example 1 </h6><br> ,   <code>alice</code>     <code>interns</code> .      <code>funny_test.txt</code>    : <br><br><pre> <code class="plaintext hljs">$ whoami alice $ id uid=1001(alice) gid=1001(alice) groups=1001(alice),1002(interns) $ ls -la ----rwx--- 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt cat: funky_test.txt: Permission denied $</code> </pre><br><h5>  Example 2 </h5><br>   ‚Äî   <code>funky_test.txt</code>  604.    <code>bob</code> ,    <code>interns</code>    : <br><br><pre> <code class="plaintext hljs">$ whoami bob $ id uid=1002(bob) gid=1003(bob) groups=1003(bob),1002(interns) $ ls -la funky_test.txt -rw----r-- 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt cat: funky_test.txt: Permission denied</code> </pre><br><h5>  Remarks </h5><br>    <code>alice</code>       ,  .  , <code>permission_denied</code>    : <br><br><pre> <code class="plaintext hljs">$ id uid=1001(alice) gid=1001(alice) groups=1001(alice),1002(interns) $ ls -la ----rwx--- 1 alice interns 12  4 13:00 funky_test.txt $ chmod 777 funky_test.txt $ ls -la funky_test.txt -rwxrwxrwx 1 alice interns 12  4 13:00 funky_test.txt $ cat funky_test.txt secret_pass</code> </pre><br>      bob    . <br><br><h5>  Why is that </h5><br>    ,          ¬´  ¬ª,  : <br><br><ul><li>  ID      <code>effective UID</code> ‚Äî      </li><li>  GID        <code>effective GID</code> ‚Äî      </li><li>      others. </li></ul><br><h5>   </h5><br>  ,      ‚Äî   ,       ‚Äú‚Äù    ,        ,    , : <br><br><ul><li>    ,   ,          <code>others</code>     </li><li>   ,     ,   <code>others</code>     </li></ul><br>           . <br><br><h4> POSIX Access Control Lists </h4><br>      ‚Äî         /.   ,     ACL,  ,       ‚Äú <code>+</code> ‚Äù <br><br>      POSIX ACLs,    ‚Äî     ,            .      ACL,        . <br><br><h5>  Example </h5><br>  How it works.        <code>alice</code>   <code>funky_test.txt</code>  ,   <br><br><pre> <code class="plaintext hljs">-rwxrw-rx 1 alice interns 12  4 13:00 funky_test.txt</code> </pre> <br>      ACL.  <code>getfacl</code> , ,    ACL,   ,     <code>ls</code> . <br><br><pre> <code class="plaintext hljs">$ getfacl funky_test.txt # file: funky_test.txt # owner: alice # group: interns user::rwx group::rw- other::rx</code> </pre><br>   , ACL        .  ,     bob  : <br><br><pre> <code class="plaintext hljs">setfacl -mu:bob:rwx funky_test.txt</code> </pre><br>       ‚Äú <code>+</code> ‚Äù   <br><br><pre> <code class="plaintext hljs">ls -l funky_test.txt -rwxrwxr-x+ 1 alice interns 12  4 13:00 funky_test.txt</code> </pre><br>     : <br><br><pre> <code class="plaintext hljs">getfacl funky_test.txt # file: funky_test.txt # owner: alice # group: interns user::rwx user:bob:rwx group::rw- mask::rwx other::rx</code> </pre><br>  ACL     .  : <br><br><ol><li>     .      <code>effective UID</code>  <code>effective GID</code>  ‚Äî  .        ,       ACL,       .  ,     ,   ,  ,         ,    . </li><li>   ACL  <code>mask</code> ,      ACL    <code>owner, group, others</code> </li></ol><br><h5>   </h5><br>  ,         ,  ,     ‚Äî      . <br><br>   ,  ACL,     , : <br><br><ul><li>        ACL,     ; </li><li>   ,         ACL,     . </li></ul><br></blockquote></div></div><br><br><hr><br><h1> <strong><font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Number 7. </font><font style="vertical-align: inherit;">Network dump II</font></font></font></strong> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">During the work in the internal network of the company, you were able to receive the following traffic. </font><font style="vertical-align: inherit;">Analyze it, try to get useful data and files from the traffic, and also describe what further attacks you could conduct. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Traffic dump: </font></font><a href="https://yadi.sk/d/e3gNme4MBo6tFQ"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">yadi.sk/d/e3gNme4MBo6tFQ</font></font></a> <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Job parsing</font></font></b> <div class="spoiler_text">   ‚Äî      . <br>      ,     . <br>   ,     . <br><br><img src="https://habrastorage.org/webt/2t/zn/ip/2tznipywtpqwalr5drvxxr4z0sw.png"><br><br>   ,     SMB-,  ,    ,       .       SMB object list (File -&gt; Export objects -&gt; SMB‚Ä¶ ). <br><br>    ‚Äî     . <br><br><img src="https://habrastorage.org/webt/fe/rt/xy/fertxyt0du3kv3qwcmivz1m6opg.png"><br> <i>(  SMB object list)</i> <br><br><img src="https://habrastorage.org/webt/xo/yd/t-/xoydt-qmcbddrx1lkoqmpplyslg.png"><br> <i>(NotTruePass.jpg)</i> <br><br>     . <br><br>        ‚Äú‚Äù    TCP-‚Ä¶     .    .  :( <br><br>    ,        .    . <br><br><img src="https://habrastorage.org/webt/fd/ch/fc/fdchfcsbkrwxmx08ltr_1qnoozg.png"><br> <i>(  desktop.ini)</i> <br><br>     ‚Äú‚Äù     . ,      NTLM,   ,  ,  NTLM      ‚ÄúPass-the-hash‚Äù.               ¬´-¬ª. <br><br>     ‚Äú‚Äù    : <br><br><pre> <code class="plaintext hljs">1)User - 1 Account: IEUser Domain: WIN7 Host: WIN7 hex dump session key - 49 0c 38 3e f8 eb 63 88 79 0f 62 84 09 84 d2 dc 2) User - 2 Account: winwin Domain: WIN7 Host: WIN7 hex dump session key - 8d f6 1b 35 79 a3 78 d3 2e 81 09 f1 95 4f 71 0a 3) User - 3 Account: 192.192.192.29 Domain: WIN7 Host: WIN7 hex dump session key - c3 19 e0 21 1b e2 63 c6 03 9e e7 38 1b 56 f0 d1</code> </pre><br>            .       MSEDGEWIN10. <br><br>    ‚Äî     : <br><br> 1) SMB Relay. <br>           . <br>      ,   MITM- <br> (.             ). <br><br>      ‚Äî        ,      ,  . <br>      .       ,       . <br><br>    ,  ,  ,     . <br><br> 2) NTLM Relay. <br>         ,  NTLM-. <br><br>         ,   NTLM-. <br><br>          . <br>     ,     ,  ,    . <br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Expert K Comment:</font></font></b> <div class="spoiler_text"><blockquote>   ,  ,    : <br><br><ol><li>    (    ) </li><li>        ‚Äî / </li><li>      ,       </li></ol><br>       ,        : <br><br><ol><li>     </li><li>     </li><li>     </li></ol><br>     Wireshark,    <code>Protocol Hierarchy Statistics</code>  <code>Conversations</code> . <br><br> <code>Protocol Hierarchy Statistics</code> ‚Äî           . <br><br><img src="https://habrastorage.org/webt/_3/sy/co/_3sycoln1juvmnzbdlzrug24fgq.png"><br><br> Conversations ‚Äî   ,         . <br><br><img src="https://habrastorage.org/webt/31/xp/r7/31xpr7rmhyghnrctn3acyznwa9w.png"><br><br><img src="https://habrastorage.org/webt/rw/21/_d/rw21_dwv4digkin6kodypnfpl2w.png"><br><br>       : <br><br><ol><li>    (60%) ‚Äî  TCP, ,  , SMB.   Protocol hierarchy  SMB  40%,        TCP,     ,     20%      SMB. </li><li>      192.192.192.128  192.192.192.129.   SMB      . </li></ol><br> <b>  </b> <br><br>    . <br><br>        ‚Äî     SMB. <br><br>        ,    ‚Äî     wireshark ‚Äî  <code>ExportObject</code> . <br>              <code>tcp stream</code> .     ,     ,    <code>tcp stream</code> ,            .           ,      . <br><br>    , ,     ,     ,     .  ,         . <br><br> <b>  .</b> <br>     SMB       . <br><br>    NTLM-     ‚Äúntlmssp‚Äù.    <code>info</code> ,  3    : <br><br><img src="https://habrastorage.org/webt/mm/gn/pj/mmgnpjekpvddsd1f6vdx5ih8hec.png"><br><br> ,        . <br><br><img src="https://habrastorage.org/webt/rk/ix/7m/rkix7mvmxaaxs09m0vvazlblvco.png"><br><br><img src="https://habrastorage.org/webt/tx/zc/hc/txzchc1u7ufdzoqkjxtnrnsvfd0.png"><br><br><img src="https://habrastorage.org/webt/pd/hg/vd/pdhgvdcc_obs9smchhmwidqmawy.png"><br><br>          Net-NTLMv2-,  : <br><br><ul><li> challenge  </li><li> response  </li><li>   </li></ul><br>  <code>Net-NTLMv2</code>       <code>hashcat</code> . <br><br> ,        <code>WIN7\winwin</code>  <code>WIN7\192.192.192.129</code> ‚Äî      ,          .    <code>WIN7\IEUser</code> ‚Äî ,       ,  ,  ,   ,  SMB. <br><br>  <code>Net-NTLM</code>   ,   ,    Wireshark.    ,  PCredz (https://github.com/lgandx/PCredz) <br><br><img src="https://habrastorage.org/webt/jd/gn/zj/jdgnzjzb6pgscawu43bxtf5wc0y.png"><br><br>     <code>IEUser</code> (   )     hashcat. <br><br><img src="https://habrastorage.org/webt/ky/i6/gf/kyi6gfki84pqjj4fgjximusk9qa.png"><br><br> <b>     ,      .</b> <br><br>        6,   ,   <code>SMB/NTLM</code> , <code>DNS</code> . <br><br> ,      ,    <code>NT</code>  <code>LM</code>  <code>NTLMv1 (Net-NTLMv1)</code> , <code>NTLMv2 (Net-NTLMv2)</code> ( <a href="https://medium.com/%40petergombos/lm-ntlm-net-ntlmv2-oh-my-a9b235c58ed4">     </a> ). <br><br> -    <code>NT</code>  <code>LM</code>  <code>NTLM</code> ,         <code>NTLM</code>  <code>NTLMv1</code>  <code>NTLMv2</code> . ,           .  But this is not so. <br><br>     ,  <code>NTLMv1/NTLMv2</code> ‚Äî    challenge-response .        ,    . <br><br>  NT  LM ‚Äî   ‚Äú  ‚Äù ‚Äî        . <br><br>      : <br><br><ul><li> PassTheHash ‚Äî ,        ,     .  But.     ,  <code>NT</code> .  PassTheHash  NTLMv2  ‚Äî   .        ,      ‚Äú‚Äù  ,       ,    . </li><li> NTLM Relay ‚Äî ,        ,     NTLM.      ,    . </li><li> Spoofing,     Windows: LLMNR, NetBios </li><li>     : MS17-010,    /  ,   . </li></ul><br>  <b>Summary</b> <br><br>     : <br><br><ul><li>    ( ) </li><li>       </li><li>       ,           </li><li>            eternalBlue </li><li>  NTLM relay </li><li>   NTLM relay    ‚Äî   SMB </li><li>       </li><li>   ,     (ARP-spoofing,  DNS   )  </li></ul><br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Number 8. </font><font style="vertical-align: inherit;">SSH Pivoting Tricks</font></font></font></strong> </h1><br><img src="https://habrastorage.org/webt/ui/gy/a1/uigya1oqcd1poeuc6whph79ehzw.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You are on network A (10.0.10.0/24), you were able to access via SSH to the Linux host (10.0.20.5) on network B (10.0.20.0/24). </font><font style="vertical-align: inherit;">However, you found that you do not have full access to network B. Think of and describe in detail the method by which you could scan network B without installing any additional scripts / utilities / programs on the Linux host.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Job parsing</font></font></b> <div class="spoiler_text"> ,    ,   : <br>    <br> nmap      <br><br>    ? <br><br>  Option: <br><br> 1)  ping. <br>  -&gt; ping -b 10.0.20.255 <br>  ping  ,     ,    . <br>    ,               . <br>           . <br> ,     CentOS 7. <br>        . <br><br><img src="https://habrastorage.org/webt/7y/vu/rn/7yvurntbjwgei1q8rr6yth0kjww.png"><br> <i>(  )</i> <br><br>    ,           .  :( <br><br><img src="https://habrastorage.org/webt/nd/r1/jc/ndr1jchof8-_rzbgh-ru1xg7vh0.png"><br><br> 2)   ARP-  . <br>  -&gt; <br>  Debian ‚Äî arp-scan --interface=/* */ 10.0.0.0/16 <br>  Linux      arp,    ( Debian) -   ,      arp-scan. <br> arp-scan,   ,      ,    . <br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KryaKrya expert comment:</font></font></b> <div class="spoiler_text"><blockquote>       ,           ,  ,      Pivoting.      ,      ,   ,          ,      ,          . <br><br> ,       ping    ,  ARP- (arp -a),    (route).   ,     netcat (nc -h),  ,      (nc -vnz 10.0.20.3 0-1000).    ,      ,        , , ,   ,   -     bash,   python      . <br><br>     ‚Äî    SSH-,   SOCKS-  SSH,          . <br> ssh -D 1337 user@10.0.20.5 -f -N <br><br>            .     nmap  SOCKS-   proxychains    . <br><br> proxychains nmap 10.0.20.0/24 <br> nmap 10.0.20.0/24 --proxy socks4://10.0.20.5:1337 <br><br>     nmap       - SOCKS-.     SYN- ( nmap    )  SOCKS-,  SOCKS-    TCP-   ,  SYN-      ,    SYN,    SYN ACK.      CONNECT- (-sT),  nmap      SOCKS-. <br><br> nmap -sT 10.0.20.0/24 --proxy socks4://10.0.20.5:1337 <br><br> ,    -  ,         ,        . ,       Linux-,   nmap  -sT  ,     ,     ,      ,    ,    ,        . <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 9. </font><font style="vertical-align: inherit;">Android SSL pinning bypass</font></font></font></strong> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You are exploring a mobile application for Android. </font><font style="vertical-align: inherit;">You have found that the application sends requests over the secure HTTPS protocol. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) Describe how you would try to bypass the protection and get unprotected HTTP traffic. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) What will change if SSL-pinning is enabled in the application, how can I try to circumvent protection in this case?</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Job parsing</font></font></b> <div class="spoiler_text"> ¬´,           HTTP-.¬ª <br><br>        . <br>        proxy host   wifi. <br><br>  Android     ,  ,      . <br><br>  ‚Äî    (  )   ‚Äî   ( ,  ). <br>  ,      MITM,   Android 6.0,      ,     . <br><br>       6.0,         . <br><br> ¬´ ,      SSL-pinning,        ?¬ª <br><br>  ,    SSL-pinning. <br><br> SSL-pinning ‚Äî   ,    ,   ¬´¬ª      . <br><br>        HTTPS-,   ,  ¬´¬ª.      ,       . <br><br>   ,      MITM-,    . <br><br>   ,      ,     ,       . <br><br>   ‚Äî  Frida. <br> Frida ‚Äî    Dinamic Instrumentation Toolkit,    ,         . <br> , Frida        Javascript. <br>       Frida     ,    , ,  ¬´True¬ª  ¬´False¬ª,     . <br><br>     Frida: <br><br> 1.      ,      .      -. <br><br> 2.      Frida.        Root. <br><br>      . <br>  APK-           .  ,       ,      . <br>      .     apk  META-INF    . <br><br> ‚Äú‚Äù APK-. <br>       APK   smali   Java,     ,     . <br>     ,    ,     . <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Expert Commentary I:</font></font></b> <div class="spoiler_text"><blockquote> ,     MITM HTTPS       . <br><br>      ,       Proxy   WiFi.      ProxyDroid,    iptables  . <br><br> ,      Root ,         , ? <br><br>    SSL-Pinning,    , ,  ‚ÄúFrida+Objection‚Äù. ,           :) <br></blockquote></div></div><br><hr><br><h1> <strong><font color="#cc0000"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No. 10. </font><font style="vertical-align: inherit;">What is your favorite attack?</font></font></font></strong> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tell us about the most interesting attack technique or published vulnerability that you have learned about recently. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The only task in the ‚Äúfree format". The attack that I liked lately is dns-rebinding. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">That‚Äôs all for me.</font></font> Thanks for attention! <br><br><hr><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Closing remarks from </font></font><a href="https://dsec.ru/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digital Security</font></font></a></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Now let us slightly open the veil, how did the process of evaluating the guys go. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each answer was independently evaluated by at least 3 specialists (one must somehow have fun in their free time from audits). The range of acceptable ratings was from 0 to 5 points with the ability to set at least 2.5, or even 3.1337 if you wish. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a result, the estimates are averaged and summed up. Thus, the maximum could score 50 points. Our experts tried to be as loyal as possible and understand what the next candidate had in mind about ‚Äú </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hacking through the form code</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚Äù or something else like that)</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We set the passing score after the application deadline is closed. This year he made 29 points, and the best result was 43.5. As a result, approximately 24% of all applicants went for an internship. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The statistics are as follows: </font></font><br><br><img src="https://habrastorage.org/webt/fn/iq/fb/fniqfb7brnsnuqx08am8vx7xmtq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, for these lucky ones it didn‚Äôt end so simply, because then they had a face-to-face interview, where we asked the guys what they liked in the questionnaire, what questions were the most difficult to answer and how long it took them to complete . Thus, we were convinced that no one helped the guys with the questionnaire, and they filled it out themselves. At the same time, we received useful feedback for the next years.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It may seem that such a system is unreasonably complex, but, unfortunately, we cannot afford to accept everyone and want to share our knowledge with the most motivated of the guys. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By the way, which is noteworthy, every year we see a surge in applications exactly at the end of the term: </font></font><br><br><img src="https://habrastorage.org/webt/wn/z_/p9/wnz_p90qafczlytjrpuddurwkbc.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For our part, we provide a wide variety of lectures (almost every day!), Access to our small but proud internal laboratory with a bunch of interesting hacking tasks compiled by experienced specialists where you can hone your practical skills and train your ‚Äúhacker instinct".</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The main occupation of the internship is a joint study with an experienced curator of some interesting and significant aspect of security, whether it be vulnerabilities in new technology or a tool that allows you to solve existing difficulties in conducting security analysis. </font><font style="vertical-align: inherit;">However, we will talk more about this in our materials dedicated to the end of Summer of Hack 2019. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a conclusion, I want to say that for the second year we have been selecting using such a system and are increasingly convinced of its effectiveness. </font><font style="vertical-align: inherit;">With the help of it, we really manage to select strong trainees and get information about the average level of knowledge among students and graduates.</font></font></div><p>Source: <a href="https://habr.com/ru/post/461077/">https://habr.com/ru/post/461077/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461069/index.html">Nobelic Outdoor IP Cameras: Tests, Technologies, and Capabilities of Ivideon Video Surveillance Systems</a></li>
<li><a href="../46107/index.html">Booting MS Windows from a USB flash drive</a></li>
<li><a href="../461071/index.html">Optimization of database queries on the example of B2B service for builders</a></li>
<li><a href="../461073/index.html">We connect online maps to the navigator on the smartphone. Part 3 - OverpassTurbo</a></li>
<li><a href="../461075/index.html">Business analytics. IT objects, components, tools</a></li>
<li><a href="../461081/index.html">The day Dodo IS stopped. Asynchronous script</a></li>
<li><a href="../461083/index.html">Writing software with the functionality of client-server utilities Windows, part 02</a></li>
<li><a href="../461085/index.html">Switching the language in the Android application</a></li>
<li><a href="../461087/index.html">Generating dungeons and caves for my game</a></li>
<li><a href="../46109/index.html">Call me back on ... iTouch!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>