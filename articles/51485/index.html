<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Download files and open_basedir: why you should use standard functions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It would seem that the issue of uploading files to the server is sucked to the bone, but one recent event made me doubt this. 

 Some time ago, in ord...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Download files and open_basedir: why you should use standard functions</h1><div class="post__text post__text-html js-mediator-article">  It would seem that the issue of uploading files to the server is sucked to the bone, but one recent event made me doubt this. <br><br>  Some time ago, in order to increase security on our servers, the PHP setting <a href="http://ru.php.net/manual/ru/ini.sect.safe-mode.php">open_basedir</a> was enabled.  After that, many PHP applications stopped uploading files to the server. <br><br><a name="habracut"></a>  According to the link there are a lot of letters (which are still recommended to be read), here I will write briefly: <br><ul><li>  open_basedir <b>limits the list of files</b> that PHP can access to by the <b>specified directory tree</b> . </li><li>  open_basedir can be used <b>regardless of whether protected mode is used or not</b> . </li></ul><br>  After enabling this setting on our servers, the scripts were ‚Äúlocked‚Äù inside the directory of their site (virtual host).  Files continued to be loaded into the directory for temporary files, which was located on another section and was not included in the directory tree of the site.  Accordingly, all scripts that tried to access the uploaded files through the <b>tmp_name</b> element of the <a href="http://ru.php.net/manual/ru/reserved.variables.files.php">$ _FILES</a> variable failed. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Of course, the PHP language is developed by intelligent people, so the open_basedir action <b>does not apply to the <a href="http://ru.php.net/manual/ru/function.is-uploaded-file.php">is_uploaded_file</a> and <a href="http://ru.php.net/manual/ru/function.move-uploaded-file.php">move_uploaded_file functions</a></b> , which, in fact, are designed to work with downloaded files. <br><br>  So what's the problem then?  And the problem is this: many ( <a href="http://google.com/codesearch%3Fhl%3Dru%26lr%3D%26q%3Dcopy.*FILES%5C%5B.*%5C%5D%5C%5B(%2527%7C%2522)tmp_name%2Blang%253Aphp">indeed many!</a> ) Refer directly to the uploaded files, <b>bypassing the standard functions</b> . <br><br>  This is usually done in cases where the downloaded file is not supposed to be stored on the site.  As a rule, this is the import of price lists (csv, xls), pictures that are converted before being saved in the file tree of the site.  Often $ _FILES is used to check the loaded image (getimagesize) before calling move_uploded_file. <br><br>  I strongly advise PHP programmers (especially beginners), first, not to neglect the use of standard functions.  If the function is written, then it means something is needed.  Secondly, carefully study the settings of PHP and its modes of operation.  This will help to avoid such mistakes. <br><br>  PS Someone can say "you are not figuring to configure the server so that the scripts stop working".  However, I believe that if there is a setting, then someone will definitely use it.  And if your program stops working after that, the stones will fly into you.  Do you (we) need it? </div><p>Source: <a href="https://habr.com/ru/post/51485/">https://habr.com/ru/post/51485/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../51472/index.html">Russian-language Jabber-Conference CakePHP</a></li>
<li><a href="../51474/index.html">Is the list parallel or perpendicular?</a></li>
<li><a href="../51480/index.html">Tie geek, 8 bit in new format</a></li>
<li><a href="../51483/index.html">Polaroid saved</a></li>
<li><a href="../51484/index.html">SMS Gateway</a></li>
<li><a href="../51488/index.html">ISP Onlime - new facts and impressions, two months later</a></li>
<li><a href="../51489/index.html">The word netbook can no longer be used in Google Ads.</a></li>
<li><a href="../51491/index.html">Incredible probabilistic processor</a></li>
<li><a href="../51493/index.html">Crisis with Spout</a></li>
<li><a href="../51494/index.html">Top 100 most popular words in Yandex, Google, Rambler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>