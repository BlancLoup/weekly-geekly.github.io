<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Blood vessel segmentation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 The retina, like any other object, has its symptoms. Its main features are blood vessels, the optical disk and the macular region (Fig....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Blood vessel segmentation</h1><div class="post__text post__text-html js-mediator-article"><h3>  Introduction </h3><br>  The retina, like any other object, has its symptoms.  Its main features are blood vessels, the optical disk and the macular region (Fig. 1). <br><br><img src="https://habrastorage.org/files/17e/aba/c66/17eabac66d934537a0c8e5ba21653717.jpg" alt="image"><br>  <i>Fig.</i>  <i>1. The structure of the retina</i> <br><br>  As a rule, during authentication, only blood vessels or signs associated with them are compared, since their uniqueness is easily distinguishable.  The disk can serve only as an additional parameter for comparison, however, it is used quite rarely.  The macular area is not used for authentication purposes at all. <br><a name="habracut"></a><br><h3>  Blood vessel segmentation </h3><br>  Before proceeding to segmentation, in order to obtain more accurate results, it is necessary to improve the contrast between the background and the segmented object. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Improved contrast between background and blood vessels</b> <div class="spoiler_text">  When segmentation of blood vessels, the green channel is used instead of the usual gray one (fig. 2).  This is done because the green channel contains the maximum local contrast between the background and the object. <br><br><img src="https://habrastorage.org/files/fcc/024/549/fcc02454997342f4b0f19753ef57cdeb.jpg" alt="image"><br>  <i>Fig.</i>  <i>2. An example from the DRIVE database (the gray channel is on the left, the green channel is on the right)</i> <br><br>  In addition to using the green channel, a contrast-limited adaptive histogram equalization (clahe) is used.  The result of the algorithm is shown in Fig.  3 <br><br><img src="https://habrastorage.org/files/4e8/a3d/057/4e8a3d05785b4a6d9467264e4f3c0c28.jpg" alt="image"><br>  <i>Fig.</i>  <i>3. Clahe (on the left - the original image, on the right - the image after applying the algorithm)</i> <br></div></div><br><h4>  Remove background with average filter </h4><br>  To simplify vessel segmentation, the background is first removed.  This is done by subtracting the original image from the smoothed average filter image.  The size of the filter window is chosen equal to the maximum thickness of the vessels in pixels. <br><br>  To remove the boundaries of a circle, its mask is calculated (Fig. 4) using a threshold transform and morphological discovery and subtracted from the image obtained at the previous step.  Then again clahe is applied.  The result is shown in Fig.  five. <br><br><img src="https://habrastorage.org/files/dca/665/696/dca66569662c46529b7c07243ebd683f.jpg" alt="image"><br>  <i>Fig.</i>  <i>4. Retina mask</i> <br><br><img src="https://habrastorage.org/files/46f/827/cef/46f827cef8f5491889d084a658e606a4.jpg" alt="image"><br>  <i>Fig.</i>  <i>5. Background removal (on the left - the result of the average filter, on the right - after subtraction and clahe)</i> <br><br>  Next, apply the automatic threshold conversion method Otsu, the median filter and the filter length.  The result of the segmentation algorithm and the standard are shown in Fig.  6 <br><br>  For convenience, this segmentation algorithm and the background removal algorithm will both be referred to as background exclusion. <br><br><img src="https://habrastorage.org/files/bcb/0f0/677/bcb0f0677e61415fb34eede1934e323c.jpg" alt="image"><br>  <i>Fig.</i>  <i>6. Segmentation result (on the left - the result of the algorithm, on the right - the standard, manually marked by an expert)</i> <br><br><h4>  Gabor filter </h4><br>  This segmentation method is based on the use of the Gabor filter series.  A distinctive feature of this filter is that it is able to select straight lines of a certain size and at a certain angle. <br>  The real part of this filter is as follows: <br><br><img src="https://habrastorage.org/files/a9f/049/fab/a9f049fab4fc44e4bedd19dcfcd89412.jpg" alt="image"><br>  Where <br><ul><li><img src="https://habrastorage.org/files/147/d4c/b30/147d4cb307114552beedd574d143de7c.jpg" alt="image"></li><li><img src="https://habrastorage.org/files/f88/4f5/e5a/f884f5e5ab6f4463b4a35e53eedeab0c.jpg" alt="image"></li><li><img src="https://habrastorage.org/files/e68/196/7dd/e681967dd0f24006a16334e97621055e.jpg" alt="image">  , <img src="https://habrastorage.org/files/b5b/4f6/2bd/b5b4f62bd8c14739bb8f2ac2369dd2f5.jpg" alt="image">  - coordinates of the nucleus in predetermined limits; </li><li><img src="https://habrastorage.org/files/ec4/7af/e14/ec47afe14c9d4f4c833e04f0122c62f4.jpg" alt="image">  - core period in pixels; </li><li><img src="https://habrastorage.org/files/5d1/237/4ca/5d12374cacd549d88a9045a7af75c070.jpg" alt="image">  - the slope of the core; </li><li><img src="https://habrastorage.org/files/06b/56c/aff/06b56cafff314aef9b00cb4a6f6f4fe6.jpg" alt="image">  - Gaussian dispersion; </li><li><img src="https://habrastorage.org/files/afc/845/4e8/afc8454e87ce43a09da4bc4ca8d7ded9.jpg" alt="image">  - core phase shift; </li><li><img src="https://habrastorage.org/files/e6b/70d/5b8/e6b70d5b89f44d2cb84d551e835f0fe5.jpg" alt="image">  - gaussian compression. </li></ul><br>  Thus, to select the vessels, you need to apply a Gabor filter with different angles of inclination of the core and count the maximum response of each pixel to a series of filters. <br><br>  As seen in fig.  7, most of the noise disappeared, but the optical disk, the background and the macular area still remained.  To eliminate them, a background removal algorithm with the same parameters as in the previous section is applied before the Gabor filter series.  The result is shown in Fig.  eight. <br><br><img src="https://habrastorage.org/files/f37/351/f15/f37351f15e5d42fdaf5a89d4b04fc184.jpg" alt="image"><br>  <i>Fig.</i>  <i>7. Gabor filter (on the left - the original image after clahe, on the right - the result of applying a series of Gabor filters)</i> <br><br><img src="https://habrastorage.org/files/196/e3a/520/196e3a5201b14a77b069917633a620b9.jpg" alt="image"><br>  <i>Fig.</i>  <i>8. Background removal + Gabor filter (on the left - the original image obtained using the background exclusion algorithm, on the right - the result of applying a series of Gabor filters)</i> <br><br>  The next step in the algorithm is the threshold transform. <br>  In order for the Otsu method to show more accurate segmentation results, it is necessary to convert all the background colors into one color.  To do this, consider the histogram of the right image in Fig.  8 (fig. 9): <br><br><img src="https://habrastorage.org/files/9cc/5ee/836/9cc5ee83699147088e49803d65aaf41a.jpg" alt="image"><br>  <i>Fig.</i>  <i>9. Histogram of the image obtained using the Gabor filter series</i> <br><br>  From the graph it is clear that the peak number of pixels falls on a gray background.  Therefore, the pixels whose color is to the right of the peak can be repainted in a different color.  However, a slight noise will still be present on the segmented image.  To eliminate it, you can shift the threshold threshold from the peak to the left. <br><br>  We introduce the sensitivity parameter of the algorithm from 0 to 100. The threshold for the conversion will be the closest color, the number of pixels of which does not exceed the value of the sensitivity parameter to the left of the peak.  The value found will be the new value of the intensity of the pixels to the right of the border.  The result is shown in Fig.  ten. <br><br><img src="https://habrastorage.org/files/661/dcd/aa4/661dcdaa4acd4fc3b756210278fdca6f.jpg" alt="image"><br>  <i>Fig.</i>  <i>10. Threshold conversion of the image intensity (on the left - the original image obtained after repainting pixels in accordance with the sensitivity parameter, on the right - the result of the Otsu method)</i> <br><habracut><br>  In the implementation, the Gabor filter was used with the following parameters: <br><ul><li>  core size - 15 x 15; </li><li><img src="https://habrastorage.org/files/ec4/7af/e14/ec47afe14c9d4f4c833e04f0122c62f4.jpg" alt="image">  - four; </li><li><img src="https://habrastorage.org/files/5d1/237/4ca/5d12374cacd549d88a9045a7af75c070.jpg" alt="image">  - from 0 to 170 degrees in increments of 10; </li><li><img src="https://habrastorage.org/files/06b/56c/aff/06b56cafff314aef9b00cb4a6f6f4fe6.jpg" alt="image">  - one; </li><li><img src="https://habrastorage.org/files/afc/845/4e8/afc8454e87ce43a09da4bc4ca8d7ded9.jpg" alt="image">  - 0; </li><li><img src="https://habrastorage.org/files/e6b/70d/5b8/e6b70d5b89f44d2cb84d551e835f0fe5.jpg" alt="image">  - 0.15. </li></ul><br>  The above parameters were selected for the DRIVE database. <br><br><div class="spoiler">  <b class="spoiler_title">Testing segmentation algorithms</b> <div class="spoiler_text"> The algorithm was tested on two databases: DRIVE and STARE.  The first base consists of 40 images captured with a Canon CR5 camera in a 24-bit color space and with a resolution of 565 x 584. The second database consists of 20 images captured with a TopCon TRV-50 camera in a 24-bit color space and c 700 x 605 resolution. Both databases provide manually marked out standards for vascular segmentation. <br><br>  Algorithm performance parameters: <br><ul><li>  P is the number of pixels corresponding to the vessels; </li><li>  N is the number of pixels corresponding to the background; </li><li>  TP is the number of pixels that are part of the vessel and defined as the pixel of the vessel; </li><li>  TN is the number of pixels that are not part of the vessel and are defined as background; </li><li>  FP - the number of pixels that are not part of the vessel and defined as the pixel of the vessel; </li><li>  FN - the number of pixels that are part of the vessel and defined as the background; </li><li>  Sensitivity = TP / (TP + FN); </li><li>  Specificity = TN / (TN + FP); </li><li>  Accuracy = (TP + TN) / (P + N). </li></ul><br><br>  Efficiency of various blood vessel segmentation algorithms based on DRIVE database <br><table><tbody><tr><th>  Segmentation method </th><th>  Accuracy </th><th>  Sensitivity </th><th>  Specificity </th></tr><tr><td>  Human observer </td><td>  0.9473 </td><td>  0.7761 </td><td>  0.9725 </td></tr><tr><td>  Staal et al. </td><td>  0.9442 </td><td>  0.7345 </td><td>  0.9773 </td></tr><tr><td>  Niemeijer et al. </td><td>  0.9416 </td><td>  0.7145 </td><td>  0.9801 </td></tr><tr><td>  Zana and klein </td><td>  0.9377 </td><td>  0.6971 </td><td>  0.9769 </td></tr><tr><td>  Jiang and mojon </td><td>  0.9212 </td><td>  0.6399 </td><td>  0.9625 </td></tr><tr><td>  Vlachos and Dermatas </td><td>  0.9285 </td><td>  0.7468 </td><td>  0.9551 </td></tr><tr><td>  Wang et al. </td><td>  0.9461 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Martinez-Perez et al. </td><td>  0.9181 </td><td>  0.6389 </td><td>  0.9496 </td></tr><tr><td>  Szpak and Tapamo </td><td>  0.9299 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Chaudhuri et al. </td><td>  0.8773 </td><td>  0.3357 </td><td>  0.9794 </td></tr><tr><td>  Soares et al. </td><td>  0.9466 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Akram and Khan </td><td>  0.9469 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Mendonca and Campilho </td><td>  0.9463 </td><td>  0.7315 </td><td>  N / A </td></tr><tr><td>  Marin et al. </td><td>  0.9452 </td><td>  0.7067 </td><td>  0.9801 </td></tr><tr><td>  Ricci and Perfetti </td><td>  0.9595 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Xiao et al. </td><td>  0.9529 </td><td>  0.7513 </td><td>  0.9792 </td></tr><tr><td>  Yin et al. </td><td>  0.9267 </td><td>  0.6522 </td><td>  0.9710 </td></tr><tr><td>  Chakraborti et al. </td><td>  0.9370 </td><td>  0.7205 </td><td>  0.9579 </td></tr><tr><td>  <b>Background exclusion</b> </td><td>  <b>0.9501</b> </td><td>  <b>0.7183</b> </td><td>  <b>0.9722</b> </td></tr><tr><td>  <b>Background exclusion + Gabor</b> </td><td>  <b>0.9580</b> </td><td>  <b>0.7174</b> </td><td>  <b>0.9809</b> </td></tr></tbody></table><br>  Efficiency of various blood vessel segmentation algorithms based on STARE data <br><table><tbody><tr><th>  Segmentation method </th><th>  Accuracy </th><th>  Sensitivity </th><th>  Specificity </th></tr><tr><td>  Human observer </td><td>  0.9354 </td><td>  0.8949 </td><td>  N / A </td></tr><tr><td>  Hoover </td><td>  0.9275 </td><td>  0.6751 </td><td>  0.9567 </td></tr><tr><td>  Staal et al. </td><td>  0.9516 </td><td>  0.6970 </td><td>  N / A </td></tr><tr><td>  Jiang and mojon </td><td>  0.9009 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Marin et al. </td><td>  0.9526 </td><td>  0.6944 </td><td>  0.9819 </td></tr><tr><td>  Ricci and Perfetti </td><td>  0.9584 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Soares et al. </td><td>  0.9480 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Akram and Khan </td><td>  0.9502 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Wang et al. </td><td>  0.9521 </td><td>  N / A </td><td>  N / A </td></tr><tr><td>  Mendonca and Campilho </td><td>  0.9479 </td><td>  0.7123 </td><td>  N / A </td></tr><tr><td>  Xiao et al. </td><td>  0.9476 </td><td>  0.7147 </td><td>  0.9735 </td></tr><tr><td>  Yin et al. </td><td>  0.9412 </td><td>  0.7248 </td><td>  0.9666 </td></tr><tr><td>  Chakraborti et al. </td><td>  0.9379 </td><td>  0.6786 </td><td>  0.9586 </td></tr><tr><td>  <b>Background exclusion</b> </td><td>  <b>0.9562</b> </td><td>  <b>0.7379</b> </td><td>  <b>0.9742</b> </td></tr><tr><td>  <b>Background exclusion + Gabor</b> </td><td>  <b>0.9381</b> </td><td>  <b>0.7918</b> </td><td>  <b>0.9502</b> </td></tr></tbody></table><br></div></div><br><div class="spoiler">  <b class="spoiler_title">List of used sources and literature</b> <div class="spoiler_text"><ul><li>  Marwan D. Saleh, C. Eswaran, and Ahmed Mueen.  Annotated Blood Vessel Segmentation Algorithm Using Histogram, Vol. 24, No 4 (August), 2011, pp 564-572 </li><li>  PC Siddalingaswamy, K. Gopalakrishna Prabhu.  Retinal images // J. Biomedical Science and Engineering, 2010, 3, pp 101-107 </li><li>  <a href="http://www.isi.uu.nl/Research/Databases/DRIVE/">www.isi.uu.nl/Research/Databases/DRIVE</a> </li><li>  <a href="http://www.ces.clemson.edu/~ahoover/stare/">www.ces.clemson.edu/~ahoover/stare</a> </li></ul><br></div></div><br>  <a href="http://habrahabr.ru/post/261309/">Continuation of feature matching</a> </habracut></div><p>Source: <a href="https://habr.com/ru/post/259017/">https://habr.com/ru/post/259017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259005/index.html">We invent a bicycle in Java - we write our Framework (DI, ORM, MVC and etc)</a></li>
<li><a href="../259007/index.html">Why iphone reloads from arabic sms</a></li>
<li><a href="../259009/index.html">Updated and enhanced version of DriverPack Online - the first in importance, 16 by number</a></li>
<li><a href="../259013/index.html">Chrome extension allows you to follow your friends via Facebook Messenger</a></li>
<li><a href="../259015/index.html">Reading 64-bit integers from Oracle to OCCI (MSVC)</a></li>
<li><a href="../259021/index.html">How I reduced the Docker image by 98.8% with fanotify</a></li>
<li><a href="../259023/index.html">Fedora 22 - all trends in one build</a></li>
<li><a href="../259025/index.html">Web-based Crona</a></li>
<li><a href="../259027/index.html">InGaAs Semiconductor as an Alternative to Silicon</a></li>
<li><a href="../259029/index.html">Samba4 - using Python Scripting Interface</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>