<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ÄúIceberg instead of Oscar!‚Äù Or as I tried to learn the basics of DataScience on kaggle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my last article on the development of data science (or Data Science abroad) from absolute zero (even lower than -273 degrees Kelvin), I promised th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>‚ÄúIceberg instead of Oscar!‚Äù Or as I tried to learn the basics of DataScience on kaggle</h1><div class="post__text post__text-html js-mediator-article">  In my last <a href="https://habrahabr.ru/post/331794/">article</a> on the development of data science (or Data Science abroad) from absolute zero (even lower than -273 degrees Kelvin), I promised that I would prepare a material on how I mastered <a href="https://www.kaggle.com/">kaggle</a> (I will write with a small letter, as they have on the logo). <br><br>  For those who, just like me, are just beginning to get acquainted with this issue, I will explain that, as I understood, kaggle is a website dedicated to competitions and, to some extent, training in Data Science, where everyone can do it for free and using any available tools. forecast for a particular task. <br><br>  If it is interesting to you that as a result from all it came out from me I ask under kat. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>UPD</b> : With a fresh mind, I added some small explanations about the ‚Äúdata‚Äù tab and about retraining the model. <br><br><img src="https://habrastorage.org/web/65d/4a6/ee6/65d4a6ee6e9d43be8ece050505fd018e.png"><br><a name="habracut"></a><br><h2>  Part 1. "My sail turns white so lonely ..." - a little about skills </h2><br>  According to a good tradition, I‚Äôll start the article with a description of my skills so that a novice reader can understand that I have practically no knowledge and also become inspired. <br><br>  So, my knowledge of what Data Science is and what it is eaten with is based on courses from the <a href="https://habrahabr.ru/post/331118/">Cognitive class</a> (SS) and on the self-tutorial Data Science from Scratch (by reference my opinion on these resources). <br><br>  So that it would not be necessary for you to spend your time, I briefly summarize: <br><br><ol><li>  Cognitive class - told me about what Data Science is and briefly demonstrated a certain set of applied practices and tools, but after passing the course I did not learn anything worthwhile on my own. <br><br></li><li>  The tutorial gave me a cursory tour of the world of data science, showed the basic techniques and gave references to basic knowledge, but due to the fact that in the book all the functions for analysis were written from scratch, then use real libraries, (for example, pandas ) I never learned, well, and the short course of Python presented in the book was enough just enough to not ‚Äúgoggle‚Äù at the sight of the learning code from the kaggle tutorials (about which later). </li></ol><br>  Therefore, despite knowledge of some concepts in the field of Data Science, having opened the first and probably the most popular task about Titanic, I was essentially ‚Äúalone in an open field,‚Äù and there were some ratings, ‚Äúnotebooks‚Äù with solutions and people who obviously know something ... <br><br><h2>  Part 2. "... Against the background of steel ships" - a little about the kaggle and the competition about the Titanic </h2><br>  I suspect that my article about kaggle is not the first one and, if you wish, you can find different information about what it is and <a href="https://habrahabr.ru/post/248395/">how to start working with it</a> , but I would still like to share my experience of entering this wonderful world. <br><br>  So, as I said at the very beginning, kaggle is a portal dedicated to data science competitions.  Registration on the portal is completely free, the presented tools seem to be too (if there is something paid please write in the comments I will update the article). <br><br>  Competitions on the portal are divided into different categories, some give money for prizes, some tasks are just for fun, of course there are tasks oriented to beginners (as I understand it, ratings are regularly cleaned), well, there are some semi-closed competitions, apparently somehow related to other portals. <br><br>  As I understand it, the portal is designed so that users can compete in forecasting and boast to their colleagues and employers high places in the leaderboards, but companies can probably solve some of their research tasks or even find employees (there is such a section on the website ). <br><br>  The portal is presented in English, so if you don‚Äôt own it at all, it will be hard for you (‚Äúthanks to CEP!‚Äù). <br><br>  I remember when I was registering, I really wanted to sleep, so I didn‚Äôt understand anything and spat, but I must pay tribute to the project team, in the morning I received a letter with a greeting and a proposal to begin acquaintance with the <a href="https://www.kaggle.com/c/titanic/">Titanic: Machine Learning from Disaster</a> course, and I was convinced they refuse. <br><br>  As it seemed to me, the task of determining the number of survivors on Titanic seems to be the most beaten and is mentioned, probably, in half of all courses in Data Science. <br><br>  <i>(By the way, an excellent task for analytics, to find out how often in Data Science courses and books the problem about Titanic is mentioned and how often it will be mentioned in the future if someone owns the data, write in the comments, update the article hot on the heels)</i> <br><br>  On the ‚ÄúOverview‚Äù page of the competition there is a descriptive part and requirements for the analysis results that you upload; if you are on kaggle for the first time, then pages with FAQ and Tutorials will be more useful.  It should be noted that the last two tabs on tasks for advanced users may well (and most likely will be) absent. <br><br>  <b>FAQ:</b> for this competition will tell us the following key things. <br><br><ol><li>  What is the public rating table, which is obtained on the basis of the test sample assessment you have uploaded and is only the tip of the iceberg <i>* ba-dum-tss *</i> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/b08/7a9/9ae/b087a99ae94d46279b43093f33c3232a.png"></div><br></li><li>  The second part of the ratings is hidden from the user and will manifest itself only after summing up.  And as I understand it, the hidden 50% are key to determining the winner and it looks like a similar approach, but with a different percentage ratio is typical for many other competitions. </li><li>  In this academic competition, the rating is cleaned every two months, which means that all your downloads older than two months will lose their status (as I understand it), so the task about Titanic is not ‚Äúfor resume‚Äù, but for developing skills. </li><li>  Kaggle will let us know that, if you wish, you don‚Äôt have to put kaggle in the cloud for analysis tools on your working machine. </li></ol><br>  <b>Tutorials:</b> For a beginner, a vital tab, if you have come "from the street" and do not understand anything, then you (and me) are just there.  Training materials can be divided into 3 types: <br><br><ol><li>  Well-documented notepads (of other users), in which the options for a ready-made solution are described in steps and the logic that guided the author of the study is described. </li><li>  Links to interactive tutorials from DataCamp </li><li>  Just an article. </li></ol><br>  Notepads and interactive tutorials are presented for R and Python languages.  And in the text articles they even add instructions on how to process data <a href="https://www.kaggle.com/c/titanic/discussion/28323">using Excel</a> . <br><br>  There are other useful pages, for example, <b>‚ÄúData‚Äù</b> .  On this page you can download training and test sample files, as well as see an example of how the file should be uploaded to the portal for evaluation.  Among other things, on this contribution there is a description of the data, decoding abbreviations and explanations, so I advise you to look. <br><br>  It should be noted that when creating a notebook (tab "Kernels"), you can one-click download a set of data from an already existing competition. <br><br>  Other tabs suggest you explore on your own. <br><br>  <b>How did I start?</b> <br><br>  At the beginning of the article I referred to the SS courses (which were more focused on R) and the self-help manual (Python-oriented), because I liked the book more, I chose Python. <br><br>  There were many notebooks in Python, some were simpler, some on the contrary contained a lot of detailed material, I realized that I was not ready ‚Äúright off the bat‚Äù right away and started from an interactive tutorial. <br><br><h2>  Part 3. ‚ÄúGood for someone who knows ...‚Äù - An interactive tutorial for solving a problem in Python </h2><br><br>  Good for someone who knows, but for me it is bad, so there was no way without a tutorial.  So the link led me to this course: " <a href="https://www.datacamp.com/community/open-courses/kaggle-python-tutorial-on-machine-learning">Kaggle Python Tutorial on Machine Learning</a> ".  The course is free (although there is an annoying nuance). <br><br>  What is the course?  If someone came across a codecademy, then everything will be familiar to you.  Left description and purpose, on the right is the task code and the Python console.  There are almost no difficulties, the tasks are simple, you can send the code as many times as you like until you can, and if you‚Äôve got enough, you can take a hint or get a ready answer (unless, of course, you are not a terrible RPG fan and you don‚Äôt feel like experience points) <br><br>  The course consists of three chapters: <br><br><ol><li>  The most basic basics of syntax and principles of analysis; </li><li>  Getting a rough model based on a decision tree (Decision Trees).  In principle, after this chapter you will have a ready-made solution that you can download and upload to kaggle; </li><li>  In chapter three, you will use Random Forest to improve your predictions.  This model can also be poured onto the kaggle; </li></ol><br>  Tutorial is simple and takes about an hour, well, a maximum of two. <br><br>  I noticed that when completing the course after completing each chapter, I had a pop up window asking me to get a paid account and only then continue the course (I didn‚Äôt notice the close button, maybe it does), if it interferes with you, you can delete it using the tool ‚ÄúViewing the element code‚Äù (available in almost any modern browser), you need to delete the Div with a class that will contain the word ‚Äúmodal‚Äù, for example, ‚Äúmodal-container‚Äù, after the window disappears, you can safely send the results and go to the next chapter. <br><br>  I can‚Äôt say that the course is very informative, but the most minimal (just tiny) ideas about libraries for analyzing data in Python are given when I experimented with my notebook (below), I borrowed many techniques from them. <br><br><h2>  Part 4. "... How dangerous in the ocean" - a man with a "notepad" in Python </h2><br>  Having completed the online course, I decided that I would not respect myself if I would send those data sets that he offers, without even trying to dig in notebooks. <br><br>  By the way, the platform allows you to "fork" your favorite notebook and experiment with it, or simply download the code for yourself in order to pick it up on your computer. <br><br>  As I said, there are a lot of notebooks, I decided to choose the one that looked simpler to learn (translate, I didn‚Äôt want a big piece of text in English at two in the morning a little less than at all).  So, I decided to borrow the code from " <a href="https://www.kaggle.com/jeffd23/scikit-learn-ml-from-start-to-finish">Machine Learning from Start to Finish with Scikit-Learn</a> ", the author does not promise high prediction accuracy, but the main thing is not victory, but participation. <br><br>  Honestly, I‚Äôll use at least one solution in its original form, my hand didn‚Äôt rise, and I tried to dig at least a little code and try to write a couple of lines with my own hands, so I had a terrible monster from the code of the interactive tutorial and this notebook <br><br>  So, I decided to edit the code on my computer (well, not just the way I put Anaconda in the last article).  I will not spread my code entirely, it‚Äôs very shameful if someone wants to put Jupyter in his notebook, then each section of code is inserted into my own cell <i>(but it‚Äôs better not, it will issue warnings) Something is a bad role model).</i> <br><br>  First of all, I stole a fragment of the data announcement <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tree %matplotlib inline data_train = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'data/train.csv'</span></span>) data_test = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'data/test.csv'</span></span>) data_train.sample(<span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br>  Then he borrowed the code for building a pair of diagrams, which the author had turned out to be quite visual.  One showed the link between the survival rates of men and women from different points of departure: <br><br><pre> <code class="python hljs">sns.barplot(x=<span class="hljs-string"><span class="hljs-string">"Embarked"</span></span>, y=<span class="hljs-string"><span class="hljs-string">"Survived"</span></span>, hue=<span class="hljs-string"><span class="hljs-string">"Sex"</span></span>, data=data_train);</code> </pre><br>  the second graph showed the same connection, but already relative, to the classes in which the passengers lived. <br><br><pre> <code class="python hljs">sns.pointplot(x=<span class="hljs-string"><span class="hljs-string">"Pclass"</span></span>, y=<span class="hljs-string"><span class="hljs-string">"Survived"</span></span>, hue=<span class="hljs-string"><span class="hljs-string">"Sex"</span></span>, data=data_train, palette={<span class="hljs-string"><span class="hljs-string">"male"</span></span>: <span class="hljs-string"><span class="hljs-string">"blue"</span></span>, <span class="hljs-string"><span class="hljs-string">"female"</span></span>: <span class="hljs-string"><span class="hljs-string">"red"</span></span>}, markers=[<span class="hljs-string"><span class="hljs-string">"*"</span></span>, <span class="hljs-string"><span class="hljs-string">"o"</span></span>], linestyles=[<span class="hljs-string"><span class="hljs-string">"-"</span></span>, <span class="hljs-string"><span class="hljs-string">"--"</span></span>]);</code> </pre><br>  Graphics are <a href="https://www.kaggle.com/jeffd23/scikit-learn-ml-from-start-to-finish">in the original notepad</a> , so I will not upload pictures. <br><br>  Then I decided that I was no worse and also tried to invent my own diagram. <br><br>  I decided to check whether the status of the attendant and the class of stay somehow influence the probability of survival of a child under 18 years of age. <br><br>  Since this sampling for pampering and in the calculations is not involved, I made a copy of the data and converted the data into the format I needed. <br><br><pre> <code class="python hljs">data_train2=data_train.copy() data_train2=data_train2[data_train2[<span class="hljs-string"><span class="hljs-string">"Age"</span></span>] &lt;= <span class="hljs-number"><span class="hljs-number">18</span></span>] data_train2.Parch = data_train2.Parch.fillna(<span class="hljs-string"><span class="hljs-string">"nanny"</span></span>) data_train2[<span class="hljs-string"><span class="hljs-string">"Parch"</span></span>][data_train2[<span class="hljs-string"><span class="hljs-string">"Parch"</span></span>] != <span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-string"><span class="hljs-string">'parrents'</span></span> data_train2[<span class="hljs-string"><span class="hljs-string">"Parch"</span></span>][data_train2[<span class="hljs-string"><span class="hljs-string">"Parch"</span></span>] != <span class="hljs-string"><span class="hljs-string">'parrents'</span></span>] = <span class="hljs-string"><span class="hljs-string">'nanny'</span></span></code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/web/300/94f/bd8/30094fbd804f40c9a18b90eae9f82b95.png"></div><br>  The result was something.  This diagram either tells us that children in the 2nd passenger class who had a parent instead of a nanny survived much more often, or doesn‚Äôt say anything except that I made a mistake because in five days it‚Äôs not realistic to master data analysis = ) <br><br>  Let's go to the settlement part.  Looking ahead, I will say that I uploaded my decision on kaggle 2 times to check the changes. <br><br>  So, I realized that the code version from the interactive tutorial is not very convenient and in order not to produce a bunch of identical code, I decided to borrow from the author of the notebook, the option with writing functions: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simplify_Age</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(df)</span></span></span><span class="hljs-function">:</span></span> df.Age = data_train.Age.fillna(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simplify_Sex</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(df)</span></span></span><span class="hljs-function">:</span></span> df[<span class="hljs-string"><span class="hljs-string">"Sex"</span></span>][df[<span class="hljs-string"><span class="hljs-string">"Sex"</span></span>] == <span class="hljs-string"><span class="hljs-string">'male'</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span> df[<span class="hljs-string"><span class="hljs-string">"Sex"</span></span>][df[<span class="hljs-string"><span class="hljs-string">"Sex"</span></span>] == <span class="hljs-string"><span class="hljs-string">'female'</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simplify_Embarked</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(df)</span></span></span><span class="hljs-function">:</span></span> df.Embarked = df.Embarked.fillna(<span class="hljs-number"><span class="hljs-number">0</span></span>) df[<span class="hljs-string"><span class="hljs-string">"Embarked"</span></span>][df[<span class="hljs-string"><span class="hljs-string">"Embarked"</span></span>] == <span class="hljs-string"><span class="hljs-string">"S"</span></span>] = <span class="hljs-number"><span class="hljs-number">1</span></span> df[<span class="hljs-string"><span class="hljs-string">"Embarked"</span></span>][df[<span class="hljs-string"><span class="hljs-string">"Embarked"</span></span>] == <span class="hljs-string"><span class="hljs-string">"C"</span></span>] = <span class="hljs-number"><span class="hljs-number">2</span></span> df[<span class="hljs-string"><span class="hljs-string">"Embarked"</span></span>][df[<span class="hljs-string"><span class="hljs-string">"Embarked"</span></span>] == <span class="hljs-string"><span class="hljs-string">"Q"</span></span>] = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simplify_Fares</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(df)</span></span></span><span class="hljs-function">:</span></span> df.Fare = df.Fare.fillna(<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br>  Functions convert the data to digital format so that they can be ‚Äúfed to the tree‚Äù later. <br><br>  Then I applied these functions for the model being taught (data_train) and for the test model (data_test). <br><br><pre> <code class="python hljs">simplify_Age(data_train) simplify_Sex(data_train) simplify_Embarked(data_train) simplify_Fares(data_train) simplify_Age(data_test) simplify_Sex(data_test) simplify_Embarked(data_test) simplify_Fares(data_test)</code> </pre><br>  assigned target to tree <br><br><pre> <code class="python hljs">target = data_train[<span class="hljs-string"><span class="hljs-string">"Survived"</span></span>].values</code> </pre><br>  further action divided <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># 2.        ,    (    ) data_train["Family"]=data_train["Parch"]+data_train["SibSp"] data_test["Family"]=data_test["Parch"]+data_test["SibSp"]</span></span></code> </pre><br>  Option for the first model.  I am not fully aware of what is happening here, apparently you can understand which tree he created and which parameters contribute more to the forecast. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  features    . features = data_train[["Pclass", "Sex", "Age", "Fare"]].values d_tree = tree.DecisionTreeClassifier() d_tree = d_tree.fit(features, target) print(d_tree.feature_importances_) print(d_tree.score(features, target))</span></span></code> </pre><br>  Now we will create a prediction for the test data set for the first model and save it in csv: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    test_features = data_test[["Pclass", "Sex", "Age", "Fare"]].values prediction = d_tree.predict(test_features) submission = pd.DataFrame({ "PassengerId": data_test["PassengerId"], "Survived": prediction }) print(submission) submission.to_csv(path_or_buf='data/prediction.csv', sep=',', index=False)</span></span></code> </pre><br>  Pick up from the .csv folder, go back to kaggle, click ‚ÄúSubmit Predictions‚Äù and get <b>0.689</b> confidence.  I can not say that it is good, but it‚Äôs the <b>FIRST PREDICTION!</b>  After this, you can go to work in popular TV shows about psychics. <br><br>  For the reasons I‚Äôll talk about in the final part, I didn‚Äôt worry much about the quality of the model and didn‚Äôt use techniques to improve it from the online Data Camp course (and they are there). <br><br>  However, to make the article clearer, let's look at one small improvement. <br><br>  Above, I suggested a code with a comment: ‚Äú# B2.  the cell for the second model comes before the code that comes after (the first model did not apply) ‚Äùtwo lines of code after the comment can be inserted immediately (there will be no harm, but there will be no benefit either). <br><br>  Why do we need these lines?  I decided to test how the presence of a family (sisters, brothers, parents, etc.) will affect survival (the idea is largely taken from an interactive tutorial).  So by combining the fields "satellites" and "relatives" (my free translation), I received the field "family" <br><br>  Replace the features = data_train [["Pclass", "Sex", "Age", "Fare"]]. Values ‚Äã‚Äãand test_features = data_test [["Pclass", "Sex", "Age", "Fare", "Family" "]]. Values ‚Äã‚Äãat: <br><br><pre> <code class="python hljs">features = data_train[[<span class="hljs-string"><span class="hljs-string">"Pclass"</span></span>, <span class="hljs-string"><span class="hljs-string">"Sex"</span></span>, <span class="hljs-string"><span class="hljs-string">"Age"</span></span>, <span class="hljs-string"><span class="hljs-string">"Fare"</span></span>,<span class="hljs-string"><span class="hljs-string">"Family"</span></span>]].values test_features = data_test[[<span class="hljs-string"><span class="hljs-string">"Pclass"</span></span>, <span class="hljs-string"><span class="hljs-string">"Sex"</span></span>, <span class="hljs-string"><span class="hljs-string">"Age"</span></span>, <span class="hljs-string"><span class="hljs-string">"Fare"</span></span>,<span class="hljs-string"><span class="hljs-string">"Family"</span></span>]].values</code> </pre><br>  They added our family influence parameter, but otherwise everything will remain unchanged. <br><br>  As I understand it, the print (d_tree.feature_importances_) command shows us the degree of contribution of each of the parameters to the final result of the model. <br><br>  We get the following: <br><br>  1. [0.08882627 0.30933519 0.23498429 0.29841084 0.06844342]. <br>  2. 0.982042648709 - It seems that this is the accuracy of the fit model <br><br>  In line 1, the positions in the array correspond to ‚ÄúPclass‚Äù, ‚ÄúSex‚Äù, ‚ÄúAge‚Äù, ‚ÄúFare‚Äù, ‚ÄúFamily‚Äù.  So, we see that our point about the family does not make much weather, but for curiosity we still fill in the updated result on kaggle. <br><br>  And we find that our model, just a little, has increased the prediction accuracy, now it is <b>0.72727</b> .  and this result is already in the region of 6800 place in the rating =) <br><br>  You may have a question, how could the prediction accuracy in line 2 be as much as 0.98 or more? Why did you end up with 0.72 on the test sample?  Apparently, the reason lies in the fact that the model is ‚Äúretrained‚Äù, that is, too much sharpened, on predicting a sample from the data_train data set and when testing the data_test set does not show adequate flexibility.  This problem should be solved by setting the parameters of our "tree", this is stated in the interactive course mentioned earlier, I did not do this in the framework of this article.  We are simple people, 0.72 is enough for us, so let's move on to the final part. <br><br><h2>  Part 5. ‚ÄúIceberg oncoming ships‚Äù - Conclusion </h2><br>  I never would have thought, but looking for dependencies in the data and trying to make predictions, it turns out to be a fascinating and quite exciting gamble!  Despite the fact that it is difficult to start from scratch, and as I understand it, the almost complete lack of skills in the field of mate.  analysis, statistics and the application of the theory of probability, more than once backfire on me, in general, at the initial stage, the process delays. <br><br>  As you can see from the example of three articles, I showed that from absolute zero, you can be completely interested in the subject, and if you are a Python fan, you can completely skip the Cognitive Class version without much damage to understanding general concepts (although it‚Äôs free and you can basically two to spend on it, see the tools). <br><br>  Nevertheless, in the process of preparing materials for these three articles, I realized that in order not to be painfully painful, it is necessary to move to a higher level of education. <br><br>  Therefore, I think it makes sense to register for the course <a href="https://www.coursera.org/specializations/machine-learning-data-analysis">‚ÄúSpecialization Machine Learning and Data Analysis posted on Coursera‚Äù</a> , at least it is in Russian, so you don‚Äôt have to puzzle over the translation of incomprehensible terms. <br><br>  This is how casual curiosity threatens to grow into something more serious, in a couple of months, when I finish the course I will share with the respected readers my impression of it. <br><br>  All good!  Successfully strain your brains! </div><p>Source: <a href="https://habr.com/ru/post/331992/">https://habr.com/ru/post/331992/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331978/index.html">Day after the Petya virus</a></li>
<li><a href="../331982/index.html">We use Laravel IoC container at full capacity</a></li>
<li><a href="../331986/index.html">Football as an exact science: how ITMO University helps the organizers of the Confederations Cup and the 2018 World Cup</a></li>
<li><a href="../331988/index.html">Graphics for indie games. What to do if the roundels and sticks do not suit you</a></li>
<li><a href="../331990/index.html">Tale about NePetu, or rather not about Petya</a></li>
<li><a href="../331994/index.html">Ruining people not beer</a></li>
<li><a href="../331996/index.html">Rasking through the parts of a particularly hardy iron bullion S line, where 768 GB of RAM</a></li>
<li><a href="../331998/index.html">Using Python and Excel to process and analyze data. Part 2: libraries for working with data</a></li>
<li><a href="../332000/index.html">Autoencoders in Keras, Part 5: GAN (Generative Adversarial Networks) and tensorflow</a></li>
<li><a href="../332004/index.html">Savings on matches or data recovery from the grating HDD Seagate ST3000NC002-1DY166</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>