<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We broadcast a video stream from a web page via WebRTC to Facebook and YouTube at the same time</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Facebook and YouTube provide broadcast services that allow broadcasting of live video streams to a wide audience of viewers. In this article we will d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We broadcast a video stream from a web page via WebRTC to Facebook and YouTube at the same time</h1><div class="post__text post__text-html js-mediator-article">  Facebook and YouTube provide broadcast services that allow broadcasting of live video streams to a wide audience of viewers.  In this article we will describe how to capture a video stream from a web page using WebRTC technology and send this video stream to Facebook and YouTube simultaneously for a live broadcast ‚Äî to two services at once. <a name="habracut"></a><br><br>  Before you start streaming, find out which RTMP endpoints Facebook and Youtube provide for streaming.  Next, we will need to send video streams to these RTMP addresses. <br><br><h2>  Facebook </h2><br>  Let's start with Facebook.  The first step is to find the <b>Start Live</b> button.  This button might look like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/files/c81/a0b/3c6/c81a0b3c60284d92b6564a30c66736b3.jpg"></div><br>  Or like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c0d/386/05f/c0d38605f63742c9a868ab850d0b4187.jpg"></div><br>  Next, you need to press the button <b>In the air</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dd7/68f/0d4/dd768f0d45b54614aef443ebcfc11096.jpg"></div><br>  And click on the link <b>Click here</b> to broadcast from external devices, and not from Facebook itself. <br><br>  Next, click <b>Create Stream</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/134/4d0/f2d/1344d0f2db1b4ab68555c72df3ce50f5.jpg"></div><br>  As a result, Facebook provides RTMP stream data: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fa6/698/be5/fa6698be5f6b49b594de1539cec241a5.jpg"></div><br>  From the screenshot it can be seen that the server address is: <b>rtmp: //rtmp-api.facebook.com: 80 / rtmp /</b> <br><br>  And the name of an RTMP stream is a long, unique string: <br>  <b>1489000000111961? Ds = 1 &amp; s_l = 1 &amp; a = ATj9giGjaTTfgpNHBP</b> <br><br>  We need these two parameters for the broadcast.  Let's put them aside and find out the RTMP parameters for YouTube. <br><br><h2>  YouTube </h2><br>  To start streaming from YouTube, go to <a href="https://youtube.com/live">https://youtube.com/live</a> and click on the <b>Upload</b> button. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/de6/864/ac3/de6864ac300c43e1bde2aaff601b395b.jpg"></div><br>  Next, select Live Streaming and click <b>Get Started</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8a7/e14/681/8a7e14681e584f9fb0afe9d1f7c30529.jpg"></div><br>  The streaming panel, player and RTMP settings should appear: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/815/21b/00a/81521b00a6604376a89b49ae64b56ceb.jpg"></div><br>  From the settings, we see that the RTMP server address is <b>rtmp: //a.rtmp.youtube.com/live2</b> , and the stream name is hidden and becomes visible by clicking on the <b>Reveal</b> button. <br>  The name of the RTMP stream for YouTube looks like this: <b>8r0t-z4d-9xyj-2bcd</b> <br><br>  As a result, we know exactly where to send RTMP streams: <br><table><tbody><tr><td></td><td>  <b>Facebook</b> </td><td>  <b>YouTube</b> </td></tr><tr><td>  RTMP address </td><td>  rtmp: //rtmp-api.facebook.com: 80 / rtmp / </td><td>  rtmp: //a.rtmp.youtube.com/live2 </td></tr><tr><td>  Stream name </td><td>  1489000000111961? Ds = 1 &amp; s_l = 1 &amp; a = ATj9giGjaTTfgpNHBP </td><td>  8r0t-z4d-9xyj-2bcd </td></tr></tbody></table><br><h2>  Web call server </h2><br>  The server will be responsible for receiving the video stream from the webcam via WebRTC and delivering it to Facebook and YouTube via RTMP. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/351/d9a/4dc/351d9a4dc4864a5781e6854991723dbf.jpg"></div><br>  <b>Do it once</b> <br><br>  First, we send to the server a video stream from a webcam from the Google Chrome browser. <br><br>  For this purpose, you can download an example of an HTML page and a streaming script <a href="">here</a> and deploy three files from this archive on your web server: <br><br><ul><li>  streamer.html </li><li>  streamer.js </li><li>  flashphoner.js </li></ul><br>  <b>flashphoner.js</b> is an API file.  Its latest version can be downloaded in the <a href="https://flashphoner.com/wcs-web-sdk">Web SDK</a> build. <br><br>  The code for the standard demo example for streaming is available <a href="https://github.com/flashphoner/flashphoner_client/tree/wcs_api-2.0/examples/demo/streaming/two_way_streaming">here</a> .  Suppose we opened the demo.  Connect to the server and send a video stream with the name <b>5dfd to the</b> WebRTC server.  It works like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fc0/20c/f1c/fc020cf1c4ef4f7d9f12c10b68f14441.png"></div><br>  The video is captured from the browser camera (in this case from the virtual one), and goes to the WCS5 server using the WebRTC technology, in VP8 + Opus or H.264 + Opus codecs, depending on the device and browser version. <br><br>  The next step is to redirect this video to Facebook. <br><br>  <b>Make two</b> <br><br>  Web Call Server has a REST API, which allows, knowing the name of the stream, redirect the WebRTC video stream to RTMP. <br><br>  To do this, send a request to the REST / HTTP server as follows: <br><table><tbody><tr><td>  URL </td><td><pre><code class="hljs objectivec">https:<span class="hljs-comment"><span class="hljs-comment">//wcs5-eu.flashphoner.com:8888/rest-api/push/startup</span></span></code> </pre> </td></tr><tr><td>  Content-Type </td><td>  application / json </td></tr><tr><td>  Method </td><td>  POST </td></tr><tr><td>  Body </td><td><pre> <code class="hljs css">{ <span class="hljs-attribute"><span class="hljs-attribute">streamName</span></span>: <span class="hljs-string"><span class="hljs-string">"5dfd"</span></span>, rtmpUrl: <span class="hljs-string"><span class="hljs-string">"rtmp://rtmp-api.facebook.com:80/rtmp/1489000000111961?ds=1&amp;s_l=1&amp;a=ATj9giGjaTTfgpNHBP"</span></span> }</code> </pre> </td></tr></tbody></table><br>  Such a request can be tested from the <a href="https://chrome.google.com/webstore/detail/advanced-rest-client/hgmloofddffdnphfgcellkdfbfbjeloo">Advanced REST Console</a> , which looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c82/600/8c3/c826008c386d4e91ab42fc24c5e041cb.png"></div><br>  As a result, WCS redirects the WebRTC video stream to Facebook at a long address: <br><br>  <b>rtmp: //rtmp-api.facebook.com: 80 / rtmp / 1489000000111961? ds = 1 &amp; s_l = 1 &amp; a = ATj9giGjaTTfgpNHBP</b> <br><br>  This address combines the RTMP URL and the name of the video stream. <br><br>  After a few seconds, a video will appear on Facebook: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3fb/1a2/e04/3fb1a2e040264269a4c2051a9afdd2a7.jpg"></div><br>  <b>Do three</b> <br><br>  We send a similar request for YouTube <br><table><tbody><tr><td>  URL </td><td><pre> <code class="hljs objectivec">https:<span class="hljs-comment"><span class="hljs-comment">//wcs5-eu.flashphoner.com:8888/rest-api/push/startup</span></span></code> </pre> </td></tr><tr><td>  Content-Type </td><td>  application / json </td></tr><tr><td>  Method </td><td>  POST </td></tr><tr><td>  Body </td><td><pre> <code class="hljs css">{ <span class="hljs-attribute"><span class="hljs-attribute">streamName</span></span>: <span class="hljs-string"><span class="hljs-string">"5dfd"</span></span>, rtmpUrl: <span class="hljs-string"><span class="hljs-string">"rtmp://a.rtmp.youtube.com/live2/8r0t-z4d-9xyj-2bcd"</span></span> }</code> </pre> </td></tr></tbody></table><br>  Or from the REST console: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f2a/026/19d/f2a02619d6fb4c74a434e27aed47dac6.png"></div><br>  The server will return 200 OK and take the stream to YouTube: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/789/b82/683/789b826834e6447eaabc1abdbc065ed7.jpg"></div><br>  As a result, we see that the stream is broadcast and distributed to both services: on Facebook and YouTube. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/2eb/b17/cfc/2ebb17cfc35347ab9e96214e6404e426.jpg"></div><br>  Now you can request a list of all broadcast streams from the same REST API: <br><table><tbody><tr><td>  URL </td><td><pre> <code class="hljs objectivec">https:<span class="hljs-comment"><span class="hljs-comment">//wcs5-eu.flashphoner.com:8888/rest-api/push/find_all</span></span></code> </pre> </td></tr><tr><td>  Content-Type </td><td>  application / json </td></tr><tr><td>  Method </td><td>  POST </td></tr><tr><td>  Body </td><td><pre> <code class="hljs json">{}</code> </pre> </td></tr></tbody></table><br>  The server will return a list of streams that are currently being relayed to Facebook and YouTube: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/948/68d/a09/94868da093b4485bb82b8bf4837b43af.jpg"></div><br>  Stop relaying with two calls <b>/ push / terminate</b> <br><br>  Disconnect from Facebook: <br><table><tbody><tr><td>  URL </td><td><pre> <code class="hljs objectivec">https:<span class="hljs-comment"><span class="hljs-comment">//wcs5-eu.flashphoner.com:8888/rest-api/push/terminate</span></span></code> </pre> </td></tr><tr><td>  Content-Type </td><td>  application / json </td></tr><tr><td>  Method </td><td>  POST </td></tr><tr><td width="114">  Body </td><td width="510"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"mediaSessionId"</span></span>: <span class="hljs-string"><span class="hljs-string">"8omef99f40674tcfi4pm87npbb"</span></span> }</code> </pre> </td></tr></tbody></table><br>  Disconnect from YouTube: <br><table><tbody><tr><td>  URL </td><td><pre> <code class="hljs objectivec">https:<span class="hljs-comment"><span class="hljs-comment">//wcs5-eu.flashphoner.com:8888/rest-api/push/terminate</span></span></code> </pre> </td></tr><tr><td>  Content-Type </td><td>  application / json </td></tr><tr><td>  Method </td><td>  POST </td></tr><tr><td>  Body </td><td><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"mediaSessionId"</span></span>: <span class="hljs-string"><span class="hljs-string">"e13p1gc10bgsk3me49cest9gv2"</span></span> }</code> </pre> </td></tr></tbody></table><br>  Thus, we organized a broadcast from a web page using WebRTC technology to a Web Call Server 5 server, then with one REST request <b>/ push / startup we</b> re-broadcast the video stream to Facebook, and with the second request <b>/ push / startup we</b> re-broadcast the stream to YouTube Live .  After that, we checked the playback of video streams through standard service players and displayed a list of re-translated streams <b>using the / push / find_all request</b> .  We finished testing, completing current translations with two <b>/ push / terminate</b> requests. <br><br><h2>  We write JavaScript / HTML code </h2><br>  Everyone or almost every developer had to work with the REST API.  Therefore, we will not describe here the code that implements sending REST / HTTP requests. <br><br>  Instead, we‚Äôll tell you how a video stream from a webpage and a webcam comes to the server. <br><br>  As we mentioned above, to create a minimal client, an exciting video, you need three scripts: <br><br><ul><li>  streamer.html </li><li>  streamer.js </li><li>  flashphoner.js </li></ul><br>  <b>flashphoner.js</b> is a file that is located in the <a href="https://flashphoner.com/wcs-web-sdk">Web SDK</a> assembly and there‚Äôs no point in describing it. <br><br>  <b>streamer.html</b> <br><br>  This page contains the <b>localVideo</b> div element in which the capture from the camera will be displayed, and the <b>Start</b> button to start the broadcast. <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"flashphoner.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"streamer.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onLoad</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"init()"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>The streamer<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"localVideo"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width:320px;height:240px;border: 1px solid"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"start"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onClick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"start()"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"status"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <b>streamer.js</b> <br><br>  The translation script works with four main API functions: <br><br><ul><li>  Flashphoner.init ();  // responsible for initializing the API. </li><li>  Flashphoner.createSession ();  // responsible for connecting to the server </li><li>  session.createStream ();  // responsible for creating a video stream </li><li>  session.createStream (). publish ();  // responsible for sending the video stream </li></ul><br>  As a result, a connection is established to the server using the Websocket protocol and video capture from the browser‚Äôs webcam and then sent to the server via WebRTC. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> localVideo; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Flashphoner.init(); localVideo = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"localVideo"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Flashphoner.createSession({<span class="hljs-attr"><span class="hljs-attr">urlServer</span></span>: <span class="hljs-string"><span class="hljs-string">"wss://wcs5-eu.flashphoner.com:8443"</span></span>}).on(Flashphoner.constants.SESSION_STATUS.ESTABLISHED, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">session</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//session connected, start streaming startStreaming(session); }).on(Flashphoner.constants.SESSION_STATUS.DISCONNECTED, function () { setStatus("DISCONNECTED"); }).on(Flashphoner.constants.SESSION_STATUS.FAILED, function () { setStatus("FAILED"); }); } function startStreaming(session) { session.createStream({ name: "stream222", display: localVideo, cacheLocalResources: true, receiveVideo: false, receiveAudio: false }).on(Flashphoner.constants.STREAM_STATUS.PUBLISHING, function (publishStream) { setStatus(Flashphoner.constants.STREAM_STATUS.PUBLISHING); }).on(Flashphoner.constants.STREAM_STATUS.UNPUBLISHED, function () { setStatus(Flashphoner.constants.STREAM_STATUS.UNPUBLISHED); }).on(Flashphoner.constants.STREAM_STATUS.FAILED, function () { setStatus(Flashphoner.constants.STREAM_STATUS.FAILED); }).publish(); } function setStatus(status) { document.getElementById("status").innerHTML = status; }</span></span></code> </pre><br>  Download the archive with <b>streamer.html</b> and <b>streamer.js</b> scripts <a href="">here</a> . <br><br>  In order for the broadcast to work from Google Chrome, you need to put the broadcast scripts on a web hosting service that works on https. <br><br>  Web Call Server can be installed on a separate Linux host.  Download the test server <a href="https://flashphoner.com/download">here</a> .  After the server is installed and running, it will accept incoming web socket connections to the following addresses: ws: // host: 8080 and wss: // host: 8443 <br><br>  Thus, we showed how to capture video from a webcam and deliver the video stream to the server using three scripts.  If everything was done correctly, the script should display the status PUBLISHING.  This means that the WebRTC stream is successfully delivered to the server and can be re-translated to YouTube or Facebook using the REST API. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9fa/9ce/f9b/9fa9cef9b3e94d35b1d966d8ccb1c351.png"></div><br><br><h2>  Links </h2><br>  <a href="https://flashphoner.com/">Web Call Server</a> - WebRTC server with the ability to relay to YouTube and Facebook <br>  <a href="https://flashphoner.com/wcs-web-sdk">Web SDK</a> - JavaScript API for embedding translation code into a web page. <br>  <a href="https://flashphoner.com/docs/wcs5/wcs_docs/html/en/wcs-rest-api/">REST API</a> - WebRTC Video Stream Relay Management <br>  <a href="">Source</a> - the source code of the sample stream from a web page to the server. <br>  <a href="http://youtube.com/live">YouTube Live</a> - a live broadcast service from YouTube <br>  <a href="https://live.fb.com/">Facebook Live</a> - <a href="https://live.fb.com/">Live</a> Broadcast Service from Facebook </div><p>Source: <a href="https://habr.com/ru/post/327986/">https://habr.com/ru/post/327986/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327974/index.html">South Korea: what any developer who wants to localize his mobile game needs to know</a></li>
<li><a href="../327978/index.html">Neuroclot: Part 1. Installing the Raspberry Pi and the cameras in the chicken coop and setting them up</a></li>
<li><a href="../327980/index.html">3 administrative scripts</a></li>
<li><a href="../327982/index.html">Reaction to user feedback in order to increase the average rating</a></li>
<li><a href="../327984/index.html">Mikrotik guarding temperature</a></li>
<li><a href="../327988/index.html">Free from all shackles: Emercoin version 6.2 has become completely decentralized</a></li>
<li><a href="../327990/index.html">Pentestit Security Conference 2017: reports</a></li>
<li><a href="../327994/index.html">We check the code of the dynamic analyzer Valgrind using a static analyzer</a></li>
<li><a href="../327996/index.html">BK-0010 emulator on FPGA</a></li>
<li><a href="../327998/index.html">Conference Outsource-People 2017, Krakow (day two)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>