<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>32-bit Excel and 64-bit SQL Server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Read the Excel table in SQL Server ... In fact, what could be simpler? There are plenty of opportunities for this. There is an Integration Services to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>32-bit Excel and 64-bit SQL Server</h1><div class="post__text post__text-html js-mediator-article"> Read the Excel table in SQL Server ... In fact, what could be simpler?  There are plenty of opportunities for this.  There is an Integration Services tool, which were former DTS, there is an import / export wizard, which is the same behind the scenes, you can quickly build your own ADO.NET application, finally, if you don't feel like shooting sparrows, you can use the linking mechanism servers, known as DTS, from the time of the seven, which allows you to easily and elegantly see theoretically any ODBC / OLE DB-reachable source in the form of a table (a set of tables) or the result of an immediate (ad hoc) query.  It was so until the 64-bit architecture ceased to be something from the hi end area and came to the laptops of developers and users.  A normal user, probably, will hardly be able to set himself a database server, but for a developer, the situation when a 64-bit SQL Server with a 32-bit MS Office is coexisting on one x64-machine is not at all exotic.  In this case, creating a linked server in Excel or Access causes a problem, because the drivers for them are, of course, 32-bit, which SQL Server, being 64-bit, does not understand.  He does not have anything similar in the list of providers known to him, although the office with all the bells and whistles, including connectivity, is on the computer. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a1d/d55/0e9/a1dd550e9cf250702da77ea83a87eea6.png" height="300"><br>  Pic.1 <br><br>  Accordingly, an attempt to use a linked server on Excel, as <a href="http://msdn.microsoft.com/ru-ru/library/ms190479.aspx">described in the documentation</a> , leads to the error Msg 7302, Level 16, State 1, Line 1 <br>  Cannot create an instance of the OLE DB provider for "Microsoft.ACE.OLEDB.12.0" for linked server ... <br>  There is an eternal question "what to do?" <br><a name="habracut"></a><br>  Well, what to do.  Put 64-bit provider, of course.  Right here ( <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D13255">Microsoft Access Database Engine 2010 Redistributable</a> ) they are distributed among two things: AccessDatabaseEngine.exe and AccessDatabaseEngine_x64.exe.  Download the 64-bit one, launch the installation and get the bounce. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/499/812/79b/49981279b251f977748441500885d7e9.png" width="350"><br>  Pic2 <br><br>  That is, if there was no 32-bit Office next to 64-bit SQL Server, then for the sake of Gd, but we have developed high technologies to such a height that it is not clear what to do.  Demolish 32-bit Office and put 64-bit instead, just to get SQL Server into an Excel tablet?  Demolish a 64-bit SQL Server and put in return 32-bit only for the same, too?  I do not think that this is a flexible solution, and this possibility is not always the case.  For example, as <a href="http://social.msdn.microsoft.com/Forums/sqlserver/en-US/6d80822d-34a8-4d12-b9ad-92abf515a973/sql-server-64-bit-connecting-to-ms-access">the man writes</a> , <i><font color="#006400">it‚Äôs a bit different.</font></i>  <i><font color="#006400">It is not a SQL Server 64 bit and 32 bit version, of course.</font></i>  <i><font color="#006400">SQL Server 32 bits, only option for MS Access.</font></i>  <i><font color="#006400">I find this quite horrible.</font></i>  Neponimika begins.  <i><font color="#A52A2A">Since there is no 64-bit Jet, you need to download the 64-bit version of Microsoft Access Database Engine 2010 Redistributable.</font></i>  <i><font color="#006400">Thanks for your answer, but I when I install the AccessDatabaseEngine_X64.exe I get the following error</font></i> (see Figure 1) <i>- <font color="#A52A2A">Please refer to this KB article: <a href="http://support.microsoft.com/kb/2269468">support.microsoft.com/kb/2269468</a></font> - <font color="#006400">The article in the link Office 32 bits products.</font></i>  <i><font color="#006400">It makes it possible for</font> <font color="#A52A2A">you to use the 64-bit version of the Microsoft ACE OLEDB Provider. or 64-bit) from SQL Server.</font></i>  <i><font color="#006400">I‚Äôm trying to install the 64 bits driver</font> <font color="#A52A2A">.</font></i>  <i>- <font color="#006400">You are guiding me in circles.</font></i> <br><br>  Actually, the problem is to get the 64-bit version of the Microsoft ACE OLEDB Provider next to the 32-bit office to be delivered.  Why this cannot be done in the forehead is a philosophical question, and <a href="http://social.msdn.microsoft.com/Forums/en-US/abf34eea-1029-429a-b88e-4671bffcee76/why-cant-32-and-64-bit-access-database-engine-aceoledb-dataproviders-coexist%3Fforum%3Dadodotnetdataproviders">quite a few copies of</a> it are also <a href="http://social.msdn.microsoft.com/Forums/en-US/abf34eea-1029-429a-b88e-4671bffcee76/why-cant-32-and-64-bit-access-database-engine-aceoledb-dataproviders-coexist%3Fforum%3Dadodotnetdataproviders">broken</a> on his subject.  <i><font color="#006400">Compose two different versions of our application;</font></i>  <i><font color="#006400">x86 platform specifically.</font></i>  <i><font color="#006400">If you have a driver, you must be able to find out.</font></i>  <i><font color="#006400">If you‚Äôve been able to compile our app for the default, you‚Äôve been able to ... and why 32 and 64 bit ACE coexist?</font></i>  <i>- <font color="#A52A2A">Microsoft Office 2010 or their dependent components, and Microsoft Office 2010 or their dependent components ...</font></i>  <i><font color="#006400">Q: Why can't the Microsoft Access Database Engine 2010 Redistributable (AccessDatabaseEngine.exe and AccessDatabaseEngine_X64.exe) both be installed on the same machine?</font></i>  <i><font color="#006400">A: Microsoft Office 2010 does not support Microsoft Office 2010. It doesn‚Äôt support, but it doesn‚Äôt support.</font></i>  <i><font color="#006400">Q: Why can't I do this?</font></i>  <i><font color="#006400">A: Because we don't support it.</font></i>  <i><font color="#006400">Q: Why can't you support it?</font></i>  <i><font color="#006400">A: Because we don't support it.</font></i> <br><br>  As a workaround for myself, I used the AccessDatabaseEngine_X64.exe installation with the / passive key, which allows the 64-bit version of the provider to stand side by side with the 32-bit version of Office.  It must be emphasized that this method is not officially supported by Microsoft, there are also warnings about possible incompatibility issues.  <i><a href="http://www.fsdeveloper.com/forum/threads/ms-office-issue-after-installing-64bit-driver.426708/">When I installed the driver AccessDatabaseEngine_x64.exe</a> ...</i>  <i><a href="http://social.msdn.microsoft.com/Forums/en-US/abf34eea-1029-429a-b88e-4671bffcee76/why-cant-32-and-64-bit-access-database-engine-aceoledb-dataproviders-coexist%3Fforum%3Dadodotnetdataproviders">If office 2010 32-bit is installed and if 64-bit is installed</a> , then ** every ** time you can access the 32-bit drivers for office</i> .  In my case (Office 2013 Pro Plus, SQL Server 2012 Developer Ed., Windows 8.1), no visible problems (pah-pah-pah) have yet arisen, but once again I want to note that this is all that is called as is and without -or obligations. <br><br>  <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D13255">I</a> download AccessDatabaseEngine_x64.exe, create a System Restore Point for every fireman (although, in my opinion, when updating office components, it is automatically created anyway), I put it from the command line.  Here are the possible keys: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f0/5ee/a1a/4f05eea1a30d94245ff333dc1978c5ee.png" width="400"><br>  Pic.3 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/344/9d0/03a/3449d003a29ea291f4175c7c1816581a.png" width="400"><br>  Pic.4 <br><br>  Unlike Figure 2, the installation starts. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bfb/3d4/f0c/bfb3d4f0c26e7a40c78fdf9b1e6d863e.png" width="350"><br>  Pic.5 <br><br>  and somewhere in half a minute it is dry, in a businesslike way it ends without any fanfare, OK, hurray, I got up, etc.  Now we will see what it Sukhov.  In Figure 1, from the Providers context menu, we say Refresh and, as they say, we feel the difference. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b8a/0b8/be3/b8a0b8be37c20c40fed843fa3d57f3f3.png" height="300"><br>  Pic.6 <br><br>  It infuses.  Quickly bungled simple xslx: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f7/31c/356/1f731c3561c0188229a6b563fae5f426.png" height="400"><br>  Pic.7 <br><br>  In SQL Server we create a linked server for this Excel: <br><pre><code class="sql hljs">if exists (<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sys.servers <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> <span class="hljs-keyword"><span class="hljs-keyword">name</span></span> = <span class="hljs-string"><span class="hljs-string">'XlsLnkSrv'</span></span>) exec sp_dropserver @<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> = <span class="hljs-string"><span class="hljs-string">'XlsLnkSrv'</span></span>, @droplogins = <span class="hljs-string"><span class="hljs-string">'droplogins'</span></span> exec sp_addlinkedserver @<span class="hljs-keyword"><span class="hljs-keyword">server</span></span> = <span class="hljs-string"><span class="hljs-string">'XlsLnkSrv'</span></span>, @srvproduct = <span class="hljs-string"><span class="hljs-string">'ACE 12.0'</span></span>, @provider = <span class="hljs-string"><span class="hljs-string">'Microsoft.ACE.OLEDB.12.0'</span></span>, @datasrc = <span class="hljs-string"><span class="hljs-string">'C:\Temp\Sample.xlsx'</span></span>, @provstr = <span class="hljs-string"><span class="hljs-string">'Excel 12.0; HDR=Yes'</span></span></code> </pre> <br>  Script 1 <br><br>  and with a sinking read: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> openquery (XlsLnkSrv, <span class="hljs-string"><span class="hljs-string">'Select * from [Sheet1$]'</span></span>)</code> </pre><br>  Script 2 <br><br>  Goal?  No, FIG! <br><br>  Msg 7399, Level 16, State 1, Line 1 <br>  The OLE DB provider for Microsoft.ACE.OLEDB.12.0 for the linked server XlsLnkSrv reported an error.  Did not give any information about the error. <br>  Msg 7303, Level 16, State 1, Line 1 <br>  Cannot initialize the OLE DB provider for the data source "Microsoft.ACE.OLEDB.12.0" for the linked server "XlsLnkSrv". <br><br>  No, (Excel forgot to close) after all a goal! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db0/675/ce4/db0675ce4a3f95546d33098e534f4c86.png" width="600"><br>  Fig.8 <br><br>  Similarly <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> openrowset(<span class="hljs-string"><span class="hljs-string">'Microsoft.ACE.OLEDB.12.0'</span></span>, <span class="hljs-string"><span class="hljs-string">'Excel 12.0;Database=C:\Temp\Sample.xlsx;HDR=Yes'</span></span>, <span class="hljs-string"><span class="hljs-string">'Select * from [Sheet1$]'</span></span>)</code> </pre><br>  but for her (just in case I remind you) you need to do first <br><pre> <code class="sql hljs">exec sp_configure '<span class="hljs-keyword"><span class="hljs-keyword">show</span></span> <span class="hljs-keyword"><span class="hljs-keyword">advanced</span></span> options<span class="hljs-string"><span class="hljs-string">', 1; reconfigure; exec sp_configure '</span></span>Ad Hoc <span class="hljs-keyword"><span class="hljs-keyword">Distributed</span></span> Queries<span class="hljs-string"><span class="hljs-string">', 1; reconfigure</span></span></code> </pre><br>  Script 3 <br><br>  In conclusion, it should be noted that the 64-bit provider did not stand side by side with 32-bit, but replaced it with itself, so now, for example, I will refuse to work with the Integration Services office in the SQL Server Data Tools for BI project (formerly. ).  If you create a connection to the Data Flow DTS package on the same Sample.xslsx, the Microsoft Office 12.0 Access Database Engine OLE DB Provider will fail to initialize, which is logical - since devenv.exe is 32-bit and the provider is now 64-bit.  To return the behavior, you need to restore the 32-bit office provider ( <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D13255">from the same place</a> ), but then bye a linked server.  To earn a linked server - see the beginning of the article.  Something like this.  My modest needs were limited at the moment by access to Excel.  For example, I did not check access database operation.  Provided to readers as an independent exercise.  Judging by the <a href="http://connect.microsoft.com/SQLServer/feedback/details/587897/connecting-via-a-linked-server-to-an-access-2010-database-file">information on the connection</a> there is also a place for achievement. </div><p>Source: <a href="https://habr.com/ru/post/219415/">https://habr.com/ru/post/219415/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../219399/index.html">Google buys Titan AeroSpace, despite the uncertainty about the commercial use of drones</a></li>
<li><a href="../2194/index.html">FeedCycle offers a service for working with cyclical RSS</a></li>
<li><a href="../21940/index.html">Google Reader. Subscription Details</a></li>
<li><a href="../219409/index.html">TsOD: model for assembly</a></li>
<li><a href="../219413/index.html">Development of alternative energy in the private sector. Difficult path to customer</a></li>
<li><a href="../219417/index.html">From the ISS will try to conduct data transmission to Earth using lasers</a></li>
<li><a href="../219419/index.html">Suggestions for learning programming language</a></li>
<li><a href="../219423/index.html">System and business intelligence in anticipation of the most significant event of the sphere!</a></li>
<li><a href="../219425/index.html">Adventure game that is played by changing its Javascript code</a></li>
<li><a href="../219427/index.html">Overview of 6 Budget Wheel Platforms for Ebay Robots</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>