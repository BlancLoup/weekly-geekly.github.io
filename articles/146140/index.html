<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Soft integrals</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Some of you have probably seen this problem in the open spaces of the network: what number is the next row going on? 

 This obvious correct answer wa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Soft integrals</h1><div class="post__text post__text-html js-mediator-article">  Some of you have probably seen this problem in the open spaces of the network: what number is the next row going on? <br><img src="https://habrastorage.org/getpro/habr/post_images/675/90d/99c/67590d99c67c81e65288c03127fa837e.png"><br>  This obvious correct answer was suggested: <br><img src="https://habrastorage.org/getpro/habr/post_images/632/0a8/a1f/6320a8a1f9b2c2763d9d1133bd376475.png"><br>  For those to whom it is not obvious how it was received, an explanation was offered.  Let be <img src="https://habrastorage.org/getpro/habr/post_images/b1d/5b7/f5e/b1d5b7f5e6eccc61ec9a56dcdd15d7a9.png">  (well, 1 for <i>x</i> = 0, although it does not matter).  Then each member of the series is the value of the following integral in the chain: <br><img src="https://habrastorage.org/getpro/habr/post_images/5ed/34b/779/5ed34b779f0bce32556a3c6b5df59314.png"><br>  So far everything is going well, but then suddenly: <br><img src="https://habrastorage.org/getpro/habr/post_images/252/aa3/f48/252aa3f48c7d0fdcee5ee61b0e2c689b.png"><br>  In principle, this is enough to amuse fellow mathematicians, but I wanted to know how such integrals are generally considered and why such a ridiculous result is obtained.  If someone else wants to shake the old days and remember the matan with the function, please read on. <a name="habracut"></a><br><br><h4>  The tale begins to affect </h4><br>  First, let's look at the first integral separately: <br><img src="https://habrastorage.org/getpro/habr/post_images/47e/30a/d3e/47e30ad3ec65d988b54c3a5ba22556ac.png"><br>  Some time ago I thought: ‚ÄúHey, I haven‚Äôt completely forgotten the matan!  Let me take this integral as indefinite, and then I will substitute the limits.  Surely a couple of times in parts, and it's in the bag.  Right now on a piece of paper I will decide everything without help. ‚Äù  I want to warn you: do not repeat my mistakes.  A sleepless night is waiting for you, and then you look in the directory and find out that the indefinite integral is not taken in elementary functions.  For him, even a <a href="http://en.wikipedia.org/wiki/Sine_integral">special function</a> introduced. <br><br>  However, with these specific limits, the integral can be taken in different ways.  We will go the way that requires a minimum of basic knowledge (the most severe - the same integration in parts).  To begin with, we will make a sudden replacement: <br><img src="https://habrastorage.org/getpro/habr/post_images/fb0/4b1/df0/fb04b1df04b3cc73f7c3cbc2e2042273.png"><br>  You ask: where did it all come from and why do we need another integral, which is not enough?  Calmly, so necessary (familiar with the properties of the Laplace transformation fun grin).  Substitute the replacement in the original formula and change the order of integration: <br><img src="https://habrastorage.org/getpro/habr/post_images/17b/323/3a1/17b3233a12cb58bef4069bf5abf20f53.png"><br>  Inside it turned out to be an almost classical integral over <i>dx</i> , with which everyone was frightened in our physics school.  It can also be taken as indefinite, twice using the integration formula in parts.  Then on the right you will get some kind of murkiness and once again the same integral multiplied by something, and as a result you can solve the equation for this integral and get an answer, and then substitute the limits.  Who cares, do it yourself, and I will idly write down the finished result: <br><img src="https://habrastorage.org/getpro/habr/post_images/0e2/2aa/f59/0e22aaf59a9b78134be026b805de22e6.png"><br>  Well, now everything is quite simple: it is a table integral of high school, which is equal to arctangent.  In infinity pi to half, in zero - zero, so we got the answer. <br>  The integral, by the way, is so good that it has its own name - the <a href="http://en.wikipedia.org/wiki/Dirichlet_integral">Dirichlet integral</a> .  Under the link you can find other ways to take it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Soon the tale is affected, and not soon the work is done </h4><br>  For the next trip, we will need four things: a rectangular function, a cosine Fourier transform, a convolution, and the Parseval theorem.  First I will say a few words about these wonderful things. <br><br>  <b>The rectangular function</b> is that we will have such a step around zero: <br><img src="https://habrastorage.org/getpro/habr/post_images/f71/023/415/f71023415d8e6d616fa0cab577ddcb40.png"><br>  The value 1/2 at the points of discontinuity is mainly needed to comply with the properties of the Fourier transform, in general it is not fundamental for our task. <br><br>  <b>Cosine Fourier transform</b> .  For simplicity, we digress a little from mathematical accuracy and formulate coarsely.  For a sufficiently good even function f (x), the following relations hold: <br><img src="https://habrastorage.org/getpro/habr/post_images/933/a4f/0dd/933a4f0ddd60dd0cbd77b86e1c62f830.png"><br>  Function <img src="https://habrastorage.org/getpro/habr/post_images/bc3/5e0/0b3/bc35e00b3bbb360273bfe6ec72a8e368.png">  and is called the cosine Fourier transform (FCT) of f (x) (it is also called the image f).  That is, the cosine transform of the cosine transform gives the original function f (x) again! <br><br>  People familiar with signal processing are well aware that FCT from a rectangular function is <img src="https://habrastorage.org/getpro/habr/post_images/683/9bc/582/6839bc5821ea9c0d7fd8c750d1c307e7.png">  .  It is easy to prove, using the above formulas and school knowledge.  Since the rectangular function outside the interval [-a, a] is zero, you can simply integrate cos (xt) dt over this interval, there is a simple replacement of the variable and a table integral.  The above property says that FCT from <img src="https://habrastorage.org/getpro/habr/post_images/683/9bc/582/6839bc5821ea9c0d7fd8c750d1c307e7.png">  - This is a rectangular function. <br><br>  <b>Convolution</b> is another beautiful thing, without which signal processing can not do.  For two functions f <sub>1</sub> (x) and f <sub>2</sub> (x), you can define a convolution function (indicated by an asterisk) like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/44d/ba1/a40/44dba1a40cafc4ffa9bec724cf287caa.png"><br><br>  The convolution has a wonderful property for which it is loved: the Fourier transform turns it into multiplication, and the multiplication into convolution.  More specifically, the cosine transform of the product of two good even functions is a convolution of their images divided by the root of two pi: <img src="https://habrastorage.org/getpro/habr/post_images/c45/5c0/d74/c455c0d74b70b030a7ada4c3df18197a.png">  . <br><br>  <b>Parseval's theorem</b> is a very cool statement about the equality of signal energy and its spectrum, which is written differently for different purposes.  We need this version: for even and fairly good functions <img src="https://habrastorage.org/getpro/habr/post_images/f51/d4f/e13/f51d4fe133114bf010dfb5f849ff3254.png">  . <br><br><h4>  Dosselev Makar digging kitchen gardens, but now Makar got into the governor </h4><br>  Take the second integral of our wonderful sequence.  As many have already guessed, we will use Parseval's theorem and replace the multipliers with their FCT images: <br><img src="https://habrastorage.org/getpro/habr/post_images/972/036/30b/97203630b3ec4779cff5a4005fa4da05.png"><br>  The first rectangular function under the integral is equal to one for arguments less than one and zero for arguments to more than one.  Therefore, nothing prevents us from removing it from the integral, adjusting the limits of integration: <br><img src="https://habrastorage.org/getpro/habr/post_images/7ed/8da/286/7ed8da2864e55cc90486089289aa2f0d.png"><br>  Under the integral there is a step of height 3 and width 1/3.  Even a third-grader will take such an integral: you just need to multiply 3 and 1/3.  The unit of the integral remains, and we have the pi we need!  Thus, we almost honestly took the second integral from the series.  Whoever wants to do this quite honestly, he will have to figure out what is the goodness of the function and prove that our functions are good. <br><br>  To further it was easier, we denote this step under the integral as <i>F <sub>1</sub> (x)</i> and draw its graph: <br><img src="https://habrastorage.org/getpro/habr/post_images/a7b/290/98d/a7b29098df197f1da0fd7116767d45e0.png" align="left"><br><img src="https://habrastorage.org/getpro/habr/post_images/4d8/8dd/d27/4d88ddd27c09e5f28b6f0f4c11417d4c.png"><br><br>  Let's go have fun further and look at the integral with three factors.  To apply the Parseval theorem, we will now consider all factors from the second as one factor: <img src="https://habrastorage.org/getpro/habr/post_images/9ea/804/3be/9ea8043be1525a7d90f109543f89722a.png">  .  With the image of the first factor, everything is already clear, and the image of the second factor is expressed through convolution: <br><img src="https://habrastorage.org/getpro/habr/post_images/e9f/f70/ba0/e9ff70ba0d270268fa1023cbfb103708.png"><br>  At first glance, scary.  But it is possible to raise something, shorten something and substitute our <i>F <sub>1</sub> (x)</i> .  Then we get: <br><img src="https://habrastorage.org/getpro/habr/post_images/801/ea6/c87/801ea6c876164eb8376f94832b139b65.png"><br>  The internal integral is just a rectangular filter, a kind of ‚Äúblur‚Äù for the function <i>F <sub>1</sub> (x)</i> : we simply average all values ‚Äã‚Äãfor plus and minus one-fifth for each point.  Again, you can get rid of the rectangular function by shuffling the limits of integration.  And with the external integral we will do the same procedure.  Here is the result: <br><img src="https://habrastorage.org/getpro/habr/post_images/52c/077/c52/52c077c52ec8d8e164190a357ac39224.png" align="left"><br><img src="https://habrastorage.org/getpro/habr/post_images/a9f/2ae/a39/a9f2aea39358667f8e303da47019c595.png"><br>  On the left is a graph of the function <i>F <sub>2</sub> (x)</i> , which is actually a smoothed <i>F <sub>1</sub> (x)</i> .  It is easy to prove that after smoothing the function over the normalized kernel its integral does not change.  Well, actually, we are talking about the integral from -‚àû to + ‚àû, but for an even function this is true for the integral from zero.  In this case, the core was a step from -1/5 to +1/5, multiplied by 5/2.  The area under the step is one, which means that the core is normalized.  Here, too, can be compared with the blur in Photoshop: after applying the blur, the picture as a whole does not become lighter or darker.  And if so, then the integral <i>F <sub>2</sub> (x)</i> is exactly equal to the integral <i>F <sub>1</sub> (x)</i> , that is, one, therefore the third integral is equal to pi-half! <br><br>  Further, the procedure is largely similar.  The fourth integral is grouped as follows: <img src="https://habrastorage.org/getpro/habr/post_images/334/79d/1da/33479d1da2645972a1f263a88ca179a9.png">  .  First, Parseval's theorem, for convolution brackets, and we already know how to express the image of the inner bracket in <i>F <sub>2</sub> (x)</i> .  Then everything is the same as last time, and as a result we get: <br><img src="https://habrastorage.org/getpro/habr/post_images/9eb/124/3fc/9eb1243fc70e9366ac5548fb2853d520.png" align="left"><br><img src="https://habrastorage.org/getpro/habr/post_images/d0c/220/441/d0c22044105392603a2f4e2839c41556.png"><br><br>  Now we already have <i>F <sub>3</sub> (x)</i> , which in reality is a smooth <i>F <sub>2</sub> (x)</i> with a kernel 2/7 wide.  The kernel is normalized, so the integral <i>F <sub>3</sub> (x)</i> is equal to the integral <i>F <sub>2</sub> (x)</i> , that is, one, and again we have pi-half! <br><br>  Great, we now click these integrals like nuts.  But in theory, if it goes on like this, will they all be infinitely pi equal in half?  Let's look further.  Fifth integral: <br><img src="https://habrastorage.org/getpro/habr/post_images/185/d17/69c/185d1769c2761f3f3731087e91f94a72.png"><br><br>  It seems all the same.  All right, the sixth integral: <br><img src="https://habrastorage.org/getpro/habr/post_images/260/5cb/858/2605cb8584ef08297d94b700625728a4.png"><br><br>  And there are no problems.  Well, we take the seventh: <br><img src="https://habrastorage.org/getpro/habr/post_images/dfb/738/230/dfb7382307b60da9f7f989d878305cbb.png"><br><br>  Nothing new!  Okay, and the eighth? <br><img src="https://habrastorage.org/getpro/habr/post_images/b6d/3f0/0ab/b6d3f00ab8377164bd7384373f0c8f08.png"><br><br>  Stop stop stop!  Here we can not do without the team CSI! <br><img src="https://habrastorage.org/getpro/habr/post_images/d8b/f1f/d42/d8bf1fd427c1e36c574d10a000687bd8.png"><br><br>  The function has leaked through the unit!  The integral <i>F <sub>7</sub> (x)</i> is still equal to unity, but if we integrate it from 0 to ‚àû.  And we integrate to the unit!  Until now, all functions were zero with x greater than one, but sooner or later it should have ended. <br><br>  And how to understand when the end comes?  It is very simple.  <i>F <sub>1</sub> (x)</i> was non-zero at x &lt;1/3.  <i>F <sub>2</sub> (x)</i> smoothed it over ¬± 1/5, which means it was non-zero at x &lt;1/3 + 1/5.  Similarly, it is possible to find the boundary of nonzero values ‚Äã‚Äãfor all these functions, and for <i>F <sub>7</sub> (x)</i> this boundary for the first time exceeds unity: <br><img src="https://habrastorage.org/getpro/habr/post_images/0a0/195/024/0a01950240263127cd310f9703c4c9cd.png"><br><br>  It is easy to even calculate how much specifically leaked, and thereby calculate the exact value of the eighth integral.  Note that to the left of the boundary, <i>F <sub>1</sub> (x)</i> is a constant 3. <i>F <sub>2</sub> (x)</i> is a minus integral of this constant with a factor of 5/2, that is, a straight line with a factor of 3 √ó 5/2.  <i>F <sub>3</sub> (x)</i> in sufficient proximity to the boundary 1/3 + 1/5 + 1/7 is the integral of that line with a factor of 7/2, that is, something like <img src="https://habrastorage.org/getpro/habr/post_images/395/47c/2ad/39547c2ad82f303e7f6d5ddc589b802b.png">  .  Continuing the similar reasoning, we obtain the formula for <i>F <sub>7</sub> (x)</i> in the vicinity of the boundary: <br><img src="https://habrastorage.org/getpro/habr/post_images/8d2/7bf/fd1/8d27bffd18209ac9ee11931dbace85ec.png"><br>  Actually, the usual parabola of the sixth degree, shifted and multiplied.  If we integrate it from one to the border 1/3 + 1/5 + 1/7 + 1/9 + 1/11 + 1/13 + 1/15, then we will find out how much function has flowed beyond the limits of the unit.  You can solve this problem entirely in ordinary fractions.  It turns out that's how much: <br><img src="https://habrastorage.org/getpro/habr/post_images/638/261/f4a/638261f4a1fa81c6c8d08117608da89b.png"><br><br>  If this number is subtracted from one and multiplied by pi-halves, we get the final value of the eighth integral: <br><img src="https://habrastorage.org/getpro/habr/post_images/252/aa3/f48/252aa3f48c7d0fdcee5ee61b0e2c689b.png"><br><br>  Such integrals are called the <a href="http://en.wikipedia.org/wiki/Borwein_integral">bornwein integrals</a> in honor of David and Jonathan Borwein, who described them.  If you want rigorous mathematical proofs (without any ‚Äúgood functions‚Äù) and other properties of these remarkable integrals, read the <a href="http://www.landsburg.org/borweinintegrals.pdf">article of the authors</a> . <br><br><h4>  Conclusion: eighty-level trolling </h4><br>  Having opened these integrals, Jonathan Borwein introduced them into the <a href="http://ru.wikipedia.org/wiki/Maple">Maple</a> software package and, having made sure that Maple correctly took all eight integrals, informed the developers about the "bug": they say, the eighth integral should also be pi-halved, and you get what.  Three days and three nights, he was killed by <a href="http://www.linkedin.com/pub/jacques-carette/9/128/a53">Jacques Caret</a> , one of the Maple developers, in search of a mistake, until he <a href="http://mathoverflow.net/questions/11517/computer-algebra-errors/11607">realized</a> that he was being cruelly joking.  And they also say that mathematicians are boring people! </div><p>Source: <a href="https://habr.com/ru/post/146140/">https://habr.com/ru/post/146140/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146133/index.html">iRobot has equipped its robots with a remote control</a></li>
<li><a href="../146135/index.html">Gooseberry is an interesting alternative to the Raspberry Pi</a></li>
<li><a href="../146136/index.html">Depth of field in computer graphics</a></li>
<li><a href="../146137/index.html">My bike Entity FrameWork, Auto Migration, With Save Data</a></li>
<li><a href="../146139/index.html">Smart Case: update your smart cover?</a></li>
<li><a href="../146141/index.html">Media queries and the media view-mode is REC now</a></li>
<li><a href="../146142/index.html">PHDays Online HackQuest 2012 Completed</a></li>
<li><a href="../146143/index.html">Apple published material from WWDC 2012</a></li>
<li><a href="../146145/index.html">Sharp's Android Feel UX Shell</a></li>
<li><a href="../146146/index.html">Yandex.Search for Android - ready answers to your questions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>