<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>vPath or how to create a service chain in a virtualization environment</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How to ensure control over the traffic between the components of a virtualized application with minimal time? Is there a technology that allows you to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>vPath or how to create a service chain in a virtualization environment</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/bdc/87d/0e2/bdc87d0e2d8625629115f3e419a67f54.png" align="left">  How to ensure control over the traffic between the components of a virtualized application with minimal time?  Is there a technology that allows you to transfer traffic along a chain through several service components, for example, a firewall, packet filter and traffic balancing system, without making any changes to the network configuration or to the configuration of the applications themselves?  Under the cat, we'll talk about Cisco vPath technology, which allows you to elegantly create service chains in virtualization environments and not depend on the manufacturer of the hypervisor. <br><br><a name="habracut"></a><br><h4>  1. Task statement </h4><br>  <u>Initial data:</u> <br><br><ul><li>  there is an application that consists of several components, for example, WEB, APP, DB; </li><li>  components are virtual machines (VMs) and are located within a cluster of hypervisors; </li><li>  all components are connected to the same network segment and use one default gateway to communicate with the outside world. </li></ul><br>  The component diagram of the connection to the network component of the application looks like in Fig.  one. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/424/87e/8c4/42487e8c4f6b9f2a12ec4893c1ef84cd.png"><br>  <b>Fig.</b>  <b>1 Logical diagram of the organization to connect the application to the network</b> <br><br>  By default, the interaction matrix between application components and the outside world looks like this. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/40d/aaf/80b/40daaf80b0f0ae992e6e0bb82ddbebc6.png"><br>  <b>Fig.</b>  <b>2 Initial interaction matrix between application components</b> <br><br>  The traffic that is transmitted between the components of the application is not controlled in any way - everything is allowed to everyone. <br><br>  <u>Statement of the problem in general:</u> <br><br><ul><li>  without changing the application configuration, provide the ability to control traffic between application components; </li><li>  control implies the possibility of transparent embedding of service elements in the path of transmission of traffic between application components; </li><li>  A service element can be a virtual machine that performs packet filtering, load balancing, deep application-level inspection, traffic compression, network traffic analysis, etc.  etc.; </li><li>  the key part of the task - there may be <b>several</b> service elements, and the complexity of embedding should not depend on their number; </li><li>  it should be possible to build service elements in <b>chains.</b> </li></ul><br>  <u>Example of the real problem number 1 - package filter embedding</u> <br><br>  The ability to control traffic between applications gives a service element called a packet filter, such as the <a href="http://www.cisco.com/c/en/us/products/switches/virtual-security-gateway/index.html">Cisco VSG</a> .  A packet filter is embedded in the data path between the virtual machines.  After embedding the filter, the interaction matrix changes and looks as follows. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/114/971/750/114971750c4912146d7f96eeee24e023.png"><br>  <b>Fig.</b>  <b>3 Transparent package filter embedding</b> <br><br>  <b>Note to Fig.</b>  <b>3</b> : the figure shows the logical operations that the packet filter performs.  In general, one virtual machine can cope with this task.  This note is also relevant for the schemes that are listed below. <br><br>  What packet filter does: <br><br><ul><li>  allows incoming traffic from users from the outside segment only to the WEB component of the application; </li><li>  traffic from the outside segment to the application components APP and DB is prohibited; </li><li>  allowed traffic between pairs of WEB-APP and APP-DB components using known protocols and ports; </li><li>  all other traffic is prohibited. </li></ul><br>  <u>Example of the real problem number 2 - the creation of service chains</u> <br><br>  Based on the experience of real projects, often application owners, network and security administrators want more from their infrastructure than just packet filtering.  Setting a task close to that with which we encounter every day in projects looks something like this. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb8/95f/42f/cb895f42f09813682f9d4b064c45e8bc.png"><br>  <b>Fig.</b>  <b>4 Service chains between application components</b> <br><br>  User traffic destined for the WEB-components of the application passes through the first service chain: <br><br><ul><li>  First, the traffic should go to the load balancer, for example <a href="http://www.cisco.com/c/en/us/products/switches/citrix-netscaler-1000v/index.html">Cisco Netscaler 1000V</a> ; </li><li>  then go through a rough cleaning on the packet filter; </li><li>  then get to the firewall for more fine cleaning, for example <a href="http://www.cisco.com/c/en/us/products/security/virtual-adaptive-security-appliance-firewall/index.html">Cisco ASAv</a> *; </li><li>  and only then the balanced, cleared and inspected traffic should be transferred to the WEB component. </li></ul><br>  * The current version of ASAv 9.2 (1) does not have vPath support.  Its implementation is planned in the near future. <br><br>  On the path of traffic, other service chains may occur with a different set and order of service components.  In our example, the second service chain consists of a packet filter and a firewall. <br><br><h4>  2. The solution of the problem by traditional methods </h4><br>  When creating a service chain with traditional methods, the problem of redirecting traffic from one service component to another is solved by changing the network topology.  Let's see how you can solve the ‚ÄúReal Problem No. 2‚Äù just reviewed.  The only possible data transfer path is created between the service virtual machines and the application, see Fig.  five. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6e9/9da/4b5/6e99da4b502ed3ca6a9c7440e66f0d7f.png"><br>  <b>Fig.</b>  <b>5 Creating a service chain by changing the topology</b> <br><br>  Service components are embedded on the physical traffic path.  Any logical change in the service chain leads to a physical change in the network topology.  As can be seen from Fig.  5. instead of one switch and one VLAN in the original task, we have 2 logical switches (inside / outside) and 9 VLANs.  You can independently calculate how many times the complexity of the topology increases when using the traditional topological method compared to what vPath offers.  In place of a VLAN there may be a VXLAN topological complexity from this does not decrease. <br><br><h4>  3. The main issue of the article </h4><br>  So what can Cisco offer to facilitate the creation of service chains for applications that are virtualized?  How, without increasing the complexity of the infrastructure, to get a flexible tool that does not depend on the hypervisor? <br><br><h4>  4. The main answer of the article </h4><br>  Cisco proposes to use vPath technology, which provides an elegant creation of service chains in a virtualized environment.  vPath is a feature of the Cisco Nexus 1000V Distributed Virtual Switch.  The Cisco Nexus1000V switch is available today for all major hypervisors ‚Äî <a href="http://www.cisco.com/c/en/us/products/switches/nexus-1000v-switch-microsoft-hyper-v/index.html">Hyper-V</a> , <a href="http://www.cisco.com/c/en/us/products/switches/nexus-1000v-kvm/index.html">KVM</a> *, <a href="http://www.cisco.com/c/en/us/products/switches/nexus-1000v-switch-vmware-vsphere/index.html">vSphere</a> .  Let's look at how the vPath architecture is structured, how it is configured, and what encapsulation looks like. <br><br>  * The first Nexus 1000V release for KVM version 5.2 (1) SK1 (2.2) does not have vPath support.  Its implementation is planned for future releases. <br><br><h4>  5. vPath architecture </h4><br>  To use vPath technology, you need: <br><br><ul><li>  Cisco Nexus 1000V Virtual Switch; </li><li>  service virtual machine that supports vPath. </li></ul><br>  Let's turn to the initial logic of the organization of the network connection of the application, which was presented in Fig.  1. Figure 6 shows the changes that need to be made when introducing vPath. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/76c/f91/409/76cf9140972609772e12d0220835fc8a.png"><br>  <b>Fig.</b>  <b>6 Basic architectural components of vPath</b> <br><br>  What has changed? <br><br><ul><li>  the standard switch, which is ‚Äúattached‚Äù to the hypervisor, has been replaced with a Nexus 1000V switch; </li><li>  WEB, APP, DB virtual machines migrated from the standard switch to the Nexus 1000V; </li><li>  We also added vPath support service virtual machines that perform the already familiar filtering, balancing and firewall roles. </li></ul><br>  You can add as many service machines as you need to perform traffic operations, or you can get by with one packet filter, as we have already seen in Example of the real task No. 1. In real scenarios, service functions will probably be combined to reduce costs and topological complexity.  No additional switches and new VLAN / VXLAN appeared.  Topologically, the scheme has not changed. <br><br>  <u>Nexus 1000V Architecture</u> <br><br>  Before we go further and figure out how the vPath works, let's get acquainted with the Nexus 1000V switch device. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ee0/de3/773/ee0de377301a27ca1cdcca872f18c58b.png"><br>  <b>Fig.</b>  <b>7 Nexus 1000V Switch Architecture</b> <br><br>  Nexus 1000V, as can be seen from Fig.  7, has two components: <br><br><ul><li>  VEM module (Virtual Ethernet Module) - software code that is embedded in the hypervisor and provides traffic switching; </li><li>  VSM module (Virtual Service Module) - a component that provides centralized management and configuration of VEM modules. </li></ul><br>  Nexus 1000V in its architecture is very similar to a physical modular switch, where VSM plays the role of a supervisor (control module), and VEM plays the role of a line card. <br><br>  All interface settings that are used to connect a virtual machine to a VEM module are stored in a structure called Port Profile. <br><br>  To demonstrate the capabilities of vPath, we will use the Nexus 1000V, which is deployed in our local lab.  Ports of virtual machines in our laboratory are configured as follows. <br><br><pre><code class="bash hljs">port-profile <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> vethernet V-CONT.WEB switchport mode access switchport access vlan 21 no shutdown state enabled port-profile <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> vethernet V-CONT.APP switchport mode access switchport access vlan 21 no shutdown state enabled port-profile <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> vethernet V-CONT.DB switchport mode access switchport access vlan 21 no shutdown state enabled</code> </pre> <br>  While the configuration of all ports is identical.  But since for each of the ports we want to implement our own service chain, we set up three different profiles. <br><br>  <u>VPath basic idea</u> <br><br>  The basic idea is to create a mechanism that allows you to abstract away from the existing network topology and pass traffic on the necessary service components transparently for both network devices and target virtual machines.  Remember that in all of our source examples, virtual machines are located in the same VLAN? <br><br>  <u>How does vPath do this?</u> <br><br>  The VEM module keeps records of all data streams that are transmitted through it.  This data is collected in the Flow Table.  The stream is identified by 6 entities: source IP address, destination IP address, source port, destination port, protocol, VLAN.  Every time a new stream appears on the network, a new entry appears in the stream table. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6bb/993/4c0/6bb9934c0564da3b5b6296bfcf926578.png"><br>  <b>Fig.</b>  <b>8 Table of streams transmitted via the VEM module</b> <br><br>  The first packet of each newly detected stream is sent to the service device.  Thus, the VEM module ‚Äúasks‚Äù the service device a question: can I transfer it further or not?  When a packet is sent to a service device, an additional header is added to it with vPath encapsulation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/415/bae/728/415bae7285b933415b5c04769c5644f4.png"><br>  <b>Fig.</b>  <b>9 Logic diagram of vPath</b> <br><br>  The service device inspects the package according to the rules and policies that have been configured on it by the security administrator, application or network.  Then the service returns the source packet to the VEM module with the vPath encapsulation, which contains the answer - yes, you can send the packet further, or - no, this packet must be discarded, because it does not satisfy the security policy. <br><br>  The VEM module received the package from the service device: <br><br><ul><li>  records the response in the Action field of the thread table; </li><li>  sends the packet to the destination port without vPath-encapsulation, if the Forward command was in the Action field; </li><li>  pushes the packet further along the chain using the vPath header if the Redirect command was in the Action field; </li><li>  drops the packet if the Drop command was in the Action field. </li></ul><br>  If the nature of the service does not require constant data transfer through the service element, such as in the case of the Cisco VSG packet filter, then all subsequent packets are transmitted bypassing the service element using the response of the service device recorded in the cache. <br><br>  Below is a simplified vPath operation algorithm for the case when you need to organize packet filtering between application components. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/120/e21/897/120e21897fe2714abe19224922b36df1.png"><br>  <b>Fig.</b>  <b>10 Algorithm of vPath for Cisco VSG</b> <br><br><h4>  6. Configure vPath </h4><br>  We now turn to the practical setting of the vPath mechanism on our laboratory bench.  We have implemented the following topology. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/259/de9/854/259de98544ec0461cfe1be7369672745.png"><br>  <b>Fig.</b>  <b>11 Laboratory bench topology</b> <br><br>  First, we register the service nodes to which we will redirect traffic. <br><br><pre> <code class="bash hljs">vservice node ASA-1 <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> asa ip address 10.0.21.1 adjacency l2 vlan 21 fail-mode close vservice node VSG-1 <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> vsg ip address 10.0.21.254 adjacency l2 vlan 21 fail-mode close</code> </pre><br>  Check that the Nexus 1000V "sees" the registered modules and their status - Alive. <br><br><pre> <code class="bash hljs">N1K<span class="hljs-comment"><span class="hljs-comment"># show vservice brief -------------------------------------------------------------------------------- License Information -------------------------------------------------------------------------------- Type In-Use-Lic-Count UnLicensed-Mod asa 2 -------------------------------------------------------------------------------- Node Information -------------------------------------------------------------------------------- ID Name Type IP-Address Mode State Module 1 VSG-1 vsg 10.0.21.254 v-21 Alive 4, 2 ASA-1 asa 10.0.21.1 v-21 Alive 4, &lt;  &gt;</span></span></code> </pre><br>  Create a service chain of 2 previously registered modules. <br><br><pre> <code class="bash hljs">vservice path WEB-CHAIN node VSG-1 profile WEB_SP order 1 node ASA-1 profile TEST-EDGE-SP order 3</code> </pre><br>  Check that the Nexus 1000V "sees" the service chain. <br><br><pre> <code class="bash hljs">N1K<span class="hljs-comment"><span class="hljs-comment"># show vservice brief &lt;  &gt; -------------------------------------------------------------------------------- Path Information -------------------------------------------------------------------------------- Name:WEB-CHAIN NumOfSvc:2 Mod:4, Node Order Profile VSG-1 1 WEB_SP ASA-1 3 TEST-EDGE-SP -------------------------------------------------------------------------------- &lt;  &gt;</span></span></code> </pre><br>  We connect the service chain, which consists of the ASA and VSG to the profile that defines the connection of the WEB virtual machine to the network. <br><br><pre> <code class="bash hljs">port-profile <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> vethernet V-CONT.WEB org root/tenant-01 vservice path WEB-CHAIN</code> </pre><br>  Check that the Nexus 1000V "sees" the configured chain. <br><br><pre> <code class="bash hljs">N1K<span class="hljs-comment"><span class="hljs-comment"># show vservice brief &lt;  &gt; -------------------------------------------------------------------------------- Port Information -------------------------------------------------------------------------------- PortProfile:V-CONT.WEB Org:root/tenant-01 Path:WEB-CHAIN Node Profile(Id) VSG-1(10.0.21.254) WEB_SP(9) ASA-1(10.0.21.1) TEST-EDGE-SP(8) Veth Mod VM-Name vNIC IP-Address 15 4 r1-web-v2 1 10.0.21.10 &lt;  &gt;</span></span></code> </pre><br>  Now we will make so that the traffic which is transferred towards the APP and DB virtual computers, was transferred through the packet filter. <br><br><pre> <code class="bash hljs">port-profile <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> vethernet V-CONT.APP org root/tenant-01 vservice node VSG-1 profile APP_SP port-profile <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> vethernet V-CONT.DB org root/tenant-01 vservice node VSG-1 profile DB_SP</code> </pre><br>  As a result, with the help of several configuration lines, the laboratory implemented the following traffic pattern inside VLAN = 21.  However, we did not create new auxiliary switches or VLANs.  In Fig.  12 shows the service chain, which turned out. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/918/b0a/8b0/918b0a8b0fb2c14ff775a0ab62e22ae4.png"><br>  <b>Fig.</b>  <b>12 Service chain configured in the example.</b> <br><br>  As can be seen from the presented configuration, it is extremely simple compared to the changes that would have to be made if it were necessary to change the network topology to fit into the service elements.  Once again, the original topology has not changed. <br><br><h4>  7. vPath encapsulation </h4><br>  vPath packs source packages into its header as follows. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c10/24b/319/c1024b319e1ece48701757c1c9f36048.png"><br><br>  <b>Fig.</b>  <b>13 vPath encapsulation</b> <br><br>  If the service virtual machine is located in the same segment, then the L2 transport header is added to the source packet.  If the service machine is located in another segment, then a transport L3 header is added.  The body of the original frame does not change.  Between the transport header and the source packet is the vPath header. <br><br>  The vPath header consists of 3 required components: <br><br><ul><li>  basic header; </li><li>  service header; </li><li>  platform header. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/def/15d/77b/def15d77b15c890bc5cc9208a563b4fe.png"><br>  <b>Fig.</b>  <b>14 vPath header</b> <br><br>  Basic title: <br><br><ul><li>  contains the version of the protocol and the identifier of the service chain. </li></ul><br>  It should be noted that the service chain itself is not included in the header.  There is only its unique identifier.  Information about the chain is stored in a special Service Table, which, like the FlowTable, is on each VEM module.  This table is programmed centrally from the VSM module when the owner of the system makes changes to the configuration. <br><br>  Service header: <br><br><ul><li>  implements the approval procedure for the vPath version used; </li><li>  transfers information about profile identifiers on service devices; </li><li>  implements the Request / Response procedure between the VEM module and the service device. </li></ul><br>  Platform Header: <br><br><ul><li>  carries information specific to the platform that implements the vPath; </li><li>  contains the port ID of the source; </li><li>  contains a segment type identifier - VLAN, VXLAN; </li><li>  contains a segment identifier - VLAN number, VXLAN number. </li></ul><br>  Here is the package that the VEM module received from the virtual machine and redirects to the service module.  The latter must decide whether it is possible or not to send this package through the service chain further.  In the service header, we see that the REDIRECT function is running.  The service module is connected to the VEM module via L2. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/389/ec6/4e8/389ec64e8016a6dfad57288de8e010e2.png"><br>  <b>Fig.</b>  <b>15 Package that the VEM sends to the service module</b> <br><br>  The next screen shot is the package that the VEM module received from the service module after the package inspection.  The Service Context Header field contains the RESPONSE identifier, and the ACTION field is set to PERMIT, meaning that this packet can be forwarded. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a28/347/b6c/a28347b6c23b77e3226bdd66f1de342f.png"><br>  <b>Fig.</b>  <b>16 Package that VEM receives from the service module after inspection</b> <br><br><h4>  8. Conclusions </h4><br>  In the article we discussed the problem of creating service chains in the data center.  A large number of virtualized infrastructure owners face this problem when deploying applications.  Solving a problem by changing the network topology to fit service devices leads to more complex network configuration.  We got acquainted with an easy way to solve this problem by deploying the Nexus 1000V switchboard and using vPath technology, which is configured by several simple commands. </div><p>Source: <a href="https://habr.com/ru/post/230143/">https://habr.com/ru/post/230143/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../230129/index.html">Adobe and Google released a family of open fonts for Asian languages.</a></li>
<li><a href="../230133/index.html">Finding the best open source audio speech recognition system</a></li>
<li><a href="../230135/index.html">History of Audio-Technica</a></li>
<li><a href="../230137/index.html">Ordered a rare phone in a foreign online store? Get a subpoena</a></li>
<li><a href="../230141/index.html">BlackBerry has got its own Siri: BlackBerry Assistant</a></li>
<li><a href="../230149/index.html">OpenVPN Access Server Desktop Client is vulnerable</a></li>
<li><a href="../230153/index.html">12 commandments about backup for which I almost paid a finger</a></li>
<li><a href="../230155/index.html">We write a simple system of recommendations on the example of Habr</a></li>
<li><a href="../230157/index.html">Apple and IBM became allies in conquering the corporate market.</a></li>
<li><a href="../230161/index.html">Who needs this HTML: ‚ÄúHow I wrote down a payment service in 2 months - and sent it to a landfill‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>