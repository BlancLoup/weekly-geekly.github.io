<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We study MITER ATT & CK. Mobile Matrices: Device Access. Part 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Persistence and Privilege Escalation 
 Links to all parts: 
 Part 1. Initial access to a mobile device (Initial Access) 
 Part 2. Persistence and Priv...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We study MITER ATT & CK. Mobile Matrices: Device Access. Part 2</h1><div class="post__text post__text-html js-mediator-article"><h2>  Persistence and Privilege Escalation </h2><br>  <b>Links to all parts:</b> <br>  <a href="https://habr.com/ru/post/451602/">Part 1. Initial access to a mobile device (Initial Access)</a> <br>  <a href="https://habr.com/ru/post/454714/">Part 2. Persistence and Privilege Escalation</a> <br>  <a href="https://habr.com/ru/post/454878/">Part 3. Obtaining Credential Access</a> <br><br>  Securing techniques describe ways of obtaining access rights, changing the configuration of a mobile device and other actions, as a result of which an attacker ensures that his presence in the system is constant.  Often, the enemy is forced to maintain access to the mobile device despite the suspension of the operating system as a result of a reboot or reset of the system to factory settings. <br><br>  Having fixed itself in the system, the adversary is able to ‚Äúlog in‚Äù to the mobile device, but probably with very limited rights.  However, taking advantage of the weaknesses of the defense, the enemy may receive the higher privileges necessary to achieve the goal of the attack. <br><a name="habracut"></a><br>  <i>The author is not responsible for the possible consequences of the application of the information contained in the article, and also apologizes for any inaccuracies in some formulations and terms.</i>  <i>The published information is a free retelling of the content of the <a href="https://attack.mitre.org/matrices/mobile/">ATT @ CK Mobile Matrices: Device Access</a> .</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  <a href="https://attack.mitre.org/tactics/TA0028/">Persistence</a> </h3><br><h3>  <a href="https://attack.mitre.org/techniques/T1401">Abuse of administrator rights to prevent their removal (Abuse Device Administrator Access to Prevent Removal)</a> <a href="https://attack.mitre.org/techniques/T1401"><br></a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description: A</i> malicious application may request the user to administer the device and, if it is granted privileges, perform manipulations that make it difficult to remove it. <br><br>  <i>Protection recommendations:</i> <br>  <b>Preliminary Application Verification</b> <br>  As a rule, applications rarely use administrative access.  In the corporate environment, pre-testing of applications should identify such programs for further thorough study.  Maggi and Zanero described the <a href="https://www.blackhat.com/docs/eu-16/materials/eu-16-Maggi-Pocket-Sized-Badness-Why-Ransomware-Comes-As-A-Plot-Twist-In-The-Cat-Mouse-Game.pdf">approach of conducting a static analysis of applications in order to identify ransomware applications</a> that abuse access by the device administrator.  In a nutshell, identifying ransomware applications consists in detecting the following indicators in the apk-file: threatening text, code associated with blocking the device's use (non-cancellable dialogues, prohibiting navigation buttons, filling the screen with a window, etc.), data encryption or Admin API abuse. <br><br>  <b>Caution when using device administrator access</b> <br>  Mobile device users should be warned not to accept requests for granting administrator privileges to applications.  In addition, the application should be checked for administrative rights prior to its installation, and the necessary applications requesting device administrator access should be carefully studied and allowed to be used only if there is a good reason.  Android users can view a list of applications with administrative rights in the device settings. <br><br>  <b>Using fresh OS versions</b> <br>  The latest versions of the OS, as a rule, contain not only fixes, but also have an improved security architecture that provides resistance to previously undetected vulnerabilities.  For example, Android 7 introduces changes that prevent the possibility of abuse of administrator rights. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1402">Autostart application when the device boots (App Auto-Start at Device Boot)</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> The Android application can listen to the broadcast of BOOT_COMPLITED broadcast messages, which guarantees its activation every time the device is started without waiting for the user to launch it manually.  BOOT_COMPLITED is a broadcast event in Android that notifies applications about the end of the OS boot process.  Any application equipped with a special receiver BroadcastRecevier can receive broadcast messages and take any actions based on them.  <a href="https://ieeexplore.ieee.org/document/6234407">An analysis of</a> 1260 malicious Android apps published in 2012 showed that 83.3% of the malware had been listening on BOOT_COMPLITED. <br><br>  <i>Protection recommendations:</i> In a corporate environment, it is possible to organize application testing in order to identify programs that announce a BroadcastReceiver, which contains an intent filter for BOOT_COMPLITED.  However, given the huge increase in the number of applications with such behavior, this method is extremely not practical. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1398">Modifying the OS kernel or boot partition (Modify OS Kernel or Boot Partition)</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description:</i> The name of the opportunity to increase the privilege of the enemy may try to place malicious code in the OS kernel or components of the boot partition, where the code can not be detected, will be saved after the device is rebooted and can not be deleted by the user.  In some cases (for example, when using <a href="https://www.samsung.com/ru/business/mobile-solutions/knox-solutions/">Samsung Knox</a> ), an attack may be detected, but will result in the device being put into reduced functionality mode. <br><br>  Many Android devices provide the ability to unlock the OS bootloader for development purposes, but this functionality provides the ability to maliciously update the kernel or modify the boot partition code.  If the bootloader is not unlocked, then there remains the potential to use vulnerabilities to update the kernel code. <br><br>  Security Tips <i>:</i> Install security updates, implement remote appraisal systems (Android SafetyNet, Samsung KNOX TIMA) and deny devices that have not passed appraisal access to corporate resources.  Organize a check of the loader lock status on devices that provide the ability to unlock the bootloader (hence allowing any OS code to be written to the device). <br><br>  Android SafetyNet Attestation API can be used to remotely identify and respond to compromised devices.  Samsung KNOX provides remote qualification of Samsung Android devices.  Samsung KNOX devices include an ‚Äúirreversible bit fuse (non-reversible Knox warranty bit fuse)‚Äù, which will work if a non-KNOX core is loaded on the device.  When triggered, enterprise KNOX container services will not be available on the device.  As described in the iOS Security Guide, iOS devices will not be able to boot or allow device activation if unauthorized changes were detected.  Many enterprise applications perform their own checks to detect and respond to compromised devices.  Such checks are not a reliable means, but can detect the primary signs of compromise. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1400">Modify System Partition</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description:</i> If an adversary can elevate privileges, he can use them to place malicious code in the system partition of the device, where it will remain after the OS reboots and will not be readily available for removal by the user.  Many Android devices allow you to unlock the bootloader for development purposes.  This feature can also be used by the adversary to modify the system partition. <br><br>  <i>Security Tips:</i> Android devices with Verified Boot support perform a cryptographic check of the integrity of the system partition.  The Android SafetyNet API can be used to identify compromised devices.  Samsung KNOX also provides the ability to remotely monitor supported devices.  Devices with iOS will not boot or will not allow to activate the device in which unauthorized changes were detected. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1399">Modifying TEE (Modify Trusted Execution Environment)</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> With appropriate privileges, an attacker can attempt to place malicious code in a trusted execution environment (TEE) of the device or other similar isolated execution environment where the code is not detectable, will persist after the device is rebooted, and cannot be deleted by the user.  Execution of the code in TEE will provide the adversary with the ability to control or falsify the operation of the device. <br><br>  <i>Security Tips:</i> Devices should verify the integrity of the code that runs on the TEE at boot time.  iOS will not load if code running in Secure Enclave does not pass digital signature verification. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1403">Modification of cached executable code (Modify cached executable code)</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> In order to improve the performance, Android Runtime (ART) compiles a bytecode (classes.dex) into machine code during application installation.  If the attacker elevates the privileges, he can modify this cached code.  Since the code was originally compiled on the device, integrity control is not applied to it, unlike the code from the system partition. <br><br>  <i>Security Tips:</i> Using the latest mobile OS versions and mandatory installation of security patches. <br><br><h3>  <a href="https://attack.mitre.org/tactics/TA0029/">Privilege Escalation</a> </h3><br><h3>  <a href="https://attack.mitre.org/techniques/T1404">Exploiting OS vulnerabilities (Exploit OS Vulnerability)</a> </h3><br>  <i>Platform:</i> Android, iOS <br>  <i>Description:</i> Malicious applications can use unpatched mobile OS vulnerabilities to gain advanced privileges. <br><br>  <i>Protection recommendations:</i> Check the application for known vulnerabilities.  Install security updates.  Using the latest OS versions. <br><br><h3>  <a href="https://attack.mitre.org/techniques/T1405">Exploiting TEE Vulnerability Vulnerability</a> </h3><br>  <i>Platform:</i> Android <br>  <i>Description:</i> Malicious applications or another attack vector can be used to exploit code vulnerabilities executed in the Trusted Execution Environment (TEE).  The adversary can then receive the privileges that the TEE has, including the ability to access cryptographic keys or other sensitive data.  To attack a TEE opponent, you may first need elevated privileges in the OS.  If not, TEE privileges can be used to exploit OS vulnerabilities. <br><br>  <i>Protection recommendations:</i> Check the application for known vulnerabilities.  Install security updates.  Using the latest OS versions. </div><p>Source: <a href="https://habr.com/ru/post/454714/">https://habr.com/ru/post/454714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454702/index.html">Zabbix: LLD-monitoring of SIM-cards Yeastar TG</a></li>
<li><a href="../454704/index.html">On the question of helicopter or how I spent the weekend</a></li>
<li><a href="../454706/index.html">Presented by Polaris to keep Kubernetes clusters healthy</a></li>
<li><a href="../454708/index.html">Do I need a pillow astronauts?</a></li>
<li><a href="../454712/index.html">WWDC 2019: Highlights from the Keynote Robot Presentation</a></li>
<li><a href="../454716/index.html">Employees do not want a new software - go on about or bend your line?</a></li>
<li><a href="../454720/index.html">How to revive the documentation?</a></li>
<li><a href="../454728/index.html">Internet access is open: LUWRAIN technology helps blind users</a></li>
<li><a href="../45473/index.html">Multiplication table</a></li>
<li><a href="../454730/index.html">Allure Server meetup: video reports</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>