<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The reasons and advantages of the third baihuist way of using SQLite in Node.js</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Those who attained Zen Python believe that there must be one (and, preferably, only one) obvious way to achieve the desired. 

  Those who have compre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The reasons and advantages of the third baihuist way of using SQLite in Node.js</h1><div class="post__text post__text-html js-mediator-article">  Those who attained <a href="http://www.python.org/dev/peps/pep-0020/">Zen Python</a> believe that there must be one <nobr>(and, preferably,</nobr> <b>only</b> one) obvious way to achieve the desired. <br><br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/d38/ead/9bd/d38ead9bd261afb439ea4be2c95d7b78.jpg" align="right"></a>  Those who have comprehended the <a href="https://github.com/joyent/node/wiki/Modules">list of Node.js modules</a> can be convinced that the creators of these modules are spiritually closer <nobr>not to Zen Buddhists,</nobr> <nobr>but to</nobr> <b>Bayhouists</b> - to fans of the <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D1%2583%25D1%2581%25D1%2582%25D1%258C_%25D1%2580%25D0%25B0%25D1%2581%25D1%2586%25D0%25B2%25D0%25B5%25D1%2582%25D0%25B0%25D1%258E%25D1%2582_%25D1%2581%25D1%2582%25D0%25BE_%25D1%2586%25D0%25B2%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B2">Baihua Yundong</a> movement <nobr>(ÁôæËä± ËøêÂä®),</nobr> proclaimed by Mao Zedong in 1957 based on the motives of the classical Chinese poems "let a hundred flowers bloom, let a hundred schools compete," beginning with the words "bai hua" <nobr>("ÁôæËä±",</nobr> "one hundred flowers").  In other words, modules for Node.js, as a rule, provide <b>several</b> ways to do the same thing, and from them the consumer chooses the one that is most suitable for him. <br><br>  But why there is no such one way that would be suitable for all? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I propose to consider the answer to this question using the example of using the SQLite database. <br><br><a name="habracut"></a>  The Node.js engine (unlike, for example, <a href="http://jsdb.org/">JSDB</a> ) does not have a built-in tool for accessing SQLite databases, providing its implementation to third-party modules.  The most popular of these is the <a href="https://github.com/mapbox/node-sqlite3"><b>sqlite3</b></a> module, supported by the well-known cartographic company <a href="https://github.com/mapbox">MapBox</a> .  <nobr>According</nobr> <a href="https://npmjs.org/package/sqlite3">to</a> npm <a href="https://npmjs.org/package/sqlite3">statistics</a> , it has <b>tens of thousands of</b> downloads per month. <br><br>  If you look at it closely at all, it is easy to notice that the code of this popular module is not entirely Javascript.  It is based on connecting the source (sish) <a href="http://sqlite.org/">SQLite</a> code as a compiled <a href="http://nodejs.org/docs/latest/api/addons.html">add-on</a> <i>(addon)</i> for Node.  <nobr>This</nobr> is the reason why the module is not widely usable: <nobr>under Linux</nobr> and under Mac OS X, program building tools are abundant, but for Windows, the need to meet <a href="https://github.com/TooTallNate/node-gyp">the</a> <nobr>node-gyp</nobr> <a href="https://github.com/TooTallNate/node-gyp">requirements</a> <nobr>can</nobr> sometimes be very painful.  A special problem is the <nobr>64-bit</nobr> version of Windows, which will require not only Microsoft Visual Studio <nobr>C ++ 2010</nobr> (free <a href="http://go.microsoft.com/%3Flinkid%3D9709949">Express</a> version), but also heavy Windows 7 <nobr>64-bit SDK, the</nobr> <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D8442">ISO image of</a> which takes more than <b>570</b> to build add-ons. <b>megabytes.</b> <br><br>  In response to this inconvenience, a second way to use SQLite in Node appeared - the <b><a href="https://github.com/mikesmullin/node-sqlite-purejs">node-sqlite-purejs module</a></b> , whose code does not require assembly, because it consists (as reflected in the module name) of pure javascript that is executed by the Node engine directly.  This code is based on the <nobr>SQL.js</nobr> script <nobr>,</nobr> which Alon Zakai (the creator of Emscripten) received, passing the SQLite code through Emscripten - <a href="http://habrahabr.ru/post/140185/">I mentioned</a> this achievement in Habrahabr in March of the last (2012) year. <br><br>  Unfortunately, the lack of C code is almost the only advantage of this module: it expects to want a lot better in terms of stability, and the list of still unsolved <a href="https://github.com/mikesmullin/node-sqlite-purejs/issues">problems</a> includes data loss and the impossibility of a soft shutdown.  All this is because during the automatic translation from C to JavaScript, the transaction atomicity <nobr>seems to be</nobr> lost, which is the main useful property of SQLite.  Until this problem is solved, we can sadly consider this second method as a dead end. <br><br>  More recently (last week on Sunday - October 27), it became possible <a href="https://groups.google.com/forum/">to read</a> about the appearance of the third method of using SQLite in Node, which is devoid of the main drawbacks of both its predecessors in the nodejs googlegroup.  This new module <nobr>(</nobr> <b><a href="https://npmjs.org/package/opendatabase/">opendatabase</a></b> ) does not contain SQLite code in either a sishnaya or even javascript form ‚Äî instead, it calls the <b><a href="http://sqlite.org/sqlite.html">sqlite</a></b> program (in Windows called <b>sqlite.exe</b> ) through the good old command line interface, throwing <nobr>SQL queries</nobr> into it and parsing the javascript its response. <br><br>  It is not hard to guess that this module does not require means for compiling and assembling (which were required by me to the sqlite3 module): it is enough to <a href="http://sqlite.org/download.html">download the</a> sqlite program from the SQLite website in a ready-made form.  For the same reason, there will be no problems with non-ideal implementation <nobr>(in node-sqlite-purejs</nobr> observed): the downloaded program contains the official implementation. <br><br>  That is why, in this module, I see the triumph of the baihuist principle of diversity and co-flourishing, once again confirming the correctness of the Chinese saying <nobr>‚Äú</nobr> <b>Ib i ibudi -</b> <b>huydao mudi</b> ‚Äù (‚Äú‰∏ÄÊ≠• ‰∏ÄÊ≠• Âú∞ ‰ºö Âà∞ ÁõÆÁöÑ‚Äù, ‚Äústep by step you can achieve the goal‚Äù). <br><br>  To this third module, for the time being, I can only blame the location of its source code <a href="https://bitbucket.org/surgemcgee/opendatabase/src">on Bitbucket</a> and in Mercurial (and not on GitHub and Git, like most other Node modules), which is not usual for me (and therefore makes it difficult to get familiar with the giblets and capabilities module, will complicate tracking its further development).  Other programmers (more familiar with Bitbucket and Mercurial) will certainly not consider this drawback to be significant (but when looking at the source code they will find there, perhaps, other shortcomings that are not yet known to me).  I have not yet read the source code of this module, so here my story ends. </div><p>Source: <a href="https://habr.com/ru/post/200344/">https://habr.com/ru/post/200344/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../200330/index.html">Unambiguous tty for USB devices on FreeBSD</a></li>
<li><a href="../200332/index.html">Project self-organizing company</a></li>
<li><a href="../200336/index.html">Let's build an autonomous drone!</a></li>
<li><a href="../200338/index.html">The Principles of Reactive Programming course at coursera.org</a></li>
<li><a href="../200340/index.html">Creating a module for Drupal 7. Part 1</a></li>
<li><a href="../200346/index.html">Hypervisor Vulnerabilities - Threat to Virtual Infrastructure and Cloud</a></li>
<li><a href="../200348/index.html">pacemaker: how to finish off lying</a></li>
<li><a href="../200350/index.html">Cognitive and MISiS held a school competition</a></li>
<li><a href="../200352/index.html">RESTful web API</a></li>
<li><a href="../200354/index.html">Custom Annotation Preprocessor - the creation of Android-based applications and configuration in IntelliJ IDEA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>