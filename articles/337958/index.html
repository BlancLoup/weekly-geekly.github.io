<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>iOS + Kotlin. What can be done now</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="An example of uikit appeared in the master branch of the Kotlin Native project . This is a simple iOS application that displays the line entered in th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>iOS + Kotlin. What can be done now</h1><div class="post__text post__text-html js-mediator-article">  An example of <a href="https://github.com/JetBrains/kotlin-native/tree/master/samples/uikit">uikit</a> appeared in the master branch of the Kotlin Native <a href="https://github.com/JetBrains/kotlin-native/tree/master/samples/uikit">project</a> .  This is a simple iOS application that displays the line entered in the input field, and yes, 100% of the code is written in Kotlin.  It looks like this: <br><br><img src="https://habrastorage.org/web/196/7a0/c42/1967a0c425664a618ea526f9383e1e81.png"><br><a name="habracut"></a><br><h2>  Should I think about the port of your application now? </h2><br>  Yes, but only if: <br><br>  0).  You really need a common code base of mobile applications. <br>  one).  The application is not tied to the platform. <br>  2).  You have time to write a certain amount of code on Kotlin, which in the future should be rewritten in Objective-C or Swift. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Reasons not to port yet </h2><br><br>  ViewController, AppDelegate and even the main function in the example are written in Kotlin.  Those files that are written in Objective-C are needed only so that Xcode does not give an error and are not included in the final assembly (I did not find a way to fix the situation).  Those.  full-fledged interop as with Java, apparently, is not yet available.  This does not mean that the situation will not change to release (now the project is at the stage of alpha preview, and there was not even a <a href="http://blog.jetbrains.com/kotlin/">blog</a> post about this example).  But the range of options currently available is rather limited. <br><br><h2>  Interop </h2><br>  The idiomatic approach to writing a multiplatform application on Kotlin is to write the general part separately, separately the part for each platform.  At the same time, on each platform, as planned, all the libraries written for it should be easily accessible.  In the case of Java, it works well.  In the case of iOS, the situation is as follows: <br><br><pre><code class="hljs kotlin"><span class="hljs-meta"><span class="hljs-meta">@ExportObjCClass</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KotlinViewController</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UIViewController { constructor</span></span></span></span>(aDecoder: NSCoder) : <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(aDecoder) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initWithCoder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(aDecoder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">NSCoder</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> = initBy(KotlinViewController(aDecoder)) <span class="hljs-meta"><span class="hljs-meta">@ObjCOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> label: UILabel <span class="hljs-meta"><span class="hljs-meta">@ObjCOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> textField: UITextField <span class="hljs-meta"><span class="hljs-meta">@ObjCOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> button: UIButton <span class="hljs-meta"><span class="hljs-meta">@ObjCAction</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">buttonPressed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { label.text = <span class="hljs-string"><span class="hljs-string">"Konan says: 'Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${textField.text}</span></span></span><span class="hljs-string">!'"</span></span> } }</code> </pre> <br>  That is quite good.  We add @ExportObjCClass annotation to each external class, @ObjCOutlet and @ObjCAction for each action graphic to each graphic element from the storyboard.  Classes in Objective-C are available by their original names. <br><br><h2>  If you need to call Kotlin from Objective-C / Swift </h2><br>  This <a href="http://justmaku.org/2017-06-07-kotlin-on-ios">article</a> describes how to do this.  After a number of layers, with manual type conversion 2 times, but you can call Swift from Kotlin and Kotlin from Swift. <br><br><h2>  Overhead </h2><br>  In theory, the application weight should increase by about 100 kb ( <a href="https://kotlinlang.slack.com/archives/C3SGXARS6/p1502811002000274%3Fthread_ts%3D1502179497.959459%26cid%3DC3SGXARS6">from here</a> ). <br>  Instead of GC, ARC will be used, so there should not be much difference in performance with Swift. <br><br><h2>  backward compatibility </h2><br>  Judging by the <a href="https://www.youtube.com/watch%3Fv%3Dm5T0M7SnCC0">reports of</a> the team members developing the language, backward compatibility is one of their main priorities.  How good it is to judge you.  Personally, I think that it is much better than Swift and, in general, the language is good and most of the <a href="https://github.com/angryziber/kotlin-puzzlers">puzzlers</a> look far-fetched.  But there is 1 thing that, in my opinion, can be a ‚Äútime bomb‚Äù and cannot be fixed with respect to backward compatibility. <br><br><h2>  inline </h2><br>  To implement <a href="https://kotlinlang.org/docs/reference/coroutines.html">coroutines</a> that make synchronous and asynchronous code look almost the same, only one new keyword suspend was entered into the language, which the developers deserve to be <a href="https://www.youtube.com/watch%3Fv%3Db4mBmi1QNF0">proud of</a> .  But in order for extension methods ( <a href="https://kotlinlang.org/docs/reference/returns.html">forEach</a> , map ...) to work as fast as normal <a href="https://kotlinlang.org/docs/reference/returns.html">for</a> (and for outputting common types during program execution), as many as 3 ( <a href="https://kotlinlang.org/docs/reference/inline-functions.html">inline, crossinline, noinline</a> ) were introduced.  They obviously do not make the code more readable.  JIT loses some of the possibilities for optimization (a <a href="http://razbor-poletov.com/2017/06/episode-138.html">podcast about it</a> ), and C experience shows that developers are not able to correctly use such features of the language.  In general, I do not understand why the same thing could not be done annotation.  For me, inline looks like a bad solution to a decent problem. <br><br><h2>  Conclusion </h2><br><ul><li>  Kotlin will soon be able to write for all 3 major platforms (Android, iOS, Web). <br></li><li>  Most likely, there will be good compatibility with Objective-C and Swift.  Perhaps better than the one that exists between these languages.  Given the experience of JetBrains in the development of compilers and IDE, you can believe this. <br></li><li>  Kotlin has a lightweight Runtime language for Android and Web.  Under iOS, apparently, will also not be difficult. <br></li><li>  Already, you can write something. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/337958/">https://habr.com/ru/post/337958/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337940/index.html">We write telegrams of a bot parser of vacancies on JS</a></li>
<li><a href="../337942/index.html">Welcome to mini ai cups</a></li>
<li><a href="../337946/index.html">How to write your first Linux device driver</a></li>
<li><a href="../337950/index.html">We enter the rating of the participant Dribbble and Behance on "My Circle"</a></li>
<li><a href="../337952/index.html">Mathematics for the programmer</a></li>
<li><a href="../337960/index.html">In unity - profit. ESET examines browser miner</a></li>
<li><a href="../337962/index.html">Where to go vendor when Amazon is too tough: we come up with a marketplace for niche gadgets</a></li>
<li><a href="../337964/index.html">Docker, or There and back</a></li>
<li><a href="../337968/index.html">What do large successful open source projects have in common?</a></li>
<li><a href="../337970/index.html">People's Privacy Policy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>