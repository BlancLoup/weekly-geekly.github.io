<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using machine learning is not difficult. Enough for a week ...</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In previous articles, I tried to talk about the basics of pricing and building a buyer's decision tree for classic retail. In this article I will tell...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using machine learning is not difficult. Enough for a week ...</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/g7/gn/b9/g7gnb9_tmdcvrdry2dw-3j3sm5i.png" alt="image"></p><br><p>  In previous articles, I tried to talk about the basics of <a href="https://habr.com/company/sas/blog/423943/">pricing</a> and building a <a href="https://habr.com/company/sas/blog/433762/">buyer's decision tree</a> for classic retail.  In this article I will tell you about a very non-standard case and try to convince you that using machine learning is not as difficult as it seems.  The article is less technical and rather designed to show that you can start small and this will already bring tangible benefits to the business. </p><a name="habracut"></a><br><h4 id="iznachalnaya-problema">  Initial problem </h4><br><p>  On our continent there is a chain of stores that changes its assortment once a week, for example, it sells <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B2%25D0%25B5%25D1%2580%25D0%25BB%25D0%25BE%25D0%25BA">overlocks</a> first and then men's sportswear.  All unsold goods are sent to warehouses and six months later they are returned to stores again.  At the same time in the store there are about 6 different categories of goods.  Those.  The assortment of stores for each week are as follows: </p><br><p><img src="https://habrastorage.org/webt/xe/nr/uq/xenruqjy3d59u53akkjxur9qohc.png" alt="image"></p><br><p>  The network has requested a range planning system with a prerequisite for analytical decision support for category managers.  After talking with the business, they proposed two very fast potential solutions that can bring results while the planning system is being deployed: </p><br><ul><li>  sales of goods that are not sold during the main sales </li><li>  improving the accuracy of forecasting demand for stores </li></ul><br><p>  The first item did not suit the customer - the company is proud of the fact that it does not arrange sales and maintains a constant level of margins.  At the same time, huge amounts of money are spent on logistics and storage of goods.  As a result, it was decided to improve the accuracy of demand forecasting for more accurate distribution between stores and warehouses. </p><br><h4 id="tekuschiy-process">  Current process </h4><br><p>  Due to the nature of the business, each individual product is not sold for a long time and it is problematic to collect enough history for a classic analysis.  The current forecasting process is very simple and is built as follows: a few weeks before the start of the main sales, test sales start on a small part of the stores.  According to the results of test sales, a decision is made to introduce goods to the entire network and it is assumed that each store will sell on average the same amount as was sold at test stores. </p><br><p>  When we descended to the customer, we analyzed the current data, realized what was happening, and offered a very simple solution to improve the accuracy of the forecast. </p><br><h4 id="analiziruem-dannye">  Analyzing data </h4><br><p>  From the data provided to us: </p><br><ul><li>  Transaction data history for 1 year and 2 months </li><li>  Product hierarchy for planning.  Unfortunately, it almost completely lacked the attributes of goods, but more on that later </li><li>  Information about the range and prices for specific weeks </li><li>  Information about the cities in which there are shops </li></ul><br><p>  We could not in a short time unload information about the balances, which is critical in this kind of analysis (if you do not store this information - start), so later we used the assumption that the goods are on the shelves and there is no shortage of goods. </p><br><p>  We immediately set aside 2 months for a test sample to demonstrate the results.  Then we put all the available data into one large storefront, clearing them of returns and strange sales (for example, the amount in the check is 0.51 per piece goods).  It took several days.  After preparing the showcase, we looked at the sale of goods [pcs.] At the highest level and saw the following picture: </p><br><p><img src="https://habrastorage.org/webt/th/yr/d5/thyrd5xh3ho40lgosu4ovih8ovw.png" alt="image"></p><br><p>  How can this picture help us? .. And this is what: </p><br><ul><li>  Obviously, there is seasonality - sales at the end of the year are higher than in the middle </li><li>  There is seasonality within the month - in the middle of the month, sales are higher than at the beginning and at the end </li><li>  There is seasonality within the week - it is not so interesting, because  as a result, the forecast was based on weeks </li></ul><br><p>  The described items confirmed the business.  But it is also an excellent feature in order to improve the forecast!  Before adding them to the forecasting model, let's think about what other features of sales should be considered ... ‚Äúobvious‚Äù ideas come to mind: </p><br><ul><li>  Sales on average vary between different product groups. </li><li>  Sales vary between different stores. </li><li>  (Similar to the previous item) Sales vary between different cities </li><li>  (A less obvious idea) due to the nature of the business, the following dependence is visible: if the future and the previous assortment are similar, then the sales of the new assortment will be lower. </li></ul><br><p>  At this point we decided to stop and build a model. </p><br><h4 id="postroenie-abt-analytical-base-tablehttpsenwikipediaorgwikianalytical_base_table">  Building ABT ( <a href="https://en.wikipedia.org/wiki/Analytical_base_table">analytical base table</a> ) </h4><br><p>  As part of the construction of the model, all the features found were translated into ‚Äúfeature‚Äù models.  Here is a list of features used as a result: </p><br><ul><li>  current forecast, i.e.  average sales of test stores in [pcs.] common to all stores </li><li>  month number and week number in month </li><li>  all categorical variables (city, store, product categories) were coded with the help of <a href="https://habr.com/company/yandex/blog/327444/">smoothed likelihood</a> (useful technique - who does not use it, take it into service) </li><li>  counted lag 4 medium sales product categories.  Those.  if the company plans to sell the blue jersey, then the lag of the average sales of the jersey category was calculated </li></ul><br><p>  ABT turned out to be simple, each parameter was clear to the business and did not cause misunderstanding or rejection.  Then it was necessary to understand how we would compare the quality of the forecast. </p><br><h4 id="vybor-metriki">  Metric selection </h4><br><p>  The customer measured the current prediction accuracy using the <a href="https://en.wikipedia.org/wiki/Mean_absolute_percentage_error">MAPE</a> metric.  The metric is popular and simple, but it has certain drawbacks when it comes to demand forecasting.  The fact is that when using MAPE, forecast errors of the form have the greatest impact on the final indicator: </p><br><p><img src="https://habrastorage.org/webt/95/jr/9q/95jr9qd5k3qsuxogm7bmj1t-plk.png" alt="image"></p><br><p>  The relative forecast error of 900% seems to be big, but let's look at the sales of another product: </p><br><p><img src="https://habrastorage.org/webt/8n/62/pf/8n62pfymy-ubynb7klmorgythb0.png" alt="image"></p><br><p>  The relative error of the forecast is 33%, which is much less than 900%, but the absolute deviation deviation of 100 [units] is much more important for business than deviation of 18 [units].  To take into account these features, you can come up with your own interesting measures, or you can use another popular measure when forecasting demand - <a href="https://en.wikipedia.org/wiki/Demand_forecasting">WAPE</a> .  This measure gives more weight to goods with higher sales, which is great for the task. </p><br><p>  We told the company about various approaches to measuring forecast errors, and the customer readily agreed that using WAPE in this task is more reasonable.  After that, we launched Random Forest with virtually no tuning of the hyperparameters and obtained the following results. </p><br><h4 id="rezultaty">  results </h4><br><p>  After forecasting the test period, we compared the predicted values ‚Äã‚Äãwith the actual ones, as well as with the company's forecast.  As a result, <em>MAPE decreased by more than 15%, WAPE by more than 10%</em> .  Having calculated the impact of the improved forecast on business indicators, it turned out to be a reduction in costs by a very big amount, amounting to millions of dollars. <br>  <strong>All work spent 1 week!</strong> <strong><br></strong> </p><br><h4 id="dalneyshie-shagi">  Further steps </h4><br><p>  As a bonus for the customer, we conducted a small <a href="https://en.wikipedia.org/wiki/Data_quality">DQ</a> experiment.  For the same product group from the product names, we distribute the characteristics (color, type of product, composition, etc.) and added them to the forecast.  The result was inspiring - in this category, both error measures improved by an additional more than 8%. </p><br><p>  As a result, the customer was given a description of each feature, model parameters, assembly parameters of the ABT showcase, and described further steps to improve the forecast (use historical data for more than one year; use balances; use product characteristics, etc.). </p><br><h4 id="vyvod">  Conclusion </h4><br><p>  In one week of working together with the customer, it was possible to significantly increase the accuracy of forecasting, while practically without changing the business process. <br>  Surely many people now think that this case is very simple and they will not get off with such an approach in the company.  Experience shows that there are almost always places where only basic assumptions and expert opinions are used.  You can start using machine learning from these places.  To do this, you need to carefully prepare and examine the data, talk to the business and try to apply popular models that do not require long tuning.  And stacking, embedding features, complex models are all for later.  I hope I have convinced you that this is not as difficult as it may seem, you just need to think a little and not be afraid to start. </p><br><p>  Do not be afraid of machine learning, look for places where it can be applied in the processes, do not be afraid to explore your data and let consultants come to them and get great results. </p><br><p>  <em>PS We recruit in practice young padawan students for internships under the guidance of experienced Jedi.</em>  <em>For the start enough common sense and knowledge of SQL, the rest will teach.</em>  <em>You can develop into a business expert or technical consultant, depending on what is more interesting.</em>  <em>If you have interest or recommendations - write in a personal</em> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/433896/">https://habr.com/ru/post/433896/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433884/index.html">Legal aspects of video surveillance: how to avoid problems with the law</a></li>
<li><a href="../433886/index.html">Python machine learning with interactive Jupyter demos</a></li>
<li><a href="../433888/index.html">Application of lithium-ion batteries in single-phase UPS</a></li>
<li><a href="../433892/index.html">FSTEC vs NIST: leakage protection in Russian and American style</a></li>
<li><a href="../433894/index.html">[Video] Why rockets explode, what will appear in Kotlin soon and how to save the review code</a></li>
<li><a href="../433898/index.html">Digest MBLT DEV :: release ‚Ññ200</a></li>
<li><a href="../433900/index.html">ICQ is dead. Long live ICQ?</a></li>
<li><a href="../433902/index.html">Repetition for the programmer: why it is important to solve similar problems</a></li>
<li><a href="../433904/index.html">Jira DataCenter - what is it? How does it work? How to deploy?</a></li>
<li><a href="../433906/index.html">Problems using NtQuerySystemInformation with undocumented arguments</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>