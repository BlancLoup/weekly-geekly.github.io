<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The quality of data networks. Transport</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the previous article the basic metrics of the quality of networks and data transmission systems were touched upon. It was also promised to write ab...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The quality of data networks. Transport</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/cc0/5a3/056/cc05a3056e204cd8a519769e9ca7a7c8.jpg" alt="image" align="left"><br>  In the <a href="http://habrahabr.ru/post/250821/">previous</a> article the basic metrics of the quality of networks and data transmission systems were touched upon.  It was also promised to write about how everything works from the inside.  And intentionally it was not mentioned about the quality of the data transmission medium and its characteristics.  I hope that the new article will provide answers to these questions. <br><br><a name="habracut"></a><br><br clear="all"><h4>  Transmission medium </h4><br>  I will begin, perhaps, with the last point - the quality of the transmission medium.  As already written above, nothing was said about it in the previous narrative, since the number of mediums and their characteristics themselves are very different and depend on just a huge number of factors.  Understanding all this diversity is the task of the relevant specialists.  It is obvious to all that radio airtime is used as a transmission medium.  I remember in the late 90s and early 00s, such exotic transmission methods as laser atmospheric transmitters began to be particularly popular with telecom operators. <img src="https://habrastorage.org/files/06b/daf/5fe/06bdaf5fe4774143a18d843a0f1572ed.jpg" alt="image" align="left">  They looked, depending on the manufacturer and configuration, something like the picture on the left (yes, almost such a <a href="http://kazus.ru/shemes/showpage/0/686/1.html">light phone</a> from amateur radio).  Their advantage was that it was not necessary to obtain the permission of the <a href="http://minsvyaz.ru/ru/activity/advisories/7/">HMLR</a> , and even the speeds were slightly higher compared to the radio bridge, besides, there were modifications for the organization of time-division channels (E1, etc.), and similar equipment access was cost prohibitively expensive.  Why not an optical cable?  Because in those happy times of wild providing, optics were still quite expensive, and for an interface converter or active equipment that could receive an optical link directly gave a small (and some large) bar of gold.  There were also satellite channels, but this is generally from the realm of fantasy and could afford them only if the companies of the oil sector and other national wealth.  But the work of the channel via satellite is reduced to the use of radio-air, with all the consequences and the introduction of a huge delay. <br><br>  Accordingly, plunging into the question as a result, we will have a lot of media and not a single generalized characteristic.  Nevertheless, for us the environment is just a transport, transmitting information from point A to point B. And for transport (even public), the characteristic reflecting its quality will be the delivery of all bits (well, or passengers) without distortion and loss (I would not want to lose some body during transportation, agree).  Those.  we come to such a generalized metric of transport quality as the number of bit errors, or <a href="http://en.wikipedia.org/wiki/Bit_error_rate">BER</a> (Bit error rate).  In purely packet networks, it is practically not used, since transmission errors are detected at the packet level, for example, the calculation of checksums: <a href="http://en.wikipedia.org/wiki/Ethernet_frame">FCS</a> (Frame check sequence) for L2 or <a href="http://en.wikipedia.org/wiki/Transmission_Control_Protocol">hecksum IP</a> for L3.  If the checksum does not match, then the entire packet is discarded as invalid.  If we consider heterogeneous networks, those in which a non-packet network can serve as transport, and, for example, one of the options described above, or transit through <a href="https://ru.wikipedia.org/wiki/ATM">ATM</a> , <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BB%25D0%25B5%25D0%25B7%25D0%25B8%25D0%25BE%25D1%2585%25D1%2580%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2586%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D1%258F_%25D0%25B8%25D0%25B5%25D1%2580%25D0%25B0%25D1%2580%25D1%2585%25D0%25B8%25D1%258F">PDH</a> , <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B8%25D0%25BD%25D1%2585%25D1%2580%25D0%25BE%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2586%25D0%25B8%25D1%2584%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D1%258F_%25D0%25B8%25D0%25B5%25D1%2580%25D0%25B0%25D1%2580%25D1%2585%25D0%25B8%25D1%258F">SDH</a> and the like is used without the direct (but with recovery) packet transmission, then bit errors transport can greatly influence, of course, depending on the technology.  Consider the encapsulation and transmission of an Ethernet frame in HDLC.  Other technologies use almost the same technique. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/files/543/c98/93e/543c9893e69a4f3782895bf20973cc13.png" alt="image"></div><br>  The scheme is read from left to right (taken <a href="http://www.kit-e.ru/articles/telecommunication/2007_4_144.php">here</a> ). <br><ol><li>  Some node of network A sends a packet towards some node of network B </li><li>  Transport between networks is built on a PDH network. </li><li>  The node at the exit edge of network A cuts out the payload area from the Ethernet frame (fields from DestinationAddress to FCS inclusive), wraps the headers in HDLC, and sends it to the border node of network B input </li><li>  Network B input node allocates payload area and recovers Ethernet frame </li><li>  The frame from the border node is sent to the recipient </li></ol><br>  As you can see, in this case, the control is transmitted correctly and in the event of a bitstream damage during transmission, the recovered packet with the wrong FCS will be discarded by the receiver.  In this case, the error detection mechanism is obvious. <br><br>  But the add-in encapsulation is not always used, or the full frame is not transmitted at all, but only the payload field.  Those.  an area is cut, wrapped in an internal protocol, and missing data is restored on the other side, including missing L2 headers.  Accordingly, FCS also disappears - it is simply calculated anew.  Thus, it turns out that if the data was damaged and the FCS was calculated on the basis of the ‚Äúcorrupted‚Äù data, the recipient does not receive the package that was sent to him.  This is quite common in satellite communications in order to increase the useful utilization of the channel, while avoiding the transfer of conditionally ‚Äúextra‚Äù information.  Summarizing, it turns out that the BER metric may be interesting in cases where: <br><ul><li>  it is necessary to check the stability of the physical channel, for example for optics it is 10E-12 (mentioned in IEEE802.3) </li><li>  Ethernet frames are packaged in SDH (GFP), PDH, ATM, and other transport networks. </li><li>  xHSL, PPP protocols are used in which IP packets are packed </li></ul><br><br><h4>  Ber test </h4><br>  The metric known is the ratio of the number of bit errors to the total number of bits transmitted.  The measurement technique for TDM networks is known as the ITU-T G.821 specification.  Classically, BERT (BER Test) of the first level is used to test channels, but taking into account the specifics of the packet network encapsulation protocols and the very principle of packet networks, it is necessary to be able to perform tests on L1-L4.  A little further will be discussed in more detail.  Well, now you should decide what to check and how to check.  To the question: ‚ÄúWhat to check?‚Äù ITU-T 0.150 answers.  In its paragraph 5, the types of <a href="https://en.wikipedia.org/wiki/Pseudorandom_number_generator">PSPs</a> (pseudo-random sequences) are considered, from which the data for the formation of a packet are simply taken.  Those.  you just need to take and fill the appropriate packet level with the data of the selected SRP.  We use the following devices in our devices: <br><ul><li>  PSP 2e9 (ITU-T 0.150 clause 5.1) </li><li>  PSP 2e11 (ITU-T 0.150 clause 5.2) </li><li>  PSP 2e15 (ITU-T 0.150 clause 5.3) </li><li>  PSP 2e23 (ITU-T 0.150 clause 5.6) </li><li>  PSP 2e31 (ITU-T 0.150 clause 5.8) </li><li>  custom sequence (32 bits) </li><li>  all zeros </li><li>  all units </li><li>  alternative sequence (01010101) </li></ul><br>  Custom sequence is introduced for compatibility with devices that exist on the market, that is, you can specify any sequence and conduct a joint test. <br><br>  The question how to check is still open, let's try to figure it out.  Suppose we can generate certain packages.  If you send such a packet to the other end of the transport, how can you understand that it has not changed (we should abstract from the packet principle, since we may not have FCS and other types of controls, as described earlier)?  The easiest option is to wrap the packet back (in TDM is called ‚Äúloop‚Äù, on Ethernet it is to install a loop).  Inversion, in many cases, can be done at the channel output without changing the transmission medium, i.e.  really put a loop on the output of E1 and everything will work.  But since  Since the data makes a double path, the probability of an error also increases by 2 times.  And the channels can be asymmetric or unidirectional.  Accordingly, it would be ideal to be able to have information about the correct following and to compare incoming packets with already known information.  The first, and simplest option, applicable when both channel outputs are located side by side (for example, this is possible with TDM switching, or testing an optical ‚Äúring‚Äù) is that one port of the device generates test traffic, and the other port of the same device receives it and compares, and since  Since the comparison occurs in the same node as the generation, then there are no problems with comparing the sequence data.  The second option involves the restoration of the original sequence and comparing it with incoming data.  In the case of a completely random sequence, it is not possible to realize this, but if the sequence is pseudo-random, then completely.  Some time is spent on synchronization at the very beginning of the test, but then the comparison is not difficult.  Since the PSP of the first device and the PSP of the second are known and identical, synchronization is reduced to finding the place where the comparison starts in the PSP of the second device.  Therefore, the following topologies exist: <br><ol><li>  "On myself" 1 - one device on one port, on the other end of the transport there is a loop </li><li>  "On itself" 2 - one device from one port of its port to another port </li><li>  from one device to another device, with synchronization </li></ol>  Once again, it is worth noting that the BER test is not recommended for use only on networks with packet switching.  I will give an example.  Assume that the test flow is already in progress and the instruments are synchronized (topology 3).  At some point in time, the following happens: <br><ol><li>  Ethernet frame is formed containing PSP data </li><li>  for such a frame is calculated FCS and it fits into the output buffer </li><li>  frame is sent over the network to another device </li><li>  for some reason, only a single bit within the packet is changed </li><li>  the receiver accepts the package </li><li>  FCS received packet does not match the content </li><li>  the packet is discarded (if there is, for example, a switch between the sender and the receiver, then the packet will not reach the receiver at all, since it will be destroyed to it) </li><li>  the sender forms the next packet (it all starts with step 1) </li></ol><br>  In the example shown in step 8, synchronization will be disrupted on the recipient side.  It will happen because the sender will take the next block of the SRP, and the recipient will compare with the block that was lost in the previous cycle (he does not know anything about the loss).  A synchronization failure will lead to an unreasonably large increase in bit errors, since  all the new blocks do not coincide at all, which will lead to the fact that in one packet the number of bit errors will increase by the frame size.  After some time, an attempt will be made to restore synchronization, but the number of accumulated bit errors will be much inconsistent with reality. <br><br><h4>  And how in the gland? </h4><br>  Like others, I don‚Äôt know, but with our Berkut instruments ( <a href="http://metrotek.spb.ru/b3et.html">ET</a> , <a href="http://metrotek.spb.ru/b3etx.html">ETX</a> , <a href="http://metrotek.spb.ru/b3etl.html">ETL</a> , <a href="http://metrotek.spb.ru/b100.html">B100</a> , as well as the <a href="http://metrotek.spb.ru/b45gbe.html">B5-GBE</a> module for <a href="http://metrotek.spb.ru/b45.html">MMT</a> ), the situation is as follows.  Remembering the principle of generating and analyzing traffic as close as possible to the physical segment from the first article, all such tasks were assigned to FPGA.  A simplified structural diagram looks like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/95d/52b/6f0/95d52b6f06f947939e8e7cf9d47ba679.png" alt="image"></div><br>  The MAC core is represented by two blocks: one for reception, the other for transmission.  This allows you to independently receive and send packets, i.e.  There is no interaction between the send queue and the receive queue, and vice versa.  It is also possible to keep general statistics on the received and sent traffic from two independent blocks regardless of the type of test.  The data from the transmission unit is received by the transmitter and sent to the network, and the incoming data from the transceiver is received by the reception unit. <br>  Since some test topologies require loop functionality (loopback, loop), it is implemented in a separate unit.  It is possible to install a loop of level L1-L4: <br><ul><li>  L1 - just wraps traffic back (it happens in the transceiver) </li><li>  L2 - changes DstMAC &lt;-&gt; SrcMAC in places, recounts FCS </li><li>  L3 - changes DstMAC &lt;-&gt; SrcMAC and DstIP &lt;-&gt; SrcIP in places, recalculates FCS </li><li>  L4 - changes DstMAC &lt;-&gt; SrcMAC, DstIP &lt;-&gt; SrcIP and DstPort &lt;-&gt; SrcPort, recounts FCS </li></ul><br>  The statistics on the packets is maintained for the loop mode too, which makes it possible to roughly estimate the ratio of sent and received packets. <br><br>  The generator module for each type of test is different; for BERT, it contains a generator of the memory bandwidth of all declared types. <br>  It works as follows.  From the PSP generator, data is sent to a multiplexer (in other words, a switch), which, if no other channel is currently on, sends the stream to the MAC tx module.  The MAC tx module, in accordance with the test settings (BERT level, packet size, field data), forms a valid Ethernet frame from the SRP and sends it to the transceiver, which in turn sends it to the network.  Depending on the topology of the test, the frame is either wrapped by the remote side or analyzed.  In any case, the initial processing of the package is no different.  The frame falls on the MAC rx core, which sends it to the multiplexer.  Depending on the device operation mode, the multiplexer sends the packet either to the Loopback module, from where it is sent after processing to the MAC tx for sending, or to the processing and test statistics module, where, if necessary, it will attempt to synchronize the memory bandwidth and compare the original sequence with received.  Processing results are sent to the statistics output module. <br>  Using FPGA or ASIC allows all operations to be performed in parallel, which does not introduce any processing delays and eliminates the interference of the processing modules. <br><br><h4>  Conclusion </h4><br>  Despite all the seeming simplicity of algorithms and techniques, there are many years of serious research behind them.  A huge number of factors still affect both the accuracy of measurements and the cost of devices (precision elements, high-speed FPGAs).  For example, the above BER test is not very complex in general algorithmic terms, but requires knowledge of mathematics, computer science and information theory for the development of a viable model.  Modifying the BER test for packet networks (supporting L2-L4 levels) requires a deep understanding of switching and routing principles.  I hope that this kind of articles are interesting and useful.  In the following publications I plan to write about certified tests, traffic generators, filters and analytical systems.  After all, as John Fitzgerald Kennedy said at a speech before US citizens before the start of the lunar program: <br><blockquote>  ‚ÄúAnd we will do it.  Not because it is easy, but because it is difficult. ‚Äù </blockquote><br><br>  <sub>Ps.</sub>  <sub>Ask questions and suggest topics, within our competence are ready for anything :)</sub> </div><p>Source: <a href="https://habr.com/ru/post/251693/">https://habr.com/ru/post/251693/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../251675/index.html">How we prepare future big data specialists</a></li>
<li><a href="../251683/index.html">LotCat</a></li>
<li><a href="../251687/index.html">Conversational bot for Vkontakte in PHP</a></li>
<li><a href="../251689/index.html">6 principles of visual hierarchy</a></li>
<li><a href="../251691/index.html">Record of the webinar "What's new in Kerio Control 8.5"</a></li>
<li><a href="../251695/index.html">LEDs, tapes and their power supply from alternating current</a></li>
<li><a href="../251701/index.html">PhonoPaper Optimization Using Intel Tools</a></li>
<li><a href="../251703/index.html">How to set up free alerts about problems with your site</a></li>
<li><a href="../251705/index.html">"Reverse Engineering" client application in an educational center</a></li>
<li><a href="../251707/index.html">Our company at the largest game development conference in San Francisco - GDC</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>