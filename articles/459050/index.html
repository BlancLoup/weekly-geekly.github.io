<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Powerful module for typing Vuex</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The motive for writing this article was another article on the topic of typing Vue and, accordingly, Vuex . To my surprise, I didn‚Äôt find there any me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Powerful module for typing Vuex</h1><div class="post__text post__text-html js-mediator-article">  The motive for writing this article was <a href="https://habr.com/ru/post/458632/">another article</a> on the topic of typing <b>Vue</b> and, accordingly, <b>Vuex</b> .  To my surprise, I didn‚Äôt find there any mention of the module, which, in my opinion, is the best of its kind "typifier" Vuex.  A search on Habr, and indeed on Runet (in fact, and in English-language sources, it is not easy to immediately find any references), alas, did not give any results.  This article is not a detailed analysis and a multipage manual on the use and configuration, but rather a way to share with you, dear Vue-ninja, a tool that does an excellent job with its task. <br><a name="habracut"></a><br><h1>  vuex-smart-module </h1><br>  Who has no time at all: <a href="https://github.com/ktsn/vuex-smart-module">Github</a> . <br><br>  The main purpose of the module, as you managed to guess, is the full-size coverage of the Vuex storage types.  Both internally and directly in the components themselves.  The module is written by the main contributor ( <a href="https://github.com/ktsn">@ktsn</a> ) of the <a href="https://github.com/vuejs/vuex">Vuex</a> and <a href="https://github.com/vuejs/vue-class-component">vue-class-component</a> libraries. <br><br><h2>  Water </h2><br>  Frankly, my path to <b>Typescript</b> began quite recently, incl.  and with such things as decorators, so I can not compare this library with other counterparts.  My attempts to customize and use other tools (for example, <a href="https://github.com/championswimmer/vuex-module-decorators">vuex-module-decorators</a> ) led me to various problems that in the end somehow did not allow me to realize what I needed (or I just, as they say, did not know how to prepare them).  I was very lucky with the <b>vuex-smart-module</b> - the library appeared at the very moment when I translated the project (and the repository) into Typescript.  Now everything works fine, and the code is pleasing to the eye. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Examples </h2><br>  The library, in my opinion, has good documentation that covers all possible cases that you will encounter (and if not, then you can find everything else in the tests, non-trivial).  However, in order to somehow dilute the article with code, I will give basic examples of connection and use, a couple of examples of ‚Äúlife‚Äù, as well as how it works in conjunction with <i>decorators</i> (there is a nuance). <br><br><h3>  Module creation </h3><br>  A module is created using classes.  To some, this may seem strangely frightening, but believe me, you get used to it quickly. <br><br>  <b>store / root.ts</b> <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    import { Getters, Mutations, Actions, Module } from 'vuex-smart-module' //  class RootState { count = 1 } //  //      RootState class RootGetters extends Getters&lt;RootState&gt; { get double() { //      `state` return this.state.count * 2 } get triple() { //       `getters` return this.getters.double + this.state.count } } //  //     ,     RootState class RootMutations extends Mutations&lt;RootState&gt; { increment(payload: number) { //       `state` this.state.count += payload } } //  //     //    ,       ,      class RootActions extends Actions&lt; RootState, RootGetters, RootMutations, RootActions &gt; { incrementAsync(payload: { amount: number; interval: number }) { //      `state`, `getters`, `commit`  `dispatch` return new Promise(resolve =&gt; { setTimeout(() =&gt; { this.commit('increment', payload.amount) }, payload.interval) }) } } //   export default new Module({ state: RootState, getters: RootGetters, mutations: RootMutations, actions: RootActions })</span></span></code> </pre> <br><h3>  Connection </h3><br>  <b>/store/index.ts</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Vue <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vue'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Vuex <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vuex'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createStore } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vuex-smart-module'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RootStore <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./root'</span></span> Vue.use(Vuex) <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore( RootStore, { <span class="hljs-attr"><span class="hljs-attr">strict</span></span>: process.env.NODE_ENV !== <span class="hljs-string"><span class="hljs-string">'production'</span></span> } )</code> </pre><br><h3>  Modules </h3><br>  Connecting modules in the same way as in normal Vuex.  They need to be specified in the modules property of the RootStore: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FooStore <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./modules/foo'</span></span> <span class="hljs-comment"><span class="hljs-comment">/* ‚Ä¶ */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Module({ <span class="hljs-attr"><span class="hljs-attr">state</span></span>: RootState, <span class="hljs-attr"><span class="hljs-attr">getters</span></span>: RootGetters, <span class="hljs-attr"><span class="hljs-attr">mutations</span></span>: RootMutations, <span class="hljs-attr"><span class="hljs-attr">actions</span></span>: RootActions, <span class="hljs-attr"><span class="hljs-attr">modules</span></span>: { FooStore } })</code> </pre><br><h3>  Use inside component </h3><br>  You can use the store either through the global property this. $ Store, or through the mapping, which is in many ways similar to the one in Vuex: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Vue <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vue'</span></span> <span class="hljs-comment"><span class="hljs-comment">//    (      ) // import FooStore from '@/store/modules/foo' import RootStore from '@/store/root' export default Vue.extend({ computed: RootStore.mapGetters(['double']), methods: RootStore.mapActions({ incAsync: 'incrementAsync' }), created() { console.log(this.double) this.incAsync(undefined) } })</span></span></code> </pre> <br><br><h3>  Typing </h3><br>  An example of commit and dispatch typing: <br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { categories } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@/api'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> type Category { <span class="hljs-attr"><span class="hljs-attr">attributes</span></span>: { <span class="hljs-attr"><span class="hljs-attr">hasPrice</span></span>: boolean; icon: string lvl: number name: string slug: string }; id: number } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> interface IParams { <span class="hljs-attr"><span class="hljs-attr">city_id</span></span>: number } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppState</span></span></span><span class="hljs-class"> </span></span>{ categories: Category[] = [] } <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppMutations</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mutations</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppState</span></span></span><span class="hljs-class">&gt; </span></span>{ setCategories(categories: Category[]) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.categories = categories } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppActions</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Actions</span></span></span><span class="hljs-class">&lt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppState</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppGetters</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppMutations</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppActions</span></span></span><span class="hljs-class"> &gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> getCategories({params}: {<span class="hljs-attr"><span class="hljs-attr">params</span></span>: IParams}): <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>&lt;Category[]&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> categories.get({params}).then( <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ data }: { data: Category[] }</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.commit(<span class="hljs-string"><span class="hljs-string">"setCategories"</span></span>, data) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data } ) } }</code> </pre> <br><br><h3>  Receptions </h3><br><h4>  Connection using decorators ( <a href="https://github.com/kaorun343/vue-property-decorator">vue-property-decorator</a> ) </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Vue, Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"vue-property-decorator"</span></span> <span class="hljs-comment"><span class="hljs-comment">//    (      ) // import FooStore from '@/store/modules/foo' import RootStore from "@/store/root" //  ,   ,      Typescript,     : const Mappers = Vue.extend({ computed: { ...RootStore.mapGetters(["double"]) }, methods: { ...RootStore.mapActions({ incAsync: 'incrementAsync' }) } }); @Component export default class MyApp extends Mappers { created() { console.log(this.double) this.incAsync(undefined) } }</span></span></code> </pre><br><h4>  Using the module inside the module </h4><br>  <b>/store/module/bar.ts</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Store } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vuex'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Getters, Actions, Module, Context } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'vuex-smart-module'</span></span> <span class="hljs-comment"><span class="hljs-comment">//    import FooStore from './foo' /* ‚Ä¶ */ class BarGetters extends Getters { //   foo!: Context&lt;typeof FooStore&gt;; //     $init(store: Store&lt;any&gt;): void { //     this.foo = FooStore.context(store) } get excited(): string { return this.foo.state.value + '!' // -&gt; hello! } } /* ‚Ä¶ */</span></span></code> </pre><br><h4>  Reset storage </h4><br>  Sometimes it may be necessary to reset the repository to its default values, which is quite simple: <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooState</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooMutations</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Mutations</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooState</span></span></span><span class="hljs-class">&gt; </span></span>{ reset () { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> s = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FooState() <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(s).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state[key] = s[key] }) } }</code> </pre> <br><h2>  The final </h2><br>  I hope you were interested, well, or at least you learned about this library.  Who knows, maybe starting from the next project (and maybe the current refactoring is just around the corner?), You will start, like me, to use vuex-smart-module (or Typescript in general)?  Personally, my transition to Typescript was quite painful (for 1.5-2 years I started trying to switch to it at least 3-4 times, but every time I faced some problems, misunderstanding. I was often haunted by the feeling that developing Typescript takes 2-3 times more time than before, because now you can‚Äôt just ‚Äúquickly jot down.‚Äù But once, stepping on the ‚Äúbright side of static typing,‚Äù I felt the power of the types and how they ultimately allow to speed up the development process, which is equally important, to debug the code (perhaps in the same 2  3 times), as well as facilitate its further support. <br><br>  PS Do not forget to put a star on this module.  :) <br><br>  <b>UPD:</b> I offer my deepest apologies to a respected user, whom I may have offended by my post and forced him to merge my karma.  I would be extremely grateful to you, Mr. (-J), if you write in a personal (or you can in the commentary on the article) - what mistake did I make to avoid it in the future. <br><br>  <b>UPD 2:</b> Added a typing example. <br><br><div class="spoiler">  <b class="spoiler_title">Thanks</b> <div class="spoiler_text">  In conclusion, I want to thank my beloved wife for her patience, the cat for the pleasant rumble next to the table, the neighbors for the silence and, of course, you for your attention! <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/459050/">https://habr.com/ru/post/459050/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../45903/index.html">Futuristic LED Watch</a></li>
<li><a href="../459030/index.html">A look into the black box - the new system from MIT will show how the machine learning algorithms work</a></li>
<li><a href="../459034/index.html">Some simple but useful tips for working with getters in Vuex</a></li>
<li><a href="../459038/index.html">The camera's voice guidance function has become more accessible - the universal solution SmartCam A12 Voice Tracking</a></li>
<li><a href="../459046/index.html">How to independently implement (Proof of Existence) in 2 steps</a></li>
<li><a href="../459052/index.html">How to compare: ‚Äúamazing cars‚Äù and ‚Äúugly barracks‚Äù, in a marketing survey and in big data</a></li>
<li><a href="../459054/index.html">Heat map of clicks - how users behave on the site</a></li>
<li><a href="../459062/index.html">The digest of interesting materials for the mobile # 305 developer (July 1 - 7)</a></li>
<li><a href="../459066/index.html">Balancing write and read in the database</a></li>
<li><a href="../459068/index.html">Windows Server 2008 R2 - The King Is Dead, Long Live The King</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>