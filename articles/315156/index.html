<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The correct polymorphic Java builder.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What is all this about? 
 When implementing chained builder in Java, everything is fine until you need to add inheritance. Immediately, two problems a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The correct polymorphic Java builder.</h1><div class="post__text post__text-html js-mediator-article"><h4>  What is all this about? </h4><br>  When implementing chained builder in Java, everything is fine until you need to add inheritance.  Immediately, two problems arise - how to make the parent builder methods return the object of the child builder and how to pass the child builder to functions that accept the parent.  A pattern implementation is proposed that solves both problems.  The source can be found <a href="https://github.com/blaze79/debuilder">here</a> on the githaba. <br><a name="habracut"></a><br><h4>  Upd.  Real problem </h4><br>  The application has dto-objects to display the result, which are constructed as follows: <br><br>  1) The builder of the necessary dto-object is created. <br>  2) The builder is transferred to different classes in a chain; each class uses the builder to set the fields it needs. <br><br>  One day they decided to introduce a new version of the API, the dto-object was expanded with the help of inheritance and it turned out that its builder could not be thrust into the existing class chain for completion. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Formulation of the problem </h4><br>  There should be 100,500 words about the importance of the pattern builder, so as not to bore the reader with this crap, let's get down to business right away.  Suppose there are 3 classes with clear names Gen1, Gen2 and Gen3.  They form a linear hierarchy of Gen3 ‚Üí Gen2 ‚Üí Gen1.  Each of them contains exactly one very important method named setValX (where X is the number from the class name).  We want to get Builder1, Builder2, Builder3 builders, each of which contains the corresponding valX method, which is implemented only in one class (we don‚Äôt want to copy-paste). <br><br>  The chains should also work: <br><br><pre><code class="java hljs">Gen1 gen1 = builder1.val1(<span class="hljs-string"><span class="hljs-string">"val1"</span></span>).build(); Gen2 gen2 = builder2.val1(<span class="hljs-string"><span class="hljs-string">"val1"</span></span>).val2(<span class="hljs-string"><span class="hljs-string">"val2"</span></span>).build(); Gen3 gen3 = builder3.val1(<span class="hljs-string"><span class="hljs-string">"val1"</span></span>).val2(<span class="hljs-string"><span class="hljs-string">"val2"</span></span>).val3(<span class="hljs-string"><span class="hljs-string">"val3"</span></span>).build();</code> </pre> <br>  And the ability to use child builders instead of parent ones: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">Gen1 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">someFunction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Builder1 builder1)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> builder1.val1(<span class="hljs-string"><span class="hljs-string">"val1111"</span></span>); } ... someFunction1(builder3.val2(<span class="hljs-string"><span class="hljs-string">"val222"</span></span>).val3(<span class="hljs-string"><span class="hljs-string">"val333"</span></span>));</code> </pre> <br><h4>  What and how did it happen </h4><br>  The builder is supposed to do the following: create an object at the very beginning, then fill its fields, and in the build () function return it to the client.  In this case, we need a class that will do a simple thing - to store a link to the object being constructed and to store a link to the builder of the desired type, which will be returned by all value setters.  The following class solves the problem: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BuilderImpl</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RetBuilder</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> T nested; RetBuilder returnBuilder; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BuilderImpl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T child)</span></span></span><span class="hljs-function"> </span></span>{ nested = child; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNested</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> nested; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">injectReturnBuilder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(RetBuilder builder)</span></span></span><span class="hljs-function"> </span></span>{ returnBuilder = builder; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> RetBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">self</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> returnBuilder; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> T </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> nested; } }</code> </pre><br>  Of course, it would be better to get rid of the injectReturnBuilder method by passing the necessary data to the constructor, but alas, this child builder will be passed there, which cannot be used until the end of the super () parent constructor.  The getNested () method on the amateur can be accessed directly from the nested field.  The self () method is made not to confuse the field with the word this. <br><br>  Now let's think about this problem.  If we have some generic Builder1 &lt;&gt; which implements everything we need for the Gen1 class (with some Gen1 parameters, Builder1), we will not need to inherit the Builder2 Gen2 generic from it (with some Gen1 parameters, Builder1), and from Builder3 for Gen3, it turns out that Builder3, in its ancestors, has two implementations of the original Builder1 with different parameters, which, alas, is expressly prohibited by Java. <br><br>  But there is a solution - it is necessary to divide the setting of the object's fields and the creation of an object into different classes. <br>  Classes with InnerBuilderX names are responsible for setting fields and returning an object and allow inheritance.  Classes with the names FinalBuilderX are inherited from the corresponding InnerBuilderX, adding the creation of the original object and are not allowed for further inheritance. <br><br>  Another difficulty is to write InnerBuilderX with the correct combination of wildcard.  Through long trial and error (reading the specifications is not our way) was found an acceptable option.  But until it was found, combinations were tried, to which the Inspector Idea was dying or was wrong, which somewhat slowed down the development.  And so, here is the code for the InnerBuilder1 class Gen1.  The parameter T is the type of the stored object, RetBuilder is the type of the builder that is returned from the installation function val1. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InnerBuilder1</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Gen1</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RetBuilder</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InnerBuilder1</span></span></span><span class="hljs-class">&lt;? </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, ?&gt;&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BuilderImpl</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RetBuilder</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InnerBuilder1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T created)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(created); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> RetBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">val1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String val)</span></span></span><span class="hljs-function"> </span></span>{ getNested().setVal1(val); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self(); } }</code> </pre> <br>  Of course, the recursive construction class InnerBuilder1 &lt;T extends Gen1, RetBuilder extends InnerBuilder1 &lt;?  extends T,? &gt;&gt; a little annoying, but it really works. <br><br>  Well, FinalBuilder is pretty simple: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FinalBuilder1</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InnerBuilder1</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Gen1</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FinalBuilder1</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FinalBuilder1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Gen1()); <span class="hljs-comment"><span class="hljs-comment">//   this injectReturnBuilder(this); } }</span></span></code> </pre> <br>  It remains to add a static function to create a builder: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> InnerBuilder1&lt;? extends Gen1, ?&gt; builder() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FinalBuilder1(); }</code> </pre> <br>  We now turn to the child builder.  We inherit the implementation for the internal builder and make the creation of the object in the final: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> InnerBuilder2&lt;? extends Gen2, ?&gt; builder() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FinalBuilder2(); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InnerBuilder2</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Gen2</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RetBuilder</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InnerBuilder2</span></span></span><span class="hljs-class">&lt;? </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">,?&gt;&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InnerBuilder1</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RetBuilder</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InnerBuilder2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T created)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(created); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> RetBuilder </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">val2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String val)</span></span></span><span class="hljs-function"> </span></span>{ getNested().setVal2(val); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self(); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FinalBuilder2</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">InnerBuilder2</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Gen2</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FinalBuilder2</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FinalBuilder2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Gen2()); injectReturnBuilder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } }</code> </pre> <br>  You can try to compile the test code: <br><br><pre> <code class="java hljs">Gen2.builder().val1(<span class="hljs-string"><span class="hljs-string">"111"</span></span>).val1(<span class="hljs-string"><span class="hljs-string">"111"</span></span>).val1(<span class="hljs-string"><span class="hljs-string">"111"</span></span>).val1(<span class="hljs-string"><span class="hljs-string">"111"</span></span>).val2(<span class="hljs-string"><span class="hljs-string">"222"</span></span>).build();</code> </pre><br>  Happened!  And what about polymorphism? <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//    Gen1 Gen1 buildGen1Final(Gen1.InnerBuilder1&lt;? extends Gen1, ?&gt; builder) { builder.val1("set value from Gen1 builder"); return builder.build(); } ... //     Gen2 buildGen1Final( Gen2.builder().val2("set value from Gen2 builder") );</span></span></code> </pre><br>  Everything works too.  Similarly, the builder is implemented for the Gen3 class, for details you can contact the <a href="https://github.com/blaze79/debuilder">githad</a> </div><p>Source: <a href="https://habr.com/ru/post/315156/">https://habr.com/ru/post/315156/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../315146/index.html">Texel density. Why and how to use it</a></li>
<li><a href="../315148/index.html">Y. Schmidhuber: ‚ÄúIt's great to be part of the future of artificial intelligence‚Äù</a></li>
<li><a href="../315150/index.html">Overclocking the performance of iOS applications</a></li>
<li><a href="../315152/index.html">Your programming language sucks</a></li>
<li><a href="../315154/index.html">VaR as a way to assess risk. Historical method</a></li>
<li><a href="../315160/index.html">Terminal Server Scan Free</a></li>
<li><a href="../315164/index.html">How else to use type safety to improve the API</a></li>
<li><a href="../315166/index.html">Log in or Log on? Front-end or Frontend? We continue to understand</a></li>
<li><a href="../315168/index.html">Comparing objects by value - 3, or Type-specific Equals & Equality operators</a></li>
<li><a href="../315170/index.html">One simple little problem. Fast, beautiful or clean?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>