<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using MEF (Managed Extensibility Framework) for developing Asp.Net WebForms applications</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="MEF is a good framework for writing extensible applications. It allows you to easily separate the implementation from the abstraction, add / modify / ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using MEF (Managed Extensibility Framework) for developing Asp.Net WebForms applications</h1><div class="post__text post__text-html js-mediator-article">  MEF is a good framework for writing extensible applications.  It allows you to easily separate the implementation from the abstraction, add / modify / delete implementations while the application is running (recomposition), work with multiple implementations of abstractions, split monolithic applications into independent parts, etc. <br><br>  Most of the examples of how MEF works are console or WPF applications.  Why?  Because in this case it is easiest to control the lifetime of the components (composable parts) because  MEF itself takes care of this, and the developer concentrates on the tasks of the example. <br><br>  The situation in web applications is completely different.  The developers are not responsible for the creation of pages, controls, etc., because  Asp.net Runtime takes care of everything. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Thus, to implement MEF support for web applications, you should combine the algorithms of both tools. <br><a name="habracut"></a><br><h4>  Known solutions </h4><br>  <a href="http://mef.codeplex.com/releases/view/44166">There is a solution for</a> how MEF can be used for WebForms applications.  But this example has several important limitations. <br><ul><li>  Developers should re-inherit all controls, pages and user controls, which is not always possible. </li><li> This example does not offer a solution for supporting <code>HttpModule</code> and <code>HttpHandler</code> </li></ul><br><h4>  High level architecture </h4><br>  The goal of the solution is to implement support for the MEF container without the need to use the re-inheritance mechanism and to provide support for the <code>HttpModule</code> and <code>HttpHandler</code> . <br><br>  Despite the fact that I rejected the above solution, I am going to use it as a basis.  This means that I will use two containers - local (per request) and global. <br><br>  Every time a request arrives, asp.net runtime creates the requested page or handler and creates all dependent controls.  I propose to initialize the imported elements immediately after all parts of the page are created, and to save all the initialized imports into a local container. <br><img src="https://habrastorage.org/storage/1626059a/26cf3ca9/f0dffd6d/e5a7c262.png"><br>  On the other hand, <code>HttpModule</code> are created once immediately after the start of the entire application.  Thus, the import for them should be done as early as possible and all <code>HttpModule</code> should be stored in the global container. <br><br><h4>  Implementation </h4><br><h5>  Pages and controls </h5><br>  In order to perform the import operation for the page and all its dependencies, you should use the additional <code>HttpModule</code> .  In this module, add the <code>Pre_Init</code> and <code>Init</code> handlers for the current requested page.  In the first handler, it is possible to perform composition for the page, the master page, and user controls.  The <code>Init</code> event will allow performing a composition for server controls, since  on <code>Pre_Init</code> they do not exist yet. <br><br>  <i>Example:</i> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ComposeContainerHttpModule : IHttpModule&lt;br&gt;{&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">void</font> Init(HttpApplication context)&lt;br&gt;  {&lt;br&gt;    context.PreRequestHandlerExecute += ContextPreRequestHandlerExecute;&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> ContextPreRequestHandlerExecute( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e)&lt;br&gt;  {&lt;br&gt; <font color="#2B91AF">Page</font> page = <font color="#2B91AF">HttpContext</font> .Current.CurrentHandler <font color="#0000ff">as</font> <font color="#2B91AF">Page</font> ;&lt;br&gt; <font color="#0000ff">if</font> (page != <font color="#0000ff">null</font> )&lt;br&gt;    {&lt;br&gt;      page.PreInit += Page_PreInit;&lt;br&gt;      page.Init += Page_Init;&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> Page_Init( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e)&lt;br&gt;  {&lt;br&gt; <font color="#2B91AF">Page</font> handler = sender <font color="#0000ff">as</font> <font color="#2B91AF">Page</font> ;&lt;br&gt;&lt;br&gt; <font color="#0000ff">if</font> (handler != <font color="#0000ff">null</font> )&lt;br&gt;    {&lt;br&gt;      CompositionBatch batch = <font color="#0000ff">new</font> CompositionBatch();&lt;br&gt;      batch = ComposeWebPartsUtils.BuildUpControls(batch, handler.Controls);&lt;br&gt;      ContextualCompositionHost.Container.Compose(batch);&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> Page_PreInit( <font color="#0000ff">object</font> sender, <font color="#2B91AF">EventArgs</font> e)&lt;br&gt;  {&lt;br&gt; <font color="#2B91AF">Page</font> handler = sender <font color="#0000ff">as</font> <font color="#2B91AF">Page</font> ;&lt;br&gt;&lt;br&gt; <font color="#0000ff">if</font> (handler != <font color="#0000ff">null</font> )&lt;br&gt;    {&lt;br&gt;      CompositionBatch batch = <font color="#0000ff">new</font> CompositionBatch();&lt;br&gt;      batch = ComposeWebPartsUtils.BuildUp(batch, handler);&lt;br&gt;      batch = ComposeWebPartsUtils.BuildUpUserControls(batch, handler.Controls);&lt;br&gt;      batch = ComposeWebPartsUtils.BuildUpMaster(batch, handler.Master);&lt;br&gt;      ContextualCompositionHost.Container.Compose(batch);&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">void</font> Dispose()&lt;br&gt;  {&lt;br&gt;  }&lt;br&gt;}&lt;br&gt;</font> &lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Initially, import is performed for the page, then for user controls and master pages, and at the very end, the recursive function implements import for server controls and their controls. <br><br>  The <code>BuildUp(CompositionBatch batch, Object o)</code> method <code>BuildUp(CompositionBatch batch, Object o)</code> checks if the <code>Object o</code> any imported items and adds it to the list of objects to implement the composition.  Once all controls have been processed, the <code>CompositionBatch</code> object can be used to initialize the container.  After that, all imports will be initialized and available during the life of the query. <br><br>  <i>Example:</i> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> ComposeWebPartsUtils&lt;br&gt;{&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">static</font> CompositionBatch BuildUp(CompositionBatch batch, Object o)&lt;br&gt;  {&lt;br&gt;    ComposablePart part = AttributedModelServices.CreatePart(o);&lt;br&gt;&lt;br&gt; <font color="#0000ff">if</font> (part.ImportDefinitions.Any())&lt;br&gt;    {&lt;br&gt; <font color="#0000ff">if</font> (part.ExportDefinitions.Any())&lt;br&gt; <font color="#0000ff">throw</font> <font color="#0000ff">new</font> Exception( <font color="#0000ff">string</font> .Format( <font color="#A31515">"'{0}': Handlers cannot be exportable"</font> , o.GetType().FullName));&lt;br&gt;&lt;br&gt;      batch.AddPart(part);&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">return</font> batch;&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">static</font> CompositionBatch BuildUpUserControls(CompositionBatch batch, ControlCollection controls)&lt;br&gt;  {&lt;br&gt; <font color="#0000ff">foreach</font> (Control c <font color="#0000ff">in</font> controls)&lt;br&gt;    {&lt;br&gt; <font color="#0000ff">if</font> (c <font color="#0000ff">is</font> UserControl)&lt;br&gt;        batch = ComposeWebPartsUtils.BuildUp(batch, c);&lt;br&gt;      batch = BuildUpUserControls(batch, c.Controls);&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">return</font> batch;&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">static</font> CompositionBatch BuildUpControls(CompositionBatch batch, ControlCollection controls)&lt;br&gt;  {&lt;br&gt; <font color="#0000ff">foreach</font> (Control c <font color="#0000ff">in</font> controls)&lt;br&gt;    {&lt;br&gt;      batch = ComposeWebPartsUtils.BuildUp(batch, c);&lt;br&gt;      batch = BuildUpControls(batch, c.Controls);&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">return</font> batch;&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">static</font> CompositionBatch BuildUpMaster(CompositionBatch batch, MasterPage master)&lt;br&gt;  {&lt;br&gt; <font color="#0000ff">if</font> (master != <font color="#0000ff">null</font> )&lt;br&gt;      batch = BuildUpMaster(ComposeWebPartsUtils.BuildUp(batch, master), master.Master);&lt;br&gt;&lt;br&gt; <font color="#0000ff">return</font> batch;&lt;br&gt;  }&lt;br&gt;}&lt;br&gt;</font> &lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  <i>Note:</i> <br>  I cannot use the same technique, which is used in the example from the codeplex site (inheritance of <code>PageHandlerFactory</code> and redefinition of the <code>GetHandler()</code> method), since  By this time, no controls for the page have yet been created. <br><br><h5>  HttpHandler </h5><br>  Handlers do not have events where all imports could be satisfied.  It would be ideal to use the corresponding <code>HandlerFactory</code> and override the <code>GetHandler()</code> method as was done for the pages in the codeplex example.  And such a class exists ( <code>SimpleWebHandlerFactory</code> ), but it is internal.  I don‚Äôt know why Microsoft programmers did this, but it looks weird because  the factory for the pages is public. <br><br>  I see no other option than implementing my own <code>SimpleWebHandlerFactory</code> factory instead of the one present in the .net framework.  The main goal of any <code>HandlerFactory</code> is to determine the type that should be instantiated for the current request.  <code>HandlerFactory</code> can only get type by parsing the resource that was requested.  Thus, I need a parser that could parse the <code>HttpHandler</code> code.  Fortunately, such a parser exists ( <code>SimpleWebHandlerParser</code> ), is public and I just need to make a wrapper for it ( <code>WebHandlerParser</code> ). <br><br>  Below is a sequence diagram that describes the operation of the algorithm for creating a composition for <code>HttpHandler</code> <br><img src="https://habrastorage.org/storage/4bc4e81a/6ee15e43/6febd05a/a884b478.png"><br>  Below is the code of classes that implement the above described functionality. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> SimpleWebHandlerFactory : IHttpHandlerFactory&lt;br&gt;{&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">virtual</font> IHttpHandler GetHandler( <font color="#2B91AF">HttpContext</font> context, <font color="#0000ff">string</font> requestType, <font color="#0000ff">string</font> virtualPath, <font color="#0000ff">string</font> path)&lt;br&gt;  {&lt;br&gt;    Type type = WebHandlerParser.GetCompiledType(context, virtualPath, path);&lt;br&gt; <font color="#0000ff">if</font> (!( <font color="#0000ff">typeof</font> (IHttpHandler).IsAssignableFrom(type)))&lt;br&gt; <font color="#0000ff">throw</font> <font color="#0000ff">new</font> HttpException( <font color="#A31515">"Type does not implement IHttpHandler: "</font> + type.FullName);&lt;br&gt;&lt;br&gt; <font color="#0000ff">return</font> Activator.CreateInstance(type) <font color="#0000ff">as</font> IHttpHandler;&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">virtual</font> <font color="#0000ff">void</font> ReleaseHandler(IHttpHandler handler)&lt;br&gt;  {&lt;br&gt;  }&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">internal</font> <font color="#0000ff">class</font> WebHandlerParser : SimpleWebHandlerParser&lt;br&gt;{&lt;br&gt; <font color="#0000ff">internal</font> WebHandlerParser( <font color="#2B91AF">HttpContext</font> context, <font color="#0000ff">string</font> virtualPath, <font color="#0000ff">string</font> physicalPath)&lt;br&gt;    : <font color="#0000ff">base</font> (context, virtualPath, physicalPath)&lt;br&gt;  {&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">static</font> Type GetCompiledType( <font color="#2B91AF">HttpContext</font> context, <font color="#0000ff">string</font> virtualPath, <font color="#0000ff">string</font> physicalPath)&lt;br&gt;  {&lt;br&gt;    WebHandlerParser parser = <font color="#0000ff">new</font> WebHandlerParser(context, virtualPath, physicalPath);&lt;br&gt;    Type type = parser.GetCompiledTypeFromCache();&lt;br&gt; <font color="#0000ff">if</font> (type != <font color="#0000ff">null</font> )&lt;br&gt; <font color="#0000ff">return</font> type;&lt;br&gt; <font color="#0000ff">else</font> &lt;br&gt; <font color="#0000ff">throw</font> <font color="#0000ff">new</font> HttpException( <font color="#0000ff">string</font> .Format( <font color="#A31515">"File '{0}' is not a web handler."</font> , virtualPath));&lt;br&gt;  }&lt;br&gt;  &lt;br&gt; <font color="#0000ff">protected</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> DefaultDirectiveName&lt;br&gt;  {&lt;br&gt; <font color="#0000ff">get</font> &lt;br&gt;    {&lt;br&gt; <font color="#0000ff">return</font> <font color="#A31515">"webhandler"</font> ;&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">class</font> ComposableWebHandlerFactory : SimpleWebHandlerFactory&lt;br&gt;{&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">override</font> IHttpHandler GetHandler( <font color="#2B91AF">HttpContext</font> context, <font color="#0000ff">string</font> requestType, <font color="#0000ff">string</font> virtualPath, <font color="#0000ff">string</font> path)&lt;br&gt;  {&lt;br&gt;    IHttpHandler handler = <font color="#0000ff">base</font> .GetHandler(context, requestType, virtualPath, path);&lt;br&gt;&lt;br&gt; <font color="#0000ff">if</font> (handler != <font color="#0000ff">null</font> )&lt;br&gt;    {&lt;br&gt;      CompositionBatch batch = <font color="#0000ff">new</font> CompositionBatch();&lt;br&gt;      batch = ComposeWebPartsUtils.BuildUp(batch, handler);&lt;br&gt;      ContextualCompositionHost.Container.Compose(batch);&lt;br&gt;    }&lt;br&gt;&lt;br&gt; <font color="#0000ff">return</font> handler;&lt;br&gt;  }&lt;br&gt;}&lt;br&gt;</font> &lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><h5>  HttpModule </h5><br>  As I mentioned earlier, all <code>HttpModules</code> are created at the start of the application.  So, I have to make a composition right after the application starts. <br>  <i>Example:</i> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ScopedContainerHttpModule : IHttpModule&lt;br&gt;{&lt;br&gt; <font color="#0000ff">private</font> CompositionContainer _container;&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">void</font> Init(HttpApplication app)&lt;br&gt;  {&lt;br&gt;    ComposeModules(app);&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">private</font> <font color="#0000ff">void</font> ComposeModules(HttpApplication app)&lt;br&gt;  {&lt;br&gt;    CompositionBatch batch = ComposeWebPartsUtils.BuildUpModules(app);&lt;br&gt;    _container.Compose(batch);&lt;br&gt;  }&lt;br&gt;}&lt;br&gt;&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> ComposeWebPartsUtils&lt;br&gt;{&lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">static</font> CompositionBatch BuildUpModules(HttpApplication app)&lt;br&gt;  {&lt;br&gt;    CompositionBatch batch = <font color="#0000ff">new</font> CompositionBatch();&lt;br&gt;&lt;br&gt; <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; app.Modules.Count - 1; i++)&lt;br&gt;      batch = BuildUp(batch, app.Modules.Get(i));&lt;br&gt;&lt;br&gt; <font color="#0000ff">return</font> batch;&lt;br&gt;  }&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  I get an <code>HttpApplication</code> object, retrieve all modules from it, and based on this information I fill the global container. <br><br>  As a result, I should add a few lines to the web.config file of any WebForms project in order for my solution to work. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">httpHandlers</font> <font color="#0000ff">&gt;</font> &lt;br&gt;  ......&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">remove</font> <font color="#ff0000">path</font> <font color="#0000ff">="*.ashx"</font> <font color="#ff0000">verb</font> <font color="#0000ff">="*"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">add</font> <font color="#ff0000">path</font> <font color="#0000ff">="*.ashx"</font> <font color="#ff0000">verb</font> <font color="#0000ff">="*"</font> <font color="#ff0000">type</font> <font color="#0000ff">="common.composition.WebExtensions.ComposableWebHandlerFactory, common.composition"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;  ......&lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">httpHandlers</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">httpModules</font> <font color="#0000ff">&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">add</font> <font color="#ff0000">name</font> <font color="#0000ff">="ContainerCreator"</font> <font color="#ff0000">type</font> <font color="#0000ff">="common.composition.WebExtensions.ScopedContainerHttpModule, common.composition"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt;  ......&lt;br&gt; <font color="#0000ff">&lt;</font> <font color="#800000">add</font> <font color="#ff0000">name</font> <font color="#0000ff">="ComposeContainerModule"</font> <font color="#ff0000">type</font> <font color="#0000ff">="common.composition.WebExtensions.ComposeContainerHttpModule, common.composition"</font> <font color="#0000ff">/&gt;</font> &lt;br&gt; <font color="#0000ff">&lt;/</font> <font color="#800000">httpModules</font> <font color="#0000ff">&gt;</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  I remove the default * .ashx file handler and add mine ( <code>ComposableWebHandlerFactory</code> ). <br><br>  I add the <code>ContainerCreator</code> module to create and initialize the infrastructure for the local and global containers. <br><br>  <code>ComposeContainerModule</code> will be used to initialize the local container. <br><br>  That's all! <br><br>  I did not need to use inheritance controls, write additional code in the main program.  This solution can be added to any web project based on web forms, and only web.config needs to be updated so that all features presented become available. <br><br><h4>  Example </h4><br>  I use the demo that I took from the <a href="http://mef.codeplex.com/releases/view/44166">WebFomsAndMef example</a> with a few modifications. <br><br>  Each element of the application imports the <code>SampleCompositionPart</code> class with the <code>[PartCreationPolicy(CreationPolicy.NonShared)]</code> attribute, which ensures that a new instance of <code>SampleCompositionPart</code> during the act of import.  This class contains the only <code>Id</code> field that is returned by Guid. <br><br>  The application displays the Guid value for the currently displayed item - page, control, user control, <code>HttpHandler</code> and <code>HttpModule</code> page <code>HttpModule</code> . <br><br>  <i>Example:</i> <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#008000">///PageSample.aspx</font> &lt;br&gt;&lt;asp:Content ID= <font color="#A31515">"BodyContent"</font> runat= <font color="#A31515">"server"</font> ContentPlaceHolderID= <font color="#A31515">"MainContent"</font> &gt;&lt;br&gt;  &lt;% =SamplePart.Id %&gt;&lt;br&gt;&lt;/asp:Content&gt;&lt;br&gt; &lt;br&gt; <font color="#008000">///PageSample.cs</font> &lt;br&gt; <font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> PageSample : System.Web.UI. <font color="#2B91AF">Page</font> &lt;br&gt;{&lt;br&gt;  [Import]&lt;br&gt; <font color="#0000ff">public</font> SampleCompositionPart SamplePart&lt;br&gt;  {&lt;br&gt; <font color="#0000ff">get</font> ;&lt;br&gt; <font color="#0000ff">set</font> ;&lt;br&gt;  }&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><img src="https://habrastorage.org/storage/67c807ee/fad6127a/396383af/a072baa8.png"><br>  Source code can be downloaded <a href="">here</a> . <br><br>  I hope this article will help you start using MEF in asp.net WebForms applications. </div><p>Source: <a href="https://habr.com/ru/post/106762/">https://habr.com/ru/post/106762/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../106752/index.html">Anonymous port scanning with hping3</a></li>
<li><a href="../106754/index.html">NASA is going to transfer its computing power to the "cloud"</a></li>
<li><a href="../106755/index.html">Accommodation in St. Petersburg for habracheloveka</a></li>
<li><a href="../106756/index.html">30 kopecks for Mikhalkov</a></li>
<li><a href="../106759/index.html">Payment system in Russian or is it worth to trust your money Z-payment</a></li>
<li><a href="../106765/index.html">Apple Developers Community Spb</a></li>
<li><a href="../106769/index.html">Personal data of conference participants in complete safety</a></li>
<li><a href="../106770/index.html">Donate simulation in online game</a></li>
<li><a href="../106774/index.html">Work day for 3 hours. Analysis and sorting of information</a></li>
<li><a href="../106776/index.html">Switching hours to winter time: economy, health or ...?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>