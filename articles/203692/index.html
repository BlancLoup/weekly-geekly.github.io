<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experience using the logman utility to collect application performance metrics on Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Good day! 

 In my first post, I would like to share my experience using a utility such as logman , with which you can collect informat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experience using the logman utility to collect application performance metrics on Windows</h1><div class="post__text post__text-html js-mediator-article"><h1>  Introduction </h1><br>  Good day! <br><br>  In my first post, I would like to share my experience using a utility such as <b>logman</b> , with which you can collect information on resource consumption (and not only) by a Windows application. <br><br>  One day at work, the task was to remove performance metrics for a single Windows application.  The main condition was to use at a minimum any third-party utilities, and since I didn‚Äôt have experience with such things at that time, after a little digging, the choice fell on logman.  Special accuracy was not required and it was necessary only to understand the nature of resource consumption by the application, for which logman at first glance was quite appropriate. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, let's go directly to the essence of the post. <br><a name="habracut"></a><br><h1>  What is logman? </h1><br>  Many of you, most likely at work or at home, used the native Windows performance monitor (perfmon) utility.  So logman is roughly a command line representation of a perfmon.  It allows you to create, start, stop performance counters, write the result to external files and much more.  I only needed the basic functionality, which I will describe below. <br><br><h1>  Basic operations </h1><br>  A small note: to perform the following operations, you must have administrator rights, otherwise such an error may take off. <br><pre><code class="dos hljs">:   .   ,  .</code> </pre> <br><br><h3>  View created and running counters </h3><br>  You can view the list of data collectors with the <code>logman</code> command <br>  As a result, approximately the following conclusion will be obtained: <br><pre> <code class="hljs 1c">   <span class="hljs-built_in"><span class="hljs-built_in"></span></span> <span class="hljs-built_in"><span class="hljs-built_in"></span></span> ------------------------------------------------------------------------------- cpu     .</code> </pre><br><br><h3>  Creating a performance counter </h3><br>  To create a counter, I used the following command (for a complete list of options, see the <a href="http://technet.microsoft.com/en-us/library/bb490956.aspx">official documentation</a> .): <br><pre> <code class="dos hljs">logman create counter "counter_name" -f csv -si "interval" --v -o "output_file" -c counter</code> </pre><br><br><ul><li>  counter_name is the name of the counter.  It can be any, for example "explorer_cpu" </li><li>  -f - file format with measurement results </li><li>  --v - this option suppresses the output of the version in the output file </li><li>  -si is an interval.  with which measurements will be recorded </li><li>  -o - file with measurement results </li><li>  -c - performance counter id </li></ul><br><br>  Let us dwell on the last option.  To understand what to enter in the ‚Äúcounter‚Äù field, you can proceed in perfmon, create a group of data collectors and select ‚ÄúCreate -&gt; Data collector‚Äù.  Then select ‚ÄúAdd counter‚Äù and in the appeared window find the type of counter that interests us. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/aae/1d5/dd4/aae1d5dd49e4f326e39c0c64c9f57709.png"><br><br>  I was interested in cpu and memory consumption by a specific process, so I used the following counters for measurements (the <a href="http://social.technet.microsoft.com/Forums/en-US/434b88e3-ee4b-4880-81f0-2e0f11c9f02a/perfmon-logman-process-cpu-counter-higher-than-cpu-total%3Fforum%3Dperfmon">following post</a> helped me in calculating the CPU): <br><br><ul><li>  "\ Processor (_Total) \% User time" - the percentage of CPU in user mode </li><li>  "\ Process (application_name) \% Processor time" - the CPU share of the application from the user mode </li><li>  "\ Process (application_name) \ Working Set" - the use of RAM by the process </li></ul><br><br>  The percentage of CPU consumption by a process can be calculated as ("\ Processor (_Total) \% User time" * "\ Process (application_name) \% Processor time") / (number of processors * 100) <br><br>  Counters can be written with a space, then in the output file the values ‚Äã‚Äãwill be each in its own column. <br><br>  As a result, I will give an example of a ready-made command for creating a counter: <br><br><pre> <code class="dos hljs">logman create counter "explorer-cpu.usage" -f csv -si <span class="hljs-number"><span class="hljs-number">1</span></span> --v -o "d:\logman-test\raw\explorer-cpu.usage.csv" -c "\Processor(_Total)\% User <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>" "\Process(explorer)\% Processor <span class="hljs-built_in"><span class="hljs-built_in">time</span></span>"</code> </pre><br><br><h3>  Start and stop the counter </h3><br>  Executed by the appropriate commands: <br><pre> <code class="dos hljs">logman <span class="hljs-built_in"><span class="hljs-built_in">start</span></span> "counter_name"</code> </pre><br><pre> <code class="dos hljs">logman stop "counter_name"</code> </pre><br><br><h3>  Delete counter </h3><br>  You can delete the counter with the following command (it must be stopped before this): <br><pre> <code class="dos hljs">logman delete "counter_name"</code> </pre><br><br><h1>  Python wrapper </h1><br>  Before turning to the code, I would like to talk about a small (although for me it became quite substantial) problem that arose during the collection of metrics. <br><br>  Since it was supposed to collect data for a rather short period of time (5-15 seconds), it became clear that the collection interval of 1 s (set via the "-si" option) is too large.  Searching on the Internet and in the office.  documentation, I could not find a way to reduce this interval, and I really wanted to increase the number of points on the graph.  After some thought, I decided to go on the contrary - if the interval cannot be reduced, then the number of counters can be increased.  Thus, by running several collectors in a row with an interval of 100-500 milliseconds, you can get as much data as you need in one second. <br><br>  The data collection process had to be integrated into the existing automated test and in the end a small auxiliary wrapper was written to perform all the above actions. <br><br>  Below is the source code of the module that collects data on the CPU and RAM for the specified application with the required accuracy. <br><br><div class="spoiler">  <b class="spoiler_title">pylogman.py</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> glob <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> multiprocessing CPU_USER_COUNTER = <span class="hljs-string"><span class="hljs-string">'"\Processor(_Total)\% User time"'</span></span> CPU_APP_COUNTER = <span class="hljs-string"><span class="hljs-string">'"\Process({app})\% Processor time"'</span></span> MEMORY_COUNTER = <span class="hljs-string"><span class="hljs-string">'"\Process({app})\Working Set"'</span></span> APP_PLACEHOLDER = <span class="hljs-string"><span class="hljs-string">'{app}'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> PerflogManager(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>): def __init__(self, app_name, <span class="hljs-type"><span class="hljs-type">precision</span></span>, results_dir, max_mem=<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-type"><span class="hljs-type">interval</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>): """ Args: app_name: name of the application without "exe" extention precision: amount of results_dir: output folder max_mem: this value is used to calculate % from total avaliable memory for further plotting interval: interval which will be used as "-si" logman option value """ self._app_name = app_name self._precision = <span class="hljs-type"><span class="hljs-type">precision</span></span> self._counters = { <span class="hljs-string"><span class="hljs-string">'cpu.usage'</span></span>: <span class="hljs-string"><span class="hljs-string">'{cpu_user} {cpu_app}'</span></span>.format(cpu_user=CPU_USER_COUNTER, cpu_app=CPU_APP_COUNTER).replace(APP_PLACEHOLDER, app_name), <span class="hljs-string"><span class="hljs-string">'mem.usage'</span></span>: MEMORY_COUNTER.replace(APP_PLACEHOLDER, app_name) } self._results_dir = os.path.normpath(results_dir) self._raw_dir = os.path.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(self._results_dir, <span class="hljs-string"><span class="hljs-string">'raw'</span></span>) self._final_dir = os.path.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(self._results_dir, <span class="hljs-string"><span class="hljs-string">'csv'</span></span>) self._interval = <span class="hljs-type"><span class="hljs-type">interval</span></span> self._max_mem = max_mem self._collectors = [] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> os.path.<span class="hljs-keyword"><span class="hljs-keyword">exists</span></span>(self._results_dir): os.makedirs(self._results_dir) os.makedirs(self._raw_dir) os.makedirs(self._final_dir) logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'Directory "{path}" for logman results has been created.'</span></span>.format(<span class="hljs-type"><span class="hljs-type">path</span></span>=self._results_dir)) logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'Performance logman manager has been created for "{}" application.'</span></span>.format(self._app_name)) def init_collectors(self): """ Creates collectors by "logman <span class="hljs-keyword"><span class="hljs-keyword">create</span></span>" command """ logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'Creating collectors set...'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> lang <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self._counters: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> idx <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(self._precision): collector = <span class="hljs-string"><span class="hljs-string">'{app}-{collector}-{id}'</span></span>.format(app=self._app_name, collector=lang, id=idx) output = os.path.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(self._raw_dir, collector + <span class="hljs-string"><span class="hljs-string">'.csv'</span></span>) self.__create(collector, self._counters[lang], output) self._collectors.append(collector) def start_all(self): """ Starts all the collectors from self._collectors list """ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> collector <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self._collectors: self.__start(collector) <span class="hljs-type"><span class="hljs-type">time</span></span>.sleep(random.uniform(<span class="hljs-number"><span class="hljs-number">0.1</span></span>, <span class="hljs-number"><span class="hljs-number">0.9</span></span>)) def stop_all(self): """ Stops and deletes all initiated collectors from self._collectors list """ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> collector <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self._collectors: self.__stop(collector) self.__delete(collector) def cleanup(self): """ Cleans raw_dir directory which contains unprocessed csv file from logman """ logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'Cleaning results directory from unnecessary files.'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> collector <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self._collectors: csv = os.path.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(self._raw_dir, <span class="hljs-string"><span class="hljs-string">'{}.csv'</span></span>.format(collector)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> os.path.isfile(csv): os.remove(csv) def process_csv(self): """ Composes and formats data from all counters for further plotting """ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> lang <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self._counters: final_output = os.path.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(self._final_dir, <span class="hljs-string"><span class="hljs-string">'{}.csv'</span></span>.format(lang)) self.__compose_csv(final_output, lang) self.__format_data(final_output) def __compose_csv(self, output, counter): """ Concatenates gathered csv data to one file """ logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'Composing file "{}".'</span></span>.format(output)) try: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(output, <span class="hljs-string"><span class="hljs-string">'a'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> outfile: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> csv <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> glob.glob(os.path.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(self._raw_dir, <span class="hljs-string"><span class="hljs-string">'*{}*'</span></span>.format(counter))): <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(csv, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> file: outfile.writelines(file.readlines()[<span class="hljs-number"><span class="hljs-number">1</span></span>:]) # <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> rid <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> a file <span class="hljs-keyword"><span class="hljs-keyword">header</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> service <span class="hljs-keyword"><span class="hljs-keyword">info</span></span> logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'File {} successfully created.'</span></span>.format(output)) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> (FileNotFoundError, IOError) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: logging.error(<span class="hljs-string"><span class="hljs-string">'Failed to compose file {file}: {exception}'</span></span>.format(file=output, <span class="hljs-keyword"><span class="hljs-keyword">exception</span></span>=e)) def __format_data(self, file): """ Sorts data after self.__compose_csv function and calculates % of CPU and Memory """ try: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(file, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> csv: raw_data = csv.readlines() <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(file, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> csv: sorted_data = [<span class="hljs-type"><span class="hljs-type">line</span></span>.replace(<span class="hljs-string"><span class="hljs-string">'"'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>).replace(<span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-string"><span class="hljs-string">';'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted(raw_data) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'" "'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">line</span></span>] csv_data = [] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'cpu'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> file: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted_data: <span class="hljs-type"><span class="hljs-type">time</span></span>, cpu_user, cpu_app = <span class="hljs-type"><span class="hljs-type">line</span></span>.split(<span class="hljs-string"><span class="hljs-string">';'</span></span>) cpu = (<span class="hljs-type"><span class="hljs-type">float</span></span>(cpu_user) * <span class="hljs-type"><span class="hljs-type">float</span></span>(cpu_app)) / (multiprocessing.cpu_count() * <span class="hljs-number"><span class="hljs-number">100</span></span>) csv_data.append(<span class="hljs-string"><span class="hljs-string">'{};{:.2f}\n'</span></span>.format(<span class="hljs-type"><span class="hljs-type">time</span></span>, cpu)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'mem'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> file: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-type"><span class="hljs-type">line</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted_data: <span class="hljs-type"><span class="hljs-type">time</span></span>, total_memory = <span class="hljs-type"><span class="hljs-type">line</span></span>.split(<span class="hljs-string"><span class="hljs-string">';'</span></span>) mem = <span class="hljs-type"><span class="hljs-type">float</span></span>(total_memory) / (self._max_mem * <span class="hljs-number"><span class="hljs-number">10000</span></span>) csv_data.append(<span class="hljs-string"><span class="hljs-string">'{};{:.2f}\n'</span></span>.format(<span class="hljs-type"><span class="hljs-type">time</span></span>, mem)) csv.writelines(csv_data) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> (FileNotFoundError, IOError) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: logging.error(<span class="hljs-string"><span class="hljs-string">'Failed to process file "{file}": {exception}'</span></span>.format(file=file, <span class="hljs-keyword"><span class="hljs-keyword">exception</span></span>=e)) def __logman(self, cmd): """ Default wrapper for logman commands Args: cmd: windows command to be executed """ try: logging.<span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>(<span class="hljs-string"><span class="hljs-string">'Running {}'</span></span>.format(cmd)) subprocess.check_call(cmd) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> (subprocess.CalledProcessError, OSError) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: logging.error(<span class="hljs-string"><span class="hljs-string">'Failed to execute command "{}": {}.'</span></span>.format(cmd, e)) def __create(self, <span class="hljs-type"><span class="hljs-type">name</span></span>, counter, output): """ Creates logman counter Args: name: uniq name of a collector counter: type of the counter (can be taken from perfmon) output: csv file for results """ logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'Creating collector "{}"'</span></span>.format(<span class="hljs-type"><span class="hljs-type">name</span></span>)) cmd = <span class="hljs-string"><span class="hljs-string">'logman create counter "{name}" -f csv -si {interval} '</span></span> \ <span class="hljs-string"><span class="hljs-string">'--v -o "{output}" -c {counter}'</span></span>.format(<span class="hljs-type"><span class="hljs-type">name</span></span>=<span class="hljs-type"><span class="hljs-type">name</span></span>, <span class="hljs-type"><span class="hljs-type">interval</span></span>=str(self._interval), output=output, counter=counter) self.__logman(cmd) def __start(self, <span class="hljs-type"><span class="hljs-type">name</span></span>): """ Starts logman collector Args: name: uniq name of a collector """ logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'Starting collector "{}".'</span></span>.format(<span class="hljs-type"><span class="hljs-type">name</span></span>)) cmd = <span class="hljs-string"><span class="hljs-string">'logman start {}'</span></span>.format(<span class="hljs-type"><span class="hljs-type">name</span></span>) self.__logman(cmd) def __stop(self, <span class="hljs-type"><span class="hljs-type">name</span></span>): """ Stops logman collector Args: name: uniq name of a collector """ logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'Stopping collector "{}".'</span></span>.format(<span class="hljs-type"><span class="hljs-type">name</span></span>)) cmd = <span class="hljs-string"><span class="hljs-string">'logman stop {}'</span></span>.format(<span class="hljs-type"><span class="hljs-type">name</span></span>) self.__logman(cmd) def __delete(self, <span class="hljs-type"><span class="hljs-type">name</span></span>): """ Deletes logman collector Args: name: uniq name of a collector """ logging.<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>(<span class="hljs-string"><span class="hljs-string">'Deleting collector "{}".'</span></span>.format(<span class="hljs-type"><span class="hljs-type">name</span></span>)) cmd = <span class="hljs-string"><span class="hljs-string">'logman delete {}'</span></span>.format(<span class="hljs-type"><span class="hljs-type">name</span></span>) self.__logman(cmd) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: logging.basicConfig(<span class="hljs-keyword"><span class="hljs-keyword">level</span></span>=logging.<span class="hljs-keyword"><span class="hljs-keyword">DEBUG</span></span>) app = <span class="hljs-string"><span class="hljs-string">'skype'</span></span> start_time = <span class="hljs-type"><span class="hljs-type">time</span></span>.strftime(<span class="hljs-string"><span class="hljs-string">'%Y%m%d-%H%M%S'</span></span>, <span class="hljs-type"><span class="hljs-type">time</span></span>.gmtime()) logman = PerflogManager(app, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">'d:/logman-test/'</span></span>) logman.init_collectors() logman.start_all() <span class="hljs-type"><span class="hljs-type">time</span></span>.sleep(<span class="hljs-number"><span class="hljs-number">20</span></span>) logman.stop_all() logman.process_csv()</code> </pre><br></div></div><br><br><h1>  Conclusion </h1><br>  In conclusion, I would like to say that logman is quite a useful utility, if it is necessary to automate the collection of performance metrics under Windows with minimal cost.  In a short time I did not manage to find a more convenient way, so I will be glad to learn about other ways and approaches in solving such problems in the comments. </div><p>Source: <a href="https://habr.com/ru/post/203692/">https://habr.com/ru/post/203692/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../203680/index.html">Methods of anonymity online. Part 3. Firefox</a></li>
<li><a href="../203682/index.html">The PHDays IV forum will be dedicated to finding new recipes for survival in cyberspace</a></li>
<li><a href="../203686/index.html">We play programming</a></li>
<li><a href="../203688/index.html">Path to Java Junior Developer</a></li>
<li><a href="../203690/index.html">Prelude or how to fall in love with Haskell</a></li>
<li><a href="../203694/index.html">Universal tips on jQuery</a></li>
<li><a href="../203696/index.html">Open State. data. Made in Ukraine</a></li>
<li><a href="../203698/index.html">Picaso 3D-Builder - Made in Russia</a></li>
<li><a href="../203700/index.html">Optimization of enumeration of surfaces composed of triangles</a></li>
<li><a href="../203702/index.html">Zend Framework 2.0 web application development</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>