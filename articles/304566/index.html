<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lenovo has released a security notification for its computers.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Computer maker Lenovo has issued a security alert for its users, Lenovo Security Advisory LEN-8324 . This is a vulnerability in the firmware (firmware...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lenovo has released a security notification for its computers.</h1><div class="post__text post__text-html js-mediator-article">  Computer maker Lenovo has issued a security alert for its users, Lenovo Security Advisory <a href="https://support.lenovo.com/ru/ru/solutions/LEN-8324">LEN-8324</a> .  This is a vulnerability in the firmware (firmware) produced by the company of computers, including in the well-known series of notebooks <a href="https://ru.wikipedia.org/wiki/ThinkPad">ThinkPad</a> .  The vulnerability can be attributed to the type of Local Privilege Escalation, since it allows an attacker to execute code in the microprocessor mode System Management Mode (SMM).  The SMM code is the most privileged from the point of view of the system, since its execution priority is even higher than that of the operating system or hypervisor running on the system that can control the virtual machines. <br><br><img src="https://habrastorage.org/files/76e/488/045/76e488045d8b46bb9f377a989cdf69fc.jpeg"><br><br>  Lenovo does not disclose information about the vulnerability, however, it is obvious that we are talking about the vulnerability, the details of which were published several days ago by a security account reader under the nickname <a href="https://twitter.com/d_olex">Cr4sh</a> .  The researcher presented his research results on the protection of the firmware of ThinkPad notebooks and published information about vulnerabilities in the implementation of BIOS_CNTL and SPI Protected Ranges (PRx) protection mechanisms that allow the firmware code to protect the SPI flash-memory (NVRAM) regions from being overwritten.  Such protection does not allow modifying legitimate executable firmware code or integrating extraneous code, for example, a backdoor into SMRAM memory. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/files/27c/e3f/79c/27ce3f79c0db47449a880033297bc180.png"><br><br>  The exploit demonstrated by the expert not only allows you to bypass the SPI Protected Ranges protection mechanism to write your SMM code, but also execute it using the 0day vulnerability in the Lenovo firmware.  The SPI Protected Ranges protection mechanism introduces the concept of special registers with the names PRx, which allow the firmware code to specify write-protected SPI flash memory regions.  Since the PRx registers are not writable by anyone except the firmware code, the exploit uses a special method to install them, similar to how the firmware code itself does. <br><br>  Since the reset of the PRx system registers is possible when the computer goes into S3 sleep mode, the firmware code saves them to a special structure called the Boot Script Table for later restoring them from there after returning from this mode.  By modifying this structure and simulating a return from S3 mode, the attacker's code can load new values ‚Äã‚Äãinto registers after waking up, i.e., reset them.  However, to protect against this method of operation, the UEFI standard regulates the use of a special protection mechanism of the Boot Script Table called the SMM LockBox.  SMM LockBox protection is successfully exploited using special system operations. <br><br><img src="https://habrastorage.org/files/c8e/914/d01/c8e914d0159044ffb6caac18fc47e0b1.png"><br>  Fig.  Exploit demonstration, successful modification of the PRx registers. <br><br>  Removing protection for modifying the chip's memory is used by an exploit involving the 0day vulnerability in the Lenovo firmware, which allows you to execute arbitrary SMM code using the callback function mechanism to bypass the SMM LockBox protection.  The vulnerability is present in the Lenovo UEFI driver called SystemSmmRuntimeRt, which can cause a pointer function in the structure passed to it without checking this pointer to belong to the legitimate code. <br><br><img src="https://habrastorage.org/files/a03/6a0/47d/a036a047d1ed48ca8ce0557bdf56b856.png"><br>  Fig.  Vulnerable driver in Lenovo UEFI firmware, which performs the function of a pointer from the structure without checking it. <br><br>  According to information published by Lenovo, the company itself does not develop firmware for its computers, delegating these responsibilities to BIOS / UEFI manufacturers, which, in turn, apply for the development and code base of Intel and AMD. <br><br><blockquote>  Since that time, Lenovo has been actively pursuing its own investigation, which remains ongoing.  At this point, there has been a list of independent BIOS Vendors (IBVs).  Independent BIOS vendors (IBVs) are software development firms that specialize in Lenovo, including Lenovo.  The following standard industry practice has been established, for example, chip makers, such as Intel or AMD.  Lenovo currently works with the industry‚Äôs three largest IBVs. </blockquote><br>  According <a href="">to</a> Cr4sh, the vulnerability is related to the firmware from Intel and was present there before 2014. The vulnerable driver is included in the newest firmware version of the ThinkPad T450s (1.22) laptops, as well as the ThinkPad X220 (1.42).  It can also potentially be located in Lenovo-made computers: ThinkCentre, ThinkStation, ThinkServer <br><br>  The demonstrated vulnerability allows attackers to bypass such modern protection mechanisms as Secure Boot, Virtual Secure Mode, and Credential Guard on Windows 10. The Secure Boot protection measure prevents malware such as bootkits from gaining control over the user's system at an early stage of its loading.  Disabling Secure Boot removes the security authentication measure of the OS loader from the firmware side. <br><br><img src="https://habrastorage.org/files/c79/796/687/c7979668797549c09bb120cdde0f9b13.jpeg"><br>  Fig.  Demonstration of arbitrary code execution in SMM. <br><br>  We recommend that Lenovo computer owners wait for the appropriate firmware update and install it as soon as it is available. </div><p>Source: <a href="https://habr.com/ru/post/304566/">https://habr.com/ru/post/304566/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../304554/index.html">Supermen on the assembly line: how we made an exoskeleton for teachers</a></li>
<li><a href="../304556/index.html">Teach children to program - they will change the world</a></li>
<li><a href="../304560/index.html">How to spend a vacation IT professionals - infographics poll</a></li>
<li><a href="../304562/index.html">June IT news</a></li>
<li><a href="../304564/index.html">Hardcore startups. Part 2: How to assemble a dream team</a></li>
<li><a href="../304568/index.html">6 reasons to explain to a child the basics of information security</a></li>
<li><a href="../304570/index.html">Spark Summit 2016: review and experience</a></li>
<li><a href="../304572/index.html">SuggestBundle or drop-down ajax lists in symfony</a></li>
<li><a href="../304574/index.html">NW.js or Electron?</a></li>
<li><a href="../304576/index.html">Standardization of records</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>