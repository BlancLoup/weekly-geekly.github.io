<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Grouping alerts in Android 7</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="After updating to Android 7, we noticed that notifications began to be grouped by application automatically. Since at the time of the release of the n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Grouping alerts in Android 7</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/824/363/b84/824363b844424ef3a60efa1b8426690d.jpg" align="left" width="350">  After updating to Android 7, we noticed that notifications began to be grouped by application automatically.  Since at the time of the release of the new version of Android, our application did not yet have a notification history, this change was quite critical - only 7 notifications are displayed in one group.  This means that if more than 20 notifications arrive per day through the application, you need to brush off new ones in order to see older ones. <br><br>  Notifications in the group are sorted by priority.  If you have 7 notifications in the group and another low priority comes, it will first be at the top, and then fly to the bottom and you will not see it at all in the list until you delete a certain number of notifications. <br><br>  We made grouping by channels, this allows you to immediately see the channel and, if possible, minimize it.  Even if the channel sends you 100 notifications, they are still easily collapsed and removed in one motion. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this article we will explain why the official manual does not work, and how we found a way to do it right. <br><a name="habracut"></a><br><h2>  What does the official manual say? </h2><br><img src="https://habrastorage.org/files/9d3/dd6/bc1/9d3dd6bc11b6423689aa99f017b11e83"><br><br>  If you go <a href="https://developer.android.com/guide/topics/ui/notifiers/notifications.html%3Fhl%3Den">here</a> , then we are simply recommended "You can use the Builder.setGroup () method to bundle similar notifications".  And further recommend to go <a href="https://developer.android.com/training/wearables/notifications/stacks.html">here</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0db/51f/d02/0db51fd027464a9db2137aee0713e61f.png"></div><br>  It only works on Android Wear.  We found a solution by typing, however, while writing the article, another manual was found in the <a href="https://android-developers.googleblog.com/2016/06/notifications-in-android-n.html">article</a> .  It is partially correct, but very little is described. <br><br><h2>  How we did </h2><br>  The manual above says: ‚ÄúIt is important to also create a summary notification.  This is a notification notice that you‚Äôve signed out on setGroupSummary (true).  It is an opportune time to use the InboxStyle, although it is not a requirement.  There is no need for any specific information. . " <br><br>  Here those sores immediately pop up to which we ran. <br><br><h4>  1. You need to limit the version of the API </h4><br>  Before Android 7, it is better to turn off grouping altogether - otherwise you will not see notifications in the group when using our solution. <br><br><pre><code class="java hljs">Boolean groupflag = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(Build.VERSION.SDK_INT &gt; <span class="hljs-number"><span class="hljs-number">23</span></span>){ groupflag = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre> <br><h4>  2. Auto-close and re-create </h4><br>  If setAutoCancel (true) is not specified - when you click on the last notification from the group, the group will remain on the list.  When another notification comes from a group, you can re-create the main header with the same ID - for identification we use the channel ID (subid) for such notification, and the group header is set via setContentTitle. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(groupflag) { Notification mainnotif = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotificationCompat.Builder(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) .setContentTitle(subname) .setAutoCancel(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) .setSmallIcon(R.mipmap.ic_launcher) .setGroupSummary(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) .setGroup(subname) .setStyle(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotificationCompat.MessagingStyle(subname)) .setColor(ContextCompat.getColor(context, R.color.blue)) .setSubText(subname) .build(); notificationManager.notify(subid, mainnotif); }</code> </pre> <br><h4>  3. Creating the notification itself </h4><br>  Do not forget setGroup (subname).  Also an interesting life hack, if you just need to turn off the standard grouping - you can add, for example, setGroup (‚ÄúApp‚Äù) without creating a header notification.  Then the grouping on the device itself will not work, but to disable groups also on the clock, I think it‚Äôs worth writing there random text.  Without a group, notifications will be grouped by your application. <br><br><pre> <code class="java hljs"> NotificationCompat.Builder mBuilder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotificationCompat.Builder( context).setSmallIcon(R.mipmap.ic_launcher) .setAutoCancel(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) .setWhen(time) .setTicker(title) .setLargeIcon(icon) .setContentTitle(title) .setStyle(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotificationCompat.BigTextStyle().bigText(msg)) .setContentText(msg) .setVibrate(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>]) .setSubText(subname) .setGroupSummary(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) .setColor(ContextCompat.getColor(context, R.color.blue)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(groupflag) mBuilder.setGroup(subname);</code> </pre> <br>  You can try such notifications <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.bupyc.pushall.app">in our application</a> , just add a device to your account and ping through your personal account in your profile 4-6 times.  This implementation allows you to save space in the notification area and efficiently manage them.  I very often see how applications either replace previous notifications, essentially removing the opportunity to read it, or simply do not use grouping where it is possible. <br><br>  Also, a little detail, if you believe the metadata <a href="https://developer.android.com/guide/topics/ui/notifiers/notifications.html">section</a> ‚Äúthe addPerson () method allows you to add a list of people to the notification.  With its help, your notification may signal the system that it should group notifications from the specified people or consider notifications from these people more important.  However, we have not tried this method. </div><p>Source: <a href="https://habr.com/ru/post/319794/">https://habr.com/ru/post/319794/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../319782/index.html">Study of image segmentation methods</a></li>
<li><a href="../319784/index.html">I work at the Deutsche Bank TechCenter</a></li>
<li><a href="../319786/index.html">SQL injection in GitHub Enterprise</a></li>
<li><a href="../319788/index.html">Release FFCMS 3.0.0 - a new recycled system</a></li>
<li><a href="../319790/index.html">Recursion Quick look</a></li>
<li><a href="../319796/index.html">Episode 3 - a new hope for the success of the game for Android</a></li>
<li><a href="../319798/index.html">Why do people play games</a></li>
<li><a href="../319800/index.html">What are the service providers of data centers, and how to choose the best?</a></li>
<li><a href="../319804/index.html">Pure javascript.Classes</a></li>
<li><a href="../319806/index.html">Product development: two years of work on the Otkrytie Bank mobile app</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>