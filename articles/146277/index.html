<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Play and root rights for Android Emulator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 

 I want to share my experience of stuffing Google Play add cones into the emulator that is part of the Android SDK. You ask: " What can be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Play and root rights for Android Emulator</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr! <br><br>  I want to share my experience of <s>stuffing</s> <b>Google Play</b> add <s>cones</s> into the emulator that is part of the Android SDK.  You ask: " <i>What can be so difficult here? Add the necessary .apk and use it with pleasure, they already wrote about it on Habr√© <a href="http://habrahabr.ru/post/134509/">here</a> !</i> " <br><br>  But no, the pitfalls turned out to be quite a lot.  I will tell about them under a cat.  By the way, along the way, I'll tell you how to get <b>root</b> rights for the emulator. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/dae/dbb/1be/daedbb1be015bd676f193db62d859334.png"><br><br>  Interesting?  Welcome under cat. <br><br>  <b>UPD</b> : Updated outdated links. <br><a name="habracut"></a><br>  And so, for a start - how does my instruction differ from what was written earlier?  That when using Google Play you will not face such picture when in categories three and a half applications are visible.  For example, here in Top Free you can see as many as two (sic!) Applications .: <br><img src="https://habrastorage.org/storage2/8be/44a/4c4/8be44a4c43ca52f2f0835ecd2cbad753.png"><br><br>  The instruction is written for Windows, but it is also suitable for other supported OS SDKs, just with minor changes. <br><br>  We will need: <br>  Andoid SDK with the following installed packages: <br><ul><li>  Android SDK Tools </li><li>  Android SDK Platform-tools </li><li>  SDK Platform for Android 2.3.3 </li><li>  Extras / Android Support </li><li>  Extras / Google USB Driver </li></ul>  Owners of processors from Intel with virtualization support, I recommend, for a start, follow the instructions recently published <a href="http://habrahabr.ru/company/intel/blog/146114/">here</a> , and create an emulator with Android 2.3. <br><br>  Create a folder called <i>GooglePlay</i> and open the console in it.  This is easy to do by right clicking on the folder with the Shift key pressed.  Unfortunately, this only works in Windows Vista and above.  Those who use XP will have to write paths for cd. <br><br>  Now you need to download some files.  Save all downloads to the created folder. <br>  We use emulator 2.3, so we take: <br><ul><li>  <a href="http://wiki.cyanogenmod.com/wiki/Latest_Version/Google_Apps"><b>Google Apps</b> for CyanogenMod 7</a> </li><li>  <b>Mkfs.yaffs2 utility</b> : <a href="http://code.google.com/p/android-group-korea/downloads/detail%3Fname%3Dmkfs.yaffs2.arm%26can%3D2%26q%3D">for ARM emulator</a> </li><li>  Or <a href="http://code.google.com/p/android-group-korea/downloads/detail%3Fname%3Dmkfs.yaffs2.x86%26can%3D2%26q%3D"><b>mkfs.yaffs2 for x86</b> emulator</a> </li><li>  <a href="http://androidsu.com/superuser/"><b>SuperUser.apk</b> and <b>su</b></a> for ARM or x86. </li></ul><br>  After installing all the packages, add <i>android-sdk \ tools</i> and <i>android-sdk \ platform-tools</i> to the system <i>PATH</i> for convenience. <br><br>  Create an emulator for Android 2.3 using the AVD Manager, setting the size of the SD card to 200-250 MB. <br><img src="https://habrastorage.org/storage2/682/7df/fa3/6827dffa3665921c0204b4c5e3473946.png"><br><br>  Start the emulator and when it is fully loaded - open the command line and enter the command " <i>adb devices</i> ".  You will need to see the emulator in the list of connected devices: <br><img src="https://habrastorage.org/storage2/4fd/ff3/920/4fdff3920ff078e111a67b1d39fa2301.png"><br><br>  If it is not there, go to the settings in the emulator ( <i>Menu button - Settings - Applications - Development</i> ).  Check the box " <i>Debug USB</i> " and restart the emulator.  Now it should appear in the list. <br><br>  Next you will <s>find a not very</s> exciting input heaps of console commands and waiting. <br><br>  We will need the <i>GoogleServicesFramework.apk</i> , <i>MarketUpdater.apk</i> and <i>Vending.apk files</i> from the downloaded archive with <i>GoogleApps</i> .  Open it and copy them to the folder you created earlier. <br><br>  Now we need to make some tricky hacks so that all applications from Google Play are available to us, regardless of their requirements.  Otherwise, a picture from several single applications expects you, as was shown above.  It is worth making a remark - launching unsupported applications will not work, but these hacks will allow you to download these applications to the device and, after that, pull apk out of the emulator, for example. <br><br>  Execute the command: <br><blockquote>  <i>adb pull system / build.prop.</i> </blockquote><br>  Just in case, I note that the dot at the end of the command is not a typo. <br>  The file build.prop will appear in the folder.  Open it with a text editor, find the line starting with <i>ro.product.cpu.abi</i> <br>  After it we add one more line: <br><blockquote>  <i>ro.product.cpu.abi2 = armeabi-v7a</i> </blockquote><br>  Just after the comment <i>ADDITIONAL_BUILD_PROPERTIES</i> you need to add the line <br><blockquote>  <i>ro.opengles.version = 131072</i> </blockquote><br>  This will allow us to see applications that require the ARM7 processor architecture and version 2.0 support. <br><br>  We also need an archive with <i>permissions</i> , which can be found <a href="https://docs.google.com/file/d/0BxJuD6m3SeknYnE4Q0tPWTN5b28/edit%3Fusp%3Dsharing">here</a> . <br>  Drag the <i>permissions</i> folder from the archive into our <i>GooglePlay</i> folder. <br>  These files are needed for applications that require certain equipment to work.  For example, a camera or accelerometer. <br><br>  By the way, about entering heaps of console commands, I lied.  Hehe. <br>  You will only need to create two .bat files.  Let's start with. <br><br>  Name the first file permissions.bat and fill it with this content: <br><blockquote>  <i>adb push permissions / android.hardware.camera.autofocus.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.camera.flash-autofocus.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.camera.front.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.camera.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.location.gps.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.location.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.sensor.accelerometer.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.sensor.compass.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.sensor.gyroscope.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.sensor.light.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.sensor.proximity.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.telephony.gsm.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.touchscreen.multitouch.jazzhand.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.touchscreen.multitouch.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.touchscreen.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.hardware.wifi.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.software.live_wallpaper.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / android.software.sip.voip.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / com.android.location.provider.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / features.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / handheld_core_hardware.xml / system / etc / permissions /</i> <i><br></i>  <i>adb push permissions / platform.xml / system / etc / permissions /</i> <br></blockquote><br><br>  After - create another one with an arbitrary name, for example make.bat and such content: <br><blockquote>  <i>adb remount</i> <i><br></i>  <i>adb push build.prop / system /</i> <i><br></i>  <i>adb push su / system / bin /</i> <i><br></i>  <i>adb push Superuser.apk / system / app /</i> <i><br></i>  <i>adb push Vending.apk / system / app /</i> <i><br></i>  <i>adb push MarketUpdater.apk / system / app /</i> <i><br></i>  <i>adb push GoogleServicesFramework.apk / system / app /</i> <i><br></i>  <i>call permissions.bat</i> <i><br></i>  <i>adb push mkfs.yaffs2 / data / misc /</i> <i><br></i>  <i>adb shell rm /system/app/SdkSetup.apk</i> <i><br></i>  <i>adb remount</i> <i><br></i>  <i>adb shell chmod 4755 / system / bin / su</i> <i><br></i>  <i>adb shell chmod 777 /data/misc/mkfs.yaffs2</i> <i><br></i>  <i>adb shell ./data/misc/mkfs.yaffs2 / system /sdcard/system.img</i> <i><br></i>  <i>adb pull /sdcard/system.img system.img</i> <br></blockquote><br>  For those who chose an emulator from Intel - pay attention to the file names in make.bat. <br>  Lines <br><blockquote>  <i>adb push su / system / bin /</i> <i><br></i>  <i>adb push mkfs.yaffs2 / data / misc /</i> <i><br></i>  <i>adb shell chmod 777 /data/misc/mkfs.yaffs2</i> <i><br></i>  <i>adb shell ./data/misc/mkfs.yaffs2 / system /sdcard/system.img</i> <br></blockquote><br>  should be replaced by: <br><blockquote>  <i>adb push su.x86 / system / bin / su</i> <i><br></i>  <i>adb push mkfs.yaffs2.x86 / data / misc /</i> <i><br></i>  <i>adb shell chmod 777 /data/misc/mkfs.yaffs2.x86</i> <i><br></i>  <i>adb shell ./data/misc/mkfs.yaffs2.x86 / system /sdcard/system.img</i> <br></blockquote><br><br>  As a result, the contents of the <i>GooglePlay</i> folder should be: <br><br><img src="https://habrastorage.org/storage2/a15/30a/9ab/a1530a9abaaded491cdbb4e53a798f3f.png"><br><br>  Now - run the make.bat file and start waiting.  Keep in mind that the last two commands from the make.bat file will take a long time to execute.  There is a little trick - to speed up this process you need to do something on the emulator.  For example, surf Habrahabr from the emulator.  I do not know how or why, but when the emulator is loaded, it speeds up the process of creating and copying system.img. <br><br>  After the console reports about its completion by its closure, we will find the system.img file in the working folder.  Now close the emulator.  You do not need to immediately log in or install any applications - you will lose all changes after restarting the emulator. <br><br>  Grab the appeared system.img and replace it with a file from the folder <br><blockquote>  <i>android-sdk / platforms / android-10 / images /</i> </blockquote><br>  If someone took Intel's x86 image as a base, use the folder <br><blockquote>  <i>android-sdk / add-ons / addon-intel_atom_x86_system_image-intel_corporation-10 / images / x86</i> </blockquote><br>  Do not forget to backup the original system.img! <br>  Please note that the android-10 folder is equivalent for Android version 2.3.  For other versions of the android, the number after android is equal to the API Level of this version. <br><br>  Now go to the folder where you have the emulator files and delete the files " <i>cache.img</i> ", " <i>userdata-qemu.img</i> ", " <i>snapshot.img</i> ", " <i>userdata.img</i> " (if it is there).  The default for Win7 is <br><blockquote>  <i>C: / Users / Your User Name / .android / avd / Your Emulator Name. Avd /</i> </blockquote><br>  After that, start the emulator, open Google Play, log in, accept the terms of the agreement and ... restart the emulator again, because, often, applications do not want to load immediately after login. <br><br>  And now, after the last reboot, you can finally fully use the emulator. <br><img src="https://habrastorage.org/storage2/a28/652/0ec/a286520ec8d5e7616497be0cf41367cb.png"><br><br>  I hope my article will help someone save time.  Thank you for taking the time to read it. </div><p>Source: <a href="https://habr.com/ru/post/146277/">https://habr.com/ru/post/146277/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146270/index.html">Initiatives of Russian Internet users will consider the Parliament</a></li>
<li><a href="../146271/index.html">Do you use domain.RF?</a></li>
<li><a href="../146272/index.html">Android, Ubuntu and Python: automate Internet radio recording and on-air synchronization</a></li>
<li><a href="../146274/index.html">Where can we get such a tool to shoe a semantic flea?</a></li>
<li><a href="../146276/index.html">Mobile Internet with backup channel for online broadcasts</a></li>
<li><a href="../146278/index.html">Feedback</a></li>
<li><a href="../146279/index.html">Pentagon is testing an operating system to control an army of robots</a></li>
<li><a href="../146282/index.html">Customer-Executor: avoid accidents</a></li>
<li><a href="../146284/index.html">Logical security holes Sberbank OnL @ yn</a></li>
<li><a href="../146286/index.html">Deploying a radio station to GNU / Linux. Part I</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>