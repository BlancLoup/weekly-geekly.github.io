<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Maintenance code. How to ‚Äúsell‚Äù refactoring to business</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few days ago I wrote an article about the main characteristics of the old code. However, there were too few concrete practical recommendations on ho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Maintenance code. How to ‚Äúsell‚Äù refactoring to business</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/04e/d1f/115/04ed1f115d7b47269f21d301cb4ce517.jpg" align="left">  A few days ago I wrote <a href="http://habrahabr.ru/post/266803/" title="Old code: why is it so">an article</a> about the main characteristics of the old code.  However, there were too few concrete practical recommendations on how to live in the conditions of the old code. <br><br>  Today I will try to answer one of the most frequent questions that I hear when it comes to developing systems with an exorbitant amount of legacy, and share my view on how to ‚Äúsell‚Äù refactoring to business. <br><br>  In this article, I fundamentally limit myself to describing interaction with a business and do not touch on technical details (how exactly refactoring should be carried out).  The post is written solely on the personal successful and not very experience of ‚Äúselling‚Äù and ‚Äúbuying‚Äù refactoring in different teams and in different companies. <br><a name="habracut"></a><br><h2>  Prerequisites </h2><br>  So, to be more specific, let's imagine that we have a flagship product that has been operating for several (sometimes a dozen) years and brings the lion's share of the company's revenues. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Usually there are approximately the following features of the product: <br><ul><li>  <a href="http://habrahabr.ru/post/115628/" title="Article about this phenomenon">"Plasticine architecture"</a> - during the lifetime of the product has acquired a large number of additional features that have been added in a hurry.  This led to the fact that the logic of the system is evenly spread throughout the code, in some places there are "hacks" that allow you to "do strange", bypassing the original idea. </li><li>  <b>lack of unit tests</b> - the current logic is not covered by tests a little more than completely.  ‚ÄúBecause unit tests were thought about for the third year of the system‚Äôs life, but it‚Äôs already incomprehensible how to build in, and there was little time for the tests.‚Äù </li><li>  <b>the absence of experts</b> - people who initially wrote the product, either sit in the position of big managers, or quit, or have already forgotten for many years how everything is arranged inside. </li></ul><br>  I described a typical situation in which there is a huge amount of products in different companies.  And, characteristically, the level of developers can be very high.  Just every year the code becomes more and more confusing. <br><br>  It is clear that such a code will have to refactor sooner or later.  But how to get time for this task in the conditions of a constant flow of food tasks?  That is what we will discuss below. <br><br><h2>  And can rewrite everything from scratch? </h2><br><img src="https://habrastorage.org/files/9cf/69c/b26/9cf69cb26e134d98bae8422b7778e5ad.jpg" align="left" title="To rebuild a complex system takes years ... and inhuman efforts">  You can dream about it, but the chances that someone will be able to convince of this is extremely small.  Moreover, if you manage to convince the management to throw out the old code and write it all over again, it means that either this manual does not know how to assess the risks, or the company is so rich that it can afford a long time (sometimes for several years) contain a parallel "strategic" team of programmers who do not bring current profits. <br><br>  In general, read <a href="http://habrahabr.ru/post/219651/" title="Joel Spolsky. Rakes that should not be stepped on - thanks dreyk @ for the translation">Joel Spolsky</a> .  He says it (although, according to the official version, Netscape was nevertheless taken out of the market by free IE, and not by delays in updates). <br><br>  And one more thing: it is necessary to understand that the project ‚Äúrewrite everything from scratch‚Äù can take years, and you will have to deal with the support of the old code at this time.  Therefore, what is written below is important in any case. <br><br>  So, how can you convince a business that you still need refactoring? <br><br><h2>  Tip 1. Do not sell refactoring to business! </h2><br>  In order to understand what I mean, we need to recall Fowler's classic definition: <i>Refactoring is a change in the internal structure of the software, designed to make it easier to understand its work and simplify the modification without affecting the observed behavior</i> . <br><br>  Pay attention to two points: <br><ul><li>  the purpose of refactoring is to simplify the understanding and modification of the code - purely technical, not business </li><li>  the behavior does not change, that is, the result for the business is not noticeable </li></ul><br>  This means that with the successful refactoring, there will be no changes.  None!  With less successful - in the running code there will be errors and differences in behavior.  That is, you cannot say ‚Äúwe fixed 10 bugs and implemented a super chip‚Äù.  You can say ‚Äúnow the code has become more beautiful, and the architecture is simpler and more understandable.  Well, yes, and a couple of bugs appeared ... But we will definitely fix them! ‚Äù. <br><br>  Now imagine yourself in the place of business.  A team of expensive professionals spent a lot of time on "beauty guidance" instead of making understandable features that bring users and money.  It's like, having given the car to the car wash, get it unchanged and the bill for $ 500 with a note ‚Äúwe went over your suspension and now we can change racks three times faster.  Perhaps the first time will be something to tap, but it should pass in a month.  If it doesn't, come, we will fix it for a reasonable fee. ‚Äù  I do not know about you, but I would not like that very much. <br><br>  In general, the first rule is this: they buy only what is interesting for the buyer or what you are interested in.  <b>Modification of the code itself is not valuable for business and is not interesting to anyone except developers</b> .  Therefore, the main mistake you can make is to say: ‚Äúyou need to do refactoring, because the code is bad, and nothing is clear.‚Äù <br><br>  Then what to say? <br><br><h2>  Tip 2. Sell business opportunities and problem solving </h2><br><img src="https://habrastorage.org/files/185/7c6/942/1857c69426894f769f70e5d4de94afb0.jpg" align="left" title="You must be the one who solves problems.">  I think each of us intuitively understands that problems with bad code lead not only to the pain of developers when working with it, but also to certain problems in business.  If you try to formalize this understanding, then we come to the two most serious problems. <br><br>  Firstly, it is an <b>unstable system behavior</b> - strange bugs, performance problems, unpredictable behavior, data loss (this is probably the worst) and so on.  This, in turn, leads to user dissatisfaction, refusals, bad reviews, low ratings in the case of mobile applications.  In general, it affects the profit in the most direct way. <br><br>  Secondly - a very <b>long process of making changes</b> .  That is, from the moment when the feature is conceived before it appears in the code, it takes a long time.  As a result, this not only makes the development process long and painful for the product team, but also does not allow you to quickly derive many functions, experiment with a large number of different options, quickly prototype changes and roll out to users to look at their reaction.  Moreover, sometimes some changes that you want to make are simply impossible without a careful reassembly of the entire system on cogs (and this is in fact already close to what we call refactoring). <br><br>  Therefore, it is necessary to come to business with the idea of ‚Äã‚Äãrefactoring at a time when at least one of these two problems becomes obvious.  However, if there are no problems yet, and you see a potential danger in one of these areas, you can come to the business in advance.  But then it is necessary to prepare a much more compelling arguments. <br><br>  As a result, the <b>purpose of refactoring should be stated not to improve the structure of the code, but to stabilize the system or speed up the delivery of features to users</b> .  Accordingly, if as a result of refactoring, there are no fewer bugs, and simple features, as they were added for two months, are added, then time was wasted, and, from a business point of view, you did not cope with the main task. <br><br><h2>  Tip 3. Take a look at the business development. </h2><br>  As it was already written above, the first rule of argumentation is to understand the values ‚Äã‚Äãof the interlocutor.  In this case, it makes sense to look at refactoring from the business side. <br><br>  From a business point of view, any feature has development costs and profit from implementation.  Costs consist of several parts.  First, it is the money that the team spends on the development of features.  This includes developer salaries, taxes, office rent, equipment, electricity, and so on.  The costs associated with the loss of profits are less obvious, but no less important: during the development of the current feature, <i>no</i> other functions appear in the product that <i>do not</i> make money and <i>do not</i> attract new users. <br><br>  Obviously, the importance of features can be easily estimated by comparing the planned profit from it and the costs of its implementation.  From this point of view, refactoring is an investment in the pure form.  Resources are spent, but the product does not appear as a result of either new users or new functions. <br><br>  And <b>your main task is to show the business why investing in refactoring will benefit in a reasonable time</b> . <br><br>  How to show this benefit? <br><br><h2>  Tip 4. Use numbers </h2><br><img src="https://habrastorage.org/files/537/6dd/040/5376dd0409484e08b90e2b37b6e7f67a.jpg" title="But please try to keep a healthy psyche!" align="left">  In order to make a decision on refactoring, a business needs, first, to get an estimate of the labor costs for carrying it out (which you most likely do regularly), and second, to understand the profit from its results.  And this is one of the difficult moments.  No matter how I would like to say: ‚Äúwe have <i>many</i> bugs‚Äù or ‚Äúif we refactor, we can <i>save time</i> when making further changes,‚Äù these words will have no meaning for the business. <br><br>  In order to come up with a normal numerical rationale, you will have to do some administrative work.  For example, to collect in one list all the bugs that can not be fixed in a reasonable time in the current implementation, and which will be corrected after refactoring.  A more difficult and painstaking work is to keep track of how long each change takes, and add time to each digit that would take this change in the system after refactoring.  This is an order of magnitude more difficult, but the results are much more tangible.  Because, ‚Äúthe change that would allow us to save X man-hours of development over the past month and allow us to save about the same in the future‚Äù sounds much clearer and more convincing for a business than the need to ‚Äúput the code in order‚Äù. <br><br>  There is another subtle point.  In assessing, the main thing is not to embellish, not to make a bright future brighter than it will in fact not underestimate the cost of refactoring.  After all, after the cherished "good" for refactoring is received, you will be the person who promised a bright future and spent the budget, and as a result ... <br><br>  ... and as a result, everything depends on you.  If you are sure that refactoring can help catch old bugs, speed up development, make the code cleaner and clearer, and the user is happier, go ahead. <br><br>  And good luck! </div><p>Source: <a href="https://habr.com/ru/post/267241/">https://habr.com/ru/post/267241/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267231/index.html">Functional C #: work with errors</a></li>
<li><a href="../267233/index.html">Managing complexity in ruby ‚Äã‚Äãon rails projects. Part 2</a></li>
<li><a href="../267235/index.html">RailsClub 2015: Competition from Vexor'a and the story of the CI-service in a large project</a></li>
<li><a href="../267237/index.html">About UEFI security, part three</a></li>
<li><a href="../267239/index.html">In the wake of C ++ Siberia: a dragon in a bag</a></li>
<li><a href="../267243/index.html">RxJava. Fighting the challenges of harsh reality</a></li>
<li><a href="../267245/index.html">RailsClub 2015: Interview with Nikolai Ryzhikov</a></li>
<li><a href="../267247/index.html">How many tweets do you need to know your character?</a></li>
<li><a href="../267253/index.html">In the Chinese AppStore, 39 infected applications were detected due to a modified version of Xcode.</a></li>
<li><a href="../267257/index.html">New PHP, Part 1: Return types</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>